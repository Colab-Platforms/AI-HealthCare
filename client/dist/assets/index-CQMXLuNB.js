function fxe(e,n){for(var s=0;s<n.length;s++){const o=n[s];if(typeof o!="string"&&!Array.isArray(o)){for(const d in o)if(d!=="default"&&!(d in e)){const h=Object.getOwnPropertyDescriptor(o,d);h&&Object.defineProperty(e,d,h.get?h:{enumerable:!0,get:()=>o[d]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))o(d);new MutationObserver(d=>{for(const h of d)if(h.type==="childList")for(const f of h.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function s(d){const h={};return d.integrity&&(h.integrity=d.integrity),d.referrerPolicy&&(h.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?h.credentials="include":d.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(d){if(d.ep)return;d.ep=!0;const h=s(d);fetch(d.href,h)}})();var Hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ur(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Cq={exports:{}},nT={},Rq={exports:{}},On={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qy=Symbol.for("react.element"),gxe=Symbol.for("react.portal"),vxe=Symbol.for("react.fragment"),yxe=Symbol.for("react.strict_mode"),bxe=Symbol.for("react.profiler"),xxe=Symbol.for("react.provider"),_xe=Symbol.for("react.context"),Exe=Symbol.for("react.forward_ref"),wxe=Symbol.for("react.suspense"),Sxe=Symbol.for("react.memo"),Txe=Symbol.for("react.lazy"),Tz=Symbol.iterator;function Nxe(e){return e===null||typeof e!="object"?null:(e=Tz&&e[Tz]||e["@@iterator"],typeof e=="function"?e:null)}var Aq={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Iq=Object.assign,Oq={};function sg(e,n,s){this.props=e,this.context=n,this.refs=Oq,this.updater=s||Aq}sg.prototype.isReactComponent={};sg.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};sg.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Pq(){}Pq.prototype=sg.prototype;function Gk(e,n,s){this.props=e,this.context=n,this.refs=Oq,this.updater=s||Aq}var Wk=Gk.prototype=new Pq;Wk.constructor=Gk;Iq(Wk,sg.prototype);Wk.isPureReactComponent=!0;var Nz=Array.isArray,kq=Object.prototype.hasOwnProperty,$k={current:null},jq={key:!0,ref:!0,__self:!0,__source:!0};function Dq(e,n,s){var o,d={},h=null,f=null;if(n!=null)for(o in n.ref!==void 0&&(f=n.ref),n.key!==void 0&&(h=""+n.key),n)kq.call(n,o)&&!jq.hasOwnProperty(o)&&(d[o]=n[o]);var v=arguments.length-2;if(v===1)d.children=s;else if(1<v){for(var b=Array(v),_=0;_<v;_++)b[_]=arguments[_+2];d.children=b}if(e&&e.defaultProps)for(o in v=e.defaultProps,v)d[o]===void 0&&(d[o]=v[o]);return{$$typeof:Qy,type:e,key:h,ref:f,props:d,_owner:$k.current}}function Cxe(e,n){return{$$typeof:Qy,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function zk(e){return typeof e=="object"&&e!==null&&e.$$typeof===Qy}function Rxe(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return n[s]})}var Cz=/\/+/g;function DI(e,n){return typeof e=="object"&&e!==null&&e.key!=null?Rxe(""+e.key):n.toString(36)}function nw(e,n,s,o,d){var h=typeof e;(h==="undefined"||h==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(h){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case Qy:case gxe:f=!0}}if(f)return f=e,d=d(f),e=o===""?"."+DI(f,0):o,Nz(d)?(s="",e!=null&&(s=e.replace(Cz,"$&/")+"/"),nw(d,n,s,"",function(_){return _})):d!=null&&(zk(d)&&(d=Cxe(d,s+(!d.key||f&&f.key===d.key?"":(""+d.key).replace(Cz,"$&/")+"/")+e)),n.push(d)),1;if(f=0,o=o===""?".":o+":",Nz(e))for(var v=0;v<e.length;v++){h=e[v];var b=o+DI(h,v);f+=nw(h,n,s,b,d)}else if(b=Nxe(e),typeof b=="function")for(e=b.call(e),v=0;!(h=e.next()).done;)h=h.value,b=o+DI(h,v++),f+=nw(h,n,s,b,d);else if(h==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return f}function bE(e,n,s){if(e==null)return e;var o=[],d=0;return nw(e,o,"","",function(h){return n.call(s,h,d++)}),o}function Axe(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var Ls={current:null},rw={transition:null},Ixe={ReactCurrentDispatcher:Ls,ReactCurrentBatchConfig:rw,ReactCurrentOwner:$k};function Lq(){throw Error("act(...) is not supported in production builds of React.")}On.Children={map:bE,forEach:function(e,n,s){bE(e,function(){n.apply(this,arguments)},s)},count:function(e){var n=0;return bE(e,function(){n++}),n},toArray:function(e){return bE(e,function(n){return n})||[]},only:function(e){if(!zk(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};On.Component=sg;On.Fragment=vxe;On.Profiler=bxe;On.PureComponent=Gk;On.StrictMode=yxe;On.Suspense=wxe;On.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ixe;On.act=Lq;On.cloneElement=function(e,n,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=Iq({},e.props),d=e.key,h=e.ref,f=e._owner;if(n!=null){if(n.ref!==void 0&&(h=n.ref,f=$k.current),n.key!==void 0&&(d=""+n.key),e.type&&e.type.defaultProps)var v=e.type.defaultProps;for(b in n)kq.call(n,b)&&!jq.hasOwnProperty(b)&&(o[b]=n[b]===void 0&&v!==void 0?v[b]:n[b])}var b=arguments.length-2;if(b===1)o.children=s;else if(1<b){v=Array(b);for(var _=0;_<b;_++)v[_]=arguments[_+2];o.children=v}return{$$typeof:Qy,type:e.type,key:d,ref:h,props:o,_owner:f}};On.createContext=function(e){return e={$$typeof:_xe,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:xxe,_context:e},e.Consumer=e};On.createElement=Dq;On.createFactory=function(e){var n=Dq.bind(null,e);return n.type=e,n};On.createRef=function(){return{current:null}};On.forwardRef=function(e){return{$$typeof:Exe,render:e}};On.isValidElement=zk;On.lazy=function(e){return{$$typeof:Txe,_payload:{_status:-1,_result:e},_init:Axe}};On.memo=function(e,n){return{$$typeof:Sxe,type:e,compare:n===void 0?null:n}};On.startTransition=function(e){var n=rw.transition;rw.transition={};try{e()}finally{rw.transition=n}};On.unstable_act=Lq;On.useCallback=function(e,n){return Ls.current.useCallback(e,n)};On.useContext=function(e){return Ls.current.useContext(e)};On.useDebugValue=function(){};On.useDeferredValue=function(e){return Ls.current.useDeferredValue(e)};On.useEffect=function(e,n){return Ls.current.useEffect(e,n)};On.useId=function(){return Ls.current.useId()};On.useImperativeHandle=function(e,n,s){return Ls.current.useImperativeHandle(e,n,s)};On.useInsertionEffect=function(e,n){return Ls.current.useInsertionEffect(e,n)};On.useLayoutEffect=function(e,n){return Ls.current.useLayoutEffect(e,n)};On.useMemo=function(e,n){return Ls.current.useMemo(e,n)};On.useReducer=function(e,n,s){return Ls.current.useReducer(e,n,s)};On.useRef=function(e){return Ls.current.useRef(e)};On.useState=function(e){return Ls.current.useState(e)};On.useSyncExternalStore=function(e,n,s){return Ls.current.useSyncExternalStore(e,n,s)};On.useTransition=function(){return Ls.current.useTransition()};On.version="18.3.1";Rq.exports=On;var z=Rq.exports;const ye=ur(z),Mq=fxe({__proto__:null,default:ye},[z]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oxe=z,Pxe=Symbol.for("react.element"),kxe=Symbol.for("react.fragment"),jxe=Object.prototype.hasOwnProperty,Dxe=Oxe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Lxe={key:!0,ref:!0,__self:!0,__source:!0};function Uq(e,n,s){var o,d={},h=null,f=null;s!==void 0&&(h=""+s),n.key!==void 0&&(h=""+n.key),n.ref!==void 0&&(f=n.ref);for(o in n)jxe.call(n,o)&&!Lxe.hasOwnProperty(o)&&(d[o]=n[o]);if(e&&e.defaultProps)for(o in n=e.defaultProps,n)d[o]===void 0&&(d[o]=n[o]);return{$$typeof:Pxe,type:e,key:h,ref:f,props:d,_owner:Dxe.current}}nT.Fragment=kxe;nT.jsx=Uq;nT.jsxs=Uq;Cq.exports=nT;var c=Cq.exports,qO={},Fq={exports:{}},Ua={},Vq={exports:{}},Bq={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(J,ue){var Ee=J.length;J.push(ue);e:for(;0<Ee;){var Fe=Ee-1>>>1,ke=J[Fe];if(0<d(ke,ue))J[Fe]=ue,J[Ee]=ke,Ee=Fe;else break e}}function s(J){return J.length===0?null:J[0]}function o(J){if(J.length===0)return null;var ue=J[0],Ee=J.pop();if(Ee!==ue){J[0]=Ee;e:for(var Fe=0,ke=J.length,Ge=ke>>>1;Fe<Ge;){var De=2*(Fe+1)-1,Pe=J[De],Ve=De+1,it=J[Ve];if(0>d(Pe,Ee))Ve<ke&&0>d(it,Pe)?(J[Fe]=it,J[Ve]=Ee,Fe=Ve):(J[Fe]=Pe,J[De]=Ee,Fe=De);else if(Ve<ke&&0>d(it,Ee))J[Fe]=it,J[Ve]=Ee,Fe=Ve;else break e}}return ue}function d(J,ue){var Ee=J.sortIndex-ue.sortIndex;return Ee!==0?Ee:J.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var f=Date,v=f.now();e.unstable_now=function(){return f.now()-v}}var b=[],_=[],w=1,E=null,N=3,I=!1,R=!1,O=!1,P=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(J){for(var ue=s(_);ue!==null;){if(ue.callback===null)o(_);else if(ue.startTime<=J)o(_),ue.sortIndex=ue.expirationTime,n(b,ue);else break;ue=s(_)}}function B(J){if(O=!1,U(J),!R)if(s(b)!==null)R=!0,re(G);else{var ue=s(_);ue!==null&&he(B,ue.startTime-J)}}function G(J,ue){R=!1,O&&(O=!1,M(X),X=-1),I=!0;var Ee=N;try{for(U(ue),E=s(b);E!==null&&(!(E.expirationTime>ue)||J&&!Q());){var Fe=E.callback;if(typeof Fe=="function"){E.callback=null,N=E.priorityLevel;var ke=Fe(E.expirationTime<=ue);ue=e.unstable_now(),typeof ke=="function"?E.callback=ke:E===s(b)&&o(b),U(ue)}else o(b);E=s(b)}if(E!==null)var Ge=!0;else{var De=s(_);De!==null&&he(B,De.startTime-ue),Ge=!1}return Ge}finally{E=null,N=Ee,I=!1}}var $=!1,q=null,X=-1,ee=5,ce=-1;function Q(){return!(e.unstable_now()-ce<ee)}function ae(){if(q!==null){var J=e.unstable_now();ce=J;var ue=!0;try{ue=q(!0,J)}finally{ue?ve():($=!1,q=null)}}else $=!1}var ve;if(typeof D=="function")ve=function(){D(ae)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,fe=le.port2;le.port1.onmessage=ae,ve=function(){fe.postMessage(null)}}else ve=function(){P(ae,0)};function re(J){q=J,$||($=!0,ve())}function he(J,ue){X=P(function(){J(e.unstable_now())},ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){R||I||(R=!0,re(G))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return N},e.unstable_getFirstCallbackNode=function(){return s(b)},e.unstable_next=function(J){switch(N){case 1:case 2:case 3:var ue=3;break;default:ue=N}var Ee=N;N=ue;try{return J()}finally{N=Ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,ue){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var Ee=N;N=J;try{return ue()}finally{N=Ee}},e.unstable_scheduleCallback=function(J,ue,Ee){var Fe=e.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?Fe+Ee:Fe):Ee=Fe,J){case 1:var ke=-1;break;case 2:ke=250;break;case 5:ke=1073741823;break;case 4:ke=1e4;break;default:ke=5e3}return ke=Ee+ke,J={id:w++,callback:ue,priorityLevel:J,startTime:Ee,expirationTime:ke,sortIndex:-1},Ee>Fe?(J.sortIndex=Ee,n(_,J),s(b)===null&&J===s(_)&&(O?(M(X),X=-1):O=!0,he(B,Ee-Fe))):(J.sortIndex=ke,n(b,J),R||I||(R=!0,re(G))),J},e.unstable_shouldYield=Q,e.unstable_wrapCallback=function(J){var ue=N;return function(){var Ee=N;N=ue;try{return J.apply(this,arguments)}finally{N=Ee}}}})(Bq);Vq.exports=Bq;var Mxe=Vq.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uxe=z,Ma=Mxe;function ot(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Gq=new Set,qv={};function sp(e,n){Ef(e,n),Ef(e+"Capture",n)}function Ef(e,n){for(qv[e]=n,e=0;e<n.length;e++)Gq.add(n[e])}var Gl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),XO=Object.prototype.hasOwnProperty,Fxe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rz={},Az={};function Vxe(e){return XO.call(Az,e)?!0:XO.call(Rz,e)?!1:Fxe.test(e)?Az[e]=!0:(Rz[e]=!0,!1)}function Bxe(e,n,s,o){if(s!==null&&s.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return o?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Gxe(e,n,s,o){if(n===null||typeof n>"u"||Bxe(e,n,s,o))return!0;if(o)return!1;if(s!==null)switch(s.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Ms(e,n,s,o,d,h,f){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=o,this.attributeNamespace=d,this.mustUseProperty=s,this.propertyName=e,this.type=n,this.sanitizeURL=h,this.removeEmptyString=f}var ss={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ss[e]=new Ms(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];ss[n]=new Ms(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ss[e]=new Ms(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ss[e]=new Ms(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ss[e]=new Ms(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ss[e]=new Ms(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ss[e]=new Ms(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ss[e]=new Ms(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ss[e]=new Ms(e,5,!1,e.toLowerCase(),null,!1,!1)});var Hk=/[\-:]([a-z])/g;function Kk(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(Hk,Kk);ss[n]=new Ms(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(Hk,Kk);ss[n]=new Ms(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(Hk,Kk);ss[n]=new Ms(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ss[e]=new Ms(e,1,!1,e.toLowerCase(),null,!1,!1)});ss.xlinkHref=new Ms("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ss[e]=new Ms(e,1,!1,e.toLowerCase(),null,!0,!0)});function Yk(e,n,s,o){var d=ss.hasOwnProperty(n)?ss[n]:null;(d!==null?d.type!==0:o||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(Gxe(n,s,d,o)&&(s=null),o||d===null?Vxe(n)&&(s===null?e.removeAttribute(n):e.setAttribute(n,""+s)):d.mustUseProperty?e[d.propertyName]=s===null?d.type===3?!1:"":s:(n=d.attributeName,o=d.attributeNamespace,s===null?e.removeAttribute(n):(d=d.type,s=d===3||d===4&&s===!0?"":""+s,o?e.setAttributeNS(o,n,s):e.setAttribute(n,s))))}var Ql=Uxe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xE=Symbol.for("react.element"),Km=Symbol.for("react.portal"),Ym=Symbol.for("react.fragment"),qk=Symbol.for("react.strict_mode"),JO=Symbol.for("react.profiler"),Wq=Symbol.for("react.provider"),$q=Symbol.for("react.context"),Xk=Symbol.for("react.forward_ref"),QO=Symbol.for("react.suspense"),ZO=Symbol.for("react.suspense_list"),Jk=Symbol.for("react.memo"),Ud=Symbol.for("react.lazy"),zq=Symbol.for("react.offscreen"),Iz=Symbol.iterator;function av(e){return e===null||typeof e!="object"?null:(e=Iz&&e[Iz]||e["@@iterator"],typeof e=="function"?e:null)}var Xr=Object.assign,LI;function Av(e){if(LI===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);LI=n&&n[1]||""}return`
`+LI+e}var MI=!1;function UI(e,n){if(!e||MI)return"";MI=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(_){var o=_}Reflect.construct(e,[],n)}else{try{n.call()}catch(_){o=_}e.call(n.prototype)}else{try{throw Error()}catch(_){o=_}e()}}catch(_){if(_&&o&&typeof _.stack=="string"){for(var d=_.stack.split(`
`),h=o.stack.split(`
`),f=d.length-1,v=h.length-1;1<=f&&0<=v&&d[f]!==h[v];)v--;for(;1<=f&&0<=v;f--,v--)if(d[f]!==h[v]){if(f!==1||v!==1)do if(f--,v--,0>v||d[f]!==h[v]){var b=`
`+d[f].replace(" at new "," at ");return e.displayName&&b.includes("<anonymous>")&&(b=b.replace("<anonymous>",e.displayName)),b}while(1<=f&&0<=v);break}}}finally{MI=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Av(e):""}function Wxe(e){switch(e.tag){case 5:return Av(e.type);case 16:return Av("Lazy");case 13:return Av("Suspense");case 19:return Av("SuspenseList");case 0:case 2:case 15:return e=UI(e.type,!1),e;case 11:return e=UI(e.type.render,!1),e;case 1:return e=UI(e.type,!0),e;default:return""}}function e2(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ym:return"Fragment";case Km:return"Portal";case JO:return"Profiler";case qk:return"StrictMode";case QO:return"Suspense";case ZO:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case $q:return(e.displayName||"Context")+".Consumer";case Wq:return(e._context.displayName||"Context")+".Provider";case Xk:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Jk:return n=e.displayName||null,n!==null?n:e2(e.type)||"Memo";case Ud:n=e._payload,e=e._init;try{return e2(e(n))}catch{}}return null}function $xe(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return e2(n);case 8:return n===qk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function hu(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Hq(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function zxe(e){var n=Hq(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),o=""+e[n];if(!e.hasOwnProperty(n)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var d=s.get,h=s.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return d.call(this)},set:function(f){o=""+f,h.call(this,f)}}),Object.defineProperty(e,n,{enumerable:s.enumerable}),{getValue:function(){return o},setValue:function(f){o=""+f},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function _E(e){e._valueTracker||(e._valueTracker=zxe(e))}function Kq(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var s=n.getValue(),o="";return e&&(o=Hq(e)?e.checked?"true":"false":e.value),e=o,e!==s?(n.setValue(e),!0):!1}function Ew(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function t2(e,n){var s=n.checked;return Xr({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Oz(e,n){var s=n.defaultValue==null?"":n.defaultValue,o=n.checked!=null?n.checked:n.defaultChecked;s=hu(n.value!=null?n.value:s),e._wrapperState={initialChecked:o,initialValue:s,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function Yq(e,n){n=n.checked,n!=null&&Yk(e,"checked",n,!1)}function n2(e,n){Yq(e,n);var s=hu(n.value),o=n.type;if(s!=null)o==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?r2(e,n.type,s):n.hasOwnProperty("defaultValue")&&r2(e,n.type,hu(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function Pz(e,n,s){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var o=n.type;if(!(o!=="submit"&&o!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,s||n===e.value||(e.value=n),e.defaultValue=n}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function r2(e,n,s){(n!=="number"||Ew(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var Iv=Array.isArray;function lf(e,n,s,o){if(e=e.options,n){n={};for(var d=0;d<s.length;d++)n["$"+s[d]]=!0;for(s=0;s<e.length;s++)d=n.hasOwnProperty("$"+e[s].value),e[s].selected!==d&&(e[s].selected=d),d&&o&&(e[s].defaultSelected=!0)}else{for(s=""+hu(s),n=null,d=0;d<e.length;d++){if(e[d].value===s){e[d].selected=!0,o&&(e[d].defaultSelected=!0);return}n!==null||e[d].disabled||(n=e[d])}n!==null&&(n.selected=!0)}}function i2(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(ot(91));return Xr({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function kz(e,n){var s=n.value;if(s==null){if(s=n.children,n=n.defaultValue,s!=null){if(n!=null)throw Error(ot(92));if(Iv(s)){if(1<s.length)throw Error(ot(93));s=s[0]}n=s}n==null&&(n=""),s=n}e._wrapperState={initialValue:hu(s)}}function qq(e,n){var s=hu(n.value),o=hu(n.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),n.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),o!=null&&(e.defaultValue=""+o)}function jz(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function Xq(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function s2(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?Xq(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var EE,Jq=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,s,o,d){MSApp.execUnsafeLocalFunction(function(){return e(n,s,o,d)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(EE=EE||document.createElement("div"),EE.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=EE.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Xv(e,n){if(n){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=n;return}}e.textContent=n}var Dv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Hxe=["Webkit","ms","Moz","O"];Object.keys(Dv).forEach(function(e){Hxe.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),Dv[n]=Dv[e]})});function Qq(e,n,s){return n==null||typeof n=="boolean"||n===""?"":s||typeof n!="number"||n===0||Dv.hasOwnProperty(e)&&Dv[e]?(""+n).trim():n+"px"}function Zq(e,n){e=e.style;for(var s in n)if(n.hasOwnProperty(s)){var o=s.indexOf("--")===0,d=Qq(s,n[s],o);s==="float"&&(s="cssFloat"),o?e.setProperty(s,d):e[s]=d}}var Kxe=Xr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function a2(e,n){if(n){if(Kxe[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(ot(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(ot(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(ot(61))}if(n.style!=null&&typeof n.style!="object")throw Error(ot(62))}}function o2(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var c2=null;function Qk(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var l2=null,df=null,uf=null;function Dz(e){if(e=tb(e)){if(typeof l2!="function")throw Error(ot(280));var n=e.stateNode;n&&(n=oT(n),l2(e.stateNode,e.type,n))}}function eX(e){df?uf?uf.push(e):uf=[e]:df=e}function tX(){if(df){var e=df,n=uf;if(uf=df=null,Dz(e),n)for(e=0;e<n.length;e++)Dz(n[e])}}function nX(e,n){return e(n)}function rX(){}var FI=!1;function iX(e,n,s){if(FI)return e(n,s);FI=!0;try{return nX(e,n,s)}finally{FI=!1,(df!==null||uf!==null)&&(rX(),tX())}}function Jv(e,n){var s=e.stateNode;if(s===null)return null;var o=oT(s);if(o===null)return null;s=o[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(ot(231,n,typeof s));return s}var d2=!1;if(Gl)try{var ov={};Object.defineProperty(ov,"passive",{get:function(){d2=!0}}),window.addEventListener("test",ov,ov),window.removeEventListener("test",ov,ov)}catch{d2=!1}function Yxe(e,n,s,o,d,h,f,v,b){var _=Array.prototype.slice.call(arguments,3);try{n.apply(s,_)}catch(w){this.onError(w)}}var Lv=!1,ww=null,Sw=!1,u2=null,qxe={onError:function(e){Lv=!0,ww=e}};function Xxe(e,n,s,o,d,h,f,v,b){Lv=!1,ww=null,Yxe.apply(qxe,arguments)}function Jxe(e,n,s,o,d,h,f,v,b){if(Xxe.apply(this,arguments),Lv){if(Lv){var _=ww;Lv=!1,ww=null}else throw Error(ot(198));Sw||(Sw=!0,u2=_)}}function ap(e){var n=e,s=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(s=n.return),e=n.return;while(e)}return n.tag===3?s:null}function sX(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function Lz(e){if(ap(e)!==e)throw Error(ot(188))}function Qxe(e){var n=e.alternate;if(!n){if(n=ap(e),n===null)throw Error(ot(188));return n!==e?null:e}for(var s=e,o=n;;){var d=s.return;if(d===null)break;var h=d.alternate;if(h===null){if(o=d.return,o!==null){s=o;continue}break}if(d.child===h.child){for(h=d.child;h;){if(h===s)return Lz(d),e;if(h===o)return Lz(d),n;h=h.sibling}throw Error(ot(188))}if(s.return!==o.return)s=d,o=h;else{for(var f=!1,v=d.child;v;){if(v===s){f=!0,s=d,o=h;break}if(v===o){f=!0,o=d,s=h;break}v=v.sibling}if(!f){for(v=h.child;v;){if(v===s){f=!0,s=h,o=d;break}if(v===o){f=!0,o=h,s=d;break}v=v.sibling}if(!f)throw Error(ot(189))}}if(s.alternate!==o)throw Error(ot(190))}if(s.tag!==3)throw Error(ot(188));return s.stateNode.current===s?e:n}function aX(e){return e=Qxe(e),e!==null?oX(e):null}function oX(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=oX(e);if(n!==null)return n;e=e.sibling}return null}var cX=Ma.unstable_scheduleCallback,Mz=Ma.unstable_cancelCallback,Zxe=Ma.unstable_shouldYield,e_e=Ma.unstable_requestPaint,ci=Ma.unstable_now,t_e=Ma.unstable_getCurrentPriorityLevel,Zk=Ma.unstable_ImmediatePriority,lX=Ma.unstable_UserBlockingPriority,Tw=Ma.unstable_NormalPriority,n_e=Ma.unstable_LowPriority,dX=Ma.unstable_IdlePriority,rT=null,Xc=null;function r_e(e){if(Xc&&typeof Xc.onCommitFiberRoot=="function")try{Xc.onCommitFiberRoot(rT,e,void 0,(e.current.flags&128)===128)}catch{}}var uc=Math.clz32?Math.clz32:a_e,i_e=Math.log,s_e=Math.LN2;function a_e(e){return e>>>=0,e===0?32:31-(i_e(e)/s_e|0)|0}var wE=64,SE=4194304;function Ov(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Nw(e,n){var s=e.pendingLanes;if(s===0)return 0;var o=0,d=e.suspendedLanes,h=e.pingedLanes,f=s&268435455;if(f!==0){var v=f&~d;v!==0?o=Ov(v):(h&=f,h!==0&&(o=Ov(h)))}else f=s&~d,f!==0?o=Ov(f):h!==0&&(o=Ov(h));if(o===0)return 0;if(n!==0&&n!==o&&!(n&d)&&(d=o&-o,h=n&-n,d>=h||d===16&&(h&4194240)!==0))return n;if(o&4&&(o|=s&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=o;0<n;)s=31-uc(n),d=1<<s,o|=e[s],n&=~d;return o}function o_e(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function c_e(e,n){for(var s=e.suspendedLanes,o=e.pingedLanes,d=e.expirationTimes,h=e.pendingLanes;0<h;){var f=31-uc(h),v=1<<f,b=d[f];b===-1?(!(v&s)||v&o)&&(d[f]=o_e(v,n)):b<=n&&(e.expiredLanes|=v),h&=~v}}function h2(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function uX(){var e=wE;return wE<<=1,!(wE&4194240)&&(wE=64),e}function VI(e){for(var n=[],s=0;31>s;s++)n.push(e);return n}function Zy(e,n,s){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-uc(n),e[n]=s}function l_e(e,n){var s=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<s;){var d=31-uc(s),h=1<<d;n[d]=0,o[d]=-1,e[d]=-1,s&=~h}}function ej(e,n){var s=e.entangledLanes|=n;for(e=e.entanglements;s;){var o=31-uc(s),d=1<<o;d&n|e[o]&n&&(e[o]|=n),s&=~d}}var ir=0;function hX(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var pX,tj,mX,fX,gX,p2=!1,TE=[],Zd=null,eu=null,tu=null,Qv=new Map,Zv=new Map,Bd=[],d_e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uz(e,n){switch(e){case"focusin":case"focusout":Zd=null;break;case"dragenter":case"dragleave":eu=null;break;case"mouseover":case"mouseout":tu=null;break;case"pointerover":case"pointerout":Qv.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zv.delete(n.pointerId)}}function cv(e,n,s,o,d,h){return e===null||e.nativeEvent!==h?(e={blockedOn:n,domEventName:s,eventSystemFlags:o,nativeEvent:h,targetContainers:[d]},n!==null&&(n=tb(n),n!==null&&tj(n)),e):(e.eventSystemFlags|=o,n=e.targetContainers,d!==null&&n.indexOf(d)===-1&&n.push(d),e)}function u_e(e,n,s,o,d){switch(n){case"focusin":return Zd=cv(Zd,e,n,s,o,d),!0;case"dragenter":return eu=cv(eu,e,n,s,o,d),!0;case"mouseover":return tu=cv(tu,e,n,s,o,d),!0;case"pointerover":var h=d.pointerId;return Qv.set(h,cv(Qv.get(h)||null,e,n,s,o,d)),!0;case"gotpointercapture":return h=d.pointerId,Zv.set(h,cv(Zv.get(h)||null,e,n,s,o,d)),!0}return!1}function vX(e){var n=Ih(e.target);if(n!==null){var s=ap(n);if(s!==null){if(n=s.tag,n===13){if(n=sX(s),n!==null){e.blockedOn=n,gX(e.priority,function(){mX(s)});return}}else if(n===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function iw(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var s=m2(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var o=new s.constructor(s.type,s);c2=o,s.target.dispatchEvent(o),c2=null}else return n=tb(s),n!==null&&tj(n),e.blockedOn=s,!1;n.shift()}return!0}function Fz(e,n,s){iw(e)&&s.delete(n)}function h_e(){p2=!1,Zd!==null&&iw(Zd)&&(Zd=null),eu!==null&&iw(eu)&&(eu=null),tu!==null&&iw(tu)&&(tu=null),Qv.forEach(Fz),Zv.forEach(Fz)}function lv(e,n){e.blockedOn===n&&(e.blockedOn=null,p2||(p2=!0,Ma.unstable_scheduleCallback(Ma.unstable_NormalPriority,h_e)))}function ey(e){function n(d){return lv(d,e)}if(0<TE.length){lv(TE[0],e);for(var s=1;s<TE.length;s++){var o=TE[s];o.blockedOn===e&&(o.blockedOn=null)}}for(Zd!==null&&lv(Zd,e),eu!==null&&lv(eu,e),tu!==null&&lv(tu,e),Qv.forEach(n),Zv.forEach(n),s=0;s<Bd.length;s++)o=Bd[s],o.blockedOn===e&&(o.blockedOn=null);for(;0<Bd.length&&(s=Bd[0],s.blockedOn===null);)vX(s),s.blockedOn===null&&Bd.shift()}var hf=Ql.ReactCurrentBatchConfig,Cw=!0;function p_e(e,n,s,o){var d=ir,h=hf.transition;hf.transition=null;try{ir=1,nj(e,n,s,o)}finally{ir=d,hf.transition=h}}function m_e(e,n,s,o){var d=ir,h=hf.transition;hf.transition=null;try{ir=4,nj(e,n,s,o)}finally{ir=d,hf.transition=h}}function nj(e,n,s,o){if(Cw){var d=m2(e,n,s,o);if(d===null)XI(e,n,o,Rw,s),Uz(e,o);else if(u_e(d,e,n,s,o))o.stopPropagation();else if(Uz(e,o),n&4&&-1<d_e.indexOf(e)){for(;d!==null;){var h=tb(d);if(h!==null&&pX(h),h=m2(e,n,s,o),h===null&&XI(e,n,o,Rw,s),h===d)break;d=h}d!==null&&o.stopPropagation()}else XI(e,n,o,null,s)}}var Rw=null;function m2(e,n,s,o){if(Rw=null,e=Qk(o),e=Ih(e),e!==null)if(n=ap(e),n===null)e=null;else if(s=n.tag,s===13){if(e=sX(n),e!==null)return e;e=null}else if(s===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Rw=e,null}function yX(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(t_e()){case Zk:return 1;case lX:return 4;case Tw:case n_e:return 16;case dX:return 536870912;default:return 16}default:return 16}}var Kd=null,rj=null,sw=null;function bX(){if(sw)return sw;var e,n=rj,s=n.length,o,d="value"in Kd?Kd.value:Kd.textContent,h=d.length;for(e=0;e<s&&n[e]===d[e];e++);var f=s-e;for(o=1;o<=f&&n[s-o]===d[h-o];o++);return sw=d.slice(e,1<o?1-o:void 0)}function aw(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function NE(){return!0}function Vz(){return!1}function Fa(e){function n(s,o,d,h,f){this._reactName=s,this._targetInst=d,this.type=o,this.nativeEvent=h,this.target=f,this.currentTarget=null;for(var v in e)e.hasOwnProperty(v)&&(s=e[v],this[v]=s?s(h):h[v]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?NE:Vz,this.isPropagationStopped=Vz,this}return Xr(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=NE)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=NE)},persist:function(){},isPersistent:NE}),n}var ag={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ij=Fa(ag),eb=Xr({},ag,{view:0,detail:0}),f_e=Fa(eb),BI,GI,dv,iT=Xr({},eb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sj,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==dv&&(dv&&e.type==="mousemove"?(BI=e.screenX-dv.screenX,GI=e.screenY-dv.screenY):GI=BI=0,dv=e),BI)},movementY:function(e){return"movementY"in e?e.movementY:GI}}),Bz=Fa(iT),g_e=Xr({},iT,{dataTransfer:0}),v_e=Fa(g_e),y_e=Xr({},eb,{relatedTarget:0}),WI=Fa(y_e),b_e=Xr({},ag,{animationName:0,elapsedTime:0,pseudoElement:0}),x_e=Fa(b_e),__e=Xr({},ag,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),E_e=Fa(__e),w_e=Xr({},ag,{data:0}),Gz=Fa(w_e),S_e={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},T_e={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},N_e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function C_e(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=N_e[e])?!!n[e]:!1}function sj(){return C_e}var R_e=Xr({},eb,{key:function(e){if(e.key){var n=S_e[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=aw(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?T_e[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sj,charCode:function(e){return e.type==="keypress"?aw(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?aw(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),A_e=Fa(R_e),I_e=Xr({},iT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wz=Fa(I_e),O_e=Xr({},eb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sj}),P_e=Fa(O_e),k_e=Xr({},ag,{propertyName:0,elapsedTime:0,pseudoElement:0}),j_e=Fa(k_e),D_e=Xr({},iT,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),L_e=Fa(D_e),M_e=[9,13,27,32],aj=Gl&&"CompositionEvent"in window,Mv=null;Gl&&"documentMode"in document&&(Mv=document.documentMode);var U_e=Gl&&"TextEvent"in window&&!Mv,xX=Gl&&(!aj||Mv&&8<Mv&&11>=Mv),$z=" ",zz=!1;function _X(e,n){switch(e){case"keyup":return M_e.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EX(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var qm=!1;function F_e(e,n){switch(e){case"compositionend":return EX(n);case"keypress":return n.which!==32?null:(zz=!0,$z);case"textInput":return e=n.data,e===$z&&zz?null:e;default:return null}}function V_e(e,n){if(qm)return e==="compositionend"||!aj&&_X(e,n)?(e=bX(),sw=rj=Kd=null,qm=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return xX&&n.locale!=="ko"?null:n.data;default:return null}}var B_e={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hz(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!B_e[e.type]:n==="textarea"}function wX(e,n,s,o){eX(o),n=Aw(n,"onChange"),0<n.length&&(s=new ij("onChange","change",null,s,o),e.push({event:s,listeners:n}))}var Uv=null,ty=null;function G_e(e){jX(e,0)}function sT(e){var n=Qm(e);if(Kq(n))return e}function W_e(e,n){if(e==="change")return n}var SX=!1;if(Gl){var $I;if(Gl){var zI="oninput"in document;if(!zI){var Kz=document.createElement("div");Kz.setAttribute("oninput","return;"),zI=typeof Kz.oninput=="function"}$I=zI}else $I=!1;SX=$I&&(!document.documentMode||9<document.documentMode)}function Yz(){Uv&&(Uv.detachEvent("onpropertychange",TX),ty=Uv=null)}function TX(e){if(e.propertyName==="value"&&sT(ty)){var n=[];wX(n,ty,e,Qk(e)),iX(G_e,n)}}function $_e(e,n,s){e==="focusin"?(Yz(),Uv=n,ty=s,Uv.attachEvent("onpropertychange",TX)):e==="focusout"&&Yz()}function z_e(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return sT(ty)}function H_e(e,n){if(e==="click")return sT(n)}function K_e(e,n){if(e==="input"||e==="change")return sT(n)}function Y_e(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var pc=typeof Object.is=="function"?Object.is:Y_e;function ny(e,n){if(pc(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var s=Object.keys(e),o=Object.keys(n);if(s.length!==o.length)return!1;for(o=0;o<s.length;o++){var d=s[o];if(!XO.call(n,d)||!pc(e[d],n[d]))return!1}return!0}function qz(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xz(e,n){var s=qz(e);e=0;for(var o;s;){if(s.nodeType===3){if(o=e+s.textContent.length,e<=n&&o>=n)return{node:s,offset:n-e};e=o}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=qz(s)}}function NX(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?NX(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function CX(){for(var e=window,n=Ew();n instanceof e.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)e=n.contentWindow;else break;n=Ew(e.document)}return n}function oj(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function q_e(e){var n=CX(),s=e.focusedElem,o=e.selectionRange;if(n!==s&&s&&s.ownerDocument&&NX(s.ownerDocument.documentElement,s)){if(o!==null&&oj(s)){if(n=o.start,e=o.end,e===void 0&&(e=n),"selectionStart"in s)s.selectionStart=n,s.selectionEnd=Math.min(e,s.value.length);else if(e=(n=s.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var d=s.textContent.length,h=Math.min(o.start,d);o=o.end===void 0?h:Math.min(o.end,d),!e.extend&&h>o&&(d=o,o=h,h=d),d=Xz(s,h);var f=Xz(s,o);d&&f&&(e.rangeCount!==1||e.anchorNode!==d.node||e.anchorOffset!==d.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(n=n.createRange(),n.setStart(d.node,d.offset),e.removeAllRanges(),h>o?(e.addRange(n),e.extend(f.node,f.offset)):(n.setEnd(f.node,f.offset),e.addRange(n)))}}for(n=[],e=s;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<n.length;s++)e=n[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var X_e=Gl&&"documentMode"in document&&11>=document.documentMode,Xm=null,f2=null,Fv=null,g2=!1;function Jz(e,n,s){var o=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;g2||Xm==null||Xm!==Ew(o)||(o=Xm,"selectionStart"in o&&oj(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Fv&&ny(Fv,o)||(Fv=o,o=Aw(f2,"onSelect"),0<o.length&&(n=new ij("onSelect","select",null,n,s),e.push({event:n,listeners:o}),n.target=Xm)))}function CE(e,n){var s={};return s[e.toLowerCase()]=n.toLowerCase(),s["Webkit"+e]="webkit"+n,s["Moz"+e]="moz"+n,s}var Jm={animationend:CE("Animation","AnimationEnd"),animationiteration:CE("Animation","AnimationIteration"),animationstart:CE("Animation","AnimationStart"),transitionend:CE("Transition","TransitionEnd")},HI={},RX={};Gl&&(RX=document.createElement("div").style,"AnimationEvent"in window||(delete Jm.animationend.animation,delete Jm.animationiteration.animation,delete Jm.animationstart.animation),"TransitionEvent"in window||delete Jm.transitionend.transition);function aT(e){if(HI[e])return HI[e];if(!Jm[e])return e;var n=Jm[e],s;for(s in n)if(n.hasOwnProperty(s)&&s in RX)return HI[e]=n[s];return e}var AX=aT("animationend"),IX=aT("animationiteration"),OX=aT("animationstart"),PX=aT("transitionend"),kX=new Map,Qz="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gu(e,n){kX.set(e,n),sp(n,[e])}for(var KI=0;KI<Qz.length;KI++){var YI=Qz[KI],J_e=YI.toLowerCase(),Q_e=YI[0].toUpperCase()+YI.slice(1);gu(J_e,"on"+Q_e)}gu(AX,"onAnimationEnd");gu(IX,"onAnimationIteration");gu(OX,"onAnimationStart");gu("dblclick","onDoubleClick");gu("focusin","onFocus");gu("focusout","onBlur");gu(PX,"onTransitionEnd");Ef("onMouseEnter",["mouseout","mouseover"]);Ef("onMouseLeave",["mouseout","mouseover"]);Ef("onPointerEnter",["pointerout","pointerover"]);Ef("onPointerLeave",["pointerout","pointerover"]);sp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sp("onBeforeInput",["compositionend","keypress","textInput","paste"]);sp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z_e=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pv));function Zz(e,n,s){var o=e.type||"unknown-event";e.currentTarget=s,Jxe(o,n,void 0,e),e.currentTarget=null}function jX(e,n){n=(n&4)!==0;for(var s=0;s<e.length;s++){var o=e[s],d=o.event;o=o.listeners;e:{var h=void 0;if(n)for(var f=o.length-1;0<=f;f--){var v=o[f],b=v.instance,_=v.currentTarget;if(v=v.listener,b!==h&&d.isPropagationStopped())break e;Zz(d,v,_),h=b}else for(f=0;f<o.length;f++){if(v=o[f],b=v.instance,_=v.currentTarget,v=v.listener,b!==h&&d.isPropagationStopped())break e;Zz(d,v,_),h=b}}}if(Sw)throw e=u2,Sw=!1,u2=null,e}function Cr(e,n){var s=n[_2];s===void 0&&(s=n[_2]=new Set);var o=e+"__bubble";s.has(o)||(DX(n,e,2,!1),s.add(o))}function qI(e,n,s){var o=0;n&&(o|=4),DX(s,e,o,n)}var RE="_reactListening"+Math.random().toString(36).slice(2);function ry(e){if(!e[RE]){e[RE]=!0,Gq.forEach(function(s){s!=="selectionchange"&&(Z_e.has(s)||qI(s,!1,e),qI(s,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[RE]||(n[RE]=!0,qI("selectionchange",!1,n))}}function DX(e,n,s,o){switch(yX(n)){case 1:var d=p_e;break;case 4:d=m_e;break;default:d=nj}s=d.bind(null,n,s,e),d=void 0,!d2||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(d=!0),o?d!==void 0?e.addEventListener(n,s,{capture:!0,passive:d}):e.addEventListener(n,s,!0):d!==void 0?e.addEventListener(n,s,{passive:d}):e.addEventListener(n,s,!1)}function XI(e,n,s,o,d){var h=o;if(!(n&1)&&!(n&2)&&o!==null)e:for(;;){if(o===null)return;var f=o.tag;if(f===3||f===4){var v=o.stateNode.containerInfo;if(v===d||v.nodeType===8&&v.parentNode===d)break;if(f===4)for(f=o.return;f!==null;){var b=f.tag;if((b===3||b===4)&&(b=f.stateNode.containerInfo,b===d||b.nodeType===8&&b.parentNode===d))return;f=f.return}for(;v!==null;){if(f=Ih(v),f===null)return;if(b=f.tag,b===5||b===6){o=h=f;continue e}v=v.parentNode}}o=o.return}iX(function(){var _=h,w=Qk(s),E=[];e:{var N=kX.get(e);if(N!==void 0){var I=ij,R=e;switch(e){case"keypress":if(aw(s)===0)break e;case"keydown":case"keyup":I=A_e;break;case"focusin":R="focus",I=WI;break;case"focusout":R="blur",I=WI;break;case"beforeblur":case"afterblur":I=WI;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=Bz;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=v_e;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=P_e;break;case AX:case IX:case OX:I=x_e;break;case PX:I=j_e;break;case"scroll":I=f_e;break;case"wheel":I=L_e;break;case"copy":case"cut":case"paste":I=E_e;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=Wz}var O=(n&4)!==0,P=!O&&e==="scroll",M=O?N!==null?N+"Capture":null:N;O=[];for(var D=_,U;D!==null;){U=D;var B=U.stateNode;if(U.tag===5&&B!==null&&(U=B,M!==null&&(B=Jv(D,M),B!=null&&O.push(iy(D,B,U)))),P)break;D=D.return}0<O.length&&(N=new I(N,R,null,s,w),E.push({event:N,listeners:O}))}}if(!(n&7)){e:{if(N=e==="mouseover"||e==="pointerover",I=e==="mouseout"||e==="pointerout",N&&s!==c2&&(R=s.relatedTarget||s.fromElement)&&(Ih(R)||R[Wl]))break e;if((I||N)&&(N=w.window===w?w:(N=w.ownerDocument)?N.defaultView||N.parentWindow:window,I?(R=s.relatedTarget||s.toElement,I=_,R=R?Ih(R):null,R!==null&&(P=ap(R),R!==P||R.tag!==5&&R.tag!==6)&&(R=null)):(I=null,R=_),I!==R)){if(O=Bz,B="onMouseLeave",M="onMouseEnter",D="mouse",(e==="pointerout"||e==="pointerover")&&(O=Wz,B="onPointerLeave",M="onPointerEnter",D="pointer"),P=I==null?N:Qm(I),U=R==null?N:Qm(R),N=new O(B,D+"leave",I,s,w),N.target=P,N.relatedTarget=U,B=null,Ih(w)===_&&(O=new O(M,D+"enter",R,s,w),O.target=U,O.relatedTarget=P,B=O),P=B,I&&R)t:{for(O=I,M=R,D=0,U=O;U;U=Um(U))D++;for(U=0,B=M;B;B=Um(B))U++;for(;0<D-U;)O=Um(O),D--;for(;0<U-D;)M=Um(M),U--;for(;D--;){if(O===M||M!==null&&O===M.alternate)break t;O=Um(O),M=Um(M)}O=null}else O=null;I!==null&&e7(E,N,I,O,!1),R!==null&&P!==null&&e7(E,P,R,O,!0)}}e:{if(N=_?Qm(_):window,I=N.nodeName&&N.nodeName.toLowerCase(),I==="select"||I==="input"&&N.type==="file")var G=W_e;else if(Hz(N))if(SX)G=K_e;else{G=z_e;var $=$_e}else(I=N.nodeName)&&I.toLowerCase()==="input"&&(N.type==="checkbox"||N.type==="radio")&&(G=H_e);if(G&&(G=G(e,_))){wX(E,G,s,w);break e}$&&$(e,N,_),e==="focusout"&&($=N._wrapperState)&&$.controlled&&N.type==="number"&&r2(N,"number",N.value)}switch($=_?Qm(_):window,e){case"focusin":(Hz($)||$.contentEditable==="true")&&(Xm=$,f2=_,Fv=null);break;case"focusout":Fv=f2=Xm=null;break;case"mousedown":g2=!0;break;case"contextmenu":case"mouseup":case"dragend":g2=!1,Jz(E,s,w);break;case"selectionchange":if(X_e)break;case"keydown":case"keyup":Jz(E,s,w)}var q;if(aj)e:{switch(e){case"compositionstart":var X="onCompositionStart";break e;case"compositionend":X="onCompositionEnd";break e;case"compositionupdate":X="onCompositionUpdate";break e}X=void 0}else qm?_X(e,s)&&(X="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(X="onCompositionStart");X&&(xX&&s.locale!=="ko"&&(qm||X!=="onCompositionStart"?X==="onCompositionEnd"&&qm&&(q=bX()):(Kd=w,rj="value"in Kd?Kd.value:Kd.textContent,qm=!0)),$=Aw(_,X),0<$.length&&(X=new Gz(X,e,null,s,w),E.push({event:X,listeners:$}),q?X.data=q:(q=EX(s),q!==null&&(X.data=q)))),(q=U_e?F_e(e,s):V_e(e,s))&&(_=Aw(_,"onBeforeInput"),0<_.length&&(w=new Gz("onBeforeInput","beforeinput",null,s,w),E.push({event:w,listeners:_}),w.data=q))}jX(E,n)})}function iy(e,n,s){return{instance:e,listener:n,currentTarget:s}}function Aw(e,n){for(var s=n+"Capture",o=[];e!==null;){var d=e,h=d.stateNode;d.tag===5&&h!==null&&(d=h,h=Jv(e,s),h!=null&&o.unshift(iy(e,h,d)),h=Jv(e,n),h!=null&&o.push(iy(e,h,d))),e=e.return}return o}function Um(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function e7(e,n,s,o,d){for(var h=n._reactName,f=[];s!==null&&s!==o;){var v=s,b=v.alternate,_=v.stateNode;if(b!==null&&b===o)break;v.tag===5&&_!==null&&(v=_,d?(b=Jv(s,h),b!=null&&f.unshift(iy(s,b,v))):d||(b=Jv(s,h),b!=null&&f.push(iy(s,b,v)))),s=s.return}f.length!==0&&e.push({event:n,listeners:f})}var eEe=/\r\n?/g,tEe=/\u0000|\uFFFD/g;function t7(e){return(typeof e=="string"?e:""+e).replace(eEe,`
`).replace(tEe,"")}function AE(e,n,s){if(n=t7(n),t7(e)!==n&&s)throw Error(ot(425))}function Iw(){}var v2=null,y2=null;function b2(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var x2=typeof setTimeout=="function"?setTimeout:void 0,nEe=typeof clearTimeout=="function"?clearTimeout:void 0,n7=typeof Promise=="function"?Promise:void 0,rEe=typeof queueMicrotask=="function"?queueMicrotask:typeof n7<"u"?function(e){return n7.resolve(null).then(e).catch(iEe)}:x2;function iEe(e){setTimeout(function(){throw e})}function JI(e,n){var s=n,o=0;do{var d=s.nextSibling;if(e.removeChild(s),d&&d.nodeType===8)if(s=d.data,s==="/$"){if(o===0){e.removeChild(d),ey(n);return}o--}else s!=="$"&&s!=="$?"&&s!=="$!"||o++;s=d}while(s);ey(n)}function nu(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function r7(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return e;n--}else s==="/$"&&n++}e=e.previousSibling}return null}var og=Math.random().toString(36).slice(2),Hc="__reactFiber$"+og,sy="__reactProps$"+og,Wl="__reactContainer$"+og,_2="__reactEvents$"+og,sEe="__reactListeners$"+og,aEe="__reactHandles$"+og;function Ih(e){var n=e[Hc];if(n)return n;for(var s=e.parentNode;s;){if(n=s[Wl]||s[Hc]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(e=r7(e);e!==null;){if(s=e[Hc])return s;e=r7(e)}return n}e=s,s=e.parentNode}return null}function tb(e){return e=e[Hc]||e[Wl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Qm(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ot(33))}function oT(e){return e[sy]||null}var E2=[],Zm=-1;function vu(e){return{current:e}}function Ir(e){0>Zm||(e.current=E2[Zm],E2[Zm]=null,Zm--)}function br(e,n){Zm++,E2[Zm]=e.current,e.current=n}var pu={},ws=vu(pu),sa=vu(!1),Hh=pu;function wf(e,n){var s=e.type.contextTypes;if(!s)return pu;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===n)return o.__reactInternalMemoizedMaskedChildContext;var d={},h;for(h in s)d[h]=n[h];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=d),d}function aa(e){return e=e.childContextTypes,e!=null}function Ow(){Ir(sa),Ir(ws)}function i7(e,n,s){if(ws.current!==pu)throw Error(ot(168));br(ws,n),br(sa,s)}function LX(e,n,s){var o=e.stateNode;if(n=n.childContextTypes,typeof o.getChildContext!="function")return s;o=o.getChildContext();for(var d in o)if(!(d in n))throw Error(ot(108,$xe(e)||"Unknown",d));return Xr({},s,o)}function Pw(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||pu,Hh=ws.current,br(ws,e),br(sa,sa.current),!0}function s7(e,n,s){var o=e.stateNode;if(!o)throw Error(ot(169));s?(e=LX(e,n,Hh),o.__reactInternalMemoizedMergedChildContext=e,Ir(sa),Ir(ws),br(ws,e)):Ir(sa),br(sa,s)}var Cl=null,cT=!1,QI=!1;function MX(e){Cl===null?Cl=[e]:Cl.push(e)}function oEe(e){cT=!0,MX(e)}function yu(){if(!QI&&Cl!==null){QI=!0;var e=0,n=ir;try{var s=Cl;for(ir=1;e<s.length;e++){var o=s[e];do o=o(!0);while(o!==null)}Cl=null,cT=!1}catch(d){throw Cl!==null&&(Cl=Cl.slice(e+1)),cX(Zk,yu),d}finally{ir=n,QI=!1}}return null}var ef=[],tf=0,kw=null,jw=0,mo=[],fo=0,Kh=null,Rl=1,Al="";function wh(e,n){ef[tf++]=jw,ef[tf++]=kw,kw=e,jw=n}function UX(e,n,s){mo[fo++]=Rl,mo[fo++]=Al,mo[fo++]=Kh,Kh=e;var o=Rl;e=Al;var d=32-uc(o)-1;o&=~(1<<d),s+=1;var h=32-uc(n)+d;if(30<h){var f=d-d%5;h=(o&(1<<f)-1).toString(32),o>>=f,d-=f,Rl=1<<32-uc(n)+d|s<<d|o,Al=h+e}else Rl=1<<h|s<<d|o,Al=e}function cj(e){e.return!==null&&(wh(e,1),UX(e,1,0))}function lj(e){for(;e===kw;)kw=ef[--tf],ef[tf]=null,jw=ef[--tf],ef[tf]=null;for(;e===Kh;)Kh=mo[--fo],mo[fo]=null,Al=mo[--fo],mo[fo]=null,Rl=mo[--fo],mo[fo]=null}var Da=null,Oa=null,Ur=!1,cc=null;function FX(e,n){var s=go(5,null,null,0);s.elementType="DELETED",s.stateNode=n,s.return=e,n=e.deletions,n===null?(e.deletions=[s],e.flags|=16):n.push(s)}function a7(e,n){switch(e.tag){case 5:var s=e.type;return n=n.nodeType!==1||s.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Da=e,Oa=nu(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Da=e,Oa=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(s=Kh!==null?{id:Rl,overflow:Al}:null,e.memoizedState={dehydrated:n,treeContext:s,retryLane:1073741824},s=go(18,null,null,0),s.stateNode=n,s.return=e,e.child=s,Da=e,Oa=null,!0):!1;default:return!1}}function w2(e){return(e.mode&1)!==0&&(e.flags&128)===0}function S2(e){if(Ur){var n=Oa;if(n){var s=n;if(!a7(e,n)){if(w2(e))throw Error(ot(418));n=nu(s.nextSibling);var o=Da;n&&a7(e,n)?FX(o,s):(e.flags=e.flags&-4097|2,Ur=!1,Da=e)}}else{if(w2(e))throw Error(ot(418));e.flags=e.flags&-4097|2,Ur=!1,Da=e}}}function o7(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Da=e}function IE(e){if(e!==Da)return!1;if(!Ur)return o7(e),Ur=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!b2(e.type,e.memoizedProps)),n&&(n=Oa)){if(w2(e))throw VX(),Error(ot(418));for(;n;)FX(e,n),n=nu(n.nextSibling)}if(o7(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ot(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(n===0){Oa=nu(e.nextSibling);break e}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++}e=e.nextSibling}Oa=null}}else Oa=Da?nu(e.stateNode.nextSibling):null;return!0}function VX(){for(var e=Oa;e;)e=nu(e.nextSibling)}function Sf(){Oa=Da=null,Ur=!1}function dj(e){cc===null?cc=[e]:cc.push(e)}var cEe=Ql.ReactCurrentBatchConfig;function uv(e,n,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(ot(309));var o=s.stateNode}if(!o)throw Error(ot(147,e));var d=o,h=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===h?n.ref:(n=function(f){var v=d.refs;f===null?delete v[h]:v[h]=f},n._stringRef=h,n)}if(typeof e!="string")throw Error(ot(284));if(!s._owner)throw Error(ot(290,e))}return e}function OE(e,n){throw e=Object.prototype.toString.call(n),Error(ot(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function c7(e){var n=e._init;return n(e._payload)}function BX(e){function n(M,D){if(e){var U=M.deletions;U===null?(M.deletions=[D],M.flags|=16):U.push(D)}}function s(M,D){if(!e)return null;for(;D!==null;)n(M,D),D=D.sibling;return null}function o(M,D){for(M=new Map;D!==null;)D.key!==null?M.set(D.key,D):M.set(D.index,D),D=D.sibling;return M}function d(M,D){return M=au(M,D),M.index=0,M.sibling=null,M}function h(M,D,U){return M.index=U,e?(U=M.alternate,U!==null?(U=U.index,U<D?(M.flags|=2,D):U):(M.flags|=2,D)):(M.flags|=1048576,D)}function f(M){return e&&M.alternate===null&&(M.flags|=2),M}function v(M,D,U,B){return D===null||D.tag!==6?(D=sO(U,M.mode,B),D.return=M,D):(D=d(D,U),D.return=M,D)}function b(M,D,U,B){var G=U.type;return G===Ym?w(M,D,U.props.children,B,U.key):D!==null&&(D.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Ud&&c7(G)===D.type)?(B=d(D,U.props),B.ref=uv(M,D,U),B.return=M,B):(B=pw(U.type,U.key,U.props,null,M.mode,B),B.ref=uv(M,D,U),B.return=M,B)}function _(M,D,U,B){return D===null||D.tag!==4||D.stateNode.containerInfo!==U.containerInfo||D.stateNode.implementation!==U.implementation?(D=aO(U,M.mode,B),D.return=M,D):(D=d(D,U.children||[]),D.return=M,D)}function w(M,D,U,B,G){return D===null||D.tag!==7?(D=Bh(U,M.mode,B,G),D.return=M,D):(D=d(D,U),D.return=M,D)}function E(M,D,U){if(typeof D=="string"&&D!==""||typeof D=="number")return D=sO(""+D,M.mode,U),D.return=M,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case xE:return U=pw(D.type,D.key,D.props,null,M.mode,U),U.ref=uv(M,null,D),U.return=M,U;case Km:return D=aO(D,M.mode,U),D.return=M,D;case Ud:var B=D._init;return E(M,B(D._payload),U)}if(Iv(D)||av(D))return D=Bh(D,M.mode,U,null),D.return=M,D;OE(M,D)}return null}function N(M,D,U,B){var G=D!==null?D.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return G!==null?null:v(M,D,""+U,B);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case xE:return U.key===G?b(M,D,U,B):null;case Km:return U.key===G?_(M,D,U,B):null;case Ud:return G=U._init,N(M,D,G(U._payload),B)}if(Iv(U)||av(U))return G!==null?null:w(M,D,U,B,null);OE(M,U)}return null}function I(M,D,U,B,G){if(typeof B=="string"&&B!==""||typeof B=="number")return M=M.get(U)||null,v(D,M,""+B,G);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case xE:return M=M.get(B.key===null?U:B.key)||null,b(D,M,B,G);case Km:return M=M.get(B.key===null?U:B.key)||null,_(D,M,B,G);case Ud:var $=B._init;return I(M,D,U,$(B._payload),G)}if(Iv(B)||av(B))return M=M.get(U)||null,w(D,M,B,G,null);OE(D,B)}return null}function R(M,D,U,B){for(var G=null,$=null,q=D,X=D=0,ee=null;q!==null&&X<U.length;X++){q.index>X?(ee=q,q=null):ee=q.sibling;var ce=N(M,q,U[X],B);if(ce===null){q===null&&(q=ee);break}e&&q&&ce.alternate===null&&n(M,q),D=h(ce,D,X),$===null?G=ce:$.sibling=ce,$=ce,q=ee}if(X===U.length)return s(M,q),Ur&&wh(M,X),G;if(q===null){for(;X<U.length;X++)q=E(M,U[X],B),q!==null&&(D=h(q,D,X),$===null?G=q:$.sibling=q,$=q);return Ur&&wh(M,X),G}for(q=o(M,q);X<U.length;X++)ee=I(q,M,X,U[X],B),ee!==null&&(e&&ee.alternate!==null&&q.delete(ee.key===null?X:ee.key),D=h(ee,D,X),$===null?G=ee:$.sibling=ee,$=ee);return e&&q.forEach(function(Q){return n(M,Q)}),Ur&&wh(M,X),G}function O(M,D,U,B){var G=av(U);if(typeof G!="function")throw Error(ot(150));if(U=G.call(U),U==null)throw Error(ot(151));for(var $=G=null,q=D,X=D=0,ee=null,ce=U.next();q!==null&&!ce.done;X++,ce=U.next()){q.index>X?(ee=q,q=null):ee=q.sibling;var Q=N(M,q,ce.value,B);if(Q===null){q===null&&(q=ee);break}e&&q&&Q.alternate===null&&n(M,q),D=h(Q,D,X),$===null?G=Q:$.sibling=Q,$=Q,q=ee}if(ce.done)return s(M,q),Ur&&wh(M,X),G;if(q===null){for(;!ce.done;X++,ce=U.next())ce=E(M,ce.value,B),ce!==null&&(D=h(ce,D,X),$===null?G=ce:$.sibling=ce,$=ce);return Ur&&wh(M,X),G}for(q=o(M,q);!ce.done;X++,ce=U.next())ce=I(q,M,X,ce.value,B),ce!==null&&(e&&ce.alternate!==null&&q.delete(ce.key===null?X:ce.key),D=h(ce,D,X),$===null?G=ce:$.sibling=ce,$=ce);return e&&q.forEach(function(ae){return n(M,ae)}),Ur&&wh(M,X),G}function P(M,D,U,B){if(typeof U=="object"&&U!==null&&U.type===Ym&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case xE:e:{for(var G=U.key,$=D;$!==null;){if($.key===G){if(G=U.type,G===Ym){if($.tag===7){s(M,$.sibling),D=d($,U.props.children),D.return=M,M=D;break e}}else if($.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Ud&&c7(G)===$.type){s(M,$.sibling),D=d($,U.props),D.ref=uv(M,$,U),D.return=M,M=D;break e}s(M,$);break}else n(M,$);$=$.sibling}U.type===Ym?(D=Bh(U.props.children,M.mode,B,U.key),D.return=M,M=D):(B=pw(U.type,U.key,U.props,null,M.mode,B),B.ref=uv(M,D,U),B.return=M,M=B)}return f(M);case Km:e:{for($=U.key;D!==null;){if(D.key===$)if(D.tag===4&&D.stateNode.containerInfo===U.containerInfo&&D.stateNode.implementation===U.implementation){s(M,D.sibling),D=d(D,U.children||[]),D.return=M,M=D;break e}else{s(M,D);break}else n(M,D);D=D.sibling}D=aO(U,M.mode,B),D.return=M,M=D}return f(M);case Ud:return $=U._init,P(M,D,$(U._payload),B)}if(Iv(U))return R(M,D,U,B);if(av(U))return O(M,D,U,B);OE(M,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,D!==null&&D.tag===6?(s(M,D.sibling),D=d(D,U),D.return=M,M=D):(s(M,D),D=sO(U,M.mode,B),D.return=M,M=D),f(M)):s(M,D)}return P}var Tf=BX(!0),GX=BX(!1),Dw=vu(null),Lw=null,nf=null,uj=null;function hj(){uj=nf=Lw=null}function pj(e){var n=Dw.current;Ir(Dw),e._currentValue=n}function T2(e,n,s){for(;e!==null;){var o=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,o!==null&&(o.childLanes|=n)):o!==null&&(o.childLanes&n)!==n&&(o.childLanes|=n),e===s)break;e=e.return}}function pf(e,n){Lw=e,uj=nf=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(na=!0),e.firstContext=null)}function wo(e){var n=e._currentValue;if(uj!==e)if(e={context:e,memoizedValue:n,next:null},nf===null){if(Lw===null)throw Error(ot(308));nf=e,Lw.dependencies={lanes:0,firstContext:e}}else nf=nf.next=e;return n}var Oh=null;function mj(e){Oh===null?Oh=[e]:Oh.push(e)}function WX(e,n,s,o){var d=n.interleaved;return d===null?(s.next=s,mj(n)):(s.next=d.next,d.next=s),n.interleaved=s,$l(e,o)}function $l(e,n){e.lanes|=n;var s=e.alternate;for(s!==null&&(s.lanes|=n),s=e,e=e.return;e!==null;)e.childLanes|=n,s=e.alternate,s!==null&&(s.childLanes|=n),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Fd=!1;function fj(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $X(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Dl(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function ru(e,n,s){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,Bn&2){var d=o.pending;return d===null?n.next=n:(n.next=d.next,d.next=n),o.pending=n,$l(e,s)}return d=o.interleaved,d===null?(n.next=n,mj(o)):(n.next=d.next,d.next=n),o.interleaved=n,$l(e,s)}function ow(e,n,s){if(n=n.updateQueue,n!==null&&(n=n.shared,(s&4194240)!==0)){var o=n.lanes;o&=e.pendingLanes,s|=o,n.lanes=s,ej(e,s)}}function l7(e,n){var s=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,s===o)){var d=null,h=null;if(s=s.firstBaseUpdate,s!==null){do{var f={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};h===null?d=h=f:h=h.next=f,s=s.next}while(s!==null);h===null?d=h=n:h=h.next=n}else d=h=n;s={baseState:o.baseState,firstBaseUpdate:d,lastBaseUpdate:h,shared:o.shared,effects:o.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=n:e.next=n,s.lastBaseUpdate=n}function Mw(e,n,s,o){var d=e.updateQueue;Fd=!1;var h=d.firstBaseUpdate,f=d.lastBaseUpdate,v=d.shared.pending;if(v!==null){d.shared.pending=null;var b=v,_=b.next;b.next=null,f===null?h=_:f.next=_,f=b;var w=e.alternate;w!==null&&(w=w.updateQueue,v=w.lastBaseUpdate,v!==f&&(v===null?w.firstBaseUpdate=_:v.next=_,w.lastBaseUpdate=b))}if(h!==null){var E=d.baseState;f=0,w=_=b=null,v=h;do{var N=v.lane,I=v.eventTime;if((o&N)===N){w!==null&&(w=w.next={eventTime:I,lane:0,tag:v.tag,payload:v.payload,callback:v.callback,next:null});e:{var R=e,O=v;switch(N=n,I=s,O.tag){case 1:if(R=O.payload,typeof R=="function"){E=R.call(I,E,N);break e}E=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=O.payload,N=typeof R=="function"?R.call(I,E,N):R,N==null)break e;E=Xr({},E,N);break e;case 2:Fd=!0}}v.callback!==null&&v.lane!==0&&(e.flags|=64,N=d.effects,N===null?d.effects=[v]:N.push(v))}else I={eventTime:I,lane:N,tag:v.tag,payload:v.payload,callback:v.callback,next:null},w===null?(_=w=I,b=E):w=w.next=I,f|=N;if(v=v.next,v===null){if(v=d.shared.pending,v===null)break;N=v,v=N.next,N.next=null,d.lastBaseUpdate=N,d.shared.pending=null}}while(!0);if(w===null&&(b=E),d.baseState=b,d.firstBaseUpdate=_,d.lastBaseUpdate=w,n=d.shared.interleaved,n!==null){d=n;do f|=d.lane,d=d.next;while(d!==n)}else h===null&&(d.shared.lanes=0);qh|=f,e.lanes=f,e.memoizedState=E}}function d7(e,n,s){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var o=e[n],d=o.callback;if(d!==null){if(o.callback=null,o=s,typeof d!="function")throw Error(ot(191,d));d.call(o)}}}var nb={},Jc=vu(nb),ay=vu(nb),oy=vu(nb);function Ph(e){if(e===nb)throw Error(ot(174));return e}function gj(e,n){switch(br(oy,n),br(ay,e),br(Jc,nb),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:s2(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=s2(n,e)}Ir(Jc),br(Jc,n)}function Nf(){Ir(Jc),Ir(ay),Ir(oy)}function zX(e){Ph(oy.current);var n=Ph(Jc.current),s=s2(n,e.type);n!==s&&(br(ay,e),br(Jc,s))}function vj(e){ay.current===e&&(Ir(Jc),Ir(ay))}var Kr=vu(0);function Uw(e){for(var n=e;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var ZI=[];function yj(){for(var e=0;e<ZI.length;e++)ZI[e]._workInProgressVersionPrimary=null;ZI.length=0}var cw=Ql.ReactCurrentDispatcher,eO=Ql.ReactCurrentBatchConfig,Yh=0,Yr=null,Si=null,Vi=null,Fw=!1,Vv=!1,cy=0,lEe=0;function ms(){throw Error(ot(321))}function bj(e,n){if(n===null)return!1;for(var s=0;s<n.length&&s<e.length;s++)if(!pc(e[s],n[s]))return!1;return!0}function xj(e,n,s,o,d,h){if(Yh=h,Yr=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,cw.current=e===null||e.memoizedState===null?pEe:mEe,e=s(o,d),Vv){h=0;do{if(Vv=!1,cy=0,25<=h)throw Error(ot(301));h+=1,Vi=Si=null,n.updateQueue=null,cw.current=fEe,e=s(o,d)}while(Vv)}if(cw.current=Vw,n=Si!==null&&Si.next!==null,Yh=0,Vi=Si=Yr=null,Fw=!1,n)throw Error(ot(300));return e}function _j(){var e=cy!==0;return cy=0,e}function $c(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vi===null?Yr.memoizedState=Vi=e:Vi=Vi.next=e,Vi}function So(){if(Si===null){var e=Yr.alternate;e=e!==null?e.memoizedState:null}else e=Si.next;var n=Vi===null?Yr.memoizedState:Vi.next;if(n!==null)Vi=n,Si=e;else{if(e===null)throw Error(ot(310));Si=e,e={memoizedState:Si.memoizedState,baseState:Si.baseState,baseQueue:Si.baseQueue,queue:Si.queue,next:null},Vi===null?Yr.memoizedState=Vi=e:Vi=Vi.next=e}return Vi}function ly(e,n){return typeof n=="function"?n(e):n}function tO(e){var n=So(),s=n.queue;if(s===null)throw Error(ot(311));s.lastRenderedReducer=e;var o=Si,d=o.baseQueue,h=s.pending;if(h!==null){if(d!==null){var f=d.next;d.next=h.next,h.next=f}o.baseQueue=d=h,s.pending=null}if(d!==null){h=d.next,o=o.baseState;var v=f=null,b=null,_=h;do{var w=_.lane;if((Yh&w)===w)b!==null&&(b=b.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),o=_.hasEagerState?_.eagerState:e(o,_.action);else{var E={lane:w,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};b===null?(v=b=E,f=o):b=b.next=E,Yr.lanes|=w,qh|=w}_=_.next}while(_!==null&&_!==h);b===null?f=o:b.next=v,pc(o,n.memoizedState)||(na=!0),n.memoizedState=o,n.baseState=f,n.baseQueue=b,s.lastRenderedState=o}if(e=s.interleaved,e!==null){d=e;do h=d.lane,Yr.lanes|=h,qh|=h,d=d.next;while(d!==e)}else d===null&&(s.lanes=0);return[n.memoizedState,s.dispatch]}function nO(e){var n=So(),s=n.queue;if(s===null)throw Error(ot(311));s.lastRenderedReducer=e;var o=s.dispatch,d=s.pending,h=n.memoizedState;if(d!==null){s.pending=null;var f=d=d.next;do h=e(h,f.action),f=f.next;while(f!==d);pc(h,n.memoizedState)||(na=!0),n.memoizedState=h,n.baseQueue===null&&(n.baseState=h),s.lastRenderedState=h}return[h,o]}function HX(){}function KX(e,n){var s=Yr,o=So(),d=n(),h=!pc(o.memoizedState,d);if(h&&(o.memoizedState=d,na=!0),o=o.queue,Ej(XX.bind(null,s,o,e),[e]),o.getSnapshot!==n||h||Vi!==null&&Vi.memoizedState.tag&1){if(s.flags|=2048,dy(9,qX.bind(null,s,o,d,n),void 0,null),Bi===null)throw Error(ot(349));Yh&30||YX(s,n,d)}return d}function YX(e,n,s){e.flags|=16384,e={getSnapshot:n,value:s},n=Yr.updateQueue,n===null?(n={lastEffect:null,stores:null},Yr.updateQueue=n,n.stores=[e]):(s=n.stores,s===null?n.stores=[e]:s.push(e))}function qX(e,n,s,o){n.value=s,n.getSnapshot=o,JX(n)&&QX(e)}function XX(e,n,s){return s(function(){JX(n)&&QX(e)})}function JX(e){var n=e.getSnapshot;e=e.value;try{var s=n();return!pc(e,s)}catch{return!0}}function QX(e){var n=$l(e,1);n!==null&&hc(n,e,1,-1)}function u7(e){var n=$c();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ly,lastRenderedState:e},n.queue=e,e=e.dispatch=hEe.bind(null,Yr,e),[n.memoizedState,e]}function dy(e,n,s,o){return e={tag:e,create:n,destroy:s,deps:o,next:null},n=Yr.updateQueue,n===null?(n={lastEffect:null,stores:null},Yr.updateQueue=n,n.lastEffect=e.next=e):(s=n.lastEffect,s===null?n.lastEffect=e.next=e:(o=s.next,s.next=e,e.next=o,n.lastEffect=e)),e}function ZX(){return So().memoizedState}function lw(e,n,s,o){var d=$c();Yr.flags|=e,d.memoizedState=dy(1|n,s,void 0,o===void 0?null:o)}function lT(e,n,s,o){var d=So();o=o===void 0?null:o;var h=void 0;if(Si!==null){var f=Si.memoizedState;if(h=f.destroy,o!==null&&bj(o,f.deps)){d.memoizedState=dy(n,s,h,o);return}}Yr.flags|=e,d.memoizedState=dy(1|n,s,h,o)}function h7(e,n){return lw(8390656,8,e,n)}function Ej(e,n){return lT(2048,8,e,n)}function eJ(e,n){return lT(4,2,e,n)}function tJ(e,n){return lT(4,4,e,n)}function nJ(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function rJ(e,n,s){return s=s!=null?s.concat([e]):null,lT(4,4,nJ.bind(null,n,e),s)}function wj(){}function iJ(e,n){var s=So();n=n===void 0?null:n;var o=s.memoizedState;return o!==null&&n!==null&&bj(n,o[1])?o[0]:(s.memoizedState=[e,n],e)}function sJ(e,n){var s=So();n=n===void 0?null:n;var o=s.memoizedState;return o!==null&&n!==null&&bj(n,o[1])?o[0]:(e=e(),s.memoizedState=[e,n],e)}function aJ(e,n,s){return Yh&21?(pc(s,n)||(s=uX(),Yr.lanes|=s,qh|=s,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,na=!0),e.memoizedState=s)}function dEe(e,n){var s=ir;ir=s!==0&&4>s?s:4,e(!0);var o=eO.transition;eO.transition={};try{e(!1),n()}finally{ir=s,eO.transition=o}}function oJ(){return So().memoizedState}function uEe(e,n,s){var o=su(e);if(s={lane:o,action:s,hasEagerState:!1,eagerState:null,next:null},cJ(e))lJ(n,s);else if(s=WX(e,n,s,o),s!==null){var d=js();hc(s,e,o,d),dJ(s,n,o)}}function hEe(e,n,s){var o=su(e),d={lane:o,action:s,hasEagerState:!1,eagerState:null,next:null};if(cJ(e))lJ(n,d);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=n.lastRenderedReducer,h!==null))try{var f=n.lastRenderedState,v=h(f,s);if(d.hasEagerState=!0,d.eagerState=v,pc(v,f)){var b=n.interleaved;b===null?(d.next=d,mj(n)):(d.next=b.next,b.next=d),n.interleaved=d;return}}catch{}finally{}s=WX(e,n,d,o),s!==null&&(d=js(),hc(s,e,o,d),dJ(s,n,o))}}function cJ(e){var n=e.alternate;return e===Yr||n!==null&&n===Yr}function lJ(e,n){Vv=Fw=!0;var s=e.pending;s===null?n.next=n:(n.next=s.next,s.next=n),e.pending=n}function dJ(e,n,s){if(s&4194240){var o=n.lanes;o&=e.pendingLanes,s|=o,n.lanes=s,ej(e,s)}}var Vw={readContext:wo,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useInsertionEffect:ms,useLayoutEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useMutableSource:ms,useSyncExternalStore:ms,useId:ms,unstable_isNewReconciler:!1},pEe={readContext:wo,useCallback:function(e,n){return $c().memoizedState=[e,n===void 0?null:n],e},useContext:wo,useEffect:h7,useImperativeHandle:function(e,n,s){return s=s!=null?s.concat([e]):null,lw(4194308,4,nJ.bind(null,n,e),s)},useLayoutEffect:function(e,n){return lw(4194308,4,e,n)},useInsertionEffect:function(e,n){return lw(4,2,e,n)},useMemo:function(e,n){var s=$c();return n=n===void 0?null:n,e=e(),s.memoizedState=[e,n],e},useReducer:function(e,n,s){var o=$c();return n=s!==void 0?s(n):n,o.memoizedState=o.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},o.queue=e,e=e.dispatch=uEe.bind(null,Yr,e),[o.memoizedState,e]},useRef:function(e){var n=$c();return e={current:e},n.memoizedState=e},useState:u7,useDebugValue:wj,useDeferredValue:function(e){return $c().memoizedState=e},useTransition:function(){var e=u7(!1),n=e[0];return e=dEe.bind(null,e[1]),$c().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,s){var o=Yr,d=$c();if(Ur){if(s===void 0)throw Error(ot(407));s=s()}else{if(s=n(),Bi===null)throw Error(ot(349));Yh&30||YX(o,n,s)}d.memoizedState=s;var h={value:s,getSnapshot:n};return d.queue=h,h7(XX.bind(null,o,h,e),[e]),o.flags|=2048,dy(9,qX.bind(null,o,h,s,n),void 0,null),s},useId:function(){var e=$c(),n=Bi.identifierPrefix;if(Ur){var s=Al,o=Rl;s=(o&~(1<<32-uc(o)-1)).toString(32)+s,n=":"+n+"R"+s,s=cy++,0<s&&(n+="H"+s.toString(32)),n+=":"}else s=lEe++,n=":"+n+"r"+s.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},mEe={readContext:wo,useCallback:iJ,useContext:wo,useEffect:Ej,useImperativeHandle:rJ,useInsertionEffect:eJ,useLayoutEffect:tJ,useMemo:sJ,useReducer:tO,useRef:ZX,useState:function(){return tO(ly)},useDebugValue:wj,useDeferredValue:function(e){var n=So();return aJ(n,Si.memoizedState,e)},useTransition:function(){var e=tO(ly)[0],n=So().memoizedState;return[e,n]},useMutableSource:HX,useSyncExternalStore:KX,useId:oJ,unstable_isNewReconciler:!1},fEe={readContext:wo,useCallback:iJ,useContext:wo,useEffect:Ej,useImperativeHandle:rJ,useInsertionEffect:eJ,useLayoutEffect:tJ,useMemo:sJ,useReducer:nO,useRef:ZX,useState:function(){return nO(ly)},useDebugValue:wj,useDeferredValue:function(e){var n=So();return Si===null?n.memoizedState=e:aJ(n,Si.memoizedState,e)},useTransition:function(){var e=nO(ly)[0],n=So().memoizedState;return[e,n]},useMutableSource:HX,useSyncExternalStore:KX,useId:oJ,unstable_isNewReconciler:!1};function ic(e,n){if(e&&e.defaultProps){n=Xr({},n),e=e.defaultProps;for(var s in e)n[s]===void 0&&(n[s]=e[s]);return n}return n}function N2(e,n,s,o){n=e.memoizedState,s=s(o,n),s=s==null?n:Xr({},n,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var dT={isMounted:function(e){return(e=e._reactInternals)?ap(e)===e:!1},enqueueSetState:function(e,n,s){e=e._reactInternals;var o=js(),d=su(e),h=Dl(o,d);h.payload=n,s!=null&&(h.callback=s),n=ru(e,h,d),n!==null&&(hc(n,e,d,o),ow(n,e,d))},enqueueReplaceState:function(e,n,s){e=e._reactInternals;var o=js(),d=su(e),h=Dl(o,d);h.tag=1,h.payload=n,s!=null&&(h.callback=s),n=ru(e,h,d),n!==null&&(hc(n,e,d,o),ow(n,e,d))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var s=js(),o=su(e),d=Dl(s,o);d.tag=2,n!=null&&(d.callback=n),n=ru(e,d,o),n!==null&&(hc(n,e,o,s),ow(n,e,o))}};function p7(e,n,s,o,d,h,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,h,f):n.prototype&&n.prototype.isPureReactComponent?!ny(s,o)||!ny(d,h):!0}function uJ(e,n,s){var o=!1,d=pu,h=n.contextType;return typeof h=="object"&&h!==null?h=wo(h):(d=aa(n)?Hh:ws.current,o=n.contextTypes,h=(o=o!=null)?wf(e,d):pu),n=new n(s,h),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=dT,e.stateNode=n,n._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=d,e.__reactInternalMemoizedMaskedChildContext=h),n}function m7(e,n,s,o){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,o),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,o),n.state!==e&&dT.enqueueReplaceState(n,n.state,null)}function C2(e,n,s,o){var d=e.stateNode;d.props=s,d.state=e.memoizedState,d.refs={},fj(e);var h=n.contextType;typeof h=="object"&&h!==null?d.context=wo(h):(h=aa(n)?Hh:ws.current,d.context=wf(e,h)),d.state=e.memoizedState,h=n.getDerivedStateFromProps,typeof h=="function"&&(N2(e,n,h,s),d.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(n=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),n!==d.state&&dT.enqueueReplaceState(d,d.state,null),Mw(e,s,d,o),d.state=e.memoizedState),typeof d.componentDidMount=="function"&&(e.flags|=4194308)}function Cf(e,n){try{var s="",o=n;do s+=Wxe(o),o=o.return;while(o);var d=s}catch(h){d=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:n,stack:d,digest:null}}function rO(e,n,s){return{value:e,source:null,stack:s??null,digest:n??null}}function R2(e,n){try{console.error(n.value)}catch(s){setTimeout(function(){throw s})}}var gEe=typeof WeakMap=="function"?WeakMap:Map;function hJ(e,n,s){s=Dl(-1,s),s.tag=3,s.payload={element:null};var o=n.value;return s.callback=function(){Gw||(Gw=!0,U2=o),R2(e,n)},s}function pJ(e,n,s){s=Dl(-1,s),s.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var d=n.value;s.payload=function(){return o(d)},s.callback=function(){R2(e,n)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(s.callback=function(){R2(e,n),typeof o!="function"&&(iu===null?iu=new Set([this]):iu.add(this));var f=n.stack;this.componentDidCatch(n.value,{componentStack:f!==null?f:""})}),s}function f7(e,n,s){var o=e.pingCache;if(o===null){o=e.pingCache=new gEe;var d=new Set;o.set(n,d)}else d=o.get(n),d===void 0&&(d=new Set,o.set(n,d));d.has(s)||(d.add(s),e=IEe.bind(null,e,n,s),n.then(e,e))}function g7(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function v7(e,n,s,o,d){return e.mode&1?(e.flags|=65536,e.lanes=d,e):(e===n?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(n=Dl(-1,1),n.tag=2,ru(s,n,1))),s.lanes|=1),e)}var vEe=Ql.ReactCurrentOwner,na=!1;function Ps(e,n,s,o){n.child=e===null?GX(n,null,s,o):Tf(n,e.child,s,o)}function y7(e,n,s,o,d){s=s.render;var h=n.ref;return pf(n,d),o=xj(e,n,s,o,h,d),s=_j(),e!==null&&!na?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~d,zl(e,n,d)):(Ur&&s&&cj(n),n.flags|=1,Ps(e,n,o,d),n.child)}function b7(e,n,s,o,d){if(e===null){var h=s.type;return typeof h=="function"&&!Oj(h)&&h.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(n.tag=15,n.type=h,mJ(e,n,h,o,d)):(e=pw(s.type,null,o,n,n.mode,d),e.ref=n.ref,e.return=n,n.child=e)}if(h=e.child,!(e.lanes&d)){var f=h.memoizedProps;if(s=s.compare,s=s!==null?s:ny,s(f,o)&&e.ref===n.ref)return zl(e,n,d)}return n.flags|=1,e=au(h,o),e.ref=n.ref,e.return=n,n.child=e}function mJ(e,n,s,o,d){if(e!==null){var h=e.memoizedProps;if(ny(h,o)&&e.ref===n.ref)if(na=!1,n.pendingProps=o=h,(e.lanes&d)!==0)e.flags&131072&&(na=!0);else return n.lanes=e.lanes,zl(e,n,d)}return A2(e,n,s,o,d)}function fJ(e,n,s){var o=n.pendingProps,d=o.children,h=e!==null?e.memoizedState:null;if(o.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},br(sf,Ca),Ca|=s;else{if(!(s&1073741824))return e=h!==null?h.baseLanes|s:s,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,br(sf,Ca),Ca|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=h!==null?h.baseLanes:s,br(sf,Ca),Ca|=o}else h!==null?(o=h.baseLanes|s,n.memoizedState=null):o=s,br(sf,Ca),Ca|=o;return Ps(e,n,d,s),n.child}function gJ(e,n){var s=n.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(n.flags|=512,n.flags|=2097152)}function A2(e,n,s,o,d){var h=aa(s)?Hh:ws.current;return h=wf(n,h),pf(n,d),s=xj(e,n,s,o,h,d),o=_j(),e!==null&&!na?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~d,zl(e,n,d)):(Ur&&o&&cj(n),n.flags|=1,Ps(e,n,s,d),n.child)}function x7(e,n,s,o,d){if(aa(s)){var h=!0;Pw(n)}else h=!1;if(pf(n,d),n.stateNode===null)dw(e,n),uJ(n,s,o),C2(n,s,o,d),o=!0;else if(e===null){var f=n.stateNode,v=n.memoizedProps;f.props=v;var b=f.context,_=s.contextType;typeof _=="object"&&_!==null?_=wo(_):(_=aa(s)?Hh:ws.current,_=wf(n,_));var w=s.getDerivedStateFromProps,E=typeof w=="function"||typeof f.getSnapshotBeforeUpdate=="function";E||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(v!==o||b!==_)&&m7(n,f,o,_),Fd=!1;var N=n.memoizedState;f.state=N,Mw(n,o,f,d),b=n.memoizedState,v!==o||N!==b||sa.current||Fd?(typeof w=="function"&&(N2(n,s,w,o),b=n.memoizedState),(v=Fd||p7(n,s,v,o,N,b,_))?(E||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(n.flags|=4194308)):(typeof f.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=o,n.memoizedState=b),f.props=o,f.state=b,f.context=_,o=v):(typeof f.componentDidMount=="function"&&(n.flags|=4194308),o=!1)}else{f=n.stateNode,$X(e,n),v=n.memoizedProps,_=n.type===n.elementType?v:ic(n.type,v),f.props=_,E=n.pendingProps,N=f.context,b=s.contextType,typeof b=="object"&&b!==null?b=wo(b):(b=aa(s)?Hh:ws.current,b=wf(n,b));var I=s.getDerivedStateFromProps;(w=typeof I=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(v!==E||N!==b)&&m7(n,f,o,b),Fd=!1,N=n.memoizedState,f.state=N,Mw(n,o,f,d);var R=n.memoizedState;v!==E||N!==R||sa.current||Fd?(typeof I=="function"&&(N2(n,s,I,o),R=n.memoizedState),(_=Fd||p7(n,s,_,o,N,R,b)||!1)?(w||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(o,R,b),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(o,R,b)),typeof f.componentDidUpdate=="function"&&(n.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof f.componentDidUpdate!="function"||v===e.memoizedProps&&N===e.memoizedState||(n.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&N===e.memoizedState||(n.flags|=1024),n.memoizedProps=o,n.memoizedState=R),f.props=o,f.state=R,f.context=b,o=_):(typeof f.componentDidUpdate!="function"||v===e.memoizedProps&&N===e.memoizedState||(n.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&N===e.memoizedState||(n.flags|=1024),o=!1)}return I2(e,n,s,o,h,d)}function I2(e,n,s,o,d,h){gJ(e,n);var f=(n.flags&128)!==0;if(!o&&!f)return d&&s7(n,s,!1),zl(e,n,h);o=n.stateNode,vEe.current=n;var v=f&&typeof s.getDerivedStateFromError!="function"?null:o.render();return n.flags|=1,e!==null&&f?(n.child=Tf(n,e.child,null,h),n.child=Tf(n,null,v,h)):Ps(e,n,v,h),n.memoizedState=o.state,d&&s7(n,s,!0),n.child}function vJ(e){var n=e.stateNode;n.pendingContext?i7(e,n.pendingContext,n.pendingContext!==n.context):n.context&&i7(e,n.context,!1),gj(e,n.containerInfo)}function _7(e,n,s,o,d){return Sf(),dj(d),n.flags|=256,Ps(e,n,s,o),n.child}var O2={dehydrated:null,treeContext:null,retryLane:0};function P2(e){return{baseLanes:e,cachePool:null,transitions:null}}function yJ(e,n,s){var o=n.pendingProps,d=Kr.current,h=!1,f=(n.flags&128)!==0,v;if((v=f)||(v=e!==null&&e.memoizedState===null?!1:(d&2)!==0),v?(h=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(d|=1),br(Kr,d&1),e===null)return S2(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(f=o.children,e=o.fallback,h?(o=n.mode,h=n.child,f={mode:"hidden",children:f},!(o&1)&&h!==null?(h.childLanes=0,h.pendingProps=f):h=pT(f,o,0,null),e=Bh(e,o,s,null),h.return=n,e.return=n,h.sibling=e,n.child=h,n.child.memoizedState=P2(s),n.memoizedState=O2,e):Sj(n,f));if(d=e.memoizedState,d!==null&&(v=d.dehydrated,v!==null))return yEe(e,n,f,o,v,d,s);if(h){h=o.fallback,f=n.mode,d=e.child,v=d.sibling;var b={mode:"hidden",children:o.children};return!(f&1)&&n.child!==d?(o=n.child,o.childLanes=0,o.pendingProps=b,n.deletions=null):(o=au(d,b),o.subtreeFlags=d.subtreeFlags&14680064),v!==null?h=au(v,h):(h=Bh(h,f,s,null),h.flags|=2),h.return=n,o.return=n,o.sibling=h,n.child=o,o=h,h=n.child,f=e.child.memoizedState,f=f===null?P2(s):{baseLanes:f.baseLanes|s,cachePool:null,transitions:f.transitions},h.memoizedState=f,h.childLanes=e.childLanes&~s,n.memoizedState=O2,o}return h=e.child,e=h.sibling,o=au(h,{mode:"visible",children:o.children}),!(n.mode&1)&&(o.lanes=s),o.return=n,o.sibling=null,e!==null&&(s=n.deletions,s===null?(n.deletions=[e],n.flags|=16):s.push(e)),n.child=o,n.memoizedState=null,o}function Sj(e,n){return n=pT({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function PE(e,n,s,o){return o!==null&&dj(o),Tf(n,e.child,null,s),e=Sj(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function yEe(e,n,s,o,d,h,f){if(s)return n.flags&256?(n.flags&=-257,o=rO(Error(ot(422))),PE(e,n,f,o)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(h=o.fallback,d=n.mode,o=pT({mode:"visible",children:o.children},d,0,null),h=Bh(h,d,f,null),h.flags|=2,o.return=n,h.return=n,o.sibling=h,n.child=o,n.mode&1&&Tf(n,e.child,null,f),n.child.memoizedState=P2(f),n.memoizedState=O2,h);if(!(n.mode&1))return PE(e,n,f,null);if(d.data==="$!"){if(o=d.nextSibling&&d.nextSibling.dataset,o)var v=o.dgst;return o=v,h=Error(ot(419)),o=rO(h,o,void 0),PE(e,n,f,o)}if(v=(f&e.childLanes)!==0,na||v){if(o=Bi,o!==null){switch(f&-f){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(o.suspendedLanes|f)?0:d,d!==0&&d!==h.retryLane&&(h.retryLane=d,$l(e,d),hc(o,e,d,-1))}return Ij(),o=rO(Error(ot(421))),PE(e,n,f,o)}return d.data==="$?"?(n.flags|=128,n.child=e.child,n=OEe.bind(null,e),d._reactRetry=n,null):(e=h.treeContext,Oa=nu(d.nextSibling),Da=n,Ur=!0,cc=null,e!==null&&(mo[fo++]=Rl,mo[fo++]=Al,mo[fo++]=Kh,Rl=e.id,Al=e.overflow,Kh=n),n=Sj(n,o.children),n.flags|=4096,n)}function E7(e,n,s){e.lanes|=n;var o=e.alternate;o!==null&&(o.lanes|=n),T2(e.return,n,s)}function iO(e,n,s,o,d){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:o,tail:s,tailMode:d}:(h.isBackwards=n,h.rendering=null,h.renderingStartTime=0,h.last=o,h.tail=s,h.tailMode=d)}function bJ(e,n,s){var o=n.pendingProps,d=o.revealOrder,h=o.tail;if(Ps(e,n,o.children,s),o=Kr.current,o&2)o=o&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&E7(e,s,n);else if(e.tag===19)E7(e,s,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(br(Kr,o),!(n.mode&1))n.memoizedState=null;else switch(d){case"forwards":for(s=n.child,d=null;s!==null;)e=s.alternate,e!==null&&Uw(e)===null&&(d=s),s=s.sibling;s=d,s===null?(d=n.child,n.child=null):(d=s.sibling,s.sibling=null),iO(n,!1,d,s,h);break;case"backwards":for(s=null,d=n.child,n.child=null;d!==null;){if(e=d.alternate,e!==null&&Uw(e)===null){n.child=d;break}e=d.sibling,d.sibling=s,s=d,d=e}iO(n,!0,s,null,h);break;case"together":iO(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function dw(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function zl(e,n,s){if(e!==null&&(n.dependencies=e.dependencies),qh|=n.lanes,!(s&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(ot(153));if(n.child!==null){for(e=n.child,s=au(e,e.pendingProps),n.child=s,s.return=n;e.sibling!==null;)e=e.sibling,s=s.sibling=au(e,e.pendingProps),s.return=n;s.sibling=null}return n.child}function bEe(e,n,s){switch(n.tag){case 3:vJ(n),Sf();break;case 5:zX(n);break;case 1:aa(n.type)&&Pw(n);break;case 4:gj(n,n.stateNode.containerInfo);break;case 10:var o=n.type._context,d=n.memoizedProps.value;br(Dw,o._currentValue),o._currentValue=d;break;case 13:if(o=n.memoizedState,o!==null)return o.dehydrated!==null?(br(Kr,Kr.current&1),n.flags|=128,null):s&n.child.childLanes?yJ(e,n,s):(br(Kr,Kr.current&1),e=zl(e,n,s),e!==null?e.sibling:null);br(Kr,Kr.current&1);break;case 19:if(o=(s&n.childLanes)!==0,e.flags&128){if(o)return bJ(e,n,s);n.flags|=128}if(d=n.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),br(Kr,Kr.current),o)break;return null;case 22:case 23:return n.lanes=0,fJ(e,n,s)}return zl(e,n,s)}var xJ,k2,_J,EJ;xJ=function(e,n){for(var s=n.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};k2=function(){};_J=function(e,n,s,o){var d=e.memoizedProps;if(d!==o){e=n.stateNode,Ph(Jc.current);var h=null;switch(s){case"input":d=t2(e,d),o=t2(e,o),h=[];break;case"select":d=Xr({},d,{value:void 0}),o=Xr({},o,{value:void 0}),h=[];break;case"textarea":d=i2(e,d),o=i2(e,o),h=[];break;default:typeof d.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=Iw)}a2(s,o);var f;s=null;for(_ in d)if(!o.hasOwnProperty(_)&&d.hasOwnProperty(_)&&d[_]!=null)if(_==="style"){var v=d[_];for(f in v)v.hasOwnProperty(f)&&(s||(s={}),s[f]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(qv.hasOwnProperty(_)?h||(h=[]):(h=h||[]).push(_,null));for(_ in o){var b=o[_];if(v=d!=null?d[_]:void 0,o.hasOwnProperty(_)&&b!==v&&(b!=null||v!=null))if(_==="style")if(v){for(f in v)!v.hasOwnProperty(f)||b&&b.hasOwnProperty(f)||(s||(s={}),s[f]="");for(f in b)b.hasOwnProperty(f)&&v[f]!==b[f]&&(s||(s={}),s[f]=b[f])}else s||(h||(h=[]),h.push(_,s)),s=b;else _==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,v=v?v.__html:void 0,b!=null&&v!==b&&(h=h||[]).push(_,b)):_==="children"?typeof b!="string"&&typeof b!="number"||(h=h||[]).push(_,""+b):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(qv.hasOwnProperty(_)?(b!=null&&_==="onScroll"&&Cr("scroll",e),h||v===b||(h=[])):(h=h||[]).push(_,b))}s&&(h=h||[]).push("style",s);var _=h;(n.updateQueue=_)&&(n.flags|=4)}};EJ=function(e,n,s,o){s!==o&&(n.flags|=4)};function hv(e,n){if(!Ur)switch(e.tailMode){case"hidden":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function fs(e){var n=e.alternate!==null&&e.alternate.child===e.child,s=0,o=0;if(n)for(var d=e.child;d!==null;)s|=d.lanes|d.childLanes,o|=d.subtreeFlags&14680064,o|=d.flags&14680064,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)s|=d.lanes|d.childLanes,o|=d.subtreeFlags,o|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=o,e.childLanes=s,n}function xEe(e,n,s){var o=n.pendingProps;switch(lj(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fs(n),null;case 1:return aa(n.type)&&Ow(),fs(n),null;case 3:return o=n.stateNode,Nf(),Ir(sa),Ir(ws),yj(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(IE(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,cc!==null&&(B2(cc),cc=null))),k2(e,n),fs(n),null;case 5:vj(n);var d=Ph(oy.current);if(s=n.type,e!==null&&n.stateNode!=null)_J(e,n,s,o,d),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!o){if(n.stateNode===null)throw Error(ot(166));return fs(n),null}if(e=Ph(Jc.current),IE(n)){o=n.stateNode,s=n.type;var h=n.memoizedProps;switch(o[Hc]=n,o[sy]=h,e=(n.mode&1)!==0,s){case"dialog":Cr("cancel",o),Cr("close",o);break;case"iframe":case"object":case"embed":Cr("load",o);break;case"video":case"audio":for(d=0;d<Pv.length;d++)Cr(Pv[d],o);break;case"source":Cr("error",o);break;case"img":case"image":case"link":Cr("error",o),Cr("load",o);break;case"details":Cr("toggle",o);break;case"input":Oz(o,h),Cr("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!h.multiple},Cr("invalid",o);break;case"textarea":kz(o,h),Cr("invalid",o)}a2(s,h),d=null;for(var f in h)if(h.hasOwnProperty(f)){var v=h[f];f==="children"?typeof v=="string"?o.textContent!==v&&(h.suppressHydrationWarning!==!0&&AE(o.textContent,v,e),d=["children",v]):typeof v=="number"&&o.textContent!==""+v&&(h.suppressHydrationWarning!==!0&&AE(o.textContent,v,e),d=["children",""+v]):qv.hasOwnProperty(f)&&v!=null&&f==="onScroll"&&Cr("scroll",o)}switch(s){case"input":_E(o),Pz(o,h,!0);break;case"textarea":_E(o),jz(o);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(o.onclick=Iw)}o=d,n.updateQueue=o,o!==null&&(n.flags|=4)}else{f=d.nodeType===9?d:d.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Xq(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=f.createElement(s,{is:o.is}):(e=f.createElement(s),s==="select"&&(f=e,o.multiple?f.multiple=!0:o.size&&(f.size=o.size))):e=f.createElementNS(e,s),e[Hc]=n,e[sy]=o,xJ(e,n,!1,!1),n.stateNode=e;e:{switch(f=o2(s,o),s){case"dialog":Cr("cancel",e),Cr("close",e),d=o;break;case"iframe":case"object":case"embed":Cr("load",e),d=o;break;case"video":case"audio":for(d=0;d<Pv.length;d++)Cr(Pv[d],e);d=o;break;case"source":Cr("error",e),d=o;break;case"img":case"image":case"link":Cr("error",e),Cr("load",e),d=o;break;case"details":Cr("toggle",e),d=o;break;case"input":Oz(e,o),d=t2(e,o),Cr("invalid",e);break;case"option":d=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},d=Xr({},o,{value:void 0}),Cr("invalid",e);break;case"textarea":kz(e,o),d=i2(e,o),Cr("invalid",e);break;default:d=o}a2(s,d),v=d;for(h in v)if(v.hasOwnProperty(h)){var b=v[h];h==="style"?Zq(e,b):h==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,b!=null&&Jq(e,b)):h==="children"?typeof b=="string"?(s!=="textarea"||b!=="")&&Xv(e,b):typeof b=="number"&&Xv(e,""+b):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(qv.hasOwnProperty(h)?b!=null&&h==="onScroll"&&Cr("scroll",e):b!=null&&Yk(e,h,b,f))}switch(s){case"input":_E(e),Pz(e,o,!1);break;case"textarea":_E(e),jz(e);break;case"option":o.value!=null&&e.setAttribute("value",""+hu(o.value));break;case"select":e.multiple=!!o.multiple,h=o.value,h!=null?lf(e,!!o.multiple,h,!1):o.defaultValue!=null&&lf(e,!!o.multiple,o.defaultValue,!0);break;default:typeof d.onClick=="function"&&(e.onclick=Iw)}switch(s){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return fs(n),null;case 6:if(e&&n.stateNode!=null)EJ(e,n,e.memoizedProps,o);else{if(typeof o!="string"&&n.stateNode===null)throw Error(ot(166));if(s=Ph(oy.current),Ph(Jc.current),IE(n)){if(o=n.stateNode,s=n.memoizedProps,o[Hc]=n,(h=o.nodeValue!==s)&&(e=Da,e!==null))switch(e.tag){case 3:AE(o.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&AE(o.nodeValue,s,(e.mode&1)!==0)}h&&(n.flags|=4)}else o=(s.nodeType===9?s:s.ownerDocument).createTextNode(o),o[Hc]=n,n.stateNode=o}return fs(n),null;case 13:if(Ir(Kr),o=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ur&&Oa!==null&&n.mode&1&&!(n.flags&128))VX(),Sf(),n.flags|=98560,h=!1;else if(h=IE(n),o!==null&&o.dehydrated!==null){if(e===null){if(!h)throw Error(ot(318));if(h=n.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(ot(317));h[Hc]=n}else Sf(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;fs(n),h=!1}else cc!==null&&(B2(cc),cc=null),h=!0;if(!h)return n.flags&65536?n:null}return n.flags&128?(n.lanes=s,n):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(n.child.flags|=8192,n.mode&1&&(e===null||Kr.current&1?Ni===0&&(Ni=3):Ij())),n.updateQueue!==null&&(n.flags|=4),fs(n),null);case 4:return Nf(),k2(e,n),e===null&&ry(n.stateNode.containerInfo),fs(n),null;case 10:return pj(n.type._context),fs(n),null;case 17:return aa(n.type)&&Ow(),fs(n),null;case 19:if(Ir(Kr),h=n.memoizedState,h===null)return fs(n),null;if(o=(n.flags&128)!==0,f=h.rendering,f===null)if(o)hv(h,!1);else{if(Ni!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(f=Uw(e),f!==null){for(n.flags|=128,hv(h,!1),o=f.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),n.subtreeFlags=0,o=s,s=n.child;s!==null;)h=s,e=o,h.flags&=14680066,f=h.alternate,f===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=f.childLanes,h.lanes=f.lanes,h.child=f.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=f.memoizedProps,h.memoizedState=f.memoizedState,h.updateQueue=f.updateQueue,h.type=f.type,e=f.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return br(Kr,Kr.current&1|2),n.child}e=e.sibling}h.tail!==null&&ci()>Rf&&(n.flags|=128,o=!0,hv(h,!1),n.lanes=4194304)}else{if(!o)if(e=Uw(f),e!==null){if(n.flags|=128,o=!0,s=e.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),hv(h,!0),h.tail===null&&h.tailMode==="hidden"&&!f.alternate&&!Ur)return fs(n),null}else 2*ci()-h.renderingStartTime>Rf&&s!==1073741824&&(n.flags|=128,o=!0,hv(h,!1),n.lanes=4194304);h.isBackwards?(f.sibling=n.child,n.child=f):(s=h.last,s!==null?s.sibling=f:n.child=f,h.last=f)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=ci(),n.sibling=null,s=Kr.current,br(Kr,o?s&1|2:s&1),n):(fs(n),null);case 22:case 23:return Aj(),o=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(n.flags|=8192),o&&n.mode&1?Ca&1073741824&&(fs(n),n.subtreeFlags&6&&(n.flags|=8192)):fs(n),null;case 24:return null;case 25:return null}throw Error(ot(156,n.tag))}function _Ee(e,n){switch(lj(n),n.tag){case 1:return aa(n.type)&&Ow(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Nf(),Ir(sa),Ir(ws),yj(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return vj(n),null;case 13:if(Ir(Kr),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(ot(340));Sf()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Ir(Kr),null;case 4:return Nf(),null;case 10:return pj(n.type._context),null;case 22:case 23:return Aj(),null;case 24:return null;default:return null}}var kE=!1,ys=!1,EEe=typeof WeakSet=="function"?WeakSet:Set,At=null;function rf(e,n){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(o){ni(e,n,o)}else s.current=null}function j2(e,n,s){try{s()}catch(o){ni(e,n,o)}}var w7=!1;function wEe(e,n){if(v2=Cw,e=CX(),oj(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var o=s.getSelection&&s.getSelection();if(o&&o.rangeCount!==0){s=o.anchorNode;var d=o.anchorOffset,h=o.focusNode;o=o.focusOffset;try{s.nodeType,h.nodeType}catch{s=null;break e}var f=0,v=-1,b=-1,_=0,w=0,E=e,N=null;t:for(;;){for(var I;E!==s||d!==0&&E.nodeType!==3||(v=f+d),E!==h||o!==0&&E.nodeType!==3||(b=f+o),E.nodeType===3&&(f+=E.nodeValue.length),(I=E.firstChild)!==null;)N=E,E=I;for(;;){if(E===e)break t;if(N===s&&++_===d&&(v=f),N===h&&++w===o&&(b=f),(I=E.nextSibling)!==null)break;E=N,N=E.parentNode}E=I}s=v===-1||b===-1?null:{start:v,end:b}}else s=null}s=s||{start:0,end:0}}else s=null;for(y2={focusedElem:e,selectionRange:s},Cw=!1,At=n;At!==null;)if(n=At,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,At=e;else for(;At!==null;){n=At;try{var R=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var O=R.memoizedProps,P=R.memoizedState,M=n.stateNode,D=M.getSnapshotBeforeUpdate(n.elementType===n.type?O:ic(n.type,O),P);M.__reactInternalSnapshotBeforeUpdate=D}break;case 3:var U=n.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ot(163))}}catch(B){ni(n,n.return,B)}if(e=n.sibling,e!==null){e.return=n.return,At=e;break}At=n.return}return R=w7,w7=!1,R}function Bv(e,n,s){var o=n.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var d=o=o.next;do{if((d.tag&e)===e){var h=d.destroy;d.destroy=void 0,h!==void 0&&j2(n,s,h)}d=d.next}while(d!==o)}}function uT(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var o=s.create;s.destroy=o()}s=s.next}while(s!==n)}}function D2(e){var n=e.ref;if(n!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof n=="function"?n(e):n.current=e}}function wJ(e){var n=e.alternate;n!==null&&(e.alternate=null,wJ(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[Hc],delete n[sy],delete n[_2],delete n[sEe],delete n[aEe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function SJ(e){return e.tag===5||e.tag===3||e.tag===4}function S7(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||SJ(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function L2(e,n,s){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?s.nodeType===8?s.parentNode.insertBefore(e,n):s.insertBefore(e,n):(s.nodeType===8?(n=s.parentNode,n.insertBefore(e,s)):(n=s,n.appendChild(e)),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=Iw));else if(o!==4&&(e=e.child,e!==null))for(L2(e,n,s),e=e.sibling;e!==null;)L2(e,n,s),e=e.sibling}function M2(e,n,s){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?s.insertBefore(e,n):s.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(M2(e,n,s),e=e.sibling;e!==null;)M2(e,n,s),e=e.sibling}var es=null,sc=!1;function Dd(e,n,s){for(s=s.child;s!==null;)TJ(e,n,s),s=s.sibling}function TJ(e,n,s){if(Xc&&typeof Xc.onCommitFiberUnmount=="function")try{Xc.onCommitFiberUnmount(rT,s)}catch{}switch(s.tag){case 5:ys||rf(s,n);case 6:var o=es,d=sc;es=null,Dd(e,n,s),es=o,sc=d,es!==null&&(sc?(e=es,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):es.removeChild(s.stateNode));break;case 18:es!==null&&(sc?(e=es,s=s.stateNode,e.nodeType===8?JI(e.parentNode,s):e.nodeType===1&&JI(e,s),ey(e)):JI(es,s.stateNode));break;case 4:o=es,d=sc,es=s.stateNode.containerInfo,sc=!0,Dd(e,n,s),es=o,sc=d;break;case 0:case 11:case 14:case 15:if(!ys&&(o=s.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){d=o=o.next;do{var h=d,f=h.destroy;h=h.tag,f!==void 0&&(h&2||h&4)&&j2(s,n,f),d=d.next}while(d!==o)}Dd(e,n,s);break;case 1:if(!ys&&(rf(s,n),o=s.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=s.memoizedProps,o.state=s.memoizedState,o.componentWillUnmount()}catch(v){ni(s,n,v)}Dd(e,n,s);break;case 21:Dd(e,n,s);break;case 22:s.mode&1?(ys=(o=ys)||s.memoizedState!==null,Dd(e,n,s),ys=o):Dd(e,n,s);break;default:Dd(e,n,s)}}function T7(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new EEe),n.forEach(function(o){var d=PEe.bind(null,e,o);s.has(o)||(s.add(o),o.then(d,d))})}}function ec(e,n){var s=n.deletions;if(s!==null)for(var o=0;o<s.length;o++){var d=s[o];try{var h=e,f=n,v=f;e:for(;v!==null;){switch(v.tag){case 5:es=v.stateNode,sc=!1;break e;case 3:es=v.stateNode.containerInfo,sc=!0;break e;case 4:es=v.stateNode.containerInfo,sc=!0;break e}v=v.return}if(es===null)throw Error(ot(160));TJ(h,f,d),es=null,sc=!1;var b=d.alternate;b!==null&&(b.return=null),d.return=null}catch(_){ni(d,n,_)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)NJ(n,e),n=n.sibling}function NJ(e,n){var s=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ec(n,e),Bc(e),o&4){try{Bv(3,e,e.return),uT(3,e)}catch(O){ni(e,e.return,O)}try{Bv(5,e,e.return)}catch(O){ni(e,e.return,O)}}break;case 1:ec(n,e),Bc(e),o&512&&s!==null&&rf(s,s.return);break;case 5:if(ec(n,e),Bc(e),o&512&&s!==null&&rf(s,s.return),e.flags&32){var d=e.stateNode;try{Xv(d,"")}catch(O){ni(e,e.return,O)}}if(o&4&&(d=e.stateNode,d!=null)){var h=e.memoizedProps,f=s!==null?s.memoizedProps:h,v=e.type,b=e.updateQueue;if(e.updateQueue=null,b!==null)try{v==="input"&&h.type==="radio"&&h.name!=null&&Yq(d,h),o2(v,f);var _=o2(v,h);for(f=0;f<b.length;f+=2){var w=b[f],E=b[f+1];w==="style"?Zq(d,E):w==="dangerouslySetInnerHTML"?Jq(d,E):w==="children"?Xv(d,E):Yk(d,w,E,_)}switch(v){case"input":n2(d,h);break;case"textarea":qq(d,h);break;case"select":var N=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!h.multiple;var I=h.value;I!=null?lf(d,!!h.multiple,I,!1):N!==!!h.multiple&&(h.defaultValue!=null?lf(d,!!h.multiple,h.defaultValue,!0):lf(d,!!h.multiple,h.multiple?[]:"",!1))}d[sy]=h}catch(O){ni(e,e.return,O)}}break;case 6:if(ec(n,e),Bc(e),o&4){if(e.stateNode===null)throw Error(ot(162));d=e.stateNode,h=e.memoizedProps;try{d.nodeValue=h}catch(O){ni(e,e.return,O)}}break;case 3:if(ec(n,e),Bc(e),o&4&&s!==null&&s.memoizedState.isDehydrated)try{ey(n.containerInfo)}catch(O){ni(e,e.return,O)}break;case 4:ec(n,e),Bc(e);break;case 13:ec(n,e),Bc(e),d=e.child,d.flags&8192&&(h=d.memoizedState!==null,d.stateNode.isHidden=h,!h||d.alternate!==null&&d.alternate.memoizedState!==null||(Cj=ci())),o&4&&T7(e);break;case 22:if(w=s!==null&&s.memoizedState!==null,e.mode&1?(ys=(_=ys)||w,ec(n,e),ys=_):ec(n,e),Bc(e),o&8192){if(_=e.memoizedState!==null,(e.stateNode.isHidden=_)&&!w&&e.mode&1)for(At=e,w=e.child;w!==null;){for(E=At=w;At!==null;){switch(N=At,I=N.child,N.tag){case 0:case 11:case 14:case 15:Bv(4,N,N.return);break;case 1:rf(N,N.return);var R=N.stateNode;if(typeof R.componentWillUnmount=="function"){o=N,s=N.return;try{n=o,R.props=n.memoizedProps,R.state=n.memoizedState,R.componentWillUnmount()}catch(O){ni(o,s,O)}}break;case 5:rf(N,N.return);break;case 22:if(N.memoizedState!==null){C7(E);continue}}I!==null?(I.return=N,At=I):C7(E)}w=w.sibling}e:for(w=null,E=e;;){if(E.tag===5){if(w===null){w=E;try{d=E.stateNode,_?(h=d.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(v=E.stateNode,b=E.memoizedProps.style,f=b!=null&&b.hasOwnProperty("display")?b.display:null,v.style.display=Qq("display",f))}catch(O){ni(e,e.return,O)}}}else if(E.tag===6){if(w===null)try{E.stateNode.nodeValue=_?"":E.memoizedProps}catch(O){ni(e,e.return,O)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===e)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===e)break e;for(;E.sibling===null;){if(E.return===null||E.return===e)break e;w===E&&(w=null),E=E.return}w===E&&(w=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:ec(n,e),Bc(e),o&4&&T7(e);break;case 21:break;default:ec(n,e),Bc(e)}}function Bc(e){var n=e.flags;if(n&2){try{e:{for(var s=e.return;s!==null;){if(SJ(s)){var o=s;break e}s=s.return}throw Error(ot(160))}switch(o.tag){case 5:var d=o.stateNode;o.flags&32&&(Xv(d,""),o.flags&=-33);var h=S7(e);M2(e,h,d);break;case 3:case 4:var f=o.stateNode.containerInfo,v=S7(e);L2(e,v,f);break;default:throw Error(ot(161))}}catch(b){ni(e,e.return,b)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function SEe(e,n,s){At=e,CJ(e)}function CJ(e,n,s){for(var o=(e.mode&1)!==0;At!==null;){var d=At,h=d.child;if(d.tag===22&&o){var f=d.memoizedState!==null||kE;if(!f){var v=d.alternate,b=v!==null&&v.memoizedState!==null||ys;v=kE;var _=ys;if(kE=f,(ys=b)&&!_)for(At=d;At!==null;)f=At,b=f.child,f.tag===22&&f.memoizedState!==null?R7(d):b!==null?(b.return=f,At=b):R7(d);for(;h!==null;)At=h,CJ(h),h=h.sibling;At=d,kE=v,ys=_}N7(e)}else d.subtreeFlags&8772&&h!==null?(h.return=d,At=h):N7(e)}}function N7(e){for(;At!==null;){var n=At;if(n.flags&8772){var s=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:ys||uT(5,n);break;case 1:var o=n.stateNode;if(n.flags&4&&!ys)if(s===null)o.componentDidMount();else{var d=n.elementType===n.type?s.memoizedProps:ic(n.type,s.memoizedProps);o.componentDidUpdate(d,s.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var h=n.updateQueue;h!==null&&d7(n,h,o);break;case 3:var f=n.updateQueue;if(f!==null){if(s=null,n.child!==null)switch(n.child.tag){case 5:s=n.child.stateNode;break;case 1:s=n.child.stateNode}d7(n,f,s)}break;case 5:var v=n.stateNode;if(s===null&&n.flags&4){s=v;var b=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":b.autoFocus&&s.focus();break;case"img":b.src&&(s.src=b.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var _=n.alternate;if(_!==null){var w=_.memoizedState;if(w!==null){var E=w.dehydrated;E!==null&&ey(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ot(163))}ys||n.flags&512&&D2(n)}catch(N){ni(n,n.return,N)}}if(n===e){At=null;break}if(s=n.sibling,s!==null){s.return=n.return,At=s;break}At=n.return}}function C7(e){for(;At!==null;){var n=At;if(n===e){At=null;break}var s=n.sibling;if(s!==null){s.return=n.return,At=s;break}At=n.return}}function R7(e){for(;At!==null;){var n=At;try{switch(n.tag){case 0:case 11:case 15:var s=n.return;try{uT(4,n)}catch(b){ni(n,s,b)}break;case 1:var o=n.stateNode;if(typeof o.componentDidMount=="function"){var d=n.return;try{o.componentDidMount()}catch(b){ni(n,d,b)}}var h=n.return;try{D2(n)}catch(b){ni(n,h,b)}break;case 5:var f=n.return;try{D2(n)}catch(b){ni(n,f,b)}}}catch(b){ni(n,n.return,b)}if(n===e){At=null;break}var v=n.sibling;if(v!==null){v.return=n.return,At=v;break}At=n.return}}var TEe=Math.ceil,Bw=Ql.ReactCurrentDispatcher,Tj=Ql.ReactCurrentOwner,bo=Ql.ReactCurrentBatchConfig,Bn=0,Bi=null,gi=null,is=0,Ca=0,sf=vu(0),Ni=0,uy=null,qh=0,hT=0,Nj=0,Gv=null,ta=null,Cj=0,Rf=1/0,Nl=null,Gw=!1,U2=null,iu=null,jE=!1,Yd=null,Ww=0,Wv=0,F2=null,uw=-1,hw=0;function js(){return Bn&6?ci():uw!==-1?uw:uw=ci()}function su(e){return e.mode&1?Bn&2&&is!==0?is&-is:cEe.transition!==null?(hw===0&&(hw=uX()),hw):(e=ir,e!==0||(e=window.event,e=e===void 0?16:yX(e.type)),e):1}function hc(e,n,s,o){if(50<Wv)throw Wv=0,F2=null,Error(ot(185));Zy(e,s,o),(!(Bn&2)||e!==Bi)&&(e===Bi&&(!(Bn&2)&&(hT|=s),Ni===4&&Gd(e,is)),oa(e,o),s===1&&Bn===0&&!(n.mode&1)&&(Rf=ci()+500,cT&&yu()))}function oa(e,n){var s=e.callbackNode;c_e(e,n);var o=Nw(e,e===Bi?is:0);if(o===0)s!==null&&Mz(s),e.callbackNode=null,e.callbackPriority=0;else if(n=o&-o,e.callbackPriority!==n){if(s!=null&&Mz(s),n===1)e.tag===0?oEe(A7.bind(null,e)):MX(A7.bind(null,e)),rEe(function(){!(Bn&6)&&yu()}),s=null;else{switch(hX(o)){case 1:s=Zk;break;case 4:s=lX;break;case 16:s=Tw;break;case 536870912:s=dX;break;default:s=Tw}s=DJ(s,RJ.bind(null,e))}e.callbackPriority=n,e.callbackNode=s}}function RJ(e,n){if(uw=-1,hw=0,Bn&6)throw Error(ot(327));var s=e.callbackNode;if(mf()&&e.callbackNode!==s)return null;var o=Nw(e,e===Bi?is:0);if(o===0)return null;if(o&30||o&e.expiredLanes||n)n=$w(e,o);else{n=o;var d=Bn;Bn|=2;var h=IJ();(Bi!==e||is!==n)&&(Nl=null,Rf=ci()+500,Vh(e,n));do try{REe();break}catch(v){AJ(e,v)}while(!0);hj(),Bw.current=h,Bn=d,gi!==null?n=0:(Bi=null,is=0,n=Ni)}if(n!==0){if(n===2&&(d=h2(e),d!==0&&(o=d,n=V2(e,d))),n===1)throw s=uy,Vh(e,0),Gd(e,o),oa(e,ci()),s;if(n===6)Gd(e,o);else{if(d=e.current.alternate,!(o&30)&&!NEe(d)&&(n=$w(e,o),n===2&&(h=h2(e),h!==0&&(o=h,n=V2(e,h))),n===1))throw s=uy,Vh(e,0),Gd(e,o),oa(e,ci()),s;switch(e.finishedWork=d,e.finishedLanes=o,n){case 0:case 1:throw Error(ot(345));case 2:Sh(e,ta,Nl);break;case 3:if(Gd(e,o),(o&130023424)===o&&(n=Cj+500-ci(),10<n)){if(Nw(e,0)!==0)break;if(d=e.suspendedLanes,(d&o)!==o){js(),e.pingedLanes|=e.suspendedLanes&d;break}e.timeoutHandle=x2(Sh.bind(null,e,ta,Nl),n);break}Sh(e,ta,Nl);break;case 4:if(Gd(e,o),(o&4194240)===o)break;for(n=e.eventTimes,d=-1;0<o;){var f=31-uc(o);h=1<<f,f=n[f],f>d&&(d=f),o&=~h}if(o=d,o=ci()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*TEe(o/1960))-o,10<o){e.timeoutHandle=x2(Sh.bind(null,e,ta,Nl),o);break}Sh(e,ta,Nl);break;case 5:Sh(e,ta,Nl);break;default:throw Error(ot(329))}}}return oa(e,ci()),e.callbackNode===s?RJ.bind(null,e):null}function V2(e,n){var s=Gv;return e.current.memoizedState.isDehydrated&&(Vh(e,n).flags|=256),e=$w(e,n),e!==2&&(n=ta,ta=s,n!==null&&B2(n)),e}function B2(e){ta===null?ta=e:ta.push.apply(ta,e)}function NEe(e){for(var n=e;;){if(n.flags&16384){var s=n.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var o=0;o<s.length;o++){var d=s[o],h=d.getSnapshot;d=d.value;try{if(!pc(h(),d))return!1}catch{return!1}}}if(s=n.child,n.subtreeFlags&16384&&s!==null)s.return=n,n=s;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Gd(e,n){for(n&=~Nj,n&=~hT,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var s=31-uc(n),o=1<<s;e[s]=-1,n&=~o}}function A7(e){if(Bn&6)throw Error(ot(327));mf();var n=Nw(e,0);if(!(n&1))return oa(e,ci()),null;var s=$w(e,n);if(e.tag!==0&&s===2){var o=h2(e);o!==0&&(n=o,s=V2(e,o))}if(s===1)throw s=uy,Vh(e,0),Gd(e,n),oa(e,ci()),s;if(s===6)throw Error(ot(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,Sh(e,ta,Nl),oa(e,ci()),null}function Rj(e,n){var s=Bn;Bn|=1;try{return e(n)}finally{Bn=s,Bn===0&&(Rf=ci()+500,cT&&yu())}}function Xh(e){Yd!==null&&Yd.tag===0&&!(Bn&6)&&mf();var n=Bn;Bn|=1;var s=bo.transition,o=ir;try{if(bo.transition=null,ir=1,e)return e()}finally{ir=o,bo.transition=s,Bn=n,!(Bn&6)&&yu()}}function Aj(){Ca=sf.current,Ir(sf)}function Vh(e,n){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,nEe(s)),gi!==null)for(s=gi.return;s!==null;){var o=s;switch(lj(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&Ow();break;case 3:Nf(),Ir(sa),Ir(ws),yj();break;case 5:vj(o);break;case 4:Nf();break;case 13:Ir(Kr);break;case 19:Ir(Kr);break;case 10:pj(o.type._context);break;case 22:case 23:Aj()}s=s.return}if(Bi=e,gi=e=au(e.current,null),is=Ca=n,Ni=0,uy=null,Nj=hT=qh=0,ta=Gv=null,Oh!==null){for(n=0;n<Oh.length;n++)if(s=Oh[n],o=s.interleaved,o!==null){s.interleaved=null;var d=o.next,h=s.pending;if(h!==null){var f=h.next;h.next=d,o.next=f}s.pending=o}Oh=null}return e}function AJ(e,n){do{var s=gi;try{if(hj(),cw.current=Vw,Fw){for(var o=Yr.memoizedState;o!==null;){var d=o.queue;d!==null&&(d.pending=null),o=o.next}Fw=!1}if(Yh=0,Vi=Si=Yr=null,Vv=!1,cy=0,Tj.current=null,s===null||s.return===null){Ni=1,uy=n,gi=null;break}e:{var h=e,f=s.return,v=s,b=n;if(n=is,v.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){var _=b,w=v,E=w.tag;if(!(w.mode&1)&&(E===0||E===11||E===15)){var N=w.alternate;N?(w.updateQueue=N.updateQueue,w.memoizedState=N.memoizedState,w.lanes=N.lanes):(w.updateQueue=null,w.memoizedState=null)}var I=g7(f);if(I!==null){I.flags&=-257,v7(I,f,v,h,n),I.mode&1&&f7(h,_,n),n=I,b=_;var R=n.updateQueue;if(R===null){var O=new Set;O.add(b),n.updateQueue=O}else R.add(b);break e}else{if(!(n&1)){f7(h,_,n),Ij();break e}b=Error(ot(426))}}else if(Ur&&v.mode&1){var P=g7(f);if(P!==null){!(P.flags&65536)&&(P.flags|=256),v7(P,f,v,h,n),dj(Cf(b,v));break e}}h=b=Cf(b,v),Ni!==4&&(Ni=2),Gv===null?Gv=[h]:Gv.push(h),h=f;do{switch(h.tag){case 3:h.flags|=65536,n&=-n,h.lanes|=n;var M=hJ(h,b,n);l7(h,M);break e;case 1:v=b;var D=h.type,U=h.stateNode;if(!(h.flags&128)&&(typeof D.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(iu===null||!iu.has(U)))){h.flags|=65536,n&=-n,h.lanes|=n;var B=pJ(h,v,n);l7(h,B);break e}}h=h.return}while(h!==null)}PJ(s)}catch(G){n=G,gi===s&&s!==null&&(gi=s=s.return);continue}break}while(!0)}function IJ(){var e=Bw.current;return Bw.current=Vw,e===null?Vw:e}function Ij(){(Ni===0||Ni===3||Ni===2)&&(Ni=4),Bi===null||!(qh&268435455)&&!(hT&268435455)||Gd(Bi,is)}function $w(e,n){var s=Bn;Bn|=2;var o=IJ();(Bi!==e||is!==n)&&(Nl=null,Vh(e,n));do try{CEe();break}catch(d){AJ(e,d)}while(!0);if(hj(),Bn=s,Bw.current=o,gi!==null)throw Error(ot(261));return Bi=null,is=0,Ni}function CEe(){for(;gi!==null;)OJ(gi)}function REe(){for(;gi!==null&&!Zxe();)OJ(gi)}function OJ(e){var n=jJ(e.alternate,e,Ca);e.memoizedProps=e.pendingProps,n===null?PJ(e):gi=n,Tj.current=null}function PJ(e){var n=e;do{var s=n.alternate;if(e=n.return,n.flags&32768){if(s=_Ee(s,n),s!==null){s.flags&=32767,gi=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ni=6,gi=null;return}}else if(s=xEe(s,n,Ca),s!==null){gi=s;return}if(n=n.sibling,n!==null){gi=n;return}gi=n=e}while(n!==null);Ni===0&&(Ni=5)}function Sh(e,n,s){var o=ir,d=bo.transition;try{bo.transition=null,ir=1,AEe(e,n,s,o)}finally{bo.transition=d,ir=o}return null}function AEe(e,n,s,o){do mf();while(Yd!==null);if(Bn&6)throw Error(ot(327));s=e.finishedWork;var d=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(ot(177));e.callbackNode=null,e.callbackPriority=0;var h=s.lanes|s.childLanes;if(l_e(e,h),e===Bi&&(gi=Bi=null,is=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||jE||(jE=!0,DJ(Tw,function(){return mf(),null})),h=(s.flags&15990)!==0,s.subtreeFlags&15990||h){h=bo.transition,bo.transition=null;var f=ir;ir=1;var v=Bn;Bn|=4,Tj.current=null,wEe(e,s),NJ(s,e),q_e(y2),Cw=!!v2,y2=v2=null,e.current=s,SEe(s),e_e(),Bn=v,ir=f,bo.transition=h}else e.current=s;if(jE&&(jE=!1,Yd=e,Ww=d),h=e.pendingLanes,h===0&&(iu=null),r_e(s.stateNode),oa(e,ci()),n!==null)for(o=e.onRecoverableError,s=0;s<n.length;s++)d=n[s],o(d.value,{componentStack:d.stack,digest:d.digest});if(Gw)throw Gw=!1,e=U2,U2=null,e;return Ww&1&&e.tag!==0&&mf(),h=e.pendingLanes,h&1?e===F2?Wv++:(Wv=0,F2=e):Wv=0,yu(),null}function mf(){if(Yd!==null){var e=hX(Ww),n=bo.transition,s=ir;try{if(bo.transition=null,ir=16>e?16:e,Yd===null)var o=!1;else{if(e=Yd,Yd=null,Ww=0,Bn&6)throw Error(ot(331));var d=Bn;for(Bn|=4,At=e.current;At!==null;){var h=At,f=h.child;if(At.flags&16){var v=h.deletions;if(v!==null){for(var b=0;b<v.length;b++){var _=v[b];for(At=_;At!==null;){var w=At;switch(w.tag){case 0:case 11:case 15:Bv(8,w,h)}var E=w.child;if(E!==null)E.return=w,At=E;else for(;At!==null;){w=At;var N=w.sibling,I=w.return;if(wJ(w),w===_){At=null;break}if(N!==null){N.return=I,At=N;break}At=I}}}var R=h.alternate;if(R!==null){var O=R.child;if(O!==null){R.child=null;do{var P=O.sibling;O.sibling=null,O=P}while(O!==null)}}At=h}}if(h.subtreeFlags&2064&&f!==null)f.return=h,At=f;else e:for(;At!==null;){if(h=At,h.flags&2048)switch(h.tag){case 0:case 11:case 15:Bv(9,h,h.return)}var M=h.sibling;if(M!==null){M.return=h.return,At=M;break e}At=h.return}}var D=e.current;for(At=D;At!==null;){f=At;var U=f.child;if(f.subtreeFlags&2064&&U!==null)U.return=f,At=U;else e:for(f=D;At!==null;){if(v=At,v.flags&2048)try{switch(v.tag){case 0:case 11:case 15:uT(9,v)}}catch(G){ni(v,v.return,G)}if(v===f){At=null;break e}var B=v.sibling;if(B!==null){B.return=v.return,At=B;break e}At=v.return}}if(Bn=d,yu(),Xc&&typeof Xc.onPostCommitFiberRoot=="function")try{Xc.onPostCommitFiberRoot(rT,e)}catch{}o=!0}return o}finally{ir=s,bo.transition=n}}return!1}function I7(e,n,s){n=Cf(s,n),n=hJ(e,n,1),e=ru(e,n,1),n=js(),e!==null&&(Zy(e,1,n),oa(e,n))}function ni(e,n,s){if(e.tag===3)I7(e,e,s);else for(;n!==null;){if(n.tag===3){I7(n,e,s);break}else if(n.tag===1){var o=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(iu===null||!iu.has(o))){e=Cf(s,e),e=pJ(n,e,1),n=ru(n,e,1),e=js(),n!==null&&(Zy(n,1,e),oa(n,e));break}}n=n.return}}function IEe(e,n,s){var o=e.pingCache;o!==null&&o.delete(n),n=js(),e.pingedLanes|=e.suspendedLanes&s,Bi===e&&(is&s)===s&&(Ni===4||Ni===3&&(is&130023424)===is&&500>ci()-Cj?Vh(e,0):Nj|=s),oa(e,n)}function kJ(e,n){n===0&&(e.mode&1?(n=SE,SE<<=1,!(SE&130023424)&&(SE=4194304)):n=1);var s=js();e=$l(e,n),e!==null&&(Zy(e,n,s),oa(e,s))}function OEe(e){var n=e.memoizedState,s=0;n!==null&&(s=n.retryLane),kJ(e,s)}function PEe(e,n){var s=0;switch(e.tag){case 13:var o=e.stateNode,d=e.memoizedState;d!==null&&(s=d.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(ot(314))}o!==null&&o.delete(n),kJ(e,s)}var jJ;jJ=function(e,n,s){if(e!==null)if(e.memoizedProps!==n.pendingProps||sa.current)na=!0;else{if(!(e.lanes&s)&&!(n.flags&128))return na=!1,bEe(e,n,s);na=!!(e.flags&131072)}else na=!1,Ur&&n.flags&1048576&&UX(n,jw,n.index);switch(n.lanes=0,n.tag){case 2:var o=n.type;dw(e,n),e=n.pendingProps;var d=wf(n,ws.current);pf(n,s),d=xj(null,n,o,e,d,s);var h=_j();return n.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,aa(o)?(h=!0,Pw(n)):h=!1,n.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,fj(n),d.updater=dT,n.stateNode=d,d._reactInternals=n,C2(n,o,e,s),n=I2(null,n,o,!0,h,s)):(n.tag=0,Ur&&h&&cj(n),Ps(null,n,d,s),n=n.child),n;case 16:o=n.elementType;e:{switch(dw(e,n),e=n.pendingProps,d=o._init,o=d(o._payload),n.type=o,d=n.tag=jEe(o),e=ic(o,e),d){case 0:n=A2(null,n,o,e,s);break e;case 1:n=x7(null,n,o,e,s);break e;case 11:n=y7(null,n,o,e,s);break e;case 14:n=b7(null,n,o,ic(o.type,e),s);break e}throw Error(ot(306,o,""))}return n;case 0:return o=n.type,d=n.pendingProps,d=n.elementType===o?d:ic(o,d),A2(e,n,o,d,s);case 1:return o=n.type,d=n.pendingProps,d=n.elementType===o?d:ic(o,d),x7(e,n,o,d,s);case 3:e:{if(vJ(n),e===null)throw Error(ot(387));o=n.pendingProps,h=n.memoizedState,d=h.element,$X(e,n),Mw(n,o,null,s);var f=n.memoizedState;if(o=f.element,h.isDehydrated)if(h={element:o,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},n.updateQueue.baseState=h,n.memoizedState=h,n.flags&256){d=Cf(Error(ot(423)),n),n=_7(e,n,o,s,d);break e}else if(o!==d){d=Cf(Error(ot(424)),n),n=_7(e,n,o,s,d);break e}else for(Oa=nu(n.stateNode.containerInfo.firstChild),Da=n,Ur=!0,cc=null,s=GX(n,null,o,s),n.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Sf(),o===d){n=zl(e,n,s);break e}Ps(e,n,o,s)}n=n.child}return n;case 5:return zX(n),e===null&&S2(n),o=n.type,d=n.pendingProps,h=e!==null?e.memoizedProps:null,f=d.children,b2(o,d)?f=null:h!==null&&b2(o,h)&&(n.flags|=32),gJ(e,n),Ps(e,n,f,s),n.child;case 6:return e===null&&S2(n),null;case 13:return yJ(e,n,s);case 4:return gj(n,n.stateNode.containerInfo),o=n.pendingProps,e===null?n.child=Tf(n,null,o,s):Ps(e,n,o,s),n.child;case 11:return o=n.type,d=n.pendingProps,d=n.elementType===o?d:ic(o,d),y7(e,n,o,d,s);case 7:return Ps(e,n,n.pendingProps,s),n.child;case 8:return Ps(e,n,n.pendingProps.children,s),n.child;case 12:return Ps(e,n,n.pendingProps.children,s),n.child;case 10:e:{if(o=n.type._context,d=n.pendingProps,h=n.memoizedProps,f=d.value,br(Dw,o._currentValue),o._currentValue=f,h!==null)if(pc(h.value,f)){if(h.children===d.children&&!sa.current){n=zl(e,n,s);break e}}else for(h=n.child,h!==null&&(h.return=n);h!==null;){var v=h.dependencies;if(v!==null){f=h.child;for(var b=v.firstContext;b!==null;){if(b.context===o){if(h.tag===1){b=Dl(-1,s&-s),b.tag=2;var _=h.updateQueue;if(_!==null){_=_.shared;var w=_.pending;w===null?b.next=b:(b.next=w.next,w.next=b),_.pending=b}}h.lanes|=s,b=h.alternate,b!==null&&(b.lanes|=s),T2(h.return,s,n),v.lanes|=s;break}b=b.next}}else if(h.tag===10)f=h.type===n.type?null:h.child;else if(h.tag===18){if(f=h.return,f===null)throw Error(ot(341));f.lanes|=s,v=f.alternate,v!==null&&(v.lanes|=s),T2(f,s,n),f=h.sibling}else f=h.child;if(f!==null)f.return=h;else for(f=h;f!==null;){if(f===n){f=null;break}if(h=f.sibling,h!==null){h.return=f.return,f=h;break}f=f.return}h=f}Ps(e,n,d.children,s),n=n.child}return n;case 9:return d=n.type,o=n.pendingProps.children,pf(n,s),d=wo(d),o=o(d),n.flags|=1,Ps(e,n,o,s),n.child;case 14:return o=n.type,d=ic(o,n.pendingProps),d=ic(o.type,d),b7(e,n,o,d,s);case 15:return mJ(e,n,n.type,n.pendingProps,s);case 17:return o=n.type,d=n.pendingProps,d=n.elementType===o?d:ic(o,d),dw(e,n),n.tag=1,aa(o)?(e=!0,Pw(n)):e=!1,pf(n,s),uJ(n,o,d),C2(n,o,d,s),I2(null,n,o,!0,e,s);case 19:return bJ(e,n,s);case 22:return fJ(e,n,s)}throw Error(ot(156,n.tag))};function DJ(e,n){return cX(e,n)}function kEe(e,n,s,o){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function go(e,n,s,o){return new kEe(e,n,s,o)}function Oj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function jEe(e){if(typeof e=="function")return Oj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xk)return 11;if(e===Jk)return 14}return 2}function au(e,n){var s=e.alternate;return s===null?(s=go(e.tag,n,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=n,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,n=e.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function pw(e,n,s,o,d,h){var f=2;if(o=e,typeof e=="function")Oj(e)&&(f=1);else if(typeof e=="string")f=5;else e:switch(e){case Ym:return Bh(s.children,d,h,n);case qk:f=8,d|=8;break;case JO:return e=go(12,s,n,d|2),e.elementType=JO,e.lanes=h,e;case QO:return e=go(13,s,n,d),e.elementType=QO,e.lanes=h,e;case ZO:return e=go(19,s,n,d),e.elementType=ZO,e.lanes=h,e;case zq:return pT(s,d,h,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Wq:f=10;break e;case $q:f=9;break e;case Xk:f=11;break e;case Jk:f=14;break e;case Ud:f=16,o=null;break e}throw Error(ot(130,e==null?e:typeof e,""))}return n=go(f,s,n,d),n.elementType=e,n.type=o,n.lanes=h,n}function Bh(e,n,s,o){return e=go(7,e,o,n),e.lanes=s,e}function pT(e,n,s,o){return e=go(22,e,o,n),e.elementType=zq,e.lanes=s,e.stateNode={isHidden:!1},e}function sO(e,n,s){return e=go(6,e,null,n),e.lanes=s,e}function aO(e,n,s){return n=go(4,e.children!==null?e.children:[],e.key,n),n.lanes=s,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function DEe(e,n,s,o,d){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=VI(0),this.expirationTimes=VI(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=VI(0),this.identifierPrefix=o,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function Pj(e,n,s,o,d,h,f,v,b){return e=new DEe(e,n,s,v,b),n===1?(n=1,h===!0&&(n|=8)):n=0,h=go(3,null,null,n),e.current=h,h.stateNode=e,h.memoizedState={element:o,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},fj(h),e}function LEe(e,n,s){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Km,key:o==null?null:""+o,children:e,containerInfo:n,implementation:s}}function LJ(e){if(!e)return pu;e=e._reactInternals;e:{if(ap(e)!==e||e.tag!==1)throw Error(ot(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(aa(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(ot(171))}if(e.tag===1){var s=e.type;if(aa(s))return LX(e,s,n)}return n}function MJ(e,n,s,o,d,h,f,v,b){return e=Pj(s,o,!0,e,d,h,f,v,b),e.context=LJ(null),s=e.current,o=js(),d=su(s),h=Dl(o,d),h.callback=n??null,ru(s,h,d),e.current.lanes=d,Zy(e,d,o),oa(e,o),e}function mT(e,n,s,o){var d=n.current,h=js(),f=su(d);return s=LJ(s),n.context===null?n.context=s:n.pendingContext=s,n=Dl(h,f),n.payload={element:e},o=o===void 0?null:o,o!==null&&(n.callback=o),e=ru(d,n,f),e!==null&&(hc(e,d,f,h),ow(e,d,f)),f}function zw(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function O7(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<n?s:n}}function kj(e,n){O7(e,n),(e=e.alternate)&&O7(e,n)}function MEe(){return null}var UJ=typeof reportError=="function"?reportError:function(e){console.error(e)};function jj(e){this._internalRoot=e}fT.prototype.render=jj.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(ot(409));mT(e,n,null,null)};fT.prototype.unmount=jj.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Xh(function(){mT(null,e,null,null)}),n[Wl]=null}};function fT(e){this._internalRoot=e}fT.prototype.unstable_scheduleHydration=function(e){if(e){var n=fX();e={blockedOn:null,target:e,priority:n};for(var s=0;s<Bd.length&&n!==0&&n<Bd[s].priority;s++);Bd.splice(s,0,e),s===0&&vX(e)}};function Dj(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function gT(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function P7(){}function UEe(e,n,s,o,d){if(d){if(typeof o=="function"){var h=o;o=function(){var _=zw(f);h.call(_)}}var f=MJ(n,o,e,0,null,!1,!1,"",P7);return e._reactRootContainer=f,e[Wl]=f.current,ry(e.nodeType===8?e.parentNode:e),Xh(),f}for(;d=e.lastChild;)e.removeChild(d);if(typeof o=="function"){var v=o;o=function(){var _=zw(b);v.call(_)}}var b=Pj(e,0,!1,null,null,!1,!1,"",P7);return e._reactRootContainer=b,e[Wl]=b.current,ry(e.nodeType===8?e.parentNode:e),Xh(function(){mT(n,b,s,o)}),b}function vT(e,n,s,o,d){var h=s._reactRootContainer;if(h){var f=h;if(typeof d=="function"){var v=d;d=function(){var b=zw(f);v.call(b)}}mT(n,f,e,d)}else f=UEe(s,n,e,d,o);return zw(f)}pX=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var s=Ov(n.pendingLanes);s!==0&&(ej(n,s|1),oa(n,ci()),!(Bn&6)&&(Rf=ci()+500,yu()))}break;case 13:Xh(function(){var o=$l(e,1);if(o!==null){var d=js();hc(o,e,1,d)}}),kj(e,1)}};tj=function(e){if(e.tag===13){var n=$l(e,134217728);if(n!==null){var s=js();hc(n,e,134217728,s)}kj(e,134217728)}};mX=function(e){if(e.tag===13){var n=su(e),s=$l(e,n);if(s!==null){var o=js();hc(s,e,n,o)}kj(e,n)}};fX=function(){return ir};gX=function(e,n){var s=ir;try{return ir=e,n()}finally{ir=s}};l2=function(e,n,s){switch(n){case"input":if(n2(e,s),n=s.name,s.type==="radio"&&n!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<s.length;n++){var o=s[n];if(o!==e&&o.form===e.form){var d=oT(o);if(!d)throw Error(ot(90));Kq(o),n2(o,d)}}}break;case"textarea":qq(e,s);break;case"select":n=s.value,n!=null&&lf(e,!!s.multiple,n,!1)}};nX=Rj;rX=Xh;var FEe={usingClientEntryPoint:!1,Events:[tb,Qm,oT,eX,tX,Rj]},pv={findFiberByHostInstance:Ih,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},VEe={bundleType:pv.bundleType,version:pv.version,rendererPackageName:pv.rendererPackageName,rendererConfig:pv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ql.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=aX(e),e===null?null:e.stateNode},findFiberByHostInstance:pv.findFiberByHostInstance||MEe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var DE=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!DE.isDisabled&&DE.supportsFiber)try{rT=DE.inject(VEe),Xc=DE}catch{}}Ua.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FEe;Ua.createPortal=function(e,n){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dj(n))throw Error(ot(200));return LEe(e,n,null,s)};Ua.createRoot=function(e,n){if(!Dj(e))throw Error(ot(299));var s=!1,o="",d=UJ;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(d=n.onRecoverableError)),n=Pj(e,1,!1,null,null,s,!1,o,d),e[Wl]=n.current,ry(e.nodeType===8?e.parentNode:e),new jj(n)};Ua.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(ot(188)):(e=Object.keys(e).join(","),Error(ot(268,e)));return e=aX(n),e=e===null?null:e.stateNode,e};Ua.flushSync=function(e){return Xh(e)};Ua.hydrate=function(e,n,s){if(!gT(n))throw Error(ot(200));return vT(null,e,n,!0,s)};Ua.hydrateRoot=function(e,n,s){if(!Dj(e))throw Error(ot(405));var o=s!=null&&s.hydratedSources||null,d=!1,h="",f=UJ;if(s!=null&&(s.unstable_strictMode===!0&&(d=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onRecoverableError!==void 0&&(f=s.onRecoverableError)),n=MJ(n,null,e,1,s??null,d,!1,h,f),e[Wl]=n.current,ry(e),o)for(e=0;e<o.length;e++)s=o[e],d=s._getVersion,d=d(s._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[s,d]:n.mutableSourceEagerHydrationData.push(s,d);return new fT(n)};Ua.render=function(e,n,s){if(!gT(n))throw Error(ot(200));return vT(null,e,n,!1,s)};Ua.unmountComponentAtNode=function(e){if(!gT(e))throw Error(ot(40));return e._reactRootContainer?(Xh(function(){vT(null,null,e,!1,function(){e._reactRootContainer=null,e[Wl]=null})}),!0):!1};Ua.unstable_batchedUpdates=Rj;Ua.unstable_renderSubtreeIntoContainer=function(e,n,s,o){if(!gT(s))throw Error(ot(200));if(e==null||e._reactInternals===void 0)throw Error(ot(38));return vT(e,n,s,!1,o)};Ua.version="18.3.1-next-f1338f8080-20240426";function FJ(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FJ)}catch(e){console.error(e)}}FJ(),Fq.exports=Ua;var BEe=Fq.exports,k7=BEe;qO.createRoot=k7.createRoot,qO.hydrateRoot=k7.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hy(){return hy=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},hy.apply(this,arguments)}var qd;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(qd||(qd={}));const j7="popstate";function GEe(e){e===void 0&&(e={});function n(o,d){let{pathname:h,search:f,hash:v}=o.location;return G2("",{pathname:h,search:f,hash:v},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function s(o,d){return typeof d=="string"?d:Hw(d)}return $Ee(n,s,null,e)}function li(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Lj(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function WEe(){return Math.random().toString(36).substr(2,8)}function D7(e,n){return{usr:e.state,key:e.key,idx:n}}function G2(e,n,s,o){return s===void 0&&(s=null),hy({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?cg(n):n,{state:s,key:n&&n.key||o||WEe()})}function Hw(e){let{pathname:n="/",search:s="",hash:o=""}=e;return s&&s!=="?"&&(n+=s.charAt(0)==="?"?s:"?"+s),o&&o!=="#"&&(n+=o.charAt(0)==="#"?o:"#"+o),n}function cg(e){let n={};if(e){let s=e.indexOf("#");s>=0&&(n.hash=e.substr(s),e=e.substr(0,s));let o=e.indexOf("?");o>=0&&(n.search=e.substr(o),e=e.substr(0,o)),e&&(n.pathname=e)}return n}function $Ee(e,n,s,o){o===void 0&&(o={});let{window:d=document.defaultView,v5Compat:h=!1}=o,f=d.history,v=qd.Pop,b=null,_=w();_==null&&(_=0,f.replaceState(hy({},f.state,{idx:_}),""));function w(){return(f.state||{idx:null}).idx}function E(){v=qd.Pop;let P=w(),M=P==null?null:P-_;_=P,b&&b({action:v,location:O.location,delta:M})}function N(P,M){v=qd.Push;let D=G2(O.location,P,M);_=w()+1;let U=D7(D,_),B=O.createHref(D);try{f.pushState(U,"",B)}catch(G){if(G instanceof DOMException&&G.name==="DataCloneError")throw G;d.location.assign(B)}h&&b&&b({action:v,location:O.location,delta:1})}function I(P,M){v=qd.Replace;let D=G2(O.location,P,M);_=w();let U=D7(D,_),B=O.createHref(D);f.replaceState(U,"",B),h&&b&&b({action:v,location:O.location,delta:0})}function R(P){let M=d.location.origin!=="null"?d.location.origin:d.location.href,D=typeof P=="string"?P:Hw(P);return D=D.replace(/ $/,"%20"),li(M,"No window.location.(origin|href) available to create URL for href: "+D),new URL(D,M)}let O={get action(){return v},get location(){return e(d,f)},listen(P){if(b)throw new Error("A history only accepts one active listener");return d.addEventListener(j7,E),b=P,()=>{d.removeEventListener(j7,E),b=null}},createHref(P){return n(d,P)},createURL:R,encodeLocation(P){let M=R(P);return{pathname:M.pathname,search:M.search,hash:M.hash}},push:N,replace:I,go(P){return f.go(P)}};return O}var L7;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(L7||(L7={}));function zEe(e,n,s){return s===void 0&&(s="/"),HEe(e,n,s)}function HEe(e,n,s,o){let d=typeof n=="string"?cg(n):n,h=Mj(d.pathname||"/",s);if(h==null)return null;let f=VJ(e);KEe(f);let v=null;for(let b=0;v==null&&b<f.length;++b){let _=swe(h);v=nwe(f[b],_)}return v}function VJ(e,n,s,o){n===void 0&&(n=[]),s===void 0&&(s=[]),o===void 0&&(o="");let d=(h,f,v)=>{let b={relativePath:v===void 0?h.path||"":v,caseSensitive:h.caseSensitive===!0,childrenIndex:f,route:h};b.relativePath.startsWith("/")&&(li(b.relativePath.startsWith(o),'Absolute route path "'+b.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),b.relativePath=b.relativePath.slice(o.length));let _=ou([o,b.relativePath]),w=s.concat(b);h.children&&h.children.length>0&&(li(h.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_+'".')),VJ(h.children,n,w,_)),!(h.path==null&&!h.index)&&n.push({path:_,score:ewe(_,h.index),routesMeta:w})};return e.forEach((h,f)=>{var v;if(h.path===""||!((v=h.path)!=null&&v.includes("?")))d(h,f);else for(let b of BJ(h.path))d(h,f,b)}),n}function BJ(e){let n=e.split("/");if(n.length===0)return[];let[s,...o]=n,d=s.endsWith("?"),h=s.replace(/\?$/,"");if(o.length===0)return d?[h,""]:[h];let f=BJ(o.join("/")),v=[];return v.push(...f.map(b=>b===""?h:[h,b].join("/"))),d&&v.push(...f),v.map(b=>e.startsWith("/")&&b===""?"/":b)}function KEe(e){e.sort((n,s)=>n.score!==s.score?s.score-n.score:twe(n.routesMeta.map(o=>o.childrenIndex),s.routesMeta.map(o=>o.childrenIndex)))}const YEe=/^:[\w-]+$/,qEe=3,XEe=2,JEe=1,QEe=10,ZEe=-2,M7=e=>e==="*";function ewe(e,n){let s=e.split("/"),o=s.length;return s.some(M7)&&(o+=ZEe),n&&(o+=XEe),s.filter(d=>!M7(d)).reduce((d,h)=>d+(YEe.test(h)?qEe:h===""?JEe:QEe),o)}function twe(e,n){return e.length===n.length&&e.slice(0,-1).every((o,d)=>o===n[d])?e[e.length-1]-n[n.length-1]:0}function nwe(e,n,s){let{routesMeta:o}=e,d={},h="/",f=[];for(let v=0;v<o.length;++v){let b=o[v],_=v===o.length-1,w=h==="/"?n:n.slice(h.length)||"/",E=rwe({path:b.relativePath,caseSensitive:b.caseSensitive,end:_},w),N=b.route;if(!E)return null;Object.assign(d,E.params),f.push({params:d,pathname:ou([h,E.pathname]),pathnameBase:dwe(ou([h,E.pathnameBase])),route:N}),E.pathnameBase!=="/"&&(h=ou([h,E.pathnameBase]))}return f}function rwe(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,o]=iwe(e.path,e.caseSensitive,e.end),d=n.match(s);if(!d)return null;let h=d[0],f=h.replace(/(.)\/+$/,"$1"),v=d.slice(1);return{params:o.reduce((_,w,E)=>{let{paramName:N,isOptional:I}=w;if(N==="*"){let O=v[E]||"";f=h.slice(0,h.length-O.length).replace(/(.)\/+$/,"$1")}const R=v[E];return I&&!R?_[N]=void 0:_[N]=(R||"").replace(/%2F/g,"/"),_},{}),pathname:h,pathnameBase:f,pattern:e}}function iwe(e,n,s){n===void 0&&(n=!1),s===void 0&&(s=!0),Lj(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let o=[],d="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,v,b)=>(o.push({paramName:v,isOptional:b!=null}),b?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(o.push({paramName:"*"}),d+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?d+="\\/*$":e!==""&&e!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,n?void 0:"i"),o]}function swe(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Lj(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function Mj(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let s=n.endsWith("/")?n.length-1:n.length,o=e.charAt(s);return o&&o!=="/"?null:e.slice(s)||"/"}const awe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,owe=e=>awe.test(e);function cwe(e,n){n===void 0&&(n="/");let{pathname:s,search:o="",hash:d=""}=typeof e=="string"?cg(e):e,h;if(s)if(owe(s))h=s;else{if(s.includes("//")){let f=s;s=s.replace(/\/\/+/g,"/"),Lj(!1,"Pathnames cannot have embedded double slashes - normalizing "+(f+" -> "+s))}s.startsWith("/")?h=U7(s.substring(1),"/"):h=U7(s,n)}else h=n;return{pathname:h,search:uwe(o),hash:hwe(d)}}function U7(e,n){let s=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(d=>{d===".."?s.length>1&&s.pop():d!=="."&&s.push(d)}),s.length>1?s.join("/"):"/"}function oO(e,n,s,o){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function lwe(e){return e.filter((n,s)=>s===0||n.route.path&&n.route.path.length>0)}function Uj(e,n){let s=lwe(e);return n?s.map((o,d)=>d===s.length-1?o.pathname:o.pathnameBase):s.map(o=>o.pathnameBase)}function Fj(e,n,s,o){o===void 0&&(o=!1);let d;typeof e=="string"?d=cg(e):(d=hy({},e),li(!d.pathname||!d.pathname.includes("?"),oO("?","pathname","search",d)),li(!d.pathname||!d.pathname.includes("#"),oO("#","pathname","hash",d)),li(!d.search||!d.search.includes("#"),oO("#","search","hash",d)));let h=e===""||d.pathname==="",f=h?"/":d.pathname,v;if(f==null)v=s;else{let E=n.length-1;if(!o&&f.startsWith("..")){let N=f.split("/");for(;N[0]==="..";)N.shift(),E-=1;d.pathname=N.join("/")}v=E>=0?n[E]:"/"}let b=cwe(d,v),_=f&&f!=="/"&&f.endsWith("/"),w=(h||f===".")&&s.endsWith("/");return!b.pathname.endsWith("/")&&(_||w)&&(b.pathname+="/"),b}const ou=e=>e.join("/").replace(/\/\/+/g,"/"),dwe=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),uwe=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,hwe=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function pwe(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const GJ=["post","put","patch","delete"];new Set(GJ);const mwe=["get",...GJ];new Set(mwe);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function py(){return py=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},py.apply(this,arguments)}const Vj=z.createContext(null),fwe=z.createContext(null),bu=z.createContext(null),yT=z.createContext(null),Zl=z.createContext({outlet:null,matches:[],isDataRoute:!1}),WJ=z.createContext(null);function gwe(e,n){let{relative:s}=n===void 0?{}:n;lg()||li(!1);let{basename:o,navigator:d}=z.useContext(bu),{hash:h,pathname:f,search:v}=zJ(e,{relative:s}),b=f;return o!=="/"&&(b=f==="/"?o:ou([o,f])),d.createHref({pathname:b,search:v,hash:h})}function lg(){return z.useContext(yT)!=null}function mc(){return lg()||li(!1),z.useContext(yT).location}function $J(e){z.useContext(bu).static||z.useLayoutEffect(e)}function Us(){let{isDataRoute:e}=z.useContext(Zl);return e?Awe():vwe()}function vwe(){lg()||li(!1);let e=z.useContext(Vj),{basename:n,future:s,navigator:o}=z.useContext(bu),{matches:d}=z.useContext(Zl),{pathname:h}=mc(),f=JSON.stringify(Uj(d,s.v7_relativeSplatPath)),v=z.useRef(!1);return $J(()=>{v.current=!0}),z.useCallback(function(_,w){if(w===void 0&&(w={}),!v.current)return;if(typeof _=="number"){o.go(_);return}let E=Fj(_,JSON.parse(f),h,w.relative==="path");e==null&&n!=="/"&&(E.pathname=E.pathname==="/"?n:ou([n,E.pathname])),(w.replace?o.replace:o.push)(E,w.state,w)},[n,o,f,h,e])}function rb(){let{matches:e}=z.useContext(Zl),n=e[e.length-1];return n?n.params:{}}function zJ(e,n){let{relative:s}=n===void 0?{}:n,{future:o}=z.useContext(bu),{matches:d}=z.useContext(Zl),{pathname:h}=mc(),f=JSON.stringify(Uj(d,o.v7_relativeSplatPath));return z.useMemo(()=>Fj(e,JSON.parse(f),h,s==="path"),[e,f,h,s])}function ywe(e,n){return bwe(e,n)}function bwe(e,n,s,o){lg()||li(!1);let{navigator:d}=z.useContext(bu),{matches:h}=z.useContext(Zl),f=h[h.length-1],v=f?f.params:{};f&&f.pathname;let b=f?f.pathnameBase:"/";f&&f.route;let _=mc(),w;if(n){var E;let P=typeof n=="string"?cg(n):n;b==="/"||(E=P.pathname)!=null&&E.startsWith(b)||li(!1),w=P}else w=_;let N=w.pathname||"/",I=N;if(b!=="/"){let P=b.replace(/^\//,"").split("/");I="/"+N.replace(/^\//,"").split("/").slice(P.length).join("/")}let R=zEe(e,{pathname:I}),O=Swe(R&&R.map(P=>Object.assign({},P,{params:Object.assign({},v,P.params),pathname:ou([b,d.encodeLocation?d.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?b:ou([b,d.encodeLocation?d.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),h,s,o);return n&&O?z.createElement(yT.Provider,{value:{location:py({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:qd.Pop}},O):O}function xwe(){let e=Rwe(),n=pwe(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},n),s?z.createElement("pre",{style:d},s):null,null)}const _we=z.createElement(xwe,null);class Ewe extends z.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,s){return s.location!==n.location||s.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:s.error,location:s.location,revalidation:n.revalidation||s.revalidation}}componentDidCatch(n,s){console.error("React Router caught the following error during render",n,s)}render(){return this.state.error!==void 0?z.createElement(Zl.Provider,{value:this.props.routeContext},z.createElement(WJ.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function wwe(e){let{routeContext:n,match:s,children:o}=e,d=z.useContext(Vj);return d&&d.static&&d.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=s.route.id),z.createElement(Zl.Provider,{value:n},o)}function Swe(e,n,s,o){var d;if(n===void 0&&(n=[]),s===void 0&&(s=null),o===void 0&&(o=null),e==null){var h;if(!s)return null;if(s.errors)e=s.matches;else if((h=o)!=null&&h.v7_partialHydration&&n.length===0&&!s.initialized&&s.matches.length>0)e=s.matches;else return null}let f=e,v=(d=s)==null?void 0:d.errors;if(v!=null){let w=f.findIndex(E=>E.route.id&&(v==null?void 0:v[E.route.id])!==void 0);w>=0||li(!1),f=f.slice(0,Math.min(f.length,w+1))}let b=!1,_=-1;if(s&&o&&o.v7_partialHydration)for(let w=0;w<f.length;w++){let E=f[w];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(_=w),E.route.id){let{loaderData:N,errors:I}=s,R=E.route.loader&&N[E.route.id]===void 0&&(!I||I[E.route.id]===void 0);if(E.route.lazy||R){b=!0,_>=0?f=f.slice(0,_+1):f=[f[0]];break}}}return f.reduceRight((w,E,N)=>{let I,R=!1,O=null,P=null;s&&(I=v&&E.route.id?v[E.route.id]:void 0,O=E.route.errorElement||_we,b&&(_<0&&N===0?(Iwe("route-fallback"),R=!0,P=null):_===N&&(R=!0,P=E.route.hydrateFallbackElement||null)));let M=n.concat(f.slice(0,N+1)),D=()=>{let U;return I?U=O:R?U=P:E.route.Component?U=z.createElement(E.route.Component,null):E.route.element?U=E.route.element:U=w,z.createElement(wwe,{match:E,routeContext:{outlet:w,matches:M,isDataRoute:s!=null},children:U})};return s&&(E.route.ErrorBoundary||E.route.errorElement||N===0)?z.createElement(Ewe,{location:s.location,revalidation:s.revalidation,component:O,error:I,children:D(),routeContext:{outlet:null,matches:M,isDataRoute:!0}}):D()},null)}var HJ=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(HJ||{}),KJ=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(KJ||{});function Twe(e){let n=z.useContext(Vj);return n||li(!1),n}function Nwe(e){let n=z.useContext(fwe);return n||li(!1),n}function Cwe(e){let n=z.useContext(Zl);return n||li(!1),n}function YJ(e){let n=Cwe(),s=n.matches[n.matches.length-1];return s.route.id||li(!1),s.route.id}function Rwe(){var e;let n=z.useContext(WJ),s=Nwe(),o=YJ();return n!==void 0?n:(e=s.errors)==null?void 0:e[o]}function Awe(){let{router:e}=Twe(HJ.UseNavigateStable),n=YJ(KJ.UseNavigateStable),s=z.useRef(!1);return $J(()=>{s.current=!0}),z.useCallback(function(d,h){h===void 0&&(h={}),s.current&&(typeof d=="number"?e.navigate(d):e.navigate(d,py({fromRouteId:n},h)))},[e,n])}const F7={};function Iwe(e,n,s){F7[e]||(F7[e]=!0)}function Owe(e,n){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Aa(e){let{to:n,replace:s,state:o,relative:d}=e;lg()||li(!1);let{future:h,static:f}=z.useContext(bu),{matches:v}=z.useContext(Zl),{pathname:b}=mc(),_=Us(),w=Fj(n,Uj(v,h.v7_relativeSplatPath),b,d==="path"),E=JSON.stringify(w);return z.useEffect(()=>_(JSON.parse(E),{replace:s,state:o,relative:d}),[_,E,d,s,o]),null}function Qn(e){li(!1)}function Pwe(e){let{basename:n="/",children:s=null,location:o,navigationType:d=qd.Pop,navigator:h,static:f=!1,future:v}=e;lg()&&li(!1);let b=n.replace(/^\/*/,"/"),_=z.useMemo(()=>({basename:b,navigator:h,static:f,future:py({v7_relativeSplatPath:!1},v)}),[b,v,h,f]);typeof o=="string"&&(o=cg(o));let{pathname:w="/",search:E="",hash:N="",state:I=null,key:R="default"}=o,O=z.useMemo(()=>{let P=Mj(w,b);return P==null?null:{location:{pathname:P,search:E,hash:N,state:I,key:R},navigationType:d}},[b,w,E,N,I,R,d]);return O==null?null:z.createElement(bu.Provider,{value:_},z.createElement(yT.Provider,{children:s,value:O}))}function kwe(e){let{children:n,location:s}=e;return ywe(W2(n),s)}new Promise(()=>{});function W2(e,n){n===void 0&&(n=[]);let s=[];return z.Children.forEach(e,(o,d)=>{if(!z.isValidElement(o))return;let h=[...n,d];if(o.type===z.Fragment){s.push.apply(s,W2(o.props.children,h));return}o.type!==Qn&&li(!1),!o.props.index||!o.props.children||li(!1);let f={id:o.props.id||h.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(f.children=W2(o.props.children,h)),s.push(f)}),s}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $2(){return $2=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},$2.apply(this,arguments)}function jwe(e,n){if(e==null)return{};var s={},o=Object.keys(e),d,h;for(h=0;h<o.length;h++)d=o[h],!(n.indexOf(d)>=0)&&(s[d]=e[d]);return s}function Dwe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Lwe(e,n){return e.button===0&&(!n||n==="_self")&&!Dwe(e)}function z2(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((n,s)=>{let o=e[s];return n.concat(Array.isArray(o)?o.map(d=>[s,d]):[[s,o]])},[]))}function Mwe(e,n){let s=z2(e);return n&&n.forEach((o,d)=>{s.has(d)||n.getAll(d).forEach(h=>{s.append(d,h)})}),s}const Uwe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Fwe="6";try{window.__reactRouterVersion=Fwe}catch{}const Vwe="startTransition",V7=Mq[Vwe];function Bwe(e){let{basename:n,children:s,future:o,window:d}=e,h=z.useRef();h.current==null&&(h.current=GEe({window:d,v5Compat:!0}));let f=h.current,[v,b]=z.useState({action:f.action,location:f.location}),{v7_startTransition:_}=o||{},w=z.useCallback(E=>{_&&V7?V7(()=>b(E)):b(E)},[b,_]);return z.useLayoutEffect(()=>f.listen(w),[f,w]),z.useEffect(()=>Owe(o),[o]),z.createElement(Pwe,{basename:n,children:s,location:v.location,navigationType:v.action,navigator:f,future:o})}const Gwe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Wwe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ct=z.forwardRef(function(n,s){let{onClick:o,relative:d,reloadDocument:h,replace:f,state:v,target:b,to:_,preventScrollReset:w,viewTransition:E}=n,N=jwe(n,Uwe),{basename:I}=z.useContext(bu),R,O=!1;if(typeof _=="string"&&Wwe.test(_)&&(R=_,Gwe))try{let U=new URL(window.location.href),B=_.startsWith("//")?new URL(U.protocol+_):new URL(_),G=Mj(B.pathname,I);B.origin===U.origin&&G!=null?_=G+B.search+B.hash:O=!0}catch{}let P=gwe(_,{relative:d}),M=$we(_,{replace:f,state:v,target:b,preventScrollReset:w,relative:d,viewTransition:E});function D(U){o&&o(U),U.defaultPrevented||M(U)}return z.createElement("a",$2({},N,{href:R||P,onClick:O||h?o:D,ref:s,target:b}))});var B7;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(B7||(B7={}));var G7;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(G7||(G7={}));function $we(e,n){let{target:s,replace:o,state:d,preventScrollReset:h,relative:f,viewTransition:v}=n===void 0?{}:n,b=Us(),_=mc(),w=zJ(e,{relative:f});return z.useCallback(E=>{if(Lwe(E,s)){E.preventDefault();let N=o!==void 0?o:Hw(_)===Hw(w);b(e,{replace:N,state:d,preventScrollReset:h,relative:f,viewTransition:v})}},[_,b,w,o,d,s,e,h,f,v])}function zwe(e){let n=z.useRef(z2(e)),s=z.useRef(!1),o=mc(),d=z.useMemo(()=>Mwe(o.search,s.current?null:n.current),[o.search]),h=Us(),f=z.useCallback((v,b)=>{const _=z2(typeof v=="function"?v(d):v);s.current=!0,h("?"+_,b)},[h,d]);return[d,f]}let Hwe={data:""},Kwe=e=>{if(typeof window=="object"){let n=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return n.nonce=window.__nonce__,n.parentNode||(e||document.head).appendChild(n),n.firstChild}return e||Hwe},Ywe=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,qwe=/\/\*[^]*?\*\/|  +/g,W7=/\n+/g,Wd=(e,n)=>{let s="",o="",d="";for(let h in e){let f=e[h];h[0]=="@"?h[1]=="i"?s=h+" "+f+";":o+=h[1]=="f"?Wd(f,h):h+"{"+Wd(f,h[1]=="k"?"":n)+"}":typeof f=="object"?o+=Wd(f,n?n.replace(/([^,])+/g,v=>h.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,b=>/&/.test(b)?b.replace(/&/g,v):v?v+" "+b:b)):h):f!=null&&(h=/^--/.test(h)?h:h.replace(/[A-Z]/g,"-$&").toLowerCase(),d+=Wd.p?Wd.p(h,f):h+":"+f+";")}return s+(n&&d?n+"{"+d+"}":d)+o},El={},qJ=e=>{if(typeof e=="object"){let n="";for(let s in e)n+=s+qJ(e[s]);return n}return e},Xwe=(e,n,s,o,d)=>{let h=qJ(e),f=El[h]||(El[h]=(b=>{let _=0,w=11;for(;_<b.length;)w=101*w+b.charCodeAt(_++)>>>0;return"go"+w})(h));if(!El[f]){let b=h!==e?e:(_=>{let w,E,N=[{}];for(;w=Ywe.exec(_.replace(qwe,""));)w[4]?N.shift():w[3]?(E=w[3].replace(W7," ").trim(),N.unshift(N[0][E]=N[0][E]||{})):N[0][w[1]]=w[2].replace(W7," ").trim();return N[0]})(e);El[f]=Wd(d?{["@keyframes "+f]:b}:b,s?"":"."+f)}let v=s&&El.g?El.g:null;return s&&(El.g=El[f]),((b,_,w,E)=>{E?_.data=_.data.replace(E,b):_.data.indexOf(b)===-1&&(_.data=w?b+_.data:_.data+b)})(El[f],n,o,v),f},Jwe=(e,n,s)=>e.reduce((o,d,h)=>{let f=n[h];if(f&&f.call){let v=f(s),b=v&&v.props&&v.props.className||/^go/.test(v)&&v;f=b?"."+b:v&&typeof v=="object"?v.props?"":Wd(v,""):v===!1?"":v}return o+d+(f??"")},"");function bT(e){let n=this||{},s=e.call?e(n.p):e;return Xwe(s.unshift?s.raw?Jwe(s,[].slice.call(arguments,1),n.p):s.reduce((o,d)=>Object.assign(o,d&&d.call?d(n.p):d),{}):s,Kwe(n.target),n.g,n.o,n.k)}let XJ,H2,K2;bT.bind({g:1});let Hl=bT.bind({k:1});function Qwe(e,n,s,o){Wd.p=n,XJ=e,H2=s,K2=o}function xu(e,n){let s=this||{};return function(){let o=arguments;function d(h,f){let v=Object.assign({},h),b=v.className||d.className;s.p=Object.assign({theme:H2&&H2()},v),s.o=/ *go\d+/.test(b),v.className=bT.apply(s,o)+(b?" "+b:"");let _=e;return e[0]&&(_=v.as||e,delete v.as),K2&&_[0]&&K2(v),XJ(_,v)}return d}}var Zwe=e=>typeof e=="function",Kw=(e,n)=>Zwe(e)?e(n):e,eSe=(()=>{let e=0;return()=>(++e).toString()})(),JJ=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),tSe=20,Bj="default",QJ=(e,n)=>{let{toastLimit:s}=e.settings;switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,s)};case 1:return{...e,toasts:e.toasts.map(f=>f.id===n.toast.id?{...f,...n.toast}:f)};case 2:let{toast:o}=n;return QJ(e,{type:e.toasts.find(f=>f.id===o.id)?1:0,toast:o});case 3:let{toastId:d}=n;return{...e,toasts:e.toasts.map(f=>f.id===d||d===void 0?{...f,dismissed:!0,visible:!1}:f)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(f=>f.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let h=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(f=>({...f,pauseDuration:f.pauseDuration+h}))}}},mw=[],ZJ={toasts:[],pausedAt:void 0,settings:{toastLimit:tSe}},Kc={},eQ=(e,n=Bj)=>{Kc[n]=QJ(Kc[n]||ZJ,e),mw.forEach(([s,o])=>{s===n&&o(Kc[n])})},tQ=e=>Object.keys(Kc).forEach(n=>eQ(e,n)),nSe=e=>Object.keys(Kc).find(n=>Kc[n].toasts.some(s=>s.id===e)),xT=(e=Bj)=>n=>{eQ(n,e)},rSe={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},iSe=(e={},n=Bj)=>{let[s,o]=z.useState(Kc[n]||ZJ),d=z.useRef(Kc[n]);z.useEffect(()=>(d.current!==Kc[n]&&o(Kc[n]),mw.push([n,o]),()=>{let f=mw.findIndex(([v])=>v===n);f>-1&&mw.splice(f,1)}),[n]);let h=s.toasts.map(f=>{var v,b,_;return{...e,...e[f.type],...f,removeDelay:f.removeDelay||((v=e[f.type])==null?void 0:v.removeDelay)||(e==null?void 0:e.removeDelay),duration:f.duration||((b=e[f.type])==null?void 0:b.duration)||(e==null?void 0:e.duration)||rSe[f.type],style:{...e.style,...(_=e[f.type])==null?void 0:_.style,...f.style}}});return{...s,toasts:h}},sSe=(e,n="blank",s)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...s,id:(s==null?void 0:s.id)||eSe()}),ib=e=>(n,s)=>{let o=sSe(n,e,s);return xT(o.toasterId||nSe(o.id))({type:2,toast:o}),o.id},Ti=(e,n)=>ib("blank")(e,n);Ti.error=ib("error");Ti.success=ib("success");Ti.loading=ib("loading");Ti.custom=ib("custom");Ti.dismiss=(e,n)=>{let s={type:3,toastId:e};n?xT(n)(s):tQ(s)};Ti.dismissAll=e=>Ti.dismiss(void 0,e);Ti.remove=(e,n)=>{let s={type:4,toastId:e};n?xT(n)(s):tQ(s)};Ti.removeAll=e=>Ti.remove(void 0,e);Ti.promise=(e,n,s)=>{let o=Ti.loading(n.loading,{...s,...s==null?void 0:s.loading});return typeof e=="function"&&(e=e()),e.then(d=>{let h=n.success?Kw(n.success,d):void 0;return h?Ti.success(h,{id:o,...s,...s==null?void 0:s.success}):Ti.dismiss(o),d}).catch(d=>{let h=n.error?Kw(n.error,d):void 0;h?Ti.error(h,{id:o,...s,...s==null?void 0:s.error}):Ti.dismiss(o)}),e};var aSe=1e3,oSe=(e,n="default")=>{let{toasts:s,pausedAt:o}=iSe(e,n),d=z.useRef(new Map).current,h=z.useCallback((E,N=aSe)=>{if(d.has(E))return;let I=setTimeout(()=>{d.delete(E),f({type:4,toastId:E})},N);d.set(E,I)},[]);z.useEffect(()=>{if(o)return;let E=Date.now(),N=s.map(I=>{if(I.duration===1/0)return;let R=(I.duration||0)+I.pauseDuration-(E-I.createdAt);if(R<0){I.visible&&Ti.dismiss(I.id);return}return setTimeout(()=>Ti.dismiss(I.id,n),R)});return()=>{N.forEach(I=>I&&clearTimeout(I))}},[s,o,n]);let f=z.useCallback(xT(n),[n]),v=z.useCallback(()=>{f({type:5,time:Date.now()})},[f]),b=z.useCallback((E,N)=>{f({type:1,toast:{id:E,height:N}})},[f]),_=z.useCallback(()=>{o&&f({type:6,time:Date.now()})},[o,f]),w=z.useCallback((E,N)=>{let{reverseOrder:I=!1,gutter:R=8,defaultPosition:O}=N||{},P=s.filter(U=>(U.position||O)===(E.position||O)&&U.height),M=P.findIndex(U=>U.id===E.id),D=P.filter((U,B)=>B<M&&U.visible).length;return P.filter(U=>U.visible).slice(...I?[D+1]:[0,D]).reduce((U,B)=>U+(B.height||0)+R,0)},[s]);return z.useEffect(()=>{s.forEach(E=>{if(E.dismissed)h(E.id,E.removeDelay);else{let N=d.get(E.id);N&&(clearTimeout(N),d.delete(E.id))}})},[s,h]),{toasts:s,handlers:{updateHeight:b,startPause:v,endPause:_,calculateOffset:w}}},cSe=Hl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,lSe=Hl`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,dSe=Hl`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,uSe=xu("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${cSe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${lSe} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${dSe} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,hSe=Hl`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,pSe=xu("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${hSe} 1s linear infinite;
`,mSe=Hl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,fSe=Hl`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,gSe=xu("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${mSe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${fSe} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,vSe=xu("div")`
  position: absolute;
`,ySe=xu("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,bSe=Hl`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,xSe=xu("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${bSe} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,_Se=({toast:e})=>{let{icon:n,type:s,iconTheme:o}=e;return n!==void 0?typeof n=="string"?z.createElement(xSe,null,n):n:s==="blank"?null:z.createElement(ySe,null,z.createElement(pSe,{...o}),s!=="loading"&&z.createElement(vSe,null,s==="error"?z.createElement(uSe,{...o}):z.createElement(gSe,{...o})))},ESe=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,wSe=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,SSe="0%{opacity:0;} 100%{opacity:1;}",TSe="0%{opacity:1;} 100%{opacity:0;}",NSe=xu("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,CSe=xu("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,RSe=(e,n)=>{let s=e.includes("top")?1:-1,[o,d]=JJ()?[SSe,TSe]:[ESe(s),wSe(s)];return{animation:n?`${Hl(o)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Hl(d)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},ASe=z.memo(({toast:e,position:n,style:s,children:o})=>{let d=e.height?RSe(e.position||n||"top-center",e.visible):{opacity:0},h=z.createElement(_Se,{toast:e}),f=z.createElement(CSe,{...e.ariaProps},Kw(e.message,e));return z.createElement(NSe,{className:e.className,style:{...d,...s,...e.style}},typeof o=="function"?o({icon:h,message:f}):z.createElement(z.Fragment,null,h,f))});Qwe(z.createElement);var ISe=({id:e,className:n,style:s,onHeightUpdate:o,children:d})=>{let h=z.useCallback(f=>{if(f){let v=()=>{let b=f.getBoundingClientRect().height;o(e,b)};v(),new MutationObserver(v).observe(f,{subtree:!0,childList:!0,characterData:!0})}},[e,o]);return z.createElement("div",{ref:h,className:n,style:s},d)},OSe=(e,n)=>{let s=e.includes("top"),o=s?{top:0}:{bottom:0},d=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:JJ()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(s?1:-1)}px)`,...o,...d}},PSe=bT`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,LE=16,kSe=({reverseOrder:e,position:n="top-center",toastOptions:s,gutter:o,children:d,toasterId:h,containerStyle:f,containerClassName:v})=>{let{toasts:b,handlers:_}=oSe(s,h);return z.createElement("div",{"data-rht-toaster":h||"",style:{position:"fixed",zIndex:9999,top:LE,left:LE,right:LE,bottom:LE,pointerEvents:"none",...f},className:v,onMouseEnter:_.startPause,onMouseLeave:_.endPause},b.map(w=>{let E=w.position||n,N=_.calculateOffset(w,{reverseOrder:e,gutter:o,defaultPosition:n}),I=OSe(E,N);return z.createElement(ISe,{id:w.id,key:w.id,onHeightUpdate:_.updateHeight,className:w.visible?PSe:"",style:I},w.type==="custom"?Kw(w.message,w):d?d(w):z.createElement(ASe,{toast:w,position:E}))}))},et=Ti;function nQ(e,n){return function(){return e.apply(n,arguments)}}const{toString:jSe}=Object.prototype,{getPrototypeOf:Gj}=Object,{iterator:_T,toStringTag:rQ}=Symbol,ET=(e=>n=>{const s=jSe.call(n);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),fc=e=>(e=e.toLowerCase(),n=>ET(n)===e),wT=e=>n=>typeof n===e,{isArray:dg}=Array,Af=wT("undefined");function sb(e){return e!==null&&!Af(e)&&e.constructor!==null&&!Af(e.constructor)&&ca(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const iQ=fc("ArrayBuffer");function DSe(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&iQ(e.buffer),n}const LSe=wT("string"),ca=wT("function"),sQ=wT("number"),ab=e=>e!==null&&typeof e=="object",MSe=e=>e===!0||e===!1,fw=e=>{if(ET(e)!=="object")return!1;const n=Gj(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(rQ in e)&&!(_T in e)},USe=e=>{if(!ab(e)||sb(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},FSe=fc("Date"),VSe=fc("File"),BSe=fc("Blob"),GSe=fc("FileList"),WSe=e=>ab(e)&&ca(e.pipe),$Se=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||ca(e.append)&&((n=ET(e))==="formdata"||n==="object"&&ca(e.toString)&&e.toString()==="[object FormData]"))},zSe=fc("URLSearchParams"),[HSe,KSe,YSe,qSe]=["ReadableStream","Request","Response","Headers"].map(fc),XSe=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ob(e,n,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let o,d;if(typeof e!="object"&&(e=[e]),dg(e))for(o=0,d=e.length;o<d;o++)n.call(null,e[o],o,e);else{if(sb(e))return;const h=s?Object.getOwnPropertyNames(e):Object.keys(e),f=h.length;let v;for(o=0;o<f;o++)v=h[o],n.call(null,e[v],v,e)}}function aQ(e,n){if(sb(e))return null;n=n.toLowerCase();const s=Object.keys(e);let o=s.length,d;for(;o-- >0;)if(d=s[o],n===d.toLowerCase())return d;return null}const kh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,oQ=e=>!Af(e)&&e!==kh;function Y2(){const{caseless:e,skipUndefined:n}=oQ(this)&&this||{},s={},o=(d,h)=>{const f=e&&aQ(s,h)||h;fw(s[f])&&fw(d)?s[f]=Y2(s[f],d):fw(d)?s[f]=Y2({},d):dg(d)?s[f]=d.slice():(!n||!Af(d))&&(s[f]=d)};for(let d=0,h=arguments.length;d<h;d++)arguments[d]&&ob(arguments[d],o);return s}const JSe=(e,n,s,{allOwnKeys:o}={})=>(ob(n,(d,h)=>{s&&ca(d)?e[h]=nQ(d,s):e[h]=d},{allOwnKeys:o}),e),QSe=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),ZSe=(e,n,s,o)=>{e.prototype=Object.create(n.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),s&&Object.assign(e.prototype,s)},eTe=(e,n,s,o)=>{let d,h,f;const v={};if(n=n||{},e==null)return n;do{for(d=Object.getOwnPropertyNames(e),h=d.length;h-- >0;)f=d[h],(!o||o(f,e,n))&&!v[f]&&(n[f]=e[f],v[f]=!0);e=s!==!1&&Gj(e)}while(e&&(!s||s(e,n))&&e!==Object.prototype);return n},tTe=(e,n,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=n.length;const o=e.indexOf(n,s);return o!==-1&&o===s},nTe=e=>{if(!e)return null;if(dg(e))return e;let n=e.length;if(!sQ(n))return null;const s=new Array(n);for(;n-- >0;)s[n]=e[n];return s},rTe=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&Gj(Uint8Array)),iTe=(e,n)=>{const o=(e&&e[_T]).call(e);let d;for(;(d=o.next())&&!d.done;){const h=d.value;n.call(e,h[0],h[1])}},sTe=(e,n)=>{let s;const o=[];for(;(s=e.exec(n))!==null;)o.push(s);return o},aTe=fc("HTMLFormElement"),oTe=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,o,d){return o.toUpperCase()+d}),$7=(({hasOwnProperty:e})=>(n,s)=>e.call(n,s))(Object.prototype),cTe=fc("RegExp"),cQ=(e,n)=>{const s=Object.getOwnPropertyDescriptors(e),o={};ob(s,(d,h)=>{let f;(f=n(d,h,e))!==!1&&(o[h]=f||d)}),Object.defineProperties(e,o)},lTe=e=>{cQ(e,(n,s)=>{if(ca(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const o=e[s];if(ca(o)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},dTe=(e,n)=>{const s={},o=d=>{d.forEach(h=>{s[h]=!0})};return dg(e)?o(e):o(String(e).split(n)),s},uTe=()=>{},hTe=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function pTe(e){return!!(e&&ca(e.append)&&e[rQ]==="FormData"&&e[_T])}const mTe=e=>{const n=new Array(10),s=(o,d)=>{if(ab(o)){if(n.indexOf(o)>=0)return;if(sb(o))return o;if(!("toJSON"in o)){n[d]=o;const h=dg(o)?[]:{};return ob(o,(f,v)=>{const b=s(f,d+1);!Af(b)&&(h[v]=b)}),n[d]=void 0,h}}return o};return s(e,0)},fTe=fc("AsyncFunction"),gTe=e=>e&&(ab(e)||ca(e))&&ca(e.then)&&ca(e.catch),lQ=((e,n)=>e?setImmediate:n?((s,o)=>(kh.addEventListener("message",({source:d,data:h})=>{d===kh&&h===s&&o.length&&o.shift()()},!1),d=>{o.push(d),kh.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",ca(kh.postMessage)),vTe=typeof queueMicrotask<"u"?queueMicrotask.bind(kh):typeof process<"u"&&process.nextTick||lQ,yTe=e=>e!=null&&ca(e[_T]),Ue={isArray:dg,isArrayBuffer:iQ,isBuffer:sb,isFormData:$Se,isArrayBufferView:DSe,isString:LSe,isNumber:sQ,isBoolean:MSe,isObject:ab,isPlainObject:fw,isEmptyObject:USe,isReadableStream:HSe,isRequest:KSe,isResponse:YSe,isHeaders:qSe,isUndefined:Af,isDate:FSe,isFile:VSe,isBlob:BSe,isRegExp:cTe,isFunction:ca,isStream:WSe,isURLSearchParams:zSe,isTypedArray:rTe,isFileList:GSe,forEach:ob,merge:Y2,extend:JSe,trim:XSe,stripBOM:QSe,inherits:ZSe,toFlatObject:eTe,kindOf:ET,kindOfTest:fc,endsWith:tTe,toArray:nTe,forEachEntry:iTe,matchAll:sTe,isHTMLForm:aTe,hasOwnProperty:$7,hasOwnProp:$7,reduceDescriptors:cQ,freezeMethods:lTe,toObjectSet:dTe,toCamelCase:oTe,noop:uTe,toFiniteNumber:hTe,findKey:aQ,global:kh,isContextDefined:oQ,isSpecCompliantForm:pTe,toJSONObject:mTe,isAsyncFn:fTe,isThenable:gTe,setImmediate:lQ,asap:vTe,isIterable:yTe};function fn(e,n,s,o,d){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),s&&(this.config=s),o&&(this.request=o),d&&(this.response=d,this.status=d.status?d.status:null)}Ue.inherits(fn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ue.toJSONObject(this.config),code:this.code,status:this.status}}});const dQ=fn.prototype,uQ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{uQ[e]={value:e}});Object.defineProperties(fn,uQ);Object.defineProperty(dQ,"isAxiosError",{value:!0});fn.from=(e,n,s,o,d,h)=>{const f=Object.create(dQ);Ue.toFlatObject(e,f,function(w){return w!==Error.prototype},_=>_!=="isAxiosError");const v=e&&e.message?e.message:"Error",b=n==null&&e?e.code:n;return fn.call(f,v,b,s,o,d),e&&f.cause==null&&Object.defineProperty(f,"cause",{value:e,configurable:!0}),f.name=e&&e.name||"Error",h&&Object.assign(f,h),f};const bTe=null;function q2(e){return Ue.isPlainObject(e)||Ue.isArray(e)}function hQ(e){return Ue.endsWith(e,"[]")?e.slice(0,-2):e}function z7(e,n,s){return e?e.concat(n).map(function(d,h){return d=hQ(d),!s&&h?"["+d+"]":d}).join(s?".":""):n}function xTe(e){return Ue.isArray(e)&&!e.some(q2)}const _Te=Ue.toFlatObject(Ue,{},null,function(n){return/^is[A-Z]/.test(n)});function ST(e,n,s){if(!Ue.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,s=Ue.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(O,P){return!Ue.isUndefined(P[O])});const o=s.metaTokens,d=s.visitor||w,h=s.dots,f=s.indexes,b=(s.Blob||typeof Blob<"u"&&Blob)&&Ue.isSpecCompliantForm(n);if(!Ue.isFunction(d))throw new TypeError("visitor must be a function");function _(R){if(R===null)return"";if(Ue.isDate(R))return R.toISOString();if(Ue.isBoolean(R))return R.toString();if(!b&&Ue.isBlob(R))throw new fn("Blob is not supported. Use a Buffer instead.");return Ue.isArrayBuffer(R)||Ue.isTypedArray(R)?b&&typeof Blob=="function"?new Blob([R]):Buffer.from(R):R}function w(R,O,P){let M=R;if(R&&!P&&typeof R=="object"){if(Ue.endsWith(O,"{}"))O=o?O:O.slice(0,-2),R=JSON.stringify(R);else if(Ue.isArray(R)&&xTe(R)||(Ue.isFileList(R)||Ue.endsWith(O,"[]"))&&(M=Ue.toArray(R)))return O=hQ(O),M.forEach(function(U,B){!(Ue.isUndefined(U)||U===null)&&n.append(f===!0?z7([O],B,h):f===null?O:O+"[]",_(U))}),!1}return q2(R)?!0:(n.append(z7(P,O,h),_(R)),!1)}const E=[],N=Object.assign(_Te,{defaultVisitor:w,convertValue:_,isVisitable:q2});function I(R,O){if(!Ue.isUndefined(R)){if(E.indexOf(R)!==-1)throw Error("Circular reference detected in "+O.join("."));E.push(R),Ue.forEach(R,function(M,D){(!(Ue.isUndefined(M)||M===null)&&d.call(n,M,Ue.isString(D)?D.trim():D,O,N))===!0&&I(M,O?O.concat(D):[D])}),E.pop()}}if(!Ue.isObject(e))throw new TypeError("data must be an object");return I(e),n}function H7(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(o){return n[o]})}function Wj(e,n){this._pairs=[],e&&ST(e,this,n)}const pQ=Wj.prototype;pQ.append=function(n,s){this._pairs.push([n,s])};pQ.toString=function(n){const s=n?function(o){return n.call(this,o,H7)}:H7;return this._pairs.map(function(d){return s(d[0])+"="+s(d[1])},"").join("&")};function ETe(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function mQ(e,n,s){if(!n)return e;const o=s&&s.encode||ETe;Ue.isFunction(s)&&(s={serialize:s});const d=s&&s.serialize;let h;if(d?h=d(n,s):h=Ue.isURLSearchParams(n)?n.toString():new Wj(n,s).toString(o),h){const f=e.indexOf("#");f!==-1&&(e=e.slice(0,f)),e+=(e.indexOf("?")===-1?"?":"&")+h}return e}class K7{constructor(){this.handlers=[]}use(n,s,o){return this.handlers.push({fulfilled:n,rejected:s,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Ue.forEach(this.handlers,function(o){o!==null&&n(o)})}}const fQ={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},wTe=typeof URLSearchParams<"u"?URLSearchParams:Wj,STe=typeof FormData<"u"?FormData:null,TTe=typeof Blob<"u"?Blob:null,NTe={isBrowser:!0,classes:{URLSearchParams:wTe,FormData:STe,Blob:TTe},protocols:["http","https","file","blob","url","data"]},$j=typeof window<"u"&&typeof document<"u",X2=typeof navigator=="object"&&navigator||void 0,CTe=$j&&(!X2||["ReactNative","NativeScript","NS"].indexOf(X2.product)<0),RTe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ATe=$j&&window.location.href||"http://localhost",ITe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:$j,hasStandardBrowserEnv:CTe,hasStandardBrowserWebWorkerEnv:RTe,navigator:X2,origin:ATe},Symbol.toStringTag,{value:"Module"})),_s={...ITe,...NTe};function OTe(e,n){return ST(e,new _s.classes.URLSearchParams,{visitor:function(s,o,d,h){return _s.isNode&&Ue.isBuffer(s)?(this.append(o,s.toString("base64")),!1):h.defaultVisitor.apply(this,arguments)},...n})}function PTe(e){return Ue.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function kTe(e){const n={},s=Object.keys(e);let o;const d=s.length;let h;for(o=0;o<d;o++)h=s[o],n[h]=e[h];return n}function gQ(e){function n(s,o,d,h){let f=s[h++];if(f==="__proto__")return!0;const v=Number.isFinite(+f),b=h>=s.length;return f=!f&&Ue.isArray(d)?d.length:f,b?(Ue.hasOwnProp(d,f)?d[f]=[d[f],o]:d[f]=o,!v):((!d[f]||!Ue.isObject(d[f]))&&(d[f]=[]),n(s,o,d[f],h)&&Ue.isArray(d[f])&&(d[f]=kTe(d[f])),!v)}if(Ue.isFormData(e)&&Ue.isFunction(e.entries)){const s={};return Ue.forEachEntry(e,(o,d)=>{n(PTe(o),d,s,0)}),s}return null}function jTe(e,n,s){if(Ue.isString(e))try{return(n||JSON.parse)(e),Ue.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(s||JSON.stringify)(e)}const cb={transitional:fQ,adapter:["xhr","http","fetch"],transformRequest:[function(n,s){const o=s.getContentType()||"",d=o.indexOf("application/json")>-1,h=Ue.isObject(n);if(h&&Ue.isHTMLForm(n)&&(n=new FormData(n)),Ue.isFormData(n))return d?JSON.stringify(gQ(n)):n;if(Ue.isArrayBuffer(n)||Ue.isBuffer(n)||Ue.isStream(n)||Ue.isFile(n)||Ue.isBlob(n)||Ue.isReadableStream(n))return n;if(Ue.isArrayBufferView(n))return n.buffer;if(Ue.isURLSearchParams(n))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let v;if(h){if(o.indexOf("application/x-www-form-urlencoded")>-1)return OTe(n,this.formSerializer).toString();if((v=Ue.isFileList(n))||o.indexOf("multipart/form-data")>-1){const b=this.env&&this.env.FormData;return ST(v?{"files[]":n}:n,b&&new b,this.formSerializer)}}return h||d?(s.setContentType("application/json",!1),jTe(n)):n}],transformResponse:[function(n){const s=this.transitional||cb.transitional,o=s&&s.forcedJSONParsing,d=this.responseType==="json";if(Ue.isResponse(n)||Ue.isReadableStream(n))return n;if(n&&Ue.isString(n)&&(o&&!this.responseType||d)){const f=!(s&&s.silentJSONParsing)&&d;try{return JSON.parse(n,this.parseReviver)}catch(v){if(f)throw v.name==="SyntaxError"?fn.from(v,fn.ERR_BAD_RESPONSE,this,null,this.response):v}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:_s.classes.FormData,Blob:_s.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ue.forEach(["delete","get","head","post","put","patch"],e=>{cb.headers[e]={}});const DTe=Ue.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),LTe=e=>{const n={};let s,o,d;return e&&e.split(`
`).forEach(function(f){d=f.indexOf(":"),s=f.substring(0,d).trim().toLowerCase(),o=f.substring(d+1).trim(),!(!s||n[s]&&DTe[s])&&(s==="set-cookie"?n[s]?n[s].push(o):n[s]=[o]:n[s]=n[s]?n[s]+", "+o:o)}),n},Y7=Symbol("internals");function mv(e){return e&&String(e).trim().toLowerCase()}function gw(e){return e===!1||e==null?e:Ue.isArray(e)?e.map(gw):String(e)}function MTe(e){const n=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=s.exec(e);)n[o[1]]=o[2];return n}const UTe=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function cO(e,n,s,o,d){if(Ue.isFunction(o))return o.call(this,n,s);if(d&&(n=s),!!Ue.isString(n)){if(Ue.isString(o))return n.indexOf(o)!==-1;if(Ue.isRegExp(o))return o.test(n)}}function FTe(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,s,o)=>s.toUpperCase()+o)}function VTe(e,n){const s=Ue.toCamelCase(" "+n);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+s,{value:function(d,h,f){return this[o].call(this,n,d,h,f)},configurable:!0})})}let la=class{constructor(n){n&&this.set(n)}set(n,s,o){const d=this;function h(v,b,_){const w=mv(b);if(!w)throw new Error("header name must be a non-empty string");const E=Ue.findKey(d,w);(!E||d[E]===void 0||_===!0||_===void 0&&d[E]!==!1)&&(d[E||b]=gw(v))}const f=(v,b)=>Ue.forEach(v,(_,w)=>h(_,w,b));if(Ue.isPlainObject(n)||n instanceof this.constructor)f(n,s);else if(Ue.isString(n)&&(n=n.trim())&&!UTe(n))f(LTe(n),s);else if(Ue.isObject(n)&&Ue.isIterable(n)){let v={},b,_;for(const w of n){if(!Ue.isArray(w))throw TypeError("Object iterator must return a key-value pair");v[_=w[0]]=(b=v[_])?Ue.isArray(b)?[...b,w[1]]:[b,w[1]]:w[1]}f(v,s)}else n!=null&&h(s,n,o);return this}get(n,s){if(n=mv(n),n){const o=Ue.findKey(this,n);if(o){const d=this[o];if(!s)return d;if(s===!0)return MTe(d);if(Ue.isFunction(s))return s.call(this,d,o);if(Ue.isRegExp(s))return s.exec(d);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,s){if(n=mv(n),n){const o=Ue.findKey(this,n);return!!(o&&this[o]!==void 0&&(!s||cO(this,this[o],o,s)))}return!1}delete(n,s){const o=this;let d=!1;function h(f){if(f=mv(f),f){const v=Ue.findKey(o,f);v&&(!s||cO(o,o[v],v,s))&&(delete o[v],d=!0)}}return Ue.isArray(n)?n.forEach(h):h(n),d}clear(n){const s=Object.keys(this);let o=s.length,d=!1;for(;o--;){const h=s[o];(!n||cO(this,this[h],h,n,!0))&&(delete this[h],d=!0)}return d}normalize(n){const s=this,o={};return Ue.forEach(this,(d,h)=>{const f=Ue.findKey(o,h);if(f){s[f]=gw(d),delete s[h];return}const v=n?FTe(h):String(h).trim();v!==h&&delete s[h],s[v]=gw(d),o[v]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const s=Object.create(null);return Ue.forEach(this,(o,d)=>{o!=null&&o!==!1&&(s[d]=n&&Ue.isArray(o)?o.join(", "):o)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,s])=>n+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...s){const o=new this(n);return s.forEach(d=>o.set(d)),o}static accessor(n){const o=(this[Y7]=this[Y7]={accessors:{}}).accessors,d=this.prototype;function h(f){const v=mv(f);o[v]||(VTe(d,f),o[v]=!0)}return Ue.isArray(n)?n.forEach(h):h(n),this}};la.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ue.reduceDescriptors(la.prototype,({value:e},n)=>{let s=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(o){this[s]=o}}});Ue.freezeMethods(la);function lO(e,n){const s=this||cb,o=n||s,d=la.from(o.headers);let h=o.data;return Ue.forEach(e,function(v){h=v.call(s,h,d.normalize(),n?n.status:void 0)}),d.normalize(),h}function vQ(e){return!!(e&&e.__CANCEL__)}function ug(e,n,s){fn.call(this,e??"canceled",fn.ERR_CANCELED,n,s),this.name="CanceledError"}Ue.inherits(ug,fn,{__CANCEL__:!0});function yQ(e,n,s){const o=s.config.validateStatus;!s.status||!o||o(s.status)?e(s):n(new fn("Request failed with status code "+s.status,[fn.ERR_BAD_REQUEST,fn.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function BTe(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function GTe(e,n){e=e||10;const s=new Array(e),o=new Array(e);let d=0,h=0,f;return n=n!==void 0?n:1e3,function(b){const _=Date.now(),w=o[h];f||(f=_),s[d]=b,o[d]=_;let E=h,N=0;for(;E!==d;)N+=s[E++],E=E%e;if(d=(d+1)%e,d===h&&(h=(h+1)%e),_-f<n)return;const I=w&&_-w;return I?Math.round(N*1e3/I):void 0}}function WTe(e,n){let s=0,o=1e3/n,d,h;const f=(_,w=Date.now())=>{s=w,d=null,h&&(clearTimeout(h),h=null),e(..._)};return[(..._)=>{const w=Date.now(),E=w-s;E>=o?f(_,w):(d=_,h||(h=setTimeout(()=>{h=null,f(d)},o-E)))},()=>d&&f(d)]}const Yw=(e,n,s=3)=>{let o=0;const d=GTe(50,250);return WTe(h=>{const f=h.loaded,v=h.lengthComputable?h.total:void 0,b=f-o,_=d(b),w=f<=v;o=f;const E={loaded:f,total:v,progress:v?f/v:void 0,bytes:b,rate:_||void 0,estimated:_&&v&&w?(v-f)/_:void 0,event:h,lengthComputable:v!=null,[n?"download":"upload"]:!0};e(E)},s)},q7=(e,n)=>{const s=e!=null;return[o=>n[0]({lengthComputable:s,total:e,loaded:o}),n[1]]},X7=e=>(...n)=>Ue.asap(()=>e(...n)),$Te=_s.hasStandardBrowserEnv?((e,n)=>s=>(s=new URL(s,_s.origin),e.protocol===s.protocol&&e.host===s.host&&(n||e.port===s.port)))(new URL(_s.origin),_s.navigator&&/(msie|trident)/i.test(_s.navigator.userAgent)):()=>!0,zTe=_s.hasStandardBrowserEnv?{write(e,n,s,o,d,h,f){if(typeof document>"u")return;const v=[`${e}=${encodeURIComponent(n)}`];Ue.isNumber(s)&&v.push(`expires=${new Date(s).toUTCString()}`),Ue.isString(o)&&v.push(`path=${o}`),Ue.isString(d)&&v.push(`domain=${d}`),h===!0&&v.push("secure"),Ue.isString(f)&&v.push(`SameSite=${f}`),document.cookie=v.join("; ")},read(e){if(typeof document>"u")return null;const n=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return n?decodeURIComponent(n[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function HTe(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function KTe(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function bQ(e,n,s){let o=!HTe(n);return e&&(o||s==!1)?KTe(e,n):n}const J7=e=>e instanceof la?{...e}:e;function Jh(e,n){n=n||{};const s={};function o(_,w,E,N){return Ue.isPlainObject(_)&&Ue.isPlainObject(w)?Ue.merge.call({caseless:N},_,w):Ue.isPlainObject(w)?Ue.merge({},w):Ue.isArray(w)?w.slice():w}function d(_,w,E,N){if(Ue.isUndefined(w)){if(!Ue.isUndefined(_))return o(void 0,_,E,N)}else return o(_,w,E,N)}function h(_,w){if(!Ue.isUndefined(w))return o(void 0,w)}function f(_,w){if(Ue.isUndefined(w)){if(!Ue.isUndefined(_))return o(void 0,_)}else return o(void 0,w)}function v(_,w,E){if(E in n)return o(_,w);if(E in e)return o(void 0,_)}const b={url:h,method:h,data:h,baseURL:f,transformRequest:f,transformResponse:f,paramsSerializer:f,timeout:f,timeoutMessage:f,withCredentials:f,withXSRFToken:f,adapter:f,responseType:f,xsrfCookieName:f,xsrfHeaderName:f,onUploadProgress:f,onDownloadProgress:f,decompress:f,maxContentLength:f,maxBodyLength:f,beforeRedirect:f,transport:f,httpAgent:f,httpsAgent:f,cancelToken:f,socketPath:f,responseEncoding:f,validateStatus:v,headers:(_,w,E)=>d(J7(_),J7(w),E,!0)};return Ue.forEach(Object.keys({...e,...n}),function(w){const E=b[w]||d,N=E(e[w],n[w],w);Ue.isUndefined(N)&&E!==v||(s[w]=N)}),s}const xQ=e=>{const n=Jh({},e);let{data:s,withXSRFToken:o,xsrfHeaderName:d,xsrfCookieName:h,headers:f,auth:v}=n;if(n.headers=f=la.from(f),n.url=mQ(bQ(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),v&&f.set("Authorization","Basic "+btoa((v.username||"")+":"+(v.password?unescape(encodeURIComponent(v.password)):""))),Ue.isFormData(s)){if(_s.hasStandardBrowserEnv||_s.hasStandardBrowserWebWorkerEnv)f.setContentType(void 0);else if(Ue.isFunction(s.getHeaders)){const b=s.getHeaders(),_=["content-type","content-length"];Object.entries(b).forEach(([w,E])=>{_.includes(w.toLowerCase())&&f.set(w,E)})}}if(_s.hasStandardBrowserEnv&&(o&&Ue.isFunction(o)&&(o=o(n)),o||o!==!1&&$Te(n.url))){const b=d&&h&&zTe.read(h);b&&f.set(d,b)}return n},YTe=typeof XMLHttpRequest<"u",qTe=YTe&&function(e){return new Promise(function(s,o){const d=xQ(e);let h=d.data;const f=la.from(d.headers).normalize();let{responseType:v,onUploadProgress:b,onDownloadProgress:_}=d,w,E,N,I,R;function O(){I&&I(),R&&R(),d.cancelToken&&d.cancelToken.unsubscribe(w),d.signal&&d.signal.removeEventListener("abort",w)}let P=new XMLHttpRequest;P.open(d.method.toUpperCase(),d.url,!0),P.timeout=d.timeout;function M(){if(!P)return;const U=la.from("getAllResponseHeaders"in P&&P.getAllResponseHeaders()),G={data:!v||v==="text"||v==="json"?P.responseText:P.response,status:P.status,statusText:P.statusText,headers:U,config:e,request:P};yQ(function(q){s(q),O()},function(q){o(q),O()},G),P=null}"onloadend"in P?P.onloadend=M:P.onreadystatechange=function(){!P||P.readyState!==4||P.status===0&&!(P.responseURL&&P.responseURL.indexOf("file:")===0)||setTimeout(M)},P.onabort=function(){P&&(o(new fn("Request aborted",fn.ECONNABORTED,e,P)),P=null)},P.onerror=function(B){const G=B&&B.message?B.message:"Network Error",$=new fn(G,fn.ERR_NETWORK,e,P);$.event=B||null,o($),P=null},P.ontimeout=function(){let B=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded";const G=d.transitional||fQ;d.timeoutErrorMessage&&(B=d.timeoutErrorMessage),o(new fn(B,G.clarifyTimeoutError?fn.ETIMEDOUT:fn.ECONNABORTED,e,P)),P=null},h===void 0&&f.setContentType(null),"setRequestHeader"in P&&Ue.forEach(f.toJSON(),function(B,G){P.setRequestHeader(G,B)}),Ue.isUndefined(d.withCredentials)||(P.withCredentials=!!d.withCredentials),v&&v!=="json"&&(P.responseType=d.responseType),_&&([N,R]=Yw(_,!0),P.addEventListener("progress",N)),b&&P.upload&&([E,I]=Yw(b),P.upload.addEventListener("progress",E),P.upload.addEventListener("loadend",I)),(d.cancelToken||d.signal)&&(w=U=>{P&&(o(!U||U.type?new ug(null,e,P):U),P.abort(),P=null)},d.cancelToken&&d.cancelToken.subscribe(w),d.signal&&(d.signal.aborted?w():d.signal.addEventListener("abort",w)));const D=BTe(d.url);if(D&&_s.protocols.indexOf(D)===-1){o(new fn("Unsupported protocol "+D+":",fn.ERR_BAD_REQUEST,e));return}P.send(h||null)})},XTe=(e,n)=>{const{length:s}=e=e?e.filter(Boolean):[];if(n||s){let o=new AbortController,d;const h=function(_){if(!d){d=!0,v();const w=_ instanceof Error?_:this.reason;o.abort(w instanceof fn?w:new ug(w instanceof Error?w.message:w))}};let f=n&&setTimeout(()=>{f=null,h(new fn(`timeout ${n} of ms exceeded`,fn.ETIMEDOUT))},n);const v=()=>{e&&(f&&clearTimeout(f),f=null,e.forEach(_=>{_.unsubscribe?_.unsubscribe(h):_.removeEventListener("abort",h)}),e=null)};e.forEach(_=>_.addEventListener("abort",h));const{signal:b}=o;return b.unsubscribe=()=>Ue.asap(v),b}},JTe=function*(e,n){let s=e.byteLength;if(s<n){yield e;return}let o=0,d;for(;o<s;)d=o+n,yield e.slice(o,d),o=d},QTe=async function*(e,n){for await(const s of ZTe(e))yield*JTe(s,n)},ZTe=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:s,value:o}=await n.read();if(s)break;yield o}}finally{await n.cancel()}},Q7=(e,n,s,o)=>{const d=QTe(e,n);let h=0,f,v=b=>{f||(f=!0,o&&o(b))};return new ReadableStream({async pull(b){try{const{done:_,value:w}=await d.next();if(_){v(),b.close();return}let E=w.byteLength;if(s){let N=h+=E;s(N)}b.enqueue(new Uint8Array(w))}catch(_){throw v(_),_}},cancel(b){return v(b),d.return()}},{highWaterMark:2})},Z7=64*1024,{isFunction:ME}=Ue,eNe=(({Request:e,Response:n})=>({Request:e,Response:n}))(Ue.global),{ReadableStream:eH,TextEncoder:tH}=Ue.global,nH=(e,...n)=>{try{return!!e(...n)}catch{return!1}},tNe=e=>{e=Ue.merge.call({skipUndefined:!0},eNe,e);const{fetch:n,Request:s,Response:o}=e,d=n?ME(n):typeof fetch=="function",h=ME(s),f=ME(o);if(!d)return!1;const v=d&&ME(eH),b=d&&(typeof tH=="function"?(R=>O=>R.encode(O))(new tH):async R=>new Uint8Array(await new s(R).arrayBuffer())),_=h&&v&&nH(()=>{let R=!1;const O=new s(_s.origin,{body:new eH,method:"POST",get duplex(){return R=!0,"half"}}).headers.has("Content-Type");return R&&!O}),w=f&&v&&nH(()=>Ue.isReadableStream(new o("").body)),E={stream:w&&(R=>R.body)};d&&["text","arrayBuffer","blob","formData","stream"].forEach(R=>{!E[R]&&(E[R]=(O,P)=>{let M=O&&O[R];if(M)return M.call(O);throw new fn(`Response type '${R}' is not supported`,fn.ERR_NOT_SUPPORT,P)})});const N=async R=>{if(R==null)return 0;if(Ue.isBlob(R))return R.size;if(Ue.isSpecCompliantForm(R))return(await new s(_s.origin,{method:"POST",body:R}).arrayBuffer()).byteLength;if(Ue.isArrayBufferView(R)||Ue.isArrayBuffer(R))return R.byteLength;if(Ue.isURLSearchParams(R)&&(R=R+""),Ue.isString(R))return(await b(R)).byteLength},I=async(R,O)=>{const P=Ue.toFiniteNumber(R.getContentLength());return P??N(O)};return async R=>{let{url:O,method:P,data:M,signal:D,cancelToken:U,timeout:B,onDownloadProgress:G,onUploadProgress:$,responseType:q,headers:X,withCredentials:ee="same-origin",fetchOptions:ce}=xQ(R),Q=n||fetch;q=q?(q+"").toLowerCase():"text";let ae=XTe([D,U&&U.toAbortSignal()],B),ve=null;const le=ae&&ae.unsubscribe&&(()=>{ae.unsubscribe()});let fe;try{if($&&_&&P!=="get"&&P!=="head"&&(fe=await I(X,M))!==0){let Fe=new s(O,{method:"POST",body:M,duplex:"half"}),ke;if(Ue.isFormData(M)&&(ke=Fe.headers.get("content-type"))&&X.setContentType(ke),Fe.body){const[Ge,De]=q7(fe,Yw(X7($)));M=Q7(Fe.body,Z7,Ge,De)}}Ue.isString(ee)||(ee=ee?"include":"omit");const re=h&&"credentials"in s.prototype,he={...ce,signal:ae,method:P.toUpperCase(),headers:X.normalize().toJSON(),body:M,duplex:"half",credentials:re?ee:void 0};ve=h&&new s(O,he);let J=await(h?Q(ve,ce):Q(O,he));const ue=w&&(q==="stream"||q==="response");if(w&&(G||ue&&le)){const Fe={};["status","statusText","headers"].forEach(Pe=>{Fe[Pe]=J[Pe]});const ke=Ue.toFiniteNumber(J.headers.get("content-length")),[Ge,De]=G&&q7(ke,Yw(X7(G),!0))||[];J=new o(Q7(J.body,Z7,Ge,()=>{De&&De(),le&&le()}),Fe)}q=q||"text";let Ee=await E[Ue.findKey(E,q)||"text"](J,R);return!ue&&le&&le(),await new Promise((Fe,ke)=>{yQ(Fe,ke,{data:Ee,headers:la.from(J.headers),status:J.status,statusText:J.statusText,config:R,request:ve})})}catch(re){throw le&&le(),re&&re.name==="TypeError"&&/Load failed|fetch/i.test(re.message)?Object.assign(new fn("Network Error",fn.ERR_NETWORK,R,ve),{cause:re.cause||re}):fn.from(re,re&&re.code,R,ve)}}},nNe=new Map,_Q=e=>{let n=e&&e.env||{};const{fetch:s,Request:o,Response:d}=n,h=[o,d,s];let f=h.length,v=f,b,_,w=nNe;for(;v--;)b=h[v],_=w.get(b),_===void 0&&w.set(b,_=v?new Map:tNe(n)),w=_;return _};_Q();const zj={http:bTe,xhr:qTe,fetch:{get:_Q}};Ue.forEach(zj,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const rH=e=>`- ${e}`,rNe=e=>Ue.isFunction(e)||e===null||e===!1;function iNe(e,n){e=Ue.isArray(e)?e:[e];const{length:s}=e;let o,d;const h={};for(let f=0;f<s;f++){o=e[f];let v;if(d=o,!rNe(o)&&(d=zj[(v=String(o)).toLowerCase()],d===void 0))throw new fn(`Unknown adapter '${v}'`);if(d&&(Ue.isFunction(d)||(d=d.get(n))))break;h[v||"#"+f]=d}if(!d){const f=Object.entries(h).map(([b,_])=>`adapter ${b} `+(_===!1?"is not supported by the environment":"is not available in the build"));let v=s?f.length>1?`since :
`+f.map(rH).join(`
`):" "+rH(f[0]):"as no adapter specified";throw new fn("There is no suitable adapter to dispatch the request "+v,"ERR_NOT_SUPPORT")}return d}const EQ={getAdapter:iNe,adapters:zj};function dO(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ug(null,e)}function iH(e){return dO(e),e.headers=la.from(e.headers),e.data=lO.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),EQ.getAdapter(e.adapter||cb.adapter,e)(e).then(function(o){return dO(e),o.data=lO.call(e,e.transformResponse,o),o.headers=la.from(o.headers),o},function(o){return vQ(o)||(dO(e),o&&o.response&&(o.response.data=lO.call(e,e.transformResponse,o.response),o.response.headers=la.from(o.response.headers))),Promise.reject(o)})}const wQ="1.13.2",TT={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{TT[e]=function(o){return typeof o===e||"a"+(n<1?"n ":" ")+e}});const sH={};TT.transitional=function(n,s,o){function d(h,f){return"[Axios v"+wQ+"] Transitional option '"+h+"'"+f+(o?". "+o:"")}return(h,f,v)=>{if(n===!1)throw new fn(d(f," has been removed"+(s?" in "+s:"")),fn.ERR_DEPRECATED);return s&&!sH[f]&&(sH[f]=!0,console.warn(d(f," has been deprecated since v"+s+" and will be removed in the near future"))),n?n(h,f,v):!0}};TT.spelling=function(n){return(s,o)=>(console.warn(`${o} is likely a misspelling of ${n}`),!0)};function sNe(e,n,s){if(typeof e!="object")throw new fn("options must be an object",fn.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let d=o.length;for(;d-- >0;){const h=o[d],f=n[h];if(f){const v=e[h],b=v===void 0||f(v,h,e);if(b!==!0)throw new fn("option "+h+" must be "+b,fn.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new fn("Unknown option "+h,fn.ERR_BAD_OPTION)}}const vw={assertOptions:sNe,validators:TT},Gc=vw.validators;let Gh=class{constructor(n){this.defaults=n||{},this.interceptors={request:new K7,response:new K7}}async request(n,s){try{return await this._request(n,s)}catch(o){if(o instanceof Error){let d={};Error.captureStackTrace?Error.captureStackTrace(d):d=new Error;const h=d.stack?d.stack.replace(/^.+\n/,""):"";try{o.stack?h&&!String(o.stack).endsWith(h.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+h):o.stack=h}catch{}}throw o}}_request(n,s){typeof n=="string"?(s=s||{},s.url=n):s=n||{},s=Jh(this.defaults,s);const{transitional:o,paramsSerializer:d,headers:h}=s;o!==void 0&&vw.assertOptions(o,{silentJSONParsing:Gc.transitional(Gc.boolean),forcedJSONParsing:Gc.transitional(Gc.boolean),clarifyTimeoutError:Gc.transitional(Gc.boolean)},!1),d!=null&&(Ue.isFunction(d)?s.paramsSerializer={serialize:d}:vw.assertOptions(d,{encode:Gc.function,serialize:Gc.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),vw.assertOptions(s,{baseUrl:Gc.spelling("baseURL"),withXsrfToken:Gc.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let f=h&&Ue.merge(h.common,h[s.method]);h&&Ue.forEach(["delete","get","head","post","put","patch","common"],R=>{delete h[R]}),s.headers=la.concat(f,h);const v=[];let b=!0;this.interceptors.request.forEach(function(O){typeof O.runWhen=="function"&&O.runWhen(s)===!1||(b=b&&O.synchronous,v.unshift(O.fulfilled,O.rejected))});const _=[];this.interceptors.response.forEach(function(O){_.push(O.fulfilled,O.rejected)});let w,E=0,N;if(!b){const R=[iH.bind(this),void 0];for(R.unshift(...v),R.push(..._),N=R.length,w=Promise.resolve(s);E<N;)w=w.then(R[E++],R[E++]);return w}N=v.length;let I=s;for(;E<N;){const R=v[E++],O=v[E++];try{I=R(I)}catch(P){O.call(this,P);break}}try{w=iH.call(this,I)}catch(R){return Promise.reject(R)}for(E=0,N=_.length;E<N;)w=w.then(_[E++],_[E++]);return w}getUri(n){n=Jh(this.defaults,n);const s=bQ(n.baseURL,n.url,n.allowAbsoluteUrls);return mQ(s,n.params,n.paramsSerializer)}};Ue.forEach(["delete","get","head","options"],function(n){Gh.prototype[n]=function(s,o){return this.request(Jh(o||{},{method:n,url:s,data:(o||{}).data}))}});Ue.forEach(["post","put","patch"],function(n){function s(o){return function(h,f,v){return this.request(Jh(v||{},{method:n,headers:o?{"Content-Type":"multipart/form-data"}:{},url:h,data:f}))}}Gh.prototype[n]=s(),Gh.prototype[n+"Form"]=s(!0)});let aNe=class SQ{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(h){s=h});const o=this;this.promise.then(d=>{if(!o._listeners)return;let h=o._listeners.length;for(;h-- >0;)o._listeners[h](d);o._listeners=null}),this.promise.then=d=>{let h;const f=new Promise(v=>{o.subscribe(v),h=v}).then(d);return f.cancel=function(){o.unsubscribe(h)},f},n(function(h,f,v){o.reason||(o.reason=new ug(h,f,v),s(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const s=this._listeners.indexOf(n);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const n=new AbortController,s=o=>{n.abort(o)};return this.subscribe(s),n.signal.unsubscribe=()=>this.unsubscribe(s),n.signal}static source(){let n;return{token:new SQ(function(d){n=d}),cancel:n}}};function oNe(e){return function(s){return e.apply(null,s)}}function cNe(e){return Ue.isObject(e)&&e.isAxiosError===!0}const J2={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(J2).forEach(([e,n])=>{J2[n]=e});function TQ(e){const n=new Gh(e),s=nQ(Gh.prototype.request,n);return Ue.extend(s,Gh.prototype,n,{allOwnKeys:!0}),Ue.extend(s,n,null,{allOwnKeys:!0}),s.create=function(d){return TQ(Jh(e,d))},s}const Ln=TQ(cb);Ln.Axios=Gh;Ln.CanceledError=ug;Ln.CancelToken=aNe;Ln.isCancel=vQ;Ln.VERSION=wQ;Ln.toFormData=ST;Ln.AxiosError=fn;Ln.Cancel=Ln.CanceledError;Ln.all=function(n){return Promise.all(n)};Ln.spread=oNe;Ln.isAxiosError=cNe;Ln.mergeConfig=Jh;Ln.AxiosHeaders=la;Ln.formToJSON=e=>gQ(Ue.isHTMLForm(e)?new FormData(e):e);Ln.getAdapter=EQ.getAdapter;Ln.HttpStatusCode=J2;Ln.default=Ln;const{Axios:nqe,AxiosError:rqe,CanceledError:iqe,isCancel:sqe,CancelToken:aqe,VERSION:oqe,all:cqe,Cancel:lqe,isAxiosError:dqe,spread:uqe,toFormData:hqe,AxiosHeaders:pqe,HttpStatusCode:mqe,formToJSON:fqe,getAdapter:gqe,mergeConfig:vqe}=Ln,fv="healthai_cache_",lNe=5*60*1e3,zc={set(e,n,s=lNe){try{const o={value:n,expiry:Date.now()+s};localStorage.setItem(fv+e,JSON.stringify(o))}catch(o){console.error("Cache set error:",o)}},get(e){try{const n=localStorage.getItem(fv+e);if(!n)return null;const s=JSON.parse(n);return Date.now()>s.expiry?(this.delete(e),null):s.value}catch(n){return console.error("Cache get error:",n),null}},delete(e){try{localStorage.removeItem(fv+e)}catch(n){console.error("Cache delete error:",n)}},clear(){try{Object.keys(localStorage).forEach(n=>{n.startsWith(fv)&&localStorage.removeItem(n)})}catch(e){console.error("Cache clear error:",e)}},cleanup(){try{Object.keys(localStorage).forEach(n=>{if(n.startsWith(fv)){const s=localStorage.getItem(n);if(s){const o=JSON.parse(s);Date.now()>o.expiry&&localStorage.removeItem(n)}}})}catch(e){console.error("Cache cleanup error:",e)}}};zc.cleanup();setInterval(()=>zc.cleanup(),5*60*1e3);const dNe=()=>"/api",ht=Ln.create({baseURL:dNe(),headers:{"Content-Type":"application/json"}});console.log(" API Configuration:",{baseURL:ht.defaults.baseURL,hostname:window.location.hostname,isProd:!0,isDev:!1,mode:"production"});ht.interceptors.request.use(e=>{const n=localStorage.getItem("token");return n&&(e.headers.Authorization=`Bearer ${n}`),e});ht.interceptors.response.use(e=>e,e=>{var n;return((n=e.response)==null?void 0:n.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),e.response||console.error("Network Error:",{message:e.message,apiUrl:ht.defaults.baseURL,currentHost:window.location.hostname,currentPort:window.location.port}),Promise.reject(e)});const da={uploadReport:e=>ht.post("/health/upload",e,{headers:{"Content-Type":"multipart/form-data"}}),getReports:()=>ht.get("/health/reports"),getReport:e=>ht.get(`/health/reports/${e}`),deleteReport:e=>ht.delete(`/health/reports/${e}`),getDashboard:()=>ht.get("/health/dashboard"),getHistory:e=>ht.get("/health/history",{params:{reportType:e}}),compareReport:e=>ht.get(`/health/reports/${e}/compare`),chatAboutReport:(e,n,s)=>ht.post(`/health/reports/${e}/chat`,{message:n,chatHistory:s}),askAI:e=>ht.post("/health/ai-chat",e),getMetricInfo:e=>ht.post("/health/metric-info",e)},ra={getAll:e=>ht.get("/doctors",{params:e}),getById:e=>ht.get(`/doctors/${e}`),getRecommended:e=>ht.get("/doctors/recommended",{params:{specializations:e}}),bookAppointment:e=>ht.post("/doctors/book",e),getAppointments:()=>ht.get("/doctors/appointments"),getAppointment:e=>ht.get(`/doctors/appointments/${e}`),startConsultation:e=>ht.post(`/doctors/appointments/${e}/start`),endConsultation:e=>ht.post(`/doctors/appointments/${e}/end`),getConsultationSummary:e=>ht.get(`/doctors/appointments/${e}/summary`),submitReview:(e,n)=>ht.post(`/doctors/appointments/${e}/review`,n),downloadPrescription:e=>ht.get(`/doctors/appointments/${e}/prescription`,{responseType:"blob"}),getDashboard:()=>ht.get("/doctors/me/dashboard"),getMyProfile:()=>ht.get("/doctors/me/profile"),updateMyProfile:e=>ht.put("/doctors/me/profile",e),getMyAppointments:e=>ht.get("/doctors/me/appointments",{params:e}),updateAppointmentStatus:(e,n)=>ht.patch(`/doctors/me/appointments/${e}`,n),getPatientProfile:(e,n)=>ht.get(`/doctors/patient/${e}`,{params:{appointmentId:n}}),getDoctorAppointments:(e,n)=>ht.get(`/doctors/${e}/appointments`,{params:{status:n}}),getMyAvailability:()=>ht.get("/doctors/me/availability"),updateMyAvailability:e=>ht.put("/doctors/me/availability",e),generateTimeSlots:()=>ht.post("/doctors/me/generate-slots"),getDoctorAvailableSlots:(e,n)=>ht.get(`/doctors/${e}/available-slots`,{params:{date:n}}),checkSlotAvailability:(e,n,s)=>ht.get(`/doctors/${e}/check-slot`,{params:{date:n,timeSlot:s}})},$m={connectDevice:(e,n)=>ht.post("/wearables/connect",{deviceType:e,deviceName:n}),disconnectDevice:e=>ht.post(`/wearables/disconnect/${e}`),getDevices:()=>ht.get("/wearables/devices"),syncMetrics:(e,n)=>ht.post("/wearables/sync",{deviceType:e,metrics:n}),addHeartRate:(e,n,s)=>ht.post("/wearables/heart-rate",{deviceType:e,bpm:n,type:s}),addSleepData:(e,n)=>ht.post("/wearables/sleep",{deviceType:e,sleepData:n}),getDashboard:()=>ht.get("/wearables/dashboard"),generateDemoData:e=>ht.post("/wearables/demo-data",{deviceType:e})},yw={getStats:()=>ht.get("/admin/stats"),getUsers:e=>ht.get("/admin/users",{params:e}),getUserDetails:e=>ht.get(`/admin/users/${e}`),updateUserStatus:(e,n)=>ht.patch(`/admin/users/${e}/status`,{isActive:n}),getReports:e=>ht.get("/admin/reports",{params:e}),getDeficiencyRules:()=>ht.get("/admin/deficiency-rules"),createDeficiencyRule:e=>ht.post("/admin/deficiency-rules",e),updateDeficiencyRule:(e,n)=>ht.put(`/admin/deficiency-rules/${e}`,n),deleteDeficiencyRule:e=>ht.delete(`/admin/deficiency-rules/${e}`),getSupplements:()=>ht.get("/admin/supplements"),createSupplement:e=>ht.post("/admin/supplements",e),updateSupplement:(e,n)=>ht.put(`/admin/supplements/${e}`,n),deleteSupplement:e=>ht.delete(`/admin/supplements/${e}`),getDietPlans:e=>ht.get("/admin/diet-plans",{params:e}),createDietPlan:e=>ht.post("/admin/diet-plans",e),updateDietPlan:(e,n)=>ht.put(`/admin/diet-plans/${e}`,n),approveDietPlan:(e,n)=>ht.patch(`/admin/diet-plans/${e}/approve`,{status:n}),deleteDietPlan:e=>ht.delete(`/admin/diet-plans/${e}`),getDoctors:e=>ht.get("/admin/doctors",{params:e}),createDoctor:e=>ht.post("/admin/doctors",e),updateDoctor:(e,n)=>ht.put(`/admin/doctors/${e}`,n),approveDoctor:e=>ht.patch(`/admin/doctors/${e}/approve`),rejectDoctor:(e,n)=>ht.patch(`/admin/doctors/${e}/reject`,{reason:n}),deleteDoctor:e=>ht.delete(`/admin/doctors/${e}`),toggleDoctorVisibility:e=>ht.patch(`/admin/doctors/${e}/visibility`),getDoctorScheduleOverview:e=>ht.get(`/admin/doctors/${e}/schedule-overview`)},uNe={getSubscription:()=>ht.get("/auth/subscription")},hNe={analyzeFood:e=>ht.post("/nutrition/analyze-food",{foodDescription:e}),logMeal:e=>ht.post("/nutrition/log-meal",e),getTodayLogs:()=>ht.get("/nutrition/logs/today"),getDailySummary:e=>ht.get("/nutrition/summary/daily",{params:{date:e}}),getGoals:()=>ht.get("/nutrition/goals"),updateGoals:e=>ht.put("/nutrition/goals",e)},NQ=z.createContext(),as=()=>z.useContext(NQ),pNe=({children:e})=>{const[n,s]=z.useState(null),[o,d]=z.useState(!0);z.useEffect(()=>{const O=localStorage.getItem("token"),P=localStorage.getItem("user");O&&P&&(s(JSON.parse(P)),ht.defaults.headers.common.Authorization=`Bearer ${O}`),d(!1)},[]);const h=async(O,P)=>{const D=O.includes("@")?{email:O,password:P}:{phone:O,password:P},{data:U}=await ht.post("/auth/login",D);return localStorage.setItem("token",U.token),localStorage.setItem("user",JSON.stringify(U)),ht.defaults.headers.common.Authorization=`Bearer ${U.token}`,s(U),U},f=async(O,P,M,D={},U=null)=>{const{data:B}=await ht.post("/auth/register",{name:O,email:P,password:M,profile:D,nutritionGoal:U});return localStorage.setItem("token",B.token),localStorage.setItem("user",JSON.stringify(B)),ht.defaults.headers.common.Authorization=`Bearer ${B.token}`,s(B),B},v=async O=>{const{data:P}=await ht.post("/auth/register/doctor",O);return localStorage.setItem("token",P.token),localStorage.setItem("user",JSON.stringify(P)),ht.defaults.headers.common.Authorization=`Bearer ${P.token}`,s(P),P},b=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete ht.defaults.headers.common.Authorization,s(null)},_=O=>{s(O),localStorage.setItem("user",JSON.stringify(O))},w=()=>(n==null?void 0:n.role)==="admin",E=()=>(n==null?void 0:n.role)==="doctor",N=()=>(n==null?void 0:n.role)==="patient"||(n==null?void 0:n.role)==="client",I=()=>{var O;return((O=n==null?void 0:n.doctorProfile)==null?void 0:O.approvalStatus)==="approved"},R=()=>{var O;return((O=n==null?void 0:n.subscription)==null?void 0:O.status)==="active"};return c.jsx(NQ.Provider,{value:{user:n,login:h,register:f,registerDoctor:v,logout:b,updateUser:_,loading:o,isAdmin:w,isDoctor:E,isPatient:N,isDoctorApproved:I,isSubscribed:R},children:e})};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var mNe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fNe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Qe=(e,n)=>{const s=z.forwardRef(({color:o="currentColor",size:d=24,strokeWidth:h=2,absoluteStrokeWidth:f,className:v="",children:b,..._},w)=>z.createElement("svg",{ref:w,...mNe,width:d,height:d,stroke:o,strokeWidth:f?Number(h)*24/Number(d):h,className:["lucide",`lucide-${fNe(e)}`,v].join(" "),..._},[...n.map(([E,N])=>z.createElement(E,N)),...Array.isArray(b)?b:[b]]));return s.displayName=`${e}`,s};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=Qe("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=Qe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=Qe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=Qe("Apple",[["path",{d:"M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z",key:"3s7exb"}],["path",{d:"M10 2c1 .5 2 2 2 5",key:"fcco2y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CQ=Qe("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=Qe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=Qe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=Qe("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=Qe("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RQ=Qe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gNe=Qe("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vNe=Qe("Beef",[["circle",{cx:"12.5",cy:"8.5",r:"2.5",key:"9738u8"}],["path",{d:"M12.5 2a6.5 6.5 0 0 0-6.22 4.6c-1.1 3.13-.78 3.9-3.18 6.08A3 3 0 0 0 5 18c4 0 8.4-1.8 11.4-4.3A6.5 6.5 0 0 0 12.5 2Z",key:"o0f6za"}],["path",{d:"m18.5 6 2.19 4.5a6.48 6.48 0 0 1 .31 2 6.49 6.49 0 0 1-2.6 5.2C15.4 20.2 11 22 7 22a3 3 0 0 1-2.68-1.66L2.4 16.5",key:"k7p6i0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yNe=Qe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bNe=Qe("Bone",[["path",{d:"M17 10c.7-.7 1.69 0 2.5 0a2.5 2.5 0 1 0 0-5 .5.5 0 0 1-.5-.5 2.5 2.5 0 1 0-5 0c0 .81.7 1.8 0 2.5l-7 7c-.7.7-1.69 0-2.5 0a2.5 2.5 0 0 0 0 5c.28 0 .5.22.5.5a2.5 2.5 0 1 0 5 0c0-.81-.7-1.8 0-2.5Z",key:"w610uw"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xNe=Qe("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uO=Qe("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jh=Qe("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=Qe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AQ=Qe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=Qe("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=Qe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=Qe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _Ne=Qe("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=Qe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IQ=Qe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=Qe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ENe=Qe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wNe=Qe("Cigarette",[["path",{d:"M18 12H2v4h16",key:"2rt1hm"}],["path",{d:"M22 12v4",key:"142cbu"}],["path",{d:"M7 12v4",key:"jqww69"}],["path",{d:"M18 8c0-2.5-2-2.5-2-5",key:"1il607"}],["path",{d:"M22 8c0-2.5-2-2.5-2-5",key:"1gah44"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SNe=Qe("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=Qe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TNe=Qe("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NNe=Qe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OQ=Qe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=Qe("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PQ=Qe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=Qe("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qh=Qe("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Of=Qe("Dumbbell",[["path",{d:"m6.5 6.5 11 11",key:"f7oqzb"}],["path",{d:"m21 21-1-1",key:"cpc6if"}],["path",{d:"m3 3 1 1",key:"d3rpuf"}],["path",{d:"m18 22 4-4",key:"1e32o6"}],["path",{d:"m2 6 4-4",key:"189tqz"}],["path",{d:"m3 10 7-7",key:"1bxui2"}],["path",{d:"m14 21 7-7",key:"16x78n"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kQ=Qe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ll=Qe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=Qe("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ml=Qe("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jQ=Qe("Footprints",[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z",key:"1dudjm"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z",key:"l2t8xc"}],["path",{d:"M16 17h4",key:"1dejxt"}],["path",{d:"M4 13h4",key:"1bwh8b"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aH=Qe("GitCompare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zn=Qe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CNe=Qe("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RNe=Qe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=Qe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NT=Qe("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hO=Qe("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=Qe("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ANe=Qe("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oH=Qe("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=Qe("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cH=Qe("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=Qe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hj=Qe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=Qe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=Qe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DQ=Qe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lH=Qe("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=Qe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LQ=Qe("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MQ=Qe("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=Qe("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const INe=Qe("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=Qe("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ONe=Qe("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PNe=Qe("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kNe=Qe("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kj=Qe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=Qe("Pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=Qe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jNe=Qe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DNe=Qe("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LNe=Qe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dH=Qe("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=Qe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=Qe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=Qe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MNe=Qe("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const my=Qe("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UQ=Qe("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wh=Qe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=Qe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yj=Qe("Stethoscope",[["path",{d:"M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3",key:"1jd90r"}],["path",{d:"M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4",key:"126ukv"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qj=Qe("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=Qe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=Qe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CT=Qe("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=Qe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=Qe("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=Qe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FQ=Qe("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=Qe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=Qe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UNe=Qe("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fu=Qe("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=Qe("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.34l1 1L22 8v8",key:"ubwiq0"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2l10 10Z",key:"1l10zd"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=Qe("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FNe=Qe("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VNe=Qe("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=Qe("Watch",[["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["polyline",{points:"12 10 12 12 13 13",key:"19dquz"}],["path",{d:"m16.13 7.66-.81-4.05a2 2 0 0 0-2-1.61h-2.68a2 2 0 0 0-2 1.61l-.78 4.05",key:"18k57s"}],["path",{d:"m7.88 16.36.8 4a2 2 0 0 0 2 1.61h2.72a2 2 0 0 0 2-1.61l.81-4.05",key:"16ny36"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BNe=Qe("Wheat",[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GNe=Qe("Wine",[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VQ=Qe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=Qe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=Qe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function WNe(){const[e,n]=z.useState(""),[s,o]=z.useState({x:0,y:0}),[d,h]=z.useState(!1),f=Us();z.useEffect(()=>{const b=()=>{const _=window.getSelection(),w=_.toString().trim();if(w.length>0){const N=_.getRangeAt(0).getBoundingClientRect();n(w),o({x:N.left+N.width/2,y:N.top-10}),h(!0)}else h(!1)};return document.addEventListener("mouseup",b),document.addEventListener("touchend",b),()=>{document.removeEventListener("mouseup",b),document.removeEventListener("touchend",b)}},[]);const v=()=>{f("/ai-chat",{state:{selectedText:e}}),h(!1)};return d?c.jsx("div",{className:"fixed z-50 animate-fade-in",style:{left:`${s.x}px`,top:`${s.y}px`,transform:"translate(-50%, -100%)"},children:c.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-lg shadow-lg hover:shadow-xl transition-all text-sm font-medium",children:[c.jsx(cu,{className:"w-4 h-4"}),"Ask AI"]})}):null}function $Ne(){var N,I;const e=mc(),n=Us(),{user:s,logout:o}=as(),[d,h]=z.useState(!1),[f,v]=z.useState(!1);z.useEffect(()=>{const R=()=>{const M=document.querySelectorAll(".fixed");let D=!1;M.forEach(U=>{const B=U.className,G=B.includes("bg-black")||B.includes("inset-0"),$=B.includes("z-50")||B.includes("z-40");G&&$&&U.offsetHeight>0&&(D=!0)}),e.pathname==="/ai-chat"&&(D=!0),v(D||d)};R();const O=setTimeout(R,100),P=new MutationObserver(R);return P.observe(document.body,{childList:!0,subtree:!0}),()=>{clearTimeout(O),P.disconnect()}},[e.pathname,d]);const b=[{path:"/dashboard",icon:NT,label:"Home"},{path:"/ai-chat",icon:cu,label:"AI"},{path:"/nutrition",icon:fu,label:"Nutrition",isCenter:!0},{path:"/upload",icon:Vn,label:"Reports"}],_=[{path:"/profile",icon:pg,label:"Profile"},{path:"/diet-plan",icon:zn,label:"Diet Plan"},{path:"/wearables",icon:Ol,label:"Wearables",comingSoon:!0},{path:"#appointment",icon:qr,label:"Appointment",comingSoon:!0}],w=R=>e.pathname===R,E=()=>{o(),et.success("Logged out successfully"),n("/login"),h(!1)};return c.jsxs(c.Fragment,{children:[d&&c.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden",onClick:()=>h(!1)}),d&&c.jsxs("div",{className:"fixed bottom-24 right-4 left-4 sm:left-auto sm:w-72 bg-gradient-to-br from-white to-cyan-50 rounded-3xl shadow-2xl z-50 overflow-hidden animate-fade-in border-2 border-cyan-200",children:[c.jsx("div",{className:"p-5 bg-gradient-to-r from-cyan-500 to-blue-500",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"font-bold text-white text-lg",children:"Menu"}),c.jsx("button",{onClick:()=>h(!1),className:"text-white hover:bg-white/20 rounded-full p-1.5 transition-colors",children:c.jsx(di,{className:"w-5 h-5"})})]})}),c.jsxs("div",{className:"space-y-1 p-3",children:[_.map(R=>{const O=R.icon,P=w(R.path);return R.comingSoon?c.jsxs("div",{className:"w-full flex items-center justify-between px-4 py-3.5 text-slate-500 bg-slate-50 rounded-xl opacity-60 cursor-not-allowed text-sm",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-slate-200 flex items-center justify-center",children:c.jsx(O,{className:"w-5 h-5"})}),c.jsx("span",{className:"font-medium",children:R.label})]}),c.jsx("span",{className:"text-xs bg-amber-100 text-amber-700 px-2.5 py-1 rounded-full font-semibold",children:"Soon"})]},R.label):R.path==="#appointment"?c.jsxs("button",{onClick:()=>{et.info("Appointment coming soon"),h(!1)},className:"w-full flex items-center gap-3 px-4 py-3.5 text-slate-700 hover:bg-cyan-50 rounded-xl transition-all text-sm group",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-cyan-100 flex items-center justify-center group-hover:bg-cyan-200 transition-colors",children:c.jsx(O,{className:"w-5 h-5 text-cyan-600"})}),c.jsx("span",{className:"font-medium",children:R.label})]},R.label):c.jsxs(Ct,{to:R.path,onClick:()=>h(!1),className:`flex items-center gap-3 px-4 py-3.5 rounded-xl transition-all text-sm group ${P?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg":"text-slate-700 hover:bg-cyan-50"}`,children:[c.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center transition-colors ${P?"bg-white/20":"bg-cyan-100 group-hover:bg-cyan-200"}`,children:c.jsx(O,{className:`w-5 h-5 ${P?"text-white":"text-cyan-600"}`})}),c.jsx("span",{className:"font-medium",children:R.label})]},R.path)}),c.jsx("div",{className:"border-t-2 border-cyan-100 my-3"}),c.jsxs("div",{className:"px-4 py-2 flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center text-white font-bold",children:(I=(N=s==null?void 0:s.name)==null?void 0:N[0])==null?void 0:I.toUpperCase()}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-semibold text-slate-800 truncate",children:s==null?void 0:s.name}),c.jsx("p",{className:"text-xs text-slate-500 truncate",children:s==null?void 0:s.email})]})]}),c.jsxs("button",{onClick:E,className:"w-full flex items-center gap-3 px-4 py-3.5 text-red-600 hover:bg-red-50 rounded-xl transition-all text-sm font-medium group",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-100 flex items-center justify-center group-hover:bg-red-200 transition-colors",children:c.jsx(Hj,{className:"w-5 h-5"})}),c.jsx("span",{children:"Logout"})]})]})]}),c.jsx("nav",{className:`mobile-bottom-nav-container ${f?"hidden":""}`,children:c.jsxs("div",{className:"mobile-bottom-nav",children:[b.map(R=>{const O=R.icon,P=w(R.path);return R.isCenter?c.jsx(Ct,{to:R.path,className:"nav-center-fab flex flex-col items-center justify-center","aria-label":R.label,title:R.label,children:c.jsx(O,{className:"w-7 h-7"})},R.path):c.jsxs(Ct,{to:R.path,className:`nav-item-modern flex flex-col items-center justify-center gap-0.5 ${P?"active":""}`,"aria-label":R.label,title:R.label,children:[c.jsx(O,{className:"w-5 h-5"}),c.jsx("span",{className:"text-[9px] font-medium",children:R.label})]},R.path)}),c.jsxs("button",{onClick:()=>h(!d),className:`nav-item-modern flex flex-col items-center justify-center gap-0.5 ${d?"active":""}`,"aria-label":"More options",title:"More options",children:[c.jsx(ONe,{className:"w-5 h-5"}),c.jsx("span",{className:"text-[9px] font-medium",children:"More"})]})]})})]})}const zNe=[{path:"/dashboard",icon:NT,label:"Dashboard"},{path:"/ai-chat",icon:cu,label:"AI Assistant"},{path:"/upload",icon:Vn,label:"My Reports"},{path:"/nutrition",icon:fu,label:"Nutrition"},{path:"/diet-plan",icon:Pa,label:"Diet Plan"},{path:"/profile",icon:pg,label:"Profile"},{path:"/doctors",icon:qr,label:"Appointments",comingSoon:!0},{path:"/wearables",icon:Ol,label:"Devices",comingSoon:!0}],HNe=[{path:"/doctor/dashboard",icon:NT,label:"Dashboard"},{path:"/doctor/availability",icon:To,label:"Manage Slots"},{path:"/profile",icon:pg,label:"Profile"}],KNe=[{path:"/admin",icon:NT,label:"Dashboard"},{path:"/profile",icon:pg,label:"Settings"}];function oi({children:e,isAdmin:n,isDoctor:s}){var P,M,D,U;const{user:o,logout:d,isAdmin:h,isDoctor:f}=as(),v=mc(),b=Us(),[_,w]=z.useState(!1),E=()=>{d(),b("/")};let N=zNe,I="/dashboard",R="Patient Portal";return h()||n?(N=KNe,I="/admin",R="Admin Panel"):(f()||s)&&(N=HNe,I="/doctor/dashboard",R=((P=o==null?void 0:o.doctorProfile)==null?void 0:P.specialization)||"Doctor Portal"),c.jsxs("div",{className:"min-h-screen flex bg-gradient-to-br from-cyan-50 via-blue-50 to-cyan-100",children:[c.jsx("aside",{className:`fixed inset-y-0 right-0 lg:left-0 lg:right-auto z-50 w-64 bg-white shadow-lg lg:shadow-sm transform transition-transform duration-300 hidden lg:flex lg:flex-col ${_?"translate-x-0":"translate-x-full lg:translate-x-0"}`,style:{borderRight:"2px solid #E5DFD3",borderLeft:"2px solid #E5DFD3"},children:c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsx("div",{className:"p-6 shrink-0",style:{borderBottom:"1px solid #E5DFD3"},children:c.jsxs(Ct,{to:I,className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{backgroundColor:"#8B7355"},children:c.jsx(jn,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("p",{className:"font-bold",style:{color:"#2C2416"},children:"FitCure"}),c.jsx("p",{className:"text-xs",style:{color:"#5C4F3D"},children:R})]})]})}),c.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:N.map(({path:B,icon:G,label:$,comingSoon:q})=>q?c.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-all cursor-not-allowed relative",style:{color:"#5C4F3D",opacity:.6},children:[c.jsx(G,{className:"w-5 h-5"}),c.jsx("span",{children:$}),c.jsx("span",{className:"ml-auto text-xs px-2 py-0.5 rounded-full font-semibold",style:{backgroundColor:"#8B7355",color:"white"},children:"Soon"})]},B):c.jsxs(Ct,{to:B,onClick:()=>w(!1),className:`flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-all ${v.pathname===B?"border":""}`,style:v.pathname===B?{backgroundColor:"#F5F1EA",color:"#8B7355",borderColor:"#E5DFD3"}:{color:"#5C4F3D"},onMouseEnter:X=>{v.pathname!==B&&(X.currentTarget.style.backgroundColor="#F5F1EA",X.currentTarget.style.color="#2C2416")},onMouseLeave:X=>{v.pathname!==B&&(X.currentTarget.style.backgroundColor="transparent",X.currentTarget.style.color="#5C4F3D")},children:[c.jsx(G,{className:"w-5 h-5"}),c.jsx("span",{children:$})]},B))}),c.jsx("div",{className:"p-4 shrink-0",style:{borderTop:"1px solid #E5DFD3"},children:c.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl",style:{backgroundColor:"#F5F1EA"},children:[c.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center shrink-0",style:{backgroundColor:"#8B7355"},children:c.jsx("span",{className:"text-white font-bold",children:(D=(M=o==null?void 0:o.name)==null?void 0:M[0])==null?void 0:D.toUpperCase()})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-medium truncate",style:{color:"#2C2416"},children:f()?`Dr. ${o==null?void 0:o.name}`:o==null?void 0:o.name}),c.jsx("p",{className:"text-xs truncate",style:{color:"#5C4F3D"},children:o==null?void 0:o.email})]}),c.jsx("button",{onClick:E,className:"p-2 rounded-lg transition-all shrink-0",style:{color:"#5C4F3D"},onMouseEnter:B=>{B.currentTarget.style.color="#dc2626",B.currentTarget.style.backgroundColor="#fee2e2"},onMouseLeave:B=>{B.currentTarget.style.color="#5C4F3D",B.currentTarget.style.backgroundColor="transparent"},title:"Logout",children:c.jsx(Hj,{className:"w-5 h-5"})})]})})]})}),_&&c.jsx("div",{className:"fixed inset-0 bg-black/20 z-40 lg:hidden",onClick:()=>w(!1)}),c.jsxs("div",{className:"flex-1 flex flex-col min-h-screen lg:ml-64",children:[c.jsx("header",{className:"sticky top-0 z-30 bg-white/80 backdrop-blur-xl",style:{borderBottom:"1px solid #E5DFD3"},children:c.jsxs("div",{className:"flex items-center justify-between px-3 md:px-4 lg:px-8 py-3 md:py-4",children:[c.jsxs("div",{className:"flex items-center gap-2 md:gap-4 flex-1 md:flex-none",children:[c.jsxs(Ct,{to:I,className:"lg:hidden flex items-center gap-2 flex-shrink-0",children:[c.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:"#8B7355"},children:c.jsx(jn,{className:"w-5 h-5 text-white"})}),c.jsx("span",{className:"text-sm font-bold",style:{color:"#2C2416"},children:"FitCure"})]}),c.jsx("h1",{className:"text-base md:text-lg font-semibold hidden sm:block",style:{color:"#2C2416"},children:((U=N.find(B=>B.path===v.pathname))==null?void 0:U.label)||"Dashboard"})]}),c.jsxs("div",{className:"flex items-center gap-2 md:gap-3 overflow-hidden",children:[c.jsx("div",{className:"hidden md:flex items-center",children:c.jsxs("div",{className:"relative",children:[c.jsx(qw,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4",style:{color:"#5C4F3D"}}),c.jsx("input",{type:"text",placeholder:"Search...",className:"w-48 pl-10 pr-4 py-2 rounded-xl text-sm focus:outline-none",style:{backgroundColor:"#F5F1EA",border:"1px solid #E5DFD3",color:"#2C2416"}})]})}),c.jsxs("button",{className:"relative p-2 rounded-xl transition-all flex-shrink-0",style:{color:"#5C4F3D"},children:[c.jsx(yNe,{className:"w-5 h-5"}),c.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full"})]})]})]})}),c.jsx("main",{className:"flex-1 main-content-mobile overflow-x-hidden w-full",style:v.pathname==="/nutrition"||v.pathname==="/ai-chat"?{padding:0,backgroundColor:"white"}:v.pathname==="/dashboard"?{padding:0}:{padding:"0.75rem"},children:e}),!h()&&!f()&&!n&&!s&&c.jsx($Ne,{})]}),v.pathname!=="/ai-chat"&&c.jsx(WNe,{})]})}function YNe(){const[e,n]=z.useState(null),[s,o]=z.useState(!1),[d,h]=z.useState(!1);z.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){h(!0);return}const b=w=>{w.preventDefault(),n(w);const N=window.innerWidth<768?500:3e3,I=setTimeout(()=>{o(!0)},N);return()=>clearTimeout(I)},_=()=>{h(!0),o(!1),n(null),et.success("App installed successfully!")};return window.addEventListener("beforeinstallprompt",b),window.addEventListener("appinstalled",_),()=>{window.removeEventListener("beforeinstallprompt",b),window.removeEventListener("appinstalled",_)}},[]);const f=async()=>{if(!e)return;e.prompt();const{outcome:b}=await e.userChoice;b==="accepted"&&et.success("Installing HealthAI app..."),n(null),o(!1)},v=()=>{o(!1)};return d||!s||!e?null:c.jsx("div",{className:"fixed bottom-24 md:bottom-8 right-4 md:right-8 z-40 animate-slide-up",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-[#E5DFD3] p-4 md:p-6 max-w-sm",children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center flex-shrink-0",children:c.jsx(PQ,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-[#2C2416] text-sm md:text-base",children:"Install HealthAI"}),c.jsx("p",{className:"text-xs md:text-sm text-[#5C4F3D]",children:"Add to your home screen"})]})]}),c.jsx("button",{onClick:v,className:"text-[#5C4F3D] hover:text-[#2C2416] flex-shrink-0",children:c.jsx(di,{className:"w-5 h-5"})})]}),c.jsx("p",{className:"text-xs md:text-sm text-[#5C4F3D] mb-4",children:"Get quick access to your health data and features offline"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:f,className:"flex-1 px-4 py-2 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-xl font-medium hover:shadow-lg transition-all text-sm md:text-base",children:"Install"}),c.jsx("button",{onClick:v,className:"flex-1 px-4 py-2 bg-[#F5F1EA] text-[#2C2416] rounded-xl font-medium hover:bg-[#E5DFD3] transition-all text-sm md:text-base",children:"Later"})]})]})})}const uH=[{icon:zn,text:"Analyzing your health data...",color:"text-red-500"},{icon:jn,text:"Processing vital signs...",color:"text-blue-500"},{icon:Yj,text:"Consulting health records...",color:"text-green-500"},{icon:ka,text:"Checking medication history...",color:"text-purple-500"},{icon:Qh,text:"Evaluating hydration levels...",color:"text-cyan-500"},{icon:jh,text:"Analyzing wellness patterns...",color:"text-indigo-500"},{icon:Of,text:"Reviewing fitness goals...",color:"text-orange-500"},{icon:Pa,text:"Assessing nutrition data...",color:"text-green-600"}];function op({message:e}){const[n,s]=z.useState(0);z.useEffect(()=>{const f=setInterval(()=>{s(v=>(v+1)%uH.length)},2e3);return()=>clearInterval(f)},[]);const{icon:o,text:d,color:h}=uH[n];return c.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:[c.jsxs("div",{className:"relative mb-6",children:[c.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-100 animate-ping opacity-75"}),c.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-200 animate-pulse"}),c.jsx("div",{className:"relative w-20 h-20 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center shadow-lg",children:c.jsx(o,{className:"w-10 h-10 text-white animate-pulse"})})]}),c.jsxs("div",{className:"text-center space-y-2",children:[c.jsx("p",{className:"text-lg font-semibold text-gray-800 animate-fade-in",children:e||d}),c.jsxs("div",{className:"flex items-center justify-center gap-1",children:[c.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),c.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),c.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]}),c.jsx("div",{className:"mt-8 max-w-md text-center",children:c.jsx("p",{className:"text-sm text-gray-500 italic",children:" Tip: Stay hydrated and maintain a balanced diet for optimal health"})})]})}const qNe=()=>{const[e,n]=z.useState(!1),[s,o]=z.useState(!1),d=z.useRef(null);return z.useEffect(()=>{const h=f=>{d.current&&!d.current.contains(f.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]),c.jsx("header",{className:"fixed top-5 z-50 left-1/2 -translate-x-1/2 w-[calc(100%-200px)] max-w-5xl max-md:w-[calc(100%-40px)]",children:c.jsx("div",{className:"bg-white/80 backdrop-blur-md rounded-[28px] border border-white/40 shadow-2xl shadow-black/10",children:c.jsxs("div",{className:"px-6 lg:px-8",children:[c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("nav",{className:"hidden lg:flex items-center gap-6",children:[c.jsx("a",{href:"#features",className:"text-sm text-gray-700 hover:text-gray-900 transition-colors font-medium",children:"Features"}),c.jsx("a",{href:"#showcase",className:"text-sm text-gray-700 hover:text-gray-900 transition-colors font-medium",children:"Showcase"})]}),c.jsx(Ct,{to:"/",className:"absolute left-1/2 -translate-x-1/2",children:c.jsx("span",{className:"text-xl lg:text-2xl font-serif text-gray-900",children:"FitCure"})}),c.jsxs("div",{className:"hidden lg:flex items-center gap-6",children:[c.jsx("a",{href:"#testimonials",className:"text-sm text-gray-700 hover:text-gray-900 transition-colors font-medium",children:"Testimonials"}),c.jsx("a",{href:"#faq",className:"text-sm text-gray-700 hover:text-gray-900 transition-colors font-medium",children:"FAQ"}),c.jsxs("div",{className:"relative",ref:d,children:[c.jsx("button",{onClick:()=>o(!s),className:"w-10 h-10 rounded-full bg-cyan-500 flex items-center justify-center hover:bg-cyan-400 transition-colors ml-2",children:c.jsx(tl,{className:"w-5 h-5 text-white"})}),s&&c.jsxs("div",{className:"absolute right-0 mt-3 w-48 bg-white backdrop-blur-2xl rounded-2xl shadow-xl border border-gray-200 py-2 animate-fade-in",children:[c.jsx(Ct,{to:"/login",className:"block px-6 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors font-medium",onClick:()=>o(!1),children:"Sign In"}),c.jsx(Ct,{to:"/register",className:"block px-6 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors font-medium",onClick:()=>o(!1),children:"Get Started"})]})]})]}),c.jsx("button",{className:"lg:hidden p-2 text-gray-900 ml-auto",onClick:()=>n(!e),children:e?c.jsx(di,{className:"w-6 h-6"}):c.jsx(DQ,{className:"w-6 h-6"})})]}),e&&c.jsx("div",{className:"lg:hidden py-6 border-t border-gray-200",children:c.jsxs("nav",{className:"flex flex-col gap-4",children:[c.jsx("a",{href:"#features",className:"text-sm text-gray-700 hover:text-gray-900 py-2 font-medium",children:"Features"}),c.jsx("a",{href:"#showcase",className:"text-sm text-gray-700 hover:text-gray-900 py-2 font-medium",children:"Showcase"}),c.jsx("a",{href:"#testimonials",className:"text-sm text-gray-700 hover:text-gray-900 py-2 font-medium",children:"Testimonials"}),c.jsx("a",{href:"#faq",className:"text-sm text-gray-700 hover:text-gray-900 py-2 font-medium",children:"FAQ"}),c.jsxs("div",{className:"flex flex-col gap-2 pt-4 border-t border-gray-200",children:[c.jsx(Ct,{to:"/login",className:"text-sm text-gray-700 hover:text-gray-900 py-2 font-medium",children:"Sign In"}),c.jsx(Ct,{to:"/register",className:"text-sm text-gray-700 hover:text-gray-900 py-2 font-medium",children:"Get Started"})]})]})})]})})})},XNe=()=>c.jsxs("div",{className:"relative min-h-screen flex items-center overflow-hidden bg-gradient-to-b from-[#0a3d5c] to-[#0d5a8a]",children:[c.jsxs("div",{className:"absolute inset-0 z-0",children:[c.jsxs("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover opacity-60",children:[c.jsx("source",{src:"https://cdn.shopify.com/videos/c/o/v/dcb48db72fdb4641a2af2df51c03aad5.mp4",type:"video/mp4"}),c.jsx("img",{src:"https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?w=1920&h=1080&fit=crop",alt:"Healthcare",className:"w-full h-full object-cover opacity-60"})]}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/40 via-black/20 to-transparent"})]}),c.jsx("div",{className:"relative z-10 w-full max-w-7xl mx-auto px-6 sm:px-8 lg:px-12 py-32",children:c.jsxs("div",{className:"max-w-xl lg:max-w-2xl text-center lg:text-left",children:[c.jsx("p",{className:"text-xs sm:text-sm uppercase tracking-[0.2em] text-cyan-300 mb-6 font-medium",children:"SMART NUTRITION TRACKING"}),c.jsxs("h1",{className:"text-4xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-serif text-white mb-6 leading-[1.1]",children:["Take Control of your",c.jsx("br",{}),c.jsx("span",{className:"italic",children:"Health"})," Journey."]}),c.jsx("p",{className:"text-base sm:text-lg md:text-xl text-cyan-100 mb-10 leading-relaxed max-w-lg",children:"Empowers user to take informed action on their health through easy to understand insights, continuous tracking, and goal-based guidance."}),c.jsxs(Ct,{to:"/register",className:"inline-flex items-center gap-2 px-8 py-4 bg-cyan-500 text-white rounded-full font-medium hover:bg-cyan-400 transition-all group shadow-lg",children:["Start Tracking",c.jsx(vo,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"})]})]})}),c.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 flex flex-col items-center gap-2 z-10",children:[c.jsx("span",{className:"text-xs uppercase tracking-wider text-cyan-300 font-medium",children:"SCROLL"}),c.jsx("div",{className:"w-px h-12 bg-cyan-300/30"})]})]}),JNe=()=>{const e=[{icon:jn,title:"Health Tracking",description:"Effortless daily tracking"},{icon:Or,title:"Progress Analytics",description:"Real-time health insights"},{icon:ns,title:"Goal Setting",description:"Personalized targets"},{icon:zn,title:"Wellness Plans",description:"AI-powered recommendations"}];return c.jsx("section",{id:"features",className:"py-20 bg-transparent",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:e.map((n,s)=>{const o=n.icon;return c.jsxs("div",{className:"text-center bg-gradient-to-br from-[#0a3d5c]/60 to-[#0d5a8a]/60 backdrop-blur-sm rounded-2xl p-8 border border-cyan-400/30 hover:border-cyan-400/60 transition-all hover:shadow-lg hover:shadow-cyan-500/20",children:[c.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 mb-6 bg-cyan-500/20 rounded-full border border-cyan-400/40",children:c.jsx(o,{className:"w-12 h-12 text-cyan-300 stroke-[1.5]"})}),c.jsx("h3",{className:"text-lg font-serif text-white mb-2",children:n.title}),c.jsx("p",{className:"text-sm text-cyan-100",children:n.description})]},s)})})})})},QNe=()=>c.jsx("section",{className:"bg-transparent py-20",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[c.jsxs("div",{className:"relative rounded-3xl overflow-hidden group",children:[c.jsx("img",{src:"https://images.unsplash.com/photo-1490645935967-10de6ba17061?w=800&h=600&fit=crop",alt:"AI-Powered Nutrition",className:"w-full h-full object-cover min-h-[400px]"}),c.jsxs("div",{className:"absolute bottom-8 left-8 right-8 bg-gradient-to-r from-[#0a3d5c]/90 to-[#0d5a8a]/90 backdrop-blur-sm rounded-2xl p-6 border border-cyan-400/30",children:[c.jsx("h3",{className:"text-2xl font-serif text-white mb-2",children:"AI-Powered Nutrition"}),c.jsx("p",{className:"text-sm text-cyan-100",children:"Smart meal recognition and instant calorie calculation with advanced AI technology."})]})]}),c.jsxs("div",{className:"flex flex-col gap-8",children:[c.jsx("div",{className:"relative rounded-3xl overflow-hidden bg-gradient-to-br from-[#0a3d5c]/80 to-[#0d5a8a]/80 backdrop-blur-sm p-8 border border-cyan-400/30",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-2xl font-serif text-white mb-2",children:"Track Everything"}),c.jsx("h4",{className:"text-xl font-serif text-cyan-300 mb-4",children:"Achieve Anything"}),c.jsxs("ul",{className:"space-y-2 text-sm text-cyan-100",children:[c.jsxs("li",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"w-1 h-1 rounded-full bg-cyan-400"}),"Calorie & Macro Tracking"]}),c.jsxs("li",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"w-1 h-1 rounded-full bg-cyan-400"}),"Meal Planning & Recipes"]}),c.jsxs("li",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"w-1 h-1 rounded-full bg-cyan-400"}),"Progress Analytics"]})]})]}),c.jsx("div",{className:"flex-shrink-0",children:c.jsx("img",{src:"https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=300&h=400&fit=crop",alt:"Healthy Food",className:"w-48 h-64 object-cover rounded-2xl"})})]})}),c.jsx("div",{className:"relative rounded-3xl overflow-hidden bg-gradient-to-br from-[#0a3d5c]/80 to-[#0d5a8a]/80 backdrop-blur-sm p-8 border border-cyan-400/30",children:c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("div",{className:"w-16 h-16 rounded-full bg-cyan-500/20 flex items-center justify-center border border-cyan-400/50",children:c.jsx(UQ,{className:"w-8 h-8 text-cyan-300"})})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-xl font-serif text-white mb-2",children:"Report Analyzer"}),c.jsx("p",{className:"text-sm text-cyan-100",children:"Track on-the-go"})]}),c.jsx("div",{className:"flex-shrink-0",children:c.jsx("img",{src:"https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?w=200&h=200&fit=crop",alt:"Mobile App",className:"w-32 h-32 object-cover rounded-xl"})})]})})]})]})})}),ZNe=()=>{const[e,n]=z.useState(0),s=z.useRef(null),o=[{title:"Track Your Health Metrics",description:"Monitor vital signs, lab results, and health trends all in one place with AI-powered insights.",phoneScreen:"dashboard",cards:[{icon:zn,title:"Heart Rate",value:"72 bpm",color:"rose",position:"left-top"},{icon:jn,title:"Blood Pressure",value:"120/80",color:"blue",position:"left-bottom"},{icon:Or,title:"Health Score",value:"85/100",color:"emerald",position:"right-top"},{icon:ka,title:"Vitamin D",value:"45 ng/mL",color:"amber",position:"right-bottom"}]},{title:"Smart Nutrition Tracking",description:"Track your meals and get actionable feedback that helps you build a better relationship with food.",phoneScreen:"nutrition",cards:[{icon:fu,title:"Today's Meals",value:"3 logged",color:"emerald",position:"left-top"},{icon:jn,title:"Calories",value:"1,850 kcal",color:"orange",position:"left-bottom"},{icon:Or,title:"Protein",value:"95g",color:"blue",position:"right-top"},{icon:zn,title:"Macro Balance",value:"Optimal",color:"purple",position:"right-bottom"}]},{title:"AI-Powered Health Insights",description:"Get personalized recommendations based on your medical reports and wearable data.",phoneScreen:"ai-chat",cards:[{icon:cu,title:"AI Assistant",value:"24/7 Available",color:"cyan",position:"left-top"},{icon:Or,title:"Insights",value:"12 new",color:"indigo",position:"left-bottom"},{icon:qr,title:"Reminders",value:"5 today",color:"pink",position:"right-top"},{icon:zn,title:"Health Tips",value:"Updated",color:"red",position:"right-bottom"}]},{title:"Sleep & Recovery Tracking",description:"Improve your sleep by understanding patterns, identifying disruptions, and building habits.",phoneScreen:"sleep",cards:[{icon:hg,title:"Sleep Quality",value:"85%",color:"indigo",position:"left-top"},{icon:jn,title:"Sleep Duration",value:"7h 45m",color:"blue",position:"left-bottom"},{icon:Or,title:"Deep Sleep",value:"2h 15m",color:"purple",position:"right-top"},{icon:zn,title:"REM Sleep",value:"1h 30m",color:"pink",position:"right-bottom"}]}];z.useEffect(()=>{const v=()=>{if(!s.current)return;const b=s.current,{top:_,height:w}=b.getBoundingClientRect(),E=window.innerHeight,N=(E/2-_)/(w-E/2),I=Math.max(0,Math.min(1,N)),R=Math.floor(I*o.length),O=Math.min(R,o.length-1);n(O)};return window.addEventListener("scroll",v),v(),()=>window.removeEventListener("scroll",v)},[o.length]);const d=v=>({"left-top":"left-[1%] sm:left-[3%] md:left-[8%] top-[8%] sm:top-[10%] md:top-[12%]","left-bottom":"left-[1%] sm:left-[5%] md:left-[10%] bottom-[12%] sm:bottom-[15%] md:bottom-[18%]","right-top":"right-[1%] sm:right-[3%] md:right-[8%] top-[14%] sm:top-[16%] md:top-[18%]","right-bottom":"right-[1%] sm:right-[5%] md:right-[10%] bottom-[6%] sm:bottom-[9%] md:bottom-[12%]"})[v]||"left-[10%] top-[20%]",h=(v,b)=>({"left-top":b?"opacity-100 translate-x-0 translate-y-0 scale-100":"opacity-0 translate-x-32 translate-y-16 scale-75","left-bottom":b?"opacity-100 translate-x-0 translate-y-0 scale-100":"opacity-0 translate-x-32 -translate-y-16 scale-75","right-top":b?"opacity-100 translate-x-0 translate-y-0 scale-100":"opacity-0 -translate-x-32 translate-y-16 scale-75","right-bottom":b?"opacity-100 translate-x-0 translate-y-0 scale-100":"opacity-0 -translate-x-32 -translate-y-16 scale-75"})[v],f=v=>({dashboard:"from-blue-500 to-cyan-500",nutrition:"from-emerald-500 to-green-500","ai-chat":"from-purple-500 to-pink-500",sleep:"from-indigo-500 to-blue-500"})[v]||"from-cyan-500 to-blue-500";return c.jsx("div",{id:"showcase",ref:s,className:"relative bg-transparent",style:{height:`${o.length*100}vh`},children:c.jsx("div",{className:"sticky top-0 h-screen flex items-center justify-center overflow-hidden pt-20 sm:pt-24 px-2 sm:px-4",children:c.jsx("div",{className:"relative w-full max-w-7xl mx-auto",children:c.jsxs("div",{className:"relative flex flex-col items-center",children:[c.jsx("div",{className:"text-center mb-2 sm:mb-3 max-w-2xl px-4 transition-all duration-700 transform relative z-30",children:c.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-serif text-white mb-6 sm:mb-8 leading-tight",children:o[e].title})}),c.jsx("div",{className:"absolute inset-0 pointer-events-none z-40",children:o[e].cards.map((v,b)=>{const _=v.icon,w={rose:{bg:"bg-rose-50",icon:"text-rose-500",value:"text-rose-600",border:"border-rose-100"},blue:{bg:"bg-blue-50",icon:"text-blue-500",value:"text-blue-600",border:"border-blue-100"},emerald:{bg:"bg-emerald-50",icon:"text-emerald-500",value:"text-emerald-600",border:"border-emerald-100"},amber:{bg:"bg-amber-50",icon:"text-amber-500",value:"text-amber-600",border:"border-amber-100"},orange:{bg:"bg-orange-50",icon:"text-orange-500",value:"text-orange-600",border:"border-orange-100"},purple:{bg:"bg-purple-50",icon:"text-purple-500",value:"text-purple-600",border:"border-purple-100"},cyan:{bg:"bg-cyan-50",icon:"text-cyan-500",value:"text-cyan-600",border:"border-cyan-100"},indigo:{bg:"bg-indigo-50",icon:"text-indigo-500",value:"text-indigo-600",border:"border-indigo-100"},pink:{bg:"bg-pink-50",icon:"text-pink-500",value:"text-pink-600",border:"border-pink-100"},red:{bg:"bg-red-50",icon:"text-red-500",value:"text-red-600",border:"border-red-100"}};return w[v.color]||w.blue,c.jsx("div",{className:`absolute ${d(v.position)} ${h(v.position,!0)} 
                      transition-all duration-1000 ease-out`,style:{transitionDelay:`${b*150}ms`},children:c.jsxs("div",{className:`bg-gradient-to-br from-[#0a3d5c]/90 to-[#0d5a8a]/90 rounded-xl sm:rounded-2xl shadow-xl p-3 sm:p-4 md:p-6 border border-cyan-400/40 
                      hover:shadow-2xl hover:-translate-y-1 transition-all duration-300 w-32 sm:w-40 md:w-48 backdrop-blur-sm`,children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg sm:rounded-xl bg-cyan-500/20 flex items-center justify-center mb-2 sm:mb-3 border border-cyan-400/30",children:c.jsx(_,{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-cyan-300",strokeWidth:2})}),c.jsx("h4",{className:"text-white font-medium text-xs sm:text-sm md:text-base mb-1 leading-tight",children:v.title}),c.jsx("p",{className:"text-cyan-300 font-bold text-base sm:text-lg md:text-xl",children:v.value})]})},b)})}),c.jsxs("div",{className:"relative transform perspective-1000 z-10",children:[c.jsxs("div",{className:"relative w-[240px] sm:w-[280px] md:w-[320px] lg:w-[340px] h-[480px] sm:h-[560px] md:h-[640px] lg:h-[680px] bg-slate-900 rounded-[2.5rem] sm:rounded-[3rem] md:rounded-[3.5rem] p-2 sm:p-3 shadow-2xl",children:[c.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-28 sm:w-32 md:w-36 h-5 sm:h-6 md:h-7 bg-slate-900 rounded-b-2xl sm:rounded-b-3xl z-10"}),c.jsx("div",{className:"relative w-full h-full bg-white rounded-[2rem] sm:rounded-[2.5rem] md:rounded-[3rem] overflow-hidden",children:c.jsxs("div",{className:`absolute inset-0 bg-gradient-to-br ${f(o[e].phoneScreen)} 
                    transition-all duration-1000 ease-in-out`,children:[c.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-5 md:px-6 pt-2 sm:pt-3 text-white text-[10px] sm:text-xs",children:[c.jsx("span",{children:"9:41"}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("div",{className:"w-3 h-2 sm:w-4 sm:h-3 border border-white rounded-sm"}),c.jsx("div",{className:"w-0.5 h-2 sm:w-1 sm:h-3 bg-white rounded-sm"})]})]}),c.jsxs("div",{className:"px-4 sm:px-5 md:px-6 pt-6 sm:pt-7 md:pt-8",children:[c.jsxs("h3",{className:"text-white text-lg sm:text-xl md:text-2xl font-bold",children:[o[e].phoneScreen==="dashboard"&&"Dashboard",o[e].phoneScreen==="nutrition"&&"Nutrition",o[e].phoneScreen==="ai-chat"&&"AI Assistant",o[e].phoneScreen==="sleep"&&"Sleep"]}),c.jsx("p",{className:"text-white/80 text-[10px] sm:text-xs md:text-sm mt-1",children:new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]}),c.jsx("div",{className:`absolute inset-x-4 sm:inset-x-5 md:inset-x-6 top-24 sm:top-28 md:top-32 bottom-4 sm:bottom-5 md:bottom-6 bg-white/10 backdrop-blur-md rounded-2xl sm:rounded-3xl border border-white/20 p-4 sm:p-5 md:p-6 \r
                      transition-all duration-1000 shadow-inner`,children:c.jsx("div",{className:"space-y-3 sm:space-y-4",children:[1,2,3].map(v=>c.jsx("div",{className:"bg-white/20 rounded-xl sm:rounded-2xl h-14 sm:h-16 md:h-20 animate-pulse shadow-lg",style:{animationDelay:`${v*200}ms`,animationDuration:"2s"}},v))})})]})})]}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-slate-900/10 to-slate-900/30 rounded-[2.5rem] sm:rounded-[3rem] md:rounded-[3.5rem] -z-10 blur-2xl sm:blur-3xl transform scale-105"})]})]})})})})};function BQ(e){var n,s,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var d=e.length;for(n=0;n<d;n++)e[n]&&(s=BQ(e[n]))&&(o&&(o+=" "),o+=s)}else for(s in e)e[s]&&(o&&(o+=" "),o+=s);return o}function In(){for(var e,n,s=0,o="",d=arguments.length;s<d;s++)(e=arguments[s])&&(n=BQ(e))&&(o&&(o+=" "),o+=n);return o}const eCe=(e,n)=>{const s=new Array(e.length+n.length);for(let o=0;o<e.length;o++)s[o]=e[o];for(let o=0;o<n.length;o++)s[e.length+o]=n[o];return s},tCe=(e,n)=>({classGroupId:e,validator:n}),GQ=(e=new Map,n=null,s)=>({nextPart:e,validators:n,classGroupId:s}),Xw="-",hH=[],nCe="arbitrary..",rCe=e=>{const n=sCe(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:o}=e;return{getClassGroupId:f=>{if(f.startsWith("[")&&f.endsWith("]"))return iCe(f);const v=f.split(Xw),b=v[0]===""&&v.length>1?1:0;return WQ(v,b,n)},getConflictingClassGroupIds:(f,v)=>{if(v){const b=o[f],_=s[f];return b?_?eCe(_,b):b:_||hH}return s[f]||hH}}},WQ=(e,n,s)=>{if(e.length-n===0)return s.classGroupId;const d=e[n],h=s.nextPart.get(d);if(h){const _=WQ(e,n+1,h);if(_)return _}const f=s.validators;if(f===null)return;const v=n===0?e.join(Xw):e.slice(n).join(Xw),b=f.length;for(let _=0;_<b;_++){const w=f[_];if(w.validator(v))return w.classGroupId}},iCe=e=>e.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const n=e.slice(1,-1),s=n.indexOf(":"),o=n.slice(0,s);return o?nCe+o:void 0})(),sCe=e=>{const{theme:n,classGroups:s}=e;return aCe(s,n)},aCe=(e,n)=>{const s=GQ();for(const o in e){const d=e[o];Xj(d,s,o,n)}return s},Xj=(e,n,s,o)=>{const d=e.length;for(let h=0;h<d;h++){const f=e[h];oCe(f,n,s,o)}},oCe=(e,n,s,o)=>{if(typeof e=="string"){cCe(e,n,s);return}if(typeof e=="function"){lCe(e,n,s,o);return}dCe(e,n,s,o)},cCe=(e,n,s)=>{const o=e===""?n:$Q(n,e);o.classGroupId=s},lCe=(e,n,s,o)=>{if(uCe(e)){Xj(e(o),n,s,o);return}n.validators===null&&(n.validators=[]),n.validators.push(tCe(s,e))},dCe=(e,n,s,o)=>{const d=Object.entries(e),h=d.length;for(let f=0;f<h;f++){const[v,b]=d[f];Xj(b,$Q(n,v),s,o)}},$Q=(e,n)=>{let s=e;const o=n.split(Xw),d=o.length;for(let h=0;h<d;h++){const f=o[h];let v=s.nextPart.get(f);v||(v=GQ(),s.nextPart.set(f,v)),s=v}return s},uCe=e=>"isThemeGetter"in e&&e.isThemeGetter===!0,hCe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let n=0,s=Object.create(null),o=Object.create(null);const d=(h,f)=>{s[h]=f,n++,n>e&&(n=0,o=s,s=Object.create(null))};return{get(h){let f=s[h];if(f!==void 0)return f;if((f=o[h])!==void 0)return d(h,f),f},set(h,f){h in s?s[h]=f:d(h,f)}}},sP="!",pH=":",pCe=[],mH=(e,n,s,o,d)=>({modifiers:e,hasImportantModifier:n,baseClassName:s,maybePostfixModifierPosition:o,isExternal:d}),mCe=e=>{const{prefix:n,experimentalParseClassName:s}=e;let o=d=>{const h=[];let f=0,v=0,b=0,_;const w=d.length;for(let O=0;O<w;O++){const P=d[O];if(f===0&&v===0){if(P===pH){h.push(d.slice(b,O)),b=O+1;continue}if(P==="/"){_=O;continue}}P==="["?f++:P==="]"?f--:P==="("?v++:P===")"&&v--}const E=h.length===0?d:d.slice(b);let N=E,I=!1;E.endsWith(sP)?(N=E.slice(0,-1),I=!0):E.startsWith(sP)&&(N=E.slice(1),I=!0);const R=_&&_>b?_-b:void 0;return mH(h,I,N,R)};if(n){const d=n+pH,h=o;o=f=>f.startsWith(d)?h(f.slice(d.length)):mH(pCe,!1,f,void 0,!0)}if(s){const d=o;o=h=>s({className:h,parseClassName:d})}return o},fCe=e=>{const n=new Map;return e.orderSensitiveModifiers.forEach((s,o)=>{n.set(s,1e6+o)}),s=>{const o=[];let d=[];for(let h=0;h<s.length;h++){const f=s[h],v=f[0]==="[",b=n.has(f);v||b?(d.length>0&&(d.sort(),o.push(...d),d=[]),o.push(f)):d.push(f)}return d.length>0&&(d.sort(),o.push(...d)),o}},gCe=e=>({cache:hCe(e.cacheSize),parseClassName:mCe(e),sortModifiers:fCe(e),...rCe(e)}),vCe=/\s+/,yCe=(e,n)=>{const{parseClassName:s,getClassGroupId:o,getConflictingClassGroupIds:d,sortModifiers:h}=n,f=[],v=e.trim().split(vCe);let b="";for(let _=v.length-1;_>=0;_-=1){const w=v[_],{isExternal:E,modifiers:N,hasImportantModifier:I,baseClassName:R,maybePostfixModifierPosition:O}=s(w);if(E){b=w+(b.length>0?" "+b:b);continue}let P=!!O,M=o(P?R.substring(0,O):R);if(!M){if(!P){b=w+(b.length>0?" "+b:b);continue}if(M=o(R),!M){b=w+(b.length>0?" "+b:b);continue}P=!1}const D=N.length===0?"":N.length===1?N[0]:h(N).join(":"),U=I?D+sP:D,B=U+M;if(f.indexOf(B)>-1)continue;f.push(B);const G=d(M,P);for(let $=0;$<G.length;++$){const q=G[$];f.push(U+q)}b=w+(b.length>0?" "+b:b)}return b},bCe=(...e)=>{let n=0,s,o,d="";for(;n<e.length;)(s=e[n++])&&(o=zQ(s))&&(d&&(d+=" "),d+=o);return d},zQ=e=>{if(typeof e=="string")return e;let n,s="";for(let o=0;o<e.length;o++)e[o]&&(n=zQ(e[o]))&&(s&&(s+=" "),s+=n);return s},xCe=(e,...n)=>{let s,o,d,h;const f=b=>{const _=n.reduce((w,E)=>E(w),e());return s=gCe(_),o=s.cache.get,d=s.cache.set,h=v,v(b)},v=b=>{const _=o(b);if(_)return _;const w=yCe(b,s);return d(b,w),w};return h=f,(...b)=>h(bCe(...b))},_Ce=[],_i=e=>{const n=s=>s[e]||_Ce;return n.isThemeGetter=!0,n},HQ=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,KQ=/^\((?:(\w[\w-]*):)?(.+)\)$/i,ECe=/^\d+\/\d+$/,wCe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,SCe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,TCe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,NCe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,CCe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Fm=e=>ECe.test(e),_n=e=>!!e&&!Number.isNaN(Number(e)),Ld=e=>!!e&&Number.isInteger(Number(e)),pO=e=>e.endsWith("%")&&_n(e.slice(0,-1)),wl=e=>wCe.test(e),RCe=()=>!0,ACe=e=>SCe.test(e)&&!TCe.test(e),YQ=()=>!1,ICe=e=>NCe.test(e),OCe=e=>CCe.test(e),PCe=e=>!Pt(e)&&!kt(e),kCe=e=>mg(e,JQ,YQ),Pt=e=>HQ.test(e),_h=e=>mg(e,QQ,ACe),mO=e=>mg(e,UCe,_n),fH=e=>mg(e,qQ,YQ),jCe=e=>mg(e,XQ,OCe),UE=e=>mg(e,ZQ,ICe),kt=e=>KQ.test(e),gv=e=>fg(e,QQ),DCe=e=>fg(e,FCe),gH=e=>fg(e,qQ),LCe=e=>fg(e,JQ),MCe=e=>fg(e,XQ),FE=e=>fg(e,ZQ,!0),mg=(e,n,s)=>{const o=HQ.exec(e);return o?o[1]?n(o[1]):s(o[2]):!1},fg=(e,n,s=!1)=>{const o=KQ.exec(e);return o?o[1]?n(o[1]):s:!1},qQ=e=>e==="position"||e==="percentage",XQ=e=>e==="image"||e==="url",JQ=e=>e==="length"||e==="size"||e==="bg-size",QQ=e=>e==="length",UCe=e=>e==="number",FCe=e=>e==="family-name",ZQ=e=>e==="shadow",VCe=()=>{const e=_i("color"),n=_i("font"),s=_i("text"),o=_i("font-weight"),d=_i("tracking"),h=_i("leading"),f=_i("breakpoint"),v=_i("container"),b=_i("spacing"),_=_i("radius"),w=_i("shadow"),E=_i("inset-shadow"),N=_i("text-shadow"),I=_i("drop-shadow"),R=_i("blur"),O=_i("perspective"),P=_i("aspect"),M=_i("ease"),D=_i("animate"),U=()=>["auto","avoid","all","avoid-page","page","left","right","column"],B=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],G=()=>[...B(),kt,Pt],$=()=>["auto","hidden","clip","visible","scroll"],q=()=>["auto","contain","none"],X=()=>[kt,Pt,b],ee=()=>[Fm,"full","auto",...X()],ce=()=>[Ld,"none","subgrid",kt,Pt],Q=()=>["auto",{span:["full",Ld,kt,Pt]},Ld,kt,Pt],ae=()=>[Ld,"auto",kt,Pt],ve=()=>["auto","min","max","fr",kt,Pt],le=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],fe=()=>["start","end","center","stretch","center-safe","end-safe"],re=()=>["auto",...X()],he=()=>[Fm,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...X()],J=()=>[e,kt,Pt],ue=()=>[...B(),gH,fH,{position:[kt,Pt]}],Ee=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Fe=()=>["auto","cover","contain",LCe,kCe,{size:[kt,Pt]}],ke=()=>[pO,gv,_h],Ge=()=>["","none","full",_,kt,Pt],De=()=>["",_n,gv,_h],Pe=()=>["solid","dashed","dotted","double"],Ve=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],it=()=>[_n,pO,gH,fH],Mt=()=>["","none",R,kt,Pt],tt=()=>["none",_n,kt,Pt],ft=()=>["none",_n,kt,Pt],Rt=()=>[_n,kt,Pt],Te=()=>[Fm,"full",...X()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[wl],breakpoint:[wl],color:[RCe],container:[wl],"drop-shadow":[wl],ease:["in","out","in-out"],font:[PCe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[wl],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[wl],shadow:[wl],spacing:["px",_n],text:[wl],"text-shadow":[wl],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Fm,Pt,kt,P]}],container:["container"],columns:[{columns:[_n,Pt,kt,v]}],"break-after":[{"break-after":U()}],"break-before":[{"break-before":U()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:G()}],overflow:[{overflow:$()}],"overflow-x":[{"overflow-x":$()}],"overflow-y":[{"overflow-y":$()}],overscroll:[{overscroll:q()}],"overscroll-x":[{"overscroll-x":q()}],"overscroll-y":[{"overscroll-y":q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:ee()}],"inset-x":[{"inset-x":ee()}],"inset-y":[{"inset-y":ee()}],start:[{start:ee()}],end:[{end:ee()}],top:[{top:ee()}],right:[{right:ee()}],bottom:[{bottom:ee()}],left:[{left:ee()}],visibility:["visible","invisible","collapse"],z:[{z:[Ld,"auto",kt,Pt]}],basis:[{basis:[Fm,"full","auto",v,...X()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[_n,Fm,"auto","initial","none",Pt]}],grow:[{grow:["",_n,kt,Pt]}],shrink:[{shrink:["",_n,kt,Pt]}],order:[{order:[Ld,"first","last","none",kt,Pt]}],"grid-cols":[{"grid-cols":ce()}],"col-start-end":[{col:Q()}],"col-start":[{"col-start":ae()}],"col-end":[{"col-end":ae()}],"grid-rows":[{"grid-rows":ce()}],"row-start-end":[{row:Q()}],"row-start":[{"row-start":ae()}],"row-end":[{"row-end":ae()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":ve()}],"auto-rows":[{"auto-rows":ve()}],gap:[{gap:X()}],"gap-x":[{"gap-x":X()}],"gap-y":[{"gap-y":X()}],"justify-content":[{justify:[...le(),"normal"]}],"justify-items":[{"justify-items":[...fe(),"normal"]}],"justify-self":[{"justify-self":["auto",...fe()]}],"align-content":[{content:["normal",...le()]}],"align-items":[{items:[...fe(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...fe(),{baseline:["","last"]}]}],"place-content":[{"place-content":le()}],"place-items":[{"place-items":[...fe(),"baseline"]}],"place-self":[{"place-self":["auto",...fe()]}],p:[{p:X()}],px:[{px:X()}],py:[{py:X()}],ps:[{ps:X()}],pe:[{pe:X()}],pt:[{pt:X()}],pr:[{pr:X()}],pb:[{pb:X()}],pl:[{pl:X()}],m:[{m:re()}],mx:[{mx:re()}],my:[{my:re()}],ms:[{ms:re()}],me:[{me:re()}],mt:[{mt:re()}],mr:[{mr:re()}],mb:[{mb:re()}],ml:[{ml:re()}],"space-x":[{"space-x":X()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":X()}],"space-y-reverse":["space-y-reverse"],size:[{size:he()}],w:[{w:[v,"screen",...he()]}],"min-w":[{"min-w":[v,"screen","none",...he()]}],"max-w":[{"max-w":[v,"screen","none","prose",{screen:[f]},...he()]}],h:[{h:["screen","lh",...he()]}],"min-h":[{"min-h":["screen","lh","none",...he()]}],"max-h":[{"max-h":["screen","lh",...he()]}],"font-size":[{text:["base",s,gv,_h]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[o,kt,mO]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",pO,Pt]}],"font-family":[{font:[DCe,Pt,n]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[d,kt,Pt]}],"line-clamp":[{"line-clamp":[_n,"none",kt,mO]}],leading:[{leading:[h,...X()]}],"list-image":[{"list-image":["none",kt,Pt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",kt,Pt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:J()}],"text-color":[{text:J()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Pe(),"wavy"]}],"text-decoration-thickness":[{decoration:[_n,"from-font","auto",kt,_h]}],"text-decoration-color":[{decoration:J()}],"underline-offset":[{"underline-offset":[_n,"auto",kt,Pt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:X()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",kt,Pt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",kt,Pt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ue()}],"bg-repeat":[{bg:Ee()}],"bg-size":[{bg:Fe()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ld,kt,Pt],radial:["",kt,Pt],conic:[Ld,kt,Pt]},MCe,jCe]}],"bg-color":[{bg:J()}],"gradient-from-pos":[{from:ke()}],"gradient-via-pos":[{via:ke()}],"gradient-to-pos":[{to:ke()}],"gradient-from":[{from:J()}],"gradient-via":[{via:J()}],"gradient-to":[{to:J()}],rounded:[{rounded:Ge()}],"rounded-s":[{"rounded-s":Ge()}],"rounded-e":[{"rounded-e":Ge()}],"rounded-t":[{"rounded-t":Ge()}],"rounded-r":[{"rounded-r":Ge()}],"rounded-b":[{"rounded-b":Ge()}],"rounded-l":[{"rounded-l":Ge()}],"rounded-ss":[{"rounded-ss":Ge()}],"rounded-se":[{"rounded-se":Ge()}],"rounded-ee":[{"rounded-ee":Ge()}],"rounded-es":[{"rounded-es":Ge()}],"rounded-tl":[{"rounded-tl":Ge()}],"rounded-tr":[{"rounded-tr":Ge()}],"rounded-br":[{"rounded-br":Ge()}],"rounded-bl":[{"rounded-bl":Ge()}],"border-w":[{border:De()}],"border-w-x":[{"border-x":De()}],"border-w-y":[{"border-y":De()}],"border-w-s":[{"border-s":De()}],"border-w-e":[{"border-e":De()}],"border-w-t":[{"border-t":De()}],"border-w-r":[{"border-r":De()}],"border-w-b":[{"border-b":De()}],"border-w-l":[{"border-l":De()}],"divide-x":[{"divide-x":De()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":De()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Pe(),"hidden","none"]}],"divide-style":[{divide:[...Pe(),"hidden","none"]}],"border-color":[{border:J()}],"border-color-x":[{"border-x":J()}],"border-color-y":[{"border-y":J()}],"border-color-s":[{"border-s":J()}],"border-color-e":[{"border-e":J()}],"border-color-t":[{"border-t":J()}],"border-color-r":[{"border-r":J()}],"border-color-b":[{"border-b":J()}],"border-color-l":[{"border-l":J()}],"divide-color":[{divide:J()}],"outline-style":[{outline:[...Pe(),"none","hidden"]}],"outline-offset":[{"outline-offset":[_n,kt,Pt]}],"outline-w":[{outline:["",_n,gv,_h]}],"outline-color":[{outline:J()}],shadow:[{shadow:["","none",w,FE,UE]}],"shadow-color":[{shadow:J()}],"inset-shadow":[{"inset-shadow":["none",E,FE,UE]}],"inset-shadow-color":[{"inset-shadow":J()}],"ring-w":[{ring:De()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:J()}],"ring-offset-w":[{"ring-offset":[_n,_h]}],"ring-offset-color":[{"ring-offset":J()}],"inset-ring-w":[{"inset-ring":De()}],"inset-ring-color":[{"inset-ring":J()}],"text-shadow":[{"text-shadow":["none",N,FE,UE]}],"text-shadow-color":[{"text-shadow":J()}],opacity:[{opacity:[_n,kt,Pt]}],"mix-blend":[{"mix-blend":[...Ve(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ve()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[_n]}],"mask-image-linear-from-pos":[{"mask-linear-from":it()}],"mask-image-linear-to-pos":[{"mask-linear-to":it()}],"mask-image-linear-from-color":[{"mask-linear-from":J()}],"mask-image-linear-to-color":[{"mask-linear-to":J()}],"mask-image-t-from-pos":[{"mask-t-from":it()}],"mask-image-t-to-pos":[{"mask-t-to":it()}],"mask-image-t-from-color":[{"mask-t-from":J()}],"mask-image-t-to-color":[{"mask-t-to":J()}],"mask-image-r-from-pos":[{"mask-r-from":it()}],"mask-image-r-to-pos":[{"mask-r-to":it()}],"mask-image-r-from-color":[{"mask-r-from":J()}],"mask-image-r-to-color":[{"mask-r-to":J()}],"mask-image-b-from-pos":[{"mask-b-from":it()}],"mask-image-b-to-pos":[{"mask-b-to":it()}],"mask-image-b-from-color":[{"mask-b-from":J()}],"mask-image-b-to-color":[{"mask-b-to":J()}],"mask-image-l-from-pos":[{"mask-l-from":it()}],"mask-image-l-to-pos":[{"mask-l-to":it()}],"mask-image-l-from-color":[{"mask-l-from":J()}],"mask-image-l-to-color":[{"mask-l-to":J()}],"mask-image-x-from-pos":[{"mask-x-from":it()}],"mask-image-x-to-pos":[{"mask-x-to":it()}],"mask-image-x-from-color":[{"mask-x-from":J()}],"mask-image-x-to-color":[{"mask-x-to":J()}],"mask-image-y-from-pos":[{"mask-y-from":it()}],"mask-image-y-to-pos":[{"mask-y-to":it()}],"mask-image-y-from-color":[{"mask-y-from":J()}],"mask-image-y-to-color":[{"mask-y-to":J()}],"mask-image-radial":[{"mask-radial":[kt,Pt]}],"mask-image-radial-from-pos":[{"mask-radial-from":it()}],"mask-image-radial-to-pos":[{"mask-radial-to":it()}],"mask-image-radial-from-color":[{"mask-radial-from":J()}],"mask-image-radial-to-color":[{"mask-radial-to":J()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":B()}],"mask-image-conic-pos":[{"mask-conic":[_n]}],"mask-image-conic-from-pos":[{"mask-conic-from":it()}],"mask-image-conic-to-pos":[{"mask-conic-to":it()}],"mask-image-conic-from-color":[{"mask-conic-from":J()}],"mask-image-conic-to-color":[{"mask-conic-to":J()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ue()}],"mask-repeat":[{mask:Ee()}],"mask-size":[{mask:Fe()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",kt,Pt]}],filter:[{filter:["","none",kt,Pt]}],blur:[{blur:Mt()}],brightness:[{brightness:[_n,kt,Pt]}],contrast:[{contrast:[_n,kt,Pt]}],"drop-shadow":[{"drop-shadow":["","none",I,FE,UE]}],"drop-shadow-color":[{"drop-shadow":J()}],grayscale:[{grayscale:["",_n,kt,Pt]}],"hue-rotate":[{"hue-rotate":[_n,kt,Pt]}],invert:[{invert:["",_n,kt,Pt]}],saturate:[{saturate:[_n,kt,Pt]}],sepia:[{sepia:["",_n,kt,Pt]}],"backdrop-filter":[{"backdrop-filter":["","none",kt,Pt]}],"backdrop-blur":[{"backdrop-blur":Mt()}],"backdrop-brightness":[{"backdrop-brightness":[_n,kt,Pt]}],"backdrop-contrast":[{"backdrop-contrast":[_n,kt,Pt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",_n,kt,Pt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[_n,kt,Pt]}],"backdrop-invert":[{"backdrop-invert":["",_n,kt,Pt]}],"backdrop-opacity":[{"backdrop-opacity":[_n,kt,Pt]}],"backdrop-saturate":[{"backdrop-saturate":[_n,kt,Pt]}],"backdrop-sepia":[{"backdrop-sepia":["",_n,kt,Pt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":X()}],"border-spacing-x":[{"border-spacing-x":X()}],"border-spacing-y":[{"border-spacing-y":X()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",kt,Pt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[_n,"initial",kt,Pt]}],ease:[{ease:["linear","initial",M,kt,Pt]}],delay:[{delay:[_n,kt,Pt]}],animate:[{animate:["none",D,kt,Pt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[O,kt,Pt]}],"perspective-origin":[{"perspective-origin":G()}],rotate:[{rotate:tt()}],"rotate-x":[{"rotate-x":tt()}],"rotate-y":[{"rotate-y":tt()}],"rotate-z":[{"rotate-z":tt()}],scale:[{scale:ft()}],"scale-x":[{"scale-x":ft()}],"scale-y":[{"scale-y":ft()}],"scale-z":[{"scale-z":ft()}],"scale-3d":["scale-3d"],skew:[{skew:Rt()}],"skew-x":[{"skew-x":Rt()}],"skew-y":[{"skew-y":Rt()}],transform:[{transform:[kt,Pt,"","none","gpu","cpu"]}],"transform-origin":[{origin:G()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Te()}],"translate-x":[{"translate-x":Te()}],"translate-y":[{"translate-y":Te()}],"translate-z":[{"translate-z":Te()}],"translate-none":["translate-none"],accent:[{accent:J()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:J()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",kt,Pt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":X()}],"scroll-mx":[{"scroll-mx":X()}],"scroll-my":[{"scroll-my":X()}],"scroll-ms":[{"scroll-ms":X()}],"scroll-me":[{"scroll-me":X()}],"scroll-mt":[{"scroll-mt":X()}],"scroll-mr":[{"scroll-mr":X()}],"scroll-mb":[{"scroll-mb":X()}],"scroll-ml":[{"scroll-ml":X()}],"scroll-p":[{"scroll-p":X()}],"scroll-px":[{"scroll-px":X()}],"scroll-py":[{"scroll-py":X()}],"scroll-ps":[{"scroll-ps":X()}],"scroll-pe":[{"scroll-pe":X()}],"scroll-pt":[{"scroll-pt":X()}],"scroll-pr":[{"scroll-pr":X()}],"scroll-pb":[{"scroll-pb":X()}],"scroll-pl":[{"scroll-pl":X()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",kt,Pt]}],fill:[{fill:["none",...J()]}],"stroke-w":[{stroke:[_n,gv,_h,mO]}],stroke:[{stroke:["none",...J()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},BCe=xCe(VCe);function La(...e){return BCe(In(e))}const GCe=Math.sqrt(5e3),WCe=[{tempId:0,testimonial:"My favorite solution in the market. We work 5x faster with COMPANY.",by:"Alex, CEO at TechCorp",imgSrc:"https://i.pravatar.cc/150?img=1"},{tempId:1,testimonial:"I'm confident my data is safe with COMPANY. I can't say that about other providers.",by:"Dan, CTO at SecureNet",imgSrc:"https://i.pravatar.cc/150?img=2"},{tempId:2,testimonial:"I know it's cliche, but we were lost before we found COMPANY. Can't thank you guys enough!",by:"Stephanie, COO at InnovateCo",imgSrc:"https://i.pravatar.cc/150?img=3"},{tempId:3,testimonial:"COMPANY's products make planning for the future seamless. Can't recommend them enough!",by:"Marie, CFO at FuturePlanning",imgSrc:"https://i.pravatar.cc/150?img=4"},{tempId:4,testimonial:"If I could give 11 stars, I'd give 12.",by:"Andre, Head of Design at CreativeSolutions",imgSrc:"https://i.pravatar.cc/150?img=5"},{tempId:5,testimonial:"SO SO SO HAPPY WE FOUND YOU GUYS!!!! I'd bet you've saved me 100 hours so far.",by:"Jeremy, Product Manager at TimeWise",imgSrc:"https://i.pravatar.cc/150?img=6"},{tempId:6,testimonial:"Took some convincing, but now that we're on COMPANY, we're never going back.",by:"Pam, Marketing Director at BrandBuilders",imgSrc:"https://i.pravatar.cc/150?img=7"},{tempId:7,testimonial:"I would be lost without COMPANY's in-depth analytics. The ROI is EASILY 100X for us.",by:"Daniel, Data Scientist at AnalyticsPro",imgSrc:"https://i.pravatar.cc/150?img=8"},{tempId:8,testimonial:"It's just the best. Period.",by:"Fernando, UX Designer at UserFirst",imgSrc:"https://i.pravatar.cc/150?img=9"},{tempId:9,testimonial:"I switched 5 years ago and never looked back.",by:"Andy, DevOps Engineer at CloudMasters",imgSrc:"https://i.pravatar.cc/150?img=10"},{tempId:10,testimonial:"I've been searching for a solution like COMPANY for YEARS. So glad I finally found one!",by:"Pete, Sales Director at RevenueRockets",imgSrc:"https://i.pravatar.cc/150?img=11"},{tempId:11,testimonial:"It's so simple and intuitive, we got the team up to speed in 10 minutes.",by:"Marina, HR Manager at TalentForge",imgSrc:"https://i.pravatar.cc/150?img=12"},{tempId:12,testimonial:"COMPANY's customer support is unparalleled. They're always there when we need them.",by:"Olivia, Customer Success Manager at ClientCare",imgSrc:"https://i.pravatar.cc/150?img=13"},{tempId:13,testimonial:"The efficiency gains we've seen since implementing COMPANY are off the charts!",by:"Raj, Operations Manager at StreamlineSolutions",imgSrc:"https://i.pravatar.cc/150?img=14"},{tempId:14,testimonial:"COMPANY has revolutionized how we handle our workflow. It's a game-changer!",by:"Lila, Workflow Specialist at ProcessPro",imgSrc:"https://i.pravatar.cc/150?img=15"},{tempId:15,testimonial:"The scalability of COMPANY's solution is impressive. It grows with our business seamlessly.",by:"Trevor, Scaling Officer at GrowthGurus",imgSrc:"https://i.pravatar.cc/150?img=16"},{tempId:16,testimonial:"I appreciate how COMPANY continually innovates. They're always one step ahead.",by:"Naomi, Innovation Lead at FutureTech",imgSrc:"https://i.pravatar.cc/150?img=17"},{tempId:17,testimonial:"The ROI we've seen with COMPANY is incredible. It's paid for itself many times over.",by:"Victor, Finance Analyst at ProfitPeak",imgSrc:"https://i.pravatar.cc/150?img=18"},{tempId:18,testimonial:"COMPANY's platform is so robust, yet easy to use. It's the perfect balance.",by:"Yuki, Tech Lead at BalancedTech",imgSrc:"https://i.pravatar.cc/150?img=19"},{tempId:19,testimonial:"We've tried many solutions, but COMPANY stands out in terms of reliability and performance.",by:"Zoe, Performance Manager at ReliableSystems",imgSrc:"https://i.pravatar.cc/150?img=20"}],$Ce=({position:e,testimonial:n,handleMove:s,cardSize:o})=>{const d=e===0;return c.jsxs("div",{onClick:()=>s(e),className:La("absolute left-1/2 top-1/2 cursor-pointer border-2 p-8 transition-all duration-500 ease-in-out",d?"z-10 bg-gradient-to-br from-[#0a3d5c] to-[#0d5a8a] text-white border-cyan-400/60":"z-0 bg-gradient-to-br from-[#0a3d5c]/40 to-[#0d5a8a]/40 text-cyan-100 border-cyan-400/20 hover:border-cyan-400/40"),style:{width:o,height:o,clipPath:"polygon(50px 0%, calc(100% - 50px) 0%, 100% 50px, 100% 100%, calc(100% - 50px) 100%, 50px 100%, 0 100%, 0 0)",transform:`
          translate(-50%, -50%) 
          translateX(${o/1.5*e}px)
          translateY(${d?-65:e%2?15:-15}px)
          rotate(${d?0:e%2?2.5:-2.5}deg)
        `,boxShadow:d?"0px 8px 0px 4px hsl(var(--border))":"0px 0px 0px 0px transparent"},children:[c.jsx("span",{className:"absolute block origin-top-right rotate-45 bg-border",style:{right:-2,top:48,width:GCe,height:2}}),c.jsx("img",{src:n.imgSrc,alt:`${n.by.split(",")[0]}`,className:"mb-4 h-14 w-12 bg-muted object-cover object-top",style:{boxShadow:"3px 3px 0px hsl(var(--background))"}}),c.jsxs("h3",{className:La("text-base sm:text-xl font-medium",d?"text-white":"text-cyan-100"),children:['"',n.testimonial,'"']}),c.jsxs("p",{className:La("absolute bottom-8 left-8 right-8 mt-2 text-sm italic",d?"text-white/80":"text-cyan-100/60"),children:["- ",n.by]})]})},zCe=()=>{const[e,n]=z.useState(365),[s,o]=z.useState(WCe),d=h=>{const f=[...s];if(h>0)for(let v=h;v>0;v--){const b=f.shift();if(!b)return;f.push({...b,tempId:Math.random()})}else for(let v=h;v<0;v++){const b=f.pop();if(!b)return;f.unshift({...b,tempId:Math.random()})}o(f)};return z.useEffect(()=>{const h=()=>{const{matches:f}=window.matchMedia("(min-width: 640px)");n(f?365:290)};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]),c.jsxs("div",{className:"relative w-full overflow-hidden bg-muted/30",style:{height:600},children:[s.map((h,f)=>{const v=s.length%2?f-(s.length+1)/2:f-s.length/2;return c.jsx($Ce,{testimonial:h,handleMove:d,position:v,cardSize:e},h.tempId)}),c.jsxs("div",{className:"absolute bottom-4 left-1/2 flex -translate-x-1/2 gap-2",children:[c.jsx("button",{onClick:()=>d(-1),className:La("flex h-14 w-14 items-center justify-center text-2xl transition-colors","bg-background border-2 border-border hover:bg-primary hover:text-primary-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"),"aria-label":"Previous testimonial",children:c.jsx(IQ,{})}),c.jsx("button",{onClick:()=>d(1),className:La("flex h-14 w-14 items-center justify-center text-2xl transition-colors","bg-background border-2 border-border hover:bg-primary hover:text-primary-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"),"aria-label":"Next testimonial",children:c.jsx(Il,{})})]})]})};function HCe(){const e=z.useRef(null);return z.useEffect(()=>{const n=async()=>{const o=(d,h)=>new Promise((f,v)=>{if(window[h]){f();return}if(document.querySelector(`script[src="${d}"]`)){const _=setInterval(()=>{window[h]&&(clearInterval(_),f())},50);setTimeout(()=>{clearInterval(_),v(new Error(`Timeout waiting for ${h}`))},1e4);return}const b=document.createElement("script");b.src=d,b.onload=()=>{setTimeout(()=>f(),100)},b.onerror=()=>v(new Error(`Failed to load ${d}`)),document.head.appendChild(b)});try{await o("https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js","gsap"),await o("https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js","THREE")}catch(d){console.error("Failed to load base scripts:",d)}s()},s=async()=>{const o={settings:{transitionDuration:2.5,autoSlideSpeed:5e3,currentEffect:"glass",currentEffectPreset:"Default",globalIntensity:1,speedMultiplier:1,distortionStrength:1,colorEnhancement:1,glassRefractionStrength:1,glassChromaticAberration:1,glassBubbleClarity:1,glassEdgeGlow:1,glassLiquidFlow:1,frostIntensity:1.5,frostCrystalSize:1,frostIceCoverage:1,frostTemperature:1,frostTexture:1,rippleFrequency:25,rippleAmplitude:.08,rippleWaveSpeed:1,rippleRippleCount:1,rippleDecay:1,plasmaIntensity:1.2,plasmaSpeed:.8,plasmaEnergyIntensity:.4,plasmaContrastBoost:.3,plasmaTurbulence:1,timeshiftDistortion:1.6,timeshiftBlur:1.5,timeshiftFlow:1.4,timeshiftChromatic:1.5,timeshiftTurbulence:1.4}};let d=0,h=!1,f,v,b,_,w=[],E=!1,N=null,I=null,R=!1;const O=()=>o.settings.autoSlideSpeed,P=50,M=()=>o.settings.transitionDuration,D=[{title:"AI Lab Report Analyzer",description:"",media:"https://cdn.shopify.com/s/files/1/0636/5226/6115/files/AILabReportAnalyser_2.png?v=1770707931"},{title:"Health Dashboard",description:"",media:"https://cdn.shopify.com/s/files/1/0636/5226/6115/files/WhatsApp_Image_2026-02-07_at_6.46.39_PM.jpg?v=1770707930"},{title:"Nutrition Insights",description:"",media:"https://cdn.shopify.com/s/files/1/0636/5226/6115/files/WhatsApp_Image_2026-02-07_at_6.43.52_PM.jpg?v=1770707929"},{title:"Doctor Consultation",description:"",media:"https://cdn.shopify.com/s/files/1/0636/5226/6115/files/WhatsApp_Image_2026-02-07_at_6.44.25_PM.jpg?v=1770707929"},{title:"Wellness Tracking",description:"",media:"https://cdn.shopify.com/s/files/1/0636/5226/6115/files/WhatsApp_Image_2026-02-07_at_6.48.17_PM.jpg?v=1770707929"},{title:"Health Reports",description:"",media:"https://cdn.shopify.com/s/files/1/0636/5226/6115/files/WhatsApp_Image_2026-02-07_at_6.43.52_PM.jpg?v=1770707929"}],U="varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); }",B=`
            uniform sampler2D uTexture1, uTexture2;
            uniform float uProgress;
            uniform vec2 uResolution, uTexture1Size, uTexture2Size;
            uniform int uEffectType;
            uniform float uGlobalIntensity, uSpeedMultiplier, uDistortionStrength, uColorEnhancement;
            uniform float uGlassRefractionStrength, uGlassChromaticAberration, uGlassBubbleClarity, uGlassEdgeGlow, uGlassLiquidFlow;
            uniform float uFrostIntensity, uFrostCrystalSize, uFrostIceCoverage, uFrostTemperature, uFrostTexture;
            uniform float uRippleFrequency, uRippleAmplitude, uRippleWaveSpeed, uRippleRippleCount, uRippleDecay;
            uniform float uPlasmaIntensity, uPlasmaSpeed, uPlasmaEnergyIntensity, uPlasmaContrastBoost, uPlasmaTurbulence;
            uniform float uTimeshiftDistortion, uTimeshiftBlur, uTimeshiftFlow, uTimeshiftChromatic, uTimeshiftTurbulence;
            varying vec2 vUv;

            vec2 getCoverUV(vec2 uv, vec2 textureSize) {
                vec2 s = uResolution / textureSize;
                float scale = max(s.x, s.y);
                vec2 scaledSize = textureSize * scale;
                vec2 offset = (uResolution - scaledSize) * 0.5;
                return (uv * uResolution - offset) / scaledSize;
            }
            float noise(vec2 p) { return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453); }
            
            vec4 glassEffect(vec2 uv, float progress) {
                float time = progress * 5.0 * uSpeedMultiplier;
                vec2 uv1 = getCoverUV(uv, uTexture1Size); vec2 uv2 = getCoverUV(uv, uTexture2Size);
                float maxR = length(uResolution) * 0.85; float br = progress * maxR;
                vec2 p = uv * uResolution; vec2 c = uResolution * 0.5;
                float d = length(p - c); float nd = d / max(br, 0.001);
                float param = smoothstep(br + 3.0, br - 3.0, d); // Inside circle
                vec4 img;
                if (param > 0.0) {
                     float ro = 0.08 * uGlassRefractionStrength * uDistortionStrength * uGlobalIntensity * pow(smoothstep(0.3 * uGlassBubbleClarity, 1.0, nd), 1.5);
                     vec2 dir = (d > 0.0) ? (p - c) / d : vec2(0.0);
                     vec2 distUV = uv2 - dir * ro;
                     distUV += vec2(sin(time + nd * 10.0), cos(time * 0.8 + nd * 8.0)) * 0.015 * uGlassLiquidFlow * uSpeedMultiplier * nd * param;
                     float ca = 0.02 * uGlassChromaticAberration * uGlobalIntensity * pow(smoothstep(0.3, 1.0, nd), 1.2);
                     img = vec4(texture2D(uTexture2, distUV + dir * ca * 1.2).r, texture2D(uTexture2, distUV + dir * ca * 0.2).g, texture2D(uTexture2, distUV - dir * ca * 0.8).b, 1.0);
                     if (uGlassEdgeGlow > 0.0) {
                        float rim = smoothstep(0.95, 1.0, nd) * (1.0 - smoothstep(1.0, 1.01, nd));
                        img.rgb += rim * 0.08 * uGlassEdgeGlow * uGlobalIntensity;
                     }
                } else { img = texture2D(uTexture2, uv2); }
                vec4 oldImg = texture2D(uTexture1, uv1);
                if (progress > 0.95) img = mix(img, texture2D(uTexture2, uv2), (progress - 0.95) / 0.05);
                return mix(oldImg, img, param);
            }
            // Simplified stubs for other effects (to save space, logic is in glassEffect mainly for demo)
            vec4 frostEffect(vec2 uv, float progress) { return mix(texture2D(uTexture1, getCoverUV(uv, uTexture1Size)), texture2D(uTexture2, getCoverUV(uv, uTexture2Size)), progress); }
            vec4 rippleEffect(vec2 uv, float progress) { return mix(texture2D(uTexture1, getCoverUV(uv, uTexture1Size)), texture2D(uTexture2, getCoverUV(uv, uTexture2Size)), progress); }
            vec4 plasmaEffect(vec2 uv, float progress) { return mix(texture2D(uTexture1, getCoverUV(uv, uTexture1Size)), texture2D(uTexture2, getCoverUV(uv, uTexture2Size)), progress); }
            vec4 timeshiftEffect(vec2 uv, float progress) { return mix(texture2D(uTexture1, getCoverUV(uv, uTexture1Size)), texture2D(uTexture2, getCoverUV(uv, uTexture2Size)), progress); }

            void main() {
                if (uEffectType == 0) gl_FragColor = glassEffect(vUv, uProgress);
                else if (uEffectType == 1) gl_FragColor = frostEffect(vUv, uProgress);
                else if (uEffectType == 2) gl_FragColor = rippleEffect(vUv, uProgress);
                else if (uEffectType == 3) gl_FragColor = plasmaEffect(vUv, uProgress);
                else gl_FragColor = timeshiftEffect(vUv, uProgress);
            }
        `,G=De=>({glass:0,frost:1,ripple:2,plasma:3,timeshift:4})[De]||0,$=()=>{if(!f)return;const De=o.settings,Pe=f.uniforms;for(const Ve in De){const it="u"+Ve.charAt(0).toUpperCase()+Ve.slice(1);Pe[it]&&(Pe[it].value=De[Ve])}Pe.uEffectType.value=G(De.currentEffect)},q=De=>De.split("").map(Pe=>`<span style="display: inline-block; opacity: 0;">${Pe===" "?"&nbsp;":Pe}</span>`).join(""),X=De=>{const Pe=document.getElementById("mainTitle"),Ve=document.getElementById("mainDesc");Pe&&Ve&&(gsap.to(Pe.children,{y:-20,opacity:0,duration:.5,stagger:.02,ease:"power2.in"}),gsap.to(Ve,{y:-10,opacity:0,duration:.4,ease:"power2.in"}),setTimeout(()=>{Pe.innerHTML=q(D[De].title),Ve.textContent=D[De].description,gsap.set(Pe.children,{opacity:0}),gsap.set(Ve,{y:20,opacity:0});const it=Pe.children;switch(De){case 0:gsap.set(it,{y:20}),gsap.to(it,{y:0,opacity:1,duration:.8,stagger:.03,ease:"power3.out"}),gsap.to(Ve,{y:0,opacity:1,duration:.8,delay:.2,ease:"power3.out"});break;case 1:gsap.set(it,{y:-20}),gsap.to(it,{y:0,opacity:1,duration:.8,stagger:.03,ease:"back.out(1.7)"}),gsap.to(Ve,{y:0,opacity:1,duration:.8,delay:.2,ease:"power3.out"});break;case 2:gsap.set(it,{filter:"blur(10px)",scale:1.5,y:0}),gsap.to(it,{filter:"blur(0px)",scale:1,opacity:1,duration:1,stagger:{amount:.5,from:"random"},ease:"power2.out"}),gsap.to(Ve,{y:0,opacity:1,duration:1,delay:.3,ease:"power2.out"});break;case 3:gsap.set(it,{scale:0,y:0}),gsap.to(it,{scale:1,opacity:1,duration:.6,stagger:.05,ease:"back.out(1.5)"}),gsap.to(Ve,{y:0,opacity:1,duration:.8,delay:.2,ease:"power3.out"});break;case 4:gsap.set(it,{rotationX:90,y:0,transformOrigin:"50% 50%"}),gsap.to(it,{rotationX:0,opacity:1,duration:.8,stagger:.04,ease:"power2.out"}),gsap.to(Ve,{y:0,opacity:1,duration:.8,delay:.2,ease:"power2.out"});break;case 5:gsap.set(it,{x:30,y:0}),gsap.to(it,{x:0,opacity:1,duration:.8,stagger:.03,ease:"power3.out"}),gsap.to(Ve,{y:0,opacity:1,duration:.8,delay:.2,ease:"power3.out"});break;default:gsap.set(it,{y:20}),gsap.to(it,{y:0,opacity:1,duration:.8,stagger:.03,ease:"power3.out"}),gsap.to(Ve,{y:0,opacity:1,duration:.8,delay:.2,ease:"power3.out"})}},500))},ee=De=>{if(h||De===d)return;J(),fe(d);const Pe=w[d],Ve=w[De];!Pe||!Ve||(h=!0,f.uniforms.uTexture1.value=Pe,f.uniforms.uTexture2.value=Ve,f.uniforms.uTexture1Size.value=Pe.userData.size,f.uniforms.uTexture2Size.value=Ve.userData.size,X(De),d=De,re(d),ae(d),gsap.fromTo(f.uniforms.uProgress,{value:0},{value:1,duration:M(),ease:"power2.inOut",onComplete:()=>{f.uniforms.uProgress.value=0,f.uniforms.uTexture1.value=Ve,f.uniforms.uTexture1Size.value=Ve.userData.size,h=!1,ue(100)}}))},ce=()=>{h||!E||!R||ee((d+1)%D.length)},Q=()=>{const De=document.getElementById("slidesNav");De&&(De.innerHTML="",D.forEach((Pe,Ve)=>{const it=document.createElement("div");it.className=`slide-nav-item${Ve===0?" active":""}`,it.dataset.slideIndex=String(Ve),it.innerHTML=`<div class="slide-progress-line"><div class="slide-progress-fill"></div></div><div class="slide-nav-title">${Pe.title}</div>`,it.addEventListener("click",Mt=>{Mt.stopPropagation(),!h&&Ve!==d&&(J(),fe(d),ee(Ve))}),De.appendChild(it)}))},ae=De=>document.querySelectorAll(".slide-nav-item").forEach((Pe,Ve)=>Pe.classList.toggle("active",Ve===De)),ve=(De,Pe)=>{var it;const Ve=(it=document.querySelectorAll(".slide-nav-item")[De])==null?void 0:it.querySelector(".slide-progress-fill");Ve&&(Ve.style.width=`${Pe}%`,Ve.style.opacity="1")},le=De=>{var Ve;const Pe=(Ve=document.querySelectorAll(".slide-nav-item")[De])==null?void 0:Ve.querySelector(".slide-progress-fill");Pe&&(Pe.style.opacity="0",setTimeout(()=>Pe.style.width="0%",300))},fe=De=>{var Ve;const Pe=(Ve=document.querySelectorAll(".slide-nav-item")[De])==null?void 0:Ve.querySelector(".slide-progress-fill");Pe&&(Pe.style.transition="width 0.2s ease-out",Pe.style.width="0%",setTimeout(()=>Pe.style.transition="width 0.1s ease, opacity 0.3s ease",200))},re=De=>{const Pe=document.getElementById("slideNumber");Pe&&(Pe.textContent=String(De+1).padStart(2,"0"));const Ve=document.getElementById("slideTotal");Ve&&(Ve.textContent=String(D.length).padStart(2,"0"))},he=()=>{if(!E||!R)return;J();let De=0;const Pe=100/O()*P;I=setInterval(()=>{if(!R){J();return}De+=Pe,ve(d,De),De>=100&&(clearInterval(I),I=null,le(d),h||ce())},P)},J=()=>{I&&clearInterval(I),N&&clearTimeout(N),I=null,N=null},ue=(De=0)=>{J(),R&&E&&(De>0?N=setTimeout(he,De):he())},Ee=De=>new Promise((Pe,Ve)=>{new THREE.TextureLoader().load(De,Mt=>{Mt.minFilter=Mt.magFilter=THREE.LinearFilter,Mt.userData={size:new THREE.Vector2(Mt.image.width,Mt.image.height)},Pe(Mt)},void 0,Ve)}),Fe=async()=>{var Ve;const De=document.querySelector(".webgl-canvas");if(!De)return;b=new THREE.Scene,_=new THREE.OrthographicCamera(-1,1,1,-1,0,1),v=new THREE.WebGLRenderer({canvas:De,antialias:!1,alpha:!1}),v.setSize(window.innerWidth,window.innerHeight),v.setPixelRatio(Math.min(window.devicePixelRatio,2)),f=new THREE.ShaderMaterial({uniforms:{uTexture1:{value:null},uTexture2:{value:null},uProgress:{value:0},uResolution:{value:new THREE.Vector2(window.innerWidth,window.innerHeight)},uTexture1Size:{value:new THREE.Vector2(1,1)},uTexture2Size:{value:new THREE.Vector2(1,1)},uEffectType:{value:0},uGlobalIntensity:{value:1},uSpeedMultiplier:{value:1},uDistortionStrength:{value:1},uColorEnhancement:{value:1},uGlassRefractionStrength:{value:1},uGlassChromaticAberration:{value:1},uGlassBubbleClarity:{value:1},uGlassEdgeGlow:{value:1},uGlassLiquidFlow:{value:1},uFrostIntensity:{value:1},uFrostCrystalSize:{value:1},uFrostIceCoverage:{value:1},uFrostTemperature:{value:1},uFrostTexture:{value:1},uRippleFrequency:{value:25},uRippleAmplitude:{value:.08},uRippleWaveSpeed:{value:1},uRippleRippleCount:{value:1},uRippleDecay:{value:1},uPlasmaIntensity:{value:1.2},uPlasmaSpeed:{value:.8},uPlasmaEnergyIntensity:{value:.4},uPlasmaContrastBoost:{value:.3},uPlasmaTurbulence:{value:1},uTimeshiftDistortion:{value:1.6},uTimeshiftBlur:{value:1.5},uTimeshiftFlow:{value:1.4},uTimeshiftChromatic:{value:1.5},uTimeshiftTurbulence:{value:1.4}},vertexShader:U,fragmentShader:B}),b.add(new THREE.Mesh(new THREE.PlaneGeometry(2,2),f));for(const it of D)try{w.push(await Ee(it.media))}catch{console.warn("Failed texture")}w.length>=2&&(f.uniforms.uTexture1.value=w[0],f.uniforms.uTexture2.value=w[1],f.uniforms.uTexture1Size.value=w[0].userData.size,f.uniforms.uTexture2Size.value=w[1].userData.size,E=!0,R=!0,$(),(Ve=document.querySelector(".slider-wrapper"))==null||Ve.classList.add("loaded"),ue(500));const Pe=()=>{requestAnimationFrame(Pe),v.render(b,_)};Pe()};Q(),re(0);const ke=document.getElementById("mainTitle"),Ge=document.getElementById("mainDesc");ke&&Ge&&(ke.innerHTML=q(D[0].title),Ge.textContent=D[0].description,gsap.fromTo(ke.children,{y:20,opacity:0},{y:0,opacity:1,duration:1,stagger:.03,ease:"power3.out",delay:.5}),gsap.fromTo(Ge,{y:20,opacity:0},{y:0,opacity:1,duration:1,ease:"power3.out",delay:.8})),Fe(),document.addEventListener("visibilitychange",()=>document.hidden?J():!h&&ue()),window.addEventListener("resize",()=>{v&&(v.setSize(window.innerWidth,window.innerHeight),f.uniforms.uResolution.value.set(window.innerWidth,window.innerHeight))})};return n(),()=>{}},[]),c.jsxs(c.Fragment,{children:[c.jsx("style",{children:`
        .slider-wrapper {
          position: relative;
          width: 100%;
          height: 100vh;
          overflow: hidden;
          background: transparent;
          border-radius: 1.5rem;
        }

        .webgl-canvas {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          border-radius: 1.5rem;
        }

        /* Slide Numbers - Left and Right */
        .slide-number, .slide-total {
          position: absolute;
          font-size: 2rem;
          font-weight: 300;
          color: rgba(255, 255, 255, 0.6);
          z-index: 10;
          letter-spacing: 2px;
        }

        .slide-number {
          top: 50%;
          left: 2rem;
          transform: translateY(-50%);
        }

        .slide-total {
          top: 50%;
          right: 2rem;
          transform: translateY(-50%);
        }

        /* Center Content */
        .slide-content {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          text-align: center;
          z-index: 5;
          width: 80%;
          max-width: 800px;
        }

        .slide-title {
          font-size: 4rem;
          font-weight: 300;
          color: white;
          margin: 0;
          margin-bottom: 1rem;
          letter-spacing: 2px;
          line-height: 1.2;
        }

        .slide-description {
          font-size: 1.1rem;
          color: rgba(255, 255, 255, 0.8);
          margin: 0;
          letter-spacing: 0.5px;
          line-height: 1.6;
        }

        /* Navigation at bottom */
        .slides-navigation {
          position: absolute;
          bottom: 2rem;
          left: 50%;
          transform: translateX(-50%);
          display: flex;
          gap: 2rem;
          z-index: 10;
          width: 90%;
          max-width: 1200px;
          justify-content: center;
          flex-wrap: wrap;
        }

        .slide-nav-item {
          cursor: pointer;
          position: relative;
          padding-bottom: 0.5rem;
          transition: all 0.3s ease;
        }

        .slide-nav-title {
          font-size: 0.9rem;
          color: rgba(255, 255, 255, 0.6);
          letter-spacing: 1px;
          text-transform: uppercase;
          transition: color 0.3s ease;
        }

        .slide-nav-item.active .slide-nav-title {
          color: rgba(255, 255, 255, 1);
        }

        .slide-progress-line {
          position: absolute;
          bottom: 0;
          left: 0;
          width: 100%;
          height: 1px;
          background: rgba(255, 255, 255, 0.2);
        }

        .slide-progress-fill {
          height: 100%;
          background: rgba(255, 255, 255, 0.8);
          width: 0%;
          transition: width 0.1s ease, opacity 0.3s ease;
          opacity: 0;
        }

        .slider-wrapper.loaded {
          opacity: 1;
        }

        @media (max-width: 768px) {
          .slide-title {
            font-size: 2.5rem;
          }

          .slide-description {
            font-size: 1rem;
          }

          .slide-number, .slide-total {
            font-size: 1.5rem;
            top: 2rem;
          }

          .slide-number {
            left: 2rem;
            transform: none;
          }

          .slide-total {
            right: 2rem;
            transform: none;
          }

          .slides-navigation {
            bottom: 1rem;
            gap: 1rem;
          }
        }
      `}),c.jsxs("main",{className:"slider-wrapper",ref:e,children:[c.jsx("canvas",{className:"webgl-canvas"}),c.jsx("span",{className:"slide-number",id:"slideNumber",children:"01"}),c.jsx("span",{className:"slide-total",id:"slideTotal",children:"06"}),c.jsxs("div",{className:"slide-content",children:[c.jsx("h1",{className:"slide-title",id:"mainTitle"}),c.jsx("p",{className:"slide-description",id:"mainDesc"})]}),c.jsx("nav",{className:"slides-navigation",id:"slidesNav"})]})]})}const vH=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,yH=In,eZ=(e,n)=>s=>{var o;if((n==null?void 0:n.variants)==null)return yH(e,s==null?void 0:s.class,s==null?void 0:s.className);const{variants:d,defaultVariants:h}=n,f=Object.keys(d).map(_=>{const w=s==null?void 0:s[_],E=h==null?void 0:h[_];if(w===null)return null;const N=vH(w)||vH(E);return d[_][N]}),v=s&&Object.entries(s).reduce((_,w)=>{let[E,N]=w;return N===void 0||(_[E]=N),_},{}),b=n==null||(o=n.compoundVariants)===null||o===void 0?void 0:o.reduce((_,w)=>{let{class:E,className:N,...I}=w;return Object.entries(I).every(R=>{let[O,P]=R;return Array.isArray(P)?P.includes({...h,...v}[O]):{...h,...v}[O]===P})?[..._,E,N]:_},[]);return yH(e,f,b,s==null?void 0:s.class,s==null?void 0:s.className)},KCe=eZ("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function bH({className:e,variant:n,...s}){return c.jsx("div",{className:La(KCe({variant:n}),e),...s})}function xH(e,n){if(typeof e=="function")return e(n);e!=null&&(e.current=n)}function YCe(...e){return n=>{let s=!1;const o=e.map(d=>{const h=xH(d,n);return!s&&typeof h=="function"&&(s=!0),h});if(s)return()=>{for(let d=0;d<o.length;d++){const h=o[d];typeof h=="function"?h():xH(e[d],null)}}}}var qCe=Symbol.for("react.lazy"),Jw=Mq[" use ".trim().toString()];function XCe(e){return typeof e=="object"&&e!==null&&"then"in e}function tZ(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===qCe&&"_payload"in e&&XCe(e._payload)}function JCe(e){const n=ZCe(e),s=z.forwardRef((o,d)=>{let{children:h,...f}=o;tZ(h)&&typeof Jw=="function"&&(h=Jw(h._payload));const v=z.Children.toArray(h),b=v.find(tRe);if(b){const _=b.props.children,w=v.map(E=>E===b?z.Children.count(_)>1?z.Children.only(null):z.isValidElement(_)?_.props.children:null:E);return c.jsx(n,{...f,ref:d,children:z.isValidElement(_)?z.cloneElement(_,void 0,w):null})}return c.jsx(n,{...f,ref:d,children:h})});return s.displayName=`${e}.Slot`,s}var QCe=JCe("Slot");function ZCe(e){const n=z.forwardRef((s,o)=>{let{children:d,...h}=s;if(tZ(d)&&typeof Jw=="function"&&(d=Jw(d._payload)),z.isValidElement(d)){const f=rRe(d),v=nRe(h,d.props);return d.type!==z.Fragment&&(v.ref=o?YCe(o,f):f),z.cloneElement(d,v)}return z.Children.count(d)>1?z.Children.only(null):null});return n.displayName=`${e}.SlotClone`,n}var eRe=Symbol("radix.slottable");function tRe(e){return z.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===eRe}function nRe(e,n){const s={...n};for(const o in n){const d=e[o],h=n[o];/^on[A-Z]/.test(o)?d&&h?s[o]=(...v)=>{const b=h(...v);return d(...v),b}:d&&(s[o]=d):o==="style"?s[o]={...d,...h}:o==="className"&&(s[o]=[d,h].filter(Boolean).join(" "))}return{...e,...s}}function rRe(e){var o,d;let n=(o=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:o.get,s=n&&"isReactWarning"in n&&n.isReactWarning;return s?e.ref:(n=(d=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:d.get,s=n&&"isReactWarning"in n&&n.isReactWarning,s?e.props.ref:e.props.ref||e.ref)}const iRe=eZ("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),aP=z.forwardRef(({className:e,variant:n,size:s,asChild:o=!1,...d},h)=>{const f=o?QCe:"button";return c.jsx(f,{className:La(iRe({variant:n,size:s,className:e})),ref:h,...d})});aP.displayName="Button";const oP=z.forwardRef(({className:e,...n},s)=>c.jsx("div",{ref:s,className:La("rounded-lg border bg-card text-card-foreground shadow-sm",e),...n}));oP.displayName="Card";const cP=z.forwardRef(({className:e,...n},s)=>c.jsx("div",{ref:s,className:La("flex flex-col space-y-1.5 p-6",e),...n}));cP.displayName="CardHeader";const lP=z.forwardRef(({className:e,...n},s)=>c.jsx("h3",{ref:s,className:La("text-2xl font-semibold leading-none tracking-tight",e),...n}));lP.displayName="CardTitle";const sRe=z.forwardRef(({className:e,...n},s)=>c.jsx("p",{ref:s,className:La("text-sm text-muted-foreground",e),...n}));sRe.displayName="CardDescription";const dP=z.forwardRef(({className:e,...n},s)=>c.jsx("div",{ref:s,className:La("p-6 pt-0",e),...n}));dP.displayName="CardContent";const aRe=z.forwardRef(({className:e,...n},s)=>c.jsx("div",{ref:s,className:La("flex items-center p-6 pt-0",e),...n}));aRe.displayName="CardFooter";function oRe({timelineData:e}){const[n,s]=z.useState({}),[o,d]=z.useState("orbital"),[h,f]=z.useState(0),[v,b]=z.useState(!0),[_,w]=z.useState({}),[E,N]=z.useState({x:0,y:0}),[I,R]=z.useState(null),O=z.useRef(null),P=z.useRef(null),M=z.useRef({}),D=ee=>{(ee.target===O.current||ee.target===P.current)&&(s({}),R(null),w({}),b(!0))},U=ee=>{s(ce=>{const Q={...ce};if(Object.keys(Q).forEach(ae=>{parseInt(ae)!==ee&&(Q[parseInt(ae)]=!1)}),Q[ee]=!ce[ee],ce[ee])R(null),b(!0),w({});else{R(ee),b(!1);const ae=$(ee),ve={};ae.forEach(le=>{ve[le]=!0}),w(ve),B(ee)}return Q})};z.useEffect(()=>{let ee;return v&&o==="orbital"&&(ee=setInterval(()=>{f(ce=>{const Q=(ce+.3)%360;return Number(Q.toFixed(3))})},50)),()=>{ee&&clearInterval(ee)}},[v,o]);const B=ee=>{if(o!=="orbital"||!M.current[ee])return;const ce=e.findIndex(ve=>ve.id===ee),Q=e.length,ae=ce/Q*360;f(270-ae)},G=(ee,ce)=>{const Q=(ee/ce*360+h)%360,ve=typeof window<"u"&&window.innerWidth<1024?160:200,le=Q*Math.PI/180,fe=ve*Math.cos(le)+E.x,re=ve*Math.sin(le)+E.y,he=Math.round(100+50*Math.cos(le)),J=Math.max(.4,Math.min(1,.4+.6*((1+Math.sin(le))/2)));return{x:fe,y:re,angle:Q,zIndex:he,opacity:J}},$=ee=>{const ce=e.find(Q=>Q.id===ee);return ce?ce.relatedIds:[]},q=ee=>I?$(I).includes(ee):!1,X=ee=>{switch(ee){case"completed":return"text-white bg-black border-white";case"in-progress":return"text-black bg-white border-black";case"pending":return"text-white bg-black/40 border-white/50";default:return"text-white bg-black/40 border-white/50"}};return c.jsx("div",{className:"w-full py-20 md:py-32 bg-gradient-to-b from-transparent via-transparent to-transparent overflow-hidden",ref:O,onClick:D,children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"hidden md:block text-center max-w-3xl mx-auto mb-16",children:[c.jsxs("div",{className:"inline-flex items-center gap-2 mb-4",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-cyan-400"}),c.jsx("span",{className:"text-sm uppercase tracking-wider text-cyan-300 font-medium",children:"Platform Features"})]}),c.jsx("h2",{className:"text-3xl md:text-5xl font-bold text-white mb-6",children:"Five Core Features That Power HealthAI"}),c.jsx("p",{className:"text-lg text-cyan-100",children:"Discover the essential capabilities that make intelligent health management possible"})]}),c.jsxs("div",{className:"hidden lg:flex items-center justify-center gap-16 h-[600px]",children:[c.jsx("div",{className:"flex-1 flex flex-col justify-center",children:c.jsx("p",{className:"text-6xl md:text-7xl font-serif font-bold text-white leading-tight",children:"Transform Your Health With Advanced AI Intelligence and Insights"})}),c.jsxs("div",{className:"flex-1 h-full relative rounded-3xl overflow-visible",style:{background:"linear-gradient(135deg, rgba(10, 61, 92, 0.4) 0%, rgba(13, 90, 138, 0.4) 100%)"},children:[c.jsx("div",{className:"absolute inset-0 rounded-3xl border border-cyan-500/30"}),c.jsxs("div",{className:"absolute w-full h-full flex items-center justify-center",ref:P,style:{perspective:"1000px",transform:`translate(${E.x}px, ${E.y}px)`},children:[c.jsxs("div",{className:"absolute w-16 h-16 rounded-full bg-gradient-to-br from-purple-500 via-blue-500 to-teal-500 animate-pulse flex items-center justify-center z-50",children:[c.jsx("div",{className:"absolute w-20 h-20 rounded-full border-2 border-white/30 animate-ping opacity-70"}),c.jsx("div",{className:"absolute w-24 h-24 rounded-full border-2 border-white/20 animate-ping opacity-50",style:{animationDelay:"0.5s"}}),c.jsx("div",{className:"w-8 h-8 rounded-full bg-white/90 backdrop-blur-md shadow-lg shadow-white/50"})]}),c.jsx("div",{className:"absolute w-96 h-96 rounded-full border border-white/10"}),e.map((ee,ce)=>{const Q=G(ce,e.length),ae=n[ee.id],ve=q(ee.id),le=_[ee.id],fe=ee.icon,re={transform:`translate(${Q.x}px, ${Q.y}px)`,zIndex:ae?200:Q.zIndex,opacity:ae?1:Q.opacity};return c.jsxs("div",{ref:he=>M.current[ee.id]=he,className:"absolute transition-all duration-700 cursor-pointer",style:re,onClick:he=>{he.stopPropagation(),U(ee.id)},children:[c.jsx("div",{className:`absolute rounded-full -inset-1 ${le?"animate-pulse duration-1000":""}`,style:{background:"radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%)",width:`${ee.energy*.5+40}px`,height:`${ee.energy*.5+40}px`,left:`-${(ee.energy*.5+40-40)/2}px`,top:`-${(ee.energy*.5+40-40)/2}px`}}),c.jsx("div",{className:`
                  w-10 h-10 rounded-full flex items-center justify-center
                  bg-transparent text-white
                  border-2 
                  ${ae?"border-white shadow-lg shadow-white/30":ve?"border-white animate-pulse":"border-white"}
                  transition-all duration-300 transform
                  ${ae?"scale-150":""}
                `,children:c.jsx(fe,{size:16})}),c.jsx("div",{className:`
                  absolute top-12  whitespace-nowrap
                  text-xs font-semibold tracking-wider
                  transition-all duration-300
                  ${ae?"text-white scale-125":"text-white"}
                `,children:ee.title}),ae&&c.jsxs(oP,{className:"absolute top-14 left-1/2 -translate-x-1/2 w-48 bg-gradient-to-br from-[#0a3d5c] to-[#0d5a8a] backdrop-blur-lg border-cyan-500/50 shadow-xl shadow-cyan-500/20 overflow-visible z-50",children:[c.jsx("div",{className:"absolute -top-1.5 left-1/2 -translate-x-1/2 w-px h-1.5 bg-cyan-400/70"}),c.jsxs(cP,{className:"pb-1.5 pt-3 px-3",children:[c.jsxs("div",{className:"flex justify-between items-center mb-0.5",children:[c.jsx(bH,{className:`px-1.5 text-xs font-semibold ${X(ee.status)}`,children:ee.status==="completed"?" COMPLETE":ee.status==="in-progress"?" IN PROGRESS":" PENDING"}),c.jsx("span",{className:"text-xs font-mono text-cyan-300/70",children:ee.date})]}),c.jsx(lP,{className:"text-xs text-white mt-0.5",children:ee.title})]}),c.jsxs(dP,{className:"text-xs text-cyan-100/90 space-y-1.5 px-3 pb-2",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-cyan-300 font-semibold mb-0.5 text-xs",children:" Overview"}),c.jsx("p",{className:"text-cyan-100/80 text-xs leading-tight",children:ee.content})]}),c.jsxs("div",{className:"pt-1.5 border-t border-cyan-500/30",children:[c.jsx("h4",{className:"text-cyan-300 font-semibold mb-1 text-xs",children:" Key Features"}),c.jsxs("div",{className:"space-y-0.5",children:[ee.id===1&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Comprehensive health data collection"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"User needs and pain points analysis"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Feature prioritization framework"})]})]}),ee.id===2&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Scalable microservices architecture"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"AI/ML pipeline integration"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Secure data storage design"})]})]}),ee.id===3&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Claude AI integration for analysis"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Real-time report processing"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Multi-language support"})]})]}),ee.id===4&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Automated test suite coverage"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Performance optimization"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Security vulnerability scanning"})]})]}),ee.id===5&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Production deployment pipeline"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"24/7 monitoring and alerts"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"User onboarding and support"})]})]})]})]}),c.jsxs("div",{className:"pt-1.5 border-t border-cyan-500/30",children:[c.jsxs("div",{className:"flex justify-between items-center text-xs mb-0.5",children:[c.jsxs("span",{className:"flex items-center text-cyan-300",children:[c.jsx(xo,{size:9,className:"mr-0.5"}),"Progress"]}),c.jsxs("span",{className:"font-mono text-cyan-400 text-xs",children:[ee.energy,"%"]})]}),c.jsx("div",{className:"w-full h-1 bg-cyan-900/50 rounded-full overflow-hidden border border-cyan-500/30",children:c.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-cyan-400",style:{width:`${ee.energy}%`}})})]}),ee.relatedIds.length>0&&c.jsxs("div",{className:"pt-1.5 border-t border-cyan-500/30",children:[c.jsxs("div",{className:"flex items-center mb-0.5",children:[c.jsx(oH,{size:9,className:"text-cyan-400 mr-0.5"}),c.jsx("h4",{className:"text-xs uppercase tracking-wider font-semibold text-cyan-300",children:"Related Phases"})]}),c.jsx("div",{className:"flex flex-wrap gap-1",children:ee.relatedIds.map(he=>{const J=e.find(ue=>ue.id===he);return c.jsxs(aP,{variant:"outline",size:"sm",className:"flex items-center h-5 px-1 py-0 text-xs rounded-md border-cyan-500/40 bg-cyan-500/10 hover:bg-cyan-500/20 text-cyan-300 hover:text-cyan-200 transition-all",onClick:ue=>{ue.stopPropagation(),U(he)},children:[J==null?void 0:J.title,c.jsx(vo,{size:7,className:"ml-0.5 text-cyan-400/60"})]},he)})})]})]})]})]},ee.id)})]})]})]}),c.jsx("div",{className:"lg:hidden h-auto py-4 flex flex-col items-center justify-center",children:c.jsxs("div",{className:"relative w-full h-[480px] flex items-center justify-center rounded-2xl overflow-visible",style:{background:"linear-gradient(135deg, rgba(10, 61, 92, 0.4) 0%, rgba(13, 90, 138, 0.4) 100%)"},children:[c.jsx("div",{className:"absolute inset-0 rounded-2xl border border-cyan-500/30"}),c.jsxs("div",{className:"absolute w-full h-full flex items-center justify-center",ref:P,style:{perspective:"1000px",transform:`translate(${E.x}px, ${E.y}px)`},children:[c.jsxs("div",{className:"absolute w-16 h-16 rounded-full bg-gradient-to-br from-purple-500 via-blue-500 to-teal-500 animate-pulse flex items-center justify-center z-50",children:[c.jsx("div",{className:"absolute w-20 h-20 rounded-full border-2 border-white/30 animate-ping opacity-70"}),c.jsx("div",{className:"absolute w-24 h-24 rounded-full border-2 border-white/20 animate-ping opacity-50",style:{animationDelay:"0.5s"}}),c.jsx("div",{className:"w-8 h-8 rounded-full bg-white/90 backdrop-blur-md shadow-lg shadow-white/50"})]}),c.jsx("div",{className:"absolute w-96 h-96 rounded-full border border-white/10"}),e.map((ee,ce)=>{const Q=G(ce,e.length),ae=n[ee.id],ve=q(ee.id),le=_[ee.id],fe=ee.icon,re={transform:`translate(${Q.x}px, ${Q.y}px)`,zIndex:ae?200:Q.zIndex,opacity:ae?1:Q.opacity};return c.jsxs("div",{ref:he=>M.current[ee.id]=he,className:"absolute transition-all duration-700 cursor-pointer",style:re,onClick:he=>{he.stopPropagation(),U(ee.id)},children:[c.jsx("div",{className:`absolute rounded-full -inset-1 ${le?"animate-pulse duration-1000":""}`,style:{background:"radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%)",width:`${ee.energy*.5+40}px`,height:`${ee.energy*.5+40}px`,left:`-${(ee.energy*.5+40-40)/2}px`,top:`-${(ee.energy*.5+40-40)/2}px`}}),c.jsx("div",{className:`
                      w-10 h-10 rounded-full flex items-center justify-center
                      bg-transparent text-white
                      border-2 
                      ${ae?"border-white shadow-lg shadow-white/30":ve?"border-white animate-pulse":"border-white"}
                      transition-all duration-300 transform
                      ${ae?"scale-150":""}
                    `,children:c.jsx(fe,{size:16})}),c.jsx("div",{className:`
                      absolute top-12  whitespace-nowrap
                      text-xs font-semibold tracking-wider
                      transition-all duration-300
                      ${ae?"text-white scale-125":"text-white"}
                    `,children:ee.title}),ae&&c.jsxs(oP,{className:"absolute top-14 left-1/2 -translate-x-1/2 w-48 bg-gradient-to-br from-[#0a3d5c] to-[#0d5a8a] backdrop-blur-lg border-cyan-500/50 shadow-xl shadow-cyan-500/20 overflow-visible z-50",children:[c.jsx("div",{className:"absolute -top-1.5 left-1/2 -translate-x-1/2 w-px h-1.5 bg-cyan-400/70"}),c.jsxs(cP,{className:"pb-1.5 pt-3 px-3",children:[c.jsxs("div",{className:"flex justify-between items-center mb-0.5",children:[c.jsx(bH,{className:`px-1.5 text-xs font-semibold ${X(ee.status)}`,children:ee.status==="completed"?" COMPLETE":ee.status==="in-progress"?" IN PROGRESS":" PENDING"}),c.jsx("span",{className:"text-xs font-mono text-cyan-300/70",children:ee.date})]}),c.jsx(lP,{className:"text-xs text-white mt-0.5",children:ee.title})]}),c.jsxs(dP,{className:"text-xs text-cyan-100/90 space-y-1.5 px-3 pb-2",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-cyan-300 font-semibold mb-0.5 text-xs",children:" Overview"}),c.jsx("p",{className:"text-cyan-100/80 text-xs leading-tight",children:ee.content})]}),c.jsxs("div",{className:"pt-1.5 border-t border-cyan-500/30",children:[c.jsx("h4",{className:"text-cyan-300 font-semibold mb-1 text-xs",children:" Key Features"}),c.jsxs("div",{className:"space-y-0.5",children:[ee.id===1&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Comprehensive health data collection"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"User needs and pain points analysis"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Feature prioritization framework"})]})]}),ee.id===2&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Scalable microservices architecture"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"AI/ML pipeline integration"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Secure data storage design"})]})]}),ee.id===3&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Claude AI integration for analysis"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Real-time report processing"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Multi-language support"})]})]}),ee.id===4&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Automated test suite coverage"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Performance optimization"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Security vulnerability scanning"})]})]}),ee.id===5&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"Production deployment pipeline"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"24/7 monitoring and alerts"})]}),c.jsxs("div",{className:"flex gap-1.5 text-xs",children:[c.jsx("span",{className:"text-cyan-400 flex-shrink-0",children:""}),c.jsx("span",{children:"User onboarding and support"})]})]})]})]}),c.jsxs("div",{className:"pt-1.5 border-t border-cyan-500/30",children:[c.jsxs("div",{className:"flex justify-between items-center text-xs mb-0.5",children:[c.jsxs("span",{className:"flex items-center text-cyan-300",children:[c.jsx(xo,{size:9,className:"mr-0.5"}),"Progress"]}),c.jsxs("span",{className:"font-mono text-cyan-400 text-xs",children:[ee.energy,"%"]})]}),c.jsx("div",{className:"w-full h-1 bg-cyan-900/50 rounded-full overflow-hidden border border-cyan-500/30",children:c.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-cyan-400",style:{width:`${ee.energy}%`}})})]}),ee.relatedIds.length>0&&c.jsxs("div",{className:"pt-1.5 border-t border-cyan-500/30",children:[c.jsxs("div",{className:"flex items-center mb-0.5",children:[c.jsx(oH,{size:9,className:"text-cyan-400 mr-0.5"}),c.jsx("h4",{className:"text-xs uppercase tracking-wider font-semibold text-cyan-300",children:"Related Phases"})]}),c.jsx("div",{className:"flex flex-wrap gap-1",children:ee.relatedIds.map(he=>{const J=e.find(ue=>ue.id===he);return c.jsxs(aP,{variant:"outline",size:"sm",className:"flex items-center h-5 px-1 py-0 text-xs rounded-md border-cyan-500/40 bg-cyan-500/10 hover:bg-cyan-500/20 text-cyan-300 hover:text-cyan-200 transition-all",onClick:ue=>{ue.stopPropagation(),U(he)},children:[J==null?void 0:J.title,c.jsx(vo,{size:7,className:"ml-0.5 text-cyan-400/60"})]},he)})})]})]})]})]},ee.id)})]})]})})]})})}const cRe=[{id:1,title:"AI Analysis",date:"Real-time",content:"Advanced AI-powered analysis of your medical reports to identify health patterns and risks.",category:"Feature",icon:jh,relatedIds:[2,3],status:"completed",energy:100},{id:2,title:"Health Tracking",date:"24/7",content:"Continuous monitoring of your health metrics with smart alerts and personalized recommendations.",category:"Feature",icon:zn,relatedIds:[1,4],status:"completed",energy:95},{id:3,title:"Doctor Network",date:"Verified",content:"Connect with verified healthcare professionals recommended based on your specific health needs.",category:"Feature",icon:Pf,relatedIds:[1,5],status:"completed",energy:90},{id:4,title:"Nutrition Plans",date:"Personalized",content:"Get customized nutrition plans and supplement recommendations based on your health profile.",category:"Feature",icon:Pa,relatedIds:[2,5],status:"completed",energy:85},{id:5,title:"Report Upload",date:"Instant",content:"Upload your medical reports and get instant AI-powered analysis with actionable insights.",category:"Feature",icon:Es,relatedIds:[3,4],status:"completed",energy:100}];function lRe(){const[e,n]=z.useState(0),s=[{question:"What types of health reports can I upload?",answer:"FitCure supports all common medical report formats including blood tests, lab results, imaging reports, and general health checkups. You can upload PDFs, images, or even photos of paper reports. Our AI can extract and analyze data from virtually any medical document."},{question:"How accurate is the AI analysis?",answer:"Our AI has been trained on millions of medical records and achieves 98% accuracy in data extraction and analysis. However, our insights are meant to supplement, not replace, professional medical advice. We always recommend consulting with healthcare professionals for serious health concerns."},{question:"Is my health data secure and private?",answer:"Absolutely. We use bank-level encryption to protect your data and are fully HIPAA compliant. Your health information is never shared with third parties without your explicit consent. You have complete control over your data and can delete it at any time."},{question:"Can I connect with real doctors through the platform?",answer:"Yes! Based on your AI analysis, we recommend verified healthcare professionals who specialize in your specific health needs. Our network includes thousands of doctors, specialists, and healthcare providers who understand our AI insights."},{question:"What if I don't have any medical reports?",answer:"No problem! You can start by taking our comprehensive health assessment, or we can help you understand what tests to request from your doctor. We also provide guidance on essential health screenings based on your age, gender, and health goals."},{question:"Can I cancel my subscription anytime?",answer:"Yes, you can cancel your subscription at any time with no penalties or fees. If you cancel mid-cycle, you'll continue to have access to all features until the end of your billing period. We also offer a 30-day money-back guarantee for new subscribers."}];return c.jsx("section",{id:"faq",className:"py-20 md:py-32 bg-transparent",children:c.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsxs("div",{className:"inline-flex items-center gap-2 mb-4",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-cyan-400"}),c.jsx("span",{className:"text-sm uppercase tracking-wider text-cyan-300 font-medium",children:"FAQ"})]}),c.jsx("h2",{className:"text-3xl md:text-5xl font-serif text-white mb-6",children:"Got questions?"}),c.jsx("p",{className:"text-lg text-cyan-100",children:"We've got answers. If you can't find what you're looking for, chat with our team."})]}),c.jsx("div",{className:"space-y-4",children:s.map((o,d)=>c.jsxs("div",{className:"border border-cyan-500/30 rounded-xl overflow-hidden bg-white/5 backdrop-blur-sm hover:bg-white/10 transition-colors",children:[c.jsxs("button",{onClick:()=>n(e===d?null:d),className:"w-full flex items-center justify-between p-6 text-left",children:[c.jsx("span",{className:"text-lg font-medium text-white pr-4",children:o.question}),c.jsx(mu,{className:`w-5 h-5 text-cyan-300 shrink-0 transition-transform duration-200 ${e===d?"rotate-180":""}`})]}),c.jsx("div",{className:`overflow-hidden transition-all duration-200 ${e===d?"max-h-96":"max-h-0"}`,children:c.jsx("p",{className:"px-6 pb-6 text-cyan-100 leading-relaxed",children:o.answer})})]},d))})]})})}function dRe(){return c.jsx("section",{className:"py-20 md:py-32 bg-transparent",children:c.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[c.jsx("h2",{className:"text-3xl md:text-5xl font-serif text-white mb-6",children:"Ready to transform your health with AI?"}),c.jsx("p",{className:"text-lg text-cyan-100 mb-10 max-w-2xl mx-auto",children:"Join 10,000+ people who've made the switch to proactive, AI-powered healthcare. Your future self will thank you."}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[c.jsxs(Ct,{to:"/register?skip=true",className:"bg-white text-[#8B7355] hover:bg-[#F5F1EA] rounded-full px-8 py-4 text-base font-medium transition-all inline-flex items-center gap-2 shadow-lg",children:["Start your free analysis",c.jsx(vo,{className:"w-5 h-5"})]}),c.jsx(Ct,{to:"/login",className:"rounded-full px-8 py-4 text-base font-medium border-2 border-white/40 text-white hover:bg-white/10 bg-transparent transition-all backdrop-blur-sm",children:"Talk to our team"})]}),c.jsx("p",{className:"text-sm text-white/80 mt-6",children:"Free forever plan  No credit card required  Cancel anytime"})]})})}function uRe(){return c.jsx("footer",{className:"bg-[#2C2416] text-white py-16",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-8 mb-12",children:[c.jsxs("div",{className:"col-span-2 lg:col-span-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx("div",{className:"w-8 h-8 bg-[#8B7355] rounded-xl flex items-center justify-center",children:c.jsx(jn,{className:"w-5 h-5 text-white"})}),c.jsx("span",{className:"font-serif text-xl",children:"FitCure"})]}),c.jsx("p",{className:"text-white/60 text-sm mb-4",children:"AI-powered health insights for better living."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-4",children:"Product"}),c.jsxs("ul",{className:"space-y-3 text-sm",children:[c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Features"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Pricing"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Mobile App"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"API"})})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-4",children:"Company"}),c.jsxs("ul",{className:"space-y-3 text-sm",children:[c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"About"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Blog"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Careers"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Press"})})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-4",children:"Resources"}),c.jsxs("ul",{className:"space-y-3 text-sm",children:[c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Help Center"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Health Guides"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Find a Doctor"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Partner with Us"})})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-4",children:"Legal"}),c.jsxs("ul",{className:"space-y-3 text-sm",children:[c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Privacy Policy"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"Terms of Service"})}),c.jsx("li",{children:c.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-colors",children:"HIPAA Compliance"})})]})]})]}),c.jsxs("div",{className:"pt-8 border-t border-white/10 flex flex-col md:flex-row items-center justify-between gap-4",children:[c.jsx("p",{className:"text-sm text-white/60",children:" 2024 FitCure. All rights reserved."}),c.jsx("p",{className:"text-sm text-white/60",children:"Made with  for better health"})]})]})})}function hRe(){return c.jsxs("div",{className:"min-h-screen bg-transparent",children:[c.jsx(qNe,{}),c.jsx(XNe,{}),c.jsx(JNe,{}),c.jsx(QNe,{}),c.jsx(HCe,{}),c.jsx(oRe,{timelineData:cRe}),c.jsx(ZNe,{}),c.jsx(zCe,{}),c.jsx(lRe,{}),c.jsx(dRe,{}),c.jsx(uRe,{})]})}function pRe(){const[e,n]=z.useState(""),[s,o]=z.useState(""),[d,h]=z.useState(!1),[f,v]=z.useState(!1),{login:b}=as(),_=Us(),w=async E=>{var N,I,R;E.preventDefault(),v(!0);try{const O=await b(e,s);et.success("Welcome back!"),_(O.role==="admin"?"/admin":O.role==="doctor"?"/doctor/dashboard":"/dashboard")}catch(O){const P=((I=(N=O.response)==null?void 0:N.data)==null?void 0:I.message)||O.message||"Login failed";O.response?et.error(P):(et.error("Network error - Check if server is running and accessible"),console.error("Connection details:",{apiUrl:(R=O.config)==null?void 0:R.baseURL,host:window.location.hostname,port:window.location.port}))}finally{v(!1)}};return c.jsxs("div",{className:"min-h-screen flex bg-gradient-to-br from-cyan-50 to-blue-50",children:[c.jsxs("div",{className:"hidden lg:flex lg:w-1/2 relative overflow-hidden bg-gradient-to-br from-cyan-500 via-blue-500 to-cyan-600",children:[c.jsxs("div",{className:"absolute inset-0",children:[c.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-white/10 rounded-full blur-3xl"}),c.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-white/10 rounded-full blur-3xl"})]}),c.jsxs("div",{className:"relative z-10 flex flex-col justify-center items-center w-full p-12 text-white",children:[c.jsx("div",{className:"w-20 h-20 bg-white/20 backdrop-blur-xl rounded-3xl flex items-center justify-center mb-8",children:c.jsx(jn,{className:"w-10 h-10"})}),c.jsx("h1",{className:"text-4xl font-bold mb-4 text-center",children:"Welcome to HealthAI"}),c.jsx("p",{className:"text-xl text-white/80 text-center max-w-md",children:"Your AI-powered health companion for smarter healthcare decisions."})]})]}),c.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:c.jsxs("div",{className:"w-full max-w-md",children:[c.jsxs("div",{className:"lg:hidden flex items-center justify-center gap-3 mb-8",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center",children:c.jsx(jn,{className:"w-7 h-7 text-white"})}),c.jsx("span",{className:"text-2xl font-bold text-gray-900",children:"HealthAI"})]}),c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h2",{className:"text-3xl font-bold mb-2 text-gray-900",children:"Sign In"}),c.jsx("p",{className:"text-gray-600",children:"Access your health dashboard"})]}),c.jsxs("form",{onSubmit:w,className:"space-y-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Email Address"}),c.jsxs("div",{className:"relative",children:[c.jsx(lb,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),c.jsx("input",{type:"email",value:e,onChange:E=>n(E.target.value),className:"w-full bg-white rounded-xl py-3 pl-12 pr-4 focus:outline-none focus:ring-2 focus:ring-cyan-500 border border-gray-200 text-gray-900",placeholder:"you@example.com",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Password"}),c.jsxs("div",{className:"relative",children:[c.jsx(tP,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),c.jsx("input",{type:d?"text":"password",value:s,onChange:E=>o(E.target.value),className:"w-full bg-white rounded-xl py-3 pl-12 pr-12 focus:outline-none focus:ring-2 focus:ring-cyan-500 border border-gray-200 text-gray-900",placeholder:"",required:!0}),c.jsx("button",{type:"button",onClick:()=>h(!d),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:d?c.jsx(kQ,{className:"w-5 h-5"}):c.jsx(Ll,{className:"w-5 h-5"})})]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-cyan-500 focus:ring-cyan-500"}),c.jsx("span",{className:"text-sm text-gray-600",children:"Remember me"})]}),c.jsx("a",{href:"#",className:"text-sm font-medium text-cyan-600 hover:text-cyan-700",children:"Forgot password?"})]}),c.jsx("button",{type:"submit",disabled:f,className:"w-full py-3 text-white font-semibold rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2 disabled:opacity-50 bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700",children:f?c.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):c.jsxs(c.Fragment,{children:["Sign In ",c.jsx(vo,{className:"w-5 h-5"})]})})]}),c.jsxs("p",{className:"text-center mt-8 text-gray-600",children:["Don't have an account?"," ",c.jsx(Ct,{to:"/register",className:"font-semibold text-cyan-600 hover:text-cyan-700",children:"Create one"})]})]})})]})}function mRe({step:e}){const n=(e-1)/4*100,s=()=>{switch(e){case 2:return c.jsx(zn,{className:"w-12 h-12"});case 3:return c.jsx(jn,{className:"w-12 h-12"});case 4:return c.jsx(Yj,{className:"w-12 h-12"});case 5:return c.jsx(ns,{className:"w-12 h-12"});default:return c.jsx(zn,{className:"w-12 h-12"})}},o=()=>{switch(e){case 2:return"Building Your Profile";case 3:return"Analyzing Your Health";case 4:return"Understanding Your Lifestyle";case 5:return"Almost Complete!";default:return"Getting Started"}};return c.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[c.jsxs("div",{className:"relative w-32 h-32 mb-4",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-400 to-blue-500 rounded-full opacity-20 animate-pulse"}),c.jsx("div",{className:"absolute inset-4 bg-gradient-to-br from-cyan-400 to-blue-500 rounded-full opacity-30 animate-pulse",style:{animationDelay:"0.2s"}}),c.jsx("div",{className:"absolute inset-8 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full flex items-center justify-center text-white shadow-lg",children:s()}),c.jsxs("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:[c.jsx("circle",{cx:"64",cy:"64",r:"60",stroke:"currentColor",strokeOpacity:"0.1",strokeWidth:"4",fill:"none",className:"text-cyan-500"}),c.jsx("circle",{cx:"64",cy:"64",r:"60",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeDasharray:"377",strokeDashoffset:377-377*(n/100),className:"text-cyan-500 transition-all duration-500",strokeLinecap:"round"})]})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-lg font-semibold text-cyan-600 mb-1",children:o()}),c.jsxs("p",{className:"text-sm text-gray-600",children:[Math.round(n),"% Complete"]})]}),c.jsx("div",{className:"flex items-center gap-2 mt-4",children:[1,2,3,4].map(d=>c.jsx("div",{className:`w-2 h-2 rounded-full transition-all duration-300 ${d<e?"bg-cyan-500 w-8":d===e?"bg-cyan-500 w-3 h-3":"bg-gray-300"}`},d))})]})}function fRe(){const e=mc();new URLSearchParams(e.search);const[n,s]=z.useState(2),[o,d]=z.useState("patient"),[h,f]=z.useState({name:"",email:"",password:"",confirmPassword:"",age:"",gender:"",height:"",weight:"",bloodGroup:"",dietaryPreference:"non-vegetarian",activityLevel:"sedentary",chronicConditions:[],allergies:[],currentMedications:[],smoker:!1,smokingFrequency:"",alcohol:!1,alcoholFrequency:"",sleepHours:"7",stressLevel:"moderate",waterIntake:"8",nutritionGoal:"general_health",targetWeight:"",weeklyGoal:"0.5"}),[v,b]=z.useState(!1),[_,w]=z.useState(!1),[E,N]=z.useState(""),[I,R]=z.useState(""),[O,P]=z.useState(""),{register:M}=as(),D=Us(),U=async ee=>{var ce,Q;if(ee.preventDefault(),h.password!==h.confirmPassword){et.error("Passwords do not match");return}if(!h.age||!h.gender){et.error("Please provide your age and gender");return}w(!0);try{const ae={age:parseInt(h.age),gender:h.gender,height:h.height?parseFloat(h.height):void 0,weight:h.weight?parseFloat(h.weight):void 0,bloodGroup:h.bloodGroup||void 0,dietaryPreference:h.dietaryPreference,activityLevel:h.activityLevel,medicalHistory:{conditions:h.chronicConditions,currentMedications:h.currentMedications},lifestyle:{smoker:h.smoker,smokingFrequency:h.smokingFrequency,alcohol:h.alcohol,alcoholFrequency:h.alcoholFrequency,sleepHours:parseInt(h.sleepHours),stressLevel:h.stressLevel,waterIntake:parseInt(h.waterIntake)},allergies:h.allergies},ve={goal:h.nutritionGoal,targetWeight:h.targetWeight?parseFloat(h.targetWeight):null,weeklyGoal:parseFloat(h.weeklyGoal)};await M(h.name,h.email,h.password,ae,ve),et.success("Account created successfully! Your personalized nutrition plan is ready."),D("/dashboard")}catch(ae){et.error(((Q=(ce=ae.response)==null?void 0:ce.data)==null?void 0:Q.message)||"Registration failed")}finally{w(!1)}},B=()=>{if(n===2){if(!h.name||!h.email||!h.password||!h.age||!h.gender){et.error("Please fill in all required fields");return}if(h.password!==h.confirmPassword){et.error("Passwords do not match");return}}if(n===3&&(!h.height||!h.weight)){et.error("Please provide your height and weight for accurate nutrition calculations");return}s(n+1)},G=()=>{n===2?D("/"):s(n-1)},$=(ee,ce)=>{f(Q=>({...Q,[ee]:Q[ee].includes(ce)?Q[ee].filter(ae=>ae!==ce):[...Q[ee],ce]}))},q=(ee,ce)=>{ce&&!h[ee].includes(ce)&&f(Q=>({...Q,[ee]:[...Q[ee],ce]}))},X=(ee,ce)=>{f(Q=>({...Q,[ee]:Q[ee].filter(ae=>ae!==ce)}))};if(n===2)return c.jsxs("div",{className:"min-h-screen flex bg-gradient-to-br from-cyan-50 to-blue-50",children:[c.jsx("div",{className:"lg:hidden w-full",children:c.jsx(mRe,{step:2})}),c.jsxs("div",{className:"hidden lg:flex lg:w-1/2 relative overflow-hidden bg-gradient-to-br from-cyan-500 via-blue-500 to-cyan-600",children:[c.jsxs("div",{className:"absolute inset-0",children:[c.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-white/10 rounded-full blur-3xl"}),c.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-white/10 rounded-full blur-3xl"})]}),c.jsxs("div",{className:"relative z-10 flex flex-col justify-center items-center p-12 text-white",children:[c.jsxs("div",{className:"relative w-32 h-32 mb-8",children:[c.jsx("div",{className:"absolute inset-0 bg-white/20 backdrop-blur-xl rounded-full animate-pulse"}),c.jsx("div",{className:"absolute inset-4 bg-white/30 backdrop-blur-xl rounded-full flex items-center justify-center",children:c.jsx(zn,{className:"w-12 h-12 animate-pulse"})}),c.jsxs("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:[c.jsx("circle",{cx:"64",cy:"64",r:"60",stroke:"white",strokeOpacity:"0.2",strokeWidth:"4",fill:"none"}),c.jsx("circle",{cx:"64",cy:"64",r:"60",stroke:"white",strokeWidth:"4",fill:"none",strokeDasharray:"377",strokeDashoffset:377-377*.25,className:"transition-all duration-500",strokeLinecap:"round"})]})]}),c.jsx("h1",{className:"text-4xl font-bold mb-4 text-center",children:"Your Health Journey Starts Here"}),c.jsx("p",{className:"text-xl text-white/80 text-center max-w-md mb-6",children:"Get personalized health insights, diet plans, and supplement recommendations based on your unique profile."}),c.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center",children:c.jsx(tc,{className:"w-5 h-5 text-green-600"})}),c.jsx("span",{className:"text-sm font-medium",children:"Step 1"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white/40"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white/40 flex items-center justify-center",children:c.jsx("span",{className:"text-sm font-bold",children:"2"})}),c.jsx("span",{className:"text-sm",children:"Step 2"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white/20"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",children:c.jsx("span",{className:"text-sm",children:"3"})}),c.jsx("span",{className:"text-sm text-white/60",children:"Step 3"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white/20"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",children:c.jsx("span",{className:"text-sm",children:"4"})}),c.jsx("span",{className:"text-sm text-white/60",children:"Step 4"})]})]}),c.jsx("p",{className:"text-sm text-white/70 mt-6",children:"25% Complete - Almost there!"})]})]}),c.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:c.jsxs("div",{className:"w-full max-w-md",children:[c.jsxs("button",{onClick:()=>s(1),className:"flex items-center gap-2 mb-6 text-cyan-600 hover:text-cyan-700",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back"]}),c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h2",{className:"text-3xl font-bold mb-2 text-gray-900",children:"Basic Information"}),c.jsx("p",{className:"text-gray-600",children:"Step 1 of 4 - Let's start with the basics"})]}),c.jsxs("form",{onSubmit:ee=>{ee.preventDefault(),B()},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Full Name *"}),c.jsxs("div",{className:"relative",children:[c.jsx(tl,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),c.jsx("input",{type:"text",value:h.name,onChange:ee=>f({...h,name:ee.target.value}),className:"w-full bg-white rounded-xl py-3 pl-12 pr-4 focus:outline-none focus:ring-2 focus:ring-cyan-500 border border-gray-200 text-gray-900",placeholder:"John Doe",required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Age *"}),c.jsx("input",{type:"number",value:h.age,onChange:ee=>f({...h,age:ee.target.value}),className:"w-full bg-white rounded-xl py-3 px-4 focus:outline-none focus:ring-2 focus:ring-cyan-500 border border-gray-200 text-gray-900",placeholder:"25",min:"1",max:"120",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Gender *"}),c.jsxs("select",{value:h.gender,onChange:ee=>f({...h,gender:ee.target.value}),className:"w-full bg-white rounded-xl py-3 px-4 focus:outline-none focus:ring-2 focus:ring-cyan-500 border border-gray-200 text-gray-900",required:!0,children:[c.jsx("option",{value:"",children:"Select"}),c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"}),c.jsx("option",{value:"other",children:"Other"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Email Address *"}),c.jsxs("div",{className:"relative",children:[c.jsx(lb,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),c.jsx("input",{type:"email",value:h.email,onChange:ee=>f({...h,email:ee.target.value}),className:"w-full bg-white rounded-xl py-3 pl-12 pr-4 focus:outline-none focus:ring-2 focus:ring-cyan-500 border border-gray-200 text-gray-900",placeholder:"you@example.com",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Password *"}),c.jsxs("div",{className:"relative",children:[c.jsx(tP,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),c.jsx("input",{type:v?"text":"password",value:h.password,onChange:ee=>f({...h,password:ee.target.value}),className:"w-full bg-white rounded-xl py-3 pl-12 pr-12 focus:outline-none focus:ring-2 focus:ring-cyan-500 border border-gray-200 text-gray-900",placeholder:"",required:!0}),c.jsx("button",{type:"button",onClick:()=>b(!v),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:v?c.jsx(kQ,{className:"w-5 h-5"}):c.jsx(Ll,{className:"w-5 h-5"})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Confirm Password *"}),c.jsxs("div",{className:"relative",children:[c.jsx(tP,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),c.jsx("input",{type:"password",value:h.confirmPassword,onChange:ee=>f({...h,confirmPassword:ee.target.value}),className:"w-full bg-white rounded-xl py-3 pl-12 pr-4 focus:outline-none focus:ring-2 focus:ring-cyan-500 border border-gray-200 text-gray-900",placeholder:"",required:!0})]})]}),c.jsxs("button",{type:"submit",className:"w-full py-3 text-white font-semibold rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2 bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700",children:["Continue ",c.jsx(vo,{className:"w-5 h-5"})]})]}),c.jsxs("p",{className:"text-center mt-6 text-gray-600",children:["Already have an account?"," ",c.jsx(Ct,{to:"/login",className:"font-semibold text-cyan-600 hover:text-cyan-700",children:"Sign in"})]})]})})]});if(n===3)return c.jsxs("div",{className:"min-h-screen flex",style:{backgroundColor:"#F5F1EA"},children:[c.jsxs("div",{className:"hidden lg:flex lg:w-1/2 relative overflow-hidden",style:{background:"linear-gradient(to bottom right, #8B7355, #A0826D, #8B7355)"},children:[c.jsxs("div",{className:"absolute inset-0",children:[c.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-white/10 rounded-full blur-3xl"}),c.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-white/10 rounded-full blur-3xl"})]}),c.jsxs("div",{className:"relative z-10 flex flex-col justify-center items-center p-12 text-white",children:[c.jsxs("div",{className:"relative w-32 h-32 mb-8",children:[c.jsx("div",{className:"absolute inset-0 bg-white/20 backdrop-blur-xl rounded-full animate-pulse"}),c.jsx("div",{className:"absolute inset-4 bg-white/30 backdrop-blur-xl rounded-full flex items-center justify-center",children:c.jsx(dH,{className:"w-12 h-12 animate-bounce",style:{animationDuration:"2s"}})}),c.jsxs("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:[c.jsx("circle",{cx:"64",cy:"64",r:"60",stroke:"white",strokeOpacity:"0.2",strokeWidth:"4",fill:"none"}),c.jsx("circle",{cx:"64",cy:"64",r:"60",stroke:"white",strokeWidth:"4",fill:"none",strokeDasharray:"377",strokeDashoffset:377-377*.5,className:"transition-all duration-500",strokeLinecap:"round"})]})]}),c.jsx("h1",{className:"text-4xl font-bold mb-4 text-center",children:"Health Profile"}),c.jsx("p",{className:"text-xl text-white/80 text-center max-w-md mb-6",children:"Help us calculate your personalized nutrition goals based on your body metrics."}),c.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center",children:c.jsx(tc,{className:"w-5 h-5 text-green-600"})}),c.jsx("span",{className:"text-sm font-medium",children:"Step 1"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center",children:c.jsx(tc,{className:"w-5 h-5 text-green-600"})}),c.jsx("span",{className:"text-sm font-medium",children:"Step 2"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white/40"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white/40 flex items-center justify-center",children:c.jsx(Zh,{className:"w-5 h-5 animate-spin"})}),c.jsx("span",{className:"text-sm",children:"Step 3"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white/20"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",children:c.jsx("span",{className:"text-sm",children:"4"})}),c.jsx("span",{className:"text-sm text-white/60",children:"Step 4"})]})]}),c.jsx("p",{className:"text-sm text-white/70 mt-6",children:"50% Complete - Halfway there!"})]})]}),c.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:c.jsxs("div",{className:"w-full max-w-md",children:[c.jsxs("button",{onClick:G,className:"flex items-center gap-2 mb-6",style:{color:"#5C4F3D"},children:[c.jsx(Ci,{className:"w-4 h-4"})," Back"]}),c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h2",{className:"text-3xl font-bold mb-2",style:{color:"#2C2416"},children:"Health Profile"}),c.jsx("p",{style:{color:"#5C4F3D"},children:"Step 2 of 4 - Your body metrics"})]}),c.jsxs("form",{onSubmit:ee=>{ee.preventDefault(),B()},className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Height (cm) *"}),c.jsxs("div",{className:"relative",children:[c.jsx(DNe,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5",style:{color:"#5C4F3D"}}),c.jsx("input",{type:"number",value:h.height,onChange:ee=>f({...h,height:ee.target.value}),className:"w-full bg-white rounded-xl py-3 pl-12 pr-4 focus:outline-none",style:{border:"1px solid #E5DFD3",color:"#2C2416"},placeholder:"170",min:"100",max:"250",step:"0.1",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Weight (kg) *"}),c.jsxs("div",{className:"relative",children:[c.jsx(dH,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5",style:{color:"#5C4F3D"}}),c.jsx("input",{type:"number",value:h.weight,onChange:ee=>f({...h,weight:ee.target.value}),className:"w-full bg-white rounded-xl py-3 pl-12 pr-4 focus:outline-none",style:{border:"1px solid #E5DFD3",color:"#2C2416"},placeholder:"70",min:"30",max:"300",step:"0.1",required:!0})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Blood Group"}),c.jsxs("div",{className:"relative",children:[c.jsx(eP,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5",style:{color:"#5C4F3D"}}),c.jsxs("select",{value:h.bloodGroup,onChange:ee=>f({...h,bloodGroup:ee.target.value}),className:"w-full bg-white rounded-xl py-3 pl-12 pr-4 focus:outline-none",style:{border:"1px solid #E5DFD3",color:"#2C2416"},children:[c.jsx("option",{value:"",children:"Select (Optional)"}),c.jsx("option",{value:"A+",children:"A+"}),c.jsx("option",{value:"A-",children:"A-"}),c.jsx("option",{value:"B+",children:"B+"}),c.jsx("option",{value:"B-",children:"B-"}),c.jsx("option",{value:"AB+",children:"AB+"}),c.jsx("option",{value:"AB-",children:"AB-"}),c.jsx("option",{value:"O+",children:"O+"}),c.jsx("option",{value:"O-",children:"O-"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Dietary Preference *"}),c.jsxs("select",{value:h.dietaryPreference,onChange:ee=>f({...h,dietaryPreference:ee.target.value}),className:"w-full bg-white rounded-xl py-3 px-4 focus:outline-none",style:{border:"1px solid #E5DFD3",color:"#2C2416"},required:!0,children:[c.jsx("option",{value:"non-vegetarian",children:"Non-Vegetarian"}),c.jsx("option",{value:"vegetarian",children:"Vegetarian"}),c.jsx("option",{value:"vegan",children:"Vegan"}),c.jsx("option",{value:"eggetarian",children:"Eggetarian"})]}),c.jsx("p",{className:"text-xs mt-1",style:{color:"#5C4F3D"},children:"This helps us recommend suitable diet plans"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Activity Level *"}),c.jsxs("select",{value:h.activityLevel,onChange:ee=>f({...h,activityLevel:ee.target.value}),className:"w-full bg-white rounded-xl py-3 px-4 focus:outline-none",style:{border:"1px solid #E5DFD3",color:"#2C2416"},required:!0,children:[c.jsx("option",{value:"sedentary",children:"Sedentary (Little or no exercise)"}),c.jsx("option",{value:"lightly_active",children:"Lightly Active (1-3 days/week)"}),c.jsx("option",{value:"moderately_active",children:"Moderately Active (3-5 days/week)"}),c.jsx("option",{value:"very_active",children:"Very Active (6-7 days/week)"}),c.jsx("option",{value:"extremely_active",children:"Extremely Active (Athlete)"})]}),c.jsx("p",{className:"text-xs mt-1",style:{color:"#5C4F3D"},children:"Used to calculate your daily calorie needs"})]}),c.jsxs("button",{type:"submit",className:"w-full py-3 text-white font-semibold rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2",style:{backgroundColor:"#8B7355"},children:["Continue ",c.jsx(vo,{className:"w-5 h-5"})]})]})]})})]});if(n===4){const ee=["Diabetes","Hypertension","Thyroid","Asthma","Heart Disease","Arthritis"],ce=["Peanuts","Dairy","Gluten","Shellfish","Eggs","Soy"];return c.jsxs("div",{className:"min-h-screen flex",style:{backgroundColor:"#F5F1EA"},children:[c.jsxs("div",{className:"hidden lg:flex lg:w-1/2 relative overflow-hidden",style:{background:"linear-gradient(to bottom right, #8B7355, #A0826D, #8B7355)"},children:[c.jsxs("div",{className:"absolute inset-0",children:[c.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-white/10 rounded-full blur-3xl"}),c.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-white/10 rounded-full blur-3xl"})]}),c.jsxs("div",{className:"relative z-10 flex flex-col justify-center items-center p-12 text-white",children:[c.jsxs("div",{className:"relative w-32 h-32 mb-8",children:[c.jsx("div",{className:"absolute inset-0 bg-white/20 backdrop-blur-xl rounded-full animate-pulse"}),c.jsx("div",{className:"absolute inset-4 bg-white/30 backdrop-blur-xl rounded-full flex items-center justify-center",children:c.jsx(zn,{className:"w-12 h-12"})}),c.jsxs("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:[c.jsx("circle",{cx:"64",cy:"64",r:"60",stroke:"white",strokeOpacity:"0.2",strokeWidth:"4",fill:"none"}),c.jsx("circle",{cx:"64",cy:"64",r:"60",stroke:"white",strokeWidth:"4",fill:"none",strokeDasharray:"377",strokeDashoffset:377-377*.75,className:"transition-all duration-500",strokeLinecap:"round"})]})]}),c.jsx("h1",{className:"text-4xl font-bold mb-4 text-center",children:"Lifestyle & Health History"}),c.jsx("p",{className:"text-xl text-white/80 text-center max-w-md mb-6",children:"Help us understand your lifestyle and medical background for better recommendations."}),c.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center",children:c.jsx(tc,{className:"w-5 h-5 text-green-600"})}),c.jsx("span",{className:"text-sm font-medium",children:"Step 1"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center",children:c.jsx(tc,{className:"w-5 h-5 text-green-600"})}),c.jsx("span",{className:"text-sm font-medium",children:"Step 2"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center",children:c.jsx(tc,{className:"w-5 h-5 text-green-600"})}),c.jsx("span",{className:"text-sm font-medium",children:"Step 3"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white/40"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white/40 flex items-center justify-center",children:c.jsx(Zh,{className:"w-5 h-5 animate-spin"})}),c.jsx("span",{className:"text-sm",children:"Step 4"})]})]}),c.jsx("p",{className:"text-sm text-white/70 mt-6",children:"75% Complete - Almost done!"})]})]}),c.jsx("div",{className:"flex-1 flex items-center justify-center p-8 overflow-y-auto",children:c.jsxs("div",{className:"w-full max-w-md py-8",children:[c.jsxs("button",{onClick:G,className:"flex items-center gap-2 mb-6",style:{color:"#5C4F3D"},children:[c.jsx(Ci,{className:"w-4 h-4"})," Back"]}),c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h2",{className:"text-3xl font-bold mb-2",style:{color:"#2C2416"},children:"Lifestyle & Medical History"}),c.jsx("p",{style:{color:"#5C4F3D"},children:"Step 3 of 4 - Optional but recommended"})]}),c.jsxs("form",{onSubmit:Q=>{Q.preventDefault(),B()},className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-xl p-4",style:{border:"1px solid #E5DFD3"},children:[c.jsx("h3",{className:"font-semibold mb-4",style:{color:"#2C2416"},children:"Lifestyle Habits"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium mb-2",style:{color:"#2C2416"},children:[c.jsx(wNe,{className:"w-4 h-4"}),"Do you smoke?"]}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",checked:!h.smoker,onChange:()=>f({...h,smoker:!1,smokingFrequency:""}),className:"text-cyan-500"}),c.jsx("span",{className:"text-sm",style:{color:"#2C2416"},children:"No"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",checked:h.smoker,onChange:()=>f({...h,smoker:!0}),className:"text-cyan-500"}),c.jsx("span",{className:"text-sm",style:{color:"#2C2416"},children:"Yes"})]})]}),h.smoker&&c.jsxs("select",{value:h.smokingFrequency,onChange:Q=>f({...h,smokingFrequency:Q.target.value}),className:"mt-2 w-full rounded-lg py-2 px-3 text-sm",style:{backgroundColor:"#F5F1EA",border:"1px solid #E5DFD3",color:"#2C2416"},children:[c.jsx("option",{value:"",children:"Select frequency"}),c.jsx("option",{value:"occasional",children:"Occasional (1-2 times/week)"}),c.jsx("option",{value:"regular",children:"Regular (3-6 times/week)"}),c.jsx("option",{value:"heavy",children:"Heavy (Daily)"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium mb-2",style:{color:"#2C2416"},children:[c.jsx(GNe,{className:"w-4 h-4"}),"Do you consume alcohol?"]}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",checked:!h.alcohol,onChange:()=>f({...h,alcohol:!1,alcoholFrequency:""}),className:"text-cyan-500"}),c.jsx("span",{className:"text-sm",style:{color:"#2C2416"},children:"No"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",checked:h.alcohol,onChange:()=>f({...h,alcohol:!0}),className:"text-cyan-500"}),c.jsx("span",{className:"text-sm",style:{color:"#2C2416"},children:"Yes"})]})]}),h.alcohol&&c.jsxs("select",{value:h.alcoholFrequency,onChange:Q=>f({...h,alcoholFrequency:Q.target.value}),className:"mt-2 w-full rounded-lg py-2 px-3 text-sm",style:{backgroundColor:"#F5F1EA",border:"1px solid #E5DFD3",color:"#2C2416"},children:[c.jsx("option",{value:"",children:"Select frequency"}),c.jsx("option",{value:"occasional",children:"Occasional (1-2 drinks/week)"}),c.jsx("option",{value:"moderate",children:"Moderate (3-7 drinks/week)"}),c.jsx("option",{value:"heavy",children:"Heavy (8+ drinks/week)"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium mb-2",style:{color:"#2C2416"},children:[c.jsx(hg,{className:"w-4 h-4"}),"Average sleep hours per night: ",h.sleepHours,"h"]}),c.jsx("input",{type:"range",min:"4",max:"12",value:h.sleepHours,onChange:Q=>f({...h,sleepHours:Q.target.value}),className:"w-full"}),c.jsxs("div",{className:"flex justify-between text-xs mt-1",style:{color:"#5C4F3D"},children:[c.jsx("span",{children:"4h"}),c.jsx("span",{children:"12h"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium mb-2",style:{color:"#2C2416"},children:[c.jsx(eP,{className:"w-4 h-4"}),"Water intake (glasses/day): ",h.waterIntake]}),c.jsx("input",{type:"range",min:"1",max:"15",value:h.waterIntake,onChange:Q=>f({...h,waterIntake:Q.target.value}),className:"w-full"}),c.jsxs("div",{className:"flex justify-between text-xs mt-1",style:{color:"#5C4F3D"},children:[c.jsx("span",{children:"1"}),c.jsx("span",{children:"15"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Stress Level"}),c.jsxs("select",{value:h.stressLevel,onChange:Q=>f({...h,stressLevel:Q.target.value}),className:"w-full rounded-lg py-2 px-3 text-sm",style:{backgroundColor:"#F5F1EA",border:"1px solid #E5DFD3",color:"#2C2416"},children:[c.jsx("option",{value:"low",children:"Low"}),c.jsx("option",{value:"moderate",children:"Moderate"}),c.jsx("option",{value:"high",children:"High"})]})]})]})]}),c.jsxs("div",{className:"bg-white rounded-xl p-4",style:{border:"1px solid #E5DFD3"},children:[c.jsx("h3",{className:"font-semibold mb-4",style:{color:"#2C2416"},children:"Medical History (Optional)"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Chronic Conditions"}),c.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:ee.map(Q=>c.jsx("button",{type:"button",onClick:()=>$("chronicConditions",Q),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${h.chronicConditions.includes(Q)?"text-white":""}`,style:{backgroundColor:h.chronicConditions.includes(Q)?"#8B7355":"#F5F1EA",color:h.chronicConditions.includes(Q)?"white":"#5C4F3D"},children:Q},Q))}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",value:E,onChange:Q=>N(Q.target.value),placeholder:"Add custom condition",className:"flex-1 rounded-lg py-2 px-3 text-sm",style:{backgroundColor:"#F5F1EA",border:"1px solid #E5DFD3",color:"#2C2416"},onKeyPress:Q=>{Q.key==="Enter"&&(Q.preventDefault(),q("chronicConditions",E),N(""))}}),c.jsx("button",{type:"button",onClick:()=>{q("chronicConditions",E),N("")},className:"px-3 py-2 text-white rounded-lg text-sm",style:{backgroundColor:"#8B7355"},children:c.jsx(Qc,{className:"w-4 h-4"})})]}),h.chronicConditions.length>0&&c.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:h.chronicConditions.map(Q=>c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs",style:{backgroundColor:"#F5F1EA",color:"#8B7355"},children:[Q,c.jsx("button",{type:"button",onClick:()=>X("chronicConditions",Q),children:c.jsx(di,{className:"w-3 h-3"})})]},Q))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Allergies"}),c.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:ce.map(Q=>c.jsx("button",{type:"button",onClick:()=>$("allergies",Q),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors",style:{backgroundColor:h.allergies.includes(Q)?"#8B7355":"#F5F1EA",color:h.allergies.includes(Q)?"white":"#5C4F3D"},children:Q},Q))}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",value:O,onChange:Q=>P(Q.target.value),placeholder:"Add custom allergy",className:"flex-1 rounded-lg py-2 px-3 text-sm",style:{backgroundColor:"#F5F1EA",border:"1px solid #E5DFD3",color:"#2C2416"},onKeyPress:Q=>{Q.key==="Enter"&&(Q.preventDefault(),q("allergies",O),P(""))}}),c.jsx("button",{type:"button",onClick:()=>{q("allergies",O),P("")},className:"px-3 py-2 text-white rounded-lg text-sm",style:{backgroundColor:"#8B7355"},children:c.jsx(Qc,{className:"w-4 h-4"})})]}),h.allergies.length>0&&c.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:h.allergies.map(Q=>c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs",style:{backgroundColor:"#F5F1EA",color:"#8B7355"},children:[Q,c.jsx("button",{type:"button",onClick:()=>X("allergies",Q),children:c.jsx(di,{className:"w-3 h-3"})})]},Q))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Current Medications"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",value:I,onChange:Q=>R(Q.target.value),placeholder:"Add medication",className:"flex-1 rounded-lg py-2 px-3 text-sm",style:{backgroundColor:"#F5F1EA",border:"1px solid #E5DFD3",color:"#2C2416"},onKeyPress:Q=>{Q.key==="Enter"&&(Q.preventDefault(),q("currentMedications",I),R(""))}}),c.jsx("button",{type:"button",onClick:()=>{q("currentMedications",I),R("")},className:"px-3 py-2 text-white rounded-lg text-sm",style:{backgroundColor:"#8B7355"},children:c.jsx(Qc,{className:"w-4 h-4"})})]}),h.currentMedications.length>0&&c.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:h.currentMedications.map(Q=>c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs",style:{backgroundColor:"#F5F1EA",color:"#8B7355"},children:[Q,c.jsx("button",{type:"button",onClick:()=>X("currentMedications",Q),children:c.jsx(di,{className:"w-3 h-3"})})]},Q))})]})]})]}),c.jsxs("button",{type:"submit",className:"w-full py-3 text-white font-semibold rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2",style:{backgroundColor:"#8B7355"},children:["Continue ",c.jsx(vo,{className:"w-5 h-5"})]})]})]})})]})}if(n===5){const ce=(()=>{if(!h.targetWeight||!h.weight)return null;const Q=Math.abs(parseFloat(h.targetWeight)-parseFloat(h.weight));return Math.ceil(Q/parseFloat(h.weeklyGoal))})();return c.jsxs("div",{className:"min-h-screen flex",style:{backgroundColor:"#F5F1EA"},children:[c.jsxs("div",{className:"hidden lg:flex lg:w-1/2 relative overflow-hidden",style:{background:"linear-gradient(to bottom right, #8B7355, #A0826D, #8B7355)"},children:[c.jsxs("div",{className:"absolute inset-0",children:[c.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-white/10 rounded-full blur-3xl"}),c.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-white/10 rounded-full blur-3xl"})]}),c.jsxs("div",{className:"relative z-10 flex flex-col justify-center items-center p-12 text-white",children:[c.jsxs("div",{className:"relative w-32 h-32 mb-8",children:[c.jsx("div",{className:"absolute inset-0 bg-white/20 backdrop-blur-xl rounded-full animate-pulse"}),c.jsx("div",{className:"absolute inset-4 bg-white/30 backdrop-blur-xl rounded-full flex items-center justify-center",children:c.jsx(ns,{className:"w-12 h-12"})}),c.jsxs("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:[c.jsx("circle",{cx:"64",cy:"64",r:"60",stroke:"white",strokeOpacity:"0.2",strokeWidth:"4",fill:"none"}),c.jsx("circle",{cx:"64",cy:"64",r:"60",stroke:"white",strokeWidth:"4",fill:"none",strokeDasharray:"377",strokeDashoffset:377-377*.95,className:"transition-all duration-500",strokeLinecap:"round"})]}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c.jsx(tc,{className:"w-16 h-16 text-white/80 animate-pulse"})})]}),c.jsx("h1",{className:"text-4xl font-bold mb-4 text-center",children:"Set Your Goals"}),c.jsx("p",{className:"text-xl text-white/80 text-center max-w-md mb-6",children:"We'll calculate your personalized nutrition plan based on your goals."}),c.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center",children:c.jsx(tc,{className:"w-5 h-5 text-green-600"})}),c.jsx("span",{className:"text-sm font-medium",children:"Step 1"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center",children:c.jsx(tc,{className:"w-5 h-5 text-green-600"})}),c.jsx("span",{className:"text-sm font-medium",children:"Step 2"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center",children:c.jsx(tc,{className:"w-5 h-5 text-green-600"})}),c.jsx("span",{className:"text-sm font-medium",children:"Step 3"})]}),c.jsx("div",{className:"w-12 h-0.5 bg-white"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center",children:c.jsx(tc,{className:"w-5 h-5 text-green-600"})}),c.jsx("span",{className:"text-sm font-medium",children:"Step 4"})]})]}),c.jsxs("div",{className:"mt-6 text-center",children:[c.jsx("p",{className:"text-lg font-bold text-white mb-2",children:" 95% Complete!"}),c.jsx("p",{className:"text-sm text-white/70",children:"One more step to unlock your personalized health plan"})]})]})]}),c.jsx("div",{className:"flex-1 flex items-center justify-center p-8 overflow-y-auto",children:c.jsxs("div",{className:"w-full max-w-md py-8",children:[c.jsxs("button",{onClick:G,className:"flex items-center gap-2 mb-6",style:{color:"#5C4F3D"},children:[c.jsx(Ci,{className:"w-4 h-4"})," Back"]}),c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h2",{className:"text-3xl font-bold mb-2",style:{color:"#2C2416"},children:"Your Nutrition Goals"}),c.jsx("p",{style:{color:"#5C4F3D"},children:"Step 4 of 4 - Almost done!"})]}),c.jsxs("form",{onSubmit:U,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-3",style:{color:"#2C2416"},children:"What's your primary goal?"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("button",{type:"button",onClick:()=>f({...h,nutritionGoal:"weight_loss"}),className:"p-4 rounded-xl border-2 transition-all",style:{borderColor:h.nutritionGoal==="weight_loss"?"#8B7355":"#E5DFD3",backgroundColor:h.nutritionGoal==="weight_loss"?"#F5F1EA":"white"},children:[c.jsx(CT,{className:"w-8 h-8 mx-auto mb-2",style:{color:h.nutritionGoal==="weight_loss"?"#8B7355":"#5C4F3D"}}),c.jsx("p",{className:"text-sm font-medium",style:{color:"#2C2416"},children:"Weight Loss"})]}),c.jsxs("button",{type:"button",onClick:()=>f({...h,nutritionGoal:"weight_gain"}),className:"p-4 rounded-xl border-2 transition-all",style:{borderColor:h.nutritionGoal==="weight_gain"?"#8B7355":"#E5DFD3",backgroundColor:h.nutritionGoal==="weight_gain"?"#F5F1EA":"white"},children:[c.jsx(Or,{className:"w-8 h-8 mx-auto mb-2",style:{color:h.nutritionGoal==="weight_gain"?"#8B7355":"#5C4F3D"}}),c.jsx("p",{className:"text-sm font-medium",style:{color:"#2C2416"},children:"Weight Gain"})]}),c.jsxs("button",{type:"button",onClick:()=>f({...h,nutritionGoal:"muscle_gain"}),className:"p-4 rounded-xl border-2 transition-all",style:{borderColor:h.nutritionGoal==="muscle_gain"?"#8B7355":"#E5DFD3",backgroundColor:h.nutritionGoal==="muscle_gain"?"#F5F1EA":"white"},children:[c.jsx(Of,{className:"w-8 h-8 mx-auto mb-2",style:{color:h.nutritionGoal==="muscle_gain"?"#8B7355":"#5C4F3D"}}),c.jsx("p",{className:"text-sm font-medium",style:{color:"#2C2416"},children:"Muscle Gain"})]}),c.jsxs("button",{type:"button",onClick:()=>f({...h,nutritionGoal:"maintain"}),className:"p-4 rounded-xl border-2 transition-all",style:{borderColor:h.nutritionGoal==="maintain"?"#8B7355":"#E5DFD3",backgroundColor:h.nutritionGoal==="maintain"?"#F5F1EA":"white"},children:[c.jsx(ff,{className:"w-8 h-8 mx-auto mb-2",style:{color:h.nutritionGoal==="maintain"?"#8B7355":"#5C4F3D"}}),c.jsx("p",{className:"text-sm font-medium",style:{color:"#2C2416"},children:"Maintain"})]}),c.jsxs("button",{type:"button",onClick:()=>f({...h,nutritionGoal:"general_health"}),className:"p-4 rounded-xl border-2 transition-all col-span-2",style:{borderColor:h.nutritionGoal==="general_health"?"#8B7355":"#E5DFD3",backgroundColor:h.nutritionGoal==="general_health"?"#F5F1EA":"white"},children:[c.jsx(zn,{className:"w-8 h-8 mx-auto mb-2",style:{color:h.nutritionGoal==="general_health"?"#8B7355":"#5C4F3D"}}),c.jsx("p",{className:"text-sm font-medium",style:{color:"#2C2416"},children:"General Health"})]})]})]}),(h.nutritionGoal==="weight_loss"||h.nutritionGoal==="weight_gain")&&c.jsxs("div",{className:"bg-white rounded-xl p-4 space-y-4",style:{border:"1px solid #E5DFD3"},children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Target Weight (kg)"}),c.jsx("input",{type:"number",value:h.targetWeight,onChange:Q=>f({...h,targetWeight:Q.target.value}),className:"w-full rounded-lg py-2 px-3 text-sm",style:{backgroundColor:"#F5F1EA",border:"1px solid #E5DFD3",color:"#2C2416"},placeholder:h.weight,min:"30",max:"300",step:"0.1"}),c.jsxs("p",{className:"text-xs mt-1",style:{color:"#5C4F3D"},children:["Current: ",h.weight," kg"]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#2C2416"},children:"Weekly Goal"}),c.jsxs("select",{value:h.weeklyGoal,onChange:Q=>f({...h,weeklyGoal:Q.target.value}),className:"w-full rounded-lg py-2 px-3 text-sm",style:{backgroundColor:"#F5F1EA",border:"1px solid #E5DFD3",color:"#2C2416"},children:[c.jsx("option",{value:"0.25",children:"0.25 kg/week (Slow & Steady)"}),c.jsx("option",{value:"0.5",children:"0.5 kg/week (Recommended)"}),c.jsx("option",{value:"1",children:"1 kg/week (Aggressive)"})]})]}),ce&&c.jsx("div",{className:"rounded-lg p-3",style:{backgroundColor:"#F5F1EA"},children:c.jsxs("p",{className:"text-sm",style:{color:"#8B7355"},children:[c.jsx("strong",{children:"Estimated time:"})," ",ce," weeks (",Math.ceil(ce/4)," months)"]})})]}),c.jsx("div",{className:"rounded-xl p-4",style:{backgroundColor:"#F5F1EA",border:"1px solid #E5DFD3"},children:c.jsxs("p",{className:"text-sm",style:{color:"#5C4F3D"},children:[c.jsx("strong",{style:{color:"#2C2416"},children:"What happens next?"})," We'll calculate your personalized daily calorie and macro goals based on your profile and goals. You can adjust these anytime from your nutrition dashboard."]})}),c.jsx("button",{type:"submit",disabled:_,className:"w-full py-3 text-white font-semibold rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2 disabled:opacity-50",style:{backgroundColor:"#8B7355"},children:_?c.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):c.jsxs(c.Fragment,{children:["Create Account & Calculate Goals ",c.jsx(vo,{className:"w-5 h-5"})]})})]})]})})]})}return null}const gRe=["General Physician","Cardiologist","Dermatologist","Endocrinologist","Gastroenterologist","Neurologist","Nutritionist","Oncologist","Orthopedic","Pediatrician","Psychiatrist","Pulmonologist"],_H=[{id:"license",name:"Medical License",description:"Valid medical license certificate"},{id:"degree",name:"Medical Degree",description:"MBBS/MD or equivalent degree certificate"},{id:"id_proof",name:"ID Proof",description:"Government issued ID (Aadhar/Passport)"}];function vRe(){const{registerDoctor:e}=as(),n=Us(),[s,o]=z.useState(!1),[d,h]=z.useState(1),[f,v]=z.useState({name:"",email:"",phone:"",password:"",confirmPassword:"",specialization:"",qualifications:"",experience:"",hospital:"",licenseNumber:"",consultationFee:"",bio:""}),[b,_]=z.useState({}),w=R=>{v({...f,[R.target.name]:R.target.value})},E=(R,O)=>{O&&_(P=>({...P,[R]:{file:O,name:O.name,size:(O.size/1024).toFixed(1)+" KB"}}))},N=R=>{_(O=>{const P={...O};return delete P[R],P})},I=async R=>{var P,M;if(R.preventDefault(),f.password!==f.confirmPassword){et.error("Passwords do not match");return}const O=_H.filter(D=>!b[D.id]);if(O.length>0){et.error(`Please upload: ${O.map(D=>D.name).join(", ")}`);return}o(!0);try{const D=Object.entries(b).map(([U,B])=>({name:B.name,type:U,url:`pending_upload_${U}`}));await e({...f,qualifications:f.qualifications.split(",").map(U=>U.trim()).filter(Boolean),experience:parseInt(f.experience),consultationFee:parseInt(f.consultationFee)||500,documents:D}),et.success("Registration successful! Your profile is pending approval."),n("/doctor/dashboard")}catch(D){et.error(((M=(P=D.response)==null?void 0:P.data)==null?void 0:M.message)||"Registration failed")}finally{o(!1)}};return c.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"w-full max-w-2xl",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsxs(Ct,{to:"/",className:"inline-flex items-center gap-2 mb-6",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center",children:c.jsx(jn,{className:"w-7 h-7 text-white"})}),c.jsx("span",{className:"text-2xl font-bold text-slate-800",children:"HealthAI"})]}),c.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Doctor Registration"}),c.jsx("p",{className:"text-slate-500",children:"Join our platform and connect with patients"})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 shadow-sm",children:[c.jsx("div",{className:"flex items-center justify-center gap-4 mb-8",children:[1,2,3].map(R=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-semibold ${d>=R?"bg-cyan-500 text-white":"bg-slate-200 text-slate-400"}`,children:R}),c.jsx("span",{className:`text-sm hidden sm:block ${d>=R?"text-cyan-600 font-medium":"text-slate-400"}`,children:R===1?"Account":R===2?"Professional":"Documents"}),R<3&&c.jsx("div",{className:`w-8 h-1 rounded ${d>R?"bg-cyan-500":"bg-slate-200"}`})]},R))}),c.jsxs("form",{onSubmit:I,children:[d===1&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Full Name"}),c.jsx("input",{type:"text",name:"name",value:f.name,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none",placeholder:"Dr. John Smith",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Email"}),c.jsx("input",{type:"email",name:"email",value:f.email,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none",placeholder:"doctor@example.com",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Phone"}),c.jsx("input",{type:"tel",name:"phone",value:f.phone,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none",placeholder:"+91 98765 43210"})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Password"}),c.jsx("input",{type:"password",name:"password",value:f.password,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none",placeholder:"",required:!0,minLength:6})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Confirm Password"}),c.jsx("input",{type:"password",name:"confirmPassword",value:f.confirmPassword,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none",placeholder:"",required:!0})]})]}),c.jsx("button",{type:"button",onClick:()=>h(2),className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-xl hover:shadow-lg transition-all mt-4",children:"Continue "})]}),d===2&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Specialization"}),c.jsxs("select",{name:"specialization",value:f.specialization,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 focus:border-cyan-500 focus:outline-none",required:!0,children:[c.jsx("option",{value:"",children:"Select specialization"}),gRe.map(R=>c.jsx("option",{value:R,children:R},R))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Experience (years)"}),c.jsx("input",{type:"number",name:"experience",value:f.experience,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none",placeholder:"5",required:!0,min:0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Medical License Number"}),c.jsx("input",{type:"text",name:"licenseNumber",value:f.licenseNumber,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none",placeholder:"MCI-12345",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Qualifications (comma separated)"}),c.jsx("input",{type:"text",name:"qualifications",value:f.qualifications,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none",placeholder:"MBBS, MD, FRCP"})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Hospital/Clinic"}),c.jsx("input",{type:"text",name:"hospital",value:f.hospital,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none",placeholder:"City Hospital"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Consultation Fee ()"}),c.jsx("input",{type:"number",name:"consultationFee",value:f.consultationFee,onChange:w,className:"w-full bg-white border border-slate-200 rounded-xl py-3 px-4 text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none",placeholder:"500",min:0})]})]}),c.jsxs("div",{className:"flex gap-3 mt-4",children:[c.jsxs("button",{type:"button",onClick:()=>h(1),className:"flex-1 py-3 bg-slate-100 text-slate-700 font-semibold rounded-xl hover:bg-slate-200 transition-all flex items-center justify-center gap-2",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back"]}),c.jsx("button",{type:"button",onClick:()=>h(3),className:"flex-1 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-xl hover:shadow-lg transition-all",children:"Continue "})]})]}),d===3&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-4",children:c.jsxs("p",{className:"text-sm text-amber-800",children:[c.jsx("strong",{children:"Important:"})," Please upload clear copies of the following documents. These will be reviewed by our admin team before your profile is approved."]})}),_H.map(R=>c.jsxs("div",{className:"border border-slate-200 rounded-xl p-4",children:[c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsxs("h4",{className:"font-medium text-slate-800",children:[R.name," ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("p",{className:"text-sm text-slate-500",children:R.description})]}),b[R.id]?c.jsx(rr,{className:"w-5 h-5 text-green-500"}):null]}),b[R.id]?c.jsxs("div",{className:"mt-3 flex items-center justify-between bg-slate-50 rounded-lg p-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Vn,{className:"w-5 h-5 text-cyan-500"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-slate-700",children:b[R.id].name}),c.jsx("p",{className:"text-xs text-slate-500",children:b[R.id].size})]})]}),c.jsx("button",{type:"button",onClick:()=>N(R.id),className:"p-1 text-slate-400 hover:text-red-500",children:c.jsx(di,{className:"w-4 h-4"})})]}):c.jsxs("label",{className:"mt-3 flex items-center justify-center gap-2 p-4 border-2 border-dashed border-slate-200 rounded-lg cursor-pointer hover:border-cyan-500 hover:bg-cyan-50 transition-all",children:[c.jsx(Es,{className:"w-5 h-5 text-slate-400"}),c.jsx("span",{className:"text-sm text-slate-500",children:"Click to upload"}),c.jsx("input",{type:"file",className:"hidden",accept:".pdf,.jpg,.jpeg,.png",onChange:O=>E(R.id,O.target.files[0])})]})]},R.id)),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsxs("button",{type:"button",onClick:()=>h(2),className:"flex-1 py-3 bg-slate-100 text-slate-700 font-semibold rounded-xl hover:bg-slate-200 transition-all flex items-center justify-center gap-2",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back"]}),c.jsx("button",{type:"submit",disabled:s,className:"flex-1 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-xl hover:shadow-lg transition-all disabled:opacity-50",children:s?"Submitting...":"Submit Application"})]})]})]}),c.jsxs("p",{className:"text-center text-slate-500 mt-6",children:["Already have an account? ",c.jsx(Ct,{to:"/login",className:"text-cyan-600 hover:text-cyan-700 font-medium",children:"Sign in"})]})]}),c.jsxs("p",{className:"text-center text-sm text-slate-500 mt-6 flex items-center justify-center gap-2",children:[c.jsx(Yj,{className:"w-4 h-4"}),"Your profile will be reviewed by our admin team before being listed."]})]})})}const nZ=z.createContext(),rZ=()=>{const e=z.useContext(nZ);if(!e)throw new Error("useData must be used within DataProvider");return e},yRe=({children:e})=>{const[n,s]=z.useState(null),[o,d]=z.useState(null),[h,f]=z.useState(null),[v,b]=z.useState({dashboard:!1,wearable:!1,nutrition:!1}),_=z.useCallback(async(R=!1)=>{if(!R){const O=zc.get("dashboard");if(O)return s(O),O}b(O=>({...O,dashboard:!0}));try{const P=(await da.getDashboard()).data;return s(P),zc.set("dashboard",P,10*60*1e3),P}catch(O){throw console.error("Failed to fetch dashboard:",O),O}finally{b(O=>({...O,dashboard:!1}))}},[]),w=z.useCallback(async(R=!1)=>{if(!R){const O=zc.get("wearable");if(O)return d(O),O}b(O=>({...O,wearable:!0}));try{const P=(await $m.getDashboard()).data;return d(P),zc.set("wearable",P,2*60*1e3),P}catch(O){console.error("Failed to fetch wearable:",O);const P={connected:!1};return d(P),P}finally{b(O=>({...O,wearable:!1}))}},[]),E=z.useCallback(async(R,O=!1)=>{var M;const P=`nutrition_${R}`;if(!O){const D=zc.get(P);if(D)return f(D),D}b(D=>({...D,nutrition:!0}));try{const U=((M=(await hNe.getDailySummary(R)).data)==null?void 0:M.summary)||null;return f(U),U&&zc.set(P,U,5*60*1e3),U}catch(D){return console.error("Failed to fetch nutrition:",D),f(null),null}finally{b(D=>({...D,nutrition:!1}))}},[]),N=z.useCallback((R=[])=>{R.length===0?(zc.clear(),s(null),d(null),f(null)):R.forEach(O=>{zc.delete(O),O==="dashboard"&&s(null),O==="wearable"&&d(null),O.startsWith("nutrition_")&&f(null)})},[]),I={dashboardData:n,wearableData:o,nutritionData:h,loading:v,fetchDashboard:_,fetchWearable:w,fetchNutrition:E,invalidateCache:N};return c.jsx(nZ.Provider,{value:I,children:e})};var bRe=Array.isArray,ua=bRe,xRe=typeof Hd=="object"&&Hd&&Hd.Object===Object&&Hd,iZ=xRe,_Re=iZ,ERe=typeof self=="object"&&self&&self.Object===Object&&self,wRe=_Re||ERe||Function("return this")(),il=wRe,SRe=il,TRe=SRe.Symbol,ub=TRe,EH=ub,sZ=Object.prototype,NRe=sZ.hasOwnProperty,CRe=sZ.toString,vv=EH?EH.toStringTag:void 0;function RRe(e){var n=NRe.call(e,vv),s=e[vv];try{e[vv]=void 0;var o=!0}catch{}var d=CRe.call(e);return o&&(n?e[vv]=s:delete e[vv]),d}var ARe=RRe,IRe=Object.prototype,ORe=IRe.toString;function PRe(e){return ORe.call(e)}var kRe=PRe,wH=ub,jRe=ARe,DRe=kRe,LRe="[object Null]",MRe="[object Undefined]",SH=wH?wH.toStringTag:void 0;function URe(e){return e==null?e===void 0?MRe:LRe:SH&&SH in Object(e)?jRe(e):DRe(e)}var ed=URe;function FRe(e){return e!=null&&typeof e=="object"}var td=FRe,VRe=ed,BRe=td,GRe="[object Symbol]";function WRe(e){return typeof e=="symbol"||BRe(e)&&VRe(e)==GRe}var gg=WRe,$Re=ua,zRe=gg,HRe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,KRe=/^\w*$/;function YRe(e,n){if($Re(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||zRe(e)?!0:KRe.test(e)||!HRe.test(e)||n!=null&&e in Object(n)}var Jj=YRe;function qRe(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}var _u=qRe;const vg=ur(_u);var XRe=ed,JRe=_u,QRe="[object AsyncFunction]",ZRe="[object Function]",eAe="[object GeneratorFunction]",tAe="[object Proxy]";function nAe(e){if(!JRe(e))return!1;var n=XRe(e);return n==ZRe||n==eAe||n==QRe||n==tAe}var Qj=nAe;const mn=ur(Qj);var rAe=il,iAe=rAe["__core-js_shared__"],sAe=iAe,fO=sAe,TH=function(){var e=/[^.]+$/.exec(fO&&fO.keys&&fO.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function aAe(e){return!!TH&&TH in e}var oAe=aAe,cAe=Function.prototype,lAe=cAe.toString;function dAe(e){if(e!=null){try{return lAe.call(e)}catch{}try{return e+""}catch{}}return""}var aZ=dAe,uAe=Qj,hAe=oAe,pAe=_u,mAe=aZ,fAe=/[\\^$.*+?()[\]{}|]/g,gAe=/^\[object .+?Constructor\]$/,vAe=Function.prototype,yAe=Object.prototype,bAe=vAe.toString,xAe=yAe.hasOwnProperty,_Ae=RegExp("^"+bAe.call(xAe).replace(fAe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function EAe(e){if(!pAe(e)||hAe(e))return!1;var n=uAe(e)?_Ae:gAe;return n.test(mAe(e))}var wAe=EAe;function SAe(e,n){return e==null?void 0:e[n]}var TAe=SAe,NAe=wAe,CAe=TAe;function RAe(e,n){var s=CAe(e,n);return NAe(s)?s:void 0}var cp=RAe,AAe=cp,IAe=AAe(Object,"create"),RT=IAe,NH=RT;function OAe(){this.__data__=NH?NH(null):{},this.size=0}var PAe=OAe;function kAe(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}var jAe=kAe,DAe=RT,LAe="__lodash_hash_undefined__",MAe=Object.prototype,UAe=MAe.hasOwnProperty;function FAe(e){var n=this.__data__;if(DAe){var s=n[e];return s===LAe?void 0:s}return UAe.call(n,e)?n[e]:void 0}var VAe=FAe,BAe=RT,GAe=Object.prototype,WAe=GAe.hasOwnProperty;function $Ae(e){var n=this.__data__;return BAe?n[e]!==void 0:WAe.call(n,e)}var zAe=$Ae,HAe=RT,KAe="__lodash_hash_undefined__";function YAe(e,n){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=HAe&&n===void 0?KAe:n,this}var qAe=YAe,XAe=PAe,JAe=jAe,QAe=VAe,ZAe=zAe,e1e=qAe;function yg(e){var n=-1,s=e==null?0:e.length;for(this.clear();++n<s;){var o=e[n];this.set(o[0],o[1])}}yg.prototype.clear=XAe;yg.prototype.delete=JAe;yg.prototype.get=QAe;yg.prototype.has=ZAe;yg.prototype.set=e1e;var t1e=yg;function n1e(){this.__data__=[],this.size=0}var r1e=n1e;function i1e(e,n){return e===n||e!==e&&n!==n}var Zj=i1e,s1e=Zj;function a1e(e,n){for(var s=e.length;s--;)if(s1e(e[s][0],n))return s;return-1}var AT=a1e,o1e=AT,c1e=Array.prototype,l1e=c1e.splice;function d1e(e){var n=this.__data__,s=o1e(n,e);if(s<0)return!1;var o=n.length-1;return s==o?n.pop():l1e.call(n,s,1),--this.size,!0}var u1e=d1e,h1e=AT;function p1e(e){var n=this.__data__,s=h1e(n,e);return s<0?void 0:n[s][1]}var m1e=p1e,f1e=AT;function g1e(e){return f1e(this.__data__,e)>-1}var v1e=g1e,y1e=AT;function b1e(e,n){var s=this.__data__,o=y1e(s,e);return o<0?(++this.size,s.push([e,n])):s[o][1]=n,this}var x1e=b1e,_1e=r1e,E1e=u1e,w1e=m1e,S1e=v1e,T1e=x1e;function bg(e){var n=-1,s=e==null?0:e.length;for(this.clear();++n<s;){var o=e[n];this.set(o[0],o[1])}}bg.prototype.clear=_1e;bg.prototype.delete=E1e;bg.prototype.get=w1e;bg.prototype.has=S1e;bg.prototype.set=T1e;var IT=bg,N1e=cp,C1e=il,R1e=N1e(C1e,"Map"),eD=R1e,CH=t1e,A1e=IT,I1e=eD;function O1e(){this.size=0,this.__data__={hash:new CH,map:new(I1e||A1e),string:new CH}}var P1e=O1e;function k1e(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}var j1e=k1e,D1e=j1e;function L1e(e,n){var s=e.__data__;return D1e(n)?s[typeof n=="string"?"string":"hash"]:s.map}var OT=L1e,M1e=OT;function U1e(e){var n=M1e(this,e).delete(e);return this.size-=n?1:0,n}var F1e=U1e,V1e=OT;function B1e(e){return V1e(this,e).get(e)}var G1e=B1e,W1e=OT;function $1e(e){return W1e(this,e).has(e)}var z1e=$1e,H1e=OT;function K1e(e,n){var s=H1e(this,e),o=s.size;return s.set(e,n),this.size+=s.size==o?0:1,this}var Y1e=K1e,q1e=P1e,X1e=F1e,J1e=G1e,Q1e=z1e,Z1e=Y1e;function xg(e){var n=-1,s=e==null?0:e.length;for(this.clear();++n<s;){var o=e[n];this.set(o[0],o[1])}}xg.prototype.clear=q1e;xg.prototype.delete=X1e;xg.prototype.get=J1e;xg.prototype.has=Q1e;xg.prototype.set=Z1e;var tD=xg,oZ=tD,eIe="Expected a function";function nD(e,n){if(typeof e!="function"||n!=null&&typeof n!="function")throw new TypeError(eIe);var s=function(){var o=arguments,d=n?n.apply(this,o):o[0],h=s.cache;if(h.has(d))return h.get(d);var f=e.apply(this,o);return s.cache=h.set(d,f)||h,f};return s.cache=new(nD.Cache||oZ),s}nD.Cache=oZ;var cZ=nD;const tIe=ur(cZ);var nIe=cZ,rIe=500;function iIe(e){var n=nIe(e,function(o){return s.size===rIe&&s.clear(),o}),s=n.cache;return n}var sIe=iIe,aIe=sIe,oIe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,cIe=/\\(\\)?/g,lIe=aIe(function(e){var n=[];return e.charCodeAt(0)===46&&n.push(""),e.replace(oIe,function(s,o,d,h){n.push(d?h.replace(cIe,"$1"):o||s)}),n}),dIe=lIe;function uIe(e,n){for(var s=-1,o=e==null?0:e.length,d=Array(o);++s<o;)d[s]=n(e[s],s,e);return d}var rD=uIe,RH=ub,hIe=rD,pIe=ua,mIe=gg,AH=RH?RH.prototype:void 0,IH=AH?AH.toString:void 0;function lZ(e){if(typeof e=="string")return e;if(pIe(e))return hIe(e,lZ)+"";if(mIe(e))return IH?IH.call(e):"";var n=e+"";return n=="0"&&1/e==-1/0?"-0":n}var fIe=lZ,gIe=fIe;function vIe(e){return e==null?"":gIe(e)}var dZ=vIe,yIe=ua,bIe=Jj,xIe=dIe,_Ie=dZ;function EIe(e,n){return yIe(e)?e:bIe(e,n)?[e]:xIe(_Ie(e))}var uZ=EIe,wIe=gg;function SIe(e){if(typeof e=="string"||wIe(e))return e;var n=e+"";return n=="0"&&1/e==-1/0?"-0":n}var PT=SIe,TIe=uZ,NIe=PT;function CIe(e,n){n=TIe(n,e);for(var s=0,o=n.length;e!=null&&s<o;)e=e[NIe(n[s++])];return s&&s==o?e:void 0}var iD=CIe,RIe=iD;function AIe(e,n,s){var o=e==null?void 0:RIe(e,n);return o===void 0?s:o}var hZ=AIe;const _o=ur(hZ);function IIe(e){return e==null}var OIe=IIe;const En=ur(OIe);var PIe=ed,kIe=ua,jIe=td,DIe="[object String]";function LIe(e){return typeof e=="string"||!kIe(e)&&jIe(e)&&PIe(e)==DIe}var MIe=LIe;const ep=ur(MIe);var pZ={exports:{}},sr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sD=Symbol.for("react.element"),aD=Symbol.for("react.portal"),kT=Symbol.for("react.fragment"),jT=Symbol.for("react.strict_mode"),DT=Symbol.for("react.profiler"),LT=Symbol.for("react.provider"),MT=Symbol.for("react.context"),UIe=Symbol.for("react.server_context"),UT=Symbol.for("react.forward_ref"),FT=Symbol.for("react.suspense"),VT=Symbol.for("react.suspense_list"),BT=Symbol.for("react.memo"),GT=Symbol.for("react.lazy"),FIe=Symbol.for("react.offscreen"),mZ;mZ=Symbol.for("react.module.reference");function Co(e){if(typeof e=="object"&&e!==null){var n=e.$$typeof;switch(n){case sD:switch(e=e.type,e){case kT:case DT:case jT:case FT:case VT:return e;default:switch(e=e&&e.$$typeof,e){case UIe:case MT:case UT:case GT:case BT:case LT:return e;default:return n}}case aD:return n}}}sr.ContextConsumer=MT;sr.ContextProvider=LT;sr.Element=sD;sr.ForwardRef=UT;sr.Fragment=kT;sr.Lazy=GT;sr.Memo=BT;sr.Portal=aD;sr.Profiler=DT;sr.StrictMode=jT;sr.Suspense=FT;sr.SuspenseList=VT;sr.isAsyncMode=function(){return!1};sr.isConcurrentMode=function(){return!1};sr.isContextConsumer=function(e){return Co(e)===MT};sr.isContextProvider=function(e){return Co(e)===LT};sr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===sD};sr.isForwardRef=function(e){return Co(e)===UT};sr.isFragment=function(e){return Co(e)===kT};sr.isLazy=function(e){return Co(e)===GT};sr.isMemo=function(e){return Co(e)===BT};sr.isPortal=function(e){return Co(e)===aD};sr.isProfiler=function(e){return Co(e)===DT};sr.isStrictMode=function(e){return Co(e)===jT};sr.isSuspense=function(e){return Co(e)===FT};sr.isSuspenseList=function(e){return Co(e)===VT};sr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===kT||e===DT||e===jT||e===FT||e===VT||e===FIe||typeof e=="object"&&e!==null&&(e.$$typeof===GT||e.$$typeof===BT||e.$$typeof===LT||e.$$typeof===MT||e.$$typeof===UT||e.$$typeof===mZ||e.getModuleId!==void 0)};sr.typeOf=Co;pZ.exports=sr;var VIe=pZ.exports,BIe=ed,GIe=td,WIe="[object Number]";function $Ie(e){return typeof e=="number"||GIe(e)&&BIe(e)==WIe}var fZ=$Ie;const zIe=ur(fZ);var HIe=fZ;function KIe(e){return HIe(e)&&e!=+e}var YIe=KIe;const _g=ur(YIe);var dc=function(n){return n===0?0:n>0?1:-1},Dh=function(n){return ep(n)&&n.indexOf("%")===n.length-1},pt=function(n){return zIe(n)&&!_g(n)},qIe=function(n){return En(n)},Ri=function(n){return pt(n)||ep(n)},XIe=0,Eg=function(n){var s=++XIe;return"".concat(n||"").concat(s)},tp=function(n,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!pt(n)&&!ep(n))return o;var h;if(Dh(n)){var f=n.indexOf("%");h=s*parseFloat(n.slice(0,f))/100}else h=+n;return _g(h)&&(h=o),d&&h>s&&(h=s),h},zd=function(n){if(!n)return null;var s=Object.keys(n);return s&&s.length?n[s[0]]:null},JIe=function(n){if(!Array.isArray(n))return!1;for(var s=n.length,o={},d=0;d<s;d++)if(!o[n[d]])o[n[d]]=!0;else return!0;return!1},ts=function(n,s){return pt(n)&&pt(s)?function(o){return n+o*(s-n)}:function(){return s}};function Qw(e,n,s){return!e||!e.length?null:e.find(function(o){return o&&(typeof n=="function"?n(o):_o(o,n))===s})}var QIe=function(n,s){return pt(n)&&pt(s)?n-s:ep(n)&&ep(s)?n.localeCompare(s):n instanceof Date&&s instanceof Date?n.getTime()-s.getTime():String(n).localeCompare(String(s))};function gf(e,n){for(var s in e)if({}.hasOwnProperty.call(e,s)&&(!{}.hasOwnProperty.call(n,s)||e[s]!==n[s]))return!1;for(var o in n)if({}.hasOwnProperty.call(n,o)&&!{}.hasOwnProperty.call(e,o))return!1;return!0}function uP(e){"@babel/helpers - typeof";return uP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},uP(e)}var ZIe=["viewBox","children"],eOe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],OH=["points","pathLength"],gO={svg:ZIe,polygon:OH,polyline:OH},oD=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Zw=function(n,s){if(!n||typeof n=="function"||typeof n=="boolean")return null;var o=n;if(z.isValidElement(n)&&(o=n.props),!vg(o))return null;var d={};return Object.keys(o).forEach(function(h){oD.includes(h)&&(d[h]=s||function(f){return o[h](o,f)})}),d},tOe=function(n,s,o){return function(d){return n(s,o,d),null}},eS=function(n,s,o){if(!vg(n)||uP(n)!=="object")return null;var d=null;return Object.keys(n).forEach(function(h){var f=n[h];oD.includes(h)&&typeof f=="function"&&(d||(d={}),d[h]=tOe(f,s,o))}),d},nOe=["children"],rOe=["children"];function PH(e,n){if(e==null)return{};var s=iOe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function iOe(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function hP(e){"@babel/helpers - typeof";return hP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},hP(e)}var kH={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Ul=function(n){return typeof n=="string"?n:n?n.displayName||n.name||"Component":""},jH=null,vO=null,cD=function e(n){if(n===jH&&Array.isArray(vO))return vO;var s=[];return z.Children.forEach(n,function(o){En(o)||(VIe.isFragment(o)?s=s.concat(e(o.props.children)):s.push(o))}),vO=s,jH=n,s};function Eo(e,n){var s=[],o=[];return Array.isArray(n)?o=n.map(function(d){return Ul(d)}):o=[Ul(n)],cD(e).forEach(function(d){var h=_o(d,"type.displayName")||_o(d,"type.name");o.indexOf(h)!==-1&&s.push(d)}),s}function Ra(e,n){var s=Eo(e,n);return s&&s[0]}var DH=function(n){if(!n||!n.props)return!1;var s=n.props,o=s.width,d=s.height;return!(!pt(o)||o<=0||!pt(d)||d<=0)},sOe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],aOe=function(n){return n&&n.type&&ep(n.type)&&sOe.indexOf(n.type)>=0},gZ=function(n){return n&&hP(n)==="object"&&"clipDot"in n},oOe=function(n,s,o,d){var h,f=(h=gO==null?void 0:gO[d])!==null&&h!==void 0?h:[];return s.startsWith("data-")||!mn(n)&&(d&&f.includes(s)||eOe.includes(s))||o&&oD.includes(s)},bn=function(n,s,o){if(!n||typeof n=="function"||typeof n=="boolean")return null;var d=n;if(z.isValidElement(n)&&(d=n.props),!vg(d))return null;var h={};return Object.keys(d).forEach(function(f){var v;oOe((v=d)===null||v===void 0?void 0:v[f],f,s,o)&&(h[f]=d[f])}),h},pP=function e(n,s){if(n===s)return!0;var o=z.Children.count(n);if(o!==z.Children.count(s))return!1;if(o===0)return!0;if(o===1)return LH(Array.isArray(n)?n[0]:n,Array.isArray(s)?s[0]:s);for(var d=0;d<o;d++){var h=n[d],f=s[d];if(Array.isArray(h)||Array.isArray(f)){if(!e(h,f))return!1}else if(!LH(h,f))return!1}return!0},LH=function(n,s){if(En(n)&&En(s))return!0;if(!En(n)&&!En(s)){var o=n.props||{},d=o.children,h=PH(o,nOe),f=s.props||{},v=f.children,b=PH(f,rOe);return d&&v?gf(h,b)&&pP(d,v):!d&&!v?gf(h,b):!1}return!1},MH=function(n,s){var o=[],d={};return cD(n).forEach(function(h,f){if(aOe(h))o.push(h);else if(h){var v=Ul(h.type),b=s[v]||{},_=b.handler,w=b.once;if(_&&(!w||!d[v])){var E=_(h,v,f);o.push(E),d[v]=!0}}}),o},cOe=function(n){var s=n&&n.type;return s&&kH[s]?kH[s]:null},lOe=function(n,s){return cD(s).indexOf(n)},dOe=["children","width","height","viewBox","className","style","title","desc"];function mP(){return mP=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},mP.apply(this,arguments)}function uOe(e,n){if(e==null)return{};var s=hOe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function hOe(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function fP(e){var n=e.children,s=e.width,o=e.height,d=e.viewBox,h=e.className,f=e.style,v=e.title,b=e.desc,_=uOe(e,dOe),w=d||{width:s,height:o,x:0,y:0},E=In("recharts-surface",h);return ye.createElement("svg",mP({},bn(_,!0,"svg"),{className:E,width:s,height:o,style:f,viewBox:"".concat(w.x," ").concat(w.y," ").concat(w.width," ").concat(w.height)}),ye.createElement("title",null,v),ye.createElement("desc",null,b),n)}var pOe=["children","className"];function gP(){return gP=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},gP.apply(this,arguments)}function mOe(e,n){if(e==null)return{};var s=fOe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function fOe(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}var xr=ye.forwardRef(function(e,n){var s=e.children,o=e.className,d=mOe(e,pOe),h=In("recharts-layer",o);return ye.createElement("g",gP({className:h},bn(d,!0),{ref:n}),s)}),Fl=function(n,s){for(var o=arguments.length,d=new Array(o>2?o-2:0),h=2;h<o;h++)d[h-2]=arguments[h]};function gOe(e,n,s){var o=-1,d=e.length;n<0&&(n=-n>d?0:d+n),s=s>d?d:s,s<0&&(s+=d),d=n>s?0:s-n>>>0,n>>>=0;for(var h=Array(d);++o<d;)h[o]=e[o+n];return h}var vOe=gOe,yOe=vOe;function bOe(e,n,s){var o=e.length;return s=s===void 0?o:s,!n&&s>=o?e:yOe(e,n,s)}var xOe=bOe,_Oe="\\ud800-\\udfff",EOe="\\u0300-\\u036f",wOe="\\ufe20-\\ufe2f",SOe="\\u20d0-\\u20ff",TOe=EOe+wOe+SOe,NOe="\\ufe0e\\ufe0f",COe="\\u200d",ROe=RegExp("["+COe+_Oe+TOe+NOe+"]");function AOe(e){return ROe.test(e)}var vZ=AOe;function IOe(e){return e.split("")}var OOe=IOe,yZ="\\ud800-\\udfff",POe="\\u0300-\\u036f",kOe="\\ufe20-\\ufe2f",jOe="\\u20d0-\\u20ff",DOe=POe+kOe+jOe,LOe="\\ufe0e\\ufe0f",MOe="["+yZ+"]",vP="["+DOe+"]",yP="\\ud83c[\\udffb-\\udfff]",UOe="(?:"+vP+"|"+yP+")",bZ="[^"+yZ+"]",xZ="(?:\\ud83c[\\udde6-\\uddff]){2}",_Z="[\\ud800-\\udbff][\\udc00-\\udfff]",FOe="\\u200d",EZ=UOe+"?",wZ="["+LOe+"]?",VOe="(?:"+FOe+"(?:"+[bZ,xZ,_Z].join("|")+")"+wZ+EZ+")*",BOe=wZ+EZ+VOe,GOe="(?:"+[bZ+vP+"?",vP,xZ,_Z,MOe].join("|")+")",WOe=RegExp(yP+"(?="+yP+")|"+GOe+BOe,"g");function $Oe(e){return e.match(WOe)||[]}var zOe=$Oe,HOe=OOe,KOe=vZ,YOe=zOe;function qOe(e){return KOe(e)?YOe(e):HOe(e)}var XOe=qOe,JOe=xOe,QOe=vZ,ZOe=XOe,e2e=dZ;function t2e(e){return function(n){n=e2e(n);var s=QOe(n)?ZOe(n):void 0,o=s?s[0]:n.charAt(0),d=s?JOe(s,1).join(""):n.slice(1);return o[e]()+d}}var n2e=t2e,r2e=n2e,i2e=r2e("toUpperCase"),s2e=i2e;const WT=ur(s2e);function yr(e){return function(){return e}}const SZ=Math.cos,tS=Math.sin,gc=Math.sqrt,nS=Math.PI,$T=2*nS,bP=Math.PI,xP=2*bP,Th=1e-6,a2e=xP-Th;function TZ(e){this._+=e[0];for(let n=1,s=e.length;n<s;++n)this._+=arguments[n]+e[n]}function o2e(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return TZ;const s=10**n;return function(o){this._+=o[0];for(let d=1,h=o.length;d<h;++d)this._+=Math.round(arguments[d]*s)/s+o[d]}}class c2e{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?TZ:o2e(n)}moveTo(n,s){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,s){this._append`L${this._x1=+n},${this._y1=+s}`}quadraticCurveTo(n,s,o,d){this._append`Q${+n},${+s},${this._x1=+o},${this._y1=+d}`}bezierCurveTo(n,s,o,d,h,f){this._append`C${+n},${+s},${+o},${+d},${this._x1=+h},${this._y1=+f}`}arcTo(n,s,o,d,h){if(n=+n,s=+s,o=+o,d=+d,h=+h,h<0)throw new Error(`negative radius: ${h}`);let f=this._x1,v=this._y1,b=o-n,_=d-s,w=f-n,E=v-s,N=w*w+E*E;if(this._x1===null)this._append`M${this._x1=n},${this._y1=s}`;else if(N>Th)if(!(Math.abs(E*b-_*w)>Th)||!h)this._append`L${this._x1=n},${this._y1=s}`;else{let I=o-f,R=d-v,O=b*b+_*_,P=I*I+R*R,M=Math.sqrt(O),D=Math.sqrt(N),U=h*Math.tan((bP-Math.acos((O+N-P)/(2*M*D)))/2),B=U/D,G=U/M;Math.abs(B-1)>Th&&this._append`L${n+B*w},${s+B*E}`,this._append`A${h},${h},0,0,${+(E*I>w*R)},${this._x1=n+G*b},${this._y1=s+G*_}`}}arc(n,s,o,d,h,f){if(n=+n,s=+s,o=+o,f=!!f,o<0)throw new Error(`negative radius: ${o}`);let v=o*Math.cos(d),b=o*Math.sin(d),_=n+v,w=s+b,E=1^f,N=f?d-h:h-d;this._x1===null?this._append`M${_},${w}`:(Math.abs(this._x1-_)>Th||Math.abs(this._y1-w)>Th)&&this._append`L${_},${w}`,o&&(N<0&&(N=N%xP+xP),N>a2e?this._append`A${o},${o},0,1,${E},${n-v},${s-b}A${o},${o},0,1,${E},${this._x1=_},${this._y1=w}`:N>Th&&this._append`A${o},${o},0,${+(N>=bP)},${E},${this._x1=n+o*Math.cos(h)},${this._y1=s+o*Math.sin(h)}`)}rect(n,s,o,d){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+s}h${o=+o}v${+d}h${-o}Z`}toString(){return this._}}function lD(e){let n=3;return e.digits=function(s){if(!arguments.length)return n;if(s==null)n=null;else{const o=Math.floor(s);if(!(o>=0))throw new RangeError(`invalid digits: ${s}`);n=o}return e},()=>new c2e(n)}function dD(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function NZ(e){this._context=e}NZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function zT(e){return new NZ(e)}function CZ(e){return e[0]}function RZ(e){return e[1]}function AZ(e,n){var s=yr(!0),o=null,d=zT,h=null,f=lD(v);e=typeof e=="function"?e:e===void 0?CZ:yr(e),n=typeof n=="function"?n:n===void 0?RZ:yr(n);function v(b){var _,w=(b=dD(b)).length,E,N=!1,I;for(o==null&&(h=d(I=f())),_=0;_<=w;++_)!(_<w&&s(E=b[_],_,b))===N&&((N=!N)?h.lineStart():h.lineEnd()),N&&h.point(+e(E,_,b),+n(E,_,b));if(I)return h=null,I+""||null}return v.x=function(b){return arguments.length?(e=typeof b=="function"?b:yr(+b),v):e},v.y=function(b){return arguments.length?(n=typeof b=="function"?b:yr(+b),v):n},v.defined=function(b){return arguments.length?(s=typeof b=="function"?b:yr(!!b),v):s},v.curve=function(b){return arguments.length?(d=b,o!=null&&(h=d(o)),v):d},v.context=function(b){return arguments.length?(b==null?o=h=null:h=d(o=b),v):o},v}function VE(e,n,s){var o=null,d=yr(!0),h=null,f=zT,v=null,b=lD(_);e=typeof e=="function"?e:e===void 0?CZ:yr(+e),n=typeof n=="function"?n:yr(n===void 0?0:+n),s=typeof s=="function"?s:s===void 0?RZ:yr(+s);function _(E){var N,I,R,O=(E=dD(E)).length,P,M=!1,D,U=new Array(O),B=new Array(O);for(h==null&&(v=f(D=b())),N=0;N<=O;++N){if(!(N<O&&d(P=E[N],N,E))===M)if(M=!M)I=N,v.areaStart(),v.lineStart();else{for(v.lineEnd(),v.lineStart(),R=N-1;R>=I;--R)v.point(U[R],B[R]);v.lineEnd(),v.areaEnd()}M&&(U[N]=+e(P,N,E),B[N]=+n(P,N,E),v.point(o?+o(P,N,E):U[N],s?+s(P,N,E):B[N]))}if(D)return v=null,D+""||null}function w(){return AZ().defined(d).curve(f).context(h)}return _.x=function(E){return arguments.length?(e=typeof E=="function"?E:yr(+E),o=null,_):e},_.x0=function(E){return arguments.length?(e=typeof E=="function"?E:yr(+E),_):e},_.x1=function(E){return arguments.length?(o=E==null?null:typeof E=="function"?E:yr(+E),_):o},_.y=function(E){return arguments.length?(n=typeof E=="function"?E:yr(+E),s=null,_):n},_.y0=function(E){return arguments.length?(n=typeof E=="function"?E:yr(+E),_):n},_.y1=function(E){return arguments.length?(s=E==null?null:typeof E=="function"?E:yr(+E),_):s},_.lineX0=_.lineY0=function(){return w().x(e).y(n)},_.lineY1=function(){return w().x(e).y(s)},_.lineX1=function(){return w().x(o).y(n)},_.defined=function(E){return arguments.length?(d=typeof E=="function"?E:yr(!!E),_):d},_.curve=function(E){return arguments.length?(f=E,h!=null&&(v=f(h)),_):f},_.context=function(E){return arguments.length?(E==null?h=v=null:v=f(h=E),_):h},_}class IZ{constructor(n,s){this._context=n,this._x=s}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(n,s){switch(n=+n,s=+s,this._point){case 0:{this._point=1,this._line?this._context.lineTo(n,s):this._context.moveTo(n,s);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+n)/2,this._y0,this._x0,s,n,s):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+s)/2,n,this._y0,n,s);break}}this._x0=n,this._y0=s}}function l2e(e){return new IZ(e,!0)}function d2e(e){return new IZ(e,!1)}const uD={draw(e,n){const s=gc(n/nS);e.moveTo(s,0),e.arc(0,0,s,0,$T)}},u2e={draw(e,n){const s=gc(n/5)/2;e.moveTo(-3*s,-s),e.lineTo(-s,-s),e.lineTo(-s,-3*s),e.lineTo(s,-3*s),e.lineTo(s,-s),e.lineTo(3*s,-s),e.lineTo(3*s,s),e.lineTo(s,s),e.lineTo(s,3*s),e.lineTo(-s,3*s),e.lineTo(-s,s),e.lineTo(-3*s,s),e.closePath()}},OZ=gc(1/3),h2e=OZ*2,p2e={draw(e,n){const s=gc(n/h2e),o=s*OZ;e.moveTo(0,-s),e.lineTo(o,0),e.lineTo(0,s),e.lineTo(-o,0),e.closePath()}},m2e={draw(e,n){const s=gc(n),o=-s/2;e.rect(o,o,s,s)}},f2e=.8908130915292852,PZ=tS(nS/10)/tS(7*nS/10),g2e=tS($T/10)*PZ,v2e=-SZ($T/10)*PZ,y2e={draw(e,n){const s=gc(n*f2e),o=g2e*s,d=v2e*s;e.moveTo(0,-s),e.lineTo(o,d);for(let h=1;h<5;++h){const f=$T*h/5,v=SZ(f),b=tS(f);e.lineTo(b*s,-v*s),e.lineTo(v*o-b*d,b*o+v*d)}e.closePath()}},yO=gc(3),b2e={draw(e,n){const s=-gc(n/(yO*3));e.moveTo(0,s*2),e.lineTo(-yO*s,-s),e.lineTo(yO*s,-s),e.closePath()}},lo=-.5,uo=gc(3)/2,_P=1/gc(12),x2e=(_P/2+1)*3,_2e={draw(e,n){const s=gc(n/x2e),o=s/2,d=s*_P,h=o,f=s*_P+s,v=-h,b=f;e.moveTo(o,d),e.lineTo(h,f),e.lineTo(v,b),e.lineTo(lo*o-uo*d,uo*o+lo*d),e.lineTo(lo*h-uo*f,uo*h+lo*f),e.lineTo(lo*v-uo*b,uo*v+lo*b),e.lineTo(lo*o+uo*d,lo*d-uo*o),e.lineTo(lo*h+uo*f,lo*f-uo*h),e.lineTo(lo*v+uo*b,lo*b-uo*v),e.closePath()}};function E2e(e,n){let s=null,o=lD(d);e=typeof e=="function"?e:yr(e||uD),n=typeof n=="function"?n:yr(n===void 0?64:+n);function d(){let h;if(s||(s=h=o()),e.apply(this,arguments).draw(s,+n.apply(this,arguments)),h)return s=null,h+""||null}return d.type=function(h){return arguments.length?(e=typeof h=="function"?h:yr(h),d):e},d.size=function(h){return arguments.length?(n=typeof h=="function"?h:yr(+h),d):n},d.context=function(h){return arguments.length?(s=h??null,d):s},d}function rS(){}function iS(e,n,s){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+n)/6,(e._y0+4*e._y1+s)/6)}function kZ(e){this._context=e}kZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:iS(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:iS(this,e,n);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}};function w2e(e){return new kZ(e)}function jZ(e){this._context=e}jZ.prototype={areaStart:rS,areaEnd:rS,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._x2=e,this._y2=n;break;case 1:this._point=2,this._x3=e,this._y3=n;break;case 2:this._point=3,this._x4=e,this._y4=n,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+n)/6);break;default:iS(this,e,n);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}};function S2e(e){return new jZ(e)}function DZ(e){this._context=e}DZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var s=(this._x0+4*this._x1+e)/6,o=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(s,o):this._context.moveTo(s,o);break;case 3:this._point=4;default:iS(this,e,n);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}};function T2e(e){return new DZ(e)}function LZ(e){this._context=e}LZ.prototype={areaStart:rS,areaEnd:rS,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}};function N2e(e){return new LZ(e)}function UH(e){return e<0?-1:1}function FH(e,n,s){var o=e._x1-e._x0,d=n-e._x1,h=(e._y1-e._y0)/(o||d<0&&-0),f=(s-e._y1)/(d||o<0&&-0),v=(h*d+f*o)/(o+d);return(UH(h)+UH(f))*Math.min(Math.abs(h),Math.abs(f),.5*Math.abs(v))||0}function VH(e,n){var s=e._x1-e._x0;return s?(3*(e._y1-e._y0)/s-n)/2:n}function bO(e,n,s){var o=e._x0,d=e._y0,h=e._x1,f=e._y1,v=(h-o)/3;e._context.bezierCurveTo(o+v,d+v*n,h-v,f-v*s,h,f)}function sS(e){this._context=e}sS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:bO(this,this._t0,VH(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){var s=NaN;if(e=+e,n=+n,!(e===this._x1&&n===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3,bO(this,VH(this,s=FH(this,e,n)),s);break;default:bO(this,this._t0,s=FH(this,e,n));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n,this._t0=s}}};function MZ(e){this._context=new UZ(e)}(MZ.prototype=Object.create(sS.prototype)).point=function(e,n){sS.prototype.point.call(this,n,e)};function UZ(e){this._context=e}UZ.prototype={moveTo:function(e,n){this._context.moveTo(n,e)},closePath:function(){this._context.closePath()},lineTo:function(e,n){this._context.lineTo(n,e)},bezierCurveTo:function(e,n,s,o,d,h){this._context.bezierCurveTo(n,e,o,s,h,d)}};function C2e(e){return new sS(e)}function R2e(e){return new MZ(e)}function FZ(e){this._context=e}FZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,n=this._y,s=e.length;if(s)if(this._line?this._context.lineTo(e[0],n[0]):this._context.moveTo(e[0],n[0]),s===2)this._context.lineTo(e[1],n[1]);else for(var o=BH(e),d=BH(n),h=0,f=1;f<s;++h,++f)this._context.bezierCurveTo(o[0][h],d[0][h],o[1][h],d[1][h],e[f],n[f]);(this._line||this._line!==0&&s===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,n){this._x.push(+e),this._y.push(+n)}};function BH(e){var n,s=e.length-1,o,d=new Array(s),h=new Array(s),f=new Array(s);for(d[0]=0,h[0]=2,f[0]=e[0]+2*e[1],n=1;n<s-1;++n)d[n]=1,h[n]=4,f[n]=4*e[n]+2*e[n+1];for(d[s-1]=2,h[s-1]=7,f[s-1]=8*e[s-1]+e[s],n=1;n<s;++n)o=d[n]/h[n-1],h[n]-=o,f[n]-=o*f[n-1];for(d[s-1]=f[s-1]/h[s-1],n=s-2;n>=0;--n)d[n]=(f[n]-d[n+1])/h[n];for(h[s-1]=(e[s]+d[s-1])/2,n=0;n<s-1;++n)h[n]=2*e[n+1]-d[n+1];return[d,h]}function A2e(e){return new FZ(e)}function HT(e,n){this._context=e,this._t=n}HT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(e,n);else{var s=this._x*(1-this._t)+e*this._t;this._context.lineTo(s,this._y),this._context.lineTo(s,n)}break}}this._x=e,this._y=n}};function I2e(e){return new HT(e,.5)}function O2e(e){return new HT(e,0)}function P2e(e){return new HT(e,1)}function kf(e,n){if((f=e.length)>1)for(var s=1,o,d,h=e[n[0]],f,v=h.length;s<f;++s)for(d=h,h=e[n[s]],o=0;o<v;++o)h[o][1]+=h[o][0]=isNaN(d[o][1])?d[o][0]:d[o][1]}function EP(e){for(var n=e.length,s=new Array(n);--n>=0;)s[n]=n;return s}function k2e(e,n){return e[n]}function j2e(e){const n=[];return n.key=e,n}function D2e(){var e=yr([]),n=EP,s=kf,o=k2e;function d(h){var f=Array.from(e.apply(this,arguments),j2e),v,b=f.length,_=-1,w;for(const E of h)for(v=0,++_;v<b;++v)(f[v][_]=[0,+o(E,f[v].key,_,h)]).data=E;for(v=0,w=dD(n(f));v<b;++v)f[w[v]].index=v;return s(f,w),f}return d.keys=function(h){return arguments.length?(e=typeof h=="function"?h:yr(Array.from(h)),d):e},d.value=function(h){return arguments.length?(o=typeof h=="function"?h:yr(+h),d):o},d.order=function(h){return arguments.length?(n=h==null?EP:typeof h=="function"?h:yr(Array.from(h)),d):n},d.offset=function(h){return arguments.length?(s=h??kf,d):s},d}function L2e(e,n){if((o=e.length)>0){for(var s,o,d=0,h=e[0].length,f;d<h;++d){for(f=s=0;s<o;++s)f+=e[s][d][1]||0;if(f)for(s=0;s<o;++s)e[s][d][1]/=f}kf(e,n)}}function M2e(e,n){if((d=e.length)>0){for(var s=0,o=e[n[0]],d,h=o.length;s<h;++s){for(var f=0,v=0;f<d;++f)v+=e[f][s][1]||0;o[s][1]+=o[s][0]=-v/2}kf(e,n)}}function U2e(e,n){if(!(!((f=e.length)>0)||!((h=(d=e[n[0]]).length)>0))){for(var s=0,o=1,d,h,f;o<h;++o){for(var v=0,b=0,_=0;v<f;++v){for(var w=e[n[v]],E=w[o][1]||0,N=w[o-1][1]||0,I=(E-N)/2,R=0;R<v;++R){var O=e[n[R]],P=O[o][1]||0,M=O[o-1][1]||0;I+=P-M}b+=E,_+=I*E}d[o-1][1]+=d[o-1][0]=s,b&&(s-=_/b)}d[o-1][1]+=d[o-1][0]=s,kf(e,n)}}function fy(e){"@babel/helpers - typeof";return fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},fy(e)}var F2e=["type","size","sizeType"];function wP(){return wP=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},wP.apply(this,arguments)}function GH(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function WH(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?GH(Object(s),!0).forEach(function(o){V2e(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):GH(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function V2e(e,n,s){return n=B2e(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function B2e(e){var n=G2e(e,"string");return fy(n)=="symbol"?n:n+""}function G2e(e,n){if(fy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(fy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function W2e(e,n){if(e==null)return{};var s=$2e(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function $2e(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}var VZ={symbolCircle:uD,symbolCross:u2e,symbolDiamond:p2e,symbolSquare:m2e,symbolStar:y2e,symbolTriangle:b2e,symbolWye:_2e},z2e=Math.PI/180,H2e=function(n){var s="symbol".concat(WT(n));return VZ[s]||uD},K2e=function(n,s,o){if(s==="area")return n;switch(o){case"cross":return 5*n*n/9;case"diamond":return .5*n*n/Math.sqrt(3);case"square":return n*n;case"star":{var d=18*z2e;return 1.25*n*n*(Math.tan(d)-Math.tan(d*2)*Math.pow(Math.tan(d),2))}case"triangle":return Math.sqrt(3)*n*n/4;case"wye":return(21-10*Math.sqrt(3))*n*n/8;default:return Math.PI*n*n/4}},Y2e=function(n,s){VZ["symbol".concat(WT(n))]=s},hD=function(n){var s=n.type,o=s===void 0?"circle":s,d=n.size,h=d===void 0?64:d,f=n.sizeType,v=f===void 0?"area":f,b=W2e(n,F2e),_=WH(WH({},b),{},{type:o,size:h,sizeType:v}),w=function(){var P=H2e(o),M=E2e().type(P).size(K2e(h,v,o));return M()},E=_.className,N=_.cx,I=_.cy,R=bn(_,!0);return N===+N&&I===+I&&h===+h?ye.createElement("path",wP({},R,{className:In("recharts-symbols",E),transform:"translate(".concat(N,", ").concat(I,")"),d:w()})):null};hD.registerSymbol=Y2e;function jf(e){"@babel/helpers - typeof";return jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},jf(e)}function SP(){return SP=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},SP.apply(this,arguments)}function $H(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function q2e(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?$H(Object(s),!0).forEach(function(o){gy(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):$H(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function X2e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function J2e(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,GZ(o.key),o)}}function Q2e(e,n,s){return n&&J2e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z2e(e,n,s){return n=aS(n),ePe(e,BZ()?Reflect.construct(n,s||[],aS(e).constructor):n.apply(e,s))}function ePe(e,n){if(n&&(jf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tPe(e)}function tPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BZ=function(){return!!e})()}function aS(e){return aS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},aS(e)}function nPe(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&TP(e,n)}function TP(e,n){return TP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},TP(e,n)}function gy(e,n,s){return n=GZ(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function GZ(e){var n=rPe(e,"string");return jf(n)=="symbol"?n:n+""}function rPe(e,n){if(jf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(jf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ho=32,pD=function(e){function n(){return X2e(this,n),Z2e(this,n,arguments)}return nPe(n,e),Q2e(n,[{key:"renderIcon",value:function(o){var d=this.props.inactiveColor,h=ho/2,f=ho/6,v=ho/3,b=o.inactive?d:o.color;if(o.type==="plainline")return ye.createElement("line",{strokeWidth:4,fill:"none",stroke:b,strokeDasharray:o.payload.strokeDasharray,x1:0,y1:h,x2:ho,y2:h,className:"recharts-legend-icon"});if(o.type==="line")return ye.createElement("path",{strokeWidth:4,fill:"none",stroke:b,d:"M0,".concat(h,"h").concat(v,`
            A`).concat(f,",").concat(f,",0,1,1,").concat(2*v,",").concat(h,`
            H`).concat(ho,"M").concat(2*v,",").concat(h,`
            A`).concat(f,",").concat(f,",0,1,1,").concat(v,",").concat(h),className:"recharts-legend-icon"});if(o.type==="rect")return ye.createElement("path",{stroke:"none",fill:b,d:"M0,".concat(ho/8,"h").concat(ho,"v").concat(ho*3/4,"h").concat(-ho,"z"),className:"recharts-legend-icon"});if(ye.isValidElement(o.legendIcon)){var _=q2e({},o);return delete _.legendIcon,ye.cloneElement(o.legendIcon,_)}return ye.createElement(hD,{fill:b,cx:h,cy:h,size:ho,sizeType:"diameter",type:o.type})}},{key:"renderItems",value:function(){var o=this,d=this.props,h=d.payload,f=d.iconSize,v=d.layout,b=d.formatter,_=d.inactiveColor,w={x:0,y:0,width:ho,height:ho},E={display:v==="horizontal"?"inline-block":"block",marginRight:10},N={display:"inline-block",verticalAlign:"middle",marginRight:4};return h.map(function(I,R){var O=I.formatter||b,P=In(gy(gy({"recharts-legend-item":!0},"legend-item-".concat(R),!0),"inactive",I.inactive));if(I.type==="none")return null;var M=mn(I.value)?null:I.value;Fl(!mn(I.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var D=I.inactive?_:I.color;return ye.createElement("li",SP({className:P,style:E,key:"legend-item-".concat(R)},eS(o.props,I,R)),ye.createElement(fP,{width:f,height:f,viewBox:w,style:N},o.renderIcon(I)),ye.createElement("span",{className:"recharts-legend-item-text",style:{color:D}},O?O(M,I,R):M))})}},{key:"render",value:function(){var o=this.props,d=o.payload,h=o.layout,f=o.align;if(!d||!d.length)return null;var v={padding:0,margin:0,textAlign:h==="horizontal"?f:"left"};return ye.createElement("ul",{className:"recharts-default-legend",style:v},this.renderItems())}}])}(z.PureComponent);gy(pD,"displayName","Legend");gy(pD,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var iPe=IT;function sPe(){this.__data__=new iPe,this.size=0}var aPe=sPe;function oPe(e){var n=this.__data__,s=n.delete(e);return this.size=n.size,s}var cPe=oPe;function lPe(e){return this.__data__.get(e)}var dPe=lPe;function uPe(e){return this.__data__.has(e)}var hPe=uPe,pPe=IT,mPe=eD,fPe=tD,gPe=200;function vPe(e,n){var s=this.__data__;if(s instanceof pPe){var o=s.__data__;if(!mPe||o.length<gPe-1)return o.push([e,n]),this.size=++s.size,this;s=this.__data__=new fPe(o)}return s.set(e,n),this.size=s.size,this}var yPe=vPe,bPe=IT,xPe=aPe,_Pe=cPe,EPe=dPe,wPe=hPe,SPe=yPe;function wg(e){var n=this.__data__=new bPe(e);this.size=n.size}wg.prototype.clear=xPe;wg.prototype.delete=_Pe;wg.prototype.get=EPe;wg.prototype.has=wPe;wg.prototype.set=SPe;var WZ=wg,TPe="__lodash_hash_undefined__";function NPe(e){return this.__data__.set(e,TPe),this}var CPe=NPe;function RPe(e){return this.__data__.has(e)}var APe=RPe,IPe=tD,OPe=CPe,PPe=APe;function oS(e){var n=-1,s=e==null?0:e.length;for(this.__data__=new IPe;++n<s;)this.add(e[n])}oS.prototype.add=oS.prototype.push=OPe;oS.prototype.has=PPe;var $Z=oS;function kPe(e,n){for(var s=-1,o=e==null?0:e.length;++s<o;)if(n(e[s],s,e))return!0;return!1}var zZ=kPe;function jPe(e,n){return e.has(n)}var HZ=jPe,DPe=$Z,LPe=zZ,MPe=HZ,UPe=1,FPe=2;function VPe(e,n,s,o,d,h){var f=s&UPe,v=e.length,b=n.length;if(v!=b&&!(f&&b>v))return!1;var _=h.get(e),w=h.get(n);if(_&&w)return _==n&&w==e;var E=-1,N=!0,I=s&FPe?new DPe:void 0;for(h.set(e,n),h.set(n,e);++E<v;){var R=e[E],O=n[E];if(o)var P=f?o(O,R,E,n,e,h):o(R,O,E,e,n,h);if(P!==void 0){if(P)continue;N=!1;break}if(I){if(!LPe(n,function(M,D){if(!MPe(I,D)&&(R===M||d(R,M,s,o,h)))return I.push(D)})){N=!1;break}}else if(!(R===O||d(R,O,s,o,h))){N=!1;break}}return h.delete(e),h.delete(n),N}var KZ=VPe,BPe=il,GPe=BPe.Uint8Array,WPe=GPe;function $Pe(e){var n=-1,s=Array(e.size);return e.forEach(function(o,d){s[++n]=[d,o]}),s}var zPe=$Pe;function HPe(e){var n=-1,s=Array(e.size);return e.forEach(function(o){s[++n]=o}),s}var mD=HPe,zH=ub,HH=WPe,KPe=Zj,YPe=KZ,qPe=zPe,XPe=mD,JPe=1,QPe=2,ZPe="[object Boolean]",eke="[object Date]",tke="[object Error]",nke="[object Map]",rke="[object Number]",ike="[object RegExp]",ske="[object Set]",ake="[object String]",oke="[object Symbol]",cke="[object ArrayBuffer]",lke="[object DataView]",KH=zH?zH.prototype:void 0,xO=KH?KH.valueOf:void 0;function dke(e,n,s,o,d,h,f){switch(s){case lke:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case cke:return!(e.byteLength!=n.byteLength||!h(new HH(e),new HH(n)));case ZPe:case eke:case rke:return KPe(+e,+n);case tke:return e.name==n.name&&e.message==n.message;case ike:case ake:return e==n+"";case nke:var v=qPe;case ske:var b=o&JPe;if(v||(v=XPe),e.size!=n.size&&!b)return!1;var _=f.get(e);if(_)return _==n;o|=QPe,f.set(e,n);var w=YPe(v(e),v(n),o,d,h,f);return f.delete(e),w;case oke:if(xO)return xO.call(e)==xO.call(n)}return!1}var uke=dke;function hke(e,n){for(var s=-1,o=n.length,d=e.length;++s<o;)e[d+s]=n[s];return e}var YZ=hke,pke=YZ,mke=ua;function fke(e,n,s){var o=n(e);return mke(e)?o:pke(o,s(e))}var gke=fke;function vke(e,n){for(var s=-1,o=e==null?0:e.length,d=0,h=[];++s<o;){var f=e[s];n(f,s,e)&&(h[d++]=f)}return h}var yke=vke;function bke(){return[]}var xke=bke,_ke=yke,Eke=xke,wke=Object.prototype,Ske=wke.propertyIsEnumerable,YH=Object.getOwnPropertySymbols,Tke=YH?function(e){return e==null?[]:(e=Object(e),_ke(YH(e),function(n){return Ske.call(e,n)}))}:Eke,Nke=Tke;function Cke(e,n){for(var s=-1,o=Array(e);++s<e;)o[s]=n(s);return o}var Rke=Cke,Ake=ed,Ike=td,Oke="[object Arguments]";function Pke(e){return Ike(e)&&Ake(e)==Oke}var kke=Pke,qH=kke,jke=td,qZ=Object.prototype,Dke=qZ.hasOwnProperty,Lke=qZ.propertyIsEnumerable,Mke=qH(function(){return arguments}())?qH:function(e){return jke(e)&&Dke.call(e,"callee")&&!Lke.call(e,"callee")},fD=Mke,cS={exports:{}};function Uke(){return!1}var Fke=Uke;cS.exports;(function(e,n){var s=il,o=Fke,d=n&&!n.nodeType&&n,h=d&&!0&&e&&!e.nodeType&&e,f=h&&h.exports===d,v=f?s.Buffer:void 0,b=v?v.isBuffer:void 0,_=b||o;e.exports=_})(cS,cS.exports);var XZ=cS.exports,Vke=9007199254740991,Bke=/^(?:0|[1-9]\d*)$/;function Gke(e,n){var s=typeof e;return n=n??Vke,!!n&&(s=="number"||s!="symbol"&&Bke.test(e))&&e>-1&&e%1==0&&e<n}var gD=Gke,Wke=9007199254740991;function $ke(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Wke}var vD=$ke,zke=ed,Hke=vD,Kke=td,Yke="[object Arguments]",qke="[object Array]",Xke="[object Boolean]",Jke="[object Date]",Qke="[object Error]",Zke="[object Function]",eje="[object Map]",tje="[object Number]",nje="[object Object]",rje="[object RegExp]",ije="[object Set]",sje="[object String]",aje="[object WeakMap]",oje="[object ArrayBuffer]",cje="[object DataView]",lje="[object Float32Array]",dje="[object Float64Array]",uje="[object Int8Array]",hje="[object Int16Array]",pje="[object Int32Array]",mje="[object Uint8Array]",fje="[object Uint8ClampedArray]",gje="[object Uint16Array]",vje="[object Uint32Array]",Rr={};Rr[lje]=Rr[dje]=Rr[uje]=Rr[hje]=Rr[pje]=Rr[mje]=Rr[fje]=Rr[gje]=Rr[vje]=!0;Rr[Yke]=Rr[qke]=Rr[oje]=Rr[Xke]=Rr[cje]=Rr[Jke]=Rr[Qke]=Rr[Zke]=Rr[eje]=Rr[tje]=Rr[nje]=Rr[rje]=Rr[ije]=Rr[sje]=Rr[aje]=!1;function yje(e){return Kke(e)&&Hke(e.length)&&!!Rr[zke(e)]}var bje=yje;function xje(e){return function(n){return e(n)}}var JZ=xje,lS={exports:{}};lS.exports;(function(e,n){var s=iZ,o=n&&!n.nodeType&&n,d=o&&!0&&e&&!e.nodeType&&e,h=d&&d.exports===o,f=h&&s.process,v=function(){try{var b=d&&d.require&&d.require("util").types;return b||f&&f.binding&&f.binding("util")}catch{}}();e.exports=v})(lS,lS.exports);var _je=lS.exports,Eje=bje,wje=JZ,XH=_je,JH=XH&&XH.isTypedArray,Sje=JH?wje(JH):Eje,QZ=Sje,Tje=Rke,Nje=fD,Cje=ua,Rje=XZ,Aje=gD,Ije=QZ,Oje=Object.prototype,Pje=Oje.hasOwnProperty;function kje(e,n){var s=Cje(e),o=!s&&Nje(e),d=!s&&!o&&Rje(e),h=!s&&!o&&!d&&Ije(e),f=s||o||d||h,v=f?Tje(e.length,String):[],b=v.length;for(var _ in e)(n||Pje.call(e,_))&&!(f&&(_=="length"||d&&(_=="offset"||_=="parent")||h&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||Aje(_,b)))&&v.push(_);return v}var jje=kje,Dje=Object.prototype;function Lje(e){var n=e&&e.constructor,s=typeof n=="function"&&n.prototype||Dje;return e===s}var Mje=Lje;function Uje(e,n){return function(s){return e(n(s))}}var ZZ=Uje,Fje=ZZ,Vje=Fje(Object.keys,Object),Bje=Vje,Gje=Mje,Wje=Bje,$je=Object.prototype,zje=$je.hasOwnProperty;function Hje(e){if(!Gje(e))return Wje(e);var n=[];for(var s in Object(e))zje.call(e,s)&&s!="constructor"&&n.push(s);return n}var Kje=Hje,Yje=Qj,qje=vD;function Xje(e){return e!=null&&qje(e.length)&&!Yje(e)}var hb=Xje,Jje=jje,Qje=Kje,Zje=hb;function eDe(e){return Zje(e)?Jje(e):Qje(e)}var KT=eDe,tDe=gke,nDe=Nke,rDe=KT;function iDe(e){return tDe(e,rDe,nDe)}var sDe=iDe,QH=sDe,aDe=1,oDe=Object.prototype,cDe=oDe.hasOwnProperty;function lDe(e,n,s,o,d,h){var f=s&aDe,v=QH(e),b=v.length,_=QH(n),w=_.length;if(b!=w&&!f)return!1;for(var E=b;E--;){var N=v[E];if(!(f?N in n:cDe.call(n,N)))return!1}var I=h.get(e),R=h.get(n);if(I&&R)return I==n&&R==e;var O=!0;h.set(e,n),h.set(n,e);for(var P=f;++E<b;){N=v[E];var M=e[N],D=n[N];if(o)var U=f?o(D,M,N,n,e,h):o(M,D,N,e,n,h);if(!(U===void 0?M===D||d(M,D,s,o,h):U)){O=!1;break}P||(P=N=="constructor")}if(O&&!P){var B=e.constructor,G=n.constructor;B!=G&&"constructor"in e&&"constructor"in n&&!(typeof B=="function"&&B instanceof B&&typeof G=="function"&&G instanceof G)&&(O=!1)}return h.delete(e),h.delete(n),O}var dDe=lDe,uDe=cp,hDe=il,pDe=uDe(hDe,"DataView"),mDe=pDe,fDe=cp,gDe=il,vDe=fDe(gDe,"Promise"),yDe=vDe,bDe=cp,xDe=il,_De=bDe(xDe,"Set"),eee=_De,EDe=cp,wDe=il,SDe=EDe(wDe,"WeakMap"),TDe=SDe,NP=mDe,CP=eD,RP=yDe,AP=eee,IP=TDe,tee=ed,Sg=aZ,ZH="[object Map]",NDe="[object Object]",e9="[object Promise]",t9="[object Set]",n9="[object WeakMap]",r9="[object DataView]",CDe=Sg(NP),RDe=Sg(CP),ADe=Sg(RP),IDe=Sg(AP),ODe=Sg(IP),Nh=tee;(NP&&Nh(new NP(new ArrayBuffer(1)))!=r9||CP&&Nh(new CP)!=ZH||RP&&Nh(RP.resolve())!=e9||AP&&Nh(new AP)!=t9||IP&&Nh(new IP)!=n9)&&(Nh=function(e){var n=tee(e),s=n==NDe?e.constructor:void 0,o=s?Sg(s):"";if(o)switch(o){case CDe:return r9;case RDe:return ZH;case ADe:return e9;case IDe:return t9;case ODe:return n9}return n});var PDe=Nh,_O=WZ,kDe=KZ,jDe=uke,DDe=dDe,i9=PDe,s9=ua,a9=XZ,LDe=QZ,MDe=1,o9="[object Arguments]",c9="[object Array]",BE="[object Object]",UDe=Object.prototype,l9=UDe.hasOwnProperty;function FDe(e,n,s,o,d,h){var f=s9(e),v=s9(n),b=f?c9:i9(e),_=v?c9:i9(n);b=b==o9?BE:b,_=_==o9?BE:_;var w=b==BE,E=_==BE,N=b==_;if(N&&a9(e)){if(!a9(n))return!1;f=!0,w=!1}if(N&&!w)return h||(h=new _O),f||LDe(e)?kDe(e,n,s,o,d,h):jDe(e,n,b,s,o,d,h);if(!(s&MDe)){var I=w&&l9.call(e,"__wrapped__"),R=E&&l9.call(n,"__wrapped__");if(I||R){var O=I?e.value():e,P=R?n.value():n;return h||(h=new _O),d(O,P,s,o,h)}}return N?(h||(h=new _O),DDe(e,n,s,o,d,h)):!1}var VDe=FDe,BDe=VDe,d9=td;function nee(e,n,s,o,d){return e===n?!0:e==null||n==null||!d9(e)&&!d9(n)?e!==e&&n!==n:BDe(e,n,s,o,nee,d)}var yD=nee,GDe=WZ,WDe=yD,$De=1,zDe=2;function HDe(e,n,s,o){var d=s.length,h=d,f=!o;if(e==null)return!h;for(e=Object(e);d--;){var v=s[d];if(f&&v[2]?v[1]!==e[v[0]]:!(v[0]in e))return!1}for(;++d<h;){v=s[d];var b=v[0],_=e[b],w=v[1];if(f&&v[2]){if(_===void 0&&!(b in e))return!1}else{var E=new GDe;if(o)var N=o(_,w,b,e,n,E);if(!(N===void 0?WDe(w,_,$De|zDe,o,E):N))return!1}}return!0}var KDe=HDe,YDe=_u;function qDe(e){return e===e&&!YDe(e)}var ree=qDe,XDe=ree,JDe=KT;function QDe(e){for(var n=JDe(e),s=n.length;s--;){var o=n[s],d=e[o];n[s]=[o,d,XDe(d)]}return n}var ZDe=QDe;function eLe(e,n){return function(s){return s==null?!1:s[e]===n&&(n!==void 0||e in Object(s))}}var iee=eLe,tLe=KDe,nLe=ZDe,rLe=iee;function iLe(e){var n=nLe(e);return n.length==1&&n[0][2]?rLe(n[0][0],n[0][1]):function(s){return s===e||tLe(s,e,n)}}var sLe=iLe;function aLe(e,n){return e!=null&&n in Object(e)}var oLe=aLe,cLe=uZ,lLe=fD,dLe=ua,uLe=gD,hLe=vD,pLe=PT;function mLe(e,n,s){n=cLe(n,e);for(var o=-1,d=n.length,h=!1;++o<d;){var f=pLe(n[o]);if(!(h=e!=null&&s(e,f)))break;e=e[f]}return h||++o!=d?h:(d=e==null?0:e.length,!!d&&hLe(d)&&uLe(f,d)&&(dLe(e)||lLe(e)))}var fLe=mLe,gLe=oLe,vLe=fLe;function yLe(e,n){return e!=null&&vLe(e,n,gLe)}var bLe=yLe,xLe=yD,_Le=hZ,ELe=bLe,wLe=Jj,SLe=ree,TLe=iee,NLe=PT,CLe=1,RLe=2;function ALe(e,n){return wLe(e)&&SLe(n)?TLe(NLe(e),n):function(s){var o=_Le(s,e);return o===void 0&&o===n?ELe(s,e):xLe(n,o,CLe|RLe)}}var ILe=ALe;function OLe(e){return e}var Tg=OLe;function PLe(e){return function(n){return n==null?void 0:n[e]}}var kLe=PLe,jLe=iD;function DLe(e){return function(n){return jLe(n,e)}}var LLe=DLe,MLe=kLe,ULe=LLe,FLe=Jj,VLe=PT;function BLe(e){return FLe(e)?MLe(VLe(e)):ULe(e)}var GLe=BLe,WLe=sLe,$Le=ILe,zLe=Tg,HLe=ua,KLe=GLe;function YLe(e){return typeof e=="function"?e:e==null?zLe:typeof e=="object"?HLe(e)?$Le(e[0],e[1]):WLe(e):KLe(e)}var Eu=YLe;function qLe(e,n,s,o){for(var d=e.length,h=s+(o?1:-1);o?h--:++h<d;)if(n(e[h],h,e))return h;return-1}var see=qLe;function XLe(e){return e!==e}var JLe=XLe;function QLe(e,n,s){for(var o=s-1,d=e.length;++o<d;)if(e[o]===n)return o;return-1}var ZLe=QLe,eMe=see,tMe=JLe,nMe=ZLe;function rMe(e,n,s){return n===n?nMe(e,n,s):eMe(e,tMe,s)}var iMe=rMe,sMe=iMe;function aMe(e,n){var s=e==null?0:e.length;return!!s&&sMe(e,n,0)>-1}var oMe=aMe;function cMe(e,n,s){for(var o=-1,d=e==null?0:e.length;++o<d;)if(s(n,e[o]))return!0;return!1}var lMe=cMe;function dMe(){}var uMe=dMe,EO=eee,hMe=uMe,pMe=mD,mMe=1/0,fMe=EO&&1/pMe(new EO([,-0]))[1]==mMe?function(e){return new EO(e)}:hMe,gMe=fMe,vMe=$Z,yMe=oMe,bMe=lMe,xMe=HZ,_Me=gMe,EMe=mD,wMe=200;function SMe(e,n,s){var o=-1,d=yMe,h=e.length,f=!0,v=[],b=v;if(s)f=!1,d=bMe;else if(h>=wMe){var _=n?null:_Me(e);if(_)return EMe(_);f=!1,d=xMe,b=new vMe}else b=n?[]:v;e:for(;++o<h;){var w=e[o],E=n?n(w):w;if(w=s||w!==0?w:0,f&&E===E){for(var N=b.length;N--;)if(b[N]===E)continue e;n&&b.push(E),v.push(w)}else d(b,E,s)||(b!==v&&b.push(E),v.push(w))}return v}var TMe=SMe,NMe=Eu,CMe=TMe;function RMe(e,n){return e&&e.length?CMe(e,NMe(n)):[]}var AMe=RMe;const u9=ur(AMe);function aee(e,n,s){return n===!0?u9(e,s):mn(n)?u9(e,n):e}function Df(e){"@babel/helpers - typeof";return Df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Df(e)}var IMe=["ref"];function h9(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function Sl(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?h9(Object(s),!0).forEach(function(o){YT(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):h9(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function OMe(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function p9(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,cee(o.key),o)}}function PMe(e,n,s){return n&&p9(e.prototype,n),s&&p9(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function kMe(e,n,s){return n=dS(n),jMe(e,oee()?Reflect.construct(n,s||[],dS(e).constructor):n.apply(e,s))}function jMe(e,n){if(n&&(Df(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DMe(e)}function DMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oee=function(){return!!e})()}function dS(e){return dS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},dS(e)}function LMe(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&OP(e,n)}function OP(e,n){return OP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},OP(e,n)}function YT(e,n,s){return n=cee(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function cee(e){var n=MMe(e,"string");return Df(n)=="symbol"?n:n+""}function MMe(e,n){if(Df(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Df(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function UMe(e,n){if(e==null)return{};var s=FMe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function FMe(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function VMe(e){return e.value}function BMe(e,n){if(ye.isValidElement(e))return ye.cloneElement(e,n);if(typeof e=="function")return ye.createElement(e,n);n.ref;var s=UMe(n,IMe);return ye.createElement(pD,s)}var m9=1,vf=function(e){function n(){var s;OMe(this,n);for(var o=arguments.length,d=new Array(o),h=0;h<o;h++)d[h]=arguments[h];return s=kMe(this,n,[].concat(d)),YT(s,"lastBoundingBox",{width:-1,height:-1}),s}return LMe(n,e),PMe(n,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var o=this.wrapperNode.getBoundingClientRect();return o.height=this.wrapperNode.offsetHeight,o.width=this.wrapperNode.offsetWidth,o}return null}},{key:"updateBBox",value:function(){var o=this.props.onBBoxUpdate,d=this.getBBox();d?(Math.abs(d.width-this.lastBoundingBox.width)>m9||Math.abs(d.height-this.lastBoundingBox.height)>m9)&&(this.lastBoundingBox.width=d.width,this.lastBoundingBox.height=d.height,o&&o(d)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,o&&o(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Sl({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(o){var d=this.props,h=d.layout,f=d.align,v=d.verticalAlign,b=d.margin,_=d.chartWidth,w=d.chartHeight,E,N;if(!o||(o.left===void 0||o.left===null)&&(o.right===void 0||o.right===null))if(f==="center"&&h==="vertical"){var I=this.getBBoxSnapshot();E={left:((_||0)-I.width)/2}}else E=f==="right"?{right:b&&b.right||0}:{left:b&&b.left||0};if(!o||(o.top===void 0||o.top===null)&&(o.bottom===void 0||o.bottom===null))if(v==="middle"){var R=this.getBBoxSnapshot();N={top:((w||0)-R.height)/2}}else N=v==="bottom"?{bottom:b&&b.bottom||0}:{top:b&&b.top||0};return Sl(Sl({},E),N)}},{key:"render",value:function(){var o=this,d=this.props,h=d.content,f=d.width,v=d.height,b=d.wrapperStyle,_=d.payloadUniqBy,w=d.payload,E=Sl(Sl({position:"absolute",width:f||"auto",height:v||"auto"},this.getDefaultPosition(b)),b);return ye.createElement("div",{className:"recharts-legend-wrapper",style:E,ref:function(I){o.wrapperNode=I}},BMe(h,Sl(Sl({},this.props),{},{payload:aee(w,_,VMe)})))}}],[{key:"getWithHeight",value:function(o,d){var h=Sl(Sl({},this.defaultProps),o.props),f=h.layout;return f==="vertical"&&pt(o.props.height)?{height:o.props.height}:f==="horizontal"?{width:o.props.width||d}:null}}])}(z.PureComponent);YT(vf,"displayName","Legend");YT(vf,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var f9=ub,GMe=fD,WMe=ua,g9=f9?f9.isConcatSpreadable:void 0;function $Me(e){return WMe(e)||GMe(e)||!!(g9&&e&&e[g9])}var zMe=$Me,HMe=YZ,KMe=zMe;function lee(e,n,s,o,d){var h=-1,f=e.length;for(s||(s=KMe),d||(d=[]);++h<f;){var v=e[h];n>0&&s(v)?n>1?lee(v,n-1,s,o,d):HMe(d,v):o||(d[d.length]=v)}return d}var dee=lee;function YMe(e){return function(n,s,o){for(var d=-1,h=Object(n),f=o(n),v=f.length;v--;){var b=f[e?v:++d];if(s(h[b],b,h)===!1)break}return n}}var qMe=YMe,XMe=qMe,JMe=XMe(),QMe=JMe,ZMe=QMe,e5e=KT;function t5e(e,n){return e&&ZMe(e,n,e5e)}var uee=t5e,n5e=hb;function r5e(e,n){return function(s,o){if(s==null)return s;if(!n5e(s))return e(s,o);for(var d=s.length,h=n?d:-1,f=Object(s);(n?h--:++h<d)&&o(f[h],h,f)!==!1;);return s}}var i5e=r5e,s5e=uee,a5e=i5e,o5e=a5e(s5e),bD=o5e,c5e=bD,l5e=hb;function d5e(e,n){var s=-1,o=l5e(e)?Array(e.length):[];return c5e(e,function(d,h,f){o[++s]=n(d,h,f)}),o}var hee=d5e;function u5e(e,n){var s=e.length;for(e.sort(n);s--;)e[s]=e[s].value;return e}var h5e=u5e,v9=gg;function p5e(e,n){if(e!==n){var s=e!==void 0,o=e===null,d=e===e,h=v9(e),f=n!==void 0,v=n===null,b=n===n,_=v9(n);if(!v&&!_&&!h&&e>n||h&&f&&b&&!v&&!_||o&&f&&b||!s&&b||!d)return 1;if(!o&&!h&&!_&&e<n||_&&s&&d&&!o&&!h||v&&s&&d||!f&&d||!b)return-1}return 0}var m5e=p5e,f5e=m5e;function g5e(e,n,s){for(var o=-1,d=e.criteria,h=n.criteria,f=d.length,v=s.length;++o<f;){var b=f5e(d[o],h[o]);if(b){if(o>=v)return b;var _=s[o];return b*(_=="desc"?-1:1)}}return e.index-n.index}var v5e=g5e,wO=rD,y5e=iD,b5e=Eu,x5e=hee,_5e=h5e,E5e=JZ,w5e=v5e,S5e=Tg,T5e=ua;function N5e(e,n,s){n.length?n=wO(n,function(h){return T5e(h)?function(f){return y5e(f,h.length===1?h[0]:h)}:h}):n=[S5e];var o=-1;n=wO(n,E5e(b5e));var d=x5e(e,function(h,f,v){var b=wO(n,function(_){return _(h)});return{criteria:b,index:++o,value:h}});return _5e(d,function(h,f){return w5e(h,f,s)})}var C5e=N5e;function R5e(e,n,s){switch(s.length){case 0:return e.call(n);case 1:return e.call(n,s[0]);case 2:return e.call(n,s[0],s[1]);case 3:return e.call(n,s[0],s[1],s[2])}return e.apply(n,s)}var A5e=R5e,I5e=A5e,y9=Math.max;function O5e(e,n,s){return n=y9(n===void 0?e.length-1:n,0),function(){for(var o=arguments,d=-1,h=y9(o.length-n,0),f=Array(h);++d<h;)f[d]=o[n+d];d=-1;for(var v=Array(n+1);++d<n;)v[d]=o[d];return v[n]=s(f),I5e(e,this,v)}}var P5e=O5e;function k5e(e){return function(){return e}}var j5e=k5e,D5e=cp,L5e=function(){try{var e=D5e(Object,"defineProperty");return e({},"",{}),e}catch{}}(),pee=L5e,M5e=j5e,b9=pee,U5e=Tg,F5e=b9?function(e,n){return b9(e,"toString",{configurable:!0,enumerable:!1,value:M5e(n),writable:!0})}:U5e,V5e=F5e,B5e=800,G5e=16,W5e=Date.now;function $5e(e){var n=0,s=0;return function(){var o=W5e(),d=G5e-(o-s);if(s=o,d>0){if(++n>=B5e)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}var z5e=$5e,H5e=V5e,K5e=z5e,Y5e=K5e(H5e),q5e=Y5e,X5e=Tg,J5e=P5e,Q5e=q5e;function Z5e(e,n){return Q5e(J5e(e,n,X5e),e+"")}var eUe=Z5e,tUe=Zj,nUe=hb,rUe=gD,iUe=_u;function sUe(e,n,s){if(!iUe(s))return!1;var o=typeof n;return(o=="number"?nUe(s)&&rUe(n,s.length):o=="string"&&n in s)?tUe(s[n],e):!1}var qT=sUe,aUe=dee,oUe=C5e,cUe=eUe,x9=qT,lUe=cUe(function(e,n){if(e==null)return[];var s=n.length;return s>1&&x9(e,n[0],n[1])?n=[]:s>2&&x9(n[0],n[1],n[2])&&(n=[n[0]]),oUe(e,aUe(n,1),[])}),dUe=lUe;const xD=ur(dUe);function vy(e){"@babel/helpers - typeof";return vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},vy(e)}function PP(){return PP=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},PP.apply(this,arguments)}function uUe(e,n){return fUe(e)||mUe(e,n)||pUe(e,n)||hUe()}function hUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pUe(e,n){if(e){if(typeof e=="string")return _9(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return _9(e,n)}}function _9(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function mUe(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n!==0)for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function fUe(e){if(Array.isArray(e))return e}function E9(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function SO(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?E9(Object(s),!0).forEach(function(o){gUe(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):E9(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function gUe(e,n,s){return n=vUe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function vUe(e){var n=yUe(e,"string");return vy(n)=="symbol"?n:n+""}function yUe(e,n){if(vy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(vy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function bUe(e){return Array.isArray(e)&&Ri(e[0])&&Ri(e[1])?e.join(" ~ "):e}var xUe=function(n){var s=n.separator,o=s===void 0?" : ":s,d=n.contentStyle,h=d===void 0?{}:d,f=n.itemStyle,v=f===void 0?{}:f,b=n.labelStyle,_=b===void 0?{}:b,w=n.payload,E=n.formatter,N=n.itemSorter,I=n.wrapperClassName,R=n.labelClassName,O=n.label,P=n.labelFormatter,M=n.accessibilityLayer,D=M===void 0?!1:M,U=function(){if(w&&w.length){var ae={padding:0,margin:0},ve=(N?xD(w,N):w).map(function(le,fe){if(le.type==="none")return null;var re=SO({display:"block",paddingTop:4,paddingBottom:4,color:le.color||"#000"},v),he=le.formatter||E||bUe,J=le.value,ue=le.name,Ee=J,Fe=ue;if(he&&Ee!=null&&Fe!=null){var ke=he(J,ue,le,fe,w);if(Array.isArray(ke)){var Ge=uUe(ke,2);Ee=Ge[0],Fe=Ge[1]}else Ee=ke}return ye.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(fe),style:re},Ri(Fe)?ye.createElement("span",{className:"recharts-tooltip-item-name"},Fe):null,Ri(Fe)?ye.createElement("span",{className:"recharts-tooltip-item-separator"},o):null,ye.createElement("span",{className:"recharts-tooltip-item-value"},Ee),ye.createElement("span",{className:"recharts-tooltip-item-unit"},le.unit||""))});return ye.createElement("ul",{className:"recharts-tooltip-item-list",style:ae},ve)}return null},B=SO({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},h),G=SO({margin:0},_),$=!En(O),q=$?O:"",X=In("recharts-default-tooltip",I),ee=In("recharts-tooltip-label",R);$&&P&&w!==void 0&&w!==null&&(q=P(O,w));var ce=D?{role:"status","aria-live":"assertive"}:{};return ye.createElement("div",PP({className:X,style:B},ce),ye.createElement("p",{className:ee,style:G},ye.isValidElement(q)?q:"".concat(q)),U())};function yy(e){"@babel/helpers - typeof";return yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},yy(e)}function GE(e,n,s){return n=_Ue(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function _Ue(e){var n=EUe(e,"string");return yy(n)=="symbol"?n:n+""}function EUe(e,n){if(yy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(yy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var yv="recharts-tooltip-wrapper",wUe={visibility:"hidden"};function SUe(e){var n=e.coordinate,s=e.translateX,o=e.translateY;return In(yv,GE(GE(GE(GE({},"".concat(yv,"-right"),pt(s)&&n&&pt(n.x)&&s>=n.x),"".concat(yv,"-left"),pt(s)&&n&&pt(n.x)&&s<n.x),"".concat(yv,"-bottom"),pt(o)&&n&&pt(n.y)&&o>=n.y),"".concat(yv,"-top"),pt(o)&&n&&pt(n.y)&&o<n.y))}function w9(e){var n=e.allowEscapeViewBox,s=e.coordinate,o=e.key,d=e.offsetTopLeft,h=e.position,f=e.reverseDirection,v=e.tooltipDimension,b=e.viewBox,_=e.viewBoxDimension;if(h&&pt(h[o]))return h[o];var w=s[o]-v-d,E=s[o]+d;if(n[o])return f[o]?w:E;if(f[o]){var N=w,I=b[o];return N<I?Math.max(E,b[o]):Math.max(w,b[o])}var R=E+v,O=b[o]+_;return R>O?Math.max(w,b[o]):Math.max(E,b[o])}function TUe(e){var n=e.translateX,s=e.translateY,o=e.useTranslate3d;return{transform:o?"translate3d(".concat(n,"px, ").concat(s,"px, 0)"):"translate(".concat(n,"px, ").concat(s,"px)")}}function NUe(e){var n=e.allowEscapeViewBox,s=e.coordinate,o=e.offsetTopLeft,d=e.position,h=e.reverseDirection,f=e.tooltipBox,v=e.useTranslate3d,b=e.viewBox,_,w,E;return f.height>0&&f.width>0&&s?(w=w9({allowEscapeViewBox:n,coordinate:s,key:"x",offsetTopLeft:o,position:d,reverseDirection:h,tooltipDimension:f.width,viewBox:b,viewBoxDimension:b.width}),E=w9({allowEscapeViewBox:n,coordinate:s,key:"y",offsetTopLeft:o,position:d,reverseDirection:h,tooltipDimension:f.height,viewBox:b,viewBoxDimension:b.height}),_=TUe({translateX:w,translateY:E,useTranslate3d:v})):_=wUe,{cssProperties:_,cssClasses:SUe({translateX:w,translateY:E,coordinate:s})}}function Lf(e){"@babel/helpers - typeof";return Lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Lf(e)}function S9(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function T9(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?S9(Object(s),!0).forEach(function(o){jP(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):S9(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function CUe(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function RUe(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,fee(o.key),o)}}function AUe(e,n,s){return n&&RUe(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function IUe(e,n,s){return n=uS(n),OUe(e,mee()?Reflect.construct(n,s||[],uS(e).constructor):n.apply(e,s))}function OUe(e,n){if(n&&(Lf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PUe(e)}function PUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mee=function(){return!!e})()}function uS(e){return uS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},uS(e)}function kUe(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&kP(e,n)}function kP(e,n){return kP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},kP(e,n)}function jP(e,n,s){return n=fee(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function fee(e){var n=jUe(e,"string");return Lf(n)=="symbol"?n:n+""}function jUe(e,n){if(Lf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Lf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var N9=1,DUe=function(e){function n(){var s;CUe(this,n);for(var o=arguments.length,d=new Array(o),h=0;h<o;h++)d[h]=arguments[h];return s=IUe(this,n,[].concat(d)),jP(s,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),jP(s,"handleKeyDown",function(f){if(f.key==="Escape"){var v,b,_,w;s.setState({dismissed:!0,dismissedAtCoordinate:{x:(v=(b=s.props.coordinate)===null||b===void 0?void 0:b.x)!==null&&v!==void 0?v:0,y:(_=(w=s.props.coordinate)===null||w===void 0?void 0:w.y)!==null&&_!==void 0?_:0}})}}),s}return kUe(n,e),AUe(n,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var o=this.wrapperNode.getBoundingClientRect();(Math.abs(o.width-this.state.lastBoundingBox.width)>N9||Math.abs(o.height-this.state.lastBoundingBox.height)>N9)&&this.setState({lastBoundingBox:{width:o.width,height:o.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var o,d;this.props.active&&this.updateBBox(),this.state.dismissed&&(((o=this.props.coordinate)===null||o===void 0?void 0:o.x)!==this.state.dismissedAtCoordinate.x||((d=this.props.coordinate)===null||d===void 0?void 0:d.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var o=this,d=this.props,h=d.active,f=d.allowEscapeViewBox,v=d.animationDuration,b=d.animationEasing,_=d.children,w=d.coordinate,E=d.hasPayload,N=d.isAnimationActive,I=d.offset,R=d.position,O=d.reverseDirection,P=d.useTranslate3d,M=d.viewBox,D=d.wrapperStyle,U=NUe({allowEscapeViewBox:f,coordinate:w,offsetTopLeft:I,position:R,reverseDirection:O,tooltipBox:this.state.lastBoundingBox,useTranslate3d:P,viewBox:M}),B=U.cssClasses,G=U.cssProperties,$=T9(T9({transition:N&&h?"transform ".concat(v,"ms ").concat(b):void 0},G),{},{pointerEvents:"none",visibility:!this.state.dismissed&&h&&E?"visible":"hidden",position:"absolute",top:0,left:0},D);return ye.createElement("div",{tabIndex:-1,className:B,style:$,ref:function(X){o.wrapperNode=X}},_)}}])}(z.PureComponent),LUe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},lp={isSsr:LUe()};function Mf(e){"@babel/helpers - typeof";return Mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Mf(e)}function C9(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function R9(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?C9(Object(s),!0).forEach(function(o){_D(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):C9(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function MUe(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function UUe(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,vee(o.key),o)}}function FUe(e,n,s){return n&&UUe(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function VUe(e,n,s){return n=hS(n),BUe(e,gee()?Reflect.construct(n,s||[],hS(e).constructor):n.apply(e,s))}function BUe(e,n){if(n&&(Mf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GUe(e)}function GUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gee=function(){return!!e})()}function hS(e){return hS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},hS(e)}function WUe(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&DP(e,n)}function DP(e,n){return DP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},DP(e,n)}function _D(e,n,s){return n=vee(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function vee(e){var n=$Ue(e,"string");return Mf(n)=="symbol"?n:n+""}function $Ue(e,n){if(Mf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Mf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function zUe(e){return e.dataKey}function HUe(e,n){return ye.isValidElement(e)?ye.cloneElement(e,n):typeof e=="function"?ye.createElement(e,n):ye.createElement(xUe,n)}var ea=function(e){function n(){return MUe(this,n),VUe(this,n,arguments)}return WUe(n,e),FUe(n,[{key:"render",value:function(){var o=this,d=this.props,h=d.active,f=d.allowEscapeViewBox,v=d.animationDuration,b=d.animationEasing,_=d.content,w=d.coordinate,E=d.filterNull,N=d.isAnimationActive,I=d.offset,R=d.payload,O=d.payloadUniqBy,P=d.position,M=d.reverseDirection,D=d.useTranslate3d,U=d.viewBox,B=d.wrapperStyle,G=R??[];E&&G.length&&(G=aee(R.filter(function(q){return q.value!=null&&(q.hide!==!0||o.props.includeHidden)}),O,zUe));var $=G.length>0;return ye.createElement(DUe,{allowEscapeViewBox:f,animationDuration:v,animationEasing:b,isAnimationActive:N,active:h,coordinate:w,hasPayload:$,offset:I,position:P,reverseDirection:M,useTranslate3d:D,viewBox:U,wrapperStyle:B},HUe(_,R9(R9({},this.props),{},{payload:G})))}}])}(z.PureComponent);_D(ea,"displayName","Tooltip");_D(ea,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!lp.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var KUe=il,YUe=function(){return KUe.Date.now()},qUe=YUe,XUe=/\s/;function JUe(e){for(var n=e.length;n--&&XUe.test(e.charAt(n)););return n}var QUe=JUe,ZUe=QUe,e4e=/^\s+/;function t4e(e){return e&&e.slice(0,ZUe(e)+1).replace(e4e,"")}var n4e=t4e,r4e=n4e,A9=_u,i4e=gg,I9=NaN,s4e=/^[-+]0x[0-9a-f]+$/i,a4e=/^0b[01]+$/i,o4e=/^0o[0-7]+$/i,c4e=parseInt;function l4e(e){if(typeof e=="number")return e;if(i4e(e))return I9;if(A9(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=A9(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=r4e(e);var s=a4e.test(e);return s||o4e.test(e)?c4e(e.slice(2),s?2:8):s4e.test(e)?I9:+e}var yee=l4e,d4e=_u,TO=qUe,O9=yee,u4e="Expected a function",h4e=Math.max,p4e=Math.min;function m4e(e,n,s){var o,d,h,f,v,b,_=0,w=!1,E=!1,N=!0;if(typeof e!="function")throw new TypeError(u4e);n=O9(n)||0,d4e(s)&&(w=!!s.leading,E="maxWait"in s,h=E?h4e(O9(s.maxWait)||0,n):h,N="trailing"in s?!!s.trailing:N);function I($){var q=o,X=d;return o=d=void 0,_=$,f=e.apply(X,q),f}function R($){return _=$,v=setTimeout(M,n),w?I($):f}function O($){var q=$-b,X=$-_,ee=n-q;return E?p4e(ee,h-X):ee}function P($){var q=$-b,X=$-_;return b===void 0||q>=n||q<0||E&&X>=h}function M(){var $=TO();if(P($))return D($);v=setTimeout(M,O($))}function D($){return v=void 0,N&&o?I($):(o=d=void 0,f)}function U(){v!==void 0&&clearTimeout(v),_=0,o=b=d=v=void 0}function B(){return v===void 0?f:D(TO())}function G(){var $=TO(),q=P($);if(o=arguments,d=this,b=$,q){if(v===void 0)return R(b);if(E)return clearTimeout(v),v=setTimeout(M,n),I(b)}return v===void 0&&(v=setTimeout(M,n)),f}return G.cancel=U,G.flush=B,G}var f4e=m4e,g4e=f4e,v4e=_u,y4e="Expected a function";function b4e(e,n,s){var o=!0,d=!0;if(typeof e!="function")throw new TypeError(y4e);return v4e(s)&&(o="leading"in s?!!s.leading:o,d="trailing"in s?!!s.trailing:d),g4e(e,n,{leading:o,maxWait:n,trailing:d})}var x4e=b4e;const bee=ur(x4e);function by(e){"@babel/helpers - typeof";return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},by(e)}function P9(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function WE(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?P9(Object(s),!0).forEach(function(o){_4e(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):P9(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function _4e(e,n,s){return n=E4e(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function E4e(e){var n=w4e(e,"string");return by(n)=="symbol"?n:n+""}function w4e(e,n){if(by(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(by(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function S4e(e,n){return R4e(e)||C4e(e,n)||N4e(e,n)||T4e()}function T4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N4e(e,n){if(e){if(typeof e=="string")return k9(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return k9(e,n)}}function k9(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function C4e(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n!==0)for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function R4e(e){if(Array.isArray(e))return e}var xy=z.forwardRef(function(e,n){var s=e.aspect,o=e.initialDimension,d=o===void 0?{width:-1,height:-1}:o,h=e.width,f=h===void 0?"100%":h,v=e.height,b=v===void 0?"100%":v,_=e.minWidth,w=_===void 0?0:_,E=e.minHeight,N=e.maxHeight,I=e.children,R=e.debounce,O=R===void 0?0:R,P=e.id,M=e.className,D=e.onResize,U=e.style,B=U===void 0?{}:U,G=z.useRef(null),$=z.useRef();$.current=D,z.useImperativeHandle(n,function(){return Object.defineProperty(G.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),G.current},configurable:!0})});var q=z.useState({containerWidth:d.width,containerHeight:d.height}),X=S4e(q,2),ee=X[0],ce=X[1],Q=z.useCallback(function(ve,le){ce(function(fe){var re=Math.round(ve),he=Math.round(le);return fe.containerWidth===re&&fe.containerHeight===he?fe:{containerWidth:re,containerHeight:he}})},[]);z.useEffect(function(){var ve=function(ue){var Ee,Fe=ue[0].contentRect,ke=Fe.width,Ge=Fe.height;Q(ke,Ge),(Ee=$.current)===null||Ee===void 0||Ee.call($,ke,Ge)};O>0&&(ve=bee(ve,O,{trailing:!0,leading:!1}));var le=new ResizeObserver(ve),fe=G.current.getBoundingClientRect(),re=fe.width,he=fe.height;return Q(re,he),le.observe(G.current),function(){le.disconnect()}},[Q,O]);var ae=z.useMemo(function(){var ve=ee.containerWidth,le=ee.containerHeight;if(ve<0||le<0)return null;Fl(Dh(f)||Dh(b),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,f,b),Fl(!s||s>0,"The aspect(%s) must be greater than zero.",s);var fe=Dh(f)?ve:f,re=Dh(b)?le:b;s&&s>0&&(fe?re=fe/s:re&&(fe=re*s),N&&re>N&&(re=N)),Fl(fe>0||re>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,fe,re,f,b,w,E,s);var he=!Array.isArray(I)&&Ul(I.type).endsWith("Chart");return ye.Children.map(I,function(J){return ye.isValidElement(J)?z.cloneElement(J,WE({width:fe,height:re},he?{style:WE({height:"100%",width:"100%",maxHeight:re,maxWidth:fe},J.props.style)}:{})):J})},[s,I,b,N,E,w,ee,f]);return ye.createElement("div",{id:P?"".concat(P):void 0,className:In("recharts-responsive-container",M),style:WE(WE({},B),{},{width:f,height:b,minWidth:w,minHeight:E,maxHeight:N}),ref:G},ae)}),xee=function(n){return null};xee.displayName="Cell";function _y(e){"@babel/helpers - typeof";return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_y(e)}function j9(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function LP(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?j9(Object(s),!0).forEach(function(o){A4e(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):j9(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function A4e(e,n,s){return n=I4e(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function I4e(e){var n=O4e(e,"string");return _y(n)=="symbol"?n:n+""}function O4e(e,n){if(_y(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(_y(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var Vm={widthCache:{},cacheCount:0},P4e=2e3,k4e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},D9="recharts_measurement_span";function j4e(e){var n=LP({},e);return Object.keys(n).forEach(function(s){n[s]||delete n[s]}),n}var $v=function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n==null||lp.isSsr)return{width:0,height:0};var o=j4e(s),d=JSON.stringify({text:n,copyStyle:o});if(Vm.widthCache[d])return Vm.widthCache[d];try{var h=document.getElementById(D9);h||(h=document.createElement("span"),h.setAttribute("id",D9),h.setAttribute("aria-hidden","true"),document.body.appendChild(h));var f=LP(LP({},k4e),o);Object.assign(h.style,f),h.textContent="".concat(n);var v=h.getBoundingClientRect(),b={width:v.width,height:v.height};return Vm.widthCache[d]=b,++Vm.cacheCount>P4e&&(Vm.cacheCount=0,Vm.widthCache={}),b}catch{return{width:0,height:0}}},D4e=function(n){return{top:n.top+window.scrollY-document.documentElement.clientTop,left:n.left+window.scrollX-document.documentElement.clientLeft}};function Ey(e){"@babel/helpers - typeof";return Ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ey(e)}function pS(e,n){return F4e(e)||U4e(e,n)||M4e(e,n)||L4e()}function L4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M4e(e,n){if(e){if(typeof e=="string")return L9(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return L9(e,n)}}function L9(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function U4e(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n===0){if(Object(s)!==s)return;b=!1}else for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function F4e(e){if(Array.isArray(e))return e}function V4e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function M9(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,G4e(o.key),o)}}function B4e(e,n,s){return n&&M9(e.prototype,n),s&&M9(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function G4e(e){var n=W4e(e,"string");return Ey(n)=="symbol"?n:n+""}function W4e(e,n){if(Ey(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Ey(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var U9=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,F9=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,$4e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,z4e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,_ee={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},H4e=Object.keys(_ee),af="NaN";function K4e(e,n){return e*_ee[n]}var $E=function(){function e(n,s){V4e(this,e),this.num=n,this.unit=s,this.num=n,this.unit=s,Number.isNaN(n)&&(this.unit=""),s!==""&&!$4e.test(s)&&(this.num=NaN,this.unit=""),H4e.includes(s)&&(this.num=K4e(n,s),this.unit="px")}return B4e(e,[{key:"add",value:function(s){return this.unit!==s.unit?new e(NaN,""):new e(this.num+s.num,this.unit)}},{key:"subtract",value:function(s){return this.unit!==s.unit?new e(NaN,""):new e(this.num-s.num,this.unit)}},{key:"multiply",value:function(s){return this.unit!==""&&s.unit!==""&&this.unit!==s.unit?new e(NaN,""):new e(this.num*s.num,this.unit||s.unit)}},{key:"divide",value:function(s){return this.unit!==""&&s.unit!==""&&this.unit!==s.unit?new e(NaN,""):new e(this.num/s.num,this.unit||s.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(s){var o,d=(o=z4e.exec(s))!==null&&o!==void 0?o:[],h=pS(d,3),f=h[1],v=h[2];return new e(parseFloat(f),v??"")}}])}();function Eee(e){if(e.includes(af))return af;for(var n=e;n.includes("*")||n.includes("/");){var s,o=(s=U9.exec(n))!==null&&s!==void 0?s:[],d=pS(o,4),h=d[1],f=d[2],v=d[3],b=$E.parse(h??""),_=$E.parse(v??""),w=f==="*"?b.multiply(_):b.divide(_);if(w.isNaN())return af;n=n.replace(U9,w.toString())}for(;n.includes("+")||/.-\d+(?:\.\d+)?/.test(n);){var E,N=(E=F9.exec(n))!==null&&E!==void 0?E:[],I=pS(N,4),R=I[1],O=I[2],P=I[3],M=$E.parse(R??""),D=$E.parse(P??""),U=O==="+"?M.add(D):M.subtract(D);if(U.isNaN())return af;n=n.replace(F9,U.toString())}return n}var V9=/\(([^()]*)\)/;function Y4e(e){for(var n=e;n.includes("(");){var s=V9.exec(n),o=pS(s,2),d=o[1];n=n.replace(V9,Eee(d))}return n}function q4e(e){var n=e.replace(/\s+/g,"");return n=Y4e(n),n=Eee(n),n}function X4e(e){try{return q4e(e)}catch{return af}}function NO(e){var n=X4e(e.slice(5,-1));return n===af?"":n}var J4e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Q4e=["dx","dy","angle","className","breakAll"];function MP(){return MP=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},MP.apply(this,arguments)}function B9(e,n){if(e==null)return{};var s=Z4e(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function Z4e(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function G9(e,n){return r3e(e)||n3e(e,n)||t3e(e,n)||e3e()}function e3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t3e(e,n){if(e){if(typeof e=="string")return W9(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return W9(e,n)}}function W9(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function n3e(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n===0){if(Object(s)!==s)return;b=!1}else for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function r3e(e){if(Array.isArray(e))return e}var wee=/[ \f\n\r\t\v\u2028\u2029]+/,See=function(n){var s=n.children,o=n.breakAll,d=n.style;try{var h=[];En(s)||(o?h=s.toString().split(""):h=s.toString().split(wee));var f=h.map(function(b){return{word:b,width:$v(b,d).width}}),v=o?0:$v("",d).width;return{wordsWithComputedWidth:f,spaceWidth:v}}catch{return null}},i3e=function(n,s,o,d,h){var f=n.maxLines,v=n.children,b=n.style,_=n.breakAll,w=pt(f),E=v,N=function(){var fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return fe.reduce(function(re,he){var J=he.word,ue=he.width,Ee=re[re.length-1];if(Ee&&(d==null||h||Ee.width+ue+o<Number(d)))Ee.words.push(J),Ee.width+=ue+o;else{var Fe={words:[J],width:ue};re.push(Fe)}return re},[])},I=N(s),R=function(fe){return fe.reduce(function(re,he){return re.width>he.width?re:he})};if(!w)return I;for(var O="",P=function(fe){var re=E.slice(0,fe),he=See({breakAll:_,style:b,children:re+O}).wordsWithComputedWidth,J=N(he),ue=J.length>f||R(J).width>Number(d);return[ue,J]},M=0,D=E.length-1,U=0,B;M<=D&&U<=E.length-1;){var G=Math.floor((M+D)/2),$=G-1,q=P($),X=G9(q,2),ee=X[0],ce=X[1],Q=P(G),ae=G9(Q,1),ve=ae[0];if(!ee&&!ve&&(M=G+1),ee&&ve&&(D=G-1),!ee&&ve){B=ce;break}U++}return B||I},$9=function(n){var s=En(n)?[]:n.toString().split(wee);return[{words:s}]},s3e=function(n){var s=n.width,o=n.scaleToFit,d=n.children,h=n.style,f=n.breakAll,v=n.maxLines;if((s||o)&&!lp.isSsr){var b,_,w=See({breakAll:f,children:d,style:h});if(w){var E=w.wordsWithComputedWidth,N=w.spaceWidth;b=E,_=N}else return $9(d);return i3e({breakAll:f,children:d,maxLines:v,style:h},b,_,s,o)}return $9(d)},z9="#808080",mS=function(n){var s=n.x,o=s===void 0?0:s,d=n.y,h=d===void 0?0:d,f=n.lineHeight,v=f===void 0?"1em":f,b=n.capHeight,_=b===void 0?"0.71em":b,w=n.scaleToFit,E=w===void 0?!1:w,N=n.textAnchor,I=N===void 0?"start":N,R=n.verticalAnchor,O=R===void 0?"end":R,P=n.fill,M=P===void 0?z9:P,D=B9(n,J4e),U=z.useMemo(function(){return s3e({breakAll:D.breakAll,children:D.children,maxLines:D.maxLines,scaleToFit:E,style:D.style,width:D.width})},[D.breakAll,D.children,D.maxLines,E,D.style,D.width]),B=D.dx,G=D.dy,$=D.angle,q=D.className,X=D.breakAll,ee=B9(D,Q4e);if(!Ri(o)||!Ri(h))return null;var ce=o+(pt(B)?B:0),Q=h+(pt(G)?G:0),ae;switch(O){case"start":ae=NO("calc(".concat(_,")"));break;case"middle":ae=NO("calc(".concat((U.length-1)/2," * -").concat(v," + (").concat(_," / 2))"));break;default:ae=NO("calc(".concat(U.length-1," * -").concat(v,")"));break}var ve=[];if(E){var le=U[0].width,fe=D.width;ve.push("scale(".concat((pt(fe)?fe/le:1)/le,")"))}return $&&ve.push("rotate(".concat($,", ").concat(ce,", ").concat(Q,")")),ve.length&&(ee.transform=ve.join(" ")),ye.createElement("text",MP({},bn(ee,!0),{x:ce,y:Q,className:In("recharts-text",q),textAnchor:I,fill:M.includes("url")?z9:M}),U.map(function(re,he){var J=re.words.join(X?"":" ");return ye.createElement("tspan",{x:ce,dy:he===0?ae:v,key:"".concat(J,"-").concat(he)},J)}))};function uu(e,n){return e==null||n==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function a3e(e,n){return e==null||n==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function ED(e){let n,s,o;e.length!==2?(n=uu,s=(v,b)=>uu(e(v),b),o=(v,b)=>e(v)-b):(n=e===uu||e===a3e?e:o3e,s=e,o=e);function d(v,b,_=0,w=v.length){if(_<w){if(n(b,b)!==0)return w;do{const E=_+w>>>1;s(v[E],b)<0?_=E+1:w=E}while(_<w)}return _}function h(v,b,_=0,w=v.length){if(_<w){if(n(b,b)!==0)return w;do{const E=_+w>>>1;s(v[E],b)<=0?_=E+1:w=E}while(_<w)}return _}function f(v,b,_=0,w=v.length){const E=d(v,b,_,w-1);return E>_&&o(v[E-1],b)>-o(v[E],b)?E-1:E}return{left:d,center:f,right:h}}function o3e(){return 0}function Tee(e){return e===null?NaN:+e}function*c3e(e,n){for(let s of e)s!=null&&(s=+s)>=s&&(yield s)}const l3e=ED(uu),pb=l3e.right;ED(Tee).center;class H9 extends Map{constructor(n,s=h3e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:s}}),n!=null)for(const[o,d]of n)this.set(o,d)}get(n){return super.get(K9(this,n))}has(n){return super.has(K9(this,n))}set(n,s){return super.set(d3e(this,n),s)}delete(n){return super.delete(u3e(this,n))}}function K9({_intern:e,_key:n},s){const o=n(s);return e.has(o)?e.get(o):s}function d3e({_intern:e,_key:n},s){const o=n(s);return e.has(o)?e.get(o):(e.set(o,s),s)}function u3e({_intern:e,_key:n},s){const o=n(s);return e.has(o)&&(s=e.get(o),e.delete(o)),s}function h3e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function p3e(e=uu){if(e===uu)return Nee;if(typeof e!="function")throw new TypeError("compare is not a function");return(n,s)=>{const o=e(n,s);return o||o===0?o:(e(s,s)===0)-(e(n,n)===0)}}function Nee(e,n){return(e==null||!(e>=e))-(n==null||!(n>=n))||(e<n?-1:e>n?1:0)}const m3e=Math.sqrt(50),f3e=Math.sqrt(10),g3e=Math.sqrt(2);function fS(e,n,s){const o=(n-e)/Math.max(0,s),d=Math.floor(Math.log10(o)),h=o/Math.pow(10,d),f=h>=m3e?10:h>=f3e?5:h>=g3e?2:1;let v,b,_;return d<0?(_=Math.pow(10,-d)/f,v=Math.round(e*_),b=Math.round(n*_),v/_<e&&++v,b/_>n&&--b,_=-_):(_=Math.pow(10,d)*f,v=Math.round(e/_),b=Math.round(n/_),v*_<e&&++v,b*_>n&&--b),b<v&&.5<=s&&s<2?fS(e,n,s*2):[v,b,_]}function UP(e,n,s){if(n=+n,e=+e,s=+s,!(s>0))return[];if(e===n)return[e];const o=n<e,[d,h,f]=o?fS(n,e,s):fS(e,n,s);if(!(h>=d))return[];const v=h-d+1,b=new Array(v);if(o)if(f<0)for(let _=0;_<v;++_)b[_]=(h-_)/-f;else for(let _=0;_<v;++_)b[_]=(h-_)*f;else if(f<0)for(let _=0;_<v;++_)b[_]=(d+_)/-f;else for(let _=0;_<v;++_)b[_]=(d+_)*f;return b}function FP(e,n,s){return n=+n,e=+e,s=+s,fS(e,n,s)[2]}function VP(e,n,s){n=+n,e=+e,s=+s;const o=n<e,d=o?FP(n,e,s):FP(e,n,s);return(o?-1:1)*(d<0?1/-d:d)}function Y9(e,n){let s;for(const o of e)o!=null&&(s<o||s===void 0&&o>=o)&&(s=o);return s}function q9(e,n){let s;for(const o of e)o!=null&&(s>o||s===void 0&&o>=o)&&(s=o);return s}function Cee(e,n,s=0,o=1/0,d){if(n=Math.floor(n),s=Math.floor(Math.max(0,s)),o=Math.floor(Math.min(e.length-1,o)),!(s<=n&&n<=o))return e;for(d=d===void 0?Nee:p3e(d);o>s;){if(o-s>600){const b=o-s+1,_=n-s+1,w=Math.log(b),E=.5*Math.exp(2*w/3),N=.5*Math.sqrt(w*E*(b-E)/b)*(_-b/2<0?-1:1),I=Math.max(s,Math.floor(n-_*E/b+N)),R=Math.min(o,Math.floor(n+(b-_)*E/b+N));Cee(e,n,I,R,d)}const h=e[n];let f=s,v=o;for(bv(e,s,n),d(e[o],h)>0&&bv(e,s,o);f<v;){for(bv(e,f,v),++f,--v;d(e[f],h)<0;)++f;for(;d(e[v],h)>0;)--v}d(e[s],h)===0?bv(e,s,v):(++v,bv(e,v,o)),v<=n&&(s=v+1),n<=v&&(o=v-1)}return e}function bv(e,n,s){const o=e[n];e[n]=e[s],e[s]=o}function v3e(e,n,s){if(e=Float64Array.from(c3e(e)),!(!(o=e.length)||isNaN(n=+n))){if(n<=0||o<2)return q9(e);if(n>=1)return Y9(e);var o,d=(o-1)*n,h=Math.floor(d),f=Y9(Cee(e,h).subarray(0,h+1)),v=q9(e.subarray(h+1));return f+(v-f)*(d-h)}}function y3e(e,n,s=Tee){if(!(!(o=e.length)||isNaN(n=+n))){if(n<=0||o<2)return+s(e[0],0,e);if(n>=1)return+s(e[o-1],o-1,e);var o,d=(o-1)*n,h=Math.floor(d),f=+s(e[h],h,e),v=+s(e[h+1],h+1,e);return f+(v-f)*(d-h)}}function b3e(e,n,s){e=+e,n=+n,s=(d=arguments.length)<2?(n=e,e=0,1):d<3?1:+s;for(var o=-1,d=Math.max(0,Math.ceil((n-e)/s))|0,h=new Array(d);++o<d;)h[o]=e+o*s;return h}function Ro(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e);break}return this}function nd(e,n){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof n=="function"?this.interpolator(n):this.range(n);break}}return this}const BP=Symbol("implicit");function wD(){var e=new H9,n=[],s=[],o=BP;function d(h){let f=e.get(h);if(f===void 0){if(o!==BP)return o;e.set(h,f=n.push(h)-1)}return s[f%s.length]}return d.domain=function(h){if(!arguments.length)return n.slice();n=[],e=new H9;for(const f of h)e.has(f)||e.set(f,n.push(f)-1);return d},d.range=function(h){return arguments.length?(s=Array.from(h),d):s.slice()},d.unknown=function(h){return arguments.length?(o=h,d):o},d.copy=function(){return wD(n,s).unknown(o)},Ro.apply(d,arguments),d}function wy(){var e=wD().unknown(void 0),n=e.domain,s=e.range,o=0,d=1,h,f,v=!1,b=0,_=0,w=.5;delete e.unknown;function E(){var N=n().length,I=d<o,R=I?d:o,O=I?o:d;h=(O-R)/Math.max(1,N-b+_*2),v&&(h=Math.floor(h)),R+=(O-R-h*(N-b))*w,f=h*(1-b),v&&(R=Math.round(R),f=Math.round(f));var P=b3e(N).map(function(M){return R+h*M});return s(I?P.reverse():P)}return e.domain=function(N){return arguments.length?(n(N),E()):n()},e.range=function(N){return arguments.length?([o,d]=N,o=+o,d=+d,E()):[o,d]},e.rangeRound=function(N){return[o,d]=N,o=+o,d=+d,v=!0,E()},e.bandwidth=function(){return f},e.step=function(){return h},e.round=function(N){return arguments.length?(v=!!N,E()):v},e.padding=function(N){return arguments.length?(b=Math.min(1,_=+N),E()):b},e.paddingInner=function(N){return arguments.length?(b=Math.min(1,N),E()):b},e.paddingOuter=function(N){return arguments.length?(_=+N,E()):_},e.align=function(N){return arguments.length?(w=Math.max(0,Math.min(1,N)),E()):w},e.copy=function(){return wy(n(),[o,d]).round(v).paddingInner(b).paddingOuter(_).align(w)},Ro.apply(E(),arguments)}function Ree(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Ree(n())},e}function zv(){return Ree(wy.apply(null,arguments).paddingInner(1))}function SD(e,n,s){e.prototype=n.prototype=s,s.constructor=e}function Aee(e,n){var s=Object.create(e.prototype);for(var o in n)s[o]=n[o];return s}function mb(){}var Sy=.7,gS=1/Sy,yf="\\s*([+-]?\\d+)\\s*",Ty="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Zc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",x3e=/^#([0-9a-f]{3,8})$/,_3e=new RegExp(`^rgb\\(${yf},${yf},${yf}\\)$`),E3e=new RegExp(`^rgb\\(${Zc},${Zc},${Zc}\\)$`),w3e=new RegExp(`^rgba\\(${yf},${yf},${yf},${Ty}\\)$`),S3e=new RegExp(`^rgba\\(${Zc},${Zc},${Zc},${Ty}\\)$`),T3e=new RegExp(`^hsl\\(${Ty},${Zc},${Zc}\\)$`),N3e=new RegExp(`^hsla\\(${Ty},${Zc},${Zc},${Ty}\\)$`),X9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};SD(mb,Ny,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:J9,formatHex:J9,formatHex8:C3e,formatHsl:R3e,formatRgb:Q9,toString:Q9});function J9(){return this.rgb().formatHex()}function C3e(){return this.rgb().formatHex8()}function R3e(){return Iee(this).formatHsl()}function Q9(){return this.rgb().formatRgb()}function Ny(e){var n,s;return e=(e+"").trim().toLowerCase(),(n=x3e.exec(e))?(s=n[1].length,n=parseInt(n[1],16),s===6?Z9(n):s===3?new ia(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):s===8?zE(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):s===4?zE(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=_3e.exec(e))?new ia(n[1],n[2],n[3],1):(n=E3e.exec(e))?new ia(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=w3e.exec(e))?zE(n[1],n[2],n[3],n[4]):(n=S3e.exec(e))?zE(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=T3e.exec(e))?nK(n[1],n[2]/100,n[3]/100,1):(n=N3e.exec(e))?nK(n[1],n[2]/100,n[3]/100,n[4]):X9.hasOwnProperty(e)?Z9(X9[e]):e==="transparent"?new ia(NaN,NaN,NaN,0):null}function Z9(e){return new ia(e>>16&255,e>>8&255,e&255,1)}function zE(e,n,s,o){return o<=0&&(e=n=s=NaN),new ia(e,n,s,o)}function A3e(e){return e instanceof mb||(e=Ny(e)),e?(e=e.rgb(),new ia(e.r,e.g,e.b,e.opacity)):new ia}function GP(e,n,s,o){return arguments.length===1?A3e(e):new ia(e,n,s,o??1)}function ia(e,n,s,o){this.r=+e,this.g=+n,this.b=+s,this.opacity=+o}SD(ia,GP,Aee(mb,{brighter(e){return e=e==null?gS:Math.pow(gS,e),new ia(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Sy:Math.pow(Sy,e),new ia(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ia($h(this.r),$h(this.g),$h(this.b),vS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:eK,formatHex:eK,formatHex8:I3e,formatRgb:tK,toString:tK}));function eK(){return`#${Lh(this.r)}${Lh(this.g)}${Lh(this.b)}`}function I3e(){return`#${Lh(this.r)}${Lh(this.g)}${Lh(this.b)}${Lh((isNaN(this.opacity)?1:this.opacity)*255)}`}function tK(){const e=vS(this.opacity);return`${e===1?"rgb(":"rgba("}${$h(this.r)}, ${$h(this.g)}, ${$h(this.b)}${e===1?")":`, ${e})`}`}function vS(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function $h(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Lh(e){return e=$h(e),(e<16?"0":"")+e.toString(16)}function nK(e,n,s,o){return o<=0?e=n=s=NaN:s<=0||s>=1?e=n=NaN:n<=0&&(e=NaN),new lc(e,n,s,o)}function Iee(e){if(e instanceof lc)return new lc(e.h,e.s,e.l,e.opacity);if(e instanceof mb||(e=Ny(e)),!e)return new lc;if(e instanceof lc)return e;e=e.rgb();var n=e.r/255,s=e.g/255,o=e.b/255,d=Math.min(n,s,o),h=Math.max(n,s,o),f=NaN,v=h-d,b=(h+d)/2;return v?(n===h?f=(s-o)/v+(s<o)*6:s===h?f=(o-n)/v+2:f=(n-s)/v+4,v/=b<.5?h+d:2-h-d,f*=60):v=b>0&&b<1?0:f,new lc(f,v,b,e.opacity)}function O3e(e,n,s,o){return arguments.length===1?Iee(e):new lc(e,n,s,o??1)}function lc(e,n,s,o){this.h=+e,this.s=+n,this.l=+s,this.opacity=+o}SD(lc,O3e,Aee(mb,{brighter(e){return e=e==null?gS:Math.pow(gS,e),new lc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Sy:Math.pow(Sy,e),new lc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,s=this.l,o=s+(s<.5?s:1-s)*n,d=2*s-o;return new ia(CO(e>=240?e-240:e+120,d,o),CO(e,d,o),CO(e<120?e+240:e-120,d,o),this.opacity)},clamp(){return new lc(rK(this.h),HE(this.s),HE(this.l),vS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=vS(this.opacity);return`${e===1?"hsl(":"hsla("}${rK(this.h)}, ${HE(this.s)*100}%, ${HE(this.l)*100}%${e===1?")":`, ${e})`}`}}));function rK(e){return e=(e||0)%360,e<0?e+360:e}function HE(e){return Math.max(0,Math.min(1,e||0))}function CO(e,n,s){return(e<60?n+(s-n)*e/60:e<180?s:e<240?n+(s-n)*(240-e)/60:n)*255}const TD=e=>()=>e;function P3e(e,n){return function(s){return e+s*n}}function k3e(e,n,s){return e=Math.pow(e,s),n=Math.pow(n,s)-e,s=1/s,function(o){return Math.pow(e+o*n,s)}}function j3e(e){return(e=+e)==1?Oee:function(n,s){return s-n?k3e(n,s,e):TD(isNaN(n)?s:n)}}function Oee(e,n){var s=n-e;return s?P3e(e,s):TD(isNaN(e)?n:e)}const iK=function e(n){var s=j3e(n);function o(d,h){var f=s((d=GP(d)).r,(h=GP(h)).r),v=s(d.g,h.g),b=s(d.b,h.b),_=Oee(d.opacity,h.opacity);return function(w){return d.r=f(w),d.g=v(w),d.b=b(w),d.opacity=_(w),d+""}}return o.gamma=e,o}(1);function D3e(e,n){n||(n=[]);var s=e?Math.min(n.length,e.length):0,o=n.slice(),d;return function(h){for(d=0;d<s;++d)o[d]=e[d]*(1-h)+n[d]*h;return o}}function L3e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function M3e(e,n){var s=n?n.length:0,o=e?Math.min(s,e.length):0,d=new Array(o),h=new Array(s),f;for(f=0;f<o;++f)d[f]=Ng(e[f],n[f]);for(;f<s;++f)h[f]=n[f];return function(v){for(f=0;f<o;++f)h[f]=d[f](v);return h}}function U3e(e,n){var s=new Date;return e=+e,n=+n,function(o){return s.setTime(e*(1-o)+n*o),s}}function yS(e,n){return e=+e,n=+n,function(s){return e*(1-s)+n*s}}function F3e(e,n){var s={},o={},d;(e===null||typeof e!="object")&&(e={}),(n===null||typeof n!="object")&&(n={});for(d in n)d in e?s[d]=Ng(e[d],n[d]):o[d]=n[d];return function(h){for(d in s)o[d]=s[d](h);return o}}var WP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,RO=new RegExp(WP.source,"g");function V3e(e){return function(){return e}}function B3e(e){return function(n){return e(n)+""}}function G3e(e,n){var s=WP.lastIndex=RO.lastIndex=0,o,d,h,f=-1,v=[],b=[];for(e=e+"",n=n+"";(o=WP.exec(e))&&(d=RO.exec(n));)(h=d.index)>s&&(h=n.slice(s,h),v[f]?v[f]+=h:v[++f]=h),(o=o[0])===(d=d[0])?v[f]?v[f]+=d:v[++f]=d:(v[++f]=null,b.push({i:f,x:yS(o,d)})),s=RO.lastIndex;return s<n.length&&(h=n.slice(s),v[f]?v[f]+=h:v[++f]=h),v.length<2?b[0]?B3e(b[0].x):V3e(n):(n=b.length,function(_){for(var w=0,E;w<n;++w)v[(E=b[w]).i]=E.x(_);return v.join("")})}function Ng(e,n){var s=typeof n,o;return n==null||s==="boolean"?TD(n):(s==="number"?yS:s==="string"?(o=Ny(n))?(n=o,iK):G3e:n instanceof Ny?iK:n instanceof Date?U3e:L3e(n)?D3e:Array.isArray(n)?M3e:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?F3e:yS)(e,n)}function ND(e,n){return e=+e,n=+n,function(s){return Math.round(e*(1-s)+n*s)}}function W3e(e,n){n===void 0&&(n=e,e=Ng);for(var s=0,o=n.length-1,d=n[0],h=new Array(o<0?0:o);s<o;)h[s]=e(d,d=n[++s]);return function(f){var v=Math.max(0,Math.min(o-1,Math.floor(f*=o)));return h[v](f-v)}}function $3e(e){return function(){return e}}function bS(e){return+e}var sK=[0,1];function ks(e){return e}function $P(e,n){return(n-=e=+e)?function(s){return(s-e)/n}:$3e(isNaN(n)?NaN:.5)}function z3e(e,n){var s;return e>n&&(s=e,e=n,n=s),function(o){return Math.max(e,Math.min(n,o))}}function H3e(e,n,s){var o=e[0],d=e[1],h=n[0],f=n[1];return d<o?(o=$P(d,o),h=s(f,h)):(o=$P(o,d),h=s(h,f)),function(v){return h(o(v))}}function K3e(e,n,s){var o=Math.min(e.length,n.length)-1,d=new Array(o),h=new Array(o),f=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++f<o;)d[f]=$P(e[f],e[f+1]),h[f]=s(n[f],n[f+1]);return function(v){var b=pb(e,v,1,o)-1;return h[b](d[b](v))}}function fb(e,n){return n.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function XT(){var e=sK,n=sK,s=Ng,o,d,h,f=ks,v,b,_;function w(){var N=Math.min(e.length,n.length);return f!==ks&&(f=z3e(e[0],e[N-1])),v=N>2?K3e:H3e,b=_=null,E}function E(N){return N==null||isNaN(N=+N)?h:(b||(b=v(e.map(o),n,s)))(o(f(N)))}return E.invert=function(N){return f(d((_||(_=v(n,e.map(o),yS)))(N)))},E.domain=function(N){return arguments.length?(e=Array.from(N,bS),w()):e.slice()},E.range=function(N){return arguments.length?(n=Array.from(N),w()):n.slice()},E.rangeRound=function(N){return n=Array.from(N),s=ND,w()},E.clamp=function(N){return arguments.length?(f=N?!0:ks,w()):f!==ks},E.interpolate=function(N){return arguments.length?(s=N,w()):s},E.unknown=function(N){return arguments.length?(h=N,E):h},function(N,I){return o=N,d=I,w()}}function CD(){return XT()(ks,ks)}function Y3e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function xS(e,n){if((s=(e=n?e.toExponential(n-1):e.toExponential()).indexOf("e"))<0)return null;var s,o=e.slice(0,s);return[o.length>1?o[0]+o.slice(2):o,+e.slice(s+1)]}function Uf(e){return e=xS(Math.abs(e)),e?e[1]:NaN}function q3e(e,n){return function(s,o){for(var d=s.length,h=[],f=0,v=e[0],b=0;d>0&&v>0&&(b+v+1>o&&(v=Math.max(1,o-b)),h.push(s.substring(d-=v,d+v)),!((b+=v+1)>o));)v=e[f=(f+1)%e.length];return h.reverse().join(n)}}function X3e(e){return function(n){return n.replace(/[0-9]/g,function(s){return e[+s]})}}var J3e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Cy(e){if(!(n=J3e.exec(e)))throw new Error("invalid format: "+e);var n;return new RD({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}Cy.prototype=RD.prototype;function RD(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}RD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Q3e(e){e:for(var n=e.length,s=1,o=-1,d;s<n;++s)switch(e[s]){case".":o=d=s;break;case"0":o===0&&(o=s),d=s;break;default:if(!+e[s])break e;o>0&&(o=0);break}return o>0?e.slice(0,o)+e.slice(d+1):e}var Pee;function Z3e(e,n){var s=xS(e,n);if(!s)return e+"";var o=s[0],d=s[1],h=d-(Pee=Math.max(-8,Math.min(8,Math.floor(d/3)))*3)+1,f=o.length;return h===f?o:h>f?o+new Array(h-f+1).join("0"):h>0?o.slice(0,h)+"."+o.slice(h):"0."+new Array(1-h).join("0")+xS(e,Math.max(0,n+h-1))[0]}function aK(e,n){var s=xS(e,n);if(!s)return e+"";var o=s[0],d=s[1];return d<0?"0."+new Array(-d).join("0")+o:o.length>d+1?o.slice(0,d+1)+"."+o.slice(d+1):o+new Array(d-o.length+2).join("0")}const oK={"%":(e,n)=>(e*100).toFixed(n),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Y3e,e:(e,n)=>e.toExponential(n),f:(e,n)=>e.toFixed(n),g:(e,n)=>e.toPrecision(n),o:e=>Math.round(e).toString(8),p:(e,n)=>aK(e*100,n),r:aK,s:Z3e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function cK(e){return e}var lK=Array.prototype.map,dK=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function eFe(e){var n=e.grouping===void 0||e.thousands===void 0?cK:q3e(lK.call(e.grouping,Number),e.thousands+""),s=e.currency===void 0?"":e.currency[0]+"",o=e.currency===void 0?"":e.currency[1]+"",d=e.decimal===void 0?".":e.decimal+"",h=e.numerals===void 0?cK:X3e(lK.call(e.numerals,String)),f=e.percent===void 0?"%":e.percent+"",v=e.minus===void 0?"":e.minus+"",b=e.nan===void 0?"NaN":e.nan+"";function _(E){E=Cy(E);var N=E.fill,I=E.align,R=E.sign,O=E.symbol,P=E.zero,M=E.width,D=E.comma,U=E.precision,B=E.trim,G=E.type;G==="n"?(D=!0,G="g"):oK[G]||(U===void 0&&(U=12),B=!0,G="g"),(P||N==="0"&&I==="=")&&(P=!0,N="0",I="=");var $=O==="$"?s:O==="#"&&/[boxX]/.test(G)?"0"+G.toLowerCase():"",q=O==="$"?o:/[%p]/.test(G)?f:"",X=oK[G],ee=/[defgprs%]/.test(G);U=U===void 0?6:/[gprs]/.test(G)?Math.max(1,Math.min(21,U)):Math.max(0,Math.min(20,U));function ce(Q){var ae=$,ve=q,le,fe,re;if(G==="c")ve=X(Q)+ve,Q="";else{Q=+Q;var he=Q<0||1/Q<0;if(Q=isNaN(Q)?b:X(Math.abs(Q),U),B&&(Q=Q3e(Q)),he&&+Q==0&&R!=="+"&&(he=!1),ae=(he?R==="("?R:v:R==="-"||R==="("?"":R)+ae,ve=(G==="s"?dK[8+Pee/3]:"")+ve+(he&&R==="("?")":""),ee){for(le=-1,fe=Q.length;++le<fe;)if(re=Q.charCodeAt(le),48>re||re>57){ve=(re===46?d+Q.slice(le+1):Q.slice(le))+ve,Q=Q.slice(0,le);break}}}D&&!P&&(Q=n(Q,1/0));var J=ae.length+Q.length+ve.length,ue=J<M?new Array(M-J+1).join(N):"";switch(D&&P&&(Q=n(ue+Q,ue.length?M-ve.length:1/0),ue=""),I){case"<":Q=ae+Q+ve+ue;break;case"=":Q=ae+ue+Q+ve;break;case"^":Q=ue.slice(0,J=ue.length>>1)+ae+Q+ve+ue.slice(J);break;default:Q=ue+ae+Q+ve;break}return h(Q)}return ce.toString=function(){return E+""},ce}function w(E,N){var I=_((E=Cy(E),E.type="f",E)),R=Math.max(-8,Math.min(8,Math.floor(Uf(N)/3)))*3,O=Math.pow(10,-R),P=dK[8+R/3];return function(M){return I(O*M)+P}}return{format:_,formatPrefix:w}}var KE,AD,kee;tFe({thousands:",",grouping:[3],currency:["$",""]});function tFe(e){return KE=eFe(e),AD=KE.format,kee=KE.formatPrefix,KE}function nFe(e){return Math.max(0,-Uf(Math.abs(e)))}function rFe(e,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Uf(n)/3)))*3-Uf(Math.abs(e)))}function iFe(e,n){return e=Math.abs(e),n=Math.abs(n)-e,Math.max(0,Uf(n)-Uf(e))+1}function jee(e,n,s,o){var d=VP(e,n,s),h;switch(o=Cy(o??",f"),o.type){case"s":{var f=Math.max(Math.abs(e),Math.abs(n));return o.precision==null&&!isNaN(h=rFe(d,f))&&(o.precision=h),kee(o,f)}case"":case"e":case"g":case"p":case"r":{o.precision==null&&!isNaN(h=iFe(d,Math.max(Math.abs(e),Math.abs(n))))&&(o.precision=h-(o.type==="e"));break}case"f":case"%":{o.precision==null&&!isNaN(h=nFe(d))&&(o.precision=h-(o.type==="%")*2);break}}return AD(o)}function wu(e){var n=e.domain;return e.ticks=function(s){var o=n();return UP(o[0],o[o.length-1],s??10)},e.tickFormat=function(s,o){var d=n();return jee(d[0],d[d.length-1],s??10,o)},e.nice=function(s){s==null&&(s=10);var o=n(),d=0,h=o.length-1,f=o[d],v=o[h],b,_,w=10;for(v<f&&(_=f,f=v,v=_,_=d,d=h,h=_);w-- >0;){if(_=FP(f,v,s),_===b)return o[d]=f,o[h]=v,n(o);if(_>0)f=Math.floor(f/_)*_,v=Math.ceil(v/_)*_;else if(_<0)f=Math.ceil(f*_)/_,v=Math.floor(v*_)/_;else break;b=_}return e},e}function _S(){var e=CD();return e.copy=function(){return fb(e,_S())},Ro.apply(e,arguments),wu(e)}function Dee(e){var n;function s(o){return o==null||isNaN(o=+o)?n:o}return s.invert=s,s.domain=s.range=function(o){return arguments.length?(e=Array.from(o,bS),s):e.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.copy=function(){return Dee(e).unknown(n)},e=arguments.length?Array.from(e,bS):[0,1],wu(s)}function Lee(e,n){e=e.slice();var s=0,o=e.length-1,d=e[s],h=e[o],f;return h<d&&(f=s,s=o,o=f,f=d,d=h,h=f),e[s]=n.floor(d),e[o]=n.ceil(h),e}function uK(e){return Math.log(e)}function hK(e){return Math.exp(e)}function sFe(e){return-Math.log(-e)}function aFe(e){return-Math.exp(-e)}function oFe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function cFe(e){return e===10?oFe:e===Math.E?Math.exp:n=>Math.pow(e,n)}function lFe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),n=>Math.log(n)/e)}function pK(e){return(n,s)=>-e(-n,s)}function ID(e){const n=e(uK,hK),s=n.domain;let o=10,d,h;function f(){return d=lFe(o),h=cFe(o),s()[0]<0?(d=pK(d),h=pK(h),e(sFe,aFe)):e(uK,hK),n}return n.base=function(v){return arguments.length?(o=+v,f()):o},n.domain=function(v){return arguments.length?(s(v),f()):s()},n.ticks=v=>{const b=s();let _=b[0],w=b[b.length-1];const E=w<_;E&&([_,w]=[w,_]);let N=d(_),I=d(w),R,O;const P=v==null?10:+v;let M=[];if(!(o%1)&&I-N<P){if(N=Math.floor(N),I=Math.ceil(I),_>0){for(;N<=I;++N)for(R=1;R<o;++R)if(O=N<0?R/h(-N):R*h(N),!(O<_)){if(O>w)break;M.push(O)}}else for(;N<=I;++N)for(R=o-1;R>=1;--R)if(O=N>0?R/h(-N):R*h(N),!(O<_)){if(O>w)break;M.push(O)}M.length*2<P&&(M=UP(_,w,P))}else M=UP(N,I,Math.min(I-N,P)).map(h);return E?M.reverse():M},n.tickFormat=(v,b)=>{if(v==null&&(v=10),b==null&&(b=o===10?"s":","),typeof b!="function"&&(!(o%1)&&(b=Cy(b)).precision==null&&(b.trim=!0),b=AD(b)),v===1/0)return b;const _=Math.max(1,o*v/n.ticks().length);return w=>{let E=w/h(Math.round(d(w)));return E*o<o-.5&&(E*=o),E<=_?b(w):""}},n.nice=()=>s(Lee(s(),{floor:v=>h(Math.floor(d(v))),ceil:v=>h(Math.ceil(d(v)))})),n}function Mee(){const e=ID(XT()).domain([1,10]);return e.copy=()=>fb(e,Mee()).base(e.base()),Ro.apply(e,arguments),e}function mK(e){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/e))}}function fK(e){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*e}}function OD(e){var n=1,s=e(mK(n),fK(n));return s.constant=function(o){return arguments.length?e(mK(n=+o),fK(n)):n},wu(s)}function Uee(){var e=OD(XT());return e.copy=function(){return fb(e,Uee()).constant(e.constant())},Ro.apply(e,arguments)}function gK(e){return function(n){return n<0?-Math.pow(-n,e):Math.pow(n,e)}}function dFe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function uFe(e){return e<0?-e*e:e*e}function PD(e){var n=e(ks,ks),s=1;function o(){return s===1?e(ks,ks):s===.5?e(dFe,uFe):e(gK(s),gK(1/s))}return n.exponent=function(d){return arguments.length?(s=+d,o()):s},wu(n)}function kD(){var e=PD(XT());return e.copy=function(){return fb(e,kD()).exponent(e.exponent())},Ro.apply(e,arguments),e}function hFe(){return kD.apply(null,arguments).exponent(.5)}function vK(e){return Math.sign(e)*e*e}function pFe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Fee(){var e=CD(),n=[0,1],s=!1,o;function d(h){var f=pFe(e(h));return isNaN(f)?o:s?Math.round(f):f}return d.invert=function(h){return e.invert(vK(h))},d.domain=function(h){return arguments.length?(e.domain(h),d):e.domain()},d.range=function(h){return arguments.length?(e.range((n=Array.from(h,bS)).map(vK)),d):n.slice()},d.rangeRound=function(h){return d.range(h).round(!0)},d.round=function(h){return arguments.length?(s=!!h,d):s},d.clamp=function(h){return arguments.length?(e.clamp(h),d):e.clamp()},d.unknown=function(h){return arguments.length?(o=h,d):o},d.copy=function(){return Fee(e.domain(),n).round(s).clamp(e.clamp()).unknown(o)},Ro.apply(d,arguments),wu(d)}function Vee(){var e=[],n=[],s=[],o;function d(){var f=0,v=Math.max(1,n.length);for(s=new Array(v-1);++f<v;)s[f-1]=y3e(e,f/v);return h}function h(f){return f==null||isNaN(f=+f)?o:n[pb(s,f)]}return h.invertExtent=function(f){var v=n.indexOf(f);return v<0?[NaN,NaN]:[v>0?s[v-1]:e[0],v<s.length?s[v]:e[e.length-1]]},h.domain=function(f){if(!arguments.length)return e.slice();e=[];for(let v of f)v!=null&&!isNaN(v=+v)&&e.push(v);return e.sort(uu),d()},h.range=function(f){return arguments.length?(n=Array.from(f),d()):n.slice()},h.unknown=function(f){return arguments.length?(o=f,h):o},h.quantiles=function(){return s.slice()},h.copy=function(){return Vee().domain(e).range(n).unknown(o)},Ro.apply(h,arguments)}function Bee(){var e=0,n=1,s=1,o=[.5],d=[0,1],h;function f(b){return b!=null&&b<=b?d[pb(o,b,0,s)]:h}function v(){var b=-1;for(o=new Array(s);++b<s;)o[b]=((b+1)*n-(b-s)*e)/(s+1);return f}return f.domain=function(b){return arguments.length?([e,n]=b,e=+e,n=+n,v()):[e,n]},f.range=function(b){return arguments.length?(s=(d=Array.from(b)).length-1,v()):d.slice()},f.invertExtent=function(b){var _=d.indexOf(b);return _<0?[NaN,NaN]:_<1?[e,o[0]]:_>=s?[o[s-1],n]:[o[_-1],o[_]]},f.unknown=function(b){return arguments.length&&(h=b),f},f.thresholds=function(){return o.slice()},f.copy=function(){return Bee().domain([e,n]).range(d).unknown(h)},Ro.apply(wu(f),arguments)}function Gee(){var e=[.5],n=[0,1],s,o=1;function d(h){return h!=null&&h<=h?n[pb(e,h,0,o)]:s}return d.domain=function(h){return arguments.length?(e=Array.from(h),o=Math.min(e.length,n.length-1),d):e.slice()},d.range=function(h){return arguments.length?(n=Array.from(h),o=Math.min(e.length,n.length-1),d):n.slice()},d.invertExtent=function(h){var f=n.indexOf(h);return[e[f-1],e[f]]},d.unknown=function(h){return arguments.length?(s=h,d):s},d.copy=function(){return Gee().domain(e).range(n).unknown(s)},Ro.apply(d,arguments)}const AO=new Date,IO=new Date;function Ai(e,n,s,o){function d(h){return e(h=arguments.length===0?new Date:new Date(+h)),h}return d.floor=h=>(e(h=new Date(+h)),h),d.ceil=h=>(e(h=new Date(h-1)),n(h,1),e(h),h),d.round=h=>{const f=d(h),v=d.ceil(h);return h-f<v-h?f:v},d.offset=(h,f)=>(n(h=new Date(+h),f==null?1:Math.floor(f)),h),d.range=(h,f,v)=>{const b=[];if(h=d.ceil(h),v=v==null?1:Math.floor(v),!(h<f)||!(v>0))return b;let _;do b.push(_=new Date(+h)),n(h,v),e(h);while(_<h&&h<f);return b},d.filter=h=>Ai(f=>{if(f>=f)for(;e(f),!h(f);)f.setTime(f-1)},(f,v)=>{if(f>=f)if(v<0)for(;++v<=0;)for(;n(f,-1),!h(f););else for(;--v>=0;)for(;n(f,1),!h(f););}),s&&(d.count=(h,f)=>(AO.setTime(+h),IO.setTime(+f),e(AO),e(IO),Math.floor(s(AO,IO))),d.every=h=>(h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?d.filter(o?f=>o(f)%h===0:f=>d.count(0,f)%h===0):d)),d}const ES=Ai(()=>{},(e,n)=>{e.setTime(+e+n)},(e,n)=>n-e);ES.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ai(n=>{n.setTime(Math.floor(n/e)*e)},(n,s)=>{n.setTime(+n+s*e)},(n,s)=>(s-n)/e):ES);ES.range;const Pl=1e3,yo=Pl*60,kl=yo*60,Kl=kl*24,jD=Kl*7,yK=Kl*30,OO=Kl*365,Mh=Ai(e=>{e.setTime(e-e.getMilliseconds())},(e,n)=>{e.setTime(+e+n*Pl)},(e,n)=>(n-e)/Pl,e=>e.getUTCSeconds());Mh.range;const DD=Ai(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Pl)},(e,n)=>{e.setTime(+e+n*yo)},(e,n)=>(n-e)/yo,e=>e.getMinutes());DD.range;const LD=Ai(e=>{e.setUTCSeconds(0,0)},(e,n)=>{e.setTime(+e+n*yo)},(e,n)=>(n-e)/yo,e=>e.getUTCMinutes());LD.range;const MD=Ai(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Pl-e.getMinutes()*yo)},(e,n)=>{e.setTime(+e+n*kl)},(e,n)=>(n-e)/kl,e=>e.getHours());MD.range;const UD=Ai(e=>{e.setUTCMinutes(0,0,0)},(e,n)=>{e.setTime(+e+n*kl)},(e,n)=>(n-e)/kl,e=>e.getUTCHours());UD.range;const gb=Ai(e=>e.setHours(0,0,0,0),(e,n)=>e.setDate(e.getDate()+n),(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*yo)/Kl,e=>e.getDate()-1);gb.range;const JT=Ai(e=>{e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n)},(e,n)=>(n-e)/Kl,e=>e.getUTCDate()-1);JT.range;const Wee=Ai(e=>{e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n)},(e,n)=>(n-e)/Kl,e=>Math.floor(e/Kl));Wee.range;function dp(e){return Ai(n=>{n.setDate(n.getDate()-(n.getDay()+7-e)%7),n.setHours(0,0,0,0)},(n,s)=>{n.setDate(n.getDate()+s*7)},(n,s)=>(s-n-(s.getTimezoneOffset()-n.getTimezoneOffset())*yo)/jD)}const QT=dp(0),wS=dp(1),mFe=dp(2),fFe=dp(3),Ff=dp(4),gFe=dp(5),vFe=dp(6);QT.range;wS.range;mFe.range;fFe.range;Ff.range;gFe.range;vFe.range;function up(e){return Ai(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7),n.setUTCHours(0,0,0,0)},(n,s)=>{n.setUTCDate(n.getUTCDate()+s*7)},(n,s)=>(s-n)/jD)}const ZT=up(0),SS=up(1),yFe=up(2),bFe=up(3),Vf=up(4),xFe=up(5),_Fe=up(6);ZT.range;SS.range;yFe.range;bFe.range;Vf.range;xFe.range;_Fe.range;const FD=Ai(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,n)=>{e.setMonth(e.getMonth()+n)},(e,n)=>n.getMonth()-e.getMonth()+(n.getFullYear()-e.getFullYear())*12,e=>e.getMonth());FD.range;const VD=Ai(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCMonth(e.getUTCMonth()+n)},(e,n)=>n.getUTCMonth()-e.getUTCMonth()+(n.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());VD.range;const Yl=Ai(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n)},(e,n)=>n.getFullYear()-e.getFullYear(),e=>e.getFullYear());Yl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ai(n=>{n.setFullYear(Math.floor(n.getFullYear()/e)*e),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,s)=>{n.setFullYear(n.getFullYear()+s*e)});Yl.range;const ql=Ai(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n)},(e,n)=>n.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ql.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ai(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/e)*e),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,s)=>{n.setUTCFullYear(n.getUTCFullYear()+s*e)});ql.range;function $ee(e,n,s,o,d,h){const f=[[Mh,1,Pl],[Mh,5,5*Pl],[Mh,15,15*Pl],[Mh,30,30*Pl],[h,1,yo],[h,5,5*yo],[h,15,15*yo],[h,30,30*yo],[d,1,kl],[d,3,3*kl],[d,6,6*kl],[d,12,12*kl],[o,1,Kl],[o,2,2*Kl],[s,1,jD],[n,1,yK],[n,3,3*yK],[e,1,OO]];function v(_,w,E){const N=w<_;N&&([_,w]=[w,_]);const I=E&&typeof E.range=="function"?E:b(_,w,E),R=I?I.range(_,+w+1):[];return N?R.reverse():R}function b(_,w,E){const N=Math.abs(w-_)/E,I=ED(([,,P])=>P).right(f,N);if(I===f.length)return e.every(VP(_/OO,w/OO,E));if(I===0)return ES.every(Math.max(VP(_,w,E),1));const[R,O]=f[N/f[I-1][2]<f[I][2]/N?I-1:I];return R.every(O)}return[v,b]}const[EFe,wFe]=$ee(ql,VD,ZT,Wee,UD,LD),[SFe,TFe]=$ee(Yl,FD,QT,gb,MD,DD);function PO(e){if(0<=e.y&&e.y<100){var n=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return n.setFullYear(e.y),n}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function kO(e){if(0<=e.y&&e.y<100){var n=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return n.setUTCFullYear(e.y),n}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function xv(e,n,s){return{y:e,m:n,d:s,H:0,M:0,S:0,L:0}}function NFe(e){var n=e.dateTime,s=e.date,o=e.time,d=e.periods,h=e.days,f=e.shortDays,v=e.months,b=e.shortMonths,_=_v(d),w=Ev(d),E=_v(h),N=Ev(h),I=_v(f),R=Ev(f),O=_v(v),P=Ev(v),M=_v(b),D=Ev(b),U={a:he,A:J,b:ue,B:Ee,c:null,d:SK,e:SK,f:qFe,g:sVe,G:oVe,H:HFe,I:KFe,j:YFe,L:zee,m:XFe,M:JFe,p:Fe,q:ke,Q:CK,s:RK,S:QFe,u:ZFe,U:eVe,V:tVe,w:nVe,W:rVe,x:null,X:null,y:iVe,Y:aVe,Z:cVe,"%":NK},B={a:Ge,A:De,b:Pe,B:Ve,c:null,d:TK,e:TK,f:hVe,g:EVe,G:SVe,H:lVe,I:dVe,j:uVe,L:Kee,m:pVe,M:mVe,p:it,q:Mt,Q:CK,s:RK,S:fVe,u:gVe,U:vVe,V:yVe,w:bVe,W:xVe,x:null,X:null,y:_Ve,Y:wVe,Z:TVe,"%":NK},G={a:ce,A:Q,b:ae,B:ve,c:le,d:EK,e:EK,f:GFe,g:_K,G:xK,H:wK,I:wK,j:UFe,L:BFe,m:MFe,M:FFe,p:ee,q:LFe,Q:$Fe,s:zFe,S:VFe,u:OFe,U:PFe,V:kFe,w:IFe,W:jFe,x:fe,X:re,y:_K,Y:xK,Z:DFe,"%":WFe};U.x=$(s,U),U.X=$(o,U),U.c=$(n,U),B.x=$(s,B),B.X=$(o,B),B.c=$(n,B);function $(tt,ft){return function(Rt){var Te=[],st=-1,ct=0,zt=tt.length,Ke,xe,Je;for(Rt instanceof Date||(Rt=new Date(+Rt));++st<zt;)tt.charCodeAt(st)===37&&(Te.push(tt.slice(ct,st)),(xe=bK[Ke=tt.charAt(++st)])!=null?Ke=tt.charAt(++st):xe=Ke==="e"?" ":"0",(Je=ft[Ke])&&(Ke=Je(Rt,xe)),Te.push(Ke),ct=st+1);return Te.push(tt.slice(ct,st)),Te.join("")}}function q(tt,ft){return function(Rt){var Te=xv(1900,void 0,1),st=X(Te,tt,Rt+="",0),ct,zt;if(st!=Rt.length)return null;if("Q"in Te)return new Date(Te.Q);if("s"in Te)return new Date(Te.s*1e3+("L"in Te?Te.L:0));if(ft&&!("Z"in Te)&&(Te.Z=0),"p"in Te&&(Te.H=Te.H%12+Te.p*12),Te.m===void 0&&(Te.m="q"in Te?Te.q:0),"V"in Te){if(Te.V<1||Te.V>53)return null;"w"in Te||(Te.w=1),"Z"in Te?(ct=kO(xv(Te.y,0,1)),zt=ct.getUTCDay(),ct=zt>4||zt===0?SS.ceil(ct):SS(ct),ct=JT.offset(ct,(Te.V-1)*7),Te.y=ct.getUTCFullYear(),Te.m=ct.getUTCMonth(),Te.d=ct.getUTCDate()+(Te.w+6)%7):(ct=PO(xv(Te.y,0,1)),zt=ct.getDay(),ct=zt>4||zt===0?wS.ceil(ct):wS(ct),ct=gb.offset(ct,(Te.V-1)*7),Te.y=ct.getFullYear(),Te.m=ct.getMonth(),Te.d=ct.getDate()+(Te.w+6)%7)}else("W"in Te||"U"in Te)&&("w"in Te||(Te.w="u"in Te?Te.u%7:"W"in Te?1:0),zt="Z"in Te?kO(xv(Te.y,0,1)).getUTCDay():PO(xv(Te.y,0,1)).getDay(),Te.m=0,Te.d="W"in Te?(Te.w+6)%7+Te.W*7-(zt+5)%7:Te.w+Te.U*7-(zt+6)%7);return"Z"in Te?(Te.H+=Te.Z/100|0,Te.M+=Te.Z%100,kO(Te)):PO(Te)}}function X(tt,ft,Rt,Te){for(var st=0,ct=ft.length,zt=Rt.length,Ke,xe;st<ct;){if(Te>=zt)return-1;if(Ke=ft.charCodeAt(st++),Ke===37){if(Ke=ft.charAt(st++),xe=G[Ke in bK?ft.charAt(st++):Ke],!xe||(Te=xe(tt,Rt,Te))<0)return-1}else if(Ke!=Rt.charCodeAt(Te++))return-1}return Te}function ee(tt,ft,Rt){var Te=_.exec(ft.slice(Rt));return Te?(tt.p=w.get(Te[0].toLowerCase()),Rt+Te[0].length):-1}function ce(tt,ft,Rt){var Te=I.exec(ft.slice(Rt));return Te?(tt.w=R.get(Te[0].toLowerCase()),Rt+Te[0].length):-1}function Q(tt,ft,Rt){var Te=E.exec(ft.slice(Rt));return Te?(tt.w=N.get(Te[0].toLowerCase()),Rt+Te[0].length):-1}function ae(tt,ft,Rt){var Te=M.exec(ft.slice(Rt));return Te?(tt.m=D.get(Te[0].toLowerCase()),Rt+Te[0].length):-1}function ve(tt,ft,Rt){var Te=O.exec(ft.slice(Rt));return Te?(tt.m=P.get(Te[0].toLowerCase()),Rt+Te[0].length):-1}function le(tt,ft,Rt){return X(tt,n,ft,Rt)}function fe(tt,ft,Rt){return X(tt,s,ft,Rt)}function re(tt,ft,Rt){return X(tt,o,ft,Rt)}function he(tt){return f[tt.getDay()]}function J(tt){return h[tt.getDay()]}function ue(tt){return b[tt.getMonth()]}function Ee(tt){return v[tt.getMonth()]}function Fe(tt){return d[+(tt.getHours()>=12)]}function ke(tt){return 1+~~(tt.getMonth()/3)}function Ge(tt){return f[tt.getUTCDay()]}function De(tt){return h[tt.getUTCDay()]}function Pe(tt){return b[tt.getUTCMonth()]}function Ve(tt){return v[tt.getUTCMonth()]}function it(tt){return d[+(tt.getUTCHours()>=12)]}function Mt(tt){return 1+~~(tt.getUTCMonth()/3)}return{format:function(tt){var ft=$(tt+="",U);return ft.toString=function(){return tt},ft},parse:function(tt){var ft=q(tt+="",!1);return ft.toString=function(){return tt},ft},utcFormat:function(tt){var ft=$(tt+="",B);return ft.toString=function(){return tt},ft},utcParse:function(tt){var ft=q(tt+="",!0);return ft.toString=function(){return tt},ft}}}var bK={"-":"",_:" ",0:"0"},Gi=/^\s*\d+/,CFe=/^%/,RFe=/[\\^$*+?|[\]().{}]/g;function Hn(e,n,s){var o=e<0?"-":"",d=(o?-e:e)+"",h=d.length;return o+(h<s?new Array(s-h+1).join(n)+d:d)}function AFe(e){return e.replace(RFe,"\\$&")}function _v(e){return new RegExp("^(?:"+e.map(AFe).join("|")+")","i")}function Ev(e){return new Map(e.map((n,s)=>[n.toLowerCase(),s]))}function IFe(e,n,s){var o=Gi.exec(n.slice(s,s+1));return o?(e.w=+o[0],s+o[0].length):-1}function OFe(e,n,s){var o=Gi.exec(n.slice(s,s+1));return o?(e.u=+o[0],s+o[0].length):-1}function PFe(e,n,s){var o=Gi.exec(n.slice(s,s+2));return o?(e.U=+o[0],s+o[0].length):-1}function kFe(e,n,s){var o=Gi.exec(n.slice(s,s+2));return o?(e.V=+o[0],s+o[0].length):-1}function jFe(e,n,s){var o=Gi.exec(n.slice(s,s+2));return o?(e.W=+o[0],s+o[0].length):-1}function xK(e,n,s){var o=Gi.exec(n.slice(s,s+4));return o?(e.y=+o[0],s+o[0].length):-1}function _K(e,n,s){var o=Gi.exec(n.slice(s,s+2));return o?(e.y=+o[0]+(+o[0]>68?1900:2e3),s+o[0].length):-1}function DFe(e,n,s){var o=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(s,s+6));return o?(e.Z=o[1]?0:-(o[2]+(o[3]||"00")),s+o[0].length):-1}function LFe(e,n,s){var o=Gi.exec(n.slice(s,s+1));return o?(e.q=o[0]*3-3,s+o[0].length):-1}function MFe(e,n,s){var o=Gi.exec(n.slice(s,s+2));return o?(e.m=o[0]-1,s+o[0].length):-1}function EK(e,n,s){var o=Gi.exec(n.slice(s,s+2));return o?(e.d=+o[0],s+o[0].length):-1}function UFe(e,n,s){var o=Gi.exec(n.slice(s,s+3));return o?(e.m=0,e.d=+o[0],s+o[0].length):-1}function wK(e,n,s){var o=Gi.exec(n.slice(s,s+2));return o?(e.H=+o[0],s+o[0].length):-1}function FFe(e,n,s){var o=Gi.exec(n.slice(s,s+2));return o?(e.M=+o[0],s+o[0].length):-1}function VFe(e,n,s){var o=Gi.exec(n.slice(s,s+2));return o?(e.S=+o[0],s+o[0].length):-1}function BFe(e,n,s){var o=Gi.exec(n.slice(s,s+3));return o?(e.L=+o[0],s+o[0].length):-1}function GFe(e,n,s){var o=Gi.exec(n.slice(s,s+6));return o?(e.L=Math.floor(o[0]/1e3),s+o[0].length):-1}function WFe(e,n,s){var o=CFe.exec(n.slice(s,s+1));return o?s+o[0].length:-1}function $Fe(e,n,s){var o=Gi.exec(n.slice(s));return o?(e.Q=+o[0],s+o[0].length):-1}function zFe(e,n,s){var o=Gi.exec(n.slice(s));return o?(e.s=+o[0],s+o[0].length):-1}function SK(e,n){return Hn(e.getDate(),n,2)}function HFe(e,n){return Hn(e.getHours(),n,2)}function KFe(e,n){return Hn(e.getHours()%12||12,n,2)}function YFe(e,n){return Hn(1+gb.count(Yl(e),e),n,3)}function zee(e,n){return Hn(e.getMilliseconds(),n,3)}function qFe(e,n){return zee(e,n)+"000"}function XFe(e,n){return Hn(e.getMonth()+1,n,2)}function JFe(e,n){return Hn(e.getMinutes(),n,2)}function QFe(e,n){return Hn(e.getSeconds(),n,2)}function ZFe(e){var n=e.getDay();return n===0?7:n}function eVe(e,n){return Hn(QT.count(Yl(e)-1,e),n,2)}function Hee(e){var n=e.getDay();return n>=4||n===0?Ff(e):Ff.ceil(e)}function tVe(e,n){return e=Hee(e),Hn(Ff.count(Yl(e),e)+(Yl(e).getDay()===4),n,2)}function nVe(e){return e.getDay()}function rVe(e,n){return Hn(wS.count(Yl(e)-1,e),n,2)}function iVe(e,n){return Hn(e.getFullYear()%100,n,2)}function sVe(e,n){return e=Hee(e),Hn(e.getFullYear()%100,n,2)}function aVe(e,n){return Hn(e.getFullYear()%1e4,n,4)}function oVe(e,n){var s=e.getDay();return e=s>=4||s===0?Ff(e):Ff.ceil(e),Hn(e.getFullYear()%1e4,n,4)}function cVe(e){var n=e.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+Hn(n/60|0,"0",2)+Hn(n%60,"0",2)}function TK(e,n){return Hn(e.getUTCDate(),n,2)}function lVe(e,n){return Hn(e.getUTCHours(),n,2)}function dVe(e,n){return Hn(e.getUTCHours()%12||12,n,2)}function uVe(e,n){return Hn(1+JT.count(ql(e),e),n,3)}function Kee(e,n){return Hn(e.getUTCMilliseconds(),n,3)}function hVe(e,n){return Kee(e,n)+"000"}function pVe(e,n){return Hn(e.getUTCMonth()+1,n,2)}function mVe(e,n){return Hn(e.getUTCMinutes(),n,2)}function fVe(e,n){return Hn(e.getUTCSeconds(),n,2)}function gVe(e){var n=e.getUTCDay();return n===0?7:n}function vVe(e,n){return Hn(ZT.count(ql(e)-1,e),n,2)}function Yee(e){var n=e.getUTCDay();return n>=4||n===0?Vf(e):Vf.ceil(e)}function yVe(e,n){return e=Yee(e),Hn(Vf.count(ql(e),e)+(ql(e).getUTCDay()===4),n,2)}function bVe(e){return e.getUTCDay()}function xVe(e,n){return Hn(SS.count(ql(e)-1,e),n,2)}function _Ve(e,n){return Hn(e.getUTCFullYear()%100,n,2)}function EVe(e,n){return e=Yee(e),Hn(e.getUTCFullYear()%100,n,2)}function wVe(e,n){return Hn(e.getUTCFullYear()%1e4,n,4)}function SVe(e,n){var s=e.getUTCDay();return e=s>=4||s===0?Vf(e):Vf.ceil(e),Hn(e.getUTCFullYear()%1e4,n,4)}function TVe(){return"+0000"}function NK(){return"%"}function CK(e){return+e}function RK(e){return Math.floor(+e/1e3)}var Bm,qee,Xee;NVe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function NVe(e){return Bm=NFe(e),qee=Bm.format,Bm.parse,Xee=Bm.utcFormat,Bm.utcParse,Bm}function CVe(e){return new Date(e)}function RVe(e){return e instanceof Date?+e:+new Date(+e)}function BD(e,n,s,o,d,h,f,v,b,_){var w=CD(),E=w.invert,N=w.domain,I=_(".%L"),R=_(":%S"),O=_("%I:%M"),P=_("%I %p"),M=_("%a %d"),D=_("%b %d"),U=_("%B"),B=_("%Y");function G($){return(b($)<$?I:v($)<$?R:f($)<$?O:h($)<$?P:o($)<$?d($)<$?M:D:s($)<$?U:B)($)}return w.invert=function($){return new Date(E($))},w.domain=function($){return arguments.length?N(Array.from($,RVe)):N().map(CVe)},w.ticks=function($){var q=N();return e(q[0],q[q.length-1],$??10)},w.tickFormat=function($,q){return q==null?G:_(q)},w.nice=function($){var q=N();return(!$||typeof $.range!="function")&&($=n(q[0],q[q.length-1],$??10)),$?N(Lee(q,$)):w},w.copy=function(){return fb(w,BD(e,n,s,o,d,h,f,v,b,_))},w}function AVe(){return Ro.apply(BD(SFe,TFe,Yl,FD,QT,gb,MD,DD,Mh,qee).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function IVe(){return Ro.apply(BD(EFe,wFe,ql,VD,ZT,JT,UD,LD,Mh,Xee).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function eN(){var e=0,n=1,s,o,d,h,f=ks,v=!1,b;function _(E){return E==null||isNaN(E=+E)?b:f(d===0?.5:(E=(h(E)-s)*d,v?Math.max(0,Math.min(1,E)):E))}_.domain=function(E){return arguments.length?([e,n]=E,s=h(e=+e),o=h(n=+n),d=s===o?0:1/(o-s),_):[e,n]},_.clamp=function(E){return arguments.length?(v=!!E,_):v},_.interpolator=function(E){return arguments.length?(f=E,_):f};function w(E){return function(N){var I,R;return arguments.length?([I,R]=N,f=E(I,R),_):[f(0),f(1)]}}return _.range=w(Ng),_.rangeRound=w(ND),_.unknown=function(E){return arguments.length?(b=E,_):b},function(E){return h=E,s=E(e),o=E(n),d=s===o?0:1/(o-s),_}}function Su(e,n){return n.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Jee(){var e=wu(eN()(ks));return e.copy=function(){return Su(e,Jee())},nd.apply(e,arguments)}function Qee(){var e=ID(eN()).domain([1,10]);return e.copy=function(){return Su(e,Qee()).base(e.base())},nd.apply(e,arguments)}function Zee(){var e=OD(eN());return e.copy=function(){return Su(e,Zee()).constant(e.constant())},nd.apply(e,arguments)}function GD(){var e=PD(eN());return e.copy=function(){return Su(e,GD()).exponent(e.exponent())},nd.apply(e,arguments)}function OVe(){return GD.apply(null,arguments).exponent(.5)}function ete(){var e=[],n=ks;function s(o){if(o!=null&&!isNaN(o=+o))return n((pb(e,o,1)-1)/(e.length-1))}return s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let d of o)d!=null&&!isNaN(d=+d)&&e.push(d);return e.sort(uu),s},s.interpolator=function(o){return arguments.length?(n=o,s):n},s.range=function(){return e.map((o,d)=>n(d/(e.length-1)))},s.quantiles=function(o){return Array.from({length:o+1},(d,h)=>v3e(e,h/o))},s.copy=function(){return ete(n).domain(e)},nd.apply(s,arguments)}function tN(){var e=0,n=.5,s=1,o=1,d,h,f,v,b,_=ks,w,E=!1,N;function I(O){return isNaN(O=+O)?N:(O=.5+((O=+w(O))-h)*(o*O<o*h?v:b),_(E?Math.max(0,Math.min(1,O)):O))}I.domain=function(O){return arguments.length?([e,n,s]=O,d=w(e=+e),h=w(n=+n),f=w(s=+s),v=d===h?0:.5/(h-d),b=h===f?0:.5/(f-h),o=h<d?-1:1,I):[e,n,s]},I.clamp=function(O){return arguments.length?(E=!!O,I):E},I.interpolator=function(O){return arguments.length?(_=O,I):_};function R(O){return function(P){var M,D,U;return arguments.length?([M,D,U]=P,_=W3e(O,[M,D,U]),I):[_(0),_(.5),_(1)]}}return I.range=R(Ng),I.rangeRound=R(ND),I.unknown=function(O){return arguments.length?(N=O,I):N},function(O){return w=O,d=O(e),h=O(n),f=O(s),v=d===h?0:.5/(h-d),b=h===f?0:.5/(f-h),o=h<d?-1:1,I}}function tte(){var e=wu(tN()(ks));return e.copy=function(){return Su(e,tte())},nd.apply(e,arguments)}function nte(){var e=ID(tN()).domain([.1,1,10]);return e.copy=function(){return Su(e,nte()).base(e.base())},nd.apply(e,arguments)}function rte(){var e=OD(tN());return e.copy=function(){return Su(e,rte()).constant(e.constant())},nd.apply(e,arguments)}function WD(){var e=PD(tN());return e.copy=function(){return Su(e,WD()).exponent(e.exponent())},nd.apply(e,arguments)}function PVe(){return WD.apply(null,arguments).exponent(.5)}const AK=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:wy,scaleDiverging:tte,scaleDivergingLog:nte,scaleDivergingPow:WD,scaleDivergingSqrt:PVe,scaleDivergingSymlog:rte,scaleIdentity:Dee,scaleImplicit:BP,scaleLinear:_S,scaleLog:Mee,scaleOrdinal:wD,scalePoint:zv,scalePow:kD,scaleQuantile:Vee,scaleQuantize:Bee,scaleRadial:Fee,scaleSequential:Jee,scaleSequentialLog:Qee,scaleSequentialPow:GD,scaleSequentialQuantile:ete,scaleSequentialSqrt:OVe,scaleSequentialSymlog:Zee,scaleSqrt:hFe,scaleSymlog:Uee,scaleThreshold:Gee,scaleTime:AVe,scaleUtc:IVe,tickFormat:jee},Symbol.toStringTag,{value:"Module"}));var kVe=gg;function jVe(e,n,s){for(var o=-1,d=e.length;++o<d;){var h=e[o],f=n(h);if(f!=null&&(v===void 0?f===f&&!kVe(f):s(f,v)))var v=f,b=h}return b}var ite=jVe;function DVe(e,n){return e>n}var LVe=DVe,MVe=ite,UVe=LVe,FVe=Tg;function VVe(e){return e&&e.length?MVe(e,FVe,UVe):void 0}var BVe=VVe;const Jd=ur(BVe);function GVe(e,n){return e<n}var WVe=GVe,$Ve=ite,zVe=WVe,HVe=Tg;function KVe(e){return e&&e.length?$Ve(e,HVe,zVe):void 0}var YVe=KVe;const nN=ur(YVe);var qVe=rD,XVe=Eu,JVe=hee,QVe=ua;function ZVe(e,n){var s=QVe(e)?qVe:JVe;return s(e,XVe(n))}var e6e=ZVe,t6e=dee,n6e=e6e;function r6e(e,n){return t6e(n6e(e,n),1)}var i6e=r6e;const s6e=ur(i6e);var a6e=yD;function o6e(e,n){return a6e(e,n)}var c6e=o6e;const Bf=ur(c6e);var Cg=1e9,l6e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},zD,Fr=!0,No="[DecimalError] ",zh=No+"Invalid argument: ",$D=No+"Exponent out of range: ",Rg=Math.floor,Ch=Math.pow,d6e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ia,Fi=1e7,Ar=7,ste=9007199254740991,TS=Rg(ste/Ar),It={};It.absoluteValue=It.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};It.comparedTo=It.cmp=function(e){var n,s,o,d,h=this;if(e=new h.constructor(e),h.s!==e.s)return h.s||-e.s;if(h.e!==e.e)return h.e>e.e^h.s<0?1:-1;for(o=h.d.length,d=e.d.length,n=0,s=o<d?o:d;n<s;++n)if(h.d[n]!==e.d[n])return h.d[n]>e.d[n]^h.s<0?1:-1;return o===d?0:o>d^h.s<0?1:-1};It.decimalPlaces=It.dp=function(){var e=this,n=e.d.length-1,s=(n-e.e)*Ar;if(n=e.d[n],n)for(;n%10==0;n/=10)s--;return s<0?0:s};It.dividedBy=It.div=function(e){return Vl(this,new this.constructor(e))};It.dividedToIntegerBy=It.idiv=function(e){var n=this,s=n.constructor;return vr(Vl(n,new s(e),0,1),s.precision)};It.equals=It.eq=function(e){return!this.cmp(e)};It.exponent=function(){return vi(this)};It.greaterThan=It.gt=function(e){return this.cmp(e)>0};It.greaterThanOrEqualTo=It.gte=function(e){return this.cmp(e)>=0};It.isInteger=It.isint=function(){return this.e>this.d.length-2};It.isNegative=It.isneg=function(){return this.s<0};It.isPositive=It.ispos=function(){return this.s>0};It.isZero=function(){return this.s===0};It.lessThan=It.lt=function(e){return this.cmp(e)<0};It.lessThanOrEqualTo=It.lte=function(e){return this.cmp(e)<1};It.logarithm=It.log=function(e){var n,s=this,o=s.constructor,d=o.precision,h=d+5;if(e===void 0)e=new o(10);else if(e=new o(e),e.s<1||e.eq(Ia))throw Error(No+"NaN");if(s.s<1)throw Error(No+(s.s?"NaN":"-Infinity"));return s.eq(Ia)?new o(0):(Fr=!1,n=Vl(Ry(s,h),Ry(e,h),h),Fr=!0,vr(n,d))};It.minus=It.sub=function(e){var n=this;return e=new n.constructor(e),n.s==e.s?cte(n,e):ate(n,(e.s=-e.s,e))};It.modulo=It.mod=function(e){var n,s=this,o=s.constructor,d=o.precision;if(e=new o(e),!e.s)throw Error(No+"NaN");return s.s?(Fr=!1,n=Vl(s,e,0,1).times(e),Fr=!0,s.minus(n)):vr(new o(s),d)};It.naturalExponential=It.exp=function(){return ote(this)};It.naturalLogarithm=It.ln=function(){return Ry(this)};It.negated=It.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};It.plus=It.add=function(e){var n=this;return e=new n.constructor(e),n.s==e.s?ate(n,e):cte(n,(e.s=-e.s,e))};It.precision=It.sd=function(e){var n,s,o,d=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(zh+e);if(n=vi(d)+1,o=d.d.length-1,s=o*Ar+1,o=d.d[o],o){for(;o%10==0;o/=10)s--;for(o=d.d[0];o>=10;o/=10)s++}return e&&n>s?n:s};It.squareRoot=It.sqrt=function(){var e,n,s,o,d,h,f,v=this,b=v.constructor;if(v.s<1){if(!v.s)return new b(0);throw Error(No+"NaN")}for(e=vi(v),Fr=!1,d=Math.sqrt(+v),d==0||d==1/0?(n=Yc(v.d),(n.length+e)%2==0&&(n+="0"),d=Math.sqrt(n),e=Rg((e+1)/2)-(e<0||e%2),d==1/0?n="5e"+e:(n=d.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),o=new b(n)):o=new b(d.toString()),s=b.precision,d=f=s+3;;)if(h=o,o=h.plus(Vl(v,h,f+2)).times(.5),Yc(h.d).slice(0,f)===(n=Yc(o.d)).slice(0,f)){if(n=n.slice(f-3,f+1),d==f&&n=="4999"){if(vr(h,s+1,0),h.times(h).eq(v)){o=h;break}}else if(n!="9999")break;f+=4}return Fr=!0,vr(o,s)};It.times=It.mul=function(e){var n,s,o,d,h,f,v,b,_,w=this,E=w.constructor,N=w.d,I=(e=new E(e)).d;if(!w.s||!e.s)return new E(0);for(e.s*=w.s,s=w.e+e.e,b=N.length,_=I.length,b<_&&(h=N,N=I,I=h,f=b,b=_,_=f),h=[],f=b+_,o=f;o--;)h.push(0);for(o=_;--o>=0;){for(n=0,d=b+o;d>o;)v=h[d]+I[o]*N[d-o-1]+n,h[d--]=v%Fi|0,n=v/Fi|0;h[d]=(h[d]+n)%Fi|0}for(;!h[--f];)h.pop();return n?++s:h.shift(),e.d=h,e.e=s,Fr?vr(e,E.precision):e};It.toDecimalPlaces=It.todp=function(e,n){var s=this,o=s.constructor;return s=new o(s),e===void 0?s:(nl(e,0,Cg),n===void 0?n=o.rounding:nl(n,0,8),vr(s,e+vi(s)+1,n))};It.toExponential=function(e,n){var s,o=this,d=o.constructor;return e===void 0?s=np(o,!0):(nl(e,0,Cg),n===void 0?n=d.rounding:nl(n,0,8),o=vr(new d(o),e+1,n),s=np(o,!0,e+1)),s};It.toFixed=function(e,n){var s,o,d=this,h=d.constructor;return e===void 0?np(d):(nl(e,0,Cg),n===void 0?n=h.rounding:nl(n,0,8),o=vr(new h(d),e+vi(d)+1,n),s=np(o.abs(),!1,e+vi(o)+1),d.isneg()&&!d.isZero()?"-"+s:s)};It.toInteger=It.toint=function(){var e=this,n=e.constructor;return vr(new n(e),vi(e)+1,n.rounding)};It.toNumber=function(){return+this};It.toPower=It.pow=function(e){var n,s,o,d,h,f,v=this,b=v.constructor,_=12,w=+(e=new b(e));if(!e.s)return new b(Ia);if(v=new b(v),!v.s){if(e.s<1)throw Error(No+"Infinity");return v}if(v.eq(Ia))return v;if(o=b.precision,e.eq(Ia))return vr(v,o);if(n=e.e,s=e.d.length-1,f=n>=s,h=v.s,f){if((s=w<0?-w:w)<=ste){for(d=new b(Ia),n=Math.ceil(o/Ar+4),Fr=!1;s%2&&(d=d.times(v),OK(d.d,n)),s=Rg(s/2),s!==0;)v=v.times(v),OK(v.d,n);return Fr=!0,e.s<0?new b(Ia).div(d):vr(d,o)}}else if(h<0)throw Error(No+"NaN");return h=h<0&&e.d[Math.max(n,s)]&1?-1:1,v.s=1,Fr=!1,d=e.times(Ry(v,o+_)),Fr=!0,d=ote(d),d.s=h,d};It.toPrecision=function(e,n){var s,o,d=this,h=d.constructor;return e===void 0?(s=vi(d),o=np(d,s<=h.toExpNeg||s>=h.toExpPos)):(nl(e,1,Cg),n===void 0?n=h.rounding:nl(n,0,8),d=vr(new h(d),e,n),s=vi(d),o=np(d,e<=s||s<=h.toExpNeg,e)),o};It.toSignificantDigits=It.tosd=function(e,n){var s=this,o=s.constructor;return e===void 0?(e=o.precision,n=o.rounding):(nl(e,1,Cg),n===void 0?n=o.rounding:nl(n,0,8)),vr(new o(s),e,n)};It.toString=It.valueOf=It.val=It.toJSON=It[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,n=vi(e),s=e.constructor;return np(e,n<=s.toExpNeg||n>=s.toExpPos)};function ate(e,n){var s,o,d,h,f,v,b,_,w=e.constructor,E=w.precision;if(!e.s||!n.s)return n.s||(n=new w(e)),Fr?vr(n,E):n;if(b=e.d,_=n.d,f=e.e,d=n.e,b=b.slice(),h=f-d,h){for(h<0?(o=b,h=-h,v=_.length):(o=_,d=f,v=b.length),f=Math.ceil(E/Ar),v=f>v?f+1:v+1,h>v&&(h=v,o.length=1),o.reverse();h--;)o.push(0);o.reverse()}for(v=b.length,h=_.length,v-h<0&&(h=v,o=_,_=b,b=o),s=0;h;)s=(b[--h]=b[h]+_[h]+s)/Fi|0,b[h]%=Fi;for(s&&(b.unshift(s),++d),v=b.length;b[--v]==0;)b.pop();return n.d=b,n.e=d,Fr?vr(n,E):n}function nl(e,n,s){if(e!==~~e||e<n||e>s)throw Error(zh+e)}function Yc(e){var n,s,o,d=e.length-1,h="",f=e[0];if(d>0){for(h+=f,n=1;n<d;n++)o=e[n]+"",s=Ar-o.length,s&&(h+=Vd(s)),h+=o;f=e[n],o=f+"",s=Ar-o.length,s&&(h+=Vd(s))}else if(f===0)return"0";for(;f%10===0;)f/=10;return h+f}var Vl=function(){function e(o,d){var h,f=0,v=o.length;for(o=o.slice();v--;)h=o[v]*d+f,o[v]=h%Fi|0,f=h/Fi|0;return f&&o.unshift(f),o}function n(o,d,h,f){var v,b;if(h!=f)b=h>f?1:-1;else for(v=b=0;v<h;v++)if(o[v]!=d[v]){b=o[v]>d[v]?1:-1;break}return b}function s(o,d,h){for(var f=0;h--;)o[h]-=f,f=o[h]<d[h]?1:0,o[h]=f*Fi+o[h]-d[h];for(;!o[0]&&o.length>1;)o.shift()}return function(o,d,h,f){var v,b,_,w,E,N,I,R,O,P,M,D,U,B,G,$,q,X,ee=o.constructor,ce=o.s==d.s?1:-1,Q=o.d,ae=d.d;if(!o.s)return new ee(o);if(!d.s)throw Error(No+"Division by zero");for(b=o.e-d.e,q=ae.length,G=Q.length,I=new ee(ce),R=I.d=[],_=0;ae[_]==(Q[_]||0);)++_;if(ae[_]>(Q[_]||0)&&--b,h==null?D=h=ee.precision:f?D=h+(vi(o)-vi(d))+1:D=h,D<0)return new ee(0);if(D=D/Ar+2|0,_=0,q==1)for(w=0,ae=ae[0],D++;(_<G||w)&&D--;_++)U=w*Fi+(Q[_]||0),R[_]=U/ae|0,w=U%ae|0;else{for(w=Fi/(ae[0]+1)|0,w>1&&(ae=e(ae,w),Q=e(Q,w),q=ae.length,G=Q.length),B=q,O=Q.slice(0,q),P=O.length;P<q;)O[P++]=0;X=ae.slice(),X.unshift(0),$=ae[0],ae[1]>=Fi/2&&++$;do w=0,v=n(ae,O,q,P),v<0?(M=O[0],q!=P&&(M=M*Fi+(O[1]||0)),w=M/$|0,w>1?(w>=Fi&&(w=Fi-1),E=e(ae,w),N=E.length,P=O.length,v=n(E,O,N,P),v==1&&(w--,s(E,q<N?X:ae,N))):(w==0&&(v=w=1),E=ae.slice()),N=E.length,N<P&&E.unshift(0),s(O,E,P),v==-1&&(P=O.length,v=n(ae,O,q,P),v<1&&(w++,s(O,q<P?X:ae,P))),P=O.length):v===0&&(w++,O=[0]),R[_++]=w,v&&O[0]?O[P++]=Q[B]||0:(O=[Q[B]],P=1);while((B++<G||O[0]!==void 0)&&D--)}return R[0]||R.shift(),I.e=b,vr(I,f?h+vi(I)+1:h)}}();function ote(e,n){var s,o,d,h,f,v,b=0,_=0,w=e.constructor,E=w.precision;if(vi(e)>16)throw Error($D+vi(e));if(!e.s)return new w(Ia);for(Fr=!1,v=E,f=new w(.03125);e.abs().gte(.1);)e=e.times(f),_+=5;for(o=Math.log(Ch(2,_))/Math.LN10*2+5|0,v+=o,s=d=h=new w(Ia),w.precision=v;;){if(d=vr(d.times(e),v),s=s.times(++b),f=h.plus(Vl(d,s,v)),Yc(f.d).slice(0,v)===Yc(h.d).slice(0,v)){for(;_--;)h=vr(h.times(h),v);return w.precision=E,n==null?(Fr=!0,vr(h,E)):h}h=f}}function vi(e){for(var n=e.e*Ar,s=e.d[0];s>=10;s/=10)n++;return n}function jO(e,n,s){if(n>e.LN10.sd())throw Fr=!0,s&&(e.precision=s),Error(No+"LN10 precision limit exceeded");return vr(new e(e.LN10),n)}function Vd(e){for(var n="";e--;)n+="0";return n}function Ry(e,n){var s,o,d,h,f,v,b,_,w,E=1,N=10,I=e,R=I.d,O=I.constructor,P=O.precision;if(I.s<1)throw Error(No+(I.s?"NaN":"-Infinity"));if(I.eq(Ia))return new O(0);if(n==null?(Fr=!1,_=P):_=n,I.eq(10))return n==null&&(Fr=!0),jO(O,_);if(_+=N,O.precision=_,s=Yc(R),o=s.charAt(0),h=vi(I),Math.abs(h)<15e14){for(;o<7&&o!=1||o==1&&s.charAt(1)>3;)I=I.times(e),s=Yc(I.d),o=s.charAt(0),E++;h=vi(I),o>1?(I=new O("0."+s),h++):I=new O(o+"."+s.slice(1))}else return b=jO(O,_+2,P).times(h+""),I=Ry(new O(o+"."+s.slice(1)),_-N).plus(b),O.precision=P,n==null?(Fr=!0,vr(I,P)):I;for(v=f=I=Vl(I.minus(Ia),I.plus(Ia),_),w=vr(I.times(I),_),d=3;;){if(f=vr(f.times(w),_),b=v.plus(Vl(f,new O(d),_)),Yc(b.d).slice(0,_)===Yc(v.d).slice(0,_))return v=v.times(2),h!==0&&(v=v.plus(jO(O,_+2,P).times(h+""))),v=Vl(v,new O(E),_),O.precision=P,n==null?(Fr=!0,vr(v,P)):v;v=b,d+=2}}function IK(e,n){var s,o,d;for((s=n.indexOf("."))>-1&&(n=n.replace(".","")),(o=n.search(/e/i))>0?(s<0&&(s=o),s+=+n.slice(o+1),n=n.substring(0,o)):s<0&&(s=n.length),o=0;n.charCodeAt(o)===48;)++o;for(d=n.length;n.charCodeAt(d-1)===48;)--d;if(n=n.slice(o,d),n){if(d-=o,s=s-o-1,e.e=Rg(s/Ar),e.d=[],o=(s+1)%Ar,s<0&&(o+=Ar),o<d){for(o&&e.d.push(+n.slice(0,o)),d-=Ar;o<d;)e.d.push(+n.slice(o,o+=Ar));n=n.slice(o),o=Ar-n.length}else o-=d;for(;o--;)n+="0";if(e.d.push(+n),Fr&&(e.e>TS||e.e<-TS))throw Error($D+s)}else e.s=0,e.e=0,e.d=[0];return e}function vr(e,n,s){var o,d,h,f,v,b,_,w,E=e.d;for(f=1,h=E[0];h>=10;h/=10)f++;if(o=n-f,o<0)o+=Ar,d=n,_=E[w=0];else{if(w=Math.ceil((o+1)/Ar),h=E.length,w>=h)return e;for(_=h=E[w],f=1;h>=10;h/=10)f++;o%=Ar,d=o-Ar+f}if(s!==void 0&&(h=Ch(10,f-d-1),v=_/h%10|0,b=n<0||E[w+1]!==void 0||_%h,b=s<4?(v||b)&&(s==0||s==(e.s<0?3:2)):v>5||v==5&&(s==4||b||s==6&&(o>0?d>0?_/Ch(10,f-d):0:E[w-1])%10&1||s==(e.s<0?8:7))),n<1||!E[0])return b?(h=vi(e),E.length=1,n=n-h-1,E[0]=Ch(10,(Ar-n%Ar)%Ar),e.e=Rg(-n/Ar)||0):(E.length=1,E[0]=e.e=e.s=0),e;if(o==0?(E.length=w,h=1,w--):(E.length=w+1,h=Ch(10,Ar-o),E[w]=d>0?(_/Ch(10,f-d)%Ch(10,d)|0)*h:0),b)for(;;)if(w==0){(E[0]+=h)==Fi&&(E[0]=1,++e.e);break}else{if(E[w]+=h,E[w]!=Fi)break;E[w--]=0,h=1}for(o=E.length;E[--o]===0;)E.pop();if(Fr&&(e.e>TS||e.e<-TS))throw Error($D+vi(e));return e}function cte(e,n){var s,o,d,h,f,v,b,_,w,E,N=e.constructor,I=N.precision;if(!e.s||!n.s)return n.s?n.s=-n.s:n=new N(e),Fr?vr(n,I):n;if(b=e.d,E=n.d,o=n.e,_=e.e,b=b.slice(),f=_-o,f){for(w=f<0,w?(s=b,f=-f,v=E.length):(s=E,o=_,v=b.length),d=Math.max(Math.ceil(I/Ar),v)+2,f>d&&(f=d,s.length=1),s.reverse(),d=f;d--;)s.push(0);s.reverse()}else{for(d=b.length,v=E.length,w=d<v,w&&(v=d),d=0;d<v;d++)if(b[d]!=E[d]){w=b[d]<E[d];break}f=0}for(w&&(s=b,b=E,E=s,n.s=-n.s),v=b.length,d=E.length-v;d>0;--d)b[v++]=0;for(d=E.length;d>f;){if(b[--d]<E[d]){for(h=d;h&&b[--h]===0;)b[h]=Fi-1;--b[h],b[d]+=Fi}b[d]-=E[d]}for(;b[--v]===0;)b.pop();for(;b[0]===0;b.shift())--o;return b[0]?(n.d=b,n.e=o,Fr?vr(n,I):n):new N(0)}function np(e,n,s){var o,d=vi(e),h=Yc(e.d),f=h.length;return n?(s&&(o=s-f)>0?h=h.charAt(0)+"."+h.slice(1)+Vd(o):f>1&&(h=h.charAt(0)+"."+h.slice(1)),h=h+(d<0?"e":"e+")+d):d<0?(h="0."+Vd(-d-1)+h,s&&(o=s-f)>0&&(h+=Vd(o))):d>=f?(h+=Vd(d+1-f),s&&(o=s-d-1)>0&&(h=h+"."+Vd(o))):((o=d+1)<f&&(h=h.slice(0,o)+"."+h.slice(o)),s&&(o=s-f)>0&&(d+1===f&&(h+="."),h+=Vd(o))),e.s<0?"-"+h:h}function OK(e,n){if(e.length>n)return e.length=n,!0}function lte(e){var n,s,o;function d(h){var f=this;if(!(f instanceof d))return new d(h);if(f.constructor=d,h instanceof d){f.s=h.s,f.e=h.e,f.d=(h=h.d)?h.slice():h;return}if(typeof h=="number"){if(h*0!==0)throw Error(zh+h);if(h>0)f.s=1;else if(h<0)h=-h,f.s=-1;else{f.s=0,f.e=0,f.d=[0];return}if(h===~~h&&h<1e7){f.e=0,f.d=[h];return}return IK(f,h.toString())}else if(typeof h!="string")throw Error(zh+h);if(h.charCodeAt(0)===45?(h=h.slice(1),f.s=-1):f.s=1,d6e.test(h))IK(f,h);else throw Error(zh+h)}if(d.prototype=It,d.ROUND_UP=0,d.ROUND_DOWN=1,d.ROUND_CEIL=2,d.ROUND_FLOOR=3,d.ROUND_HALF_UP=4,d.ROUND_HALF_DOWN=5,d.ROUND_HALF_EVEN=6,d.ROUND_HALF_CEIL=7,d.ROUND_HALF_FLOOR=8,d.clone=lte,d.config=d.set=u6e,e===void 0&&(e={}),e)for(o=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<o.length;)e.hasOwnProperty(s=o[n++])||(e[s]=this[s]);return d.config(e),d}function u6e(e){if(!e||typeof e!="object")throw Error(No+"Object expected");var n,s,o,d=["precision",1,Cg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(n=0;n<d.length;n+=3)if((o=e[s=d[n]])!==void 0)if(Rg(o)===o&&o>=d[n+1]&&o<=d[n+2])this[s]=o;else throw Error(zh+s+": "+o);if((o=e[s="LN10"])!==void 0)if(o==Math.LN10)this[s]=new this(o);else throw Error(zh+s+": "+o);return this}var zD=lte(l6e);Ia=new zD(1);const dr=zD;function h6e(e){return g6e(e)||f6e(e)||m6e(e)||p6e()}function p6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m6e(e,n){if(e){if(typeof e=="string")return zP(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return zP(e,n)}}function f6e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function g6e(e){if(Array.isArray(e))return zP(e)}function zP(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}var v6e=function(n){return n},dte={},ute=function(n){return n===dte},PK=function(n){return function s(){return arguments.length===0||arguments.length===1&&ute(arguments.length<=0?void 0:arguments[0])?s:n.apply(void 0,arguments)}},y6e=function e(n,s){return n===1?s:PK(function(){for(var o=arguments.length,d=new Array(o),h=0;h<o;h++)d[h]=arguments[h];var f=d.filter(function(v){return v!==dte}).length;return f>=n?s.apply(void 0,d):e(n-f,PK(function(){for(var v=arguments.length,b=new Array(v),_=0;_<v;_++)b[_]=arguments[_];var w=d.map(function(E){return ute(E)?b.shift():E});return s.apply(void 0,h6e(w).concat(b))}))})},rN=function(n){return y6e(n.length,n)},HP=function(n,s){for(var o=[],d=n;d<s;++d)o[d-n]=d;return o},b6e=rN(function(e,n){return Array.isArray(n)?n.map(e):Object.keys(n).map(function(s){return n[s]}).map(e)}),x6e=function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];if(!s.length)return v6e;var d=s.reverse(),h=d[0],f=d.slice(1);return function(){return f.reduce(function(v,b){return b(v)},h.apply(void 0,arguments))}},KP=function(n){return Array.isArray(n)?n.reverse():n.split("").reverse.join("")},hte=function(n){var s=null,o=null;return function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return s&&h.every(function(v,b){return v===s[b]})||(s=h,o=n.apply(void 0,h)),o}};function _6e(e){var n;return e===0?n=1:n=Math.floor(new dr(e).abs().log(10).toNumber())+1,n}function E6e(e,n,s){for(var o=new dr(e),d=0,h=[];o.lt(n)&&d<1e5;)h.push(o.toNumber()),o=o.add(s),d++;return h}var w6e=rN(function(e,n,s){var o=+e,d=+n;return o+s*(d-o)}),S6e=rN(function(e,n,s){var o=n-+e;return o=o||1/0,(s-e)/o}),T6e=rN(function(e,n,s){var o=n-+e;return o=o||1/0,Math.max(0,Math.min(1,(s-e)/o))});const iN={rangeStep:E6e,getDigitCount:_6e,interpolateNumber:w6e,uninterpolateNumber:S6e,uninterpolateTruncation:T6e};function YP(e){return R6e(e)||C6e(e)||pte(e)||N6e()}function N6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C6e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function R6e(e){if(Array.isArray(e))return qP(e)}function Ay(e,n){return O6e(e)||I6e(e,n)||pte(e,n)||A6e()}function A6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pte(e,n){if(e){if(typeof e=="string")return qP(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return qP(e,n)}}function qP(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function I6e(e,n){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var s=[],o=!0,d=!1,h=void 0;try{for(var f=e[Symbol.iterator](),v;!(o=(v=f.next()).done)&&(s.push(v.value),!(n&&s.length===n));o=!0);}catch(b){d=!0,h=b}finally{try{!o&&f.return!=null&&f.return()}finally{if(d)throw h}}return s}}function O6e(e){if(Array.isArray(e))return e}function mte(e){var n=Ay(e,2),s=n[0],o=n[1],d=s,h=o;return s>o&&(d=o,h=s),[d,h]}function fte(e,n,s){if(e.lte(0))return new dr(0);var o=iN.getDigitCount(e.toNumber()),d=new dr(10).pow(o),h=e.div(d),f=o!==1?.05:.1,v=new dr(Math.ceil(h.div(f).toNumber())).add(s).mul(f),b=v.mul(d);return n?b:new dr(Math.ceil(b))}function P6e(e,n,s){var o=1,d=new dr(e);if(!d.isint()&&s){var h=Math.abs(e);h<1?(o=new dr(10).pow(iN.getDigitCount(e)-1),d=new dr(Math.floor(d.div(o).toNumber())).mul(o)):h>1&&(d=new dr(Math.floor(e)))}else e===0?d=new dr(Math.floor((n-1)/2)):s||(d=new dr(Math.floor(e)));var f=Math.floor((n-1)/2),v=x6e(b6e(function(b){return d.add(new dr(b-f).mul(o)).toNumber()}),HP);return v(0,n)}function gte(e,n,s,o){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-e)/(s-1)))return{step:new dr(0),tickMin:new dr(0),tickMax:new dr(0)};var h=fte(new dr(n).sub(e).div(s-1),o,d),f;e<=0&&n>=0?f=new dr(0):(f=new dr(e).add(n).div(2),f=f.sub(new dr(f).mod(h)));var v=Math.ceil(f.sub(e).div(h).toNumber()),b=Math.ceil(new dr(n).sub(f).div(h).toNumber()),_=v+b+1;return _>s?gte(e,n,s,o,d+1):(_<s&&(b=n>0?b+(s-_):b,v=n>0?v:v+(s-_)),{step:h,tickMin:f.sub(new dr(v).mul(h)),tickMax:f.add(new dr(b).mul(h))})}function k6e(e){var n=Ay(e,2),s=n[0],o=n[1],d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=Math.max(d,2),v=mte([s,o]),b=Ay(v,2),_=b[0],w=b[1];if(_===-1/0||w===1/0){var E=w===1/0?[_].concat(YP(HP(0,d-1).map(function(){return 1/0}))):[].concat(YP(HP(0,d-1).map(function(){return-1/0})),[w]);return s>o?KP(E):E}if(_===w)return P6e(_,d,h);var N=gte(_,w,f,h),I=N.step,R=N.tickMin,O=N.tickMax,P=iN.rangeStep(R,O.add(new dr(.1).mul(I)),I);return s>o?KP(P):P}function j6e(e,n){var s=Ay(e,2),o=s[0],d=s[1],h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=mte([o,d]),v=Ay(f,2),b=v[0],_=v[1];if(b===-1/0||_===1/0)return[o,d];if(b===_)return[b];var w=Math.max(n,2),E=fte(new dr(_).sub(b).div(w-1),h,0),N=[].concat(YP(iN.rangeStep(new dr(b),new dr(_).sub(new dr(.99).mul(E)),E)),[_]);return o>d?KP(N):N}var D6e=hte(k6e),L6e=hte(j6e),M6e="Invariant failed";function rp(e,n){throw new Error(M6e)}var U6e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Gf(e){"@babel/helpers - typeof";return Gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Gf(e)}function NS(){return NS=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},NS.apply(this,arguments)}function F6e(e,n){return W6e(e)||G6e(e,n)||B6e(e,n)||V6e()}function V6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B6e(e,n){if(e){if(typeof e=="string")return kK(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return kK(e,n)}}function kK(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function G6e(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n!==0)for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function W6e(e){if(Array.isArray(e))return e}function $6e(e,n){if(e==null)return{};var s=z6e(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function z6e(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function H6e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function K6e(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,bte(o.key),o)}}function Y6e(e,n,s){return n&&K6e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function q6e(e,n,s){return n=CS(n),X6e(e,vte()?Reflect.construct(n,s||[],CS(e).constructor):n.apply(e,s))}function X6e(e,n){if(n&&(Gf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J6e(e)}function J6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vte=function(){return!!e})()}function CS(e){return CS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},CS(e)}function Q6e(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&XP(e,n)}function XP(e,n){return XP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},XP(e,n)}function yte(e,n,s){return n=bte(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function bte(e){var n=Z6e(e,"string");return Gf(n)=="symbol"?n:n+""}function Z6e(e,n){if(Gf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Gf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var vb=function(e){function n(){return H6e(this,n),q6e(this,n,arguments)}return Q6e(n,e),Y6e(n,[{key:"render",value:function(){var o=this.props,d=o.offset,h=o.layout,f=o.width,v=o.dataKey,b=o.data,_=o.dataPointFormatter,w=o.xAxis,E=o.yAxis,N=$6e(o,U6e),I=bn(N,!1);this.props.direction==="x"&&w.type!=="number"&&rp();var R=b.map(function(O){var P=_(O,v),M=P.x,D=P.y,U=P.value,B=P.errorVal;if(!B)return null;var G=[],$,q;if(Array.isArray(B)){var X=F6e(B,2);$=X[0],q=X[1]}else $=q=B;if(h==="vertical"){var ee=w.scale,ce=D+d,Q=ce+f,ae=ce-f,ve=ee(U-$),le=ee(U+q);G.push({x1:le,y1:Q,x2:le,y2:ae}),G.push({x1:ve,y1:ce,x2:le,y2:ce}),G.push({x1:ve,y1:Q,x2:ve,y2:ae})}else if(h==="horizontal"){var fe=E.scale,re=M+d,he=re-f,J=re+f,ue=fe(U-$),Ee=fe(U+q);G.push({x1:he,y1:Ee,x2:J,y2:Ee}),G.push({x1:re,y1:ue,x2:re,y2:Ee}),G.push({x1:he,y1:ue,x2:J,y2:ue})}return ye.createElement(xr,NS({className:"recharts-errorBar",key:"bar-".concat(G.map(function(Fe){return"".concat(Fe.x1,"-").concat(Fe.x2,"-").concat(Fe.y1,"-").concat(Fe.y2)}))},I),G.map(function(Fe){return ye.createElement("line",NS({},Fe,{key:"line-".concat(Fe.x1,"-").concat(Fe.x2,"-").concat(Fe.y1,"-").concat(Fe.y2)}))}))});return ye.createElement(xr,{className:"recharts-errorBars"},R)}}])}(ye.Component);yte(vb,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});yte(vb,"displayName","ErrorBar");function Iy(e){"@babel/helpers - typeof";return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Iy(e)}function jK(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function Eh(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?jK(Object(s),!0).forEach(function(o){eBe(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):jK(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function eBe(e,n,s){return n=tBe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function tBe(e){var n=nBe(e,"string");return Iy(n)=="symbol"?n:n+""}function nBe(e,n){if(Iy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Iy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var xte=function(n){var s=n.children,o=n.formattedGraphicalItems,d=n.legendWidth,h=n.legendContent,f=Ra(s,vf);if(!f)return null;var v=vf.defaultProps,b=v!==void 0?Eh(Eh({},v),f.props):{},_;return f.props&&f.props.payload?_=f.props&&f.props.payload:h==="children"?_=(o||[]).reduce(function(w,E){var N=E.item,I=E.props,R=I.sectors||I.data||[];return w.concat(R.map(function(O){return{type:f.props.iconType||N.props.legendType,value:O.name,color:O.fill,payload:O}}))},[]):_=(o||[]).map(function(w){var E=w.item,N=E.type.defaultProps,I=N!==void 0?Eh(Eh({},N),E.props):{},R=I.dataKey,O=I.name,P=I.legendType,M=I.hide;return{inactive:M,dataKey:R,type:b.iconType||P||"square",color:HD(E),value:O||R,payload:I}}),Eh(Eh(Eh({},b),vf.getWithHeight(f,d)),{},{payload:_,item:f})};function Oy(e){"@babel/helpers - typeof";return Oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Oy(e)}function DK(e){return aBe(e)||sBe(e)||iBe(e)||rBe()}function rBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iBe(e,n){if(e){if(typeof e=="string")return JP(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return JP(e,n)}}function sBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aBe(e){if(Array.isArray(e))return JP(e)}function JP(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function LK(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function ri(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?LK(Object(s),!0).forEach(function(o){bf(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):LK(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function bf(e,n,s){return n=oBe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function oBe(e){var n=cBe(e,"string");return Oy(n)=="symbol"?n:n+""}function cBe(e,n){if(Oy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Oy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Ds(e,n,s){return En(e)||En(n)?s:Ri(n)?_o(e,n,s):mn(n)?n(e):s}function Hv(e,n,s,o){var d=s6e(e,function(v){return Ds(v,n)});if(s==="number"){var h=d.filter(function(v){return pt(v)||parseFloat(v)});return h.length?[nN(h),Jd(h)]:[1/0,-1/0]}var f=o?d.filter(function(v){return!En(v)}):d;return f.map(function(v){return Ri(v)||v instanceof Date?v:""})}var lBe=function(n){var s,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],d=arguments.length>2?arguments[2]:void 0,h=arguments.length>3?arguments[3]:void 0,f=-1,v=(s=o==null?void 0:o.length)!==null&&s!==void 0?s:0;if(v<=1)return 0;if(h&&h.axisType==="angleAxis"&&Math.abs(Math.abs(h.range[1]-h.range[0])-360)<=1e-6)for(var b=h.range,_=0;_<v;_++){var w=_>0?d[_-1].coordinate:d[v-1].coordinate,E=d[_].coordinate,N=_>=v-1?d[0].coordinate:d[_+1].coordinate,I=void 0;if(dc(E-w)!==dc(N-E)){var R=[];if(dc(N-E)===dc(b[1]-b[0])){I=N;var O=E+b[1]-b[0];R[0]=Math.min(O,(O+w)/2),R[1]=Math.max(O,(O+w)/2)}else{I=w;var P=N+b[1]-b[0];R[0]=Math.min(E,(P+E)/2),R[1]=Math.max(E,(P+E)/2)}var M=[Math.min(E,(I+E)/2),Math.max(E,(I+E)/2)];if(n>M[0]&&n<=M[1]||n>=R[0]&&n<=R[1]){f=d[_].index;break}}else{var D=Math.min(w,N),U=Math.max(w,N);if(n>(D+E)/2&&n<=(U+E)/2){f=d[_].index;break}}}else for(var B=0;B<v;B++)if(B===0&&n<=(o[B].coordinate+o[B+1].coordinate)/2||B>0&&B<v-1&&n>(o[B].coordinate+o[B-1].coordinate)/2&&n<=(o[B].coordinate+o[B+1].coordinate)/2||B===v-1&&n>(o[B].coordinate+o[B-1].coordinate)/2){f=o[B].index;break}return f},HD=function(n){var s,o=n,d=o.type.displayName,h=(s=n.type)!==null&&s!==void 0&&s.defaultProps?ri(ri({},n.type.defaultProps),n.props):n.props,f=h.stroke,v=h.fill,b;switch(d){case"Line":b=f;break;case"Area":case"Radar":b=f&&f!=="none"?f:v;break;default:b=v;break}return b},dBe=function(n){var s=n.barSize,o=n.totalSize,d=n.stackGroups,h=d===void 0?{}:d;if(!h)return{};for(var f={},v=Object.keys(h),b=0,_=v.length;b<_;b++)for(var w=h[v[b]].stackGroups,E=Object.keys(w),N=0,I=E.length;N<I;N++){var R=w[E[N]],O=R.items,P=R.cateAxisId,M=O.filter(function(q){return Ul(q.type).indexOf("Bar")>=0});if(M&&M.length){var D=M[0].type.defaultProps,U=D!==void 0?ri(ri({},D),M[0].props):M[0].props,B=U.barSize,G=U[P];f[G]||(f[G]=[]);var $=En(B)?s:B;f[G].push({item:M[0],stackList:M.slice(1),barSize:En($)?void 0:tp($,o,0)})}}return f},uBe=function(n){var s=n.barGap,o=n.barCategoryGap,d=n.bandSize,h=n.sizeList,f=h===void 0?[]:h,v=n.maxBarSize,b=f.length;if(b<1)return null;var _=tp(s,d,0,!0),w,E=[];if(f[0].barSize===+f[0].barSize){var N=!1,I=d/b,R=f.reduce(function(B,G){return B+G.barSize||0},0);R+=(b-1)*_,R>=d&&(R-=(b-1)*_,_=0),R>=d&&I>0&&(N=!0,I*=.9,R=b*I);var O=(d-R)/2>>0,P={offset:O-_,size:0};w=f.reduce(function(B,G){var $={item:G.item,position:{offset:P.offset+P.size+_,size:N?I:G.barSize}},q=[].concat(DK(B),[$]);return P=q[q.length-1].position,G.stackList&&G.stackList.length&&G.stackList.forEach(function(X){q.push({item:X,position:P})}),q},E)}else{var M=tp(o,d,0,!0);d-2*M-(b-1)*_<=0&&(_=0);var D=(d-2*M-(b-1)*_)/b;D>1&&(D>>=0);var U=v===+v?Math.min(D,v):D;w=f.reduce(function(B,G,$){var q=[].concat(DK(B),[{item:G.item,position:{offset:M+(D+_)*$+(D-U)/2,size:U}}]);return G.stackList&&G.stackList.length&&G.stackList.forEach(function(X){q.push({item:X,position:q[q.length-1].position})}),q},E)}return w},hBe=function(n,s,o,d){var h=o.children,f=o.width,v=o.margin,b=f-(v.left||0)-(v.right||0),_=xte({children:h,legendWidth:b});if(_){var w=d||{},E=w.width,N=w.height,I=_.align,R=_.verticalAlign,O=_.layout;if((O==="vertical"||O==="horizontal"&&R==="middle")&&I!=="center"&&pt(n[I]))return ri(ri({},n),{},bf({},I,n[I]+(E||0)));if((O==="horizontal"||O==="vertical"&&I==="center")&&R!=="middle"&&pt(n[R]))return ri(ri({},n),{},bf({},R,n[R]+(N||0)))}return n},pBe=function(n,s,o){return En(s)?!0:n==="horizontal"?s==="yAxis":n==="vertical"||o==="x"?s==="xAxis":o==="y"?s==="yAxis":!0},_te=function(n,s,o,d,h){var f=s.props.children,v=Eo(f,vb).filter(function(_){return pBe(d,h,_.props.direction)});if(v&&v.length){var b=v.map(function(_){return _.props.dataKey});return n.reduce(function(_,w){var E=Ds(w,o);if(En(E))return _;var N=Array.isArray(E)?[nN(E),Jd(E)]:[E,E],I=b.reduce(function(R,O){var P=Ds(w,O,0),M=N[0]-Math.abs(Array.isArray(P)?P[0]:P),D=N[1]+Math.abs(Array.isArray(P)?P[1]:P);return[Math.min(M,R[0]),Math.max(D,R[1])]},[1/0,-1/0]);return[Math.min(I[0],_[0]),Math.max(I[1],_[1])]},[1/0,-1/0])}return null},mBe=function(n,s,o,d,h){var f=s.map(function(v){return _te(n,v,o,h,d)}).filter(function(v){return!En(v)});return f&&f.length?f.reduce(function(v,b){return[Math.min(v[0],b[0]),Math.max(v[1],b[1])]},[1/0,-1/0]):null},Ete=function(n,s,o,d,h){var f=s.map(function(b){var _=b.props.dataKey;return o==="number"&&_&&_te(n,b,_,d)||Hv(n,_,o,h)});if(o==="number")return f.reduce(function(b,_){return[Math.min(b[0],_[0]),Math.max(b[1],_[1])]},[1/0,-1/0]);var v={};return f.reduce(function(b,_){for(var w=0,E=_.length;w<E;w++)v[_[w]]||(v[_[w]]=!0,b.push(_[w]));return b},[])},wte=function(n,s){return n==="horizontal"&&s==="xAxis"||n==="vertical"&&s==="yAxis"||n==="centric"&&s==="angleAxis"||n==="radial"&&s==="radiusAxis"},Ste=function(n,s,o,d){if(d)return n.map(function(b){return b.coordinate});var h,f,v=n.map(function(b){return b.coordinate===s&&(h=!0),b.coordinate===o&&(f=!0),b.coordinate});return h||v.push(s),f||v.push(o),v},jl=function(n,s,o){if(!n)return null;var d=n.scale,h=n.duplicateDomain,f=n.type,v=n.range,b=n.realScaleType==="scaleBand"?d.bandwidth()/2:2,_=(s||o)&&f==="category"&&d.bandwidth?d.bandwidth()/b:0;if(_=n.axisType==="angleAxis"&&(v==null?void 0:v.length)>=2?dc(v[0]-v[1])*2*_:_,s&&(n.ticks||n.niceTicks)){var w=(n.ticks||n.niceTicks).map(function(E){var N=h?h.indexOf(E):E;return{coordinate:d(N)+_,value:E,offset:_}});return w.filter(function(E){return!_g(E.coordinate)})}return n.isCategorical&&n.categoricalDomain?n.categoricalDomain.map(function(E,N){return{coordinate:d(E)+_,value:E,index:N,offset:_}}):d.ticks&&!o?d.ticks(n.tickCount).map(function(E){return{coordinate:d(E)+_,value:E,offset:_}}):d.domain().map(function(E,N){return{coordinate:d(E)+_,value:h?h[E]:E,index:N,offset:_}})},DO=new WeakMap,YE=function(n,s){if(typeof s!="function")return n;DO.has(n)||DO.set(n,new WeakMap);var o=DO.get(n);if(o.has(s))return o.get(s);var d=function(){n.apply(void 0,arguments),s.apply(void 0,arguments)};return o.set(s,d),d},fBe=function(n,s,o){var d=n.scale,h=n.type,f=n.layout,v=n.axisType;if(d==="auto")return f==="radial"&&v==="radiusAxis"?{scale:wy(),realScaleType:"band"}:f==="radial"&&v==="angleAxis"?{scale:_S(),realScaleType:"linear"}:h==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!o)?{scale:zv(),realScaleType:"point"}:h==="category"?{scale:wy(),realScaleType:"band"}:{scale:_S(),realScaleType:"linear"};if(ep(d)){var b="scale".concat(WT(d));return{scale:(AK[b]||zv)(),realScaleType:AK[b]?b:"point"}}return mn(d)?{scale:d}:{scale:zv(),realScaleType:"point"}},MK=1e-4,gBe=function(n){var s=n.domain();if(!(!s||s.length<=2)){var o=s.length,d=n.range(),h=Math.min(d[0],d[1])-MK,f=Math.max(d[0],d[1])+MK,v=n(s[0]),b=n(s[o-1]);(v<h||v>f||b<h||b>f)&&n.domain([s[0],s[o-1]])}},vBe=function(n,s){if(!n)return null;for(var o=0,d=n.length;o<d;o++)if(n[o].item===s)return n[o].position;return null},yBe=function(n,s){if(!s||s.length!==2||!pt(s[0])||!pt(s[1]))return n;var o=Math.min(s[0],s[1]),d=Math.max(s[0],s[1]),h=[n[0],n[1]];return(!pt(n[0])||n[0]<o)&&(h[0]=o),(!pt(n[1])||n[1]>d)&&(h[1]=d),h[0]>d&&(h[0]=d),h[1]<o&&(h[1]=o),h},bBe=function(n){var s=n.length;if(!(s<=0))for(var o=0,d=n[0].length;o<d;++o)for(var h=0,f=0,v=0;v<s;++v){var b=_g(n[v][o][1])?n[v][o][0]:n[v][o][1];b>=0?(n[v][o][0]=h,n[v][o][1]=h+b,h=n[v][o][1]):(n[v][o][0]=f,n[v][o][1]=f+b,f=n[v][o][1])}},xBe=function(n){var s=n.length;if(!(s<=0))for(var o=0,d=n[0].length;o<d;++o)for(var h=0,f=0;f<s;++f){var v=_g(n[f][o][1])?n[f][o][0]:n[f][o][1];v>=0?(n[f][o][0]=h,n[f][o][1]=h+v,h=n[f][o][1]):(n[f][o][0]=0,n[f][o][1]=0)}},_Be={sign:bBe,expand:L2e,none:kf,silhouette:M2e,wiggle:U2e,positive:xBe},EBe=function(n,s,o){var d=s.map(function(v){return v.props.dataKey}),h=_Be[o],f=D2e().keys(d).value(function(v,b){return+Ds(v,b,0)}).order(EP).offset(h);return f(n)},wBe=function(n,s,o,d,h,f){if(!n)return null;var v=f?s.reverse():s,b={},_=v.reduce(function(E,N){var I,R=(I=N.type)!==null&&I!==void 0&&I.defaultProps?ri(ri({},N.type.defaultProps),N.props):N.props,O=R.stackId,P=R.hide;if(P)return E;var M=R[o],D=E[M]||{hasStack:!1,stackGroups:{}};if(Ri(O)){var U=D.stackGroups[O]||{numericAxisId:o,cateAxisId:d,items:[]};U.items.push(N),D.hasStack=!0,D.stackGroups[O]=U}else D.stackGroups[Eg("_stackId_")]={numericAxisId:o,cateAxisId:d,items:[N]};return ri(ri({},E),{},bf({},M,D))},b),w={};return Object.keys(_).reduce(function(E,N){var I=_[N];if(I.hasStack){var R={};I.stackGroups=Object.keys(I.stackGroups).reduce(function(O,P){var M=I.stackGroups[P];return ri(ri({},O),{},bf({},P,{numericAxisId:o,cateAxisId:d,items:M.items,stackedData:EBe(n,M.items,h)}))},R)}return ri(ri({},E),{},bf({},N,I))},w)},SBe=function(n,s){var o=s.realScaleType,d=s.type,h=s.tickCount,f=s.originalDomain,v=s.allowDecimals,b=o||s.scale;if(b!=="auto"&&b!=="linear")return null;if(h&&d==="number"&&f&&(f[0]==="auto"||f[1]==="auto")){var _=n.domain();if(!_.length)return null;var w=D6e(_,h,v);return n.domain([nN(w),Jd(w)]),{niceTicks:w}}if(h&&d==="number"){var E=n.domain(),N=L6e(E,h,v);return{niceTicks:N}}return null};function RS(e){var n=e.axis,s=e.ticks,o=e.bandSize,d=e.entry,h=e.index,f=e.dataKey;if(n.type==="category"){if(!n.allowDuplicatedCategory&&n.dataKey&&!En(d[n.dataKey])){var v=Qw(s,"value",d[n.dataKey]);if(v)return v.coordinate+o/2}return s[h]?s[h].coordinate+o/2:null}var b=Ds(d,En(f)?n.dataKey:f);return En(b)?null:n.scale(b)}var UK=function(n){var s=n.axis,o=n.ticks,d=n.offset,h=n.bandSize,f=n.entry,v=n.index;if(s.type==="category")return o[v]?o[v].coordinate+d:null;var b=Ds(f,s.dataKey,s.domain[v]);return En(b)?null:s.scale(b)-h/2+d},TBe=function(n){var s=n.numericAxis,o=s.scale.domain();if(s.type==="number"){var d=Math.min(o[0],o[1]),h=Math.max(o[0],o[1]);return d<=0&&h>=0?0:h<0?h:d}return o[0]},NBe=function(n,s){var o,d=(o=n.type)!==null&&o!==void 0&&o.defaultProps?ri(ri({},n.type.defaultProps),n.props):n.props,h=d.stackId;if(Ri(h)){var f=s[h];if(f){var v=f.items.indexOf(n);return v>=0?f.stackedData[v]:null}}return null},CBe=function(n){return n.reduce(function(s,o){return[nN(o.concat([s[0]]).filter(pt)),Jd(o.concat([s[1]]).filter(pt))]},[1/0,-1/0])},Tte=function(n,s,o){return Object.keys(n).reduce(function(d,h){var f=n[h],v=f.stackedData,b=v.reduce(function(_,w){var E=CBe(w.slice(s,o+1));return[Math.min(_[0],E[0]),Math.max(_[1],E[1])]},[1/0,-1/0]);return[Math.min(b[0],d[0]),Math.max(b[1],d[1])]},[1/0,-1/0]).map(function(d){return d===1/0||d===-1/0?0:d})},FK=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,VK=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,QP=function(n,s,o){if(mn(n))return n(s,o);if(!Array.isArray(n))return s;var d=[];if(pt(n[0]))d[0]=o?n[0]:Math.min(n[0],s[0]);else if(FK.test(n[0])){var h=+FK.exec(n[0])[1];d[0]=s[0]-h}else mn(n[0])?d[0]=n[0](s[0]):d[0]=s[0];if(pt(n[1]))d[1]=o?n[1]:Math.max(n[1],s[1]);else if(VK.test(n[1])){var f=+VK.exec(n[1])[1];d[1]=s[1]+f}else mn(n[1])?d[1]=n[1](s[1]):d[1]=s[1];return d},AS=function(n,s,o){if(n&&n.scale&&n.scale.bandwidth){var d=n.scale.bandwidth();if(!o||d>0)return d}if(n&&s&&s.length>=2){for(var h=xD(s,function(E){return E.coordinate}),f=1/0,v=1,b=h.length;v<b;v++){var _=h[v],w=h[v-1];f=Math.min((_.coordinate||0)-(w.coordinate||0),f)}return f===1/0?0:f}return o?void 0:0},BK=function(n,s,o){return!n||!n.length||Bf(n,_o(o,"type.defaultProps.domain"))?s:n},Nte=function(n,s){var o=n.type.defaultProps?ri(ri({},n.type.defaultProps),n.props):n.props,d=o.dataKey,h=o.name,f=o.unit,v=o.formatter,b=o.tooltipType,_=o.chartType,w=o.hide;return ri(ri({},bn(n,!1)),{},{dataKey:d,unit:f,formatter:v,name:h||d,color:HD(n),value:Ds(s,d),type:b,payload:s,chartType:_,hide:w})};function Py(e){"@babel/helpers - typeof";return Py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Py(e)}function GK(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function WK(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?GK(Object(s),!0).forEach(function(o){RBe(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):GK(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function RBe(e,n,s){return n=ABe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function ABe(e){var n=IBe(e,"string");return Py(n)=="symbol"?n:n+""}function IBe(e,n){if(Py(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Py(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var IS=Math.PI/180,OBe=function(n){return n*180/Math.PI},rs=function(n,s,o,d){return{x:n+Math.cos(-IS*d)*o,y:s+Math.sin(-IS*d)*o}},PBe=function(n,s){var o=n.x,d=n.y,h=s.x,f=s.y;return Math.sqrt(Math.pow(o-h,2)+Math.pow(d-f,2))},kBe=function(n,s){var o=n.x,d=n.y,h=s.cx,f=s.cy,v=PBe({x:o,y:d},{x:h,y:f});if(v<=0)return{radius:v};var b=(o-h)/v,_=Math.acos(b);return d>f&&(_=2*Math.PI-_),{radius:v,angle:OBe(_),angleInRadian:_}},jBe=function(n){var s=n.startAngle,o=n.endAngle,d=Math.floor(s/360),h=Math.floor(o/360),f=Math.min(d,h);return{startAngle:s-f*360,endAngle:o-f*360}},DBe=function(n,s){var o=s.startAngle,d=s.endAngle,h=Math.floor(o/360),f=Math.floor(d/360),v=Math.min(h,f);return n+v*360},$K=function(n,s){var o=n.x,d=n.y,h=kBe({x:o,y:d},s),f=h.radius,v=h.angle,b=s.innerRadius,_=s.outerRadius;if(f<b||f>_)return!1;if(f===0)return!0;var w=jBe(s),E=w.startAngle,N=w.endAngle,I=v,R;if(E<=N){for(;I>N;)I-=360;for(;I<E;)I+=360;R=I>=E&&I<=N}else{for(;I>E;)I-=360;for(;I<N;)I+=360;R=I>=N&&I<=E}return R?WK(WK({},s),{},{radius:f,angle:DBe(I,s)}):null};function ky(e){"@babel/helpers - typeof";return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ky(e)}var LBe=["offset"];function MBe(e){return BBe(e)||VBe(e)||FBe(e)||UBe()}function UBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FBe(e,n){if(e){if(typeof e=="string")return ZP(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ZP(e,n)}}function VBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BBe(e){if(Array.isArray(e))return ZP(e)}function ZP(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function GBe(e,n){if(e==null)return{};var s=WBe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function WBe(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function zK(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function wi(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?zK(Object(s),!0).forEach(function(o){$Be(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):zK(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function $Be(e,n,s){return n=zBe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function zBe(e){var n=HBe(e,"string");return ky(n)=="symbol"?n:n+""}function HBe(e,n){if(ky(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(ky(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function jy(){return jy=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},jy.apply(this,arguments)}var KBe=function(n){var s=n.value,o=n.formatter,d=En(n.children)?s:n.children;return mn(o)?o(d):d},YBe=function(n,s){var o=dc(s-n),d=Math.min(Math.abs(s-n),360);return o*d},qBe=function(n,s,o){var d=n.position,h=n.viewBox,f=n.offset,v=n.className,b=h,_=b.cx,w=b.cy,E=b.innerRadius,N=b.outerRadius,I=b.startAngle,R=b.endAngle,O=b.clockWise,P=(E+N)/2,M=YBe(I,R),D=M>=0?1:-1,U,B;d==="insideStart"?(U=I+D*f,B=O):d==="insideEnd"?(U=R-D*f,B=!O):d==="end"&&(U=R+D*f,B=O),B=M<=0?B:!B;var G=rs(_,w,P,U),$=rs(_,w,P,U+(B?1:-1)*359),q="M".concat(G.x,",").concat(G.y,`
    A`).concat(P,",").concat(P,",0,1,").concat(B?0:1,`,
    `).concat($.x,",").concat($.y),X=En(n.id)?Eg("recharts-radial-line-"):n.id;return ye.createElement("text",jy({},o,{dominantBaseline:"central",className:In("recharts-radial-bar-label",v)}),ye.createElement("defs",null,ye.createElement("path",{id:X,d:q})),ye.createElement("textPath",{xlinkHref:"#".concat(X)},s))},XBe=function(n){var s=n.viewBox,o=n.offset,d=n.position,h=s,f=h.cx,v=h.cy,b=h.innerRadius,_=h.outerRadius,w=h.startAngle,E=h.endAngle,N=(w+E)/2;if(d==="outside"){var I=rs(f,v,_+o,N),R=I.x,O=I.y;return{x:R,y:O,textAnchor:R>=f?"start":"end",verticalAnchor:"middle"}}if(d==="center")return{x:f,y:v,textAnchor:"middle",verticalAnchor:"middle"};if(d==="centerTop")return{x:f,y:v,textAnchor:"middle",verticalAnchor:"start"};if(d==="centerBottom")return{x:f,y:v,textAnchor:"middle",verticalAnchor:"end"};var P=(b+_)/2,M=rs(f,v,P,N),D=M.x,U=M.y;return{x:D,y:U,textAnchor:"middle",verticalAnchor:"middle"}},JBe=function(n){var s=n.viewBox,o=n.parentViewBox,d=n.offset,h=n.position,f=s,v=f.x,b=f.y,_=f.width,w=f.height,E=w>=0?1:-1,N=E*d,I=E>0?"end":"start",R=E>0?"start":"end",O=_>=0?1:-1,P=O*d,M=O>0?"end":"start",D=O>0?"start":"end";if(h==="top"){var U={x:v+_/2,y:b-E*d,textAnchor:"middle",verticalAnchor:I};return wi(wi({},U),o?{height:Math.max(b-o.y,0),width:_}:{})}if(h==="bottom"){var B={x:v+_/2,y:b+w+N,textAnchor:"middle",verticalAnchor:R};return wi(wi({},B),o?{height:Math.max(o.y+o.height-(b+w),0),width:_}:{})}if(h==="left"){var G={x:v-P,y:b+w/2,textAnchor:M,verticalAnchor:"middle"};return wi(wi({},G),o?{width:Math.max(G.x-o.x,0),height:w}:{})}if(h==="right"){var $={x:v+_+P,y:b+w/2,textAnchor:D,verticalAnchor:"middle"};return wi(wi({},$),o?{width:Math.max(o.x+o.width-$.x,0),height:w}:{})}var q=o?{width:_,height:w}:{};return h==="insideLeft"?wi({x:v+P,y:b+w/2,textAnchor:D,verticalAnchor:"middle"},q):h==="insideRight"?wi({x:v+_-P,y:b+w/2,textAnchor:M,verticalAnchor:"middle"},q):h==="insideTop"?wi({x:v+_/2,y:b+N,textAnchor:"middle",verticalAnchor:R},q):h==="insideBottom"?wi({x:v+_/2,y:b+w-N,textAnchor:"middle",verticalAnchor:I},q):h==="insideTopLeft"?wi({x:v+P,y:b+N,textAnchor:D,verticalAnchor:R},q):h==="insideTopRight"?wi({x:v+_-P,y:b+N,textAnchor:M,verticalAnchor:R},q):h==="insideBottomLeft"?wi({x:v+P,y:b+w-N,textAnchor:D,verticalAnchor:I},q):h==="insideBottomRight"?wi({x:v+_-P,y:b+w-N,textAnchor:M,verticalAnchor:I},q):vg(h)&&(pt(h.x)||Dh(h.x))&&(pt(h.y)||Dh(h.y))?wi({x:v+tp(h.x,_),y:b+tp(h.y,w),textAnchor:"end",verticalAnchor:"end"},q):wi({x:v+_/2,y:b+w/2,textAnchor:"middle",verticalAnchor:"middle"},q)},QBe=function(n){return"cx"in n&&pt(n.cx)};function bs(e){var n=e.offset,s=n===void 0?5:n,o=GBe(e,LBe),d=wi({offset:s},o),h=d.viewBox,f=d.position,v=d.value,b=d.children,_=d.content,w=d.className,E=w===void 0?"":w,N=d.textBreakAll;if(!h||En(v)&&En(b)&&!z.isValidElement(_)&&!mn(_))return null;if(z.isValidElement(_))return z.cloneElement(_,d);var I;if(mn(_)){if(I=z.createElement(_,d),z.isValidElement(I))return I}else I=KBe(d);var R=QBe(h),O=bn(d,!0);if(R&&(f==="insideStart"||f==="insideEnd"||f==="end"))return qBe(d,I,O);var P=R?XBe(d):JBe(d);return ye.createElement(mS,jy({className:In("recharts-label",E)},O,P,{breakAll:N}),I)}bs.displayName="Label";var Cte=function(n){var s=n.cx,o=n.cy,d=n.angle,h=n.startAngle,f=n.endAngle,v=n.r,b=n.radius,_=n.innerRadius,w=n.outerRadius,E=n.x,N=n.y,I=n.top,R=n.left,O=n.width,P=n.height,M=n.clockWise,D=n.labelViewBox;if(D)return D;if(pt(O)&&pt(P)){if(pt(E)&&pt(N))return{x:E,y:N,width:O,height:P};if(pt(I)&&pt(R))return{x:I,y:R,width:O,height:P}}return pt(E)&&pt(N)?{x:E,y:N,width:0,height:0}:pt(s)&&pt(o)?{cx:s,cy:o,startAngle:h||d||0,endAngle:f||d||0,innerRadius:_||0,outerRadius:w||b||v||0,clockWise:M}:n.viewBox?n.viewBox:{}},ZBe=function(n,s){return n?n===!0?ye.createElement(bs,{key:"label-implicit",viewBox:s}):Ri(n)?ye.createElement(bs,{key:"label-implicit",viewBox:s,value:n}):z.isValidElement(n)?n.type===bs?z.cloneElement(n,{key:"label-implicit",viewBox:s}):ye.createElement(bs,{key:"label-implicit",content:n,viewBox:s}):mn(n)?ye.createElement(bs,{key:"label-implicit",content:n,viewBox:s}):vg(n)?ye.createElement(bs,jy({viewBox:s},n,{key:"label-implicit"})):null:null},e8e=function(n,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!n||!n.children&&o&&!n.label)return null;var d=n.children,h=Cte(n),f=Eo(d,bs).map(function(b,_){return z.cloneElement(b,{viewBox:s||h,key:"label-".concat(_)})});if(!o)return f;var v=ZBe(n.label,s||h);return[v].concat(MBe(f))};bs.parseViewBox=Cte;bs.renderCallByParent=e8e;function t8e(e){var n=e==null?0:e.length;return n?e[n-1]:void 0}var n8e=t8e;const r8e=ur(n8e);function Dy(e){"@babel/helpers - typeof";return Dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Dy(e)}var i8e=["valueAccessor"],s8e=["data","dataKey","clockWise","id","textBreakAll"];function a8e(e){return d8e(e)||l8e(e)||c8e(e)||o8e()}function o8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c8e(e,n){if(e){if(typeof e=="string")return ek(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ek(e,n)}}function l8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function d8e(e){if(Array.isArray(e))return ek(e)}function ek(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function OS(){return OS=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},OS.apply(this,arguments)}function HK(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function KK(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?HK(Object(s),!0).forEach(function(o){u8e(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):HK(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function u8e(e,n,s){return n=h8e(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function h8e(e){var n=p8e(e,"string");return Dy(n)=="symbol"?n:n+""}function p8e(e,n){if(Dy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Dy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function YK(e,n){if(e==null)return{};var s=m8e(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function m8e(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}var f8e=function(n){return Array.isArray(n.value)?r8e(n.value):n.value};function Bl(e){var n=e.valueAccessor,s=n===void 0?f8e:n,o=YK(e,i8e),d=o.data,h=o.dataKey,f=o.clockWise,v=o.id,b=o.textBreakAll,_=YK(o,s8e);return!d||!d.length?null:ye.createElement(xr,{className:"recharts-label-list"},d.map(function(w,E){var N=En(h)?s(w,E):Ds(w&&w.payload,h),I=En(v)?{}:{id:"".concat(v,"-").concat(E)};return ye.createElement(bs,OS({},bn(w,!0),_,I,{parentViewBox:w.parentViewBox,value:N,textBreakAll:b,viewBox:bs.parseViewBox(En(f)?w:KK(KK({},w),{},{clockWise:f})),key:"label-".concat(E),index:E}))}))}Bl.displayName="LabelList";function g8e(e,n){return e?e===!0?ye.createElement(Bl,{key:"labelList-implicit",data:n}):ye.isValidElement(e)||mn(e)?ye.createElement(Bl,{key:"labelList-implicit",data:n,content:e}):vg(e)?ye.createElement(Bl,OS({data:n},e,{key:"labelList-implicit"})):null:null}function v8e(e,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&s&&!e.label)return null;var o=e.children,d=Eo(o,Bl).map(function(f,v){return z.cloneElement(f,{data:n,key:"labelList-".concat(v)})});if(!s)return d;var h=g8e(e.label,n);return[h].concat(a8e(d))}Bl.renderCallByParent=v8e;function Ly(e){"@babel/helpers - typeof";return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ly(e)}function tk(){return tk=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},tk.apply(this,arguments)}function qK(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function XK(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?qK(Object(s),!0).forEach(function(o){y8e(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):qK(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function y8e(e,n,s){return n=b8e(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function b8e(e){var n=x8e(e,"string");return Ly(n)=="symbol"?n:n+""}function x8e(e,n){if(Ly(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Ly(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var _8e=function(n,s){var o=dc(s-n),d=Math.min(Math.abs(s-n),359.999);return o*d},qE=function(n){var s=n.cx,o=n.cy,d=n.radius,h=n.angle,f=n.sign,v=n.isExternal,b=n.cornerRadius,_=n.cornerIsExternal,w=b*(v?1:-1)+d,E=Math.asin(b/w)/IS,N=_?h:h+f*E,I=rs(s,o,w,N),R=rs(s,o,d,N),O=_?h-f*E:h,P=rs(s,o,w*Math.cos(E*IS),O);return{center:I,circleTangency:R,lineTangency:P,theta:E}},Rte=function(n){var s=n.cx,o=n.cy,d=n.innerRadius,h=n.outerRadius,f=n.startAngle,v=n.endAngle,b=_8e(f,v),_=f+b,w=rs(s,o,h,f),E=rs(s,o,h,_),N="M ".concat(w.x,",").concat(w.y,`
    A `).concat(h,",").concat(h,`,0,
    `).concat(+(Math.abs(b)>180),",").concat(+(f>_),`,
    `).concat(E.x,",").concat(E.y,`
  `);if(d>0){var I=rs(s,o,d,f),R=rs(s,o,d,_);N+="L ".concat(R.x,",").concat(R.y,`
            A `).concat(d,",").concat(d,`,0,
            `).concat(+(Math.abs(b)>180),",").concat(+(f<=_),`,
            `).concat(I.x,",").concat(I.y," Z")}else N+="L ".concat(s,",").concat(o," Z");return N},E8e=function(n){var s=n.cx,o=n.cy,d=n.innerRadius,h=n.outerRadius,f=n.cornerRadius,v=n.forceCornerRadius,b=n.cornerIsExternal,_=n.startAngle,w=n.endAngle,E=dc(w-_),N=qE({cx:s,cy:o,radius:h,angle:_,sign:E,cornerRadius:f,cornerIsExternal:b}),I=N.circleTangency,R=N.lineTangency,O=N.theta,P=qE({cx:s,cy:o,radius:h,angle:w,sign:-E,cornerRadius:f,cornerIsExternal:b}),M=P.circleTangency,D=P.lineTangency,U=P.theta,B=b?Math.abs(_-w):Math.abs(_-w)-O-U;if(B<0)return v?"M ".concat(R.x,",").concat(R.y,`
        a`).concat(f,",").concat(f,",0,0,1,").concat(f*2,`,0
        a`).concat(f,",").concat(f,",0,0,1,").concat(-f*2,`,0
      `):Rte({cx:s,cy:o,innerRadius:d,outerRadius:h,startAngle:_,endAngle:w});var G="M ".concat(R.x,",").concat(R.y,`
    A`).concat(f,",").concat(f,",0,0,").concat(+(E<0),",").concat(I.x,",").concat(I.y,`
    A`).concat(h,",").concat(h,",0,").concat(+(B>180),",").concat(+(E<0),",").concat(M.x,",").concat(M.y,`
    A`).concat(f,",").concat(f,",0,0,").concat(+(E<0),",").concat(D.x,",").concat(D.y,`
  `);if(d>0){var $=qE({cx:s,cy:o,radius:d,angle:_,sign:E,isExternal:!0,cornerRadius:f,cornerIsExternal:b}),q=$.circleTangency,X=$.lineTangency,ee=$.theta,ce=qE({cx:s,cy:o,radius:d,angle:w,sign:-E,isExternal:!0,cornerRadius:f,cornerIsExternal:b}),Q=ce.circleTangency,ae=ce.lineTangency,ve=ce.theta,le=b?Math.abs(_-w):Math.abs(_-w)-ee-ve;if(le<0&&f===0)return"".concat(G,"L").concat(s,",").concat(o,"Z");G+="L".concat(ae.x,",").concat(ae.y,`
      A`).concat(f,",").concat(f,",0,0,").concat(+(E<0),",").concat(Q.x,",").concat(Q.y,`
      A`).concat(d,",").concat(d,",0,").concat(+(le>180),",").concat(+(E>0),",").concat(q.x,",").concat(q.y,`
      A`).concat(f,",").concat(f,",0,0,").concat(+(E<0),",").concat(X.x,",").concat(X.y,"Z")}else G+="L".concat(s,",").concat(o,"Z");return G},w8e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Ate=function(n){var s=XK(XK({},w8e),n),o=s.cx,d=s.cy,h=s.innerRadius,f=s.outerRadius,v=s.cornerRadius,b=s.forceCornerRadius,_=s.cornerIsExternal,w=s.startAngle,E=s.endAngle,N=s.className;if(f<h||w===E)return null;var I=In("recharts-sector",N),R=f-h,O=tp(v,R,0,!0),P;return O>0&&Math.abs(w-E)<360?P=E8e({cx:o,cy:d,innerRadius:h,outerRadius:f,cornerRadius:Math.min(O,R/2),forceCornerRadius:b,cornerIsExternal:_,startAngle:w,endAngle:E}):P=Rte({cx:o,cy:d,innerRadius:h,outerRadius:f,startAngle:w,endAngle:E}),ye.createElement("path",tk({},bn(s,!0),{className:I,d:P,role:"img"}))};function My(e){"@babel/helpers - typeof";return My=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},My(e)}function nk(){return nk=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},nk.apply(this,arguments)}function JK(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function QK(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?JK(Object(s),!0).forEach(function(o){S8e(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):JK(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function S8e(e,n,s){return n=T8e(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function T8e(e){var n=N8e(e,"string");return My(n)=="symbol"?n:n+""}function N8e(e,n){if(My(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(My(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var ZK={curveBasisClosed:S2e,curveBasisOpen:T2e,curveBasis:w2e,curveBumpX:l2e,curveBumpY:d2e,curveLinearClosed:N2e,curveLinear:zT,curveMonotoneX:C2e,curveMonotoneY:R2e,curveNatural:A2e,curveStep:I2e,curveStepAfter:P2e,curveStepBefore:O2e},XE=function(n){return n.x===+n.x&&n.y===+n.y},wv=function(n){return n.x},Sv=function(n){return n.y},C8e=function(n,s){if(mn(n))return n;var o="curve".concat(WT(n));return(o==="curveMonotone"||o==="curveBump")&&s?ZK["".concat(o).concat(s==="vertical"?"Y":"X")]:ZK[o]||zT},R8e=function(n){var s=n.type,o=s===void 0?"linear":s,d=n.points,h=d===void 0?[]:d,f=n.baseLine,v=n.layout,b=n.connectNulls,_=b===void 0?!1:b,w=C8e(o,v),E=_?h.filter(function(O){return XE(O)}):h,N;if(Array.isArray(f)){var I=_?f.filter(function(O){return XE(O)}):f,R=E.map(function(O,P){return QK(QK({},O),{},{base:I[P]})});return v==="vertical"?N=VE().y(Sv).x1(wv).x0(function(O){return O.base.x}):N=VE().x(wv).y1(Sv).y0(function(O){return O.base.y}),N.defined(XE).curve(w),N(R)}return v==="vertical"&&pt(f)?N=VE().y(Sv).x1(wv).x0(f):pt(f)?N=VE().x(wv).y1(Sv).y0(f):N=AZ().x(wv).y(Sv),N.defined(XE).curve(w),N(E)},xf=function(n){var s=n.className,o=n.points,d=n.path,h=n.pathRef;if((!o||!o.length)&&!d)return null;var f=o&&o.length?R8e(n):d;return z.createElement("path",nk({},bn(n,!1),Zw(n),{className:In("recharts-curve",s),d:f,ref:h}))},Ite={exports:{}},A8e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",I8e=A8e,O8e=I8e;function Ote(){}function Pte(){}Pte.resetWarningCache=Ote;var P8e=function(){function e(o,d,h,f,v,b){if(b!==O8e){var _=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw _.name="Invariant Violation",_}}e.isRequired=e;function n(){return e}var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:Pte,resetWarningCache:Ote};return s.PropTypes=s,s};Ite.exports=P8e();var k8e=Ite.exports;const Vt=ur(k8e);var j8e=Object.getOwnPropertyNames,D8e=Object.getOwnPropertySymbols,L8e=Object.prototype.hasOwnProperty;function eY(e,n){return function(o,d,h){return e(o,d,h)&&n(o,d,h)}}function JE(e){return function(s,o,d){if(!s||!o||typeof s!="object"||typeof o!="object")return e(s,o,d);var h=d.cache,f=h.get(s),v=h.get(o);if(f&&v)return f===o&&v===s;h.set(s,o),h.set(o,s);var b=e(s,o,d);return h.delete(s),h.delete(o),b}}function M8e(e){return e!=null?e[Symbol.toStringTag]:void 0}function tY(e){return j8e(e).concat(D8e(e))}var U8e=Object.hasOwn||function(e,n){return L8e.call(e,n)};function hp(e,n){return e===n||!e&&!n&&e!==e&&n!==n}var F8e="__v",V8e="__o",B8e="_owner",nY=Object.getOwnPropertyDescriptor,rY=Object.keys;function G8e(e,n,s){var o=e.length;if(n.length!==o)return!1;for(;o-- >0;)if(!s.equals(e[o],n[o],o,o,e,n,s))return!1;return!0}function W8e(e,n){return hp(e.getTime(),n.getTime())}function $8e(e,n){return e.name===n.name&&e.message===n.message&&e.cause===n.cause&&e.stack===n.stack}function z8e(e,n){return e===n}function iY(e,n,s){var o=e.size;if(o!==n.size)return!1;if(!o)return!0;for(var d=new Array(o),h=e.entries(),f,v,b=0;(f=h.next())&&!f.done;){for(var _=n.entries(),w=!1,E=0;(v=_.next())&&!v.done;){if(d[E]){E++;continue}var N=f.value,I=v.value;if(s.equals(N[0],I[0],b,E,e,n,s)&&s.equals(N[1],I[1],N[0],I[0],e,n,s)){w=d[E]=!0;break}E++}if(!w)return!1;b++}return!0}var H8e=hp;function K8e(e,n,s){var o=rY(e),d=o.length;if(rY(n).length!==d)return!1;for(;d-- >0;)if(!kte(e,n,s,o[d]))return!1;return!0}function Tv(e,n,s){var o=tY(e),d=o.length;if(tY(n).length!==d)return!1;for(var h,f,v;d-- >0;)if(h=o[d],!kte(e,n,s,h)||(f=nY(e,h),v=nY(n,h),(f||v)&&(!f||!v||f.configurable!==v.configurable||f.enumerable!==v.enumerable||f.writable!==v.writable)))return!1;return!0}function Y8e(e,n){return hp(e.valueOf(),n.valueOf())}function q8e(e,n){return e.source===n.source&&e.flags===n.flags}function sY(e,n,s){var o=e.size;if(o!==n.size)return!1;if(!o)return!0;for(var d=new Array(o),h=e.values(),f,v;(f=h.next())&&!f.done;){for(var b=n.values(),_=!1,w=0;(v=b.next())&&!v.done;){if(!d[w]&&s.equals(f.value,v.value,f.value,v.value,e,n,s)){_=d[w]=!0;break}w++}if(!_)return!1}return!0}function X8e(e,n){var s=e.length;if(n.length!==s)return!1;for(;s-- >0;)if(e[s]!==n[s])return!1;return!0}function J8e(e,n){return e.hostname===n.hostname&&e.pathname===n.pathname&&e.protocol===n.protocol&&e.port===n.port&&e.hash===n.hash&&e.username===n.username&&e.password===n.password}function kte(e,n,s,o){return(o===B8e||o===V8e||o===F8e)&&(e.$$typeof||n.$$typeof)?!0:U8e(n,o)&&s.equals(e[o],n[o],o,o,e,n,s)}var Q8e="[object Arguments]",Z8e="[object Boolean]",eGe="[object Date]",tGe="[object Error]",nGe="[object Map]",rGe="[object Number]",iGe="[object Object]",sGe="[object RegExp]",aGe="[object Set]",oGe="[object String]",cGe="[object URL]",lGe=Array.isArray,aY=typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView:null,oY=Object.assign,dGe=Object.prototype.toString.call.bind(Object.prototype.toString);function uGe(e){var n=e.areArraysEqual,s=e.areDatesEqual,o=e.areErrorsEqual,d=e.areFunctionsEqual,h=e.areMapsEqual,f=e.areNumbersEqual,v=e.areObjectsEqual,b=e.arePrimitiveWrappersEqual,_=e.areRegExpsEqual,w=e.areSetsEqual,E=e.areTypedArraysEqual,N=e.areUrlsEqual,I=e.unknownTagComparators;return function(O,P,M){if(O===P)return!0;if(O==null||P==null)return!1;var D=typeof O;if(D!==typeof P)return!1;if(D!=="object")return D==="number"?f(O,P,M):D==="function"?d(O,P,M):!1;var U=O.constructor;if(U!==P.constructor)return!1;if(U===Object)return v(O,P,M);if(lGe(O))return n(O,P,M);if(aY!=null&&aY(O))return E(O,P,M);if(U===Date)return s(O,P,M);if(U===RegExp)return _(O,P,M);if(U===Map)return h(O,P,M);if(U===Set)return w(O,P,M);var B=dGe(O);if(B===eGe)return s(O,P,M);if(B===sGe)return _(O,P,M);if(B===nGe)return h(O,P,M);if(B===aGe)return w(O,P,M);if(B===iGe)return typeof O.then!="function"&&typeof P.then!="function"&&v(O,P,M);if(B===cGe)return N(O,P,M);if(B===tGe)return o(O,P,M);if(B===Q8e)return v(O,P,M);if(B===Z8e||B===rGe||B===oGe)return b(O,P,M);if(I){var G=I[B];if(!G){var $=M8e(O);$&&(G=I[$])}if(G)return G(O,P,M)}return!1}}function hGe(e){var n=e.circular,s=e.createCustomConfig,o=e.strict,d={areArraysEqual:o?Tv:G8e,areDatesEqual:W8e,areErrorsEqual:$8e,areFunctionsEqual:z8e,areMapsEqual:o?eY(iY,Tv):iY,areNumbersEqual:H8e,areObjectsEqual:o?Tv:K8e,arePrimitiveWrappersEqual:Y8e,areRegExpsEqual:q8e,areSetsEqual:o?eY(sY,Tv):sY,areTypedArraysEqual:o?Tv:X8e,areUrlsEqual:J8e,unknownTagComparators:void 0};if(s&&(d=oY({},d,s(d))),n){var h=JE(d.areArraysEqual),f=JE(d.areMapsEqual),v=JE(d.areObjectsEqual),b=JE(d.areSetsEqual);d=oY({},d,{areArraysEqual:h,areMapsEqual:f,areObjectsEqual:v,areSetsEqual:b})}return d}function pGe(e){return function(n,s,o,d,h,f,v){return e(n,s,v)}}function mGe(e){var n=e.circular,s=e.comparator,o=e.createState,d=e.equals,h=e.strict;if(o)return function(b,_){var w=o(),E=w.cache,N=E===void 0?n?new WeakMap:void 0:E,I=w.meta;return s(b,_,{cache:N,equals:d,meta:I,strict:h})};if(n)return function(b,_){return s(b,_,{cache:new WeakMap,equals:d,meta:void 0,strict:h})};var f={cache:void 0,equals:d,meta:void 0,strict:h};return function(b,_){return s(b,_,f)}}var fGe=Tu();Tu({strict:!0});Tu({circular:!0});Tu({circular:!0,strict:!0});Tu({createInternalComparator:function(){return hp}});Tu({strict:!0,createInternalComparator:function(){return hp}});Tu({circular:!0,createInternalComparator:function(){return hp}});Tu({circular:!0,createInternalComparator:function(){return hp},strict:!0});function Tu(e){e===void 0&&(e={});var n=e.circular,s=n===void 0?!1:n,o=e.createInternalComparator,d=e.createState,h=e.strict,f=h===void 0?!1:h,v=hGe(e),b=uGe(v),_=o?o(b):pGe(b);return mGe({circular:s,comparator:b,createState:d,equals:_,strict:f})}function gGe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function cY(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=-1,o=function d(h){s<0&&(s=h),h-s>n?(e(h),s=-1):gGe(d)};requestAnimationFrame(o)}function rk(e){"@babel/helpers - typeof";return rk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},rk(e)}function vGe(e){return _Ge(e)||xGe(e)||bGe(e)||yGe()}function yGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bGe(e,n){if(e){if(typeof e=="string")return lY(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return lY(e,n)}}function lY(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function xGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Ge(e){if(Array.isArray(e))return e}function EGe(){var e={},n=function(){return null},s=!1,o=function d(h){if(!s){if(Array.isArray(h)){if(!h.length)return;var f=h,v=vGe(f),b=v[0],_=v.slice(1);if(typeof b=="number"){cY(d.bind(null,_),b);return}d(b),cY(d.bind(null,_));return}rk(h)==="object"&&(e=h,n(e)),typeof h=="function"&&h()}};return{stop:function(){s=!0},start:function(h){s=!1,o(h)},subscribe:function(h){return n=h,function(){n=function(){return null}}}}}function Uy(e){"@babel/helpers - typeof";return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Uy(e)}function dY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function uY(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?dY(Object(s),!0).forEach(function(o){jte(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):dY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function jte(e,n,s){return n=wGe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function wGe(e){var n=SGe(e,"string");return Uy(n)==="symbol"?n:String(n)}function SGe(e,n){if(Uy(e)!=="object"||e===null)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Uy(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var TGe=function(n,s){return[Object.keys(n),Object.keys(s)].reduce(function(o,d){return o.filter(function(h){return d.includes(h)})})},NGe=function(n){return n},CGe=function(n){return n.replace(/([A-Z])/g,function(s){return"-".concat(s.toLowerCase())})},Kv=function(n,s){return Object.keys(s).reduce(function(o,d){return uY(uY({},o),{},jte({},d,n(d,s[d])))},{})},hY=function(n,s,o){return n.map(function(d){return"".concat(CGe(d)," ").concat(s,"ms ").concat(o)}).join(",")};function RGe(e,n){return OGe(e)||IGe(e,n)||Dte(e,n)||AGe()}function AGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IGe(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n!==0)for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function OGe(e){if(Array.isArray(e))return e}function PGe(e){return DGe(e)||jGe(e)||Dte(e)||kGe()}function kGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dte(e,n){if(e){if(typeof e=="string")return ik(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ik(e,n)}}function jGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DGe(e){if(Array.isArray(e))return ik(e)}function ik(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}var PS=1e-4,Lte=function(n,s){return[0,3*n,3*s-6*n,3*n-3*s+1]},Mte=function(n,s){return n.map(function(o,d){return o*Math.pow(s,d)}).reduce(function(o,d){return o+d})},pY=function(n,s){return function(o){var d=Lte(n,s);return Mte(d,o)}},LGe=function(n,s){return function(o){var d=Lte(n,s),h=[].concat(PGe(d.map(function(f,v){return f*v}).slice(1)),[0]);return Mte(h,o)}},mY=function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];var d=s[0],h=s[1],f=s[2],v=s[3];if(s.length===1)switch(s[0]){case"linear":d=0,h=0,f=1,v=1;break;case"ease":d=.25,h=.1,f=.25,v=1;break;case"ease-in":d=.42,h=0,f=1,v=1;break;case"ease-out":d=.42,h=0,f=.58,v=1;break;case"ease-in-out":d=0,h=0,f=.58,v=1;break;default:{var b=s[0].split("(");if(b[0]==="cubic-bezier"&&b[1].split(")")[0].split(",").length===4){var _=b[1].split(")")[0].split(",").map(function(P){return parseFloat(P)}),w=RGe(_,4);d=w[0],h=w[1],f=w[2],v=w[3]}}}var E=pY(d,f),N=pY(h,v),I=LGe(d,f),R=function(M){return M>1?1:M<0?0:M},O=function(M){for(var D=M>1?1:M,U=D,B=0;B<8;++B){var G=E(U)-D,$=I(U);if(Math.abs(G-D)<PS||$<PS)return N(U);U=R(U-G/$)}return N(U)};return O.isStepper=!1,O},MGe=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=n.stiff,o=s===void 0?100:s,d=n.damping,h=d===void 0?8:d,f=n.dt,v=f===void 0?17:f,b=function(w,E,N){var I=-(w-E)*o,R=N*h,O=N+(I-R)*v/1e3,P=N*v/1e3+w;return Math.abs(P-E)<PS&&Math.abs(O)<PS?[E,0]:[P,O]};return b.isStepper=!0,b.dt=v,b},UGe=function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];var d=s[0];if(typeof d=="string")switch(d){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return mY(d);case"spring":return MGe();default:if(d.split("(")[0]==="cubic-bezier")return mY(d)}return typeof d=="function"?d:null};function Fy(e){"@babel/helpers - typeof";return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Fy(e)}function fY(e){return BGe(e)||VGe(e)||Ute(e)||FGe()}function FGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BGe(e){if(Array.isArray(e))return ak(e)}function gY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function Zi(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?gY(Object(s),!0).forEach(function(o){sk(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):gY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function sk(e,n,s){return n=GGe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function GGe(e){var n=WGe(e,"string");return Fy(n)==="symbol"?n:String(n)}function WGe(e,n){if(Fy(e)!=="object"||e===null)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Fy(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function $Ge(e,n){return KGe(e)||HGe(e,n)||Ute(e,n)||zGe()}function zGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ute(e,n){if(e){if(typeof e=="string")return ak(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ak(e,n)}}function ak(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function HGe(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n!==0)for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function KGe(e){if(Array.isArray(e))return e}var kS=function(n,s,o){return n+(s-n)*o},ok=function(n){var s=n.from,o=n.to;return s!==o},YGe=function e(n,s,o){var d=Kv(function(h,f){if(ok(f)){var v=n(f.from,f.to,f.velocity),b=$Ge(v,2),_=b[0],w=b[1];return Zi(Zi({},f),{},{from:_,velocity:w})}return f},s);return o<1?Kv(function(h,f){return ok(f)?Zi(Zi({},f),{},{velocity:kS(f.velocity,d[h].velocity,o),from:kS(f.from,d[h].from,o)}):f},s):e(n,d,o-1)};const qGe=function(e,n,s,o,d){var h=TGe(e,n),f=h.reduce(function(P,M){return Zi(Zi({},P),{},sk({},M,[e[M],n[M]]))},{}),v=h.reduce(function(P,M){return Zi(Zi({},P),{},sk({},M,{from:e[M],velocity:0,to:n[M]}))},{}),b=-1,_,w,E=function(){return null},N=function(){return Kv(function(M,D){return D.from},v)},I=function(){return!Object.values(v).filter(ok).length},R=function(M){_||(_=M);var D=M-_,U=D/s.dt;v=YGe(s,v,U),d(Zi(Zi(Zi({},e),n),N())),_=M,I()||(b=requestAnimationFrame(E))},O=function(M){w||(w=M);var D=(M-w)/o,U=Kv(function(G,$){return kS.apply(void 0,fY($).concat([s(D)]))},f);if(d(Zi(Zi(Zi({},e),n),U)),D<1)b=requestAnimationFrame(E);else{var B=Kv(function(G,$){return kS.apply(void 0,fY($).concat([s(1)]))},f);d(Zi(Zi(Zi({},e),n),B))}};return E=s.isStepper?R:O,function(){return requestAnimationFrame(E),function(){cancelAnimationFrame(b)}}};function Wf(e){"@babel/helpers - typeof";return Wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Wf(e)}var XGe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function JGe(e,n){if(e==null)return{};var s=QGe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function QGe(e,n){if(e==null)return{};var s={},o=Object.keys(e),d,h;for(h=0;h<o.length;h++)d=o[h],!(n.indexOf(d)>=0)&&(s[d]=e[d]);return s}function LO(e){return nWe(e)||tWe(e)||eWe(e)||ZGe()}function ZGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eWe(e,n){if(e){if(typeof e=="string")return ck(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ck(e,n)}}function tWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nWe(e){if(Array.isArray(e))return ck(e)}function ck(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function vY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function nc(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?vY(Object(s),!0).forEach(function(o){kv(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):vY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function kv(e,n,s){return n=Fte(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function rWe(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function iWe(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Fte(o.key),o)}}function sWe(e,n,s){return n&&iWe(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fte(e){var n=aWe(e,"string");return Wf(n)==="symbol"?n:String(n)}function aWe(e,n){if(Wf(e)!=="object"||e===null)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Wf(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function oWe(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&lk(e,n)}function lk(e,n){return lk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},lk(e,n)}function cWe(e){var n=lWe();return function(){var o=jS(e),d;if(n){var h=jS(this).constructor;d=Reflect.construct(o,arguments,h)}else d=o.apply(this,arguments);return dk(this,d)}}function dk(e,n){if(n&&(Wf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uk(e)}function uk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jS(e){return jS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},jS(e)}var rl=function(e){oWe(s,e);var n=cWe(s);function s(o,d){var h;rWe(this,s),h=n.call(this,o,d);var f=h.props,v=f.isActive,b=f.attributeName,_=f.from,w=f.to,E=f.steps,N=f.children,I=f.duration;if(h.handleStyleChange=h.handleStyleChange.bind(uk(h)),h.changeStyle=h.changeStyle.bind(uk(h)),!v||I<=0)return h.state={style:{}},typeof N=="function"&&(h.state={style:w}),dk(h);if(E&&E.length)h.state={style:E[0].style};else if(_){if(typeof N=="function")return h.state={style:_},dk(h);h.state={style:b?kv({},b,_):_}}else h.state={style:{}};return h}return sWe(s,[{key:"componentDidMount",value:function(){var d=this.props,h=d.isActive,f=d.canBegin;this.mounted=!0,!(!h||!f)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(d){var h=this.props,f=h.isActive,v=h.canBegin,b=h.attributeName,_=h.shouldReAnimate,w=h.to,E=h.from,N=this.state.style;if(v){if(!f){var I={style:b?kv({},b,w):w};this.state&&N&&(b&&N[b]!==w||!b&&N!==w)&&this.setState(I);return}if(!(fGe(d.to,w)&&d.canBegin&&d.isActive)){var R=!d.canBegin||!d.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var O=R||_?E:d.to;if(this.state&&N){var P={style:b?kv({},b,O):O};(b&&N[b]!==O||!b&&N!==O)&&this.setState(P)}this.runAnimation(nc(nc({},this.props),{},{from:O,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var d=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),d&&d()}},{key:"handleStyleChange",value:function(d){this.changeStyle(d)}},{key:"changeStyle",value:function(d){this.mounted&&this.setState({style:d})}},{key:"runJSAnimation",value:function(d){var h=this,f=d.from,v=d.to,b=d.duration,_=d.easing,w=d.begin,E=d.onAnimationEnd,N=d.onAnimationStart,I=qGe(f,v,UGe(_),b,this.changeStyle),R=function(){h.stopJSAnimation=I()};this.manager.start([N,w,R,b,E])}},{key:"runStepAnimation",value:function(d){var h=this,f=d.steps,v=d.begin,b=d.onAnimationStart,_=f[0],w=_.style,E=_.duration,N=E===void 0?0:E,I=function(O,P,M){if(M===0)return O;var D=P.duration,U=P.easing,B=U===void 0?"ease":U,G=P.style,$=P.properties,q=P.onAnimationEnd,X=M>0?f[M-1]:P,ee=$||Object.keys(G);if(typeof B=="function"||B==="spring")return[].concat(LO(O),[h.runJSAnimation.bind(h,{from:X.style,to:G,duration:D,easing:B}),D]);var ce=hY(ee,D,B),Q=nc(nc(nc({},X.style),G),{},{transition:ce});return[].concat(LO(O),[Q,D,q]).filter(NGe)};return this.manager.start([b].concat(LO(f.reduce(I,[w,Math.max(N,v)])),[d.onAnimationEnd]))}},{key:"runAnimation",value:function(d){this.manager||(this.manager=EGe());var h=d.begin,f=d.duration,v=d.attributeName,b=d.to,_=d.easing,w=d.onAnimationStart,E=d.onAnimationEnd,N=d.steps,I=d.children,R=this.manager;if(this.unSubscribe=R.subscribe(this.handleStyleChange),typeof _=="function"||typeof I=="function"||_==="spring"){this.runJSAnimation(d);return}if(N.length>1){this.runStepAnimation(d);return}var O=v?kv({},v,b):b,P=hY(Object.keys(O),f,_);R.start([w,h,nc(nc({},O),{},{transition:P}),f,E])}},{key:"render",value:function(){var d=this.props,h=d.children;d.begin;var f=d.duration;d.attributeName,d.easing;var v=d.isActive;d.steps,d.from,d.to,d.canBegin,d.onAnimationEnd,d.shouldReAnimate,d.onAnimationReStart;var b=JGe(d,XGe),_=z.Children.count(h),w=this.state.style;if(typeof h=="function")return h(w);if(!v||_===0||f<=0)return h;var E=function(I){var R=I.props,O=R.style,P=O===void 0?{}:O,M=R.className,D=z.cloneElement(I,nc(nc({},b),{},{style:nc(nc({},P),w),className:M}));return D};return _===1?E(z.Children.only(h)):ye.createElement("div",null,z.Children.map(h,function(N){return E(N)}))}}]),s}(z.PureComponent);rl.displayName="Animate";rl.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};rl.propTypes={from:Vt.oneOfType([Vt.object,Vt.string]),to:Vt.oneOfType([Vt.object,Vt.string]),attributeName:Vt.string,duration:Vt.number,begin:Vt.number,easing:Vt.oneOfType([Vt.string,Vt.func]),steps:Vt.arrayOf(Vt.shape({duration:Vt.number.isRequired,style:Vt.object.isRequired,easing:Vt.oneOfType([Vt.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Vt.func]),properties:Vt.arrayOf("string"),onAnimationEnd:Vt.func})),children:Vt.oneOfType([Vt.node,Vt.func]),isActive:Vt.bool,canBegin:Vt.bool,onAnimationEnd:Vt.func,shouldReAnimate:Vt.bool,onAnimationStart:Vt.func,onAnimationReStart:Vt.func};function Vy(e){"@babel/helpers - typeof";return Vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Vy(e)}function DS(){return DS=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},DS.apply(this,arguments)}function dWe(e,n){return mWe(e)||pWe(e,n)||hWe(e,n)||uWe()}function uWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hWe(e,n){if(e){if(typeof e=="string")return yY(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return yY(e,n)}}function yY(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function pWe(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n!==0)for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function mWe(e){if(Array.isArray(e))return e}function bY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function xY(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?bY(Object(s),!0).forEach(function(o){fWe(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):bY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function fWe(e,n,s){return n=gWe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function gWe(e){var n=vWe(e,"string");return Vy(n)=="symbol"?n:n+""}function vWe(e,n){if(Vy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Vy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var _Y=function(n,s,o,d,h){var f=Math.min(Math.abs(o)/2,Math.abs(d)/2),v=d>=0?1:-1,b=o>=0?1:-1,_=d>=0&&o>=0||d<0&&o<0?1:0,w;if(f>0&&h instanceof Array){for(var E=[0,0,0,0],N=0,I=4;N<I;N++)E[N]=h[N]>f?f:h[N];w="M".concat(n,",").concat(s+v*E[0]),E[0]>0&&(w+="A ".concat(E[0],",").concat(E[0],",0,0,").concat(_,",").concat(n+b*E[0],",").concat(s)),w+="L ".concat(n+o-b*E[1],",").concat(s),E[1]>0&&(w+="A ".concat(E[1],",").concat(E[1],",0,0,").concat(_,`,
        `).concat(n+o,",").concat(s+v*E[1])),w+="L ".concat(n+o,",").concat(s+d-v*E[2]),E[2]>0&&(w+="A ".concat(E[2],",").concat(E[2],",0,0,").concat(_,`,
        `).concat(n+o-b*E[2],",").concat(s+d)),w+="L ".concat(n+b*E[3],",").concat(s+d),E[3]>0&&(w+="A ".concat(E[3],",").concat(E[3],",0,0,").concat(_,`,
        `).concat(n,",").concat(s+d-v*E[3])),w+="Z"}else if(f>0&&h===+h&&h>0){var R=Math.min(f,h);w="M ".concat(n,",").concat(s+v*R,`
            A `).concat(R,",").concat(R,",0,0,").concat(_,",").concat(n+b*R,",").concat(s,`
            L `).concat(n+o-b*R,",").concat(s,`
            A `).concat(R,",").concat(R,",0,0,").concat(_,",").concat(n+o,",").concat(s+v*R,`
            L `).concat(n+o,",").concat(s+d-v*R,`
            A `).concat(R,",").concat(R,",0,0,").concat(_,",").concat(n+o-b*R,",").concat(s+d,`
            L `).concat(n+b*R,",").concat(s+d,`
            A `).concat(R,",").concat(R,",0,0,").concat(_,",").concat(n,",").concat(s+d-v*R," Z")}else w="M ".concat(n,",").concat(s," h ").concat(o," v ").concat(d," h ").concat(-o," Z");return w},yWe=function(n,s){if(!n||!s)return!1;var o=n.x,d=n.y,h=s.x,f=s.y,v=s.width,b=s.height;if(Math.abs(v)>0&&Math.abs(b)>0){var _=Math.min(h,h+v),w=Math.max(h,h+v),E=Math.min(f,f+b),N=Math.max(f,f+b);return o>=_&&o<=w&&d>=E&&d<=N}return!1},bWe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},KD=function(n){var s=xY(xY({},bWe),n),o=z.useRef(),d=z.useState(-1),h=dWe(d,2),f=h[0],v=h[1];z.useEffect(function(){if(o.current&&o.current.getTotalLength)try{var B=o.current.getTotalLength();B&&v(B)}catch{}},[]);var b=s.x,_=s.y,w=s.width,E=s.height,N=s.radius,I=s.className,R=s.animationEasing,O=s.animationDuration,P=s.animationBegin,M=s.isAnimationActive,D=s.isUpdateAnimationActive;if(b!==+b||_!==+_||w!==+w||E!==+E||w===0||E===0)return null;var U=In("recharts-rectangle",I);return D?ye.createElement(rl,{canBegin:f>0,from:{width:w,height:E,x:b,y:_},to:{width:w,height:E,x:b,y:_},duration:O,animationEasing:R,isActive:D},function(B){var G=B.width,$=B.height,q=B.x,X=B.y;return ye.createElement(rl,{canBegin:f>0,from:"0px ".concat(f===-1?1:f,"px"),to:"".concat(f,"px 0px"),attributeName:"strokeDasharray",begin:P,duration:O,isActive:M,easing:R},ye.createElement("path",DS({},bn(s,!0),{className:U,d:_Y(q,X,G,$,N),ref:o})))}):ye.createElement("path",DS({},bn(s,!0),{className:U,d:_Y(b,_,w,E,N)}))};function hk(){return hk=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},hk.apply(this,arguments)}var sN=function(n){var s=n.cx,o=n.cy,d=n.r,h=n.className,f=In("recharts-dot",h);return s===+s&&o===+o&&d===+d?z.createElement("circle",hk({},bn(n,!1),Zw(n),{className:f,cx:s,cy:o,r:d})):null};function By(e){"@babel/helpers - typeof";return By=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},By(e)}var xWe=["x","y","top","left","width","height","className"];function pk(){return pk=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},pk.apply(this,arguments)}function EY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function _We(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?EY(Object(s),!0).forEach(function(o){EWe(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):EY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function EWe(e,n,s){return n=wWe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function wWe(e){var n=SWe(e,"string");return By(n)=="symbol"?n:n+""}function SWe(e,n){if(By(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(By(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function TWe(e,n){if(e==null)return{};var s=NWe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function NWe(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}var CWe=function(n,s,o,d,h,f){return"M".concat(n,",").concat(h,"v").concat(d,"M").concat(f,",").concat(s,"h").concat(o)},RWe=function(n){var s=n.x,o=s===void 0?0:s,d=n.y,h=d===void 0?0:d,f=n.top,v=f===void 0?0:f,b=n.left,_=b===void 0?0:b,w=n.width,E=w===void 0?0:w,N=n.height,I=N===void 0?0:N,R=n.className,O=TWe(n,xWe),P=_We({x:o,y:h,top:v,left:_,width:E,height:I},O);return!pt(o)||!pt(h)||!pt(E)||!pt(I)||!pt(v)||!pt(_)?null:ye.createElement("path",pk({},bn(P,!0),{className:In("recharts-cross",R),d:CWe(o,h,E,I,v,_)}))},AWe=ZZ,IWe=AWe(Object.getPrototypeOf,Object),OWe=IWe,PWe=ed,kWe=OWe,jWe=td,DWe="[object Object]",LWe=Function.prototype,MWe=Object.prototype,Vte=LWe.toString,UWe=MWe.hasOwnProperty,FWe=Vte.call(Object);function VWe(e){if(!jWe(e)||PWe(e)!=DWe)return!1;var n=kWe(e);if(n===null)return!0;var s=UWe.call(n,"constructor")&&n.constructor;return typeof s=="function"&&s instanceof s&&Vte.call(s)==FWe}var BWe=VWe;const GWe=ur(BWe);var WWe=ed,$We=td,zWe="[object Boolean]";function HWe(e){return e===!0||e===!1||$We(e)&&WWe(e)==zWe}var KWe=HWe;const YWe=ur(KWe);function Gy(e){"@babel/helpers - typeof";return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Gy(e)}function LS(){return LS=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},LS.apply(this,arguments)}function qWe(e,n){return ZWe(e)||QWe(e,n)||JWe(e,n)||XWe()}function XWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JWe(e,n){if(e){if(typeof e=="string")return wY(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return wY(e,n)}}function wY(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function QWe(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n!==0)for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function ZWe(e){if(Array.isArray(e))return e}function SY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function TY(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?SY(Object(s),!0).forEach(function(o){e$e(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):SY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function e$e(e,n,s){return n=t$e(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function t$e(e){var n=n$e(e,"string");return Gy(n)=="symbol"?n:n+""}function n$e(e,n){if(Gy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Gy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var NY=function(n,s,o,d,h){var f=o-d,v;return v="M ".concat(n,",").concat(s),v+="L ".concat(n+o,",").concat(s),v+="L ".concat(n+o-f/2,",").concat(s+h),v+="L ".concat(n+o-f/2-d,",").concat(s+h),v+="L ".concat(n,",").concat(s," Z"),v},r$e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},i$e=function(n){var s=TY(TY({},r$e),n),o=z.useRef(),d=z.useState(-1),h=qWe(d,2),f=h[0],v=h[1];z.useEffect(function(){if(o.current&&o.current.getTotalLength)try{var U=o.current.getTotalLength();U&&v(U)}catch{}},[]);var b=s.x,_=s.y,w=s.upperWidth,E=s.lowerWidth,N=s.height,I=s.className,R=s.animationEasing,O=s.animationDuration,P=s.animationBegin,M=s.isUpdateAnimationActive;if(b!==+b||_!==+_||w!==+w||E!==+E||N!==+N||w===0&&E===0||N===0)return null;var D=In("recharts-trapezoid",I);return M?ye.createElement(rl,{canBegin:f>0,from:{upperWidth:0,lowerWidth:0,height:N,x:b,y:_},to:{upperWidth:w,lowerWidth:E,height:N,x:b,y:_},duration:O,animationEasing:R,isActive:M},function(U){var B=U.upperWidth,G=U.lowerWidth,$=U.height,q=U.x,X=U.y;return ye.createElement(rl,{canBegin:f>0,from:"0px ".concat(f===-1?1:f,"px"),to:"".concat(f,"px 0px"),attributeName:"strokeDasharray",begin:P,duration:O,easing:R},ye.createElement("path",LS({},bn(s,!0),{className:D,d:NY(q,X,B,G,$),ref:o})))}):ye.createElement("g",null,ye.createElement("path",LS({},bn(s,!0),{className:D,d:NY(b,_,w,E,N)})))},s$e=["option","shapeType","propTransformer","activeClassName","isActive"];function Wy(e){"@babel/helpers - typeof";return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Wy(e)}function a$e(e,n){if(e==null)return{};var s=o$e(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function o$e(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function CY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function MS(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?CY(Object(s),!0).forEach(function(o){c$e(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):CY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function c$e(e,n,s){return n=l$e(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function l$e(e){var n=d$e(e,"string");return Wy(n)=="symbol"?n:n+""}function d$e(e,n){if(Wy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Wy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function u$e(e,n){return MS(MS({},n),e)}function h$e(e,n){return e==="symbols"}function RY(e){var n=e.shapeType,s=e.elementProps;switch(n){case"rectangle":return ye.createElement(KD,s);case"trapezoid":return ye.createElement(i$e,s);case"sector":return ye.createElement(Ate,s);case"symbols":if(h$e(n))return ye.createElement(hD,s);break;default:return null}}function p$e(e){return z.isValidElement(e)?e.props:e}function m$e(e){var n=e.option,s=e.shapeType,o=e.propTransformer,d=o===void 0?u$e:o,h=e.activeClassName,f=h===void 0?"recharts-active-shape":h,v=e.isActive,b=a$e(e,s$e),_;if(z.isValidElement(n))_=z.cloneElement(n,MS(MS({},b),p$e(n)));else if(mn(n))_=n(b);else if(GWe(n)&&!YWe(n)){var w=d(n,b);_=ye.createElement(RY,{shapeType:s,elementProps:w})}else{var E=b;_=ye.createElement(RY,{shapeType:s,elementProps:E})}return v?ye.createElement(xr,{className:f},_):_}function aN(e,n){return n!=null&&"trapezoids"in e.props}function oN(e,n){return n!=null&&"sectors"in e.props}function $y(e,n){return n!=null&&"points"in e.props}function f$e(e,n){var s,o,d=e.x===(n==null||(s=n.labelViewBox)===null||s===void 0?void 0:s.x)||e.x===n.x,h=e.y===(n==null||(o=n.labelViewBox)===null||o===void 0?void 0:o.y)||e.y===n.y;return d&&h}function g$e(e,n){var s=e.endAngle===n.endAngle,o=e.startAngle===n.startAngle;return s&&o}function v$e(e,n){var s=e.x===n.x,o=e.y===n.y,d=e.z===n.z;return s&&o&&d}function y$e(e,n){var s;return aN(e,n)?s=f$e:oN(e,n)?s=g$e:$y(e,n)&&(s=v$e),s}function b$e(e,n){var s;return aN(e,n)?s="trapezoids":oN(e,n)?s="sectors":$y(e,n)&&(s="points"),s}function x$e(e,n){if(aN(e,n)){var s;return(s=n.tooltipPayload)===null||s===void 0||(s=s[0])===null||s===void 0||(s=s.payload)===null||s===void 0?void 0:s.payload}if(oN(e,n)){var o;return(o=n.tooltipPayload)===null||o===void 0||(o=o[0])===null||o===void 0||(o=o.payload)===null||o===void 0?void 0:o.payload}return $y(e,n)?n.payload:{}}function _$e(e){var n=e.activeTooltipItem,s=e.graphicalItem,o=e.itemData,d=b$e(s,n),h=x$e(s,n),f=o.filter(function(b,_){var w=Bf(h,b),E=s.props[d].filter(function(R){var O=y$e(s,n);return O(R,n)}),N=s.props[d].indexOf(E[E.length-1]),I=_===N;return w&&I}),v=o.indexOf(f[f.length-1]);return v}var E$e=Math.ceil,w$e=Math.max;function S$e(e,n,s,o){for(var d=-1,h=w$e(E$e((n-e)/(s||1)),0),f=Array(h);h--;)f[o?h:++d]=e,e+=s;return f}var T$e=S$e,N$e=yee,AY=1/0,C$e=17976931348623157e292;function R$e(e){if(!e)return e===0?e:0;if(e=N$e(e),e===AY||e===-AY){var n=e<0?-1:1;return n*C$e}return e===e?e:0}var Bte=R$e,A$e=T$e,I$e=qT,MO=Bte;function O$e(e){return function(n,s,o){return o&&typeof o!="number"&&I$e(n,s,o)&&(s=o=void 0),n=MO(n),s===void 0?(s=n,n=0):s=MO(s),o=o===void 0?n<s?1:-1:MO(o),A$e(n,s,o,e)}}var P$e=O$e,k$e=P$e,j$e=k$e(),D$e=j$e;const US=ur(D$e);function zy(e){"@babel/helpers - typeof";return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},zy(e)}function IY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function OY(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?IY(Object(s),!0).forEach(function(o){Gte(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):IY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function Gte(e,n,s){return n=L$e(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function L$e(e){var n=M$e(e,"string");return zy(n)=="symbol"?n:n+""}function M$e(e,n){if(zy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(zy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var U$e=["Webkit","Moz","O","ms"],F$e=function(n,s){var o=n.replace(/(\w)/,function(h){return h.toUpperCase()}),d=U$e.reduce(function(h,f){return OY(OY({},h),{},Gte({},f+o,s))},{});return d[n]=s,d};function $f(e){"@babel/helpers - typeof";return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$f(e)}function FS(){return FS=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},FS.apply(this,arguments)}function PY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function UO(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?PY(Object(s),!0).forEach(function(o){Na(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):PY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function V$e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function kY(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,$te(o.key),o)}}function B$e(e,n,s){return n&&kY(e.prototype,n),s&&kY(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function G$e(e,n,s){return n=VS(n),W$e(e,Wte()?Reflect.construct(n,s||[],VS(e).constructor):n.apply(e,s))}function W$e(e,n){if(n&&($f(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $$e(e)}function $$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wte=function(){return!!e})()}function VS(e){return VS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},VS(e)}function z$e(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&mk(e,n)}function mk(e,n){return mk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},mk(e,n)}function Na(e,n,s){return n=$te(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function $te(e){var n=H$e(e,"string");return $f(n)=="symbol"?n:n+""}function H$e(e,n){if($f(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if($f(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var K$e=function(n){var s=n.data,o=n.startIndex,d=n.endIndex,h=n.x,f=n.width,v=n.travellerWidth;if(!s||!s.length)return{};var b=s.length,_=zv().domain(US(0,b)).range([h,h+f-v]),w=_.domain().map(function(E){return _(E)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:_(o),endX:_(d),scale:_,scaleValues:w}},jY=function(n){return n.changedTouches&&!!n.changedTouches.length},zf=function(e){function n(s){var o;return V$e(this,n),o=G$e(this,n,[s]),Na(o,"handleDrag",function(d){o.leaveTimer&&(clearTimeout(o.leaveTimer),o.leaveTimer=null),o.state.isTravellerMoving?o.handleTravellerMove(d):o.state.isSlideMoving&&o.handleSlideDrag(d)}),Na(o,"handleTouchMove",function(d){d.changedTouches!=null&&d.changedTouches.length>0&&o.handleDrag(d.changedTouches[0])}),Na(o,"handleDragEnd",function(){o.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var d=o.props,h=d.endIndex,f=d.onDragEnd,v=d.startIndex;f==null||f({endIndex:h,startIndex:v})}),o.detachDragEndListener()}),Na(o,"handleLeaveWrapper",function(){(o.state.isTravellerMoving||o.state.isSlideMoving)&&(o.leaveTimer=window.setTimeout(o.handleDragEnd,o.props.leaveTimeOut))}),Na(o,"handleEnterSlideOrTraveller",function(){o.setState({isTextActive:!0})}),Na(o,"handleLeaveSlideOrTraveller",function(){o.setState({isTextActive:!1})}),Na(o,"handleSlideDragStart",function(d){var h=jY(d)?d.changedTouches[0]:d;o.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:h.pageX}),o.attachDragEndListener()}),o.travellerDragStartHandlers={startX:o.handleTravellerDragStart.bind(o,"startX"),endX:o.handleTravellerDragStart.bind(o,"endX")},o.state={},o}return z$e(n,e),B$e(n,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(o){var d=o.startX,h=o.endX,f=this.state.scaleValues,v=this.props,b=v.gap,_=v.data,w=_.length-1,E=Math.min(d,h),N=Math.max(d,h),I=n.getIndexInRange(f,E),R=n.getIndexInRange(f,N);return{startIndex:I-I%b,endIndex:R===w?w:R-R%b}}},{key:"getTextOfTick",value:function(o){var d=this.props,h=d.data,f=d.tickFormatter,v=d.dataKey,b=Ds(h[o],v,o);return mn(f)?f(b,o):b}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(o){var d=this.state,h=d.slideMoveStartX,f=d.startX,v=d.endX,b=this.props,_=b.x,w=b.width,E=b.travellerWidth,N=b.startIndex,I=b.endIndex,R=b.onChange,O=o.pageX-h;O>0?O=Math.min(O,_+w-E-v,_+w-E-f):O<0&&(O=Math.max(O,_-f,_-v));var P=this.getIndex({startX:f+O,endX:v+O});(P.startIndex!==N||P.endIndex!==I)&&R&&R(P),this.setState({startX:f+O,endX:v+O,slideMoveStartX:o.pageX})}},{key:"handleTravellerDragStart",value:function(o,d){var h=jY(d)?d.changedTouches[0]:d;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:o,brushMoveStartX:h.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(o){var d=this.state,h=d.brushMoveStartX,f=d.movingTravellerId,v=d.endX,b=d.startX,_=this.state[f],w=this.props,E=w.x,N=w.width,I=w.travellerWidth,R=w.onChange,O=w.gap,P=w.data,M={startX:this.state.startX,endX:this.state.endX},D=o.pageX-h;D>0?D=Math.min(D,E+N-I-_):D<0&&(D=Math.max(D,E-_)),M[f]=_+D;var U=this.getIndex(M),B=U.startIndex,G=U.endIndex,$=function(){var X=P.length-1;return f==="startX"&&(v>b?B%O===0:G%O===0)||v<b&&G===X||f==="endX"&&(v>b?G%O===0:B%O===0)||v>b&&G===X};this.setState(Na(Na({},f,_+D),"brushMoveStartX",o.pageX),function(){R&&$()&&R(U)})}},{key:"handleTravellerMoveKeyboard",value:function(o,d){var h=this,f=this.state,v=f.scaleValues,b=f.startX,_=f.endX,w=this.state[d],E=v.indexOf(w);if(E!==-1){var N=E+o;if(!(N===-1||N>=v.length)){var I=v[N];d==="startX"&&I>=_||d==="endX"&&I<=b||this.setState(Na({},d,I),function(){h.props.onChange(h.getIndex({startX:h.state.startX,endX:h.state.endX}))})}}}},{key:"renderBackground",value:function(){var o=this.props,d=o.x,h=o.y,f=o.width,v=o.height,b=o.fill,_=o.stroke;return ye.createElement("rect",{stroke:_,fill:b,x:d,y:h,width:f,height:v})}},{key:"renderPanorama",value:function(){var o=this.props,d=o.x,h=o.y,f=o.width,v=o.height,b=o.data,_=o.children,w=o.padding,E=z.Children.only(_);return E?ye.cloneElement(E,{x:d,y:h,width:f,height:v,margin:w,compact:!0,data:b}):null}},{key:"renderTravellerLayer",value:function(o,d){var h,f,v=this,b=this.props,_=b.y,w=b.travellerWidth,E=b.height,N=b.traveller,I=b.ariaLabel,R=b.data,O=b.startIndex,P=b.endIndex,M=Math.max(o,this.props.x),D=UO(UO({},bn(this.props,!1)),{},{x:M,y:_,width:w,height:E}),U=I||"Min value: ".concat((h=R[O])===null||h===void 0?void 0:h.name,", Max value: ").concat((f=R[P])===null||f===void 0?void 0:f.name);return ye.createElement(xr,{tabIndex:0,role:"slider","aria-label":U,"aria-valuenow":o,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[d],onTouchStart:this.travellerDragStartHandlers[d],onKeyDown:function(G){["ArrowLeft","ArrowRight"].includes(G.key)&&(G.preventDefault(),G.stopPropagation(),v.handleTravellerMoveKeyboard(G.key==="ArrowRight"?1:-1,d))},onFocus:function(){v.setState({isTravellerFocused:!0})},onBlur:function(){v.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},n.renderTraveller(N,D))}},{key:"renderSlide",value:function(o,d){var h=this.props,f=h.y,v=h.height,b=h.stroke,_=h.travellerWidth,w=Math.min(o,d)+_,E=Math.max(Math.abs(d-o)-_,0);return ye.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:b,fillOpacity:.2,x:w,y:f,width:E,height:v})}},{key:"renderText",value:function(){var o=this.props,d=o.startIndex,h=o.endIndex,f=o.y,v=o.height,b=o.travellerWidth,_=o.stroke,w=this.state,E=w.startX,N=w.endX,I=5,R={pointerEvents:"none",fill:_};return ye.createElement(xr,{className:"recharts-brush-texts"},ye.createElement(mS,FS({textAnchor:"end",verticalAnchor:"middle",x:Math.min(E,N)-I,y:f+v/2},R),this.getTextOfTick(d)),ye.createElement(mS,FS({textAnchor:"start",verticalAnchor:"middle",x:Math.max(E,N)+b+I,y:f+v/2},R),this.getTextOfTick(h)))}},{key:"render",value:function(){var o=this.props,d=o.data,h=o.className,f=o.children,v=o.x,b=o.y,_=o.width,w=o.height,E=o.alwaysShowText,N=this.state,I=N.startX,R=N.endX,O=N.isTextActive,P=N.isSlideMoving,M=N.isTravellerMoving,D=N.isTravellerFocused;if(!d||!d.length||!pt(v)||!pt(b)||!pt(_)||!pt(w)||_<=0||w<=0)return null;var U=In("recharts-brush",h),B=ye.Children.count(f)===1,G=F$e("userSelect","none");return ye.createElement(xr,{className:U,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:G},this.renderBackground(),B&&this.renderPanorama(),this.renderSlide(I,R),this.renderTravellerLayer(I,"startX"),this.renderTravellerLayer(R,"endX"),(O||P||M||D||E)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(o){var d=o.x,h=o.y,f=o.width,v=o.height,b=o.stroke,_=Math.floor(h+v/2)-1;return ye.createElement(ye.Fragment,null,ye.createElement("rect",{x:d,y:h,width:f,height:v,fill:b,stroke:"none"}),ye.createElement("line",{x1:d+1,y1:_,x2:d+f-1,y2:_,fill:"none",stroke:"#fff"}),ye.createElement("line",{x1:d+1,y1:_+2,x2:d+f-1,y2:_+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(o,d){var h;return ye.isValidElement(o)?h=ye.cloneElement(o,d):mn(o)?h=o(d):h=n.renderDefaultTraveller(d),h}},{key:"getDerivedStateFromProps",value:function(o,d){var h=o.data,f=o.width,v=o.x,b=o.travellerWidth,_=o.updateId,w=o.startIndex,E=o.endIndex;if(h!==d.prevData||_!==d.prevUpdateId)return UO({prevData:h,prevTravellerWidth:b,prevUpdateId:_,prevX:v,prevWidth:f},h&&h.length?K$e({data:h,width:f,x:v,travellerWidth:b,startIndex:w,endIndex:E}):{scale:null,scaleValues:null});if(d.scale&&(f!==d.prevWidth||v!==d.prevX||b!==d.prevTravellerWidth)){d.scale.range([v,v+f-b]);var N=d.scale.domain().map(function(I){return d.scale(I)});return{prevData:h,prevTravellerWidth:b,prevUpdateId:_,prevX:v,prevWidth:f,startX:d.scale(o.startIndex),endX:d.scale(o.endIndex),scaleValues:N}}return null}},{key:"getIndexInRange",value:function(o,d){for(var h=o.length,f=0,v=h-1;v-f>1;){var b=Math.floor((f+v)/2);o[b]>d?v=b:f=b}return d>=o[v]?v:f}}])}(z.PureComponent);Na(zf,"displayName","Brush");Na(zf,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Y$e=bD;function q$e(e,n){var s;return Y$e(e,function(o,d,h){return s=n(o,d,h),!s}),!!s}var X$e=q$e,J$e=zZ,Q$e=Eu,Z$e=X$e,eze=ua,tze=qT;function nze(e,n,s){var o=eze(e)?J$e:Z$e;return s&&tze(e,n,s)&&(n=void 0),o(e,Q$e(n))}var rze=nze;const ize=ur(rze);var el=function(n,s){var o=n.alwaysShow,d=n.ifOverflow;return o&&(d="extendDomain"),d===s},DY=pee;function sze(e,n,s){n=="__proto__"&&DY?DY(e,n,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[n]=s}var aze=sze,oze=aze,cze=uee,lze=Eu;function dze(e,n){var s={};return n=lze(n),cze(e,function(o,d,h){oze(s,d,n(o,d,h))}),s}var uze=dze;const hze=ur(uze);function pze(e,n){for(var s=-1,o=e==null?0:e.length;++s<o;)if(!n(e[s],s,e))return!1;return!0}var mze=pze,fze=bD;function gze(e,n){var s=!0;return fze(e,function(o,d,h){return s=!!n(o,d,h),s}),s}var vze=gze,yze=mze,bze=vze,xze=Eu,_ze=ua,Eze=qT;function wze(e,n,s){var o=_ze(e)?yze:bze;return s&&Eze(e,n,s)&&(n=void 0),o(e,xze(n))}var Sze=wze;const zte=ur(Sze);var Tze=["x","y"];function Hy(e){"@babel/helpers - typeof";return Hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Hy(e)}function fk(){return fk=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},fk.apply(this,arguments)}function LY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function Nv(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?LY(Object(s),!0).forEach(function(o){Nze(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):LY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function Nze(e,n,s){return n=Cze(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function Cze(e){var n=Rze(e,"string");return Hy(n)=="symbol"?n:n+""}function Rze(e,n){if(Hy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Hy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Aze(e,n){if(e==null)return{};var s=Ize(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function Ize(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function Oze(e,n){var s=e.x,o=e.y,d=Aze(e,Tze),h="".concat(s),f=parseInt(h,10),v="".concat(o),b=parseInt(v,10),_="".concat(n.height||d.height),w=parseInt(_,10),E="".concat(n.width||d.width),N=parseInt(E,10);return Nv(Nv(Nv(Nv(Nv({},n),d),f?{x:f}:{}),b?{y:b}:{}),{},{height:w,width:N,name:n.name,radius:n.radius})}function MY(e){return ye.createElement(m$e,fk({shapeType:"rectangle",propTransformer:Oze,activeClassName:"recharts-active-bar"},e))}var Pze=function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(o,d){if(typeof n=="number")return n;var h=pt(o)||qIe(o);return h?n(o,d):(h||rp(),s)}},kze=["value","background"],Hte;function Hf(e){"@babel/helpers - typeof";return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Hf(e)}function jze(e,n){if(e==null)return{};var s=Dze(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function Dze(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function BS(){return BS=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},BS.apply(this,arguments)}function UY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function fi(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?UY(Object(s),!0).forEach(function(o){Qd(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):UY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function Lze(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function FY(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Yte(o.key),o)}}function Mze(e,n,s){return n&&FY(e.prototype,n),s&&FY(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uze(e,n,s){return n=GS(n),Fze(e,Kte()?Reflect.construct(n,s||[],GS(e).constructor):n.apply(e,s))}function Fze(e,n){if(n&&(Hf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vze(e)}function Vze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kte=function(){return!!e})()}function GS(e){return GS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},GS(e)}function Bze(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&gk(e,n)}function gk(e,n){return gk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},gk(e,n)}function Qd(e,n,s){return n=Yte(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function Yte(e){var n=Gze(e,"string");return Hf(n)=="symbol"?n:n+""}function Gze(e,n){if(Hf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Hf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var yb=function(e){function n(){var s;Lze(this,n);for(var o=arguments.length,d=new Array(o),h=0;h<o;h++)d[h]=arguments[h];return s=Uze(this,n,[].concat(d)),Qd(s,"state",{isAnimationFinished:!1}),Qd(s,"id",Eg("recharts-bar-")),Qd(s,"handleAnimationEnd",function(){var f=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),f&&f()}),Qd(s,"handleAnimationStart",function(){var f=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),f&&f()}),s}return Bze(n,e),Mze(n,[{key:"renderRectanglesStatically",value:function(o){var d=this,h=this.props,f=h.shape,v=h.dataKey,b=h.activeIndex,_=h.activeBar,w=bn(this.props,!1);return o&&o.map(function(E,N){var I=N===b,R=I?_:f,O=fi(fi(fi({},w),E),{},{isActive:I,option:R,index:N,dataKey:v,onAnimationStart:d.handleAnimationStart,onAnimationEnd:d.handleAnimationEnd});return ye.createElement(xr,BS({className:"recharts-bar-rectangle"},eS(d.props,E,N),{key:"rectangle-".concat(E==null?void 0:E.x,"-").concat(E==null?void 0:E.y,"-").concat(E==null?void 0:E.value,"-").concat(N)}),ye.createElement(MY,O))})}},{key:"renderRectanglesWithAnimation",value:function(){var o=this,d=this.props,h=d.data,f=d.layout,v=d.isAnimationActive,b=d.animationBegin,_=d.animationDuration,w=d.animationEasing,E=d.animationId,N=this.state.prevData;return ye.createElement(rl,{begin:b,duration:_,isActive:v,easing:w,from:{t:0},to:{t:1},key:"bar-".concat(E),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(I){var R=I.t,O=h.map(function(P,M){var D=N&&N[M];if(D){var U=ts(D.x,P.x),B=ts(D.y,P.y),G=ts(D.width,P.width),$=ts(D.height,P.height);return fi(fi({},P),{},{x:U(R),y:B(R),width:G(R),height:$(R)})}if(f==="horizontal"){var q=ts(0,P.height),X=q(R);return fi(fi({},P),{},{y:P.y+P.height-X,height:X})}var ee=ts(0,P.width),ce=ee(R);return fi(fi({},P),{},{width:ce})});return ye.createElement(xr,null,o.renderRectanglesStatically(O))})}},{key:"renderRectangles",value:function(){var o=this.props,d=o.data,h=o.isAnimationActive,f=this.state.prevData;return h&&d&&d.length&&(!f||!Bf(f,d))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(d)}},{key:"renderBackground",value:function(){var o=this,d=this.props,h=d.data,f=d.dataKey,v=d.activeIndex,b=bn(this.props.background,!1);return h.map(function(_,w){_.value;var E=_.background,N=jze(_,kze);if(!E)return null;var I=fi(fi(fi(fi(fi({},N),{},{fill:"#eee"},E),b),eS(o.props,_,w)),{},{onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd,dataKey:f,index:w,className:"recharts-bar-background-rectangle"});return ye.createElement(MY,BS({key:"background-bar-".concat(w),option:o.props.background,isActive:w===v},I))})}},{key:"renderErrorBar",value:function(o,d){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var h=this.props,f=h.data,v=h.xAxis,b=h.yAxis,_=h.layout,w=h.children,E=Eo(w,vb);if(!E)return null;var N=_==="vertical"?f[0].height/2:f[0].width/2,I=function(P,M){var D=Array.isArray(P.value)?P.value[1]:P.value;return{x:P.x,y:P.y,value:D,errorVal:Ds(P,M)}},R={clipPath:o?"url(#clipPath-".concat(d,")"):null};return ye.createElement(xr,R,E.map(function(O){return ye.cloneElement(O,{key:"error-bar-".concat(d,"-").concat(O.props.dataKey),data:f,xAxis:v,yAxis:b,layout:_,offset:N,dataPointFormatter:I})}))}},{key:"render",value:function(){var o=this.props,d=o.hide,h=o.data,f=o.className,v=o.xAxis,b=o.yAxis,_=o.left,w=o.top,E=o.width,N=o.height,I=o.isAnimationActive,R=o.background,O=o.id;if(d||!h||!h.length)return null;var P=this.state.isAnimationFinished,M=In("recharts-bar",f),D=v&&v.allowDataOverflow,U=b&&b.allowDataOverflow,B=D||U,G=En(O)?this.id:O;return ye.createElement(xr,{className:M},D||U?ye.createElement("defs",null,ye.createElement("clipPath",{id:"clipPath-".concat(G)},ye.createElement("rect",{x:D?_:_-E/2,y:U?w:w-N/2,width:D?E:E*2,height:U?N:N*2}))):null,ye.createElement(xr,{className:"recharts-bar-rectangles",clipPath:B?"url(#clipPath-".concat(G,")"):null},R?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(B,G),(!I||P)&&Bl.renderCallByParent(this.props,h))}}],[{key:"getDerivedStateFromProps",value:function(o,d){return o.animationId!==d.prevAnimationId?{prevAnimationId:o.animationId,curData:o.data,prevData:d.curData}:o.data!==d.curData?{curData:o.data}:null}}])}(z.PureComponent);Hte=yb;Qd(yb,"displayName","Bar");Qd(yb,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!lp.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Qd(yb,"getComposedData",function(e){var n=e.props,s=e.item,o=e.barPosition,d=e.bandSize,h=e.xAxis,f=e.yAxis,v=e.xAxisTicks,b=e.yAxisTicks,_=e.stackedData,w=e.dataStartIndex,E=e.displayedData,N=e.offset,I=vBe(o,s);if(!I)return null;var R=n.layout,O=s.type.defaultProps,P=O!==void 0?fi(fi({},O),s.props):s.props,M=P.dataKey,D=P.children,U=P.minPointSize,B=R==="horizontal"?f:h,G=_?B.scale.domain():null,$=TBe({numericAxis:B}),q=Eo(D,xee),X=E.map(function(ee,ce){var Q,ae,ve,le,fe,re;_?Q=yBe(_[w+ce],G):(Q=Ds(ee,M),Array.isArray(Q)||(Q=[$,Q]));var he=Pze(U,Hte.defaultProps.minPointSize)(Q[1],ce);if(R==="horizontal"){var J,ue=[f.scale(Q[0]),f.scale(Q[1])],Ee=ue[0],Fe=ue[1];ae=UK({axis:h,ticks:v,bandSize:d,offset:I.offset,entry:ee,index:ce}),ve=(J=Fe??Ee)!==null&&J!==void 0?J:void 0,le=I.size;var ke=Ee-Fe;if(fe=Number.isNaN(ke)?0:ke,re={x:ae,y:f.y,width:le,height:f.height},Math.abs(he)>0&&Math.abs(fe)<Math.abs(he)){var Ge=dc(fe||he)*(Math.abs(he)-Math.abs(fe));ve-=Ge,fe+=Ge}}else{var De=[h.scale(Q[0]),h.scale(Q[1])],Pe=De[0],Ve=De[1];if(ae=Pe,ve=UK({axis:f,ticks:b,bandSize:d,offset:I.offset,entry:ee,index:ce}),le=Ve-Pe,fe=I.size,re={x:h.x,y:ve,width:h.width,height:fe},Math.abs(he)>0&&Math.abs(le)<Math.abs(he)){var it=dc(le||he)*(Math.abs(he)-Math.abs(le));le+=it}}return fi(fi(fi({},ee),{},{x:ae,y:ve,width:le,height:fe,value:_?Q:Q[1],payload:ee,background:re},q&&q[ce]&&q[ce].props),{},{tooltipPayload:[Nte(s,ee)],tooltipPosition:{x:ae+le/2,y:ve+fe/2}})});return fi({data:X,layout:R},N)});function Ky(e){"@babel/helpers - typeof";return Ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ky(e)}function Wze(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function VY(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,qte(o.key),o)}}function $ze(e,n,s){return n&&VY(e.prototype,n),s&&VY(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function BY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function ac(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?BY(Object(s),!0).forEach(function(o){cN(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):BY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function cN(e,n,s){return n=qte(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function qte(e){var n=zze(e,"string");return Ky(n)=="symbol"?n:n+""}function zze(e,n){if(Ky(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Ky(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var Xte=function(n,s,o,d,h){var f=n.width,v=n.height,b=n.layout,_=n.children,w=Object.keys(s),E={left:o.left,leftMirror:o.left,right:f-o.right,rightMirror:f-o.right,top:o.top,topMirror:o.top,bottom:v-o.bottom,bottomMirror:v-o.bottom},N=!!Ra(_,yb);return w.reduce(function(I,R){var O=s[R],P=O.orientation,M=O.domain,D=O.padding,U=D===void 0?{}:D,B=O.mirror,G=O.reversed,$="".concat(P).concat(B?"Mirror":""),q,X,ee,ce,Q;if(O.type==="number"&&(O.padding==="gap"||O.padding==="no-gap")){var ae=M[1]-M[0],ve=1/0,le=O.categoricalDomain.sort(QIe);if(le.forEach(function(De,Pe){Pe>0&&(ve=Math.min((De||0)-(le[Pe-1]||0),ve))}),Number.isFinite(ve)){var fe=ve/ae,re=O.layout==="vertical"?o.height:o.width;if(O.padding==="gap"&&(q=fe*re/2),O.padding==="no-gap"){var he=tp(n.barCategoryGap,fe*re),J=fe*re/2;q=J-he-(J-he)/re*he}}}d==="xAxis"?X=[o.left+(U.left||0)+(q||0),o.left+o.width-(U.right||0)-(q||0)]:d==="yAxis"?X=b==="horizontal"?[o.top+o.height-(U.bottom||0),o.top+(U.top||0)]:[o.top+(U.top||0)+(q||0),o.top+o.height-(U.bottom||0)-(q||0)]:X=O.range,G&&(X=[X[1],X[0]]);var ue=fBe(O,h,N),Ee=ue.scale,Fe=ue.realScaleType;Ee.domain(M).range(X),gBe(Ee);var ke=SBe(Ee,ac(ac({},O),{},{realScaleType:Fe}));d==="xAxis"?(Q=P==="top"&&!B||P==="bottom"&&B,ee=o.left,ce=E[$]-Q*O.height):d==="yAxis"&&(Q=P==="left"&&!B||P==="right"&&B,ee=E[$]-Q*O.width,ce=o.top);var Ge=ac(ac(ac({},O),ke),{},{realScaleType:Fe,x:ee,y:ce,scale:Ee,width:d==="xAxis"?o.width:O.width,height:d==="yAxis"?o.height:O.height});return Ge.bandSize=AS(Ge,ke),!O.hide&&d==="xAxis"?E[$]+=(Q?-1:1)*Ge.height:O.hide||(E[$]+=(Q?-1:1)*Ge.width),ac(ac({},I),{},cN({},R,Ge))},{})},Jte=function(n,s){var o=n.x,d=n.y,h=s.x,f=s.y;return{x:Math.min(o,h),y:Math.min(d,f),width:Math.abs(h-o),height:Math.abs(f-d)}},Hze=function(n){var s=n.x1,o=n.y1,d=n.x2,h=n.y2;return Jte({x:s,y:o},{x:d,y:h})},Qte=function(){function e(n){Wze(this,e),this.scale=n}return $ze(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=o.bandAware,h=o.position;if(s!==void 0){if(h)switch(h){case"start":return this.scale(s);case"middle":{var f=this.bandwidth?this.bandwidth()/2:0;return this.scale(s)+f}case"end":{var v=this.bandwidth?this.bandwidth():0;return this.scale(s)+v}default:return this.scale(s)}if(d){var b=this.bandwidth?this.bandwidth()/2:0;return this.scale(s)+b}return this.scale(s)}}},{key:"isInRange",value:function(s){var o=this.range(),d=o[0],h=o[o.length-1];return d<=h?s>=d&&s<=h:s>=h&&s<=d}}],[{key:"create",value:function(s){return new e(s)}}])}();cN(Qte,"EPS",1e-4);var YD=function(n){var s=Object.keys(n).reduce(function(o,d){return ac(ac({},o),{},cN({},d,Qte.create(n[d])))},{});return ac(ac({},s),{},{apply:function(d){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=h.bandAware,v=h.position;return hze(d,function(b,_){return s[_].apply(b,{bandAware:f,position:v})})},isInRange:function(d){return zte(d,function(h,f){return s[f].isInRange(h)})}})};function Kze(e){return(e%180+180)%180}var Yze=function(n){var s=n.width,o=n.height,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=Kze(d),f=h*Math.PI/180,v=Math.atan(o/s),b=f>v&&f<Math.PI-v?o/Math.sin(f):s/Math.cos(f);return Math.abs(b)},qze=Eu,Xze=hb,Jze=KT;function Qze(e){return function(n,s,o){var d=Object(n);if(!Xze(n)){var h=qze(s);n=Jze(n),s=function(v){return h(d[v],v,d)}}var f=e(n,s,o);return f>-1?d[h?n[f]:f]:void 0}}var Zze=Qze,e7e=Bte;function t7e(e){var n=e7e(e),s=n%1;return n===n?s?n-s:n:0}var n7e=t7e,r7e=see,i7e=Eu,s7e=n7e,a7e=Math.max;function o7e(e,n,s){var o=e==null?0:e.length;if(!o)return-1;var d=s==null?0:s7e(s);return d<0&&(d=a7e(o+d,0)),r7e(e,i7e(n),d)}var c7e=o7e,l7e=Zze,d7e=c7e,u7e=l7e(d7e),h7e=u7e;const p7e=ur(h7e);var m7e=tIe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),qD=z.createContext(void 0),XD=z.createContext(void 0),Zte=z.createContext(void 0),ene=z.createContext({}),tne=z.createContext(void 0),nne=z.createContext(0),rne=z.createContext(0),GY=function(n){var s=n.state,o=s.xAxisMap,d=s.yAxisMap,h=s.offset,f=n.clipPathId,v=n.children,b=n.width,_=n.height,w=m7e(h);return ye.createElement(qD.Provider,{value:o},ye.createElement(XD.Provider,{value:d},ye.createElement(ene.Provider,{value:h},ye.createElement(Zte.Provider,{value:w},ye.createElement(tne.Provider,{value:f},ye.createElement(nne.Provider,{value:_},ye.createElement(rne.Provider,{value:b},v)))))))},f7e=function(){return z.useContext(tne)},ine=function(n){var s=z.useContext(qD);s==null&&rp();var o=s[n];return o==null&&rp(),o},g7e=function(){var n=z.useContext(qD);return zd(n)},v7e=function(){var n=z.useContext(XD),s=p7e(n,function(o){return zte(o.domain,Number.isFinite)});return s||zd(n)},sne=function(n){var s=z.useContext(XD);s==null&&rp();var o=s[n];return o==null&&rp(),o},y7e=function(){var n=z.useContext(Zte);return n},b7e=function(){return z.useContext(ene)},JD=function(){return z.useContext(rne)},QD=function(){return z.useContext(nne)};function Kf(e){"@babel/helpers - typeof";return Kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Kf(e)}function x7e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _7e(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,one(o.key),o)}}function E7e(e,n,s){return n&&_7e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function w7e(e,n,s){return n=WS(n),S7e(e,ane()?Reflect.construct(n,s||[],WS(e).constructor):n.apply(e,s))}function S7e(e,n){if(n&&(Kf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T7e(e)}function T7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ane(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ane=function(){return!!e})()}function WS(e){return WS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},WS(e)}function N7e(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&vk(e,n)}function vk(e,n){return vk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},vk(e,n)}function WY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function $Y(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?WY(Object(s),!0).forEach(function(o){ZD(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):WY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function ZD(e,n,s){return n=one(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function one(e){var n=C7e(e,"string");return Kf(n)=="symbol"?n:n+""}function C7e(e,n){if(Kf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Kf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function R7e(e,n){return P7e(e)||O7e(e,n)||I7e(e,n)||A7e()}function A7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I7e(e,n){if(e){if(typeof e=="string")return zY(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return zY(e,n)}}function zY(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function O7e(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n!==0)for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function P7e(e){if(Array.isArray(e))return e}function yk(){return yk=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},yk.apply(this,arguments)}var k7e=function(n,s){var o;return ye.isValidElement(n)?o=ye.cloneElement(n,s):mn(n)?o=n(s):o=ye.createElement("line",yk({},s,{className:"recharts-reference-line-line"})),o},j7e=function(n,s,o,d,h,f,v,b,_){var w=h.x,E=h.y,N=h.width,I=h.height;if(o){var R=_.y,O=n.y.apply(R,{position:f});if(el(_,"discard")&&!n.y.isInRange(O))return null;var P=[{x:w+N,y:O},{x:w,y:O}];return b==="left"?P.reverse():P}if(s){var M=_.x,D=n.x.apply(M,{position:f});if(el(_,"discard")&&!n.x.isInRange(D))return null;var U=[{x:D,y:E+I},{x:D,y:E}];return v==="top"?U.reverse():U}if(d){var B=_.segment,G=B.map(function($){return n.apply($,{position:f})});return el(_,"discard")&&ize(G,function($){return!n.isInRange($)})?null:G}return null};function D7e(e){var n=e.x,s=e.y,o=e.segment,d=e.xAxisId,h=e.yAxisId,f=e.shape,v=e.className,b=e.alwaysShow,_=f7e(),w=ine(d),E=sne(h),N=y7e();if(!_||!N)return null;Fl(b===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var I=YD({x:w.scale,y:E.scale}),R=Ri(n),O=Ri(s),P=o&&o.length===2,M=j7e(I,R,O,P,N,e.position,w.orientation,E.orientation,e);if(!M)return null;var D=R7e(M,2),U=D[0],B=U.x,G=U.y,$=D[1],q=$.x,X=$.y,ee=el(e,"hidden")?"url(#".concat(_,")"):void 0,ce=$Y($Y({clipPath:ee},bn(e,!0)),{},{x1:B,y1:G,x2:q,y2:X});return ye.createElement(xr,{className:In("recharts-reference-line",v)},k7e(f,ce),bs.renderCallByParent(e,Hze({x1:B,y1:G,x2:q,y2:X})))}var eL=function(e){function n(){return x7e(this,n),w7e(this,n,arguments)}return N7e(n,e),E7e(n,[{key:"render",value:function(){return ye.createElement(D7e,this.props)}}])}(ye.Component);ZD(eL,"displayName","ReferenceLine");ZD(eL,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function bk(){return bk=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},bk.apply(this,arguments)}function Yf(e){"@babel/helpers - typeof";return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Yf(e)}function HY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function KY(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?HY(Object(s),!0).forEach(function(o){lN(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):HY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function L7e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function M7e(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,lne(o.key),o)}}function U7e(e,n,s){return n&&M7e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function F7e(e,n,s){return n=$S(n),V7e(e,cne()?Reflect.construct(n,s||[],$S(e).constructor):n.apply(e,s))}function V7e(e,n){if(n&&(Yf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B7e(e)}function B7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cne=function(){return!!e})()}function $S(e){return $S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},$S(e)}function G7e(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&xk(e,n)}function xk(e,n){return xk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},xk(e,n)}function lN(e,n,s){return n=lne(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function lne(e){var n=W7e(e,"string");return Yf(n)=="symbol"?n:n+""}function W7e(e,n){if(Yf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Yf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var $7e=function(n){var s=n.x,o=n.y,d=n.xAxis,h=n.yAxis,f=YD({x:d.scale,y:h.scale}),v=f.apply({x:s,y:o},{bandAware:!0});return el(n,"discard")&&!f.isInRange(v)?null:v},dN=function(e){function n(){return L7e(this,n),F7e(this,n,arguments)}return G7e(n,e),U7e(n,[{key:"render",value:function(){var o=this.props,d=o.x,h=o.y,f=o.r,v=o.alwaysShow,b=o.clipPathId,_=Ri(d),w=Ri(h);if(Fl(v===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!_||!w)return null;var E=$7e(this.props);if(!E)return null;var N=E.x,I=E.y,R=this.props,O=R.shape,P=R.className,M=el(this.props,"hidden")?"url(#".concat(b,")"):void 0,D=KY(KY({clipPath:M},bn(this.props,!0)),{},{cx:N,cy:I});return ye.createElement(xr,{className:In("recharts-reference-dot",P)},n.renderDot(O,D),bs.renderCallByParent(this.props,{x:N-f,y:I-f,width:2*f,height:2*f}))}}])}(ye.Component);lN(dN,"displayName","ReferenceDot");lN(dN,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});lN(dN,"renderDot",function(e,n){var s;return ye.isValidElement(e)?s=ye.cloneElement(e,n):mn(e)?s=e(n):s=ye.createElement(sN,bk({},n,{cx:n.cx,cy:n.cy,className:"recharts-reference-dot-dot"})),s});function _k(){return _k=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},_k.apply(this,arguments)}function qf(e){"@babel/helpers - typeof";return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},qf(e)}function YY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function qY(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?YY(Object(s),!0).forEach(function(o){uN(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):YY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function z7e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function H7e(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,une(o.key),o)}}function K7e(e,n,s){return n&&H7e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y7e(e,n,s){return n=zS(n),q7e(e,dne()?Reflect.construct(n,s||[],zS(e).constructor):n.apply(e,s))}function q7e(e,n){if(n&&(qf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return X7e(e)}function X7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dne=function(){return!!e})()}function zS(e){return zS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},zS(e)}function J7e(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Ek(e,n)}function Ek(e,n){return Ek=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},Ek(e,n)}function uN(e,n,s){return n=une(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function une(e){var n=Q7e(e,"string");return qf(n)=="symbol"?n:n+""}function Q7e(e,n){if(qf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(qf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Z7e=function(n,s,o,d,h){var f=h.x1,v=h.x2,b=h.y1,_=h.y2,w=h.xAxis,E=h.yAxis;if(!w||!E)return null;var N=YD({x:w.scale,y:E.scale}),I={x:n?N.x.apply(f,{position:"start"}):N.x.rangeMin,y:o?N.y.apply(b,{position:"start"}):N.y.rangeMin},R={x:s?N.x.apply(v,{position:"end"}):N.x.rangeMax,y:d?N.y.apply(_,{position:"end"}):N.y.rangeMax};return el(h,"discard")&&(!N.isInRange(I)||!N.isInRange(R))?null:Jte(I,R)},hN=function(e){function n(){return z7e(this,n),Y7e(this,n,arguments)}return J7e(n,e),K7e(n,[{key:"render",value:function(){var o=this.props,d=o.x1,h=o.x2,f=o.y1,v=o.y2,b=o.className,_=o.alwaysShow,w=o.clipPathId;Fl(_===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var E=Ri(d),N=Ri(h),I=Ri(f),R=Ri(v),O=this.props.shape;if(!E&&!N&&!I&&!R&&!O)return null;var P=Z7e(E,N,I,R,this.props);if(!P&&!O)return null;var M=el(this.props,"hidden")?"url(#".concat(w,")"):void 0;return ye.createElement(xr,{className:In("recharts-reference-area",b)},n.renderRect(O,qY(qY({clipPath:M},bn(this.props,!0)),P)),bs.renderCallByParent(this.props,P))}}])}(ye.Component);uN(hN,"displayName","ReferenceArea");uN(hN,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});uN(hN,"renderRect",function(e,n){var s;return ye.isValidElement(e)?s=ye.cloneElement(e,n):mn(e)?s=e(n):s=ye.createElement(KD,_k({},n,{className:"recharts-reference-area-rect"})),s});function hne(e,n,s){if(n<1)return[];if(n===1&&s===void 0)return e;for(var o=[],d=0;d<e.length;d+=n)o.push(e[d]);return o}function eHe(e,n,s){var o={width:e.width+n.width,height:e.height+n.height};return Yze(o,s)}function tHe(e,n,s){var o=s==="width",d=e.x,h=e.y,f=e.width,v=e.height;return n===1?{start:o?d:h,end:o?d+f:h+v}:{start:o?d+f:h+v,end:o?d:h}}function HS(e,n,s,o,d){if(e*n<e*o||e*n>e*d)return!1;var h=s();return e*(n-e*h/2-o)>=0&&e*(n+e*h/2-d)<=0}function nHe(e,n){return hne(e,n+1)}function rHe(e,n,s,o,d){for(var h=(o||[]).slice(),f=n.start,v=n.end,b=0,_=1,w=f,E=function(){var R=o==null?void 0:o[b];if(R===void 0)return{v:hne(o,_)};var O=b,P,M=function(){return P===void 0&&(P=s(R,O)),P},D=R.coordinate,U=b===0||HS(e,D,M,w,v);U||(b=0,w=f,_+=1),U&&(w=D+e*(M()/2+d),b+=_)},N;_<=h.length;)if(N=E(),N)return N.v;return[]}function Yy(e){"@babel/helpers - typeof";return Yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Yy(e)}function XY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function vs(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?XY(Object(s),!0).forEach(function(o){iHe(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):XY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function iHe(e,n,s){return n=sHe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function sHe(e){var n=aHe(e,"string");return Yy(n)=="symbol"?n:n+""}function aHe(e,n){if(Yy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Yy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function oHe(e,n,s,o,d){for(var h=(o||[]).slice(),f=h.length,v=n.start,b=n.end,_=function(N){var I=h[N],R,O=function(){return R===void 0&&(R=s(I,N)),R};if(N===f-1){var P=e*(I.coordinate+e*O()/2-b);h[N]=I=vs(vs({},I),{},{tickCoord:P>0?I.coordinate-P*e:I.coordinate})}else h[N]=I=vs(vs({},I),{},{tickCoord:I.coordinate});var M=HS(e,I.tickCoord,O,v,b);M&&(b=I.tickCoord-e*(O()/2+d),h[N]=vs(vs({},I),{},{isShow:!0}))},w=f-1;w>=0;w--)_(w);return h}function cHe(e,n,s,o,d,h){var f=(o||[]).slice(),v=f.length,b=n.start,_=n.end;if(h){var w=o[v-1],E=s(w,v-1),N=e*(w.coordinate+e*E/2-_);f[v-1]=w=vs(vs({},w),{},{tickCoord:N>0?w.coordinate-N*e:w.coordinate});var I=HS(e,w.tickCoord,function(){return E},b,_);I&&(_=w.tickCoord-e*(E/2+d),f[v-1]=vs(vs({},w),{},{isShow:!0}))}for(var R=h?v-1:v,O=function(D){var U=f[D],B,G=function(){return B===void 0&&(B=s(U,D)),B};if(D===0){var $=e*(U.coordinate-e*G()/2-b);f[D]=U=vs(vs({},U),{},{tickCoord:$<0?U.coordinate-$*e:U.coordinate})}else f[D]=U=vs(vs({},U),{},{tickCoord:U.coordinate});var q=HS(e,U.tickCoord,G,b,_);q&&(b=U.tickCoord+e*(G()/2+d),f[D]=vs(vs({},U),{},{isShow:!0}))},P=0;P<R;P++)O(P);return f}function tL(e,n,s){var o=e.tick,d=e.ticks,h=e.viewBox,f=e.minTickGap,v=e.orientation,b=e.interval,_=e.tickFormatter,w=e.unit,E=e.angle;if(!d||!d.length||!o)return[];if(pt(b)||lp.isSsr)return nHe(d,typeof b=="number"&&pt(b)?b:0);var N=[],I=v==="top"||v==="bottom"?"width":"height",R=w&&I==="width"?$v(w,{fontSize:n,letterSpacing:s}):{width:0,height:0},O=function(U,B){var G=mn(_)?_(U.value,B):U.value;return I==="width"?eHe($v(G,{fontSize:n,letterSpacing:s}),R,E):$v(G,{fontSize:n,letterSpacing:s})[I]},P=d.length>=2?dc(d[1].coordinate-d[0].coordinate):1,M=tHe(h,P,I);return b==="equidistantPreserveStart"?rHe(P,M,O,d,f):(b==="preserveStart"||b==="preserveStartEnd"?N=cHe(P,M,O,d,f,b==="preserveStartEnd"):N=oHe(P,M,O,d,f),N.filter(function(D){return D.isShow}))}var lHe=["viewBox"],dHe=["viewBox"],uHe=["ticks"];function Xf(e){"@babel/helpers - typeof";return Xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Xf(e)}function of(){return of=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},of.apply(this,arguments)}function JY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function Ei(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?JY(Object(s),!0).forEach(function(o){nL(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):JY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function FO(e,n){if(e==null)return{};var s=hHe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function hHe(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function pHe(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function QY(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,mne(o.key),o)}}function mHe(e,n,s){return n&&QY(e.prototype,n),s&&QY(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function fHe(e,n,s){return n=KS(n),gHe(e,pne()?Reflect.construct(n,s||[],KS(e).constructor):n.apply(e,s))}function gHe(e,n){if(n&&(Xf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vHe(e)}function vHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pne=function(){return!!e})()}function KS(e){return KS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},KS(e)}function yHe(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&wk(e,n)}function wk(e,n){return wk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},wk(e,n)}function nL(e,n,s){return n=mne(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function mne(e){var n=bHe(e,"string");return Xf(n)=="symbol"?n:n+""}function bHe(e,n){if(Xf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Xf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ag=function(e){function n(s){var o;return pHe(this,n),o=fHe(this,n,[s]),o.state={fontSize:"",letterSpacing:""},o}return yHe(n,e),mHe(n,[{key:"shouldComponentUpdate",value:function(o,d){var h=o.viewBox,f=FO(o,lHe),v=this.props,b=v.viewBox,_=FO(v,dHe);return!gf(h,b)||!gf(f,_)||!gf(d,this.state)}},{key:"componentDidMount",value:function(){var o=this.layerReference;if(o){var d=o.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];d&&this.setState({fontSize:window.getComputedStyle(d).fontSize,letterSpacing:window.getComputedStyle(d).letterSpacing})}}},{key:"getTickLineCoord",value:function(o){var d=this.props,h=d.x,f=d.y,v=d.width,b=d.height,_=d.orientation,w=d.tickSize,E=d.mirror,N=d.tickMargin,I,R,O,P,M,D,U=E?-1:1,B=o.tickSize||w,G=pt(o.tickCoord)?o.tickCoord:o.coordinate;switch(_){case"top":I=R=o.coordinate,P=f+ +!E*b,O=P-U*B,D=O-U*N,M=G;break;case"left":O=P=o.coordinate,R=h+ +!E*v,I=R-U*B,M=I-U*N,D=G;break;case"right":O=P=o.coordinate,R=h+ +E*v,I=R+U*B,M=I+U*N,D=G;break;default:I=R=o.coordinate,P=f+ +E*b,O=P+U*B,D=O+U*N,M=G;break}return{line:{x1:I,y1:O,x2:R,y2:P},tick:{x:M,y:D}}}},{key:"getTickTextAnchor",value:function(){var o=this.props,d=o.orientation,h=o.mirror,f;switch(d){case"left":f=h?"start":"end";break;case"right":f=h?"end":"start";break;default:f="middle";break}return f}},{key:"getTickVerticalAnchor",value:function(){var o=this.props,d=o.orientation,h=o.mirror,f="end";switch(d){case"left":case"right":f="middle";break;case"top":f=h?"start":"end";break;default:f=h?"end":"start";break}return f}},{key:"renderAxisLine",value:function(){var o=this.props,d=o.x,h=o.y,f=o.width,v=o.height,b=o.orientation,_=o.mirror,w=o.axisLine,E=Ei(Ei(Ei({},bn(this.props,!1)),bn(w,!1)),{},{fill:"none"});if(b==="top"||b==="bottom"){var N=+(b==="top"&&!_||b==="bottom"&&_);E=Ei(Ei({},E),{},{x1:d,y1:h+N*v,x2:d+f,y2:h+N*v})}else{var I=+(b==="left"&&!_||b==="right"&&_);E=Ei(Ei({},E),{},{x1:d+I*f,y1:h,x2:d+I*f,y2:h+v})}return ye.createElement("line",of({},E,{className:In("recharts-cartesian-axis-line",_o(w,"className"))}))}},{key:"renderTicks",value:function(o,d,h){var f=this,v=this.props,b=v.tickLine,_=v.stroke,w=v.tick,E=v.tickFormatter,N=v.unit,I=tL(Ei(Ei({},this.props),{},{ticks:o}),d,h),R=this.getTickTextAnchor(),O=this.getTickVerticalAnchor(),P=bn(this.props,!1),M=bn(w,!1),D=Ei(Ei({},P),{},{fill:"none"},bn(b,!1)),U=I.map(function(B,G){var $=f.getTickLineCoord(B),q=$.line,X=$.tick,ee=Ei(Ei(Ei(Ei({textAnchor:R,verticalAnchor:O},P),{},{stroke:"none",fill:_},M),X),{},{index:G,payload:B,visibleTicksCount:I.length,tickFormatter:E});return ye.createElement(xr,of({className:"recharts-cartesian-axis-tick",key:"tick-".concat(B.value,"-").concat(B.coordinate,"-").concat(B.tickCoord)},eS(f.props,B,G)),b&&ye.createElement("line",of({},D,q,{className:In("recharts-cartesian-axis-tick-line",_o(b,"className"))})),w&&n.renderTickItem(w,ee,"".concat(mn(E)?E(B.value,G):B.value).concat(N||"")))});return ye.createElement("g",{className:"recharts-cartesian-axis-ticks"},U)}},{key:"render",value:function(){var o=this,d=this.props,h=d.axisLine,f=d.width,v=d.height,b=d.ticksGenerator,_=d.className,w=d.hide;if(w)return null;var E=this.props,N=E.ticks,I=FO(E,uHe),R=N;return mn(b)&&(R=N&&N.length>0?b(this.props):b(I)),f<=0||v<=0||!R||!R.length?null:ye.createElement(xr,{className:In("recharts-cartesian-axis",_),ref:function(P){o.layerReference=P}},h&&this.renderAxisLine(),this.renderTicks(R,this.state.fontSize,this.state.letterSpacing),bs.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(o,d,h){var f,v=In(d.className,"recharts-cartesian-axis-tick-value");return ye.isValidElement(o)?f=ye.cloneElement(o,Ei(Ei({},d),{},{className:v})):mn(o)?f=o(Ei(Ei({},d),{},{className:v})):f=ye.createElement(mS,of({},d,{className:"recharts-cartesian-axis-tick-value"}),h),f}}])}(z.Component);nL(Ag,"displayName","CartesianAxis");nL(Ag,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var xHe=["x1","y1","x2","y2","key"],_He=["offset"];function ip(e){"@babel/helpers - typeof";return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ip(e)}function ZY(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function xs(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?ZY(Object(s),!0).forEach(function(o){EHe(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ZY(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function EHe(e,n,s){return n=wHe(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function wHe(e){var n=SHe(e,"string");return ip(n)=="symbol"?n:n+""}function SHe(e,n){if(ip(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(ip(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Uh(){return Uh=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},Uh.apply(this,arguments)}function eq(e,n){if(e==null)return{};var s=THe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function THe(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}var NHe=function(n){var s=n.fill;if(!s||s==="none")return null;var o=n.fillOpacity,d=n.x,h=n.y,f=n.width,v=n.height,b=n.ry;return ye.createElement("rect",{x:d,y:h,ry:b,width:f,height:v,stroke:"none",fill:s,fillOpacity:o,className:"recharts-cartesian-grid-bg"})};function fne(e,n){var s;if(ye.isValidElement(e))s=ye.cloneElement(e,n);else if(mn(e))s=e(n);else{var o=n.x1,d=n.y1,h=n.x2,f=n.y2,v=n.key,b=eq(n,xHe),_=bn(b,!1);_.offset;var w=eq(_,_He);s=ye.createElement("line",Uh({},w,{x1:o,y1:d,x2:h,y2:f,fill:"none",key:v}))}return s}function CHe(e){var n=e.x,s=e.width,o=e.horizontal,d=o===void 0?!0:o,h=e.horizontalPoints;if(!d||!h||!h.length)return null;var f=h.map(function(v,b){var _=xs(xs({},e),{},{x1:n,y1:v,x2:n+s,y2:v,key:"line-".concat(b),index:b});return fne(d,_)});return ye.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function RHe(e){var n=e.y,s=e.height,o=e.vertical,d=o===void 0?!0:o,h=e.verticalPoints;if(!d||!h||!h.length)return null;var f=h.map(function(v,b){var _=xs(xs({},e),{},{x1:v,y1:n,x2:v,y2:n+s,key:"line-".concat(b),index:b});return fne(d,_)});return ye.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function AHe(e){var n=e.horizontalFill,s=e.fillOpacity,o=e.x,d=e.y,h=e.width,f=e.height,v=e.horizontalPoints,b=e.horizontal,_=b===void 0?!0:b;if(!_||!n||!n.length)return null;var w=v.map(function(N){return Math.round(N+d-d)}).sort(function(N,I){return N-I});d!==w[0]&&w.unshift(0);var E=w.map(function(N,I){var R=!w[I+1],O=R?d+f-N:w[I+1]-N;if(O<=0)return null;var P=I%n.length;return ye.createElement("rect",{key:"react-".concat(I),y:N,x:o,height:O,width:h,stroke:"none",fill:n[P],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return ye.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},E)}function IHe(e){var n=e.vertical,s=n===void 0?!0:n,o=e.verticalFill,d=e.fillOpacity,h=e.x,f=e.y,v=e.width,b=e.height,_=e.verticalPoints;if(!s||!o||!o.length)return null;var w=_.map(function(N){return Math.round(N+h-h)}).sort(function(N,I){return N-I});h!==w[0]&&w.unshift(0);var E=w.map(function(N,I){var R=!w[I+1],O=R?h+v-N:w[I+1]-N;if(O<=0)return null;var P=I%o.length;return ye.createElement("rect",{key:"react-".concat(I),x:N,y:f,width:O,height:b,stroke:"none",fill:o[P],fillOpacity:d,className:"recharts-cartesian-grid-bg"})});return ye.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},E)}var OHe=function(n,s){var o=n.xAxis,d=n.width,h=n.height,f=n.offset;return Ste(tL(xs(xs(xs({},Ag.defaultProps),o),{},{ticks:jl(o,!0),viewBox:{x:0,y:0,width:d,height:h}})),f.left,f.left+f.width,s)},PHe=function(n,s){var o=n.yAxis,d=n.width,h=n.height,f=n.offset;return Ste(tL(xs(xs(xs({},Ag.defaultProps),o),{},{ticks:jl(o,!0),viewBox:{x:0,y:0,width:d,height:h}})),f.top,f.top+f.height,s)},Gm={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Jf(e){var n,s,o,d,h,f,v=JD(),b=QD(),_=b7e(),w=xs(xs({},e),{},{stroke:(n=e.stroke)!==null&&n!==void 0?n:Gm.stroke,fill:(s=e.fill)!==null&&s!==void 0?s:Gm.fill,horizontal:(o=e.horizontal)!==null&&o!==void 0?o:Gm.horizontal,horizontalFill:(d=e.horizontalFill)!==null&&d!==void 0?d:Gm.horizontalFill,vertical:(h=e.vertical)!==null&&h!==void 0?h:Gm.vertical,verticalFill:(f=e.verticalFill)!==null&&f!==void 0?f:Gm.verticalFill,x:pt(e.x)?e.x:_.left,y:pt(e.y)?e.y:_.top,width:pt(e.width)?e.width:_.width,height:pt(e.height)?e.height:_.height}),E=w.x,N=w.y,I=w.width,R=w.height,O=w.syncWithTicks,P=w.horizontalValues,M=w.verticalValues,D=g7e(),U=v7e();if(!pt(I)||I<=0||!pt(R)||R<=0||!pt(E)||E!==+E||!pt(N)||N!==+N)return null;var B=w.verticalCoordinatesGenerator||OHe,G=w.horizontalCoordinatesGenerator||PHe,$=w.horizontalPoints,q=w.verticalPoints;if((!$||!$.length)&&mn(G)){var X=P&&P.length,ee=G({yAxis:U?xs(xs({},U),{},{ticks:X?P:U.ticks}):void 0,width:v,height:b,offset:_},X?!0:O);Fl(Array.isArray(ee),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(ip(ee),"]")),Array.isArray(ee)&&($=ee)}if((!q||!q.length)&&mn(B)){var ce=M&&M.length,Q=B({xAxis:D?xs(xs({},D),{},{ticks:ce?M:D.ticks}):void 0,width:v,height:b,offset:_},ce?!0:O);Fl(Array.isArray(Q),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(ip(Q),"]")),Array.isArray(Q)&&(q=Q)}return ye.createElement("g",{className:"recharts-cartesian-grid"},ye.createElement(NHe,{fill:w.fill,fillOpacity:w.fillOpacity,x:w.x,y:w.y,width:w.width,height:w.height,ry:w.ry}),ye.createElement(CHe,Uh({},w,{offset:_,horizontalPoints:$,xAxis:D,yAxis:U})),ye.createElement(RHe,Uh({},w,{offset:_,verticalPoints:q,xAxis:D,yAxis:U})),ye.createElement(AHe,Uh({},w,{horizontalPoints:$})),ye.createElement(IHe,Uh({},w,{verticalPoints:q})))}Jf.displayName="CartesianGrid";var kHe=["type","layout","connectNulls","ref"],jHe=["key"];function Qf(e){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Qf(e)}function tq(e,n){if(e==null)return{};var s=DHe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function DHe(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function Yv(){return Yv=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},Yv.apply(this,arguments)}function nq(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function Ta(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?nq(Object(s),!0).forEach(function(o){oc(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):nq(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function Wm(e){return FHe(e)||UHe(e)||MHe(e)||LHe()}function LHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MHe(e,n){if(e){if(typeof e=="string")return Sk(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Sk(e,n)}}function UHe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FHe(e){if(Array.isArray(e))return Sk(e)}function Sk(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function VHe(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function rq(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,vne(o.key),o)}}function BHe(e,n,s){return n&&rq(e.prototype,n),s&&rq(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function GHe(e,n,s){return n=YS(n),WHe(e,gne()?Reflect.construct(n,s||[],YS(e).constructor):n.apply(e,s))}function WHe(e,n){if(n&&(Qf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $He(e)}function $He(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gne=function(){return!!e})()}function YS(e){return YS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},YS(e)}function zHe(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Tk(e,n)}function Tk(e,n){return Tk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},Tk(e,n)}function oc(e,n,s){return n=vne(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function vne(e){var n=HHe(e,"string");return Qf(n)=="symbol"?n:n+""}function HHe(e,n){if(Qf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Qf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ig=function(e){function n(){var s;VHe(this,n);for(var o=arguments.length,d=new Array(o),h=0;h<o;h++)d[h]=arguments[h];return s=GHe(this,n,[].concat(d)),oc(s,"state",{isAnimationFinished:!0,totalLength:0}),oc(s,"generateSimpleStrokeDasharray",function(f,v){return"".concat(v,"px ").concat(f-v,"px")}),oc(s,"getStrokeDasharray",function(f,v,b){var _=b.reduce(function(M,D){return M+D});if(!_)return s.generateSimpleStrokeDasharray(v,f);for(var w=Math.floor(f/_),E=f%_,N=v-f,I=[],R=0,O=0;R<b.length;O+=b[R],++R)if(O+b[R]>E){I=[].concat(Wm(b.slice(0,R)),[E-O]);break}var P=I.length%2===0?[0,N]:[N];return[].concat(Wm(n.repeat(b,w)),Wm(I),P).map(function(M){return"".concat(M,"px")}).join(", ")}),oc(s,"id",Eg("recharts-line-")),oc(s,"pathRef",function(f){s.mainCurve=f}),oc(s,"handleAnimationEnd",function(){s.setState({isAnimationFinished:!0}),s.props.onAnimationEnd&&s.props.onAnimationEnd()}),oc(s,"handleAnimationStart",function(){s.setState({isAnimationFinished:!1}),s.props.onAnimationStart&&s.props.onAnimationStart()}),s}return zHe(n,e),BHe(n,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var o=this.getTotalLength();this.setState({totalLength:o})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var o=this.getTotalLength();o!==this.state.totalLength&&this.setState({totalLength:o})}}},{key:"getTotalLength",value:function(){var o=this.mainCurve;try{return o&&o.getTotalLength&&o.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(o,d){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var h=this.props,f=h.points,v=h.xAxis,b=h.yAxis,_=h.layout,w=h.children,E=Eo(w,vb);if(!E)return null;var N=function(O,P){return{x:O.x,y:O.y,value:O.value,errorVal:Ds(O.payload,P)}},I={clipPath:o?"url(#clipPath-".concat(d,")"):null};return ye.createElement(xr,I,E.map(function(R){return ye.cloneElement(R,{key:"bar-".concat(R.props.dataKey),data:f,xAxis:v,yAxis:b,layout:_,dataPointFormatter:N})}))}},{key:"renderDots",value:function(o,d,h){var f=this.props.isAnimationActive;if(f&&!this.state.isAnimationFinished)return null;var v=this.props,b=v.dot,_=v.points,w=v.dataKey,E=bn(this.props,!1),N=bn(b,!0),I=_.map(function(O,P){var M=Ta(Ta(Ta({key:"dot-".concat(P),r:3},E),N),{},{index:P,cx:O.x,cy:O.y,value:O.value,dataKey:w,payload:O.payload,points:_});return n.renderDotItem(b,M)}),R={clipPath:o?"url(#clipPath-".concat(d?"":"dots-").concat(h,")"):null};return ye.createElement(xr,Yv({className:"recharts-line-dots",key:"dots"},R),I)}},{key:"renderCurveStatically",value:function(o,d,h,f){var v=this.props,b=v.type,_=v.layout,w=v.connectNulls;v.ref;var E=tq(v,kHe),N=Ta(Ta(Ta({},bn(E,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(h,")"):null,points:o},f),{},{type:b,layout:_,connectNulls:w});return ye.createElement(xf,Yv({},N,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(o,d){var h=this,f=this.props,v=f.points,b=f.strokeDasharray,_=f.isAnimationActive,w=f.animationBegin,E=f.animationDuration,N=f.animationEasing,I=f.animationId,R=f.animateNewValues,O=f.width,P=f.height,M=this.state,D=M.prevPoints,U=M.totalLength;return ye.createElement(rl,{begin:w,duration:E,isActive:_,easing:N,from:{t:0},to:{t:1},key:"line-".concat(I),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(B){var G=B.t;if(D){var $=D.length/v.length,q=v.map(function(ae,ve){var le=Math.floor(ve*$);if(D[le]){var fe=D[le],re=ts(fe.x,ae.x),he=ts(fe.y,ae.y);return Ta(Ta({},ae),{},{x:re(G),y:he(G)})}if(R){var J=ts(O*2,ae.x),ue=ts(P/2,ae.y);return Ta(Ta({},ae),{},{x:J(G),y:ue(G)})}return Ta(Ta({},ae),{},{x:ae.x,y:ae.y})});return h.renderCurveStatically(q,o,d)}var X=ts(0,U),ee=X(G),ce;if(b){var Q="".concat(b).split(/[,\s]+/gim).map(function(ae){return parseFloat(ae)});ce=h.getStrokeDasharray(ee,U,Q)}else ce=h.generateSimpleStrokeDasharray(U,ee);return h.renderCurveStatically(v,o,d,{strokeDasharray:ce})})}},{key:"renderCurve",value:function(o,d){var h=this.props,f=h.points,v=h.isAnimationActive,b=this.state,_=b.prevPoints,w=b.totalLength;return v&&f&&f.length&&(!_&&w>0||!Bf(_,f))?this.renderCurveWithAnimation(o,d):this.renderCurveStatically(f,o,d)}},{key:"render",value:function(){var o,d=this.props,h=d.hide,f=d.dot,v=d.points,b=d.className,_=d.xAxis,w=d.yAxis,E=d.top,N=d.left,I=d.width,R=d.height,O=d.isAnimationActive,P=d.id;if(h||!v||!v.length)return null;var M=this.state.isAnimationFinished,D=v.length===1,U=In("recharts-line",b),B=_&&_.allowDataOverflow,G=w&&w.allowDataOverflow,$=B||G,q=En(P)?this.id:P,X=(o=bn(f,!1))!==null&&o!==void 0?o:{r:3,strokeWidth:2},ee=X.r,ce=ee===void 0?3:ee,Q=X.strokeWidth,ae=Q===void 0?2:Q,ve=gZ(f)?f:{},le=ve.clipDot,fe=le===void 0?!0:le,re=ce*2+ae;return ye.createElement(xr,{className:U},B||G?ye.createElement("defs",null,ye.createElement("clipPath",{id:"clipPath-".concat(q)},ye.createElement("rect",{x:B?N:N-I/2,y:G?E:E-R/2,width:B?I:I*2,height:G?R:R*2})),!fe&&ye.createElement("clipPath",{id:"clipPath-dots-".concat(q)},ye.createElement("rect",{x:N-re/2,y:E-re/2,width:I+re,height:R+re}))):null,!D&&this.renderCurve($,q),this.renderErrorBar($,q),(D||f)&&this.renderDots($,fe,q),(!O||M)&&Bl.renderCallByParent(this.props,v))}}],[{key:"getDerivedStateFromProps",value:function(o,d){return o.animationId!==d.prevAnimationId?{prevAnimationId:o.animationId,curPoints:o.points,prevPoints:d.curPoints}:o.points!==d.curPoints?{curPoints:o.points}:null}},{key:"repeat",value:function(o,d){for(var h=o.length%2!==0?[].concat(Wm(o),[0]):o,f=[],v=0;v<d;++v)f=[].concat(Wm(f),Wm(h));return f}},{key:"renderDotItem",value:function(o,d){var h;if(ye.isValidElement(o))h=ye.cloneElement(o,d);else if(mn(o))h=o(d);else{var f=d.key,v=tq(d,jHe),b=In("recharts-line-dot",typeof o!="boolean"?o.className:"");h=ye.createElement(sN,Yv({key:f},v,{className:b}))}return h}}])}(z.PureComponent);oc(Ig,"displayName","Line");oc(Ig,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!lp.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});oc(Ig,"getComposedData",function(e){var n=e.props,s=e.xAxis,o=e.yAxis,d=e.xAxisTicks,h=e.yAxisTicks,f=e.dataKey,v=e.bandSize,b=e.displayedData,_=e.offset,w=n.layout,E=b.map(function(N,I){var R=Ds(N,f);return w==="horizontal"?{x:RS({axis:s,ticks:d,bandSize:v,entry:N,index:I}),y:En(R)?null:o.scale(R),value:R,payload:N}:{x:En(R)?null:s.scale(R),y:RS({axis:o,ticks:h,bandSize:v,entry:N,index:I}),value:R,payload:N}});return Ta({points:E,layout:w},_)});var KHe=["layout","type","stroke","connectNulls","isRange","ref"],YHe=["key"],yne;function Zf(e){"@babel/helpers - typeof";return Zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Zf(e)}function bne(e,n){if(e==null)return{};var s=qHe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function qHe(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function Fh(){return Fh=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},Fh.apply(this,arguments)}function iq(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function Md(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?iq(Object(s),!0).forEach(function(o){qc(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):iq(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function XHe(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function sq(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_ne(o.key),o)}}function JHe(e,n,s){return n&&sq(e.prototype,n),s&&sq(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function QHe(e,n,s){return n=qS(n),ZHe(e,xne()?Reflect.construct(n,s||[],qS(e).constructor):n.apply(e,s))}function ZHe(e,n){if(n&&(Zf(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e9e(e)}function e9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xne=function(){return!!e})()}function qS(e){return qS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},qS(e)}function t9e(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Nk(e,n)}function Nk(e,n){return Nk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},Nk(e,n)}function qc(e,n,s){return n=_ne(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function _ne(e){var n=n9e(e,"string");return Zf(n)=="symbol"?n:n+""}function n9e(e,n){if(Zf(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Zf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var sl=function(e){function n(){var s;XHe(this,n);for(var o=arguments.length,d=new Array(o),h=0;h<o;h++)d[h]=arguments[h];return s=QHe(this,n,[].concat(d)),qc(s,"state",{isAnimationFinished:!0}),qc(s,"id",Eg("recharts-area-")),qc(s,"handleAnimationEnd",function(){var f=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),mn(f)&&f()}),qc(s,"handleAnimationStart",function(){var f=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),mn(f)&&f()}),s}return t9e(n,e),JHe(n,[{key:"renderDots",value:function(o,d,h){var f=this.props.isAnimationActive,v=this.state.isAnimationFinished;if(f&&!v)return null;var b=this.props,_=b.dot,w=b.points,E=b.dataKey,N=bn(this.props,!1),I=bn(_,!0),R=w.map(function(P,M){var D=Md(Md(Md({key:"dot-".concat(M),r:3},N),I),{},{index:M,cx:P.x,cy:P.y,dataKey:E,value:P.value,payload:P.payload,points:w});return n.renderDotItem(_,D)}),O={clipPath:o?"url(#clipPath-".concat(d?"":"dots-").concat(h,")"):null};return ye.createElement(xr,Fh({className:"recharts-area-dots"},O),R)}},{key:"renderHorizontalRect",value:function(o){var d=this.props,h=d.baseLine,f=d.points,v=d.strokeWidth,b=f[0].x,_=f[f.length-1].x,w=o*Math.abs(b-_),E=Jd(f.map(function(N){return N.y||0}));return pt(h)&&typeof h=="number"?E=Math.max(h,E):h&&Array.isArray(h)&&h.length&&(E=Math.max(Jd(h.map(function(N){return N.y||0})),E)),pt(E)?ye.createElement("rect",{x:b<_?b:b-w,y:0,width:w,height:Math.floor(E+(v?parseInt("".concat(v),10):1))}):null}},{key:"renderVerticalRect",value:function(o){var d=this.props,h=d.baseLine,f=d.points,v=d.strokeWidth,b=f[0].y,_=f[f.length-1].y,w=o*Math.abs(b-_),E=Jd(f.map(function(N){return N.x||0}));return pt(h)&&typeof h=="number"?E=Math.max(h,E):h&&Array.isArray(h)&&h.length&&(E=Math.max(Jd(h.map(function(N){return N.x||0})),E)),pt(E)?ye.createElement("rect",{x:0,y:b<_?b:b-w,width:E+(v?parseInt("".concat(v),10):1),height:Math.floor(w)}):null}},{key:"renderClipRect",value:function(o){var d=this.props.layout;return d==="vertical"?this.renderVerticalRect(o):this.renderHorizontalRect(o)}},{key:"renderAreaStatically",value:function(o,d,h,f){var v=this.props,b=v.layout,_=v.type,w=v.stroke,E=v.connectNulls,N=v.isRange;v.ref;var I=bne(v,KHe);return ye.createElement(xr,{clipPath:h?"url(#clipPath-".concat(f,")"):null},ye.createElement(xf,Fh({},bn(I,!0),{points:o,connectNulls:E,type:_,baseLine:d,layout:b,stroke:"none",className:"recharts-area-area"})),w!=="none"&&ye.createElement(xf,Fh({},bn(this.props,!1),{className:"recharts-area-curve",layout:b,type:_,connectNulls:E,fill:"none",points:o})),w!=="none"&&N&&ye.createElement(xf,Fh({},bn(this.props,!1),{className:"recharts-area-curve",layout:b,type:_,connectNulls:E,fill:"none",points:d})))}},{key:"renderAreaWithAnimation",value:function(o,d){var h=this,f=this.props,v=f.points,b=f.baseLine,_=f.isAnimationActive,w=f.animationBegin,E=f.animationDuration,N=f.animationEasing,I=f.animationId,R=this.state,O=R.prevPoints,P=R.prevBaseLine;return ye.createElement(rl,{begin:w,duration:E,isActive:_,easing:N,from:{t:0},to:{t:1},key:"area-".concat(I),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(M){var D=M.t;if(O){var U=O.length/v.length,B=v.map(function(X,ee){var ce=Math.floor(ee*U);if(O[ce]){var Q=O[ce],ae=ts(Q.x,X.x),ve=ts(Q.y,X.y);return Md(Md({},X),{},{x:ae(D),y:ve(D)})}return X}),G;if(pt(b)&&typeof b=="number"){var $=ts(P,b);G=$(D)}else if(En(b)||_g(b)){var q=ts(P,0);G=q(D)}else G=b.map(function(X,ee){var ce=Math.floor(ee*U);if(P[ce]){var Q=P[ce],ae=ts(Q.x,X.x),ve=ts(Q.y,X.y);return Md(Md({},X),{},{x:ae(D),y:ve(D)})}return X});return h.renderAreaStatically(B,G,o,d)}return ye.createElement(xr,null,ye.createElement("defs",null,ye.createElement("clipPath",{id:"animationClipPath-".concat(d)},h.renderClipRect(D))),ye.createElement(xr,{clipPath:"url(#animationClipPath-".concat(d,")")},h.renderAreaStatically(v,b,o,d)))})}},{key:"renderArea",value:function(o,d){var h=this.props,f=h.points,v=h.baseLine,b=h.isAnimationActive,_=this.state,w=_.prevPoints,E=_.prevBaseLine,N=_.totalLength;return b&&f&&f.length&&(!w&&N>0||!Bf(w,f)||!Bf(E,v))?this.renderAreaWithAnimation(o,d):this.renderAreaStatically(f,v,o,d)}},{key:"render",value:function(){var o,d=this.props,h=d.hide,f=d.dot,v=d.points,b=d.className,_=d.top,w=d.left,E=d.xAxis,N=d.yAxis,I=d.width,R=d.height,O=d.isAnimationActive,P=d.id;if(h||!v||!v.length)return null;var M=this.state.isAnimationFinished,D=v.length===1,U=In("recharts-area",b),B=E&&E.allowDataOverflow,G=N&&N.allowDataOverflow,$=B||G,q=En(P)?this.id:P,X=(o=bn(f,!1))!==null&&o!==void 0?o:{r:3,strokeWidth:2},ee=X.r,ce=ee===void 0?3:ee,Q=X.strokeWidth,ae=Q===void 0?2:Q,ve=gZ(f)?f:{},le=ve.clipDot,fe=le===void 0?!0:le,re=ce*2+ae;return ye.createElement(xr,{className:U},B||G?ye.createElement("defs",null,ye.createElement("clipPath",{id:"clipPath-".concat(q)},ye.createElement("rect",{x:B?w:w-I/2,y:G?_:_-R/2,width:B?I:I*2,height:G?R:R*2})),!fe&&ye.createElement("clipPath",{id:"clipPath-dots-".concat(q)},ye.createElement("rect",{x:w-re/2,y:_-re/2,width:I+re,height:R+re}))):null,D?null:this.renderArea($,q),(f||D)&&this.renderDots($,fe,q),(!O||M)&&Bl.renderCallByParent(this.props,v))}}],[{key:"getDerivedStateFromProps",value:function(o,d){return o.animationId!==d.prevAnimationId?{prevAnimationId:o.animationId,curPoints:o.points,curBaseLine:o.baseLine,prevPoints:d.curPoints,prevBaseLine:d.curBaseLine}:o.points!==d.curPoints||o.baseLine!==d.curBaseLine?{curPoints:o.points,curBaseLine:o.baseLine}:null}}])}(z.PureComponent);yne=sl;qc(sl,"displayName","Area");qc(sl,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!lp.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});qc(sl,"getBaseValue",function(e,n,s,o){var d=e.layout,h=e.baseValue,f=n.props.baseValue,v=f??h;if(pt(v)&&typeof v=="number")return v;var b=d==="horizontal"?o:s,_=b.scale.domain();if(b.type==="number"){var w=Math.max(_[0],_[1]),E=Math.min(_[0],_[1]);return v==="dataMin"?E:v==="dataMax"||w<0?w:Math.max(Math.min(_[0],_[1]),0)}return v==="dataMin"?_[0]:v==="dataMax"?_[1]:_[0]});qc(sl,"getComposedData",function(e){var n=e.props,s=e.item,o=e.xAxis,d=e.yAxis,h=e.xAxisTicks,f=e.yAxisTicks,v=e.bandSize,b=e.dataKey,_=e.stackedData,w=e.dataStartIndex,E=e.displayedData,N=e.offset,I=n.layout,R=_&&_.length,O=yne.getBaseValue(n,s,o,d),P=I==="horizontal",M=!1,D=E.map(function(B,G){var $;R?$=_[w+G]:($=Ds(B,b),Array.isArray($)?M=!0:$=[O,$]);var q=$[1]==null||R&&Ds(B,b)==null;return P?{x:RS({axis:o,ticks:h,bandSize:v,entry:B,index:G}),y:q?null:d.scale($[1]),value:$,payload:B}:{x:q?null:o.scale($[1]),y:RS({axis:d,ticks:f,bandSize:v,entry:B,index:G}),value:$,payload:B}}),U;return R||M?U=D.map(function(B){var G=Array.isArray(B.value)?B.value[0]:null;return P?{x:B.x,y:G!=null&&B.y!=null?d.scale(G):null}:{x:G!=null?o.scale(G):null,y:B.y}}):U=P?d.scale(O):o.scale(O),Md({points:D,baseLine:U,layout:I,isRange:M},N)});qc(sl,"renderDotItem",function(e,n){var s;if(ye.isValidElement(e))s=ye.cloneElement(e,n);else if(mn(e))s=e(n);else{var o=In("recharts-area-dot",typeof e!="boolean"?e.className:""),d=n.key,h=bne(n,YHe);s=ye.createElement(sN,Fh({},h,{key:d,className:o}))}return s});function eg(e){"@babel/helpers - typeof";return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},eg(e)}function r9e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i9e(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Sne(o.key),o)}}function s9e(e,n,s){return n&&i9e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a9e(e,n,s){return n=XS(n),o9e(e,Ene()?Reflect.construct(n,s||[],XS(e).constructor):n.apply(e,s))}function o9e(e,n){if(n&&(eg(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c9e(e)}function c9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ene(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ene=function(){return!!e})()}function XS(e){return XS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},XS(e)}function l9e(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Ck(e,n)}function Ck(e,n){return Ck=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},Ck(e,n)}function wne(e,n,s){return n=Sne(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function Sne(e){var n=d9e(e,"string");return eg(n)=="symbol"?n:n+""}function d9e(e,n){if(eg(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(eg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Rk(){return Rk=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},Rk.apply(this,arguments)}function u9e(e){var n=e.xAxisId,s=JD(),o=QD(),d=ine(n);return d==null?null:z.createElement(Ag,Rk({},d,{className:In("recharts-".concat(d.axisType," ").concat(d.axisType),d.className),viewBox:{x:0,y:0,width:s,height:o},ticksGenerator:function(f){return jl(f,!0)}}))}var Xl=function(e){function n(){return r9e(this,n),a9e(this,n,arguments)}return l9e(n,e),s9e(n,[{key:"render",value:function(){return z.createElement(u9e,this.props)}}])}(z.Component);wne(Xl,"displayName","XAxis");wne(Xl,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function tg(e){"@babel/helpers - typeof";return tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},tg(e)}function h9e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function p9e(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Cne(o.key),o)}}function m9e(e,n,s){return n&&p9e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f9e(e,n,s){return n=JS(n),g9e(e,Tne()?Reflect.construct(n,s||[],JS(e).constructor):n.apply(e,s))}function g9e(e,n){if(n&&(tg(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v9e(e)}function v9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tne=function(){return!!e})()}function JS(e){return JS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},JS(e)}function y9e(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Ak(e,n)}function Ak(e,n){return Ak=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},Ak(e,n)}function Nne(e,n,s){return n=Cne(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function Cne(e){var n=b9e(e,"string");return tg(n)=="symbol"?n:n+""}function b9e(e,n){if(tg(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(tg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Ik(){return Ik=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},Ik.apply(this,arguments)}var x9e=function(n){var s=n.yAxisId,o=JD(),d=QD(),h=sne(s);return h==null?null:z.createElement(Ag,Ik({},h,{className:In("recharts-".concat(h.axisType," ").concat(h.axisType),h.className),viewBox:{x:0,y:0,width:o,height:d},ticksGenerator:function(v){return jl(v,!0)}}))},Jl=function(e){function n(){return h9e(this,n),f9e(this,n,arguments)}return y9e(n,e),m9e(n,[{key:"render",value:function(){return z.createElement(x9e,this.props)}}])}(z.Component);Nne(Jl,"displayName","YAxis");Nne(Jl,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function aq(e){return S9e(e)||w9e(e)||E9e(e)||_9e()}function _9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E9e(e,n){if(e){if(typeof e=="string")return Ok(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Ok(e,n)}}function w9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function S9e(e){if(Array.isArray(e))return Ok(e)}function Ok(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}var Pk=function(n,s,o,d,h){var f=Eo(n,eL),v=Eo(n,dN),b=[].concat(aq(f),aq(v)),_=Eo(n,hN),w="".concat(d,"Id"),E=d[0],N=s;if(b.length&&(N=b.reduce(function(O,P){if(P.props[w]===o&&el(P.props,"extendDomain")&&pt(P.props[E])){var M=P.props[E];return[Math.min(O[0],M),Math.max(O[1],M)]}return O},N)),_.length){var I="".concat(E,"1"),R="".concat(E,"2");N=_.reduce(function(O,P){if(P.props[w]===o&&el(P.props,"extendDomain")&&pt(P.props[I])&&pt(P.props[R])){var M=P.props[I],D=P.props[R];return[Math.min(O[0],M,D),Math.max(O[1],M,D)]}return O},N)}return h&&h.length&&(N=h.reduce(function(O,P){return pt(P)?[Math.min(O[0],P),Math.max(O[1],P)]:O},N)),N},Rne={exports:{}};(function(e){var n=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function d(b,_,w){this.fn=b,this.context=_,this.once=w||!1}function h(b,_,w,E,N){if(typeof w!="function")throw new TypeError("The listener must be a function");var I=new d(w,E||b,N),R=s?s+_:_;return b._events[R]?b._events[R].fn?b._events[R]=[b._events[R],I]:b._events[R].push(I):(b._events[R]=I,b._eventsCount++),b}function f(b,_){--b._eventsCount===0?b._events=new o:delete b._events[_]}function v(){this._events=new o,this._eventsCount=0}v.prototype.eventNames=function(){var _=[],w,E;if(this._eventsCount===0)return _;for(E in w=this._events)n.call(w,E)&&_.push(s?E.slice(1):E);return Object.getOwnPropertySymbols?_.concat(Object.getOwnPropertySymbols(w)):_},v.prototype.listeners=function(_){var w=s?s+_:_,E=this._events[w];if(!E)return[];if(E.fn)return[E.fn];for(var N=0,I=E.length,R=new Array(I);N<I;N++)R[N]=E[N].fn;return R},v.prototype.listenerCount=function(_){var w=s?s+_:_,E=this._events[w];return E?E.fn?1:E.length:0},v.prototype.emit=function(_,w,E,N,I,R){var O=s?s+_:_;if(!this._events[O])return!1;var P=this._events[O],M=arguments.length,D,U;if(P.fn){switch(P.once&&this.removeListener(_,P.fn,void 0,!0),M){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,w),!0;case 3:return P.fn.call(P.context,w,E),!0;case 4:return P.fn.call(P.context,w,E,N),!0;case 5:return P.fn.call(P.context,w,E,N,I),!0;case 6:return P.fn.call(P.context,w,E,N,I,R),!0}for(U=1,D=new Array(M-1);U<M;U++)D[U-1]=arguments[U];P.fn.apply(P.context,D)}else{var B=P.length,G;for(U=0;U<B;U++)switch(P[U].once&&this.removeListener(_,P[U].fn,void 0,!0),M){case 1:P[U].fn.call(P[U].context);break;case 2:P[U].fn.call(P[U].context,w);break;case 3:P[U].fn.call(P[U].context,w,E);break;case 4:P[U].fn.call(P[U].context,w,E,N);break;default:if(!D)for(G=1,D=new Array(M-1);G<M;G++)D[G-1]=arguments[G];P[U].fn.apply(P[U].context,D)}}return!0},v.prototype.on=function(_,w,E){return h(this,_,w,E,!1)},v.prototype.once=function(_,w,E){return h(this,_,w,E,!0)},v.prototype.removeListener=function(_,w,E,N){var I=s?s+_:_;if(!this._events[I])return this;if(!w)return f(this,I),this;var R=this._events[I];if(R.fn)R.fn===w&&(!N||R.once)&&(!E||R.context===E)&&f(this,I);else{for(var O=0,P=[],M=R.length;O<M;O++)(R[O].fn!==w||N&&!R[O].once||E&&R[O].context!==E)&&P.push(R[O]);P.length?this._events[I]=P.length===1?P[0]:P:f(this,I)}return this},v.prototype.removeAllListeners=function(_){var w;return _?(w=s?s+_:_,this._events[w]&&f(this,w)):(this._events=new o,this._eventsCount=0),this},v.prototype.off=v.prototype.removeListener,v.prototype.addListener=v.prototype.on,v.prefixed=s,v.EventEmitter=v,e.exports=v})(Rne);var T9e=Rne.exports;const N9e=ur(T9e);var VO=new N9e,BO="recharts.syncMouseEvents";function qy(e){"@babel/helpers - typeof";return qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},qy(e)}function C9e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function R9e(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Ane(o.key),o)}}function A9e(e,n,s){return n&&R9e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function GO(e,n,s){return n=Ane(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function Ane(e){var n=I9e(e,"string");return qy(n)=="symbol"?n:n+""}function I9e(e,n){if(qy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(qy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var O9e=function(){function e(){C9e(this,e),GO(this,"activeIndex",0),GO(this,"coordinateList",[]),GO(this,"layout","horizontal")}return A9e(e,[{key:"setDetails",value:function(s){var o,d=s.coordinateList,h=d===void 0?null:d,f=s.container,v=f===void 0?null:f,b=s.layout,_=b===void 0?null:b,w=s.offset,E=w===void 0?null:w,N=s.mouseHandlerCallback,I=N===void 0?null:N;this.coordinateList=(o=h??this.coordinateList)!==null&&o!==void 0?o:[],this.container=v??this.container,this.layout=_??this.layout,this.offset=E??this.offset,this.mouseHandlerCallback=I??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(s){if(this.coordinateList.length!==0)switch(s.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(s){this.activeIndex=s}},{key:"spoofMouse",value:function(){var s,o;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var d=this.container.getBoundingClientRect(),h=d.x,f=d.y,v=d.height,b=this.coordinateList[this.activeIndex].coordinate,_=((s=window)===null||s===void 0?void 0:s.scrollX)||0,w=((o=window)===null||o===void 0?void 0:o.scrollY)||0,E=h+b+_,N=f+this.offset.top+v/2+w;this.mouseHandlerCallback({pageX:E,pageY:N})}}}])}();function P9e(e,n,s){if(s==="number"&&n===!0&&Array.isArray(e)){var o=e==null?void 0:e[0],d=e==null?void 0:e[1];if(o&&d&&pt(o)&&pt(d))return!0}return!1}function k9e(e,n,s,o){var d=o/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?n.x-d:s.left+.5,y:e==="horizontal"?s.top+.5:n.y-d,width:e==="horizontal"?o:s.width-1,height:e==="horizontal"?s.height-1:o}}function Ine(e){var n=e.cx,s=e.cy,o=e.radius,d=e.startAngle,h=e.endAngle,f=rs(n,s,o,d),v=rs(n,s,o,h);return{points:[f,v],cx:n,cy:s,radius:o,startAngle:d,endAngle:h}}function j9e(e,n,s){var o,d,h,f;if(e==="horizontal")o=n.x,h=o,d=s.top,f=s.top+s.height;else if(e==="vertical")d=n.y,f=d,o=s.left,h=s.left+s.width;else if(n.cx!=null&&n.cy!=null)if(e==="centric"){var v=n.cx,b=n.cy,_=n.innerRadius,w=n.outerRadius,E=n.angle,N=rs(v,b,_,E),I=rs(v,b,w,E);o=N.x,d=N.y,h=I.x,f=I.y}else return Ine(n);return[{x:o,y:d},{x:h,y:f}]}function Xy(e){"@babel/helpers - typeof";return Xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Xy(e)}function oq(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function QE(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?oq(Object(s),!0).forEach(function(o){D9e(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):oq(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function D9e(e,n,s){return n=L9e(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function L9e(e){var n=M9e(e,"string");return Xy(n)=="symbol"?n:n+""}function M9e(e,n){if(Xy(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(Xy(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function U9e(e){var n,s,o=e.element,d=e.tooltipEventType,h=e.isActive,f=e.activeCoordinate,v=e.activePayload,b=e.offset,_=e.activeTooltipIndex,w=e.tooltipAxisBandSize,E=e.layout,N=e.chartName,I=(n=o.props.cursor)!==null&&n!==void 0?n:(s=o.type.defaultProps)===null||s===void 0?void 0:s.cursor;if(!o||!I||!h||!f||N!=="ScatterChart"&&d!=="axis")return null;var R,O=xf;if(N==="ScatterChart")R=f,O=RWe;else if(N==="BarChart")R=k9e(E,f,b,w),O=KD;else if(E==="radial"){var P=Ine(f),M=P.cx,D=P.cy,U=P.radius,B=P.startAngle,G=P.endAngle;R={cx:M,cy:D,startAngle:B,endAngle:G,innerRadius:U,outerRadius:U},O=Ate}else R={points:j9e(E,f,b)},O=xf;var $=QE(QE(QE(QE({stroke:"#ccc",pointerEvents:"none"},b),R),bn(I,!1)),{},{payload:v,payloadIndex:_,className:In("recharts-tooltip-cursor",I.className)});return z.isValidElement(I)?z.cloneElement(I,$):z.createElement(O,$)}var F9e=["item"],V9e=["children","className","width","height","style","compact","title","desc"];function ng(e){"@babel/helpers - typeof";return ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ng(e)}function cf(){return cf=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},cf.apply(this,arguments)}function cq(e,n){return W9e(e)||G9e(e,n)||Pne(e,n)||B9e()}function B9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G9e(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o,d,h,f,v=[],b=!0,_=!1;try{if(h=(s=s.call(e)).next,n!==0)for(;!(b=(o=h.call(s)).done)&&(v.push(o.value),v.length!==n);b=!0);}catch(w){_=!0,d=w}finally{try{if(!b&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(_)throw d}}return v}}function W9e(e){if(Array.isArray(e))return e}function lq(e,n){if(e==null)return{};var s=$9e(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function $9e(e,n){if(e==null)return{};var s={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(n.indexOf(o)>=0)continue;s[o]=e[o]}return s}function z9e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function H9e(e,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,kne(o.key),o)}}function K9e(e,n,s){return n&&H9e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y9e(e,n,s){return n=QS(n),q9e(e,One()?Reflect.construct(n,s||[],QS(e).constructor):n.apply(e,s))}function q9e(e,n){if(n&&(ng(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return X9e(e)}function X9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function One(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(One=function(){return!!e})()}function QS(e){return QS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},QS(e)}function J9e(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&kk(e,n)}function kk(e,n){return kk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,d){return o.__proto__=d,o},kk(e,n)}function rg(e){return eKe(e)||Z9e(e)||Pne(e)||Q9e()}function Q9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pne(e,n){if(e){if(typeof e=="string")return jk(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return jk(e,n)}}function Z9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eKe(e){if(Array.isArray(e))return jk(e)}function jk(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function dq(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function $e(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?dq(Object(s),!0).forEach(function(o){qt(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):dq(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function qt(e,n,s){return n=kne(n),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function kne(e){var n=tKe(e,"string");return ng(n)=="symbol"?n:n+""}function tKe(e,n){if(ng(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,n);if(ng(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var nKe={xAxis:["bottom","top"],yAxis:["left","right"]},rKe={width:"100%",height:"100%"},jne={x:0,y:0};function ZE(e){return e}var iKe=function(n,s){return s==="horizontal"?n.x:s==="vertical"?n.y:s==="centric"?n.angle:n.radius},sKe=function(n,s,o,d){var h=s.find(function(w){return w&&w.index===o});if(h){if(n==="horizontal")return{x:h.coordinate,y:d.y};if(n==="vertical")return{x:d.x,y:h.coordinate};if(n==="centric"){var f=h.coordinate,v=d.radius;return $e($e($e({},d),rs(d.cx,d.cy,v,f)),{},{angle:f,radius:v})}var b=h.coordinate,_=d.angle;return $e($e($e({},d),rs(d.cx,d.cy,b,_)),{},{angle:_,radius:b})}return jne},pN=function(n,s){var o=s.graphicalItems,d=s.dataStartIndex,h=s.dataEndIndex,f=(o??[]).reduce(function(v,b){var _=b.props.data;return _&&_.length?[].concat(rg(v),rg(_)):v},[]);return f.length>0?f:n&&n.length&&pt(d)&&pt(h)?n.slice(d,h+1):[]};function Dne(e){return e==="number"?[0,"auto"]:void 0}var Dk=function(n,s,o,d){var h=n.graphicalItems,f=n.tooltipAxis,v=pN(s,n);return o<0||!h||!h.length||o>=v.length?null:h.reduce(function(b,_){var w,E=(w=_.props.data)!==null&&w!==void 0?w:s;E&&n.dataStartIndex+n.dataEndIndex!==0&&n.dataEndIndex-n.dataStartIndex>=o&&(E=E.slice(n.dataStartIndex,n.dataEndIndex+1));var N;if(f.dataKey&&!f.allowDuplicatedCategory){var I=E===void 0?v:E;N=Qw(I,f.dataKey,d)}else N=E&&E[o]||v[o];return N?[].concat(rg(b),[Nte(_,N)]):b},[])},uq=function(n,s,o,d){var h=d||{x:n.chartX,y:n.chartY},f=iKe(h,o),v=n.orderedTooltipTicks,b=n.tooltipAxis,_=n.tooltipTicks,w=lBe(f,v,_,b);if(w>=0&&_){var E=_[w]&&_[w].value,N=Dk(n,s,w,E),I=sKe(o,v,w,h);return{activeTooltipIndex:w,activeLabel:E,activePayload:N,activeCoordinate:I}}return null},aKe=function(n,s){var o=s.axes,d=s.graphicalItems,h=s.axisType,f=s.axisIdKey,v=s.stackGroups,b=s.dataStartIndex,_=s.dataEndIndex,w=n.layout,E=n.children,N=n.stackOffset,I=wte(w,h);return o.reduce(function(R,O){var P,M=O.type.defaultProps!==void 0?$e($e({},O.type.defaultProps),O.props):O.props,D=M.type,U=M.dataKey,B=M.allowDataOverflow,G=M.allowDuplicatedCategory,$=M.scale,q=M.ticks,X=M.includeHidden,ee=M[f];if(R[ee])return R;var ce=pN(n.data,{graphicalItems:d.filter(function(ke){var Ge,De=f in ke.props?ke.props[f]:(Ge=ke.type.defaultProps)===null||Ge===void 0?void 0:Ge[f];return De===ee}),dataStartIndex:b,dataEndIndex:_}),Q=ce.length,ae,ve,le;P9e(M.domain,B,D)&&(ae=QP(M.domain,null,B),I&&(D==="number"||$!=="auto")&&(le=Hv(ce,U,"category")));var fe=Dne(D);if(!ae||ae.length===0){var re,he=(re=M.domain)!==null&&re!==void 0?re:fe;if(U){if(ae=Hv(ce,U,D),D==="category"&&I){var J=JIe(ae);G&&J?(ve=ae,ae=US(0,Q)):G||(ae=BK(he,ae,O).reduce(function(ke,Ge){return ke.indexOf(Ge)>=0?ke:[].concat(rg(ke),[Ge])},[]))}else if(D==="category")G?ae=ae.filter(function(ke){return ke!==""&&!En(ke)}):ae=BK(he,ae,O).reduce(function(ke,Ge){return ke.indexOf(Ge)>=0||Ge===""||En(Ge)?ke:[].concat(rg(ke),[Ge])},[]);else if(D==="number"){var ue=mBe(ce,d.filter(function(ke){var Ge,De,Pe=f in ke.props?ke.props[f]:(Ge=ke.type.defaultProps)===null||Ge===void 0?void 0:Ge[f],Ve="hide"in ke.props?ke.props.hide:(De=ke.type.defaultProps)===null||De===void 0?void 0:De.hide;return Pe===ee&&(X||!Ve)}),U,h,w);ue&&(ae=ue)}I&&(D==="number"||$!=="auto")&&(le=Hv(ce,U,"category"))}else I?ae=US(0,Q):v&&v[ee]&&v[ee].hasStack&&D==="number"?ae=N==="expand"?[0,1]:Tte(v[ee].stackGroups,b,_):ae=Ete(ce,d.filter(function(ke){var Ge=f in ke.props?ke.props[f]:ke.type.defaultProps[f],De="hide"in ke.props?ke.props.hide:ke.type.defaultProps.hide;return Ge===ee&&(X||!De)}),D,w,!0);if(D==="number")ae=Pk(E,ae,ee,h,q),he&&(ae=QP(he,ae,B));else if(D==="category"&&he){var Ee=he,Fe=ae.every(function(ke){return Ee.indexOf(ke)>=0});Fe&&(ae=Ee)}}return $e($e({},R),{},qt({},ee,$e($e({},M),{},{axisType:h,domain:ae,categoricalDomain:le,duplicateDomain:ve,originalDomain:(P=M.domain)!==null&&P!==void 0?P:fe,isCategorical:I,layout:w})))},{})},oKe=function(n,s){var o=s.graphicalItems,d=s.Axis,h=s.axisType,f=s.axisIdKey,v=s.stackGroups,b=s.dataStartIndex,_=s.dataEndIndex,w=n.layout,E=n.children,N=pN(n.data,{graphicalItems:o,dataStartIndex:b,dataEndIndex:_}),I=N.length,R=wte(w,h),O=-1;return o.reduce(function(P,M){var D=M.type.defaultProps!==void 0?$e($e({},M.type.defaultProps),M.props):M.props,U=D[f],B=Dne("number");if(!P[U]){O++;var G;return R?G=US(0,I):v&&v[U]&&v[U].hasStack?(G=Tte(v[U].stackGroups,b,_),G=Pk(E,G,U,h)):(G=QP(B,Ete(N,o.filter(function($){var q,X,ee=f in $.props?$.props[f]:(q=$.type.defaultProps)===null||q===void 0?void 0:q[f],ce="hide"in $.props?$.props.hide:(X=$.type.defaultProps)===null||X===void 0?void 0:X.hide;return ee===U&&!ce}),"number",w),d.defaultProps.allowDataOverflow),G=Pk(E,G,U,h)),$e($e({},P),{},qt({},U,$e($e({axisType:h},d.defaultProps),{},{hide:!0,orientation:_o(nKe,"".concat(h,".").concat(O%2),null),domain:G,originalDomain:B,isCategorical:R,layout:w})))}return P},{})},cKe=function(n,s){var o=s.axisType,d=o===void 0?"xAxis":o,h=s.AxisComp,f=s.graphicalItems,v=s.stackGroups,b=s.dataStartIndex,_=s.dataEndIndex,w=n.children,E="".concat(d,"Id"),N=Eo(w,h),I={};return N&&N.length?I=aKe(n,{axes:N,graphicalItems:f,axisType:d,axisIdKey:E,stackGroups:v,dataStartIndex:b,dataEndIndex:_}):f&&f.length&&(I=oKe(n,{Axis:h,graphicalItems:f,axisType:d,axisIdKey:E,stackGroups:v,dataStartIndex:b,dataEndIndex:_})),I},lKe=function(n){var s=zd(n),o=jl(s,!1,!0);return{tooltipTicks:o,orderedTooltipTicks:xD(o,function(d){return d.coordinate}),tooltipAxis:s,tooltipAxisBandSize:AS(s,o)}},hq=function(n){var s=n.children,o=n.defaultShowTooltip,d=Ra(s,zf),h=0,f=0;return n.data&&n.data.length!==0&&(f=n.data.length-1),d&&d.props&&(d.props.startIndex>=0&&(h=d.props.startIndex),d.props.endIndex>=0&&(f=d.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:h,dataEndIndex:f,activeTooltipIndex:-1,isTooltipActive:!!o}},dKe=function(n){return!n||!n.length?!1:n.some(function(s){var o=Ul(s&&s.type);return o&&o.indexOf("Bar")>=0})},pq=function(n){return n==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:n==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:n==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},uKe=function(n,s){var o=n.props,d=n.graphicalItems,h=n.xAxisMap,f=h===void 0?{}:h,v=n.yAxisMap,b=v===void 0?{}:v,_=o.width,w=o.height,E=o.children,N=o.margin||{},I=Ra(E,zf),R=Ra(E,vf),O=Object.keys(b).reduce(function(G,$){var q=b[$],X=q.orientation;return!q.mirror&&!q.hide?$e($e({},G),{},qt({},X,G[X]+q.width)):G},{left:N.left||0,right:N.right||0}),P=Object.keys(f).reduce(function(G,$){var q=f[$],X=q.orientation;return!q.mirror&&!q.hide?$e($e({},G),{},qt({},X,_o(G,"".concat(X))+q.height)):G},{top:N.top||0,bottom:N.bottom||0}),M=$e($e({},P),O),D=M.bottom;I&&(M.bottom+=I.props.height||zf.defaultProps.height),R&&s&&(M=hBe(M,d,o,s));var U=_-M.left-M.right,B=w-M.top-M.bottom;return $e($e({brushBottom:D},M),{},{width:Math.max(U,0),height:Math.max(B,0)})},hKe=function(n,s){if(s==="xAxis")return n[s].width;if(s==="yAxis")return n[s].height},Lne=function(n){var s=n.chartName,o=n.GraphicalChild,d=n.defaultTooltipEventType,h=d===void 0?"axis":d,f=n.validateTooltipEventTypes,v=f===void 0?["axis"]:f,b=n.axisComponents,_=n.legendContent,w=n.formatAxisMap,E=n.defaultProps,N=function(M,D){var U=D.graphicalItems,B=D.stackGroups,G=D.offset,$=D.updateId,q=D.dataStartIndex,X=D.dataEndIndex,ee=M.barSize,ce=M.layout,Q=M.barGap,ae=M.barCategoryGap,ve=M.maxBarSize,le=pq(ce),fe=le.numericAxisName,re=le.cateAxisName,he=dKe(U),J=[];return U.forEach(function(ue,Ee){var Fe=pN(M.data,{graphicalItems:[ue],dataStartIndex:q,dataEndIndex:X}),ke=ue.type.defaultProps!==void 0?$e($e({},ue.type.defaultProps),ue.props):ue.props,Ge=ke.dataKey,De=ke.maxBarSize,Pe=ke["".concat(fe,"Id")],Ve=ke["".concat(re,"Id")],it={},Mt=b.reduce(function(Jr,os){var Ao=D["".concat(os.axisType,"Map")],Ne=ke["".concat(os.axisType,"Id")];Ao&&Ao[Ne]||os.axisType==="zAxis"||rp();var Ze=Ao[Ne];return $e($e({},Jr),{},qt(qt({},os.axisType,Ze),"".concat(os.axisType,"Ticks"),jl(Ze)))},it),tt=Mt[re],ft=Mt["".concat(re,"Ticks")],Rt=B&&B[Pe]&&B[Pe].hasStack&&NBe(ue,B[Pe].stackGroups),Te=Ul(ue.type).indexOf("Bar")>=0,st=AS(tt,ft),ct=[],zt=he&&dBe({barSize:ee,stackGroups:B,totalSize:hKe(Mt,re)});if(Te){var Ke,xe,Je=En(De)?ve:De,yt=(Ke=(xe=AS(tt,ft,!0))!==null&&xe!==void 0?xe:Je)!==null&&Ke!==void 0?Ke:0;ct=uBe({barGap:Q,barCategoryGap:ae,bandSize:yt!==st?yt:st,sizeList:zt[Ve],maxBarSize:Je}),yt!==st&&(ct=ct.map(function(Jr){return $e($e({},Jr),{},{position:$e($e({},Jr.position),{},{offset:Jr.position.offset-yt/2})})}))}var Yn=ue&&ue.type&&ue.type.getComposedData;Yn&&J.push({props:$e($e({},Yn($e($e({},Mt),{},{displayedData:Fe,props:M,dataKey:Ge,item:ue,bandSize:st,barPosition:ct,offset:G,stackedData:Rt,layout:ce,dataStartIndex:q,dataEndIndex:X}))),{},qt(qt(qt({key:ue.key||"item-".concat(Ee)},fe,Mt[fe]),re,Mt[re]),"animationId",$)),childIndex:lOe(ue,M.children),item:ue})}),J},I=function(M,D){var U=M.props,B=M.dataStartIndex,G=M.dataEndIndex,$=M.updateId;if(!DH({props:U}))return null;var q=U.children,X=U.layout,ee=U.stackOffset,ce=U.data,Q=U.reverseStackOrder,ae=pq(X),ve=ae.numericAxisName,le=ae.cateAxisName,fe=Eo(q,o),re=wBe(ce,fe,"".concat(ve,"Id"),"".concat(le,"Id"),ee,Q),he=b.reduce(function(ke,Ge){var De="".concat(Ge.axisType,"Map");return $e($e({},ke),{},qt({},De,cKe(U,$e($e({},Ge),{},{graphicalItems:fe,stackGroups:Ge.axisType===ve&&re,dataStartIndex:B,dataEndIndex:G}))))},{}),J=uKe($e($e({},he),{},{props:U,graphicalItems:fe}),D==null?void 0:D.legendBBox);Object.keys(he).forEach(function(ke){he[ke]=w(U,he[ke],J,ke.replace("Map",""),s)});var ue=he["".concat(le,"Map")],Ee=lKe(ue),Fe=N(U,$e($e({},he),{},{dataStartIndex:B,dataEndIndex:G,updateId:$,graphicalItems:fe,stackGroups:re,offset:J}));return $e($e({formattedGraphicalItems:Fe,graphicalItems:fe,offset:J,stackGroups:re},Ee),he)},R=function(P){function M(D){var U,B,G;return z9e(this,M),G=Y9e(this,M,[D]),qt(G,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),qt(G,"accessibilityManager",new O9e),qt(G,"handleLegendBBoxUpdate",function($){if($){var q=G.state,X=q.dataStartIndex,ee=q.dataEndIndex,ce=q.updateId;G.setState($e({legendBBox:$},I({props:G.props,dataStartIndex:X,dataEndIndex:ee,updateId:ce},$e($e({},G.state),{},{legendBBox:$}))))}}),qt(G,"handleReceiveSyncEvent",function($,q,X){if(G.props.syncId===$){if(X===G.eventEmitterSymbol&&typeof G.props.syncMethod!="function")return;G.applySyncEvent(q)}}),qt(G,"handleBrushChange",function($){var q=$.startIndex,X=$.endIndex;if(q!==G.state.dataStartIndex||X!==G.state.dataEndIndex){var ee=G.state.updateId;G.setState(function(){return $e({dataStartIndex:q,dataEndIndex:X},I({props:G.props,dataStartIndex:q,dataEndIndex:X,updateId:ee},G.state))}),G.triggerSyncEvent({dataStartIndex:q,dataEndIndex:X})}}),qt(G,"handleMouseEnter",function($){var q=G.getMouseInfo($);if(q){var X=$e($e({},q),{},{isTooltipActive:!0});G.setState(X),G.triggerSyncEvent(X);var ee=G.props.onMouseEnter;mn(ee)&&ee(X,$)}}),qt(G,"triggeredAfterMouseMove",function($){var q=G.getMouseInfo($),X=q?$e($e({},q),{},{isTooltipActive:!0}):{isTooltipActive:!1};G.setState(X),G.triggerSyncEvent(X);var ee=G.props.onMouseMove;mn(ee)&&ee(X,$)}),qt(G,"handleItemMouseEnter",function($){G.setState(function(){return{isTooltipActive:!0,activeItem:$,activePayload:$.tooltipPayload,activeCoordinate:$.tooltipPosition||{x:$.cx,y:$.cy}}})}),qt(G,"handleItemMouseLeave",function(){G.setState(function(){return{isTooltipActive:!1}})}),qt(G,"handleMouseMove",function($){$.persist(),G.throttleTriggeredAfterMouseMove($)}),qt(G,"handleMouseLeave",function($){G.throttleTriggeredAfterMouseMove.cancel();var q={isTooltipActive:!1};G.setState(q),G.triggerSyncEvent(q);var X=G.props.onMouseLeave;mn(X)&&X(q,$)}),qt(G,"handleOuterEvent",function($){var q=cOe($),X=_o(G.props,"".concat(q));if(q&&mn(X)){var ee,ce;/.*touch.*/i.test(q)?ce=G.getMouseInfo($.changedTouches[0]):ce=G.getMouseInfo($),X((ee=ce)!==null&&ee!==void 0?ee:{},$)}}),qt(G,"handleClick",function($){var q=G.getMouseInfo($);if(q){var X=$e($e({},q),{},{isTooltipActive:!0});G.setState(X),G.triggerSyncEvent(X);var ee=G.props.onClick;mn(ee)&&ee(X,$)}}),qt(G,"handleMouseDown",function($){var q=G.props.onMouseDown;if(mn(q)){var X=G.getMouseInfo($);q(X,$)}}),qt(G,"handleMouseUp",function($){var q=G.props.onMouseUp;if(mn(q)){var X=G.getMouseInfo($);q(X,$)}}),qt(G,"handleTouchMove",function($){$.changedTouches!=null&&$.changedTouches.length>0&&G.throttleTriggeredAfterMouseMove($.changedTouches[0])}),qt(G,"handleTouchStart",function($){$.changedTouches!=null&&$.changedTouches.length>0&&G.handleMouseDown($.changedTouches[0])}),qt(G,"handleTouchEnd",function($){$.changedTouches!=null&&$.changedTouches.length>0&&G.handleMouseUp($.changedTouches[0])}),qt(G,"handleDoubleClick",function($){var q=G.props.onDoubleClick;if(mn(q)){var X=G.getMouseInfo($);q(X,$)}}),qt(G,"handleContextMenu",function($){var q=G.props.onContextMenu;if(mn(q)){var X=G.getMouseInfo($);q(X,$)}}),qt(G,"triggerSyncEvent",function($){G.props.syncId!==void 0&&VO.emit(BO,G.props.syncId,$,G.eventEmitterSymbol)}),qt(G,"applySyncEvent",function($){var q=G.props,X=q.layout,ee=q.syncMethod,ce=G.state.updateId,Q=$.dataStartIndex,ae=$.dataEndIndex;if($.dataStartIndex!==void 0||$.dataEndIndex!==void 0)G.setState($e({dataStartIndex:Q,dataEndIndex:ae},I({props:G.props,dataStartIndex:Q,dataEndIndex:ae,updateId:ce},G.state)));else if($.activeTooltipIndex!==void 0){var ve=$.chartX,le=$.chartY,fe=$.activeTooltipIndex,re=G.state,he=re.offset,J=re.tooltipTicks;if(!he)return;if(typeof ee=="function")fe=ee(J,$);else if(ee==="value"){fe=-1;for(var ue=0;ue<J.length;ue++)if(J[ue].value===$.activeLabel){fe=ue;break}}var Ee=$e($e({},he),{},{x:he.left,y:he.top}),Fe=Math.min(ve,Ee.x+Ee.width),ke=Math.min(le,Ee.y+Ee.height),Ge=J[fe]&&J[fe].value,De=Dk(G.state,G.props.data,fe),Pe=J[fe]?{x:X==="horizontal"?J[fe].coordinate:Fe,y:X==="horizontal"?ke:J[fe].coordinate}:jne;G.setState($e($e({},$),{},{activeLabel:Ge,activeCoordinate:Pe,activePayload:De,activeTooltipIndex:fe}))}else G.setState($)}),qt(G,"renderCursor",function($){var q,X=G.state,ee=X.isTooltipActive,ce=X.activeCoordinate,Q=X.activePayload,ae=X.offset,ve=X.activeTooltipIndex,le=X.tooltipAxisBandSize,fe=G.getTooltipEventType(),re=(q=$.props.active)!==null&&q!==void 0?q:ee,he=G.props.layout,J=$.key||"_recharts-cursor";return ye.createElement(U9e,{key:J,activeCoordinate:ce,activePayload:Q,activeTooltipIndex:ve,chartName:s,element:$,isActive:re,layout:he,offset:ae,tooltipAxisBandSize:le,tooltipEventType:fe})}),qt(G,"renderPolarAxis",function($,q,X){var ee=_o($,"type.axisType"),ce=_o(G.state,"".concat(ee,"Map")),Q=$.type.defaultProps,ae=Q!==void 0?$e($e({},Q),$.props):$.props,ve=ce&&ce[ae["".concat(ee,"Id")]];return z.cloneElement($,$e($e({},ve),{},{className:In(ee,ve.className),key:$.key||"".concat(q,"-").concat(X),ticks:jl(ve,!0)}))}),qt(G,"renderPolarGrid",function($){var q=$.props,X=q.radialLines,ee=q.polarAngles,ce=q.polarRadius,Q=G.state,ae=Q.radiusAxisMap,ve=Q.angleAxisMap,le=zd(ae),fe=zd(ve),re=fe.cx,he=fe.cy,J=fe.innerRadius,ue=fe.outerRadius;return z.cloneElement($,{polarAngles:Array.isArray(ee)?ee:jl(fe,!0).map(function(Ee){return Ee.coordinate}),polarRadius:Array.isArray(ce)?ce:jl(le,!0).map(function(Ee){return Ee.coordinate}),cx:re,cy:he,innerRadius:J,outerRadius:ue,key:$.key||"polar-grid",radialLines:X})}),qt(G,"renderLegend",function(){var $=G.state.formattedGraphicalItems,q=G.props,X=q.children,ee=q.width,ce=q.height,Q=G.props.margin||{},ae=ee-(Q.left||0)-(Q.right||0),ve=xte({children:X,formattedGraphicalItems:$,legendWidth:ae,legendContent:_});if(!ve)return null;var le=ve.item,fe=lq(ve,F9e);return z.cloneElement(le,$e($e({},fe),{},{chartWidth:ee,chartHeight:ce,margin:Q,onBBoxUpdate:G.handleLegendBBoxUpdate}))}),qt(G,"renderTooltip",function(){var $,q=G.props,X=q.children,ee=q.accessibilityLayer,ce=Ra(X,ea);if(!ce)return null;var Q=G.state,ae=Q.isTooltipActive,ve=Q.activeCoordinate,le=Q.activePayload,fe=Q.activeLabel,re=Q.offset,he=($=ce.props.active)!==null&&$!==void 0?$:ae;return z.cloneElement(ce,{viewBox:$e($e({},re),{},{x:re.left,y:re.top}),active:he,label:fe,payload:he?le:[],coordinate:ve,accessibilityLayer:ee})}),qt(G,"renderBrush",function($){var q=G.props,X=q.margin,ee=q.data,ce=G.state,Q=ce.offset,ae=ce.dataStartIndex,ve=ce.dataEndIndex,le=ce.updateId;return z.cloneElement($,{key:$.key||"_recharts-brush",onChange:YE(G.handleBrushChange,$.props.onChange),data:ee,x:pt($.props.x)?$.props.x:Q.left,y:pt($.props.y)?$.props.y:Q.top+Q.height+Q.brushBottom-(X.bottom||0),width:pt($.props.width)?$.props.width:Q.width,startIndex:ae,endIndex:ve,updateId:"brush-".concat(le)})}),qt(G,"renderReferenceElement",function($,q,X){if(!$)return null;var ee=G,ce=ee.clipPathId,Q=G.state,ae=Q.xAxisMap,ve=Q.yAxisMap,le=Q.offset,fe=$.type.defaultProps||{},re=$.props,he=re.xAxisId,J=he===void 0?fe.xAxisId:he,ue=re.yAxisId,Ee=ue===void 0?fe.yAxisId:ue;return z.cloneElement($,{key:$.key||"".concat(q,"-").concat(X),xAxis:ae[J],yAxis:ve[Ee],viewBox:{x:le.left,y:le.top,width:le.width,height:le.height},clipPathId:ce})}),qt(G,"renderActivePoints",function($){var q=$.item,X=$.activePoint,ee=$.basePoint,ce=$.childIndex,Q=$.isRange,ae=[],ve=q.props.key,le=q.item.type.defaultProps!==void 0?$e($e({},q.item.type.defaultProps),q.item.props):q.item.props,fe=le.activeDot,re=le.dataKey,he=$e($e({index:ce,dataKey:re,cx:X.x,cy:X.y,r:4,fill:HD(q.item),strokeWidth:2,stroke:"#fff",payload:X.payload,value:X.value},bn(fe,!1)),Zw(fe));return ae.push(M.renderActiveDot(fe,he,"".concat(ve,"-activePoint-").concat(ce))),ee?ae.push(M.renderActiveDot(fe,$e($e({},he),{},{cx:ee.x,cy:ee.y}),"".concat(ve,"-basePoint-").concat(ce))):Q&&ae.push(null),ae}),qt(G,"renderGraphicChild",function($,q,X){var ee=G.filterFormatItem($,q,X);if(!ee)return null;var ce=G.getTooltipEventType(),Q=G.state,ae=Q.isTooltipActive,ve=Q.tooltipAxis,le=Q.activeTooltipIndex,fe=Q.activeLabel,re=G.props.children,he=Ra(re,ea),J=ee.props,ue=J.points,Ee=J.isRange,Fe=J.baseLine,ke=ee.item.type.defaultProps!==void 0?$e($e({},ee.item.type.defaultProps),ee.item.props):ee.item.props,Ge=ke.activeDot,De=ke.hide,Pe=ke.activeBar,Ve=ke.activeShape,it=!!(!De&&ae&&he&&(Ge||Pe||Ve)),Mt={};ce!=="axis"&&he&&he.props.trigger==="click"?Mt={onClick:YE(G.handleItemMouseEnter,$.props.onClick)}:ce!=="axis"&&(Mt={onMouseLeave:YE(G.handleItemMouseLeave,$.props.onMouseLeave),onMouseEnter:YE(G.handleItemMouseEnter,$.props.onMouseEnter)});var tt=z.cloneElement($,$e($e({},ee.props),Mt));function ft(os){return typeof ve.dataKey=="function"?ve.dataKey(os.payload):null}if(it)if(le>=0){var Rt,Te;if(ve.dataKey&&!ve.allowDuplicatedCategory){var st=typeof ve.dataKey=="function"?ft:"payload.".concat(ve.dataKey.toString());Rt=Qw(ue,st,fe),Te=Ee&&Fe&&Qw(Fe,st,fe)}else Rt=ue==null?void 0:ue[le],Te=Ee&&Fe&&Fe[le];if(Ve||Pe){var ct=$.props.activeIndex!==void 0?$.props.activeIndex:le;return[z.cloneElement($,$e($e($e({},ee.props),Mt),{},{activeIndex:ct})),null,null]}if(!En(Rt))return[tt].concat(rg(G.renderActivePoints({item:ee,activePoint:Rt,basePoint:Te,childIndex:le,isRange:Ee})))}else{var zt,Ke=(zt=G.getItemByXY(G.state.activeCoordinate))!==null&&zt!==void 0?zt:{graphicalItem:tt},xe=Ke.graphicalItem,Je=xe.item,yt=Je===void 0?$:Je,Yn=xe.childIndex,Jr=$e($e($e({},ee.props),Mt),{},{activeIndex:Yn});return[z.cloneElement(yt,Jr),null,null]}return Ee?[tt,null,null]:[tt,null]}),qt(G,"renderCustomized",function($,q,X){return z.cloneElement($,$e($e({key:"recharts-customized-".concat(X)},G.props),G.state))}),qt(G,"renderMap",{CartesianGrid:{handler:ZE,once:!0},ReferenceArea:{handler:G.renderReferenceElement},ReferenceLine:{handler:ZE},ReferenceDot:{handler:G.renderReferenceElement},XAxis:{handler:ZE},YAxis:{handler:ZE},Brush:{handler:G.renderBrush,once:!0},Bar:{handler:G.renderGraphicChild},Line:{handler:G.renderGraphicChild},Area:{handler:G.renderGraphicChild},Radar:{handler:G.renderGraphicChild},RadialBar:{handler:G.renderGraphicChild},Scatter:{handler:G.renderGraphicChild},Pie:{handler:G.renderGraphicChild},Funnel:{handler:G.renderGraphicChild},Tooltip:{handler:G.renderCursor,once:!0},PolarGrid:{handler:G.renderPolarGrid,once:!0},PolarAngleAxis:{handler:G.renderPolarAxis},PolarRadiusAxis:{handler:G.renderPolarAxis},Customized:{handler:G.renderCustomized}}),G.clipPathId="".concat((U=D.id)!==null&&U!==void 0?U:Eg("recharts"),"-clip"),G.throttleTriggeredAfterMouseMove=bee(G.triggeredAfterMouseMove,(B=D.throttleDelay)!==null&&B!==void 0?B:1e3/60),G.state={},G}return J9e(M,P),K9e(M,[{key:"componentDidMount",value:function(){var U,B;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(U=this.props.margin.left)!==null&&U!==void 0?U:0,top:(B=this.props.margin.top)!==null&&B!==void 0?B:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var U=this.props,B=U.children,G=U.data,$=U.height,q=U.layout,X=Ra(B,ea);if(X){var ee=X.props.defaultIndex;if(!(typeof ee!="number"||ee<0||ee>this.state.tooltipTicks.length-1)){var ce=this.state.tooltipTicks[ee]&&this.state.tooltipTicks[ee].value,Q=Dk(this.state,G,ee,ce),ae=this.state.tooltipTicks[ee].coordinate,ve=(this.state.offset.top+$)/2,le=q==="horizontal",fe=le?{x:ae,y:ve}:{y:ae,x:ve},re=this.state.formattedGraphicalItems.find(function(J){var ue=J.item;return ue.type.name==="Scatter"});re&&(fe=$e($e({},fe),re.props.points[ee].tooltipPosition),Q=re.props.points[ee].tooltipPayload);var he={activeTooltipIndex:ee,isTooltipActive:!0,activeLabel:ce,activePayload:Q,activeCoordinate:fe};this.setState(he),this.renderCursor(X),this.accessibilityManager.setIndex(ee)}}}},{key:"getSnapshotBeforeUpdate",value:function(U,B){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==B.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==U.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==U.margin){var G,$;this.accessibilityManager.setDetails({offset:{left:(G=this.props.margin.left)!==null&&G!==void 0?G:0,top:($=this.props.margin.top)!==null&&$!==void 0?$:0}})}return null}},{key:"componentDidUpdate",value:function(U){pP([Ra(U.children,ea)],[Ra(this.props.children,ea)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var U=Ra(this.props.children,ea);if(U&&typeof U.props.shared=="boolean"){var B=U.props.shared?"axis":"item";return v.indexOf(B)>=0?B:h}return h}},{key:"getMouseInfo",value:function(U){if(!this.container)return null;var B=this.container,G=B.getBoundingClientRect(),$=D4e(G),q={chartX:Math.round(U.pageX-$.left),chartY:Math.round(U.pageY-$.top)},X=G.width/B.offsetWidth||1,ee=this.inRange(q.chartX,q.chartY,X);if(!ee)return null;var ce=this.state,Q=ce.xAxisMap,ae=ce.yAxisMap,ve=this.getTooltipEventType(),le=uq(this.state,this.props.data,this.props.layout,ee);if(ve!=="axis"&&Q&&ae){var fe=zd(Q).scale,re=zd(ae).scale,he=fe&&fe.invert?fe.invert(q.chartX):null,J=re&&re.invert?re.invert(q.chartY):null;return $e($e({},q),{},{xValue:he,yValue:J},le)}return le?$e($e({},q),le):null}},{key:"inRange",value:function(U,B){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,$=this.props.layout,q=U/G,X=B/G;if($==="horizontal"||$==="vertical"){var ee=this.state.offset,ce=q>=ee.left&&q<=ee.left+ee.width&&X>=ee.top&&X<=ee.top+ee.height;return ce?{x:q,y:X}:null}var Q=this.state,ae=Q.angleAxisMap,ve=Q.radiusAxisMap;if(ae&&ve){var le=zd(ae);return $K({x:q,y:X},le)}return null}},{key:"parseEventsOfWrapper",value:function(){var U=this.props.children,B=this.getTooltipEventType(),G=Ra(U,ea),$={};G&&B==="axis"&&(G.props.trigger==="click"?$={onClick:this.handleClick}:$={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var q=Zw(this.props,this.handleOuterEvent);return $e($e({},q),$)}},{key:"addListener",value:function(){VO.on(BO,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){VO.removeListener(BO,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(U,B,G){for(var $=this.state.formattedGraphicalItems,q=0,X=$.length;q<X;q++){var ee=$[q];if(ee.item===U||ee.props.key===U.key||B===Ul(ee.item.type)&&G===ee.childIndex)return ee}return null}},{key:"renderClipPath",value:function(){var U=this.clipPathId,B=this.state.offset,G=B.left,$=B.top,q=B.height,X=B.width;return ye.createElement("defs",null,ye.createElement("clipPath",{id:U},ye.createElement("rect",{x:G,y:$,height:q,width:X})))}},{key:"getXScales",value:function(){var U=this.state.xAxisMap;return U?Object.entries(U).reduce(function(B,G){var $=cq(G,2),q=$[0],X=$[1];return $e($e({},B),{},qt({},q,X.scale))},{}):null}},{key:"getYScales",value:function(){var U=this.state.yAxisMap;return U?Object.entries(U).reduce(function(B,G){var $=cq(G,2),q=$[0],X=$[1];return $e($e({},B),{},qt({},q,X.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(U){var B;return(B=this.state.xAxisMap)===null||B===void 0||(B=B[U])===null||B===void 0?void 0:B.scale}},{key:"getYScaleByAxisId",value:function(U){var B;return(B=this.state.yAxisMap)===null||B===void 0||(B=B[U])===null||B===void 0?void 0:B.scale}},{key:"getItemByXY",value:function(U){var B=this.state,G=B.formattedGraphicalItems,$=B.activeItem;if(G&&G.length)for(var q=0,X=G.length;q<X;q++){var ee=G[q],ce=ee.props,Q=ee.item,ae=Q.type.defaultProps!==void 0?$e($e({},Q.type.defaultProps),Q.props):Q.props,ve=Ul(Q.type);if(ve==="Bar"){var le=(ce.data||[]).find(function(J){return yWe(U,J)});if(le)return{graphicalItem:ee,payload:le}}else if(ve==="RadialBar"){var fe=(ce.data||[]).find(function(J){return $K(U,J)});if(fe)return{graphicalItem:ee,payload:fe}}else if(aN(ee,$)||oN(ee,$)||$y(ee,$)){var re=_$e({graphicalItem:ee,activeTooltipItem:$,itemData:ae.data}),he=ae.activeIndex===void 0?re:ae.activeIndex;return{graphicalItem:$e($e({},ee),{},{childIndex:he}),payload:$y(ee,$)?ae.data[re]:ee.props.data[re]}}}return null}},{key:"render",value:function(){var U=this;if(!DH(this))return null;var B=this.props,G=B.children,$=B.className,q=B.width,X=B.height,ee=B.style,ce=B.compact,Q=B.title,ae=B.desc,ve=lq(B,V9e),le=bn(ve,!1);if(ce)return ye.createElement(GY,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ye.createElement(fP,cf({},le,{width:q,height:X,title:Q,desc:ae}),this.renderClipPath(),MH(G,this.renderMap)));if(this.props.accessibilityLayer){var fe,re;le.tabIndex=(fe=this.props.tabIndex)!==null&&fe!==void 0?fe:0,le.role=(re=this.props.role)!==null&&re!==void 0?re:"application",le.onKeyDown=function(J){U.accessibilityManager.keyboardEvent(J)},le.onFocus=function(){U.accessibilityManager.focus()}}var he=this.parseEventsOfWrapper();return ye.createElement(GY,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ye.createElement("div",cf({className:In("recharts-wrapper",$),style:$e({position:"relative",cursor:"default",width:q,height:X},ee)},he,{ref:function(ue){U.container=ue}}),ye.createElement(fP,cf({},le,{width:q,height:X,title:Q,desc:ae,style:rKe}),this.renderClipPath(),MH(G,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(z.Component);qt(R,"displayName",s),qt(R,"defaultProps",$e({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},E)),qt(R,"getDerivedStateFromProps",function(P,M){var D=P.dataKey,U=P.data,B=P.children,G=P.width,$=P.height,q=P.layout,X=P.stackOffset,ee=P.margin,ce=M.dataStartIndex,Q=M.dataEndIndex;if(M.updateId===void 0){var ae=hq(P);return $e($e($e({},ae),{},{updateId:0},I($e($e({props:P},ae),{},{updateId:0}),M)),{},{prevDataKey:D,prevData:U,prevWidth:G,prevHeight:$,prevLayout:q,prevStackOffset:X,prevMargin:ee,prevChildren:B})}if(D!==M.prevDataKey||U!==M.prevData||G!==M.prevWidth||$!==M.prevHeight||q!==M.prevLayout||X!==M.prevStackOffset||!gf(ee,M.prevMargin)){var ve=hq(P),le={chartX:M.chartX,chartY:M.chartY,isTooltipActive:M.isTooltipActive},fe=$e($e({},uq(M,U,q)),{},{updateId:M.updateId+1}),re=$e($e($e({},ve),le),fe);return $e($e($e({},re),I($e({props:P},re),M)),{},{prevDataKey:D,prevData:U,prevWidth:G,prevHeight:$,prevLayout:q,prevStackOffset:X,prevMargin:ee,prevChildren:B})}if(!pP(B,M.prevChildren)){var he,J,ue,Ee,Fe=Ra(B,zf),ke=Fe&&(he=(J=Fe.props)===null||J===void 0?void 0:J.startIndex)!==null&&he!==void 0?he:ce,Ge=Fe&&(ue=(Ee=Fe.props)===null||Ee===void 0?void 0:Ee.endIndex)!==null&&ue!==void 0?ue:Q,De=ke!==ce||Ge!==Q,Pe=!En(U),Ve=Pe&&!De?M.updateId:M.updateId+1;return $e($e({updateId:Ve},I($e($e({props:P},M),{},{updateId:Ve,dataStartIndex:ke,dataEndIndex:Ge}),M)),{},{prevChildren:B,dataStartIndex:ke,dataEndIndex:Ge})}return null}),qt(R,"renderActiveDot",function(P,M,D){var U;return z.isValidElement(P)?U=z.cloneElement(P,M):mn(P)?U=P(M):U=ye.createElement(sN,M),ye.createElement(xr,{className:"recharts-active-dot",key:D},U)});var O=z.forwardRef(function(M,D){return ye.createElement(R,cf({},M,{ref:D}))});return O.displayName=R.displayName,O},Mne=Lne({chartName:"LineChart",GraphicalChild:Ig,axisComponents:[{axisType:"xAxis",AxisComp:Xl},{axisType:"yAxis",AxisComp:Jl}],formatAxisMap:Xte}),rL=Lne({chartName:"AreaChart",GraphicalChild:sl,axisComponents:[{axisType:"xAxis",AxisComp:Xl},{axisType:"yAxis",AxisComp:Jl}],formatAxisMap:Xte});const pKe=({reports:e,selectedReport:n,onSelect:s})=>{const[o,d]=z.useState(!1),h=z.useRef(null);z.useEffect(()=>{const _=w=>{h.current&&!h.current.contains(w.target)&&d(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]);const f=e==null?void 0:e.find(_=>_._id===n),v=_=>{const w=_.reportDate||_.createdAt;return new Date(w).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"})},b=f?`${f.reportType} - ${v(f)}`:"Select Report";return c.jsxs("div",{className:"relative inline-block z-10",ref:h,children:[c.jsxs("button",{onClick:()=>d(!o),className:"px-3 sm:px-4 py-2 bg-white rounded-lg text-xs sm:text-sm font-medium cursor-pointer transition-all shadow-sm hover:shadow-md flex items-center gap-2",style:{borderColor:"#8B7355",border:"2px solid #8B7355",color:"#8B7355"},children:[c.jsx(Vn,{className:"w-4 h-4"}),c.jsx("span",{className:"hidden sm:inline",children:b}),c.jsx("span",{className:"sm:hidden",children:f?f.reportType:"Report"}),c.jsx(mu,{className:`w-4 h-4 transition-transform ${o?"rotate-180":""}`,style:{color:"#8B7355"}})]}),o&&c.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-lg shadow-lg border-2 overflow-hidden",style:{borderColor:"#8B7355"},children:[c.jsx("button",{onClick:()=>{s(null),d(!1)},className:"w-full px-4 py-2.5 text-left text-xs sm:text-sm font-medium transition-colors hover:bg-slate-50",style:{color:n===null?"#8B7355":"#64748b",backgroundColor:n===null?"#F5F1EA":"transparent",borderBottom:"1px solid #e2e8f0"},children:"Select Report"}),e&&e.length>0?e.map(_=>c.jsx("button",{onClick:()=>{s(_._id),d(!1)},className:"w-full px-4 py-2.5 text-left text-xs sm:text-sm transition-colors hover:bg-slate-50 border-b border-slate-100 last:border-b-0",style:{color:n===_._id?"#8B7355":"#64748b",backgroundColor:n===_._id?"#F5F1EA":"transparent",fontWeight:n===_._id?"600":"500"},children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{children:_.reportType}),c.jsx("span",{className:"text-slate-400 text-xs",children:v(_)})]})},_._id)):c.jsx("div",{className:"px-4 py-3 text-center text-slate-500 text-xs sm:text-sm",children:"No reports available"})]})]})},Une={vitaminD:{name:"Vitamin D",icon:qj,color:"amber",unit:"ng/mL",normalRange:"30-100",lowExplanation:"When Vitamin D is low, you may feel tired all the time, have weak bones that break easily, feel sad or depressed, get sick often, and have muscle pain. Your body needs sunlight and certain foods to make Vitamin D.",tips:["Get 15-20 minutes of sunlight daily","Eat eggs, fish, and fortified milk","Consider supplements if advised by doctor"]},vitaminB12:{name:"Vitamin B12",icon:xo,color:"red",unit:"pg/mL",normalRange:"300-900",lowExplanation:"Low Vitamin B12 makes you feel very tired and weak. You might feel dizzy, have trouble thinking clearly, feel numbness in hands or feet, and look pale. Your body needs B12 to make healthy blood cells.",tips:["Eat meat, fish, eggs, and dairy","Vegetarians may need supplements","Get tested if you feel constantly tired"]},iron:{name:"Iron",icon:Qh,color:"rose",unit:"mcg/dL",normalRange:"60-170",lowExplanation:"Low iron means your blood cannot carry enough oxygen. You will feel very tired, look pale, feel short of breath, have cold hands and feet, and may have headaches. Women often have low iron.",tips:["Eat red meat, spinach, and beans","Take iron with Vitamin C for better absorption","Avoid tea/coffee with iron-rich meals"]},hemoglobin:{name:"Hemoglobin",icon:zn,color:"red",unit:"g/dL",normalRange:"12-17",lowExplanation:"Low hemoglobin means anemia - your blood cannot carry enough oxygen to your body. You will feel extremely tired, weak, dizzy, and may have pale skin. Your heart has to work harder.",tips:["Eat iron-rich foods","Include Vitamin C in your diet","See a doctor if symptoms persist"]},calcium:{name:"Calcium",icon:bNe,color:"slate",unit:"mg/dL",normalRange:"8.5-10.5",lowExplanation:"Low calcium weakens your bones and teeth. You may have muscle cramps, numbness in fingers, brittle nails, and bones that break easily. Long-term low calcium can cause osteoporosis.",tips:["Drink milk and eat dairy products","Eat leafy green vegetables","Get enough Vitamin D for calcium absorption"]},vitaminC:{name:"Vitamin C",icon:my,color:"orange",unit:"mg/dL",normalRange:"0.6-2.0",lowExplanation:"Low Vitamin C means your body cannot heal wounds properly. You may have bleeding gums, bruise easily, feel tired, have dry skin, and get sick often. Your immune system becomes weak.",tips:["Eat citrus fruits like oranges and lemons","Include tomatoes and bell peppers","Eat fresh fruits and vegetables daily"]},cholesterol:{name:"Cholesterol",icon:jn,color:"yellow",unit:"mg/dL",normalRange:"<200",lowExplanation:"While high cholesterol is usually the concern, very low cholesterol can affect hormone production and brain function. However, most people need to focus on keeping cholesterol in healthy range.",tips:["Limit fried and fatty foods","Exercise regularly","Eat more fiber and vegetables"]},bloodSugar:{name:"Blood Sugar",icon:ka,color:"purple",unit:"mg/dL",normalRange:"70-100",lowExplanation:"Low blood sugar (hypoglycemia) makes you feel shaky, sweaty, confused, and very hungry. You may feel dizzy or faint. High blood sugar over time can lead to diabetes and damage organs.",tips:["Eat regular meals","Limit sugary foods and drinks","Exercise helps control blood sugar"]},thyroid:{name:"Thyroid (TSH)",icon:jh,color:"indigo",unit:"mIU/L",normalRange:"0.4-4.0",lowExplanation:"Thyroid problems affect your energy and weight. Low thyroid makes you tired, gain weight, feel cold, and have dry skin. High thyroid makes you anxious, lose weight, and feel hot.",tips:["Get thyroid checked if you have unexplained weight changes","Iodine in salt helps thyroid function","Take thyroid medicine as prescribed"]},heartRate:{name:"Heart Rate",icon:zn,color:"red",unit:"bpm",normalRange:"60-100",lowExplanation:"Very low heart rate can mean your heart is not pumping enough blood. You may feel dizzy, tired, or faint. Athletes often have lower heart rates which is normal for them.",tips:["Regular exercise strengthens your heart","Reduce stress and anxiety","Limit caffeine and alcohol"]},sleep:{name:"Sleep",icon:hg,color:"indigo",unit:"hours",normalRange:"7-9",lowExplanation:"Not enough sleep makes you tired, irritable, and unable to think clearly. Long-term poor sleep increases risk of heart disease, diabetes, and weight gain. Your body heals during sleep.",tips:["Sleep 7-9 hours every night","Keep a regular sleep schedule","Avoid screens before bedtime"]},steps:{name:"Daily Steps",icon:jQ,color:"cyan",unit:"steps",normalRange:"8,000-10,000",lowExplanation:"Not walking enough means less exercise for your body. This can lead to weight gain, weak muscles, poor heart health, and low energy. Walking is the easiest exercise for everyone.",tips:["Aim for 8,000-10,000 steps daily","Take stairs instead of elevator","Walk after meals for better digestion"]}},mKe=({metric:e,onClose:n})=>{if(!e)return null;const s=Une[e];if(!s)return null;const o=s.icon;return c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-end sm:items-center justify-center z-50 p-0 sm:p-4",onClick:n,children:c.jsxs("div",{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[85vh] overflow-y-auto p-5 sm:p-6 relative animate-slide-up sm:animate-fade-in shadow-xl",onClick:d=>d.stopPropagation(),children:[c.jsx("div",{className:"w-12 h-1 bg-slate-300 rounded-full mx-auto mb-4 sm:hidden"}),c.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600 p-1",children:c.jsx(di,{className:"w-5 h-5"})}),c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-${s.color}-100 flex items-center justify-center`,children:c.jsx(o,{className:`w-5 h-5 sm:w-6 sm:h-6 text-${s.color}-500`})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-800",children:s.name}),c.jsxs("p",{className:"text-slate-500 text-xs sm:text-sm",children:["Normal: ",s.normalRange," ",s.unit]})]})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("h4",{className:"text-cyan-600 font-medium mb-2 text-sm sm:text-base",children:"What happens when it's low?"}),c.jsx("p",{className:"text-slate-600 text-xs sm:text-sm leading-relaxed",children:s.lowExplanation})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-emerald-600 font-medium mb-2 text-sm sm:text-base",children:"Simple Tips to Improve"}),c.jsx("ul",{className:"space-y-2",children:s.tips.map((d,h)=>c.jsxs("li",{className:"flex items-start gap-2 text-slate-600 text-xs sm:text-sm",children:[c.jsx("span",{className:"text-emerald-500 mt-0.5",children:""}),d]},h))})]}),c.jsx("button",{onClick:n,className:"w-full mt-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium rounded-xl transition-colors sm:hidden",children:"Got it"})]})})},po=({metricKey:e,value:n,unit:s,status:o,subtitle:d,onInfoClick:h,previousValue:f,allReports:v,isSamePatient:b})=>{const _=Une[e];if(!_)return null;const w=_.icon,N={normal:"emerald",low:"amber",high:"red",critical:"red"}[o]||"slate",I=n!=null&&n!=="";let R=null;if(I&&f!==null&&f!==void 0&&v&&v.length>1&&b){const O=parseFloat(n),P=parseFloat(f);if(!isNaN(O)&&!isNaN(P)&&P!==0){const M=O-P,D=(M/P*100).toFixed(1);let U=!1,B="slate";["vitaminD","vitaminB12","iron","calcium","hemoglobin","vitaminC"].includes(e)?(U=M>0,M>0?B="emerald":M<0&&(B="red")):["cholesterol","bloodSugar","tsh"].includes(e)&&(U=M<0,M<0?B="emerald":M>0&&(B="red")),Math.abs(D)<5&&(B="amber"),R={change:M,percentChange:D,isImprovement:U,color:B}}}return c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm group relative p-3 sm:p-5 hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1 sm:mb-2",children:[c.jsx("span",{className:"text-slate-500 text-xs sm:text-sm truncate pr-2",children:_.name}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 shrink-0",children:[c.jsx("button",{onClick:()=>h(e),className:"w-5 h-5 sm:w-6 sm:h-6 rounded-lg bg-slate-100 flex items-center justify-center opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity hover:bg-slate-200",title:"Learn more",children:c.jsx(Ll,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5 text-cyan-500"})}),c.jsx("div",{className:`w-6 h-6 sm:w-8 sm:h-8 rounded-lg bg-${_.color}-100 flex items-center justify-center`,children:c.jsx(w,{className:`w-3 h-3 sm:w-4 sm:h-4 text-${_.color}-500`})})]})]}),c.jsx("div",{className:"flex items-baseline gap-1 sm:gap-2 flex-wrap",children:I?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"text-xl sm:text-3xl font-bold text-slate-800",children:n}),c.jsx("span",{className:"text-slate-400 text-xs sm:text-sm",children:s||_.unit}),o&&c.jsx("span",{className:`text-${N}-600 text-[10px] sm:text-xs ml-auto px-1.5 sm:px-2 py-0.5 bg-${N}-100 rounded-full`,children:o.toUpperCase()})]}):c.jsx("span",{className:"text-slate-400 text-sm",children:"No data"})}),R&&c.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs sm:text-sm font-medium",children:[c.jsxs("div",{className:`flex items-center gap-0.5 px-2 py-1 rounded-lg bg-${R.color}-100`,children:[R.change>0?c.jsx(Q2,{className:`w-3 h-3 sm:w-4 sm:h-4 text-${R.color}-600`}):c.jsx(CQ,{className:`w-3 h-3 sm:w-4 sm:h-4 text-${R.color}-600`}),c.jsxs("span",{className:`text-${R.color}-600`,children:[R.change>0?"+":"",R.percentChange,"%"]})]}),c.jsx("span",{className:"text-slate-400 text-[10px] sm:text-xs",children:"vs prev"})]}),d&&c.jsx("p",{className:"text-slate-400 text-[10px] sm:text-xs mt-1 sm:mt-2 truncate",children:d})]})};function fKe(){var Ve,it,Mt,tt,ft,Rt,Te,st,ct,zt;const{user:e}=as(),{dashboardData:n,wearableData:s,nutritionData:o,loading:d,fetchDashboard:h,fetchWearable:f,fetchNutrition:v}=rZ(),[b,_]=z.useState(null),[w,E]=z.useState(new Date().toISOString().split("T")[0]),[N,I]=z.useState(null),[R,O]=z.useState(null),[P,M]=z.useState(null);z.useEffect(()=>{(async()=>{var xe,Je;try{O(null),await Promise.all([h(),f()])}catch(yt){console.error("Failed to fetch dashboard:",yt),O(((Je=(xe=yt.response)==null?void 0:xe.data)==null?void 0:Je.message)||"Failed to load dashboard data")}})()},[h,f]),z.useEffect(()=>{n!=null&&n.recentReports&&n.recentReports.length>0&&P===null&&M(n.recentReports[0]._id)},[n==null?void 0:n.recentReports,P]),z.useEffect(()=>{(async()=>{const xe=await v(w);I(xe)})()},[w,v]);const D=d.dashboard||d.wearable,U=n,B=N||o;if(z.useEffect(()=>{var Ke;U&&console.log(" Dashboard Data:",{hasLatestComparison:!!U.latestComparison,latestComparison:U.latestComparison,recentReports:((Ke=U.recentReports)==null?void 0:Ke.length)||0})},[U]),D)return c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-slate-500",children:"Loading your health data..."})]})});if(R)return c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-red-500 mb-4",children:R}),c.jsx("button",{onClick:()=>h(),className:"px-6 py-2 bg-cyan-500 text-white rounded-xl hover:bg-cyan-600",children:"Try Again"})]})});const{user:G,healthScores:$,latestAnalysis:q,recentReports:X}=U||{},ee=X&&X.length>0,ce=P&&X?X.find(Ke=>Ke._id===P):X==null?void 0:X[0],Q=(ce==null?void 0:ce.aiAnalysis)||q,ae=((Ve=G==null?void 0:G.healthMetrics)==null?void 0:Ve.healthScore)||(Q==null?void 0:Q.healthScore)||null,ve=(Q==null?void 0:Q.metrics)||{},le=Ke=>Ke==null?null:typeof Ke=="object"&&Ke.value!==void 0?Ke.value:Ke,fe={vitaminD:le(ve.vitaminD),vitaminB12:le(ve.vitaminB12),iron:le(ve.iron),calcium:le(ve.calcium),hemoglobin:le(ve.hemoglobin),bloodSugar:le(ve.bloodSugar)||le(ve.glucose),tsh:le(ve.tsh)||le(ve.thyroid),vitaminC:le(ve.vitaminC),cholesterol:le(ve.cholesterol)||le(ve.totalCholesterol)},re={};let he=!0;if(X&&X.length>1){const Ke=X[1],xe=(ce==null?void 0:ce.patientName)||(e==null?void 0:e.name)||"",Je=(Ke==null?void 0:Ke.patientName)||"";if(xe&&Je){const yt=xe.toLowerCase().trim(),Yn=Je.toLowerCase().trim();he=yt===Yn,he||console.log(`Patient mismatch: "${xe}" vs "${Je}"`)}if(he){const yt=((it=Ke==null?void 0:Ke.aiAnalysis)==null?void 0:it.metrics)||{};re.vitaminD=le(yt.vitaminD),re.vitaminB12=le(yt.vitaminB12),re.iron=le(yt.iron),re.calcium=le(yt.calcium),re.hemoglobin=le(yt.hemoglobin),re.bloodSugar=le(yt.bloodSugar)||le(yt.glucose),re.tsh=le(yt.tsh)||le(yt.thyroid),re.vitaminC=le(yt.vitaminC),re.cholesterol=le(yt.cholesterol)||le(yt.totalCholesterol)}}const J=(s==null?void 0:s.connected)&&(s==null?void 0:s.todayMetrics),ue=(s==null?void 0:s.todayMetrics)||{steps:0,caloriesBurned:0},Ee=(s==null?void 0:s.recentHeartRate)||[],Fe=(s==null?void 0:s.recentSleep)||[],ke=Ee.length>0?Math.round(Ee.reduce((Ke,xe)=>Ke+xe.bpm,0)/Ee.length):null,Ge=Fe.length>0?(Fe.reduce((Ke,xe)=>Ke+xe.totalSleepMinutes,0)/Fe.length/60).toFixed(1):null,De=($==null?void 0:$.length)>0?$.map(Ke=>({date:new Date(Ke.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),score:Ke.score,type:Ke.type})):[],Pe=(Ke,xe,Je)=>{if(!Ke)return null;const yt=parseFloat(Ke);return yt<xe*.7?"critical":yt<xe?"low":yt>Je*1.3||yt>Je?"high":"normal"};return c.jsxs("div",{className:"space-y-6 animate-fade-in",children:[b&&c.jsx(mKe,{metric:b,onClose:()=>_(null)}),c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsxs("div",{children:[c.jsxs("h1",{className:"text-xl sm:text-3xl font-bold text-slate-800",children:["Welcome back, ",c.jsx("span",{className:"text-cyan-600",children:(Mt=e==null?void 0:e.name)==null?void 0:Mt.split(" ")[0]})]}),c.jsx("p",{className:"text-slate-500 mt-1 text-sm sm:text-base",children:"Your complete health overview. Tap the eye icon to learn more."})]}),c.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[c.jsxs(Ct,{to:"/upload",className:"px-3 sm:px-6 py-2 sm:py-3 bg-white border border-slate-200 text-slate-700 rounded-xl font-medium hover:bg-slate-50 flex items-center gap-1 sm:gap-2 text-xs sm:text-base",children:[c.jsx(Es,{className:"w-3 h-3 sm:w-4 sm:h-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Upload Records"}),c.jsx("span",{className:"sm:hidden",children:"Upload"})]}),c.jsxs("button",{className:"px-3 sm:px-6 py-2 sm:py-3 text-white rounded-xl font-medium hover:shadow-lg flex items-center gap-1 sm:gap-2 text-xs sm:text-base",style:{backgroundColor:"#8B7355"},children:[c.jsx(Qc,{className:"w-3 h-3 sm:w-4 sm:h-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Log Symptoms"}),c.jsx("span",{className:"sm:hidden",children:"Log"})]})]})]}),c.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[ee&&ae?c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-4 sm:p-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 sm:gap-4 mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-800",children:"Health Score"}),c.jsx("p",{className:"text-slate-500 text-xs sm:text-sm",children:"Your overall health progress"})]}),c.jsxs("div",{className:"flex flex-col items-end gap-1",children:[c.jsxs("div",{className:"flex items-baseline gap-2",children:[c.jsx("span",{className:"text-2xl sm:text-4xl font-bold text-slate-800",children:ae}),c.jsx("span",{className:"text-slate-400 text-sm",children:"/100"})]}),De.length>1&&(()=>{const Ke=De[De.length-1].score,xe=De[De.length-2].score,Je=Ke-xe,yt=Je>0,Yn=Je===0;return c.jsx("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-bold ${yt?"bg-green-100 text-green-700":Yn?"bg-blue-100 text-blue-700":"bg-red-100 text-red-700"}`,children:yt?c.jsxs(c.Fragment,{children:[c.jsx(Q2,{className:"w-3 h-3"}),c.jsxs("span",{children:["+",Je]})]}):Yn?c.jsxs(c.Fragment,{children:[c.jsx(ff,{className:"w-3 h-3"}),c.jsx("span",{children:"Stable"})]}):c.jsxs(c.Fragment,{children:[c.jsx(CQ,{className:"w-3 h-3"}),c.jsx("span",{children:Je})]})})})()]})]}),De.length>0&&c.jsx(xy,{width:"100%",height:140,children:c.jsxs(rL,{data:De,children:[c.jsx("defs",{children:c.jsxs("linearGradient",{id:"scoreGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[c.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),c.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})}),c.jsx(Jf,{strokeDasharray:"3 3",stroke:"#e2e8f0",vertical:!1}),c.jsx(Xl,{dataKey:"date",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),c.jsx(Jl,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1,domain:[50,100],hide:!0}),c.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"12px"},labelStyle:{color:"#64748b"},formatter:Ke=>[`${Ke}/100`,"Score"]}),c.jsx(sl,{type:"monotone",dataKey:"score",stroke:"#10b981",strokeWidth:2,fill:"url(#scoreGradient)"})]})})]}):c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-8 text-center",children:[c.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:c.jsx(Or,{className:"w-8 h-8 text-slate-400"})}),c.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"No Health Data Yet"}),c.jsx("p",{className:"text-slate-500 mb-4",children:"Upload your first health report to see your personalized health score and track your progress over time."}),c.jsxs(Ct,{to:"/upload",className:"inline-flex items-center gap-2 px-6 py-3 text-white rounded-xl font-medium hover:shadow-lg transition-all",style:{backgroundColor:"#8B7355"},children:[c.jsx(Es,{className:"w-4 h-4"}),"Upload Your First Report"]})]}),(U==null?void 0:U.latestComparison)&&c.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl border-2 border-purple-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center",children:c.jsx(Wh,{className:"w-5 h-5 text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-bold text-purple-900",children:"AI Health Insights"}),c.jsx("p",{className:"text-purple-700 text-xs",children:"Compared with your previous report"})]})]}),c.jsx("div",{className:"mb-4 p-3 bg-white/60 rounded-lg",children:c.jsx("p",{className:"text-sm text-purple-900 leading-relaxed",children:U.latestComparison.summary})}),U.latestComparison.improvements&&U.latestComparison.improvements.length>0&&c.jsxs("div",{className:"mb-3",children:[c.jsxs("h4",{className:"text-sm font-bold text-green-900 mb-2 flex items-center gap-1",children:[c.jsx(Or,{className:"w-4 h-4"}),"What's Improved"]}),c.jsx("div",{className:"space-y-1",children:U.latestComparison.improvements.slice(0,2).map((Ke,xe)=>c.jsxs("div",{className:"text-xs text-green-800 flex items-start gap-2 bg-green-50 p-2 rounded",children:[c.jsx("span",{className:"text-green-600 mt-0.5",children:""}),c.jsx("span",{children:Ke})]},xe))})]}),U.latestComparison.concerns&&U.latestComparison.concerns.length>0&&c.jsxs("div",{children:[c.jsxs("h4",{className:"text-sm font-bold text-amber-900 mb-2 flex items-center gap-1",children:[c.jsx($d,{className:"w-4 h-4"}),"Areas to Watch"]}),c.jsx("div",{className:"space-y-1",children:U.latestComparison.concerns.slice(0,2).map((Ke,xe)=>c.jsxs("div",{className:"text-xs text-amber-800 flex items-start gap-2 bg-amber-50 p-2 rounded",children:[c.jsx("span",{className:"text-amber-600 mt-0.5",children:"!"}),c.jsx("span",{children:Ke})]},xe))})]})]}),U!=null&&U.latestComparison?c.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-2xl border-2 border-cyan-200 p-6 shadow-lg",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"w-12 h-12 bg-cyan-500 rounded-full flex items-center justify-center",children:c.jsx(Or,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold text-cyan-900",children:"Health Progress Report"}),c.jsxs("p",{className:"text-cyan-700 text-sm",children:["Compared with ",new Date(U.latestComparison.previousReportDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]})]}),c.jsxs("div",{className:`p-4 rounded-xl mb-4 ${U.latestComparison.overallTrend==="improved"?"bg-green-100 border-2 border-green-300":U.latestComparison.overallTrend==="declined"?"bg-red-100 border-2 border-red-300":"bg-blue-100 border-2 border-blue-300"}`,children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[U.latestComparison.overallTrend==="improved"?c.jsx(rr,{className:"w-5 h-5 text-green-700"}):U.latestComparison.overallTrend==="declined"?c.jsx($d,{className:"w-5 h-5 text-red-700"}):c.jsx(ff,{className:"w-5 h-5 text-blue-700"}),c.jsx("span",{className:`font-bold text-lg ${U.latestComparison.overallTrend==="improved"?"text-green-900":U.latestComparison.overallTrend==="declined"?"text-red-900":"text-blue-900"}`,children:U.latestComparison.overallTrend==="improved"?" Health Improved!":U.latestComparison.overallTrend==="declined"?" Needs Attention":" Stable Progress"})]}),c.jsx("p",{className:`text-sm ${U.latestComparison.overallTrend==="improved"?"text-green-800":U.latestComparison.overallTrend==="declined"?"text-red-800":"text-blue-800"}`,children:U.latestComparison.summary})]}),U.latestComparison.improvements&&U.latestComparison.improvements.length>0&&c.jsxs("div",{className:"mb-4",children:[c.jsxs("h4",{className:"font-bold text-green-900 mb-2 flex items-center gap-2",children:[c.jsx(rr,{className:"w-4 h-4"}),"Improvements"]}),c.jsx("ul",{className:"space-y-1",children:U.latestComparison.improvements.slice(0,3).map((Ke,xe)=>c.jsxs("li",{className:"text-sm text-green-800 flex items-start gap-2",children:[c.jsx("span",{className:"text-green-600 mt-0.5",children:""}),Ke]},xe))})]}),U.latestComparison.concerns&&U.latestComparison.concerns.length>0&&c.jsxs("div",{className:"mb-4",children:[c.jsxs("h4",{className:"font-bold text-red-900 mb-2 flex items-center gap-2",children:[c.jsx($d,{className:"w-4 h-4"}),"Areas to Focus"]}),c.jsx("ul",{className:"space-y-1",children:U.latestComparison.concerns.slice(0,3).map((Ke,xe)=>c.jsxs("li",{className:"text-sm text-red-800 flex items-start gap-2",children:[c.jsx("span",{className:"text-red-600 mt-0.5",children:"!"}),Ke]},xe))})]}),U.latestComparison.recommendations&&U.latestComparison.recommendations.length>0&&c.jsxs("div",{className:"p-3 bg-white rounded-lg border border-cyan-200",children:[c.jsx("h4",{className:"font-bold text-cyan-900 mb-2 text-sm",children:" Recommendations"}),c.jsx("ul",{className:"space-y-1",children:U.latestComparison.recommendations.slice(0,2).map((Ke,xe)=>c.jsxs("li",{className:"text-xs text-cyan-800",children:[" ",Ke]},xe))})]})]}):X&&X.length>1&&c.jsxs("div",{className:"bg-amber-50 rounded-2xl border-2 border-amber-200 p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx($d,{className:"w-6 h-6 text-amber-600"}),c.jsx("h3",{className:"text-lg font-bold text-amber-900",children:"Comparison Not Available"})]}),c.jsxs("p",{className:"text-amber-800 text-sm mb-3",children:["You have ",X.length," reports, but comparison data is not available yet."]}),c.jsx("p",{className:"text-amber-700 text-xs",children:"Upload a new report to generate automatic comparison with your previous report."})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-4 sm:p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-4",children:c.jsxs("div",{children:[c.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-slate-800 flex items-center gap-2",children:[c.jsx(fu,{className:"w-5 h-5 text-emerald-500"}),"Nutrition Tracker"]}),c.jsx("p",{className:"text-slate-500 text-xs sm:text-sm",children:"Daily calorie and macro tracking"})]})}),c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx("input",{type:"text",value:w?new Date(w+"T00:00:00").toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"}):"",onChange:Ke=>{const Je=Ke.target.value.split("/");if(Je.length===3){const yt=Je[0],Yn=Je[1];let Jr=Je[2];Jr.length===2&&(Jr=(parseInt(Jr)>30?"19":"20")+Jr);const os=`${Jr}-${Yn}-${yt}`;E(os)}},placeholder:"DD/MM/YY",className:"flex-1 px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500",maxLength:"8"}),c.jsx("button",{onClick:()=>E(new Date().toISOString().split("T")[0]),className:"px-3 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition-colors",children:"Today"})]}),B?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-sm text-slate-600",children:"Calories"}),c.jsxs("span",{className:"text-sm font-semibold text-slate-800",children:[B.totalCalories||0," / ",B.calorieGoal||1800]})]}),c.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2",children:c.jsx("div",{className:"h-2 rounded-full transition-all",style:{width:`${Math.min((B.totalCalories||0)/(B.calorieGoal||1800)*100,100)}%`,backgroundColor:"#8B7355"}})}),!B.calorieGoal&&c.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[c.jsx(Ct,{to:"/profile",className:"underline",children:"Set your fitness goal"})," for personalized targets"]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[c.jsxs("div",{className:"bg-blue-50 rounded-xl p-3",children:[c.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[c.jsx(Ml,{className:"w-3 h-3 text-blue-500"}),c.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"Protein"})]}),c.jsxs("p",{className:"text-lg font-bold text-blue-700",children:[(B.totalProtein||0).toFixed(2),"g"]}),c.jsx("div",{className:"w-full bg-blue-200 rounded-full h-1 mt-2",children:c.jsx("div",{className:"bg-blue-500 h-1 rounded-full",style:{width:`${Math.min((B.totalProtein||0)/(B.proteinGoal||80)*100,100)}%`}})})]}),c.jsxs("div",{className:"bg-amber-50 rounded-xl p-3",children:[c.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[c.jsx(Ml,{className:"w-3 h-3 text-amber-500"}),c.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"Carbs"})]}),c.jsxs("p",{className:"text-lg font-bold text-amber-700",children:[(B.totalCarbs||0).toFixed(2),"g"]}),c.jsx("div",{className:"w-full bg-amber-200 rounded-full h-1 mt-2",children:c.jsx("div",{className:"bg-amber-500 h-1 rounded-full",style:{width:`${Math.min((B.totalCarbs||0)/(B.carbsGoal||200)*100,100)}%`}})})]}),c.jsxs("div",{className:"bg-rose-50 rounded-xl p-3",children:[c.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[c.jsx(Ml,{className:"w-3 h-3 text-rose-500"}),c.jsx("span",{className:"text-xs text-rose-600 font-medium",children:"Fats"})]}),c.jsxs("p",{className:"text-lg font-bold text-rose-700",children:[(B.totalFats||0).toFixed(2),"g"]}),c.jsx("div",{className:"w-full bg-rose-200 rounded-full h-1 mt-2",children:c.jsx("div",{className:"bg-rose-500 h-1 rounded-full",style:{width:`${Math.min((B.totalFats||0)/(B.fatsGoal||50)*100,100)}%`}})})]})]}),c.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-slate-100",children:[c.jsx("span",{className:"text-sm text-slate-600",children:"Meals logged today"}),c.jsx("span",{className:"text-sm font-semibold text-slate-800",children:((tt=B.mealsLogged)!=null&&tt.breakfast?1:0)+((ft=B.mealsLogged)!=null&&ft.lunch?1:0)+((Rt=B.mealsLogged)!=null&&Rt.dinner?1:0)+(((Te=B.mealsLogged)==null?void 0:Te.snacks)||0)})]}),c.jsxs(Ct,{to:"/nutrition",className:"w-full py-2 text-white rounded-xl font-medium hover:shadow-lg flex items-center justify-center gap-2 text-sm transition-all",style:{backgroundColor:"#8B7355"},children:[c.jsx(Qc,{className:"w-4 h-4"}),"Log Meal"]})]}):c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-3",children:c.jsx(fu,{className:"w-6 h-6 text-slate-400"})}),c.jsx("p",{className:"text-slate-500 text-sm mb-4",children:"No meals logged for this day"}),c.jsxs(Ct,{to:"/nutrition",className:"inline-flex items-center gap-2 px-4 py-2 text-white rounded-xl font-medium hover:shadow-lg text-sm transition-all",style:{backgroundColor:"#8B7355"},children:[c.jsx(Qc,{className:"w-4 h-4"}),"Log Your First Meal"]})]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[c.jsxs("h3",{className:"text-sm sm:text-lg font-semibold text-slate-800 flex items-center gap-2",children:[c.jsx(jn,{className:"w-4 h-4 sm:w-5 sm:h-5 text-cyan-500"}),"Vital Signs & Activity"]}),c.jsx(pKe,{reports:X,selectedReport:P,onSelect:M})]}),c.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-4",children:[c.jsx(po,{metricKey:"heartRate",value:ke,status:Pe(ke,60,100),subtitle:J?"From wearable":"Connect device",onInfoClick:_}),c.jsx(po,{metricKey:"sleep",value:Ge,status:Ge?Pe(parseFloat(Ge),7,9):null,subtitle:Fe.length>0?`${Fe.length} nights avg`:"Track sleep",onInfoClick:_}),c.jsx(po,{metricKey:"steps",value:ue.steps>0?ue.steps.toLocaleString():null,unit:"steps",status:ue.steps>=8e3?"normal":ue.steps>=5e3?"low":ue.steps>0?"critical":null,subtitle:J?`${ue.caloriesBurned} cal`:"Today",onInfoClick:_}),c.jsx(po,{metricKey:"cholesterol",value:fe.cholesterol,previousValue:re.cholesterol,allReports:X,isSamePatient:he,status:Pe(fe.cholesterol,0,200),subtitle:"From blood work",onInfoClick:_})]})]}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-sm sm:text-lg font-semibold text-slate-800 mb-2 sm:mb-3 flex items-center gap-2",children:[c.jsx(ka,{className:"w-4 h-4 sm:w-5 sm:h-5 text-amber-500"}),"Vitamins & Minerals"]}),c.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-4",children:[c.jsx(po,{metricKey:"vitaminD",value:fe.vitaminD,previousValue:re.vitaminD,allReports:X,isSamePatient:he,status:Pe(fe.vitaminD,30,100),subtitle:"Bone & immune health",onInfoClick:_}),c.jsx(po,{metricKey:"vitaminB12",value:fe.vitaminB12,previousValue:re.vitaminB12,allReports:X,isSamePatient:he,status:Pe(fe.vitaminB12,300,900),subtitle:"Energy & nerves",onInfoClick:_}),c.jsx(po,{metricKey:"iron",value:fe.iron,previousValue:re.iron,allReports:X,isSamePatient:he,status:Pe(fe.iron,60,170),subtitle:"Blood oxygen",onInfoClick:_}),c.jsx(po,{metricKey:"calcium",value:fe.calcium,previousValue:re.calcium,allReports:X,isSamePatient:he,status:Pe(fe.calcium,8.5,10.5),subtitle:"Bones & teeth",onInfoClick:_})]})]}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-sm sm:text-lg font-semibold text-slate-800 mb-2 sm:mb-3 flex items-center gap-2",children:[c.jsx(Qh,{className:"w-4 h-4 sm:w-5 sm:h-5 text-red-500"}),"Blood & Hormones"]}),c.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-4",children:[c.jsx(po,{metricKey:"hemoglobin",value:fe.hemoglobin,previousValue:re.hemoglobin,allReports:X,isSamePatient:he,status:Pe(fe.hemoglobin,12,17),subtitle:"Oxygen carrier",onInfoClick:_}),c.jsx(po,{metricKey:"bloodSugar",value:fe.bloodSugar,previousValue:re.bloodSugar,allReports:X,isSamePatient:he,status:Pe(fe.bloodSugar,70,100),subtitle:"Fasting glucose",onInfoClick:_}),c.jsx(po,{metricKey:"thyroid",value:fe.tsh,previousValue:re.tsh,allReports:X,isSamePatient:he,status:Pe(fe.tsh,.4,4),subtitle:"Metabolism control",onInfoClick:_}),c.jsx(po,{metricKey:"vitaminC",value:fe.vitaminC,previousValue:re.vitaminC,allReports:X,isSamePatient:he,status:Pe(fe.vitaminC,.6,2),subtitle:"Immune & healing",onInfoClick:_})]})]}),ee&&De.length>1&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[c.jsx(Or,{className:"w-5 h-5 text-cyan-500"}),"Health Improvement Tracking"]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[c.jsx(To,{className:"w-4 h-4"}),"Last updated: ",new Date().toLocaleDateString()]})]}),c.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-slate-600 text-sm",children:"Overall Trend"}),c.jsx(Q2,{className:"w-4 h-4 text-green-500"})]}),c.jsxs("div",{className:"flex items-baseline gap-2",children:[c.jsx("span",{className:"text-2xl font-bold text-green-500",children:"Improved"}),c.jsx("span",{className:"text-xs text-slate-400",children:"vs last month"})]}),c.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Based on lab values and wearable data"})]}),c.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-slate-600 text-sm",children:"Stable Metrics"}),c.jsx(ff,{className:"w-4 h-4 text-blue-500"})]}),c.jsxs("div",{className:"flex items-baseline gap-2",children:[c.jsx("span",{className:"text-2xl font-bold text-blue-500",children:"6"}),c.jsx("span",{className:"text-xs text-slate-400",children:"out of 12"})]}),c.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Maintaining healthy ranges"})]}),c.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-slate-600 text-sm",children:"Needs Attention"}),c.jsx($d,{className:"w-4 h-4 text-yellow-500"})]}),c.jsxs("div",{className:"flex items-baseline gap-2",children:[c.jsx("span",{className:"text-2xl font-bold text-yellow-500",children:"2"}),c.jsx("span",{className:"text-xs text-slate-400",children:"metrics"})]}),c.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Vitamin D, Iron levels"})]})]}),c.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h4",{className:"text-slate-800 font-medium",children:"Lab Values Trend"}),c.jsxs("select",{className:"bg-slate-50 border border-slate-200 rounded-lg px-3 py-1 text-slate-700 text-sm",children:[c.jsx("option",{children:"Vitamin D"}),c.jsx("option",{children:"Iron"}),c.jsx("option",{children:"B12"}),c.jsx("option",{children:"Hemoglobin"})]})]}),c.jsx(xy,{width:"100%",height:200,children:c.jsxs(Mne,{data:De.map((Ke,xe)=>({date:Ke.date,score:Ke.score})),children:[c.jsx(Jf,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),c.jsx(Xl,{dataKey:"date",stroke:"#94a3b8",fontSize:12}),c.jsx(Jl,{stroke:"#94a3b8",fontSize:12}),c.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e2e8f0",borderRadius:"8px"},labelStyle:{color:"#64748b"}}),c.jsx(Ig,{type:"monotone",dataKey:"score",stroke:"#f59e0b",strokeWidth:2,dot:{fill:"#f59e0b",strokeWidth:2}})]})}),c.jsxs("div",{className:"flex items-center gap-4 mt-4 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500"}),c.jsx("span",{className:"text-slate-600",children:"Health Score Trend"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ns,{className:"w-4 h-4 text-green-500"}),c.jsx("span",{className:"text-slate-500",children:"Target: 80+ score"})]})]})]}),(Q==null?void 0:Q.recommendations)&&c.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[c.jsxs("h4",{className:"text-slate-800 font-medium mb-4 flex items-center gap-2",children:[c.jsx(If,{className:"w-5 h-5 text-cyan-500"}),"Personalized Recommendations"]}),c.jsx("div",{className:"space-y-3",children:(st=Q.recommendations.lifestyle)==null?void 0:st.slice(0,3).map((Ke,xe)=>c.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-50 rounded-lg",children:[c.jsx(rr,{className:"w-5 h-5 text-green-500 mt-0.5 shrink-0"}),c.jsx("div",{children:c.jsx("p",{className:"text-slate-800 font-medium text-sm",children:Ke})})]},xe))})]})]}),c.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c.jsxs("div",{className:"rounded-2xl p-6",style:{backgroundColor:"#F5F1EA",border:"2px solid #E5DFD3"},children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("div",{className:"px-3 py-1 rounded-full flex items-center gap-2",style:{backgroundColor:"#E5DFD3"},children:[c.jsx(Wh,{className:"w-4 h-4 text-cyan-600"}),c.jsx("span",{className:"text-cyan-700 text-sm font-medium",children:"AI ANALYSIS"})]})}),c.jsx("span",{className:"text-slate-500 text-sm",children:q?"Based on your reports":"No reports yet"})]}),c.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-3",children:((ct=Q==null?void 0:Q.summary)==null?void 0:ct.split(".")[0])||"Upload a health report to get AI insights"}),c.jsx("p",{className:"text-slate-600 mb-6",children:Q?Q.summary:"Our AI will analyze your health reports and provide personalized insights, recommendations, and track your health trends over time."}),c.jsxs("div",{className:"flex flex-wrap gap-3",children:[!ee&&c.jsxs(Ct,{to:"/upload",className:"px-6 py-2 text-white rounded-xl font-medium hover:shadow-lg flex items-center gap-2",style:{backgroundColor:"#8B7355"},children:[c.jsx(Es,{className:"w-4 h-4"}),"Upload Your First Report"]}),J&&c.jsx(Ct,{to:"/wearables",className:"px-6 py-2 bg-white border border-slate-200 text-slate-700 rounded-xl font-medium hover:bg-slate-50",children:"View Wearable Data"})]})]}),((zt=Q==null?void 0:Q.keyFindings)==null?void 0:zt.length)>0&&c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Key Findings from Your Reports"}),c.jsx("div",{className:"space-y-3",children:Q.keyFindings.slice(0,4).map((Ke,xe)=>{const Je=typeof Ke=="string"?Ke:Ke.title||Ke.finding||JSON.stringify(Ke),yt=typeof Ke=="object"?Ke.description:null,Yn=typeof Ke=="object"?Ke.severity:"low";return c.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-50 rounded-xl",children:[c.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${Yn==="high"?"bg-red-500":Yn==="medium"?"bg-amber-500":"bg-emerald-500"}`}),c.jsxs("div",{children:[c.jsx("p",{className:"text-slate-800 font-medium",children:Je}),yt&&c.jsx("p",{className:"text-slate-500 text-sm mt-1",children:yt})]})]},xe)})})]})]}),c.jsx("div",{className:"space-y-6",children:c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"font-semibold text-slate-800",children:"Recent Reports"}),c.jsx(Ct,{to:"/profile",className:"text-cyan-500 text-sm hover:text-cyan-600",children:"View All"})]}),c.jsx("div",{className:"space-y-3",children:(X==null?void 0:X.length)>0?X.slice(0,3).map(Ke=>c.jsxs(Ct,{to:`/reports/${Ke._id}`,className:"flex items-center gap-3 p-3 bg-slate-50 rounded-xl hover:bg-slate-100 transition-colors",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-100 flex items-center justify-center",children:c.jsx(Vn,{className:"w-5 h-5 text-red-500"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-slate-800 font-medium truncate",children:Ke.reportType}),c.jsx("p",{className:"text-slate-400 text-sm",children:new Date(Ke.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),c.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${Ke.status==="completed"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:Ke.status==="completed"?"ANALYZED":"PENDING"})]},Ke._id)):c.jsxs("div",{className:"text-center py-4",children:[c.jsx(Vn,{className:"w-10 h-10 text-slate-300 mx-auto mb-2"}),c.jsx("p",{className:"text-slate-500 text-sm",children:"No reports uploaded yet"}),c.jsx(Ct,{to:"/upload",className:"text-cyan-500 text-sm hover:text-cyan-600",children:"+ Upload Report"})]})})]})})]})]})}const gKe="http://localhost:5000",vKe=({bmi:e})=>{const[d,h]=z.useState(null),v=e<16?0:e>=40?180:(e-16)/24*180,b=[{start:0,end:30,color:"#ef4444",label:"Underweight",range:"< 18.5"},{start:30,end:82.5,color:"#22c55e",label:"Normal",range:"18.5 - 25"},{start:82.5,end:120,color:"#eab308",label:"Overweight",range:"25 - 30"},{start:120,end:157.5,color:"#f97316",label:"Obese",range:"30 - 35"},{start:157.5,end:180,color:"#dc2626",label:"Severely Obese",range:"> 35"}];return c.jsxs("div",{className:"relative flex items-center justify-center",children:[c.jsxs("svg",{width:200,height:200/2+20,className:"overflow-visible",children:[b.map((_,w)=>{const E=_.start-90,N=_.end-90,I=N-E>180?1:0,R=200/2+90*Math.cos(E*Math.PI/180),O=200/2+90*Math.sin(E*Math.PI/180),P=200/2+90*Math.cos(N*Math.PI/180),M=200/2+90*Math.sin(N*Math.PI/180);return c.jsx("g",{children:c.jsx("path",{d:`M ${R} ${O} A 90 90 0 ${I} 1 ${P} ${M}`,fill:"none",stroke:_.color,strokeWidth:20,strokeLinecap:"round",className:"cursor-pointer transition-opacity hover:opacity-80",onMouseEnter:()=>h(w),onMouseLeave:()=>h(null)})},w)}),c.jsxs("g",{transform:`rotate(${v-90} ${200/2} ${200/2})`,children:[c.jsx("line",{x1:200/2,y1:200/2,x2:200/2+90-10,y2:200/2,stroke:"#1e293b",strokeWidth:"3",strokeLinecap:"round"}),c.jsx("circle",{cx:200/2,cy:200/2,r:"8",fill:"#1e293b"})]}),c.jsx("text",{x:200/2,y:200/2+35,textAnchor:"middle",className:"text-3xl font-bold fill-slate-800",children:e.toFixed(1)}),c.jsx("text",{x:200/2,y:200/2+55,textAnchor:"middle",className:"text-xs fill-slate-500",children:"kg/m"})]}),d!==null&&c.jsxs("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-full mb-2 px-3 py-2 bg-slate-800 text-white text-xs font-medium rounded-lg shadow-lg whitespace-nowrap z-10",children:[c.jsx("div",{className:"font-semibold",children:b[d].label}),c.jsxs("div",{className:"text-slate-300",children:["BMI: ",b[d].range]}),c.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-800"})]})]})},yKe=({bmi:e})=>{const[d,h]=z.useState(null),v=e<16?0:e>=40?180:(e-16)/24*180,b=[{start:0,end:30,color:"#ef4444",label:"Underweight",range:"< 18.5"},{start:30,end:82.5,color:"#22c55e",label:"Normal",range:"18.5 - 25"},{start:82.5,end:120,color:"#eab308",label:"Overweight",range:"25 - 30"},{start:120,end:157.5,color:"#f97316",label:"Obese",range:"30 - 35"},{start:157.5,end:180,color:"#dc2626",label:"Severely Obese",range:"> 35"}];return c.jsxs("div",{className:"relative flex items-center justify-center",children:[c.jsxs("svg",{width:240,height:240/2+30,className:"overflow-visible",children:[b.map((_,w)=>{const E=_.start,N=_.end,I=0,R=240/2-109*Math.cos(E*Math.PI/180),O=240/2-109*Math.sin(E*Math.PI/180),P=240/2-109*Math.cos(N*Math.PI/180),M=240/2-109*Math.sin(N*Math.PI/180);return c.jsx("g",{children:c.jsx("path",{d:`M ${R} ${O} A 109 109 0 ${I} 1 ${P} ${M}`,fill:"none",stroke:_.color,strokeWidth:22,strokeLinecap:"round",className:"cursor-pointer transition-opacity active:opacity-80",onTouchStart:()=>h(w),onTouchEnd:()=>h(null),onMouseEnter:()=>h(w),onMouseLeave:()=>h(null)})},w)}),c.jsxs("g",{transform:`rotate(${v} ${240/2} ${240/2})`,children:[c.jsx("line",{x1:240/2,y1:240/2,x2:240/2-109+12,y2:240/2,stroke:"#1e293b",strokeWidth:"3",strokeLinecap:"round"}),c.jsx("circle",{cx:240/2,cy:240/2,r:"9",fill:"#1e293b"})]}),c.jsx("text",{x:240/2,y:240/2+25,textAnchor:"middle",className:"text-4xl font-bold fill-slate-800",children:e.toFixed(1)}),c.jsx("text",{x:240/2,y:240/2+45,textAnchor:"middle",className:"text-sm fill-slate-500 font-medium",children:"kg/m"})]}),d!==null&&c.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-slate-800 text-white text-xs font-medium rounded-lg shadow-lg whitespace-nowrap z-10 animate-fade-in",children:[c.jsx("div",{className:"font-semibold",children:b[d].label}),c.jsxs("div",{className:"text-slate-300",children:["BMI: ",b[d].range]}),c.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-800"})]})]})},bKe=({bmi:e})=>{const s=e<16?{label:"Severely Underweight",color:"bg-red-100 text-red-700 border-red-200",icon:Vr}:e<18.5?{label:"Underweight",color:"bg-red-50 text-red-600 border-red-200",icon:Vr}:e<25?{label:"Normal",color:"bg-green-100 text-green-700 border-green-200",icon:rr}:e<30?{label:"Overweight",color:"bg-yellow-100 text-yellow-700 border-yellow-200",icon:Or}:e<35?{label:"Obese",color:"bg-orange-100 text-orange-700 border-orange-200",icon:Or}:{label:"Severely Obese",color:"bg-red-100 text-red-700 border-red-200",icon:Vr},o=s.icon;return c.jsxs("div",{className:`flex items-center gap-1.5 lg:gap-2 px-3 lg:px-4 py-1.5 lg:py-2 rounded-full border-2 ${s.color} font-semibold text-xs lg:text-sm`,children:[c.jsx(o,{className:"w-3.5 h-3.5 lg:w-4 lg:h-4"}),s.label]})};function xKe(){const{user:e}=as(),[n,s]=z.useState(null),[o,d]=z.useState(null),[h,f]=z.useState(null),[v,b]=z.useState(null),[_,w]=z.useState(null);z.useEffect(()=>{E(),N()},[e]);const E=()=>{var G,$;const I=(G=e==null?void 0:e.profile)==null?void 0:G.height,R=($=e==null?void 0:e.profile)==null?void 0:$.weight;if(!I||!R)return;const O=I/100,P=R/(O*O);s(P);const M=P/25;d(M);const D=R/Math.pow(O,3);f(D);const U=18.5*O*O,B=25*O*O;b({min:U.toFixed(1),max:B.toFixed(1)})},N=async()=>{var I;try{const R=localStorage.getItem("token"),{data:O}=await Ln.get(`${gKe}/api/auth/profile`,{headers:{Authorization:`Bearer ${R}`}});w((I=O.user)==null?void 0:I.nutritionGoal)}catch(R){console.error("Failed to fetch goal:",R)}};return n?c.jsx(c.Fragment,{children:c.jsx("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-2xl border-2 border-cyan-200 p-4 lg:p-6 shadow-sm",children:c.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-3 lg:gap-6",children:[c.jsx("div",{className:"lg:hidden w-full flex justify-center",children:c.jsx(yKe,{bmi:n})}),c.jsx("div",{className:"hidden lg:block flex-shrink-0",children:c.jsx(vKe,{bmi:n})}),c.jsxs("div",{className:"flex-1 w-full space-y-2 lg:space-y-4 text-center lg:text-left",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2 justify-center lg:justify-start",children:[c.jsx("h3",{className:"hidden lg:block text-2xl font-bold text-slate-800",children:"Your BMI"}),c.jsx(bKe,{bmi:n})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 lg:gap-3",children:[c.jsxs("div",{className:"bg-white rounded-lg lg:rounded-xl p-2 lg:p-3 border border-slate-200",children:[c.jsx("p",{className:"text-[10px] lg:text-xs text-slate-600 mb-0.5 lg:mb-1",children:"Healthy BMI"}),c.jsx("p",{className:"text-xs lg:text-sm font-bold text-slate-800",children:"18.5 - 25"})]}),c.jsxs("div",{className:"bg-white rounded-lg lg:rounded-xl p-2 lg:p-3 border border-slate-200",children:[c.jsx("p",{className:"text-[10px] lg:text-xs text-slate-600 mb-0.5 lg:mb-1",children:"Healthy Weight"}),c.jsxs("p",{className:"text-xs lg:text-sm font-bold text-slate-800",children:[v==null?void 0:v.min," - ",v==null?void 0:v.max," kg"]})]}),c.jsxs("div",{className:"bg-white rounded-lg lg:rounded-xl p-2 lg:p-3 border border-slate-200",children:[c.jsx("p",{className:"text-[10px] lg:text-xs text-slate-600 mb-0.5 lg:mb-1",children:"BMI Prime"}),c.jsx("p",{className:"text-xs lg:text-sm font-bold text-slate-800",children:o==null?void 0:o.toFixed(2)})]}),c.jsxs("div",{className:"bg-white rounded-lg lg:rounded-xl p-2 lg:p-3 border border-slate-200",children:[c.jsx("p",{className:"text-[10px] lg:text-xs text-slate-600 mb-0.5 lg:mb-1",children:"Ponderal Index"}),c.jsxs("p",{className:"text-xs lg:text-sm font-bold text-slate-800",children:[h==null?void 0:h.toFixed(1)," kg/m"]})]})]}),_!=null&&_.goal?c.jsx("div",{className:"bg-white rounded-lg lg:rounded-xl p-2.5 lg:p-4 border-2 border-cyan-200",children:c.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-2 lg:gap-3",children:[c.jsxs("div",{className:"text-center sm:text-left",children:[c.jsx("p",{className:"text-[10px] lg:text-xs text-slate-600 mb-0.5 lg:mb-1",children:"Current Goal"}),c.jsxs("p",{className:"text-xs lg:text-sm font-bold text-slate-800 capitalize",children:[_.goal.replace("_"," "),_.targetWeight&&` - ${_.targetWeight} kg`]})]}),c.jsx(Ct,{to:"/profile?tab=goals",className:"px-3 py-1.5 lg:px-4 lg:py-2 bg-cyan-500 text-white rounded-lg text-xs lg:text-sm font-medium hover:bg-cyan-600 transition-colors whitespace-nowrap",children:"Change"})]})}):c.jsxs(Ct,{to:"/profile?tab=goals",className:"w-full py-2 lg:py-3 bg-cyan-500 text-white rounded-lg lg:rounded-xl font-semibold hover:bg-cyan-600 transition-colors flex items-center justify-center gap-2 text-sm lg:text-base",children:[c.jsx(ns,{className:"w-4 h-4 lg:w-5 lg:h-5"}),"Set Your Goal"]})]})]})})}):c.jsx("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-2xl border-2 border-cyan-200 p-6",children:c.jsxs("div",{className:"text-center",children:[c.jsx(ns,{className:"w-12 h-12 text-cyan-500 mx-auto mb-3"}),c.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:"Complete Your Profile"}),c.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Add your height and weight to see your BMI and get personalized recommendations"}),c.jsx("a",{href:"/profile",className:"inline-block px-6 py-2 bg-cyan-500 text-white rounded-xl font-medium hover:bg-cyan-600 transition-colors",children:"Update Profile"})]})})}const ew=({title:e,description:n,link:s,status:o,icon:d,gradient:h,emoji:f})=>c.jsxs(Ct,{to:s,className:"group relative overflow-hidden rounded-3xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1",children:[c.jsxs("div",{className:`h-48 bg-gradient-to-br ${h} relative rounded-t-3xl overflow-hidden`,children:[c.jsxs("div",{className:"absolute inset-0 opacity-10",children:[c.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.8),transparent_50%)] animate-pulse"}),c.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(45deg,transparent_25%,rgba(255,255,255,0.1)_50%,transparent_75%)] bg-[length:20px_20px]"})]}),c.jsx("div",{className:"absolute top-1/2 right-8 transform -translate-y-1/2",children:c.jsxs("div",{className:"relative w-24 h-24 group-hover:scale-110 transition-transform duration-500",children:[c.jsx("div",{className:"absolute inset-0 bg-white/10 rounded-full blur-xl transform translate-y-2"}),c.jsx("div",{className:"absolute inset-0 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center border border-white/30",children:c.jsx("span",{className:"text-5xl filter drop-shadow-lg",children:f})}),c.jsx("div",{className:"absolute top-2 left-2 w-8 h-8 bg-white/40 rounded-full blur-md"})]})}),c.jsx("div",{className:"absolute top-4 left-4 z-10",children:c.jsx("div",{className:"w-16 h-16 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center shadow-lg border border-white/30 group-hover:scale-110 transition-transform",children:c.jsx(d,{className:"w-8 h-8 text-white drop-shadow-md"})})}),o&&c.jsx("div",{className:"absolute top-4 right-4 z-10",children:c.jsx("span",{className:"px-3 py-1 bg-white/90 backdrop-blur-sm rounded-full text-xs font-semibold text-slate-700 shadow-md",children:o})}),c.jsx("div",{className:"absolute bottom-0 right-0 w-32 h-32 bg-white/10 rounded-tl-full"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-20 h-20 bg-black/5 rounded-tr-full"})]}),c.jsxs("div",{className:"bg-white p-5 rounded-b-3xl",children:[c.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-1 group-hover:text-cyan-600 transition-colors",children:e}),c.jsx("p",{className:"text-sm text-slate-600 line-clamp-2",children:n}),c.jsxs("div",{className:"mt-3 flex items-center text-cyan-600 text-sm font-medium",children:[c.jsx("span",{children:"Get Started"}),c.jsx(Il,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]})]}),gs=({icon:e,title:n,subtitle:s,link:o,color:d,comingSoon:h})=>{const f=c.jsxs("div",{className:`relative bg-white rounded-2xl p-4 border-2 border-slate-100 hover:border-${d}-200 hover:shadow-lg transition-all duration-300 group ${h?"opacity-60":"cursor-pointer"}`,children:[c.jsx("div",{className:`w-14 h-14 rounded-xl bg-${d}-50 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform`,children:c.jsx(e,{className:`w-7 h-7 text-${d}-500`})}),c.jsx("h4",{className:"font-semibold text-slate-800 text-sm mb-1",children:n}),c.jsx("p",{className:"text-xs text-slate-500",children:s}),h&&c.jsx("div",{className:"absolute top-2 right-2",children:c.jsx("span",{className:"px-2 py-1 bg-amber-100 text-amber-700 text-[10px] font-semibold rounded-full",children:"SOON"})})]});return h?f:c.jsx(Ct,{to:o,children:f})};function _Ke(){var N,I,R,O,P,M,D,U,B,G,$;const{user:e}=as(),{dashboardData:n,loading:s,fetchDashboard:o}=rZ(),[d,h]=z.useState(0),[f,v]=z.useState(!n);if(z.useEffect(()=>{(async()=>{await o(),v(!1)})()},[o]),z.useEffect(()=>{var q,X,ee;if(n){let ce=0;const Q=4;(q=e==null?void 0:e.profile)!=null&&q.age&&((X=e==null?void 0:e.profile)!=null&&X.gender)&&ce++,((ee=n.recentReports)==null?void 0:ee.length)>0&&ce++,n.nutritionTracked&&ce++,n.wearableConnected&&ce++;const ae=Math.round(ce/Q*100);setTimeout(()=>h(ae),300)}},[n,e]),f&&s.dashboard&&!n)return c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-slate-600",children:"Loading your health dashboard..."})]})});const b=((N=n==null?void 0:n.recentReports)==null?void 0:N.length)>0,_=((I=e==null?void 0:e.profile)==null?void 0:I.age)&&((R=e==null?void 0:e.profile)==null?void 0:R.gender),w=n==null?void 0:n.nutritionTracked;n==null||n.wearableConnected;const E=((P=(O=n==null?void 0:n.user)==null?void 0:O.healthMetrics)==null?void 0:P.healthScore)||((M=n==null?void 0:n.latestAnalysis)==null?void 0:M.healthScore);return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-cyan-50 via-blue-50 to-cyan-100",children:[s.dashboard&&n&&c.jsxs("div",{className:"fixed top-20 right-4 z-50 bg-white rounded-full shadow-lg px-4 py-2 flex items-center gap-2 animate-slide-in-right",children:[c.jsx("div",{className:"w-4 h-4 border-2 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin"}),c.jsx("span",{className:"text-sm text-slate-600",children:"Refreshing..."})]}),c.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in pb-20 px-4",children:[c.jsxs("div",{className:"pt-6",children:[c.jsxs("h1",{className:"text-3xl font-bold text-slate-800 mb-1",children:["Hi, ",c.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-cyan-600 to-emerald-600",children:((D=e==null?void 0:e.name)==null?void 0:D.split(" ")[0])||"there"}),"! "]}),c.jsx("p",{className:"text-slate-600",children:"Welcome to your health journey"})]}),c.jsx(xKe,{}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("button",{onClick:()=>{var q;return b&&((q=document.getElementById("health-score-graph"))==null?void 0:q.scrollIntoView({behavior:"smooth",block:"center"}))},className:"bg-white rounded-2xl p-5 shadow-md hover:shadow-lg transition-all cursor-pointer text-left hover:scale-105 transform duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-red-400 to-pink-500 flex items-center justify-center",children:c.jsx(zn,{className:"w-6 h-6 text-white"})}),c.jsx(Or,{className:"w-5 h-5 text-emerald-500"})]}),c.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Health Score"}),c.jsx("p",{className:"text-3xl font-bold text-slate-800",children:((B=(U=n==null?void 0:n.user)==null?void 0:U.healthMetrics)==null?void 0:B.healthScore)||"--"})]}),c.jsxs("button",{onClick:()=>{var q;return b&&((q=document.getElementById("recent-reports"))==null?void 0:q.scrollIntoView({behavior:"smooth",block:"center"}))},className:"bg-white rounded-2xl p-5 shadow-md hover:shadow-lg transition-all cursor-pointer text-left hover:scale-105 transform duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-400 to-cyan-500 flex items-center justify-center",children:c.jsx(Vn,{className:"w-6 h-6 text-white"})}),c.jsx(vo,{className:"w-5 h-5 text-slate-400"})]}),c.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Total Reports"}),c.jsx("p",{className:"text-3xl font-bold text-slate-800",children:(n==null?void 0:n.totalReports)||((G=n==null?void 0:n.recentReports)==null?void 0:G.length)||0})]}),c.jsxs(Ct,{to:"/nutrition#daily-target",className:"bg-white rounded-2xl p-5 shadow-md hover:shadow-lg transition-all cursor-pointer hover:scale-105 transform duration-200 block",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-emerald-400 to-green-500 flex items-center justify-center",children:c.jsx(fu,{className:"w-6 h-6 text-white"})}),c.jsx(Ml,{className:"w-5 h-5 text-orange-500"})]}),c.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Meals Logged"}),c.jsx("p",{className:"text-3xl font-bold text-slate-800",children:(n==null?void 0:n.mealsLogged)||0})]}),c.jsxs(Ct,{to:"/challenge",className:"bg-white rounded-2xl p-5 shadow-md hover:shadow-lg transition-all cursor-pointer hover:scale-105 transform duration-200 block",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-400 to-indigo-500 flex items-center justify-center",children:c.jsx(If,{className:"w-6 h-6 text-white"})}),c.jsx(ja,{className:"w-5 h-5 text-amber-400"})]}),c.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Streak Days"}),c.jsx("p",{className:"text-3xl font-bold text-slate-800",children:(n==null?void 0:n.streakDays)||0})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"flex items-center justify-between mb-6",children:c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[c.jsx(zn,{className:"w-7 h-7 text-red-500"}),"Health Journey"]}),c.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Your personalized health management tools"})]})}),c.jsxs("div",{className:"md:grid md:grid-cols-4 md:gap-6 flex md:flex-none overflow-x-auto gap-4 pb-4 md:pb-0 snap-x snap-mandatory scrollbar-hide -mx-4 px-4 md:mx-0 md:px-0",children:[c.jsx("div",{className:"min-w-[280px] md:min-w-0 snap-center",children:c.jsx(ew,{title:"Upload Report",description:"Get AI-powered analysis of your health reports with personalized insights",icon:Es,emoji:"",gradient:"from-blue-400 via-blue-500 to-blue-600",link:"/upload",status:b?`${n.recentReports.length} Reports`:"Get Started"})}),c.jsx("div",{className:"min-w-[280px] md:min-w-0 snap-center",children:c.jsx(ew,{title:"Nutrition Tracker",description:"Track your daily meals, calories, and macros with smart recommendations",icon:fu,emoji:"",gradient:"from-emerald-400 via-emerald-500 to-emerald-600",link:"/nutrition",status:w?"Active":"Start Tracking"})}),c.jsx("div",{className:"min-w-[280px] md:min-w-0 snap-center",children:c.jsx(ew,{title:"Diet Plan",description:"Get personalized meal plans based on your health reports and goals",icon:Pa,emoji:"",gradient:"from-orange-400 via-orange-500 to-orange-600",link:"/diet-plan",status:"Personalized"})}),c.jsx("div",{className:"min-w-[280px] md:min-w-0 snap-center",children:c.jsx(ew,{title:"My Fitness Goal",description:"Set and track your fitness goals to achieve your health targets",icon:ns,emoji:"",gradient:"from-purple-400 via-purple-500 to-purple-600",link:"/profile?tab=goals",status:_?"View Goals":"Set Goals"})})]})]}),b&&E&&(($=n==null?void 0:n.healthScores)==null?void 0:$.length)>0&&c.jsxs("div",{id:"health-score-graph",className:"bg-white rounded-2xl shadow-md p-6 scroll-mt-20",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 sm:gap-4 mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Health Score Trend"}),c.jsx("p",{className:"text-slate-500 text-sm",children:"Your overall health progress over time"})]}),c.jsxs("div",{className:"flex items-baseline gap-2",children:[c.jsx("span",{className:"text-4xl font-bold text-slate-800",children:E}),c.jsx("span",{className:"text-slate-400 text-sm",children:"/100"})]})]}),c.jsx(xy,{width:"100%",height:200,children:c.jsxs(rL,{data:n.healthScores.map(q=>({date:new Date(q.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),score:q.score})),children:[c.jsx("defs",{children:c.jsxs("linearGradient",{id:"scoreGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[c.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),c.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})}),c.jsx(Jf,{strokeDasharray:"3 3",stroke:"#e2e8f0",vertical:!1}),c.jsx(Xl,{dataKey:"date",stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1}),c.jsx(Jl,{stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1,domain:[50,100],hide:!0}),c.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e2e8f0",borderRadius:"12px",fontSize:"12px"},labelStyle:{color:"#64748b"},formatter:q=>[`${q}/100`,"Score"]}),c.jsx(sl,{type:"monotone",dataKey:"score",stroke:"#10b981",strokeWidth:2,fill:"url(#scoreGradient)"})]})})]}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx(RQ,{className:"w-7 h-7 text-cyan-600"}),"More Offerings"]}),c.jsxs("div",{className:"hidden md:grid md:grid-cols-4 gap-4",children:[c.jsx(gs,{icon:Pa,title:"Quick Food Check",subtitle:"Instant nutrition",link:"/nutrition",color:"emerald"}),c.jsx(gs,{icon:jn,title:"Vital Signs",subtitle:"Track metrics",link:"/vital-signs",color:"red"}),c.jsx(gs,{icon:ka,title:"Supplements",subtitle:"Recommendations",link:"/supplements",color:"purple"}),c.jsx(gs,{icon:cu,title:"AI Chat",subtitle:"Ask health questions",link:"/ai-chat",color:"cyan"}),c.jsx(gs,{icon:Vn,title:"My Reports",subtitle:"View all reports",link:"/reports",color:"blue"}),c.jsx(gs,{icon:qr,title:"Appointments",subtitle:"Book doctors",link:"/doctors",color:"indigo",comingSoon:!0}),c.jsx(gs,{icon:Of,title:"Fitness Plan",subtitle:"Exercise routines",link:"/dashboard",color:"orange",comingSoon:!0}),c.jsx(gs,{icon:jh,title:"Mental Health",subtitle:"Mood tracking",link:"/dashboard",color:"pink",comingSoon:!0})]}),c.jsxs("div",{className:"md:hidden",children:[c.jsxs("div",{className:"flex overflow-x-auto gap-3 pb-4 snap-x snap-mandatory scrollbar-hide -mx-4 px-4",children:[c.jsx("div",{className:"min-w-[calc(50%-6px)] snap-start flex-shrink-0",children:c.jsx(gs,{icon:Pa,title:"Quick Food Check",subtitle:"Instant nutrition",link:"/nutrition",color:"emerald"})}),c.jsx("div",{className:"min-w-[calc(50%-6px)] snap-start flex-shrink-0",children:c.jsx(gs,{icon:jn,title:"Vital Signs",subtitle:"Track metrics",link:"/vital-signs",color:"red"})}),c.jsx("div",{className:"min-w-[calc(50%-6px)] snap-start flex-shrink-0",children:c.jsx(gs,{icon:ka,title:"Supplements",subtitle:"Recommendations",link:"/supplements",color:"purple"})}),c.jsx("div",{className:"min-w-[calc(50%-6px)] snap-start flex-shrink-0",children:c.jsx(gs,{icon:cu,title:"AI Chat",subtitle:"Ask health questions",link:"/ai-chat",color:"cyan"})}),c.jsx("div",{className:"min-w-[calc(50%-6px)] snap-start flex-shrink-0",children:c.jsx(gs,{icon:Vn,title:"My Reports",subtitle:"View all reports",link:"/reports",color:"blue"})}),c.jsx("div",{className:"min-w-[calc(50%-6px)] snap-start flex-shrink-0",children:c.jsx(gs,{icon:qr,title:"Appointments",subtitle:"Book doctors",link:"/doctors",color:"indigo",comingSoon:!0})}),c.jsx("div",{className:"min-w-[calc(50%-6px)] snap-start flex-shrink-0",children:c.jsx(gs,{icon:Of,title:"Fitness Plan",subtitle:"Exercise routines",link:"/dashboard",color:"orange",comingSoon:!0})}),c.jsx("div",{className:"min-w-[calc(50%-6px)] snap-start flex-shrink-0",children:c.jsx(gs,{icon:jh,title:"Mental Health",subtitle:"Mood tracking",link:"/dashboard",color:"pink",comingSoon:!0})})]}),c.jsx("div",{className:"flex items-center justify-center gap-2 mt-2",children:c.jsxs("div",{className:"flex items-center gap-1 text-slate-400 text-xs",children:[c.jsx(Il,{className:"w-4 h-4 animate-pulse"}),c.jsx("span",{children:"Scroll for more"}),c.jsx(Il,{className:"w-4 h-4 animate-pulse"})]})})]})]}),b&&c.jsxs("div",{id:"recent-reports",className:"scroll-mt-20",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[c.jsx(Vn,{className:"w-7 h-7 text-blue-600"}),"Recent Reports"]}),c.jsx("p",{className:"text-slate-600 text-sm mt-1",children:"Your latest uploaded health reports"})]}),c.jsxs(Ct,{to:"/reports",className:"text-cyan-600 hover:text-cyan-700 font-medium text-xs sm:text-sm flex items-center gap-1 whitespace-nowrap",children:["View All",c.jsx(Il,{className:"w-4 h-4"})]})]}),c.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:n.recentReports.slice(0,2).map(q=>{var X,ee;return c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-orange-200 p-5 hover:shadow-lg transition-all group",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-400 to-cyan-500 flex items-center justify-center",children:c.jsx(Vn,{className:"w-6 h-6 text-white"})}),c.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${q.status==="completed"?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"}`,children:q.status==="completed"?"ANALYZED":"PENDING"})]}),c.jsx("h3",{className:"font-bold text-slate-800 text-lg mb-2",children:q.reportType}),c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[c.jsx(qr,{className:"w-4 h-4"}),c.jsx("span",{children:new Date(q.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),((X=q.aiAnalysis)==null?void 0:X.healthScore)&&c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(zn,{className:"w-4 h-4 text-red-500"}),c.jsx("span",{className:"font-bold text-slate-800",children:q.aiAnalysis.healthScore})]})]}),((ee=q.aiAnalysis)==null?void 0:ee.summary)&&c.jsx("p",{className:"text-sm text-slate-600 line-clamp-2 mb-4",children:q.aiAnalysis.summary}),c.jsxs(Ct,{to:`/reports/${q._id}`,className:"w-full py-2 px-4 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white text-sm font-medium rounded-xl transition-all flex items-center justify-center gap-2",children:[c.jsx(jn,{className:"w-4 h-4"}),"View Details"]})]},q._id)})})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-amber-500 to-orange-500 flex items-center justify-center",children:c.jsx(rP,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"30 Days Challenge"}),c.jsx("p",{className:"text-slate-600 text-sm",children:"Build healthy habits, one day at a time"})]})]}),c.jsxs(Ct,{to:"/challenge",className:"block bg-gradient-to-br from-amber-400 via-orange-500 to-red-500 rounded-3xl p-5 sm:p-8 text-white hover:shadow-2xl transition-all hover:-translate-y-1 group",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[c.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-1",children:[c.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center flex-shrink-0",children:c.jsx(rP,{className:"w-6 h-6 sm:w-8 sm:h-8 text-white"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h3",{className:"text-base sm:text-2xl font-bold mb-0.5 sm:mb-1 leading-tight",children:"30 Days Health Challenge"}),c.jsx("p",{className:"text-xs sm:text-base text-amber-100 leading-tight",children:"Complete daily tasks to build lasting habits"})]})]}),c.jsx(Il,{className:"w-6 h-6 sm:w-8 sm:h-8 group-hover:translate-x-2 transition-transform flex-shrink-0"})]}),c.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mb-4 sm:mb-6",children:[c.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-3 sm:p-4 text-center",children:[c.jsx("div",{className:"text-2xl sm:text-3xl mb-1 sm:mb-2",children:""}),c.jsx("p",{className:"text-xs sm:text-sm font-medium",children:"Drink Water"})]}),c.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-3 sm:p-4 text-center",children:[c.jsx("div",{className:"text-2xl sm:text-3xl mb-1 sm:mb-2",children:""}),c.jsx("p",{className:"text-xs sm:text-sm font-medium",children:"Workout/Yoga"})]}),c.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-3 sm:p-4 text-center",children:[c.jsx("div",{className:"text-2xl sm:text-3xl mb-1 sm:mb-2",children:""}),c.jsx("p",{className:"text-xs sm:text-sm font-medium",children:"Eat Fruits"})]}),c.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-3 sm:p-4 text-center",children:[c.jsx("div",{className:"text-2xl sm:text-3xl mb-1 sm:mb-2",children:""}),c.jsx("p",{className:"text-xs sm:text-sm font-medium",children:"Sleep Well"})]})]}),c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[c.jsx(Ml,{className:"w-4 h-4 sm:w-5 sm:h-5"}),c.jsx("span",{className:"text-xs sm:text-base font-bold",children:"Start Streak"})]}),c.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[c.jsx(If,{className:"w-4 h-4 sm:w-5 sm:h-5"}),c.jsx("span",{className:"text-xs sm:text-base font-bold",children:"Earn Badges"})]})]}),c.jsxs("div",{className:"px-3 py-1.5 sm:px-4 sm:py-2 bg-white/20 backdrop-blur-sm rounded-full text-xs sm:text-base font-bold whitespace-nowrap flex items-center gap-1",children:["Start Challenge",c.jsx(vo,{className:"w-3 h-3 sm:w-4 sm:h-4"})]})]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center",children:c.jsx(Wh,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Did You Know?"}),c.jsx("p",{className:"text-slate-600 text-sm",children:"Surprising nutrition facts about everyday foods"})]})]}),c.jsxs("div",{className:"md:grid md:grid-cols-2 lg:grid-cols-4 md:gap-4 flex md:flex-none overflow-x-auto gap-4 pb-4 md:pb-0 snap-x snap-mandatory scrollbar-hide -mx-4 px-4 md:mx-0 md:px-0",children:[c.jsxs("div",{className:"min-w-[280px] md:min-w-0 snap-center bg-white rounded-2xl border-2 border-orange-200 p-5 hover:shadow-lg transition-all hover:-translate-y-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"text-4xl",children:""}),c.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:c.jsx(Pa,{className:"w-5 h-5 text-green-600"})})]}),c.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Guava Power"}),c.jsxs("p",{className:"text-sm text-slate-600 mb-3",children:["One guava contains ",c.jsx("span",{className:"font-bold text-green-600",children:"3g of protein"})," - more than most fruits!"]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[c.jsx(ns,{className:"w-3 h-3"}),c.jsx("span",{children:"Great for muscle recovery"})]})]}),c.jsxs("div",{className:"min-w-[280px] md:min-w-0 snap-center bg-white rounded-2xl border-2 border-blue-200 p-5 hover:shadow-lg transition-all hover:-translate-y-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"text-4xl",children:""}),c.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:c.jsx(Qh,{className:"w-5 h-5 text-blue-600"})})]}),c.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Spinach Iron"}),c.jsxs("p",{className:"text-sm text-slate-600 mb-3",children:["Spinach has ",c.jsx("span",{className:"font-bold text-blue-600",children:"2.7mg iron"})," per 100g - boosts blood health naturally"]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[c.jsx(zn,{className:"w-3 h-3"}),c.jsx("span",{children:"Prevents anemia"})]})]}),c.jsxs("div",{className:"min-w-[280px] md:min-w-0 snap-center bg-white rounded-2xl border-2 border-purple-200 p-5 hover:shadow-lg transition-all hover:-translate-y-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"text-4xl",children:""}),c.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:c.jsx(xo,{className:"w-5 h-5 text-purple-600"})})]}),c.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Almond Energy"}),c.jsxs("p",{className:"text-sm text-slate-600 mb-3",children:["Just ",c.jsx("span",{className:"font-bold text-purple-600",children:"23 almonds"})," provide 6g protein and healthy fats for brain power"]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[c.jsx(jh,{className:"w-3 h-3"}),c.jsx("span",{children:"Boosts brain function"})]})]}),c.jsxs("div",{className:"min-w-[280px] md:min-w-0 snap-center bg-white rounded-2xl border-2 border-amber-200 p-5 hover:shadow-lg transition-all hover:-translate-y-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"text-4xl",children:""}),c.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center",children:c.jsx(qj,{className:"w-5 h-5 text-amber-600"})})]}),c.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Egg Vitamin D"}),c.jsxs("p",{className:"text-sm text-slate-600 mb-3",children:["One egg yolk has ",c.jsx("span",{className:"font-bold text-amber-600",children:"40 IU Vitamin D"})," - supports bone health"]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[c.jsx(my,{className:"w-3 h-3"}),c.jsx("span",{children:"Strengthens immunity"})]})]})]})]}),c.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-pink-50 to-orange-50 rounded-3xl border-2 border-purple-200 p-6 md:p-8",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:c.jsx(xo,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Coming Soon"}),c.jsx("p",{className:"text-slate-600 text-sm",children:"Exciting new features we're working on"})]})]}),c.jsxs("div",{className:"md:grid md:grid-cols-3 md:gap-4 flex md:flex-none overflow-x-auto gap-4 pb-4 md:pb-0 snap-x snap-mandatory scrollbar-hide -mx-4 px-4 md:mx-0 md:px-0",children:[c.jsxs("div",{className:"min-w-[280px] md:min-w-0 snap-center bg-white/80 backdrop-blur-sm rounded-2xl p-5 border-2 border-purple-200",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:c.jsx(jh,{className:"w-5 h-5 text-purple-600"})}),c.jsx(ja,{className:"w-5 h-5 text-amber-400"})]}),c.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Mental Wellness"}),c.jsx("p",{className:"text-sm text-slate-600",children:"Mood tracking, meditation guides, and stress management tools"})]}),c.jsxs("div",{className:"min-w-[280px] md:min-w-0 snap-center bg-white/80 backdrop-blur-sm rounded-2xl p-5 border-2 border-pink-200",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-lg bg-pink-100 flex items-center justify-center",children:c.jsx(ns,{className:"w-5 h-5 text-pink-600"})}),c.jsx(ja,{className:"w-5 h-5 text-amber-400"})]}),c.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Fitness Coaching"}),c.jsx("p",{className:"text-sm text-slate-600",children:"Personalized workout plans and virtual fitness trainer"})]}),c.jsxs("div",{className:"min-w-[280px] md:min-w-0 snap-center bg-white/80 backdrop-blur-sm rounded-2xl p-5 border-2 border-orange-200",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center",children:c.jsx(my,{className:"w-5 h-5 text-orange-600"})}),c.jsx(ja,{className:"w-5 h-5 text-amber-400"})]}),c.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Health Insurance"}),c.jsx("p",{className:"text-sm text-slate-600",children:"Compare plans and manage your health coverage"})]})]})]}),c.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-emerald-500 rounded-3xl p-8 text-white",children:c.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Need Help Getting Started?"}),c.jsx("p",{className:"text-cyan-50",children:"Our AI assistant is here to guide you through your health journey"})]}),c.jsxs(Ct,{to:"/ai-chat",className:"px-8 py-4 bg-white text-cyan-600 rounded-xl font-bold hover:shadow-2xl transition-all flex items-center gap-2 group",children:[c.jsx(cu,{className:"w-5 h-5"}),"Chat with AI",c.jsx(vo,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"})]})]})})]})]})}function EKe(){var _,w;const{user:e}=as(),[n,s]=z.useState(null),[o,d]=z.useState(!0);if(z.useEffect(()=>{(async()=>{try{const{data:N}=await ra.getDashboard();s(N)}catch(N){console.error("Failed to fetch dashboard:",N)}finally{d(!1)}})()},[]),o)return c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-12 h-12 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-slate-500",children:"Loading dashboard..."})]})});const{doctor:h,stats:f,todaySchedule:v,upcomingSchedule:b}=n||{};return(h==null?void 0:h.approvalStatus)==="pending"?c.jsx("div",{className:"max-w-lg mx-auto mt-20",children:c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 text-center shadow-sm",children:[c.jsx("div",{className:"w-16 h-16 rounded-full bg-amber-100 flex items-center justify-center mx-auto mb-4",children:c.jsx(To,{className:"w-8 h-8 text-amber-500"})}),c.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Approval Pending"}),c.jsx("p",{className:"text-slate-500 mb-4",children:"Your profile is under review. You'll be notified once approved."}),c.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-100 text-amber-700 rounded-xl text-sm font-medium",children:[c.jsx(Vr,{className:"w-4 h-4"})," Pending Review"]})]})}):(h==null?void 0:h.approvalStatus)==="rejected"?c.jsx("div",{className:"max-w-lg mx-auto mt-20",children:c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 text-center shadow-sm",children:[c.jsx("div",{className:"w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mx-auto mb-4",children:c.jsx(VQ,{className:"w-8 h-8 text-red-500"})}),c.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"Application Rejected"}),c.jsx("p",{className:"text-slate-500",children:"Please contact support for more information."})]})}):c.jsxs("div",{className:"space-y-6 animate-fade-in",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[c.jsxs("div",{children:[c.jsxs("h1",{className:"text-2xl font-bold text-slate-800",children:["Welcome, Dr. ",(_=h==null?void 0:h.name)==null?void 0:_.split(" ")[0],"! "]}),c.jsx("p",{className:"text-slate-500 mt-1",children:h==null?void 0:h.specialization})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs(Ct,{to:"/doctor/availability",className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-medium transition-all",children:[c.jsx(pg,{className:"w-4 h-4"})," Manage Slots"]}),h!=null&&h.isListed?c.jsxs("span",{className:"px-3 py-2 bg-green-100 text-green-700 rounded-xl text-sm font-medium flex items-center gap-1",children:[c.jsx(rr,{className:"w-4 h-4"})," Listed"]}):c.jsxs("span",{className:"px-3 py-2 bg-amber-100 text-amber-700 rounded-xl text-sm font-medium flex items-center gap-1",children:[c.jsx(Vr,{className:"w-4 h-4"})," Not Listed"]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center mb-3",children:c.jsx(qr,{className:"w-5 h-5 text-blue-600"})}),c.jsx("p",{className:"text-2xl font-bold text-slate-800",children:(f==null?void 0:f.todayAppointments)||0}),c.jsx("p",{className:"text-sm text-slate-500",children:"Today"})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center mb-3",children:c.jsx(Or,{className:"w-5 h-5 text-green-600"})}),c.jsx("p",{className:"text-2xl font-bold text-slate-800",children:(f==null?void 0:f.upcomingAppointments)||0}),c.jsx("p",{className:"text-sm text-slate-500",children:"Upcoming"})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-purple-100 flex items-center justify-center mb-3",children:c.jsx(Pf,{className:"w-5 h-5 text-purple-600"})}),c.jsx("p",{className:"text-2xl font-bold text-slate-800",children:(f==null?void 0:f.totalPatients)||0}),c.jsx("p",{className:"text-sm text-slate-500",children:"Patients"})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center mb-3",children:c.jsx(ja,{className:"w-5 h-5 text-amber-600"})}),c.jsx("p",{className:"text-2xl font-bold text-slate-800",children:((w=h==null?void 0:h.rating)==null?void 0:w.toFixed(1))||"0.0"}),c.jsx("p",{className:"text-sm text-slate-500",children:"Rating"})]})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[c.jsx("div",{className:"flex items-center justify-between mb-4",children:c.jsxs("h2",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[c.jsx(jn,{className:"w-5 h-5 text-cyan-500"})," Today's Schedule"]})}),(v==null?void 0:v.length)>0?c.jsx("div",{className:"space-y-3",children:v.map(E=>{var N,I,R,O,P;return c.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-cyan-100 flex items-center justify-center text-cyan-600 font-bold",children:((R=(I=(N=E.patient)==null?void 0:N.name)==null?void 0:I[0])==null?void 0:R.toUpperCase())||"P"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-slate-800",children:(O=E.patient)==null?void 0:O.name}),c.jsx("p",{className:"text-sm text-slate-500",children:E.timeSlot})]})]}),c.jsxs(Ct,{to:`/patient/${(P=E.patient)==null?void 0:P._id}?appointmentId=${E._id}`,className:"px-4 py-2 bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 transition-all text-sm flex items-center gap-1",children:[c.jsx(Ll,{className:"w-4 h-4"})," View"]})]},E._id)})}):c.jsxs("div",{className:"text-center py-8 text-slate-500",children:[c.jsx(qr,{className:"w-10 h-10 mx-auto mb-2 text-slate-300"}),c.jsx("p",{children:"No appointments today"})]})]}),(b==null?void 0:b.length)>0&&c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[c.jsxs("h2",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[c.jsx(To,{className:"w-5 h-5 text-green-500"})," Upcoming Appointments"]}),c.jsx("div",{className:"space-y-3",children:b.slice(0,5).map(E=>{var N,I,R,O;return c.jsx("div",{className:"p-4 bg-slate-50 rounded-xl flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center text-green-600 font-bold",children:((R=(I=(N=E.patient)==null?void 0:N.name)==null?void 0:I[0])==null?void 0:R.toUpperCase())||"P"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-slate-800",children:(O=E.patient)==null?void 0:O.name}),c.jsxs("p",{className:"text-sm text-slate-500",children:[new Date(E.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),"  ",E.timeSlot]})]})]})},E._id)})})]})]})}function pp(e,n,s,o){function d(h){return h instanceof s?h:new s(function(f){f(h)})}return new(s||(s=Promise))(function(h,f){function v(w){try{_(o.next(w))}catch(E){f(E)}}function b(w){try{_(o.throw(w))}catch(E){f(E)}}function _(w){w.done?h(w.value):d(w.value).then(v,b)}_((o=o.apply(e,n||[])).next())})}const wKe=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function ig(e,n,s){const o=SKe(e),{webkitRelativePath:d}=e,h=typeof n=="string"?n:typeof d=="string"&&d.length>0?d:`./${e.name}`;return typeof o.path!="string"&&mq(o,"path",h),mq(o,"relativePath",h),o}function SKe(e){const{name:n}=e;if(n&&n.lastIndexOf(".")!==-1&&!e.type){const o=n.split(".").pop().toLowerCase(),d=wKe.get(o);d&&Object.defineProperty(e,"type",{value:d,writable:!1,configurable:!1,enumerable:!0})}return e}function mq(e,n,s){Object.defineProperty(e,n,{value:s,writable:!1,configurable:!1,enumerable:!0})}const TKe=[".DS_Store","Thumbs.db"];function NKe(e){return pp(this,void 0,void 0,function*(){return ZS(e)&&CKe(e.dataTransfer)?OKe(e.dataTransfer,e.type):RKe(e)?AKe(e):Array.isArray(e)&&e.every(n=>"getFile"in n&&typeof n.getFile=="function")?IKe(e):[]})}function CKe(e){return ZS(e)}function RKe(e){return ZS(e)&&ZS(e.target)}function ZS(e){return typeof e=="object"&&e!==null}function AKe(e){return Lk(e.target.files).map(n=>ig(n))}function IKe(e){return pp(this,void 0,void 0,function*(){return(yield Promise.all(e.map(s=>s.getFile()))).map(s=>ig(s))})}function OKe(e,n){return pp(this,void 0,void 0,function*(){if(e.items){const s=Lk(e.items).filter(d=>d.kind==="file");if(n!=="drop")return s;const o=yield Promise.all(s.map(PKe));return fq(Fne(o))}return fq(Lk(e.files).map(s=>ig(s)))})}function fq(e){return e.filter(n=>TKe.indexOf(n.name)===-1)}function Lk(e){if(e===null)return[];const n=[];for(let s=0;s<e.length;s++){const o=e[s];n.push(o)}return n}function PKe(e){if(typeof e.webkitGetAsEntry!="function")return gq(e);const n=e.webkitGetAsEntry();return n&&n.isDirectory?Vne(n):gq(e,n)}function Fne(e){return e.reduce((n,s)=>[...n,...Array.isArray(s)?Fne(s):[s]],[])}function gq(e,n){return pp(this,void 0,void 0,function*(){var s;if(globalThis.isSecureContext&&typeof e.getAsFileSystemHandle=="function"){const h=yield e.getAsFileSystemHandle();if(h===null)throw new Error(`${e} is not a File`);if(h!==void 0){const f=yield h.getFile();return f.handle=h,ig(f)}}const o=e.getAsFile();if(!o)throw new Error(`${e} is not a File`);return ig(o,(s=n==null?void 0:n.fullPath)!==null&&s!==void 0?s:void 0)})}function kKe(e){return pp(this,void 0,void 0,function*(){return e.isDirectory?Vne(e):jKe(e)})}function Vne(e){const n=e.createReader();return new Promise((s,o)=>{const d=[];function h(){n.readEntries(f=>pp(this,void 0,void 0,function*(){if(f.length){const v=Promise.all(f.map(kKe));d.push(v),h()}else try{const v=yield Promise.all(d);s(v)}catch(v){o(v)}}),f=>{o(f)})}h()})}function jKe(e){return pp(this,void 0,void 0,function*(){return new Promise((n,s)=>{e.file(o=>{const d=ig(o,e.fullPath);n(d)},o=>{s(o)})})})}var WO=function(e,n){if(e&&n){var s=Array.isArray(n)?n:n.split(",");if(s.length===0)return!0;var o=e.name||"",d=(e.type||"").toLowerCase(),h=d.replace(/\/.*$/,"");return s.some(function(f){var v=f.trim().toLowerCase();return v.charAt(0)==="."?o.toLowerCase().endsWith(v):v.endsWith("/*")?h===v.replace(/\/.*$/,""):d===v})}return!0};function vq(e){return MKe(e)||LKe(e)||Gne(e)||DKe()}function DKe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LKe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MKe(e){if(Array.isArray(e))return Mk(e)}function yq(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function bq(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?yq(Object(s),!0).forEach(function(o){Bne(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):yq(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function Bne(e,n,s){return n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function Jy(e,n){return VKe(e)||FKe(e,n)||Gne(e,n)||UKe()}function UKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gne(e,n){if(e){if(typeof e=="string")return Mk(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Mk(e,n)}}function Mk(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function FKe(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o=[],d=!0,h=!1,f,v;try{for(s=s.call(e);!(d=(f=s.next()).done)&&(o.push(f.value),!(n&&o.length===n));d=!0);}catch(b){h=!0,v=b}finally{try{!d&&s.return!=null&&s.return()}finally{if(h)throw v}}return o}}function VKe(e){if(Array.isArray(e))return e}var BKe=typeof WO=="function"?WO:WO.default,GKe="file-invalid-type",WKe="file-too-large",$Ke="file-too-small",zKe="too-many-files",HKe=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",s=n.split(","),o=s.length>1?"one of ".concat(s.join(", ")):s[0];return{code:GKe,message:"File type must be ".concat(o)}},xq=function(n){return{code:WKe,message:"File is larger than ".concat(n," ").concat(n===1?"byte":"bytes")}},_q=function(n){return{code:$Ke,message:"File is smaller than ".concat(n," ").concat(n===1?"byte":"bytes")}},KKe={code:zKe,message:"Too many files"};function Wne(e,n){var s=e.type==="application/x-moz-file"||BKe(e,n);return[s,s?null:HKe(n)]}function $ne(e,n,s){if(Ah(e.size))if(Ah(n)&&Ah(s)){if(e.size>s)return[!1,xq(s)];if(e.size<n)return[!1,_q(n)]}else{if(Ah(n)&&e.size<n)return[!1,_q(n)];if(Ah(s)&&e.size>s)return[!1,xq(s)]}return[!0,null]}function Ah(e){return e!=null}function YKe(e){var n=e.files,s=e.accept,o=e.minSize,d=e.maxSize,h=e.multiple,f=e.maxFiles,v=e.validator;return!h&&n.length>1||h&&f>=1&&n.length>f?!1:n.every(function(b){var _=Wne(b,s),w=Jy(_,1),E=w[0],N=$ne(b,o,d),I=Jy(N,1),R=I[0],O=v?v(b):null;return E&&R&&!O})}function eT(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function tw(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(n){return n==="Files"||n==="application/x-moz-file"}):!!e.target&&!!e.target.files}function Eq(e){e.preventDefault()}function qKe(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function XKe(e){return e.indexOf("Edge/")!==-1}function JKe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return qKe(e)||XKe(e)}function Wc(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return function(o){for(var d=arguments.length,h=new Array(d>1?d-1:0),f=1;f<d;f++)h[f-1]=arguments[f];return n.some(function(v){return!eT(o)&&v&&v.apply(void 0,[o].concat(h)),eT(o)})}}function QKe(){return"showOpenFilePicker"in window}function ZKe(e){if(Ah(e)){var n=Object.entries(e).filter(function(s){var o=Jy(s,2),d=o[0],h=o[1],f=!0;return zne(d)||(console.warn('Skipped "'.concat(d,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),f=!1),(!Array.isArray(h)||!h.every(Hne))&&(console.warn('Skipped "'.concat(d,'" because an invalid file extension was provided.')),f=!1),f}).reduce(function(s,o){var d=Jy(o,2),h=d[0],f=d[1];return bq(bq({},s),{},Bne({},h,f))},{});return[{description:"Files",accept:n}]}return e}function eYe(e){if(Ah(e))return Object.entries(e).reduce(function(n,s){var o=Jy(s,2),d=o[0],h=o[1];return[].concat(vq(n),[d],vq(h))},[]).filter(function(n){return zne(n)||Hne(n)}).join(",")}function tYe(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function nYe(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function zne(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||e==="application/*"||/\w+\/[-+.\w]+/g.test(e)}function Hne(e){return/^.*\.[\w]+$/.test(e)}var rYe=["children"],iYe=["open"],sYe=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],aYe=["refKey","onChange","onClick"];function oYe(e){return dYe(e)||lYe(e)||Kne(e)||cYe()}function cYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dYe(e){if(Array.isArray(e))return Uk(e)}function $O(e,n){return pYe(e)||hYe(e,n)||Kne(e,n)||uYe()}function uYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kne(e,n){if(e){if(typeof e=="string")return Uk(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Uk(e,n)}}function Uk(e,n){(n==null||n>e.length)&&(n=e.length);for(var s=0,o=new Array(n);s<n;s++)o[s]=e[s];return o}function hYe(e,n){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var o=[],d=!0,h=!1,f,v;try{for(s=s.call(e);!(d=(f=s.next()).done)&&(o.push(f.value),!(n&&o.length===n));d=!0);}catch(b){h=!0,v=b}finally{try{!d&&s.return!=null&&s.return()}finally{if(h)throw v}}return o}}function pYe(e){if(Array.isArray(e))return e}function wq(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),s.push.apply(s,o)}return s}function Hr(e){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?wq(Object(s),!0).forEach(function(o){Fk(e,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):wq(Object(s)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(s,o))})}return e}function Fk(e,n,s){return n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function tT(e,n){if(e==null)return{};var s=mYe(e,n),o,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(d=0;d<h.length;d++)o=h[d],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(s[o]=e[o])}return s}function mYe(e,n){if(e==null)return{};var s={},o=Object.keys(e),d,h;for(h=0;h<o.length;h++)d=o[h],!(n.indexOf(d)>=0)&&(s[d]=e[d]);return s}var iL=z.forwardRef(function(e,n){var s=e.children,o=tT(e,rYe),d=qne(o),h=d.open,f=tT(d,iYe);return z.useImperativeHandle(n,function(){return{open:h}},[h]),ye.createElement(z.Fragment,null,s(Hr(Hr({},f),{},{open:h})))});iL.displayName="Dropzone";var Yne={disabled:!1,getFilesFromEvent:NKe,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};iL.defaultProps=Yne;iL.propTypes={children:Vt.func,accept:Vt.objectOf(Vt.arrayOf(Vt.string)),multiple:Vt.bool,preventDropOnDocument:Vt.bool,noClick:Vt.bool,noKeyboard:Vt.bool,noDrag:Vt.bool,noDragEventsBubbling:Vt.bool,minSize:Vt.number,maxSize:Vt.number,maxFiles:Vt.number,disabled:Vt.bool,getFilesFromEvent:Vt.func,onFileDialogCancel:Vt.func,onFileDialogOpen:Vt.func,useFsAccessApi:Vt.bool,autoFocus:Vt.bool,onDragEnter:Vt.func,onDragLeave:Vt.func,onDragOver:Vt.func,onDrop:Vt.func,onDropAccepted:Vt.func,onDropRejected:Vt.func,onError:Vt.func,validator:Vt.func};var Vk={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function qne(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Hr(Hr({},Yne),e),s=n.accept,o=n.disabled,d=n.getFilesFromEvent,h=n.maxSize,f=n.minSize,v=n.multiple,b=n.maxFiles,_=n.onDragEnter,w=n.onDragLeave,E=n.onDragOver,N=n.onDrop,I=n.onDropAccepted,R=n.onDropRejected,O=n.onFileDialogCancel,P=n.onFileDialogOpen,M=n.useFsAccessApi,D=n.autoFocus,U=n.preventDropOnDocument,B=n.noClick,G=n.noKeyboard,$=n.noDrag,q=n.noDragEventsBubbling,X=n.onError,ee=n.validator,ce=z.useMemo(function(){return eYe(s)},[s]),Q=z.useMemo(function(){return ZKe(s)},[s]),ae=z.useMemo(function(){return typeof P=="function"?P:Sq},[P]),ve=z.useMemo(function(){return typeof O=="function"?O:Sq},[O]),le=z.useRef(null),fe=z.useRef(null),re=z.useReducer(fYe,Vk),he=$O(re,2),J=he[0],ue=he[1],Ee=J.isFocused,Fe=J.isFileDialogActive,ke=z.useRef(typeof window<"u"&&window.isSecureContext&&M&&QKe()),Ge=function(){!ke.current&&Fe&&setTimeout(function(){if(fe.current){var Ze=fe.current.files;Ze.length||(ue({type:"closeDialog"}),ve())}},300)};z.useEffect(function(){return window.addEventListener("focus",Ge,!1),function(){window.removeEventListener("focus",Ge,!1)}},[fe,Fe,ve,ke]);var De=z.useRef([]),Pe=function(Ze){le.current&&le.current.contains(Ze.target)||(Ze.preventDefault(),De.current=[])};z.useEffect(function(){return U&&(document.addEventListener("dragover",Eq,!1),document.addEventListener("drop",Pe,!1)),function(){U&&(document.removeEventListener("dragover",Eq),document.removeEventListener("drop",Pe))}},[le,U]),z.useEffect(function(){return!o&&D&&le.current&&le.current.focus(),function(){}},[le,D,o]);var Ve=z.useCallback(function(Ne){X?X(Ne):console.error(Ne)},[X]),it=z.useCallback(function(Ne){Ne.preventDefault(),Ne.persist(),Yn(Ne),De.current=[].concat(oYe(De.current),[Ne.target]),tw(Ne)&&Promise.resolve(d(Ne)).then(function(Ze){if(!(eT(Ne)&&!q)){var Gn=Ze.length,on=Gn>0&&YKe({files:Ze,accept:ce,minSize:f,maxSize:h,multiple:v,maxFiles:b,validator:ee}),Br=Gn>0&&!on;ue({isDragAccept:on,isDragReject:Br,isDragActive:!0,type:"setDraggedFiles"}),_&&_(Ne)}}).catch(function(Ze){return Ve(Ze)})},[d,_,Ve,q,ce,f,h,v,b,ee]),Mt=z.useCallback(function(Ne){Ne.preventDefault(),Ne.persist(),Yn(Ne);var Ze=tw(Ne);if(Ze&&Ne.dataTransfer)try{Ne.dataTransfer.dropEffect="copy"}catch{}return Ze&&E&&E(Ne),!1},[E,q]),tt=z.useCallback(function(Ne){Ne.preventDefault(),Ne.persist(),Yn(Ne);var Ze=De.current.filter(function(on){return le.current&&le.current.contains(on)}),Gn=Ze.indexOf(Ne.target);Gn!==-1&&Ze.splice(Gn,1),De.current=Ze,!(Ze.length>0)&&(ue({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),tw(Ne)&&w&&w(Ne))},[le,w,q]),ft=z.useCallback(function(Ne,Ze){var Gn=[],on=[];Ne.forEach(function(Br){var Wi=Wne(Br,ce),Fs=$O(Wi,2),al=Fs[0],mp=Fs[1],fp=$ne(Br,f,h),Va=$O(fp,2),gp=Va[0],Og=Va[1],Pg=ee?ee(Br):null;if(al&&gp&&!Pg)Gn.push(Br);else{var vc=[mp,Og];Pg&&(vc=vc.concat(Pg)),on.push({file:Br,errors:vc.filter(function(bb){return bb})})}}),(!v&&Gn.length>1||v&&b>=1&&Gn.length>b)&&(Gn.forEach(function(Br){on.push({file:Br,errors:[KKe]})}),Gn.splice(0)),ue({acceptedFiles:Gn,fileRejections:on,isDragReject:on.length>0,type:"setFiles"}),N&&N(Gn,on,Ze),on.length>0&&R&&R(on,Ze),Gn.length>0&&I&&I(Gn,Ze)},[ue,v,ce,f,h,b,N,I,R,ee]),Rt=z.useCallback(function(Ne){Ne.preventDefault(),Ne.persist(),Yn(Ne),De.current=[],tw(Ne)&&Promise.resolve(d(Ne)).then(function(Ze){eT(Ne)&&!q||ft(Ze,Ne)}).catch(function(Ze){return Ve(Ze)}),ue({type:"reset"})},[d,ft,Ve,q]),Te=z.useCallback(function(){if(ke.current){ue({type:"openDialog"}),ae();var Ne={multiple:v,types:Q};window.showOpenFilePicker(Ne).then(function(Ze){return d(Ze)}).then(function(Ze){ft(Ze,null),ue({type:"closeDialog"})}).catch(function(Ze){tYe(Ze)?(ve(Ze),ue({type:"closeDialog"})):nYe(Ze)?(ke.current=!1,fe.current?(fe.current.value=null,fe.current.click()):Ve(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Ve(Ze)});return}fe.current&&(ue({type:"openDialog"}),ae(),fe.current.value=null,fe.current.click())},[ue,ae,ve,M,ft,Ve,Q,v]),st=z.useCallback(function(Ne){!le.current||!le.current.isEqualNode(Ne.target)||(Ne.key===" "||Ne.key==="Enter"||Ne.keyCode===32||Ne.keyCode===13)&&(Ne.preventDefault(),Te())},[le,Te]),ct=z.useCallback(function(){ue({type:"focus"})},[]),zt=z.useCallback(function(){ue({type:"blur"})},[]),Ke=z.useCallback(function(){B||(JKe()?setTimeout(Te,0):Te())},[B,Te]),xe=function(Ze){return o?null:Ze},Je=function(Ze){return G?null:xe(Ze)},yt=function(Ze){return $?null:xe(Ze)},Yn=function(Ze){q&&Ze.stopPropagation()},Jr=z.useMemo(function(){return function(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ze=Ne.refKey,Gn=Ze===void 0?"ref":Ze,on=Ne.role,Br=Ne.onKeyDown,Wi=Ne.onFocus,Fs=Ne.onBlur,al=Ne.onClick,mp=Ne.onDragEnter,fp=Ne.onDragOver,Va=Ne.onDragLeave,gp=Ne.onDrop,Og=tT(Ne,sYe);return Hr(Hr(Fk({onKeyDown:Je(Wc(Br,st)),onFocus:Je(Wc(Wi,ct)),onBlur:Je(Wc(Fs,zt)),onClick:xe(Wc(al,Ke)),onDragEnter:yt(Wc(mp,it)),onDragOver:yt(Wc(fp,Mt)),onDragLeave:yt(Wc(Va,tt)),onDrop:yt(Wc(gp,Rt)),role:typeof on=="string"&&on!==""?on:"presentation"},Gn,le),!o&&!G?{tabIndex:0}:{}),Og)}},[le,st,ct,zt,Ke,it,Mt,tt,Rt,G,$,o]),os=z.useCallback(function(Ne){Ne.stopPropagation()},[]),Ao=z.useMemo(function(){return function(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ze=Ne.refKey,Gn=Ze===void 0?"ref":Ze,on=Ne.onChange,Br=Ne.onClick,Wi=tT(Ne,aYe),Fs=Fk({accept:ce,multiple:v,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:xe(Wc(on,Rt)),onClick:xe(Wc(Br,os)),tabIndex:-1},Gn,fe);return Hr(Hr({},Fs),Wi)}},[fe,s,v,Rt,o]);return Hr(Hr({},J),{},{isFocused:Ee&&!o,getRootProps:Jr,getInputProps:Ao,rootRef:le,inputRef:fe,open:xe(Te)})}function fYe(e,n){switch(n.type){case"focus":return Hr(Hr({},e),{},{isFocused:!0});case"blur":return Hr(Hr({},e),{},{isFocused:!1});case"openDialog":return Hr(Hr({},Vk),{},{isFileDialogActive:!0});case"closeDialog":return Hr(Hr({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return Hr(Hr({},e),{},{isDragActive:n.isDragActive,isDragAccept:n.isDragAccept,isDragReject:n.isDragReject});case"setFiles":return Hr(Hr({},e),{},{acceptedFiles:n.acceptedFiles,fileRejections:n.fileRejections,isDragReject:n.isDragReject});case"reset":return Hr({},Vk);default:return e}}function Sq(){}const gYe=[{value:"Blood Test",label:"Blood Test"},{value:"X-Ray",label:"X-Ray"},{value:"MRI",label:"MRI"},{value:"CT Scan",label:"CT Scan"},{value:"ECG",label:"ECG"},{value:"Ultrasound",label:"Ultrasound"},{value:"General Checkup",label:"General Checkup"},{value:"Other",label:"Other"}];function vYe(){const[e,n]=z.useState([]),[s,o]=z.useState(!1),[d,h]=z.useState(0),f=Us();z.useState(()=>{window.scrollTo(0,0)},[]);const v=z.useCallback(R=>{const O=R.map(P=>({file:P,id:Math.random().toString(36).substr(2,9),reportType:"Blood Test",name:P.name,size:P.size}));n(P=>[...P,...O])},[]),{getRootProps:b,getInputProps:_,isDragActive:w}=qne({onDrop:v,accept:{"application/pdf":[".pdf"],"image/*":[".png",".jpg",".jpeg"]},maxSize:10*1024*1024}),E=(R,O)=>{n(P=>P.map(M=>M.id===R?{...M,reportType:O}:M))},N=R=>{n(O=>O.filter(P=>P.id!==R))},I=async R=>{var P,M;if(R.preventDefault(),e.length===0){et.error("Please select at least one file");return}o(!0),h(0);const O=setInterval(()=>{h(D=>D>=90?(clearInterval(O),90):D+10)},500);try{const D=new FormData;D.append("report",e[0].file),D.append("reportType",e[0].reportType);const{data:U}=await da.uploadReport(D);clearInterval(O),h(100),et.success("Report analyzed successfully!"),setTimeout(()=>f(`/reports/${U.report._id}`),500)}catch(D){clearInterval(O),et.error(((M=(P=D.response)==null?void 0:P.data)==null?void 0:M.message)||"Failed to analyze report"),h(0)}finally{o(!1)}};return c.jsxs("div",{className:"space-y-3 sm:space-y-6 animate-fade-in p-4 max-w-4xl mx-auto",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-slate-800",children:"Upload Medical Reports"}),c.jsx("p",{className:"text-slate-500 mt-1 text-xs sm:text-sm",children:"Upload your medical documents for AI-powered analysis"})]}),c.jsxs("div",{...b(),className:`relative border-2 border-dashed rounded-2xl p-6 sm:p-12 text-center cursor-pointer transition-all ${w?"border-cyan-500 bg-cyan-50":"border-slate-300 hover:border-cyan-400 bg-white"}`,children:[c.jsx("input",{..._()}),c.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-cyan-100 flex items-center justify-center mx-auto mb-3 sm:mb-4",children:c.jsx(Es,{className:"w-6 h-6 sm:w-8 sm:h-8 text-cyan-600"})}),c.jsx("p",{className:"text-base sm:text-lg font-semibold text-slate-800 mb-1 sm:mb-2",children:w?"Drop files here":"Tap to upload"}),c.jsx("p",{className:"text-slate-500 mb-3 sm:mb-4 text-xs sm:text-sm",children:"PDF, PNG, JPG  Max 10MB"}),c.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 text-xs sm:text-sm text-slate-600",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(rr,{className:"w-3 h-3 sm:w-4 sm:h-4 text-emerald-500"})," PDF"]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(rr,{className:"w-3 h-3 sm:w-4 sm:h-4 text-emerald-500"})," PNG"]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(rr,{className:"w-3 h-3 sm:w-4 sm:h-4 text-emerald-500"})," JPG"]})]})]}),e.length>0&&c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden shadow-sm",children:[c.jsx("div",{className:"p-3 sm:p-4 border-b border-slate-200",children:c.jsxs("h3",{className:"font-semibold text-slate-800 text-sm sm:text-base",children:["Files (",e.length,")"]})}),c.jsx("div",{className:"divide-y divide-slate-200 max-h-[200px] overflow-y-auto",children:e.map(R=>c.jsxs("div",{className:"p-3 sm:p-4 flex items-center gap-2 sm:gap-4",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-cyan-100 flex items-center justify-center flex-shrink-0",children:c.jsx(Vn,{className:"w-4 h-4 sm:w-5 sm:h-5 text-cyan-600"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"font-medium text-slate-800 truncate text-xs sm:text-sm",children:R.name}),c.jsxs("p",{className:"text-xs text-slate-500",children:[(R.size/1024/1024).toFixed(2)," MB"]})]}),c.jsxs("div",{className:"relative flex-shrink-0",children:[c.jsx("select",{value:R.reportType,onChange:O=>E(R.id,O.target.value),className:"appearance-none bg-white text-slate-800 text-xs sm:text-sm px-2 py-1 sm:px-4 sm:py-2 pr-6 sm:pr-8 rounded-xl border border-slate-300 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none cursor-pointer",children:gYe.map(O=>c.jsx("option",{value:O.value,children:O.label},O.value))}),c.jsx(mu,{className:"absolute right-1 sm:right-2 top-1/2 -translate-y-1/2 w-3 h-3 sm:w-4 sm:h-4 text-slate-400 pointer-events-none"})]}),c.jsx("button",{onClick:()=>N(R.id),className:"p-1.5 sm:p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all flex-shrink-0",children:c.jsx(lu,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]},R.id))})]}),s&&c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-4 sm:p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 mb-3 sm:mb-4",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-cyan-100 flex items-center justify-center",children:c.jsx(cH,{className:"w-4 h-4 sm:w-5 sm:h-5 text-cyan-600 animate-spin"})}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold text-slate-800 text-sm sm:text-base",children:"Analyzing..."}),c.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"AI is extracting insights"})]})]}),c.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full transition-all duration-500",style:{width:`${d}%`}})}),c.jsxs("p",{className:"text-xs sm:text-sm text-slate-500 mt-2 text-right",children:[d,"%"]})]}),c.jsx("button",{onClick:I,disabled:s||e.length===0,className:"w-full py-3 sm:py-4 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-xl hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm sm:text-base",children:s?c.jsxs(c.Fragment,{children:[c.jsx(cH,{className:"w-4 h-4 sm:w-5 sm:h-5 animate-spin"}),"Analyzing..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Es,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Upload & Analyze"]})}),c.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs sm:text-sm text-slate-500 pt-2",children:[c.jsx(my,{className:"w-3 h-3 sm:w-4 sm:h-4"}),c.jsx("span",{children:"Encrypted & HIPAA Compliant"})]})]})}const yYe={en:{whatIsIt:"What is",whenHigh:"When High",whenLow:"When Low",howToImprove:"How to Improve",gotIt:"Got it"},hi:{whatIsIt:"  ",whenHigh:"  ",whenLow:"  ",howToImprove:"  ",gotIt:" "}},zO={},bYe=({metric:e,onClose:n})=>{const[s,o]=z.useState("en"),[d,h]=z.useState(null),[f,v]=z.useState(!0),[b,_]=z.useState(!1);if(!e)return console.error("MetricDetailModal: metric is undefined or null"),c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[9999] p-4",onClick:n,children:c.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-md text-center",children:[c.jsx("p",{className:"text-slate-600 mb-4",children:"Unable to load metric information"}),c.jsx("button",{onClick:n,className:"px-6 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600",children:"Close"})]})});const w=()=>{const O=(e==null?void 0:e.name)||"Unknown Metric",P=(e==null?void 0:e.value)||"N/A",M=(e==null?void 0:e.unit)||"";return{en:{name:O,whatIsIt:`${O} is a health metric. Your current value is ${P} ${M}.`,whenHighTitle:"When High",whenHighEffects:["Please consult with a healthcare professional"],whenLowTitle:"When Low",whenLowEffects:["Please consult with a healthcare professional"],solutions:["Consult with your doctor for personalized advice"]},hi:{name:O,whatIsIt:`${O}    `,whenHighTitle:"  ",whenHighEffects:["    "],whenLowTitle:"  ",whenLowEffects:["    "],solutions:["        "]}}};if(z.useEffect(()=>{if(!e||!e.name){console.error("MetricDetailModal useEffect: metric is invalid",e),h(w()),v(!1);return}v(!0),_(!1),(async()=>{try{const P=`${e.name}-${e.value}`;if(zO[P]){console.log(" Using cached metric info for:",e.name),h(zO[P]),_(!0),v(!1);return}console.log(" Fetching AI-generated metric info for:",e.name);const M=await da.getMetricInfo({metricName:e.name,metricValue:e.value,normalRange:e.normalRange,unit:e.unit});if(console.log(" Received AI metric info:",M.data),!M.data||!M.data.metricInfo){console.error("Invalid AI response structure:",M.data),h(w()),v(!1);return}zO[P]=M.data.metricInfo,h(M.data.metricInfo),_(!0),v(!1)}catch(P){console.error("Error fetching metric info:",P),h(w()),v(!1)}})()},[e]),!e||!d)return null;const E=d[s]||d.en||{name:(e==null?void 0:e.name)||"Unknown Metric",whatIsIt:"Information not available",whenHighTitle:"When High",whenHighEffects:["Please consult with a healthcare professional"],whenLowTitle:"When Low",whenLowEffects:["Please consult with a healthcare professional"],solutions:["Consult with your doctor for personalized advice"]},N=yYe[s];e!=null&&e.name,e!=null&&e.value;const I=(e==null?void 0:e.unit)||"",R=(e==null?void 0:e.normalRange)||"N/A";return c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-end sm:items-center justify-center z-[9999] p-0 sm:p-4",onClick:n,children:c.jsxs("div",{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-2xl max-h-[90vh] overflow-y-auto p-5 sm:p-6 relative animate-slide-up sm:animate-fade-in shadow-xl",onClick:O=>O.stopPropagation(),children:[c.jsx("div",{className:"w-12 h-1 bg-slate-300 rounded-full mx-auto mb-4 sm:hidden"}),c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-slate-800 mb-2",children:E.name}),c.jsxs("p",{className:"text-slate-600",children:[s==="hi"?" ":"Normal Range",": ",c.jsxs("span",{className:"font-semibold text-cyan-600",children:[R," ",I]})]})]}),c.jsx("div",{className:"flex flex-col items-end gap-2",children:c.jsxs("select",{value:s,onChange:O=>o(O.target.value),className:"px-3 py-2 bg-white border-2 border-slate-200 rounded-lg text-sm font-medium text-slate-700 cursor-pointer hover:border-cyan-400 focus:outline-none focus:border-cyan-500 transition-colors",children:[c.jsx("option",{value:"en",children:"English"}),c.jsx("option",{value:"hi",children:""})]})})]}),c.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600 p-1",children:c.jsx(di,{className:"w-5 h-5"})}),f?c.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[c.jsx("div",{className:"w-12 h-12 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mb-4"}),c.jsx("p",{className:"text-slate-600 font-medium",children:"Generating AI insights..."}),c.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"This usually takes 2-3 seconds"})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"mb-6 p-4 bg-cyan-50 rounded-xl border-2 border-cyan-200",children:[c.jsxs("h3",{className:"text-lg font-bold text-cyan-700 mb-2",children:[N.whatIsIt," ",E.name,"?"]}),c.jsx("p",{className:"text-slate-700 leading-relaxed",children:E.whatIsIt})]}),c.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-xl border-2 border-red-200",children:[c.jsx("h3",{className:"text-lg font-bold text-red-700 mb-3",children:E.whenHighTitle}),c.jsx("ul",{className:"space-y-2",children:E.whenHighEffects&&Array.isArray(E.whenHighEffects)&&E.whenHighEffects.map((O,P)=>c.jsxs("li",{className:"flex items-start gap-2 text-slate-700",children:[c.jsx("span",{className:"text-red-500 font-bold mt-0.5",children:""}),O]},P))})]}),c.jsxs("div",{className:"mb-6 p-4 bg-amber-50 rounded-xl border-2 border-amber-200",children:[c.jsx("h3",{className:"text-lg font-bold text-amber-700 mb-3",children:E.whenLowTitle}),c.jsx("ul",{className:"space-y-2",children:E.whenLowEffects&&Array.isArray(E.whenLowEffects)&&E.whenLowEffects.map((O,P)=>c.jsxs("li",{className:"flex items-start gap-2 text-slate-700",children:[c.jsx("span",{className:"text-amber-500 font-bold mt-0.5",children:""}),O]},P))})]}),c.jsxs("div",{className:"mb-6 p-4 bg-emerald-50 rounded-xl border-2 border-emerald-200",children:[c.jsxs("h3",{className:"text-lg font-bold text-emerald-700 mb-3",children:[" ",N.howToImprove]}),c.jsx("ul",{className:"space-y-2",children:E.solutions&&Array.isArray(E.solutions)&&E.solutions.map((O,P)=>c.jsxs("li",{className:"flex items-start gap-2 text-slate-700",children:[c.jsx("span",{className:"text-emerald-500 font-bold mt-0.5",children:""}),O]},P))})]}),b&&c.jsx("div",{className:"mb-4 p-2 bg-green-50 rounded-lg border border-green-200 flex items-center gap-2",children:c.jsx("span",{className:"text-green-600 text-sm",children:" AI-Generated Information"})}),c.jsx("button",{onClick:n,className:"w-full py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium rounded-xl transition-colors sm:hidden",children:N.gotIt})]})]})})};function xYe(){var P,M,D,U,B,G,$,q,X,ee,ce,Q,ae,ve,le,fe,re,he;const{id:e}=rb(),[n,s]=z.useState(null),[o,d]=z.useState(!0),[h,f]=z.useState(null),[v,b]=z.useState(!1),[_,w]=z.useState(null),[E,N]=z.useState(null);z.useEffect(()=>{(async()=>{try{const{data:ue}=await da.getReport(e);s(ue.report)}catch{et.error("Failed to load report")}finally{d(!1)}})()},[e]);const I=async()=>{try{const{data:J}=await da.compareReport(e);J.comparison?(N(J),w(J.previousReport),b(!0)):et.info("No previous report found for comparison")}catch{et.error("Failed to load comparison data")}};if(o)return c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-slate-400",children:"Loading report..."})]})});if(!n)return c.jsx("div",{className:"text-center py-12 text-slate-400",children:"Report not found"});const{aiAnalysis:R}=n,O=(R==null?void 0:R.healthScore)||0;return c.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 animate-fade-in",children:[h&&c.jsx(bYe,{metric:h,onClose:()=>f(null)}),c.jsxs(Ct,{to:"/dashboard",className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 font-medium transition-colors",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back to Dashboard"]}),c.jsxs("div",{className:"bg-gradient-to-r from-cyan-600 to-blue-600 rounded-2xl p-6 text-white relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 opacity-10",children:c.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white rounded-full -translate-y-1/2 translate-x-1/2"})}),c.jsxs("div",{className:"relative flex flex-col md:flex-row md:items-center justify-between gap-6",children:[c.jsxs("div",{className:"flex items-center gap-5",children:[c.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center",children:c.jsx(Vn,{className:"w-8 h-8"})}),c.jsxs("div",{children:[c.jsxs("h1",{className:"text-2xl font-bold",children:[n.reportType," Report"]}),c.jsxs("p",{className:"text-white/70",children:["Analyzed on ",new Date(n.createdAt).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]}),((P=n.aiAnalysis)==null?void 0:P.patientName)&&n.aiAnalysis.patientName!=="Patient"&&c.jsxs("p",{className:"text-white/90 text-sm mt-2 font-semibold",children:[" ",n.aiAnalysis.patientName,((M=n.aiAnalysis)==null?void 0:M.patientAge)&&n.aiAnalysis.patientAge!=="N/A"&&`  Age: ${n.aiAnalysis.patientAge}`,((D=n.aiAnalysis)==null?void 0:D.patientGender)&&n.aiAnalysis.patientGender!=="N/A"&&`  ${n.aiAnalysis.patientGender}`]}),((U=n.aiAnalysis)==null?void 0:U.reportDate)&&n.aiAnalysis.reportDate!=="N/A"&&c.jsxs("p",{className:"text-white/70 text-sm",children:[" Report Date: ",n.aiAnalysis.reportDate]})]})]}),c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsxs("div",{className:"text-center p-4 bg-white/10 backdrop-blur-sm rounded-xl",children:[c.jsx("p",{className:"text-4xl font-bold",children:O}),c.jsx("p",{className:"text-sm text-white/70",children:"Health Score"})]}),c.jsxs("button",{onClick:I,className:"px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-all flex items-center gap-2 text-sm font-medium",children:[c.jsx(RQ,{className:"w-4 h-4"}),"Compare with Previous"]})]})]})]}),(R==null?void 0:R.summary)&&c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-6 shadow-sm",children:[c.jsxs("h2",{className:"text-lg font-bold text-slate-800 mb-3 flex items-center gap-2",children:[c.jsx(jn,{className:"w-5 h-5 text-cyan-500"})," Summary"]}),c.jsx("p",{className:"text-slate-700 leading-relaxed mb-4",children:R.summary}),(R==null?void 0:R.keyFindings)&&R.keyFindings.length>0&&c.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-xl border-2 border-blue-200",children:[c.jsx("h3",{className:"font-semibold text-blue-900 mb-3",children:" Key Findings"}),c.jsx("ul",{className:"space-y-2",children:R.keyFindings.map((J,ue)=>c.jsxs("li",{className:"flex items-start gap-2 text-slate-700",children:[c.jsx("span",{className:"text-blue-500 font-bold mt-0.5",children:""}),J]},ue))})]})]}),(R==null?void 0:R.metrics)&&Object.keys(R.metrics).length>0&&c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-6 shadow-sm",children:[c.jsx("h2",{className:"text-lg font-bold text-slate-800 mb-6",children:"All Health Metrics"}),c.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(R.metrics).map(([J,ue])=>c.jsxs("button",{onClick:()=>f({key:J,name:J.replace(/([A-Z])/g," $1"),...ue}),className:`p-4 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md hover:scale-105 text-left ${ue.status==="normal"?"bg-emerald-50 border-emerald-200 hover:border-emerald-300":ue.status==="borderline"?"bg-amber-50 border-amber-200 hover:border-amber-300":"bg-red-50 border-red-200 hover:border-red-300"}`,children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("p",{className:"text-sm text-slate-600 capitalize font-medium",children:J.replace(/([A-Z])/g," $1")}),c.jsx(Ll,{className:"w-4 h-4 text-slate-400"})]}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800",children:[ue.value," ",c.jsx("span",{className:"text-sm font-normal text-slate-500",children:ue.unit})]}),c.jsxs("div",{className:"flex items-center justify-between mt-2",children:[c.jsxs("span",{className:"text-xs text-slate-600",children:["Normal: ",ue.normalRange]}),c.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${ue.status==="normal"?"bg-emerald-100 text-emerald-700":ue.status==="borderline"?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"}`,children:ue.status})]})]},J))})]}),((B=R==null?void 0:R.deficiencies)==null?void 0:B.length)>0&&c.jsxs("div",{className:"bg-white rounded-2xl border-l-4 border-amber-500 border-t-2 border-r-2 border-b-2 border-t-slate-200 border-r-slate-200 border-b-slate-200 p-6 shadow-sm",children:[c.jsxs("h2",{className:"text-lg font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx(Qh,{className:"w-5 h-5 text-amber-500"})," Detected Deficiencies"]}),c.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:R.deficiencies.map((J,ue)=>{var Ee;return c.jsxs("button",{onClick:()=>J.name&&f({key:J.name.toLowerCase().replace(/\s+/g,""),name:J.name,value:J.currentValue,normalRange:J.normalRange,unit:""}),className:`p-4 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md hover:scale-105 text-left ${J.severity==="severe"?"bg-red-50 border-red-200 hover:border-red-300":J.severity==="moderate"?"bg-amber-50 border-amber-200 hover:border-amber-300":"bg-yellow-50 border-yellow-200 hover:border-yellow-300"}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"font-bold text-slate-800",children:J.name||"Unknown Deficiency"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${J.severity==="severe"?"bg-red-100 text-red-700":J.severity==="moderate"?"bg-amber-100 text-amber-700":"bg-yellow-100 text-yellow-700"}`,children:J.severity||"unknown"}),c.jsx(Ll,{className:"w-4 h-4 text-slate-400"})]})]}),c.jsxs("p",{className:"text-sm text-slate-700 font-medium",children:["Current: ",J.currentValue||"N/A"]}),c.jsxs("p",{className:"text-sm text-slate-600",children:["Normal: ",J.normalRange||"N/A"]}),((Ee=J.symptoms)==null?void 0:Ee.length)>0&&c.jsxs("p",{className:"text-xs text-slate-600 mt-2",children:["Symptoms: ",J.symptoms.join(", ")]})]},ue)})})]}),((G=R==null?void 0:R.supplements)==null?void 0:G.length)>0&&c.jsxs("div",{className:"bg-white rounded-2xl border-l-4 border-purple-500 border-t-2 border-r-2 border-b-2 border-t-slate-200 border-r-slate-200 border-b-slate-200 p-6 shadow-sm",children:[c.jsxs("h2",{className:"text-lg font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx(ka,{className:"w-5 h-5 text-purple-500"})," Recommended Supplements & Natural Sources"]}),c.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:R.supplements.map((J,ue)=>c.jsxs("div",{className:"p-4 bg-purple-50 rounded-xl border-2 border-purple-200",children:[c.jsx("div",{className:"flex items-start justify-between mb-2",children:c.jsx("h3",{className:"font-bold text-slate-800",children:J.category})}),c.jsxs("p",{className:"text-sm text-slate-700 mb-2",children:[c.jsx("strong",{children:"Why:"})," ",J.reason]}),c.jsxs("p",{className:"text-sm text-slate-700 mb-2",children:[c.jsx("strong",{children:"Natural Sources:"})," ",J.naturalSources]}),c.jsxs("p",{className:"text-xs text-slate-600 italic",children:[" ",J.note]})]},ue))})]}),(R==null?void 0:R.dietPlan)&&c.jsxs("div",{className:"bg-white rounded-2xl border-l-4 border-green-500 border-t-2 border-r-2 border-b-2 border-t-slate-200 border-r-slate-200 border-b-slate-200 p-6 shadow-sm",children:[c.jsxs("h2",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[c.jsx(UNe,{className:"w-5 h-5 text-green-500"})," Personalized Diet Plan"]}),c.jsx("p",{className:"text-slate-700 mb-6 font-medium",children:R.dietPlan.overview}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[(($=R.dietPlan.breakfast)==null?void 0:$.length)>0&&c.jsxs("div",{className:"p-4 bg-orange-50 rounded-xl border-2 border-orange-200",children:[c.jsx("h3",{className:"font-bold text-orange-700 mb-3",children:" Breakfast"}),R.dietPlan.breakfast.map((J,ue)=>{var Ee;return c.jsxs("div",{className:"mb-3 pb-3 border-b border-orange-200 last:border-0",children:[c.jsx("p",{className:"font-medium text-slate-800",children:J.meal}),c.jsxs("p",{className:"text-xs text-slate-600",children:["Nutrients: ",(Ee=J.nutrients)==null?void 0:Ee.join(", ")]}),c.jsxs("p",{className:"text-xs text-orange-600 italic",children:[" ",J.tip]})]},ue)})]}),((q=R.dietPlan.lunch)==null?void 0:q.length)>0&&c.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl border-2 border-blue-200",children:[c.jsx("h3",{className:"font-bold text-blue-700 mb-3",children:" Lunch"}),R.dietPlan.lunch.map((J,ue)=>{var Ee;return c.jsxs("div",{className:"mb-3 pb-3 border-b border-blue-200 last:border-0",children:[c.jsx("p",{className:"font-medium text-slate-800",children:J.meal}),c.jsxs("p",{className:"text-xs text-slate-600",children:["Nutrients: ",(Ee=J.nutrients)==null?void 0:Ee.join(", ")]}),c.jsxs("p",{className:"text-xs text-blue-600 italic",children:[" ",J.tip]})]},ue)})]}),((X=R.dietPlan.dinner)==null?void 0:X.length)>0&&c.jsxs("div",{className:"p-4 bg-indigo-50 rounded-xl border-2 border-indigo-200",children:[c.jsx("h3",{className:"font-bold text-indigo-700 mb-3",children:" Dinner"}),R.dietPlan.dinner.map((J,ue)=>{var Ee;return c.jsxs("div",{className:"mb-3 pb-3 border-b border-indigo-200 last:border-0",children:[c.jsx("p",{className:"font-medium text-slate-800",children:J.meal}),c.jsxs("p",{className:"text-xs text-slate-600",children:["Nutrients: ",(Ee=J.nutrients)==null?void 0:Ee.join(", ")]}),c.jsxs("p",{className:"text-xs text-indigo-600 italic",children:[" ",J.tip]})]},ue)})]}),((ee=R.dietPlan.snacks)==null?void 0:ee.length)>0&&c.jsxs("div",{className:"p-4 bg-pink-50 rounded-xl border-2 border-pink-200",children:[c.jsx("h3",{className:"font-bold text-pink-700 mb-3",children:" Snacks"}),R.dietPlan.snacks.map((J,ue)=>{var Ee;return c.jsxs("div",{className:"mb-3 pb-3 border-b border-pink-200 last:border-0",children:[c.jsx("p",{className:"font-medium text-slate-800",children:J.meal}),c.jsxs("p",{className:"text-xs text-slate-600",children:["Nutrients: ",(Ee=J.nutrients)==null?void 0:Ee.join(", ")]}),c.jsxs("p",{className:"text-xs text-pink-600 italic",children:[" ",J.tip]})]},ue)})]})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[((ce=R.dietPlan.foodsToIncrease)==null?void 0:ce.length)>0&&c.jsxs("div",{className:"p-4 bg-emerald-50 rounded-xl border-2 border-emerald-200",children:[c.jsx("h3",{className:"font-bold text-emerald-700 mb-2",children:" Foods to Increase"}),c.jsx("ul",{className:"space-y-1",children:R.dietPlan.foodsToIncrease.map((J,ue)=>c.jsxs("li",{className:"text-sm text-slate-700",children:[" ",J]},ue))})]}),((Q=R.dietPlan.foodsToLimit)==null?void 0:Q.length)>0&&c.jsxs("div",{className:"p-4 bg-red-50 rounded-xl border-2 border-red-200",children:[c.jsx("h3",{className:"font-bold text-red-700 mb-2",children:" Foods to Limit"}),c.jsx("ul",{className:"space-y-1",children:R.dietPlan.foodsToLimit.map((J,ue)=>c.jsxs("li",{className:"text-sm text-slate-700",children:[" ",J]},ue))})]})]}),R.dietPlan.hydration&&c.jsxs("div",{className:"p-4 bg-cyan-50 rounded-xl border-2 border-cyan-200 mb-4",children:[c.jsx("h3",{className:"font-bold text-cyan-700 mb-2",children:" Hydration"}),c.jsx("p",{className:"text-sm text-slate-700",children:R.dietPlan.hydration})]}),((ae=R.dietPlan.tips)==null?void 0:ae.length)>0&&c.jsxs("div",{className:"p-4 bg-yellow-50 rounded-xl border-2 border-yellow-200",children:[c.jsx("h3",{className:"font-bold text-yellow-700 mb-2",children:" Tips"}),c.jsx("ul",{className:"space-y-1",children:R.dietPlan.tips.map((J,ue)=>c.jsxs("li",{className:"text-sm text-slate-700",children:[" ",J]},ue))})]})]}),(R==null?void 0:R.recommendations)&&c.jsxs("div",{className:"bg-white rounded-2xl border-l-4 border-red-500 border-t-2 border-r-2 border-b-2 border-t-slate-200 border-r-slate-200 border-b-slate-200 p-6 shadow-sm",children:[c.jsxs("h2",{className:"text-lg font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx(zn,{className:"w-5 h-5 text-red-500"})," Health Recommendations"]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[((ve=R.recommendations.lifestyle)==null?void 0:ve.length)>0&&c.jsxs("div",{className:"p-4 bg-red-50 rounded-xl border-2 border-red-200",children:[c.jsx("h3",{className:"font-bold text-red-700 mb-3",children:" Lifestyle Changes"}),c.jsx("ul",{className:"space-y-2",children:R.recommendations.lifestyle.map((J,ue)=>c.jsxs("li",{className:"flex items-start gap-2 text-slate-700",children:[c.jsx("span",{className:"text-red-500 font-bold mt-0.5",children:""}),J]},ue))})]}),((le=R.recommendations.tests)==null?void 0:le.length)>0&&c.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl border-2 border-blue-200",children:[c.jsx("h3",{className:"font-bold text-blue-700 mb-3",children:" Follow-up Tests"}),c.jsx("ul",{className:"space-y-2",children:R.recommendations.tests.map((J,ue)=>c.jsxs("li",{className:"flex items-start gap-2 text-slate-700",children:[c.jsx("span",{className:"text-blue-500 font-bold mt-0.5",children:""}),J]},ue))})]})]})]}),v&&E&&c.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl border-2 border-blue-200 p-6 shadow-lg",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h2",{className:"text-xl font-bold text-blue-900 flex items-center gap-2",children:[c.jsx(Or,{className:"w-6 h-6 text-blue-600"}),"Report Comparison"]}),c.jsx("button",{onClick:()=>b(!1),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Close"})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[c.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-blue-200",children:[c.jsx("p",{className:"text-sm text-blue-600 font-semibold mb-2",children:"Current Report"}),c.jsx("p",{className:"text-2xl font-bold text-blue-900",children:((fe=E.currentReport)==null?void 0:fe.healthScore)||0}),c.jsx("p",{className:"text-xs text-blue-600 mt-1",children:new Date((re=E.currentReport)==null?void 0:re.createdAt).toLocaleDateString()})]}),c.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-amber-200",children:[c.jsx("p",{className:"text-sm text-amber-600 font-semibold mb-2",children:"Previous Report"}),c.jsx("p",{className:"text-2xl font-bold text-amber-900",children:(_==null?void 0:_.healthScore)||0}),c.jsx("p",{className:"text-xs text-amber-600 mt-1",children:new Date(_==null?void 0:_.createdAt).toLocaleDateString()})]})]}),((he=E.currentReport)==null?void 0:he.metrics)&&c.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-blue-200",children:[c.jsx("h3",{className:"font-bold text-blue-900 mb-4",children:"Metrics Comparison"}),c.jsx("div",{className:"space-y-3",children:Object.entries(E.currentReport.metrics||{}).map(([J,ue])=>{var Ge;const Ee=(Ge=_==null?void 0:_.metrics)==null?void 0:Ge[J];if(!Ee)return null;const Fe=ue.value-Ee.value,ke=ue.status==="normal"&&Ee.status!=="normal"||Fe>0&&J.includes("HDL")||Fe<0&&!J.includes("HDL")&&!J.includes("Glucose")&&!J.includes("Cholesterol");return c.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-medium text-slate-800",children:J}),c.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"text-slate-600",children:"Previous: "}),c.jsxs("span",{className:"font-semibold text-amber-700",children:[Ee.value," ",Ee.unit]})]}),c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"text-slate-600",children:"Current: "}),c.jsxs("span",{className:"font-semibold text-blue-700",children:[ue.value," ",ue.unit]})]})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:`text-sm font-bold ${ke?"text-green-600":"text-red-600"}`,children:[ke?"":""," ",Math.abs(Fe).toFixed(1)]}),c.jsx("p",{className:`text-xs font-medium ${ke?"text-green-600":"text-red-600"}`,children:ke?"Improved":"Changed"})]})]},J)})})]})]}),c.jsx("div",{className:"p-4 bg-blue-50 rounded-xl border-2 border-blue-200",children:c.jsxs("p",{className:"text-sm text-blue-700",children:[c.jsx("strong",{children:"Disclaimer:"})," This AI analysis is for informational wellness support only and should not replace professional medical advice. Always consult with a healthcare provider for medical decisions."]})})]})}const _Ye=["All","General Physician","Nutritionist","Cardiologist","Dermatologist","Endocrinologist","Neurologist"];function EYe(){var ae,ve,le,fe;const e=Us(),[n,s]=z.useState([]),[o,d]=z.useState([]),[h,f]=z.useState(!0),[v,b]=z.useState("All"),[_,w]=z.useState(""),[E,N]=z.useState(null),[I,R]=z.useState({date:"",timeSlot:"",symptoms:""}),[O,P]=z.useState(!1),[M,D]=z.useState("doctors"),[U,B]=z.useState([]),[G,$]=z.useState(!1);z.useEffect(()=>{q()},[v]);const q=async()=>{try{const re={};v!=="All"&&(re.specialization=v);const[he,J]=await Promise.all([ra.getAll(re),ra.getAppointments()]);s(he.data),d(J.data)}catch(re){console.error("Failed to fetch data:",re)}finally{f(!1)}};z.useEffect(()=>{E&&I.date&&X()},[E,I.date]);const X=async()=>{var re;if(!(!E||!I.date)){$(!0);try{const{data:he}=await ra.getDoctorAvailableSlots(E._id);console.log("Slots response:",he);const J=new Date(I.date).toDateString();console.log("Looking for dateKey:",J),console.log("Available keys:",Object.keys(he.slotsByDate||{})),B(((re=he.slotsByDate)==null?void 0:re[J])||[])}catch(he){console.error("Failed to fetch slots:",he),B([])}finally{$(!1)}}},ee=n.filter(re=>{var he,J,ue;return((J=re.name||((he=re.user)==null?void 0:he.name))==null?void 0:J.toLowerCase().includes(_.toLowerCase()))||((ue=re.specialization)==null?void 0:ue.toLowerCase().includes(_.toLowerCase()))}),ce=async re=>{var he,J;if(re.preventDefault(),!I.date||!I.timeSlot){et.error("Please select date and time");return}P(!0);try{await ra.bookAppointment({doctorId:E._id,...I,type:"video"}),et.success("Appointment booked successfully!"),N(null),R({date:"",timeSlot:"",symptoms:""}),B([]),q()}catch(ue){et.error(((J=(he=ue.response)==null?void 0:he.data)==null?void 0:J.message)||"Failed to book appointment")}finally{P(!1)}},Q=()=>{const re=[];for(let he=0;he<7;he++){const J=new Date;J.setDate(J.getDate()+he),re.push({value:J.toISOString().split("T")[0],label:J.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),isToday:he===0})}return re};return c.jsxs("div",{className:"space-y-6 animate-fade-in",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Find Doctors"}),c.jsx("p",{className:"text-slate-500 mt-1",children:"Book video consultations with healthcare specialists"})]}),c.jsxs("div",{className:"flex gap-2 p-1 bg-slate-100 rounded-xl w-fit",children:[c.jsxs("button",{onClick:()=>D("doctors"),className:`flex items-center gap-2 px-5 py-2.5 rounded-lg font-medium transition-all ${M==="doctors"?"bg-white text-slate-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[c.jsx(tl,{className:"w-4 h-4"})," Find Doctors"]}),c.jsxs("button",{onClick:()=>D("appointments"),className:`flex items-center gap-2 px-5 py-2.5 rounded-lg font-medium transition-all ${M==="appointments"?"bg-white text-slate-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[c.jsx(qr,{className:"w-4 h-4"})," My Appointments",o.length>0&&c.jsx("span",{className:"ml-1 px-2 py-0.5 bg-cyan-100 text-cyan-600 text-xs rounded-full",children:o.length})]})]}),M==="doctors"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-4 shadow-sm",children:c.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(qw,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),c.jsx("input",{type:"text",placeholder:"Search doctors...",value:_,onChange:re=>w(re.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none"})]}),c.jsx("select",{value:v,onChange:re=>b(re.target.value),className:"px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 focus:border-cyan-500 focus:outline-none",children:_Ye.map(re=>c.jsx("option",{value:re,children:re},re))})]})}),h?c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"w-10 h-10 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mx-auto"}),c.jsx("p",{className:"text-slate-500 mt-4",children:"Loading doctors..."})]}):ee.length>0?c.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:ee.map(re=>{var J,ue,Ee;const he=re.name||((J=re.user)==null?void 0:J.name)||"Doctor";return c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm hover:shadow-md transition-all",children:[c.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[c.jsx("div",{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center text-xl font-bold text-white",children:(ue=he[0])==null?void 0:ue.toUpperCase()}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("h3",{className:"font-semibold text-slate-800",children:["Dr. ",he]}),c.jsx("p",{className:"text-sm text-cyan-600 font-medium",children:re.specialization}),c.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[c.jsx(ja,{className:"w-4 h-4 text-amber-400 fill-amber-400"}),c.jsx("span",{className:"text-sm text-slate-600",children:((Ee=re.rating)==null?void 0:Ee.toFixed(1))||"4.5"}),c.jsx("span",{className:"text-slate-300",children:""}),c.jsxs("span",{className:"text-sm text-slate-500",children:[re.experience||5,"+ yrs"]})]})]})]}),c.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100",children:[c.jsxs("div",{children:[c.jsxs("span",{className:"text-xl font-bold text-slate-800",children:["",re.consultationFee||500]}),c.jsx("span",{className:"text-sm text-slate-500",children:" / session"})]}),c.jsx("button",{onClick:()=>N(re),className:"px-4 py-2 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-medium rounded-xl hover:shadow-lg transition-all",children:"Book Now"})]})]},re._id)})}):c.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl border border-slate-200",children:[c.jsx(qw,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),c.jsx("p",{className:"text-slate-500",children:"No doctors found"})]})]}),M==="appointments"&&c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Your Appointments"}),o.length>0?c.jsx("div",{className:"space-y-3",children:o.map(re=>{var he,J,ue,Ee,Fe,ke,Ge,De;return c.jsx("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center text-white font-bold",children:((Fe=(Ee=((he=re.doctor)==null?void 0:he.name)||((ue=(J=re.doctor)==null?void 0:J.user)==null?void 0:ue.name))==null?void 0:Ee[0])==null?void 0:Fe.toUpperCase())||"D"}),c.jsxs("div",{children:[c.jsxs("p",{className:"font-medium text-slate-800",children:["Dr. ",((ke=re.doctor)==null?void 0:ke.name)||((De=(Ge=re.doctor)==null?void 0:Ge.user)==null?void 0:De.name)]}),c.jsxs("p",{className:"text-sm text-slate-500",children:[new Date(re.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),"  ",re.timeSlot]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${re.status==="completed"?"bg-green-100 text-green-600":re.status==="scheduled"?"bg-amber-100 text-amber-600":"bg-red-100 text-red-600"}`,children:re.status}),re.status==="scheduled"&&c.jsx("button",{onClick:()=>e(`/consultation/${re._id}`),className:"px-3 py-1 bg-cyan-500 text-white text-sm font-medium rounded-lg hover:bg-cyan-600",children:"Join Call"})]})]})},re._id)})}):c.jsxs("div",{className:"text-center py-8",children:[c.jsx(qr,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),c.jsx("p",{className:"text-slate-500",children:"No appointments yet"}),c.jsx("button",{onClick:()=>D("doctors"),className:"mt-3 text-cyan-600 font-medium hover:text-cyan-700",children:"Book your first appointment "})]})]}),E&&c.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-xl animate-slide-up max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Book Appointment"}),c.jsx("button",{onClick:()=>{N(null),B([]),R({date:"",timeSlot:"",symptoms:""})},className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",children:c.jsx(di,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"flex items-center gap-4 p-4 bg-slate-50 rounded-xl mb-6",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center text-white font-bold",children:(le=(ve=E.name||((ae=E.user)==null?void 0:ae.name))==null?void 0:ve[0])==null?void 0:le.toUpperCase()}),c.jsxs("div",{children:[c.jsxs("p",{className:"font-semibold text-slate-800",children:["Dr. ",E.name||((fe=E.user)==null?void 0:fe.name)]}),c.jsx("p",{className:"text-sm text-cyan-600",children:E.specialization})]})]}),c.jsxs("form",{onSubmit:ce,className:"space-y-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Select Date"}),c.jsx("div",{className:"grid grid-cols-4 gap-2",children:Q().map(re=>c.jsxs("button",{type:"button",onClick:()=>R({...I,date:re.value,timeSlot:""}),className:`p-2 rounded-xl text-center transition-all ${I.date===re.value?"bg-cyan-500 text-white":"bg-slate-50 text-slate-600 hover:bg-slate-100 border border-slate-200"}`,children:[c.jsx("div",{className:"text-xs font-medium",children:re.label.split(" ")[0]}),c.jsx("div",{className:"text-sm font-bold",children:re.label.split(" ")[2]})]},re.value))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Select Time"}),G?c.jsxs("div",{className:"flex items-center justify-center py-6",children:[c.jsx("div",{className:"w-6 h-6 border-2 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin"}),c.jsx("span",{className:"ml-2 text-slate-500 text-sm",children:"Loading slots..."})]}):U.length>0?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:U.map(re=>{const he=I.timeSlot===re.timeSlot,J=re.status==="passed",ue=re.status==="booked",Ee=re.status==="blocked",Fe=re.status==="available";return c.jsxs("button",{type:"button",onClick:()=>Fe&&R({...I,timeSlot:re.timeSlot}),disabled:!Fe,className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${he?"bg-cyan-500 text-white ring-2 ring-cyan-300":J?"bg-slate-100 text-slate-400 cursor-not-allowed line-through":ue?"bg-red-50 text-red-400 cursor-not-allowed border border-red-200":Ee?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-emerald-100 text-emerald-600 border border-emerald-200 hover:bg-emerald-200 cursor-pointer"}`,title:J?"Time passed":ue?"Already booked":Ee?"Not available":"Available",children:[re.timeSlot,ue&&c.jsx("span",{className:"ml-1 text-xs",children:"(Booked)"})]},re.timeSlot)})}),c.jsxs("div",{className:"flex flex-wrap gap-3 text-xs text-slate-500",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"w-3 h-3 rounded-full bg-emerald-100 border border-emerald-300"})," Available"]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"w-3 h-3 rounded-full bg-red-50 border border-red-200"})," Booked"]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"w-3 h-3 rounded-full bg-slate-100 border border-slate-200"})," Passed/Unavailable"]})]})]}):I.date?c.jsxs("div",{className:"text-center py-6 bg-slate-50 rounded-xl",children:[c.jsx(To,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),c.jsx("p",{className:"text-slate-500 text-sm",children:"No slots available for this date"})]}):c.jsxs("div",{className:"text-center py-6 bg-slate-50 rounded-xl",children:[c.jsx(qr,{className:"w-8 h-8 text-slate-300 mx-auto mb-2"}),c.jsx("p",{className:"text-slate-500 text-sm",children:"Select a date first"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Symptoms (Optional)"}),c.jsx("textarea",{value:I.symptoms,onChange:re=>R({...I,symptoms:re.target.value}),className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 placeholder-slate-400 focus:border-cyan-500 focus:outline-none resize-none",rows:3,placeholder:"Describe your symptoms..."})]}),c.jsxs("div",{className:"p-4 bg-cyan-50 border border-cyan-200 rounded-xl",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(du,{className:"w-5 h-5 text-cyan-600"}),c.jsx("span",{className:"font-medium text-cyan-700",children:"Video Consultation"})]}),c.jsx("p",{className:"text-xs text-cyan-600 mt-1",children:"You'll receive a video call link via email"})]}),c.jsxs("div",{className:"flex gap-3 pt-2",children:[c.jsx("button",{type:"button",onClick:()=>{N(null),B([])},className:"flex-1 py-3 bg-slate-100 text-slate-700 font-medium rounded-xl hover:bg-slate-200 transition-all",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:O||!I.date||!I.timeSlot,className:"flex-1 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-medium rounded-xl hover:shadow-lg transition-all disabled:opacity-50",children:O?"Booking...":`Confirm  ${E.consultationFee||500}`})]})]})]})})]})}function wYe(){var ve,le,fe,re,he,J,ue,Ee,Fe,ke,Ge,De,Pe,Ve,it,Mt,tt,ft,Rt,Te;const{user:e,updateUser:n}=as(),s=mc(),o=Us(),[d,h]=z.useState(!1),[f,v]=z.useState(null),[b,_]=z.useState("profile"),[w,E]=z.useState(null),[N,I]=z.useState(!1),[R,O]=z.useState(!1),[P,M]=z.useState({goalType:"maintenance",currentWeight:((ve=e==null?void 0:e.profile)==null?void 0:ve.weight)||"",targetWeight:"",height:((le=e==null?void 0:e.profile)==null?void 0:le.height)||"",age:((fe=e==null?void 0:e.profile)==null?void 0:fe.age)||"",gender:((re=e==null?void 0:e.profile)==null?void 0:re.gender)||"male",activityLevel:"moderate",dietaryPreference:((he=e==null?void 0:e.profile)==null?void 0:he.dietaryPreference)||"non-vegetarian"}),[D,U]=z.useState({name:(e==null?void 0:e.name)||"",profile:{age:((J=e==null?void 0:e.profile)==null?void 0:J.age)||"",gender:((ue=e==null?void 0:e.profile)==null?void 0:ue.gender)||"",dietaryPreference:((Ee=e==null?void 0:e.profile)==null?void 0:Ee.dietaryPreference)||"non-vegetarian",height:((Fe=e==null?void 0:e.profile)==null?void 0:Fe.height)||"",weight:((ke=e==null?void 0:e.profile)==null?void 0:ke.weight)||"",bloodGroup:((Ge=e==null?void 0:e.profile)==null?void 0:Ge.bloodGroup)||"",allergies:((Pe=(De=e==null?void 0:e.profile)==null?void 0:De.allergies)==null?void 0:Pe.join(", "))||"",chronicConditions:((it=(Ve=e==null?void 0:e.profile)==null?void 0:Ve.chronicConditions)==null?void 0:it.join(", "))||""}});z.useEffect(()=>{window.scrollTo(0,0),B(),G(),new URLSearchParams(s.search).get("tab")==="goals"&&_("goals")},[s.search]);const B=async()=>{try{const{data:st}=await da.getHistory();v(st)}catch(st){console.error("Failed to fetch health history:",st)}},G=async()=>{try{const st=localStorage.getItem("token"),ct=await Ln.get("/api/nutrition/goals",{headers:{Authorization:`Bearer ${st}`}});ct.data.healthGoal&&(E(ct.data.healthGoal),M({goalType:ct.data.healthGoal.goalType,currentWeight:ct.data.healthGoal.currentWeight,targetWeight:ct.data.healthGoal.targetWeight,height:ct.data.healthGoal.height,age:ct.data.healthGoal.age,gender:ct.data.healthGoal.gender,activityLevel:ct.data.healthGoal.activityLevel,dietaryPreference:ct.data.healthGoal.dietaryPreference}))}catch{console.log("No health goal set yet")}},$=st=>{const{name:ct,value:zt}=st.target;if(ct.startsWith("profile.")){const Ke=ct.split(".")[1];U(xe=>({...xe,profile:{...xe.profile,[Ke]:zt}}))}else U(Ke=>({...Ke,[ct]:zt}))},q=async st=>{var ct,zt;st.preventDefault(),h(!0);try{const Ke={name:D.name,profile:{...D.profile,age:D.profile.age?Number(D.profile.age):void 0,height:D.profile.height?Number(D.profile.height):void 0,weight:D.profile.weight?Number(D.profile.weight):void 0,allergies:D.profile.allergies?D.profile.allergies.split(",").map(Je=>Je.trim()).filter(Boolean):[],chronicConditions:D.profile.chronicConditions?D.profile.chronicConditions.split(",").map(Je=>Je.trim()).filter(Boolean):[]}},{data:xe}=await ht.put("/auth/profile",Ke);n(xe),O(!1),et.success("Profile updated successfully!")}catch(Ke){et.error(((zt=(ct=Ke.response)==null?void 0:ct.data)==null?void 0:zt.message)||"Failed to update profile")}finally{h(!1)}},X=async st=>{var ct,zt;st.preventDefault(),I(!0);try{const Ke=localStorage.getItem("token"),xe={...P,currentWeight:Number(P.currentWeight),targetWeight:Number(P.targetWeight),height:Number(P.height),age:Number(P.age)},Je=await Ln.post("/api/nutrition/goals",xe,{headers:{Authorization:`Bearer ${Ke}`}});E(Je.data.healthGoal),et.success("Fitness goal set successfully!")}catch(Ke){et.error(((zt=(ct=Ke.response)==null?void 0:ct.data)==null?void 0:zt.message)||"Failed to set fitness goal")}finally{I(!1)}},ee=st=>{const{name:ct,value:zt}=st.target;M(Ke=>({...Ke,[ct]:zt}))},ce=D.profile.height&&D.profile.weight?(D.profile.weight/Math.pow(D.profile.height/100,2)).toFixed(1):null,ae=(st=>st?st<18.5?{label:"Underweight",color:"blue",gradient:"from-blue-400 to-blue-500"}:st<25?{label:"Normal",color:"emerald",gradient:"from-emerald-400 to-emerald-500"}:st<30?{label:"Overweight",color:"amber",gradient:"from-amber-400 to-amber-500"}:{label:"Obese",color:"red",gradient:"from-red-400 to-red-500"}:{label:"N/A",color:"slate",gradient:"from-slate-400 to-slate-500"})(parseFloat(ce));return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-cyan-50 via-blue-50 to-cyan-100 pb-20",children:c.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in p-4",children:[c.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-cyan-500 via-blue-500 to-indigo-500 rounded-3xl p-4 sm:p-6 md:p-8 text-white shadow-2xl",children:[c.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 sm:w-64 sm:h-64 bg-white/10 rounded-full -mr-16 sm:-mr-32 -mt-16 sm:-mt-32"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 sm:w-48 sm:h-48 bg-white/10 rounded-full -ml-12 sm:-ml-24 -mb-12 sm:-mb-24"}),c.jsxs("div",{className:"relative z-10",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-4 md:gap-6",children:[c.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-2xl sm:rounded-3xl bg-white/20 backdrop-blur-sm flex items-center justify-center text-2xl sm:text-3xl md:text-4xl font-bold border-2 sm:border-4 border-white/30",children:(tt=(Mt=e==null?void 0:e.name)==null?void 0:Mt[0])==null?void 0:tt.toUpperCase()}),c.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[c.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-1 sm:mb-2",children:e==null?void 0:e.name}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-3 text-white/90 text-xs sm:text-sm",children:[c.jsxs("span",{className:"flex items-center justify-center sm:justify-start gap-1 sm:gap-2",children:[c.jsx(lb,{className:"w-3 h-3 sm:w-4 sm:h-4"})," ",e==null?void 0:e.email]}),(e==null?void 0:e.phone)&&c.jsxs("span",{className:"flex items-center justify-center sm:justify-start gap-1 sm:gap-2",children:[c.jsx(Kj,{className:"w-3 h-3 sm:w-4 sm:h-4"})," ",e==null?void 0:e.phone]})]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 md:gap-4 mt-3 sm:mt-4 md:mt-6",children:[c.jsxs("div",{className:"text-center p-2 sm:p-3 md:p-4 bg-white/10 backdrop-blur-sm rounded-xl sm:rounded-2xl",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg sm:rounded-xl bg-white/20 flex items-center justify-center mx-auto mb-1 sm:mb-2",children:c.jsx(zn,{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6"})}),c.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:((ft=e==null?void 0:e.healthMetrics)==null?void 0:ft.healthScore)||"--"}),c.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-white/80",children:"Health Score"})]}),ce&&c.jsxs("div",{className:"text-center p-2 sm:p-3 md:p-4 bg-white/10 backdrop-blur-sm rounded-xl sm:rounded-2xl",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg sm:rounded-xl bg-white/20 flex items-center justify-center mx-auto mb-1 sm:mb-2",children:c.jsx(Or,{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6"})}),c.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:ce}),c.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-white/80",children:"BMI"})]}),c.jsxs("div",{className:"text-center p-2 sm:p-3 md:p-4 bg-white/10 backdrop-blur-sm rounded-xl sm:rounded-2xl",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg sm:rounded-xl bg-white/20 flex items-center justify-center mx-auto mb-1 sm:mb-2",children:c.jsx(jn,{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6"})}),c.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:(f==null?void 0:f.totalReports)||0}),c.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-white/80",children:"Reports"})]}),c.jsxs("div",{className:"text-center p-2 sm:p-3 md:p-4 bg-white/10 backdrop-blur-sm rounded-xl sm:rounded-2xl",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg sm:rounded-xl bg-white/20 flex items-center justify-center mx-auto mb-1 sm:mb-2",children:c.jsx(If,{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6"})}),c.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold capitalize",children:((Rt=e==null?void 0:e.subscription)==null?void 0:Rt.plan)||"Free"}),c.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-white/80",children:"Plan"})]})]})]})]}),c.jsx("div",{className:"flex gap-2 p-1 bg-white rounded-2xl shadow-lg w-full md:w-fit overflow-x-auto",children:[{id:"profile",label:"Profile",icon:tl},{id:"goals",label:"Fitness Goals",icon:ns}].map(st=>c.jsxs("button",{onClick:()=>_(st.id),className:`flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all whitespace-nowrap ${b===st.id?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg":"text-slate-600 hover:bg-slate-50"}`,children:[c.jsx(st.icon,{className:"w-5 h-5"}),st.label]},st.id))}),b==="profile"&&c.jsxs("form",{onSubmit:q,className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-3xl shadow-lg p-4 sm:p-6 border-2 border-cyan-100",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[c.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-slate-800 flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center",children:c.jsx(tl,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),c.jsx("span",{className:"text-base sm:text-xl",children:"Basic Information"})]}),c.jsx("button",{type:"button",onClick:()=>O(!R),className:`px-3 py-1.5 sm:px-4 sm:py-2 rounded-xl font-medium transition-all flex items-center gap-1 sm:gap-2 text-xs sm:text-sm ${R?"bg-red-100 text-red-600 hover:bg-red-200":"bg-cyan-100 text-cyan-600 hover:bg-cyan-200"}`,children:R?c.jsxs(c.Fragment,{children:[c.jsx(di,{className:"w-3 h-3 sm:w-4 sm:h-4"})," Cancel"]}):c.jsxs(c.Fragment,{children:[c.jsx(PNe,{className:"w-3 h-3 sm:w-4 sm:h-4"})," Edit"]})})]}),ce&&c.jsx("div",{className:"mb-4 sm:mb-6 p-3 sm:p-4 bg-gradient-to-br from-cyan-50 to-blue-50 rounded-2xl border-2 border-cyan-200",children:c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-xs sm:text-sm text-slate-600 mb-1",children:"Your BMI"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:`w-16 h-16 sm:w-20 sm:h-20 rounded-2xl bg-gradient-to-br ${ae.gradient} flex items-center justify-center shadow-lg`,children:c.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-white",children:ce})}),c.jsxs("div",{children:[c.jsx("span",{className:`px-3 py-1 rounded-full text-xs sm:text-sm font-bold bg-${ae.color}-100 text-${ae.color}-700`,children:ae.label}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Body Mass Index"})]})]})]})})}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-3 sm:gap-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2",children:"Full Name"}),c.jsx("input",{type:"text",name:"name",value:D.name,onChange:$,disabled:!R,className:"w-full bg-slate-50 border-2 border-slate-200 rounded-xl py-2 sm:py-3 px-3 sm:px-4 text-sm sm:text-base text-slate-800 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none disabled:opacity-60",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2",children:"Email"}),c.jsx("input",{type:"email",value:e==null?void 0:e.email,className:"w-full bg-slate-100 border-2 border-slate-200 rounded-xl py-2 sm:py-3 px-3 sm:px-4 text-sm sm:text-base text-slate-500",disabled:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2",children:"Age"}),c.jsx("input",{type:"number",name:"profile.age",value:D.profile.age,onChange:$,disabled:!R,className:"w-full bg-slate-50 border-2 border-slate-200 rounded-xl py-2 sm:py-3 px-3 sm:px-4 text-sm sm:text-base text-slate-800 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none disabled:opacity-60",min:"1",max:"120",placeholder:"Enter your age"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2",children:"Gender"}),c.jsxs("select",{name:"profile.gender",value:D.profile.gender,onChange:$,disabled:!R,className:"w-full bg-slate-50 border-2 border-slate-200 rounded-xl py-2 sm:py-3 px-3 sm:px-4 text-sm sm:text-base text-slate-800 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none disabled:opacity-60",children:[c.jsx("option",{value:"",children:"Select gender"}),c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"}),c.jsx("option",{value:"other",children:"Other"})]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2",children:"Dietary Preference"}),c.jsxs("select",{name:"profile.dietaryPreference",value:D.profile.dietaryPreference,onChange:$,disabled:!R,className:"w-full bg-slate-50 border-2 border-slate-200 rounded-xl py-2 sm:py-3 px-3 sm:px-4 text-sm sm:text-base text-slate-800 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none disabled:opacity-60",children:[c.jsx("option",{value:"non-vegetarian",children:"Non-Vegetarian"}),c.jsx("option",{value:"vegetarian",children:"Vegetarian"}),c.jsx("option",{value:"vegan",children:"Vegan"}),c.jsx("option",{value:"eggetarian",children:"Eggetarian"})]})]})]})]}),c.jsxs("div",{className:"bg-white rounded-3xl shadow-lg p-4 sm:p-6 border-2 border-red-100",children:[c.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-slate-800 mb-4 sm:mb-6 flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-br from-red-400 to-pink-500 flex items-center justify-center",children:c.jsx(zn,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),c.jsx("span",{className:"text-base sm:text-xl",children:"Health Information"})]}),c.jsxs("div",{className:"grid md:grid-cols-3 gap-3 sm:gap-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2",children:"Height (cm)"}),c.jsx("input",{type:"number",name:"profile.height",value:D.profile.height,onChange:$,disabled:!R,className:"w-full bg-slate-50 border-2 border-slate-200 rounded-xl py-2 sm:py-3 px-3 sm:px-4 text-sm sm:text-base text-slate-800 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none disabled:opacity-60",min:"50",max:"300",placeholder:"170"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2",children:"Weight (kg)"}),c.jsx("input",{type:"number",name:"profile.weight",value:D.profile.weight,onChange:$,disabled:!R,className:"w-full bg-slate-50 border-2 border-slate-200 rounded-xl py-2 sm:py-3 px-3 sm:px-4 text-sm sm:text-base text-slate-800 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none disabled:opacity-60",min:"10",max:"500",placeholder:"70"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2",children:"Blood Group"}),c.jsxs("select",{name:"profile.bloodGroup",value:D.profile.bloodGroup,onChange:$,disabled:!R,className:"w-full bg-slate-50 border-2 border-slate-200 rounded-xl py-2 sm:py-3 px-3 sm:px-4 text-sm sm:text-base text-slate-800 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none disabled:opacity-60",children:[c.jsx("option",{value:"",children:"Select"}),["A+","A-","B+","B-","AB+","AB-","O+","O-"].map(st=>c.jsx("option",{value:st,children:st},st))]})]})]})]}),c.jsxs("div",{className:"bg-white rounded-3xl shadow-lg p-4 sm:p-6 border-2 border-amber-100",children:[c.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-slate-800 mb-4 sm:mb-6 flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center",children:c.jsx(Vr,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),c.jsx("span",{className:"text-base sm:text-xl",children:"Medical History"})]}),c.jsxs("div",{className:"space-y-3 sm:space-y-5",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2",children:["Allergies ",c.jsx("span",{className:"text-slate-400 font-normal",children:"(comma separated)"})]}),c.jsx("input",{type:"text",name:"profile.allergies",value:D.profile.allergies,onChange:$,disabled:!R,className:"w-full bg-slate-50 border-2 border-slate-200 rounded-xl py-2 sm:py-3 px-3 sm:px-4 text-sm sm:text-base text-slate-800 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none disabled:opacity-60",placeholder:"e.g., Penicillin, Peanuts"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2",children:["Chronic Conditions ",c.jsx("span",{className:"text-slate-400 font-normal",children:"(comma separated)"})]}),c.jsx("input",{type:"text",name:"profile.chronicConditions",value:D.profile.chronicConditions,onChange:$,disabled:!R,className:"w-full bg-slate-50 border-2 border-slate-200 rounded-xl py-2 sm:py-3 px-3 sm:px-4 text-sm sm:text-base text-slate-800 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none disabled:opacity-60",placeholder:"e.g., Diabetes, Hypertension"})]})]})]}),R&&c.jsx("button",{type:"submit",disabled:d,className:"w-full py-3 sm:py-4 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-bold rounded-2xl hover:shadow-2xl transition-all flex items-center justify-center gap-2 disabled:opacity-50 text-base sm:text-lg",children:d?c.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 border-3 border-white/30 border-t-white rounded-full animate-spin"}):c.jsxs(c.Fragment,{children:[c.jsx(Xd,{className:"w-5 h-5 sm:w-6 sm:h-6"}),"Save Changes"]})})]}),c.jsx("div",{className:"space-y-6",children:c.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-indigo-500 rounded-3xl shadow-lg p-4 sm:p-6 text-white",children:[c.jsxs("h3",{className:"text-base sm:text-lg font-bold mb-3 sm:mb-4 flex items-center gap-2",children:[c.jsx(Wh,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Quick Stats"]}),c.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between p-2 sm:p-3 bg-white/20 backdrop-blur-sm rounded-xl",children:[c.jsx("span",{className:"text-xs sm:text-sm",children:"Total Reports"}),c.jsx("span",{className:"font-bold text-lg sm:text-xl",children:(f==null?void 0:f.totalReports)||0})]}),c.jsxs("div",{className:"flex items-center justify-between p-2 sm:p-3 bg-white/20 backdrop-blur-sm rounded-xl",children:[c.jsx("span",{className:"text-xs sm:text-sm",children:"Report Types"}),c.jsx("span",{className:"font-bold text-lg sm:text-xl",children:Object.keys((f==null?void 0:f.history)||{}).length})]}),c.jsxs("div",{className:"flex items-center justify-between p-2 sm:p-3 bg-white/20 backdrop-blur-sm rounded-xl",children:[c.jsx("span",{className:"text-xs sm:text-sm",children:"Subscription"}),c.jsx("span",{className:"px-2 sm:px-3 py-1 bg-white text-purple-600 rounded-lg text-xs sm:text-sm font-bold capitalize",children:((Te=e==null?void 0:e.subscription)==null?void 0:Te.plan)||"Free"})]})]})]})})]}),b==="goals"&&c.jsxs("form",{onSubmit:X,className:"max-w-5xl space-y-6",children:[w&&c.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 rounded-2xl sm:rounded-3xl border-2 sm:border-3 border-emerald-200 p-3 sm:p-4 md:p-6 shadow-lg",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-4 mb-3 sm:mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-bold text-emerald-900 mb-0.5 sm:mb-1",children:"Your Current Goal"}),c.jsx("p",{className:"text-xs sm:text-sm text-emerald-700",children:"Daily targets calculated"})]}),c.jsx("div",{className:"px-3 py-1 sm:px-4 sm:py-2 bg-emerald-600 text-white rounded-lg sm:rounded-xl font-bold capitalize text-xs sm:text-sm whitespace-nowrap",children:w.goalType.replace("_"," ")})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 md:gap-4 mt-3 sm:mt-4 md:mt-6",children:[c.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-5 rounded-xl sm:rounded-2xl shadow-md text-center",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg sm:rounded-xl bg-gradient-to-br from-red-400 to-pink-500 flex items-center justify-center mx-auto mb-1 sm:mb-2",children:c.jsx(ns,{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-white"})}),c.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-slate-600 mb-0.5 sm:mb-1",children:"Daily Calories"}),c.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-bold text-slate-800",children:w.dailyCalorieTarget})]}),c.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-5 rounded-xl sm:rounded-2xl shadow-md text-center",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg sm:rounded-xl bg-gradient-to-br from-blue-400 to-blue-500 flex items-center justify-center mx-auto mb-1 sm:mb-2",children:c.jsx(vNe,{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-white"})}),c.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-slate-600 mb-0.5 sm:mb-1",children:"Protein"}),c.jsxs("p",{className:"text-lg sm:text-xl md:text-2xl font-bold text-blue-600",children:[w.macroTargets.protein,"g"]})]}),c.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-5 rounded-xl sm:rounded-2xl shadow-md text-center",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg sm:rounded-xl bg-gradient-to-br from-green-400 to-green-500 flex items-center justify-center mx-auto mb-1 sm:mb-2",children:c.jsx(BNe,{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-white"})}),c.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-slate-600 mb-0.5 sm:mb-1",children:"Carbs"}),c.jsxs("p",{className:"text-lg sm:text-xl md:text-2xl font-bold text-green-600",children:[w.macroTargets.carbs,"g"]})]}),c.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-5 rounded-xl sm:rounded-2xl shadow-md text-center",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg sm:rounded-xl bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center mx-auto mb-1 sm:mb-2",children:c.jsx(eP,{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-white"})}),c.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-slate-600 mb-0.5 sm:mb-1",children:"Fats"}),c.jsxs("p",{className:"text-lg sm:text-xl md:text-2xl font-bold text-orange-600",children:[w.macroTargets.fats,"g"]})]})]})]}),c.jsxs("div",{className:"bg-white rounded-3xl shadow-lg p-6 border-2 border-cyan-100",children:[c.jsxs("h3",{className:"text-xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center",children:c.jsx(ns,{className:"w-5 h-5 text-white"})}),w?"Update Your Fitness Goal":"Set Your Fitness Goal"]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Goal Type"}),c.jsxs("select",{name:"goalType",value:P.goalType,onChange:ee,className:"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none",required:!0,children:[c.jsx("option",{value:"weight_loss",children:"Weight Loss (Fat Loss)"}),c.jsx("option",{value:"muscle_gain",children:"Muscle Gain (Bulking)"}),c.jsx("option",{value:"weight_gain",children:"Weight Gain"}),c.jsx("option",{value:"maintenance",children:"Maintenance"}),c.jsx("option",{value:"health_improvement",children:"Health Improvement"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Activity Level"}),c.jsxs("select",{name:"activityLevel",value:P.activityLevel,onChange:ee,className:"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none",required:!0,children:[c.jsx("option",{value:"sedentary",children:"Sedentary (Little or no exercise)"}),c.jsx("option",{value:"light",children:"Light (Exercise 1-3 days/week)"}),c.jsx("option",{value:"moderate",children:"Moderate (Exercise 3-5 days/week)"}),c.jsx("option",{value:"active",children:"Active (Exercise 6-7 days/week)"}),c.jsx("option",{value:"very_active",children:"Very Active (Hard exercise daily)"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Current Weight (kg)"}),c.jsx("input",{type:"number",name:"currentWeight",value:P.currentWeight,onChange:ee,className:"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none",required:!0,min:"30",max:"300",step:"0.1"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Target Weight (kg)"}),c.jsx("input",{type:"number",name:"targetWeight",value:P.targetWeight,onChange:ee,className:"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none",required:!0,min:"30",max:"300",step:"0.1"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Height (cm)"}),c.jsx("input",{type:"number",name:"height",value:P.height,onChange:ee,className:"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none",required:!0,min:"100",max:"250"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Age"}),c.jsx("input",{type:"number",name:"age",value:P.age,onChange:ee,className:"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none",required:!0,min:"10",max:"120"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Gender"}),c.jsxs("select",{name:"gender",value:P.gender,onChange:ee,className:"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none",required:!0,children:[c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"}),c.jsx("option",{value:"other",children:"Other"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Dietary Preference"}),c.jsxs("select",{name:"dietaryPreference",value:P.dietaryPreference,onChange:ee,className:"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none",required:!0,children:[c.jsx("option",{value:"vegetarian",children:"Vegetarian"}),c.jsx("option",{value:"vegan",children:"Vegan"}),c.jsx("option",{value:"non-vegetarian",children:"Non-Vegetarian"}),c.jsx("option",{value:"eggetarian",children:"Eggetarian"})]})]})]}),c.jsx("button",{type:"submit",disabled:N,className:"mt-6 w-full py-4 bg-gradient-to-r from-emerald-500 to-green-500 text-white font-bold rounded-2xl hover:shadow-2xl transition-all flex items-center justify-center gap-2 disabled:opacity-50 text-lg",children:N?c.jsx("div",{className:"w-6 h-6 border-3 border-white/30 border-t-white rounded-full animate-spin"}):c.jsxs(c.Fragment,{children:[c.jsx(ns,{className:"w-6 h-6"}),w?"Update Goal":"Set Goal"]})})]})]}),f&&f.history&&Object.keys(f.history).length>0&&c.jsxs("div",{className:"bg-white rounded-3xl shadow-lg p-6 border-2 border-cyan-100",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-400 to-cyan-500 flex items-center justify-center",children:c.jsx(Vn,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Health Reports"}),c.jsx("p",{className:"text-sm text-slate-600",children:"Your uploaded health reports by type"})]})]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(f.history).map(([st,ct])=>{var zt;return c.jsxs("button",{onClick:()=>o("/reports"),className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-2xl p-5 border-2 border-cyan-200 hover:border-cyan-400 hover:shadow-lg transition-all group text-left",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-400 to-cyan-500 flex items-center justify-center",children:c.jsx(Vn,{className:"w-6 h-6 text-white"})}),c.jsx(Il,{className:"w-5 h-5 text-cyan-600 group-hover:translate-x-1 transition-transform"})]}),c.jsx("h4",{className:"font-bold text-slate-800 text-lg mb-1 capitalize",children:st.replace(/([A-Z])/g," $1").trim()}),c.jsxs("p",{className:"text-sm text-slate-600 mb-2",children:[ct.length," ",ct.length===1?"report":"reports"]}),((zt=ct[0])==null?void 0:zt.healthScore)&&c.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[c.jsx(zn,{className:"w-4 h-4 text-red-500"}),c.jsxs("span",{className:"text-sm font-semibold text-slate-700",children:["Latest: ",ct[0].healthScore,"/100"]})]})]},st)})}),c.jsxs("div",{className:"mt-6 flex items-center justify-between p-4 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-2xl text-white",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-cyan-100",children:"Total Reports"}),c.jsx("p",{className:"text-2xl font-bold",children:f.totalReports||0})]}),c.jsxs("button",{onClick:()=>o("/reports"),className:"px-6 py-3 bg-white text-cyan-600 rounded-xl font-bold hover:shadow-lg transition-all flex items-center gap-2",children:["View All",c.jsx(Il,{className:"w-5 h-5"})]})]})]})]})})}const HO={name:"John Doe",email:"john@example.com",profile:{age:32,gender:"male",height:175,weight:72,bloodGroup:"O+",allergies:["Penicillin"],chronicConditions:["None"]}},SYe=[{date:"Jul",score:65},{date:"Aug",score:68},{date:"Sep",score:72},{date:"Oct",score:70},{date:"Nov",score:75},{date:"Dec",score:78}],rc={summary:"Overall health is good with some areas needing attention. Blood sugar levels are slightly elevated.",keyFindings:["Hemoglobin levels are normal at 14.2 g/dL","Cholesterol is borderline high at 210 mg/dL","Vitamin D deficiency detected"],riskFactors:["Pre-diabetic blood sugar levels","Sedentary lifestyle indicators"],metrics:{hemoglobin:{value:14.2,unit:"g/dL",status:"normal",normalRange:"12-16"},bloodSugar:{value:115,unit:"mg/dL",status:"borderline",normalRange:"70-100"},cholesterol:{value:210,unit:"mg/dL",status:"borderline",normalRange:"<200"}},recommendations:{diet:[{item:"Leafy Greens",reason:"Rich in iron and vitamins",priority:"high"},{item:"Fatty Fish",reason:"Omega-3 helps reduce cholesterol",priority:"high"},{item:"Nuts & Seeds",reason:"Good fats for heart health",priority:"medium"}],exercise:[{activity:"Brisk Walking",duration:"30 mins",frequency:"daily",reason:"Improves cardiovascular health"},{activity:"Strength Training",duration:"20 mins",frequency:"3x/week",reason:"Builds muscle"}]},doctorConsultation:{specializations:["Endocrinologist","Cardiologist"],reason:"Blood sugar and cholesterol need monitoring"}},Bk=[{_id:"1",name:"Dr. Sarah Johnson",specialization:"Cardiologist",experience:12,fee:800,rating:4.8,reviews:124,hospital:"City Heart Hospital",available:!0,slots:["09:00 AM","10:00 AM","11:00 AM","02:00 PM","03:00 PM"]},{_id:"2",name:"Dr. Raj Patel",specialization:"Endocrinologist",experience:15,fee:900,rating:4.9,reviews:89,hospital:"Diabetes Care Center",available:!0,slots:["10:00 AM","11:00 AM","04:00 PM","05:00 PM"]},{_id:"3",name:"Dr. Emily Chen",specialization:"General Physician",experience:8,fee:500,rating:4.7,reviews:156,hospital:"Family Health Clinic",available:!0,slots:["09:00 AM","10:00 AM","02:00 PM","03:00 PM","04:00 PM"]},{_id:"4",name:"Dr. Michael Brown",specialization:"Neurologist",experience:18,fee:1200,rating:4.9,reviews:67,hospital:"Neuro Care Institute",available:!0,slots:["11:00 AM","02:00 PM","03:00 PM"]},{_id:"5",name:"Dr. Priya Sharma",specialization:"Dermatologist",experience:10,fee:600,rating:4.6,reviews:203,hospital:"Skin & Care Clinic",available:!1,slots:[]}],TYe=[{_id:"apt1",doctor:Bk[1],date:"2024-12-15",timeSlot:"10:00 AM",status:"confirmed",type:"online",meetLink:"https://meet.healthai.com/apt-xyz123",amountPaid:450}],Tq={summary:"Your health has improved since your last checkup.",metricChanges:[{metric:"Health Score",previous:"72",current:"78",change:"improved"},{metric:"Blood Sugar",previous:"125 mg/dL",current:"115 mg/dL",change:"improved"}]},KO={cholesterol:"Your cholesterol level of 210 mg/dL is borderline high. Focus on reducing saturated fats and increasing fiber. Regular exercise helps too.",worried:"No immediate alarm, but attention needed. Blood sugar is pre-diabetic and cholesterol borderline. Lifestyle changes can help. Follow up with specialists.",default:"Your health score is 78/100. Key areas: managing blood sugar and cholesterol through diet and exercise. Ask me anything specific!"},Nq=["All","Cardiologist","Endocrinologist","General Physician","Neurologist","Dermatologist","Orthopedic","Pediatrician"],NYe=["Blood Test","X-Ray","MRI","CT Scan","ECG","General Checkup"];function CYe(){const[e,n]=z.useState("dashboard"),[s,o]=z.useState(!1),[d,h]=z.useState([]),[f,v]=z.useState(""),[b,_]=z.useState(!1),[w,E]=z.useState(!1),[N,I]=z.useState(null),[R,O]=z.useState(0),[P,M]=z.useState({date:"",slot:"",type:"online"}),[D,U]=z.useState(Bk),[B,G]=z.useState(TYe),[$,q]=z.useState("All"),[X,ee]=z.useState(""),[ce,Q]=z.useState(0),[ae,ve]=z.useState(null),[le,fe]=z.useState(!1),[re,he]=z.useState({name:"",specialization:"",experience:"",fee:"",hospital:""}),[J,ue]=z.useState(!1),[Ee,Fe]=z.useState(HO.profile),ke=z.useRef(null);z.useEffect(()=>{var xe;(xe=ke.current)==null||xe.scrollIntoView({behavior:"smooth"})},[d]);const Ge=xe=>{if(xe.preventDefault(),!f.trim())return;const Je=f.toLowerCase();h(yt=>[...yt,{role:"user",content:f}]),v(""),setTimeout(()=>{const yt=Object.keys(KO).find(Yn=>Je.includes(Yn));h(Yn=>[...Yn,{role:"assistant",content:KO[yt]||KO.default}])},800)},De=()=>{if(R===0)O(1);else if(R===1&&P.date&&P.slot)O(2);else if(R===2){const xe={_id:`apt${Date.now()}`,doctor:N,date:P.date,timeSlot:P.slot,status:"confirmed",type:P.type,meetLink:`https://meet.healthai.com/apt-${Math.random().toString(36).substr(2,9)}`,amountPaid:N.fee/2};G(Je=>[xe,...Je]),O(3)}},Pe=()=>{I(null),O(0),M({date:"",slot:"",type:"online"})},Ve=()=>{ce===0&&ae&&(Q(1),fe(!0),setTimeout(()=>{fe(!1),Q(2)},2500))},it=()=>{re.name&&re.specialization&&re.fee&&(U(xe=>[...xe,{...re,_id:`doc${Date.now()}`,rating:4.5,reviews:0,available:!0,slots:["10:00 AM","02:00 PM","04:00 PM"]}]),he({name:"",specialization:"",experience:"",fee:"",hospital:""}),ue(!1))},Mt=D.filter(xe=>($==="All"||xe.specialization===$)&&xe.name.toLowerCase().includes(X.toLowerCase())),tt=({trend:xe})=>xe==="improved"?c.jsx(Or,{className:"w-4 h-4 text-green-600"}):xe==="declined"?c.jsx(CT,{className:"w-4 h-4 text-red-600"}):c.jsx(ff,{className:"w-4 h-4 text-gray-400"}),ft=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Welcome back, John!"}),c.jsx("p",{className:"text-gray-600",children:"Here's your health overview"})]}),c.jsxs("button",{onClick:()=>n("upload"),className:"btn-primary flex items-center gap-2",children:[c.jsx(Es,{className:"w-4 h-4"})," Upload Report"]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{icon:jn,color:"primary",label:"Health Score",value:"78/100"},{icon:Vn,color:"blue",label:"Total Reports",value:"6"},{icon:Or,color:"green",label:"BMI",value:"23.5"},{icon:qr,color:"purple",label:"Last Checkup",value:"Dec 5"}].map((xe,Je)=>c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:`w-12 h-12 bg-${xe.color}-100 rounded-xl flex items-center justify-center`,children:c.jsx(xe.icon,{className:`w-6 h-6 text-${xe.color}-600`})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500",children:xe.label}),c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:xe.value})]})]})},Je))}),B.length>0&&c.jsxs("div",{className:"card border-2 border-green-200 bg-green-50/30",children:[c.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[c.jsx(qr,{className:"w-5 h-5 text-green-600"})," Upcoming Appointments"]}),B.filter(xe=>xe.status==="confirmed").map(xe=>c.jsxs("div",{className:"bg-white p-4 rounded-xl flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center text-lg font-bold text-primary-600",children:xe.doctor.name[4]}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:xe.doctor.name}),c.jsxs("p",{className:"text-sm text-gray-500",children:[xe.doctor.specialization,"  ",xe.date," at ",xe.timeSlot]})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[xe.type==="online"&&xe.meetLink&&c.jsxs("a",{href:xe.meetLink,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700",children:[c.jsx(du,{className:"w-4 h-4"})," Join Call"]}),c.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium",children:"Confirmed"})]})]},xe._id))]}),c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Health Score Trend"}),c.jsx(xy,{width:"100%",height:200,children:c.jsxs(Mne,{data:SYe,children:[c.jsx(Jf,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),c.jsx(Xl,{dataKey:"date"}),c.jsx(Jl,{domain:[0,100]}),c.jsx(ea,{}),c.jsx(Ig,{type:"monotone",dataKey:"score",stroke:"#22c55e",strokeWidth:2,dot:{fill:"#22c55e"}})]})})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(Pa,{className:"w-5 h-5 text-green-600"}),c.jsx("h3",{className:"font-semibold",children:"Diet Recommendations"})]}),c.jsx("ul",{className:"space-y-2",children:rc.recommendations.diet.map((xe,Je)=>c.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mt-2"}),c.jsxs("span",{children:[c.jsx("strong",{children:xe.item})," - ",xe.reason]})]},Je))})]}),c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(Of,{className:"w-5 h-5 text-blue-600"}),c.jsx("h3",{className:"font-semibold",children:"Exercise Plan"})]}),c.jsx("ul",{className:"space-y-2",children:rc.recommendations.exercise.map((xe,Je)=>c.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2"}),c.jsxs("span",{children:[c.jsx("strong",{children:xe.activity})," - ",xe.duration,", ",xe.frequency]})]},Je))})]})]}),c.jsx("div",{className:"card border-l-4 border-yellow-500 bg-yellow-50",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(Vr,{className:"w-5 h-5 text-orange-600 mt-0.5"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:"Doctor Consultation Recommended"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:rc.doctorConsultation.reason}),c.jsxs("p",{className:"text-sm mt-2",children:[c.jsx("strong",{children:"Specialists:"})," ",rc.doctorConsultation.specializations.join(", ")]}),c.jsx("button",{onClick:()=>n("doctors"),className:"btn-primary mt-3 text-sm",children:"Find Doctors"})]})]})})]}),Rt=()=>c.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Upload Health Report"}),c.jsx("p",{className:"text-gray-600",children:"Upload your medical report for AI-powered analysis"})]}),ce===0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"card",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Report Type"}),c.jsx("select",{className:"input",children:NYe.map(xe=>c.jsx("option",{children:xe},xe))})]}),c.jsxs("div",{className:"card",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Upload File"}),ae?c.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Vn,{className:"w-10 h-10 text-primary-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:ae.name}),c.jsxs("p",{className:"text-sm text-gray-500",children:[ae.size," MB"]})]})]}),c.jsx("button",{onClick:()=>ve(null),className:"p-2 text-gray-400 hover:text-red-500",children:c.jsx(di,{className:"w-5 h-5"})})]}):c.jsxs("div",{onClick:()=>ve({name:"blood_test_report.pdf",size:2.4}),className:"border-2 border-dashed border-gray-300 rounded-xl p-12 text-center cursor-pointer hover:border-primary-400 transition-colors",children:[c.jsx(Es,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600 mb-2",children:"Drag & drop or click to upload"}),c.jsx("p",{className:"text-sm text-gray-500",children:"PDF, PNG, JPG - max 10MB"})]})]}),c.jsxs("button",{onClick:Ve,disabled:!ae,className:"btn-primary w-full flex items-center justify-center gap-2",children:[c.jsx(Es,{className:"w-5 h-5"})," Analyze Report"]})]}),ce===1&&c.jsxs("div",{className:"card text-center py-12",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-semibold",children:"Analyzing Your Report..."}),c.jsx("p",{className:"text-gray-600 mt-2",children:"Our AI is extracting insights from your report"}),c.jsx("div",{className:"mt-6 space-y-2 text-left max-w-xs mx-auto",children:["Extracting text from PDF...","Analyzing health metrics...","Generating recommendations..."].map((xe,Je)=>c.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[c.jsx(Xd,{className:"w-4 h-4 text-green-600"}),c.jsx("span",{children:xe})]},Je))})]}),ce===2&&c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"card bg-green-50 border-2 border-green-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Xd,{className:"w-8 h-8 text-green-600"}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Analysis Complete!"}),c.jsx("p",{className:"text-green-700",children:"Your report has been analyzed successfully"})]})]})}),c.jsx("button",{onClick:()=>n("report"),className:"btn-primary w-full",children:"View Full Analysis"})]}),c.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl text-sm text-blue-800",children:[c.jsx("strong",{children:"Note:"})," AI analysis is for informational purposes only. Always consult a healthcare provider."]})]}),Te=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s?"Manage Doctors":"Find Doctors"}),c.jsx("p",{className:"text-gray-600",children:s?"Add and manage platform doctors":"Book consultations with specialists"})]}),s&&c.jsxs("button",{onClick:()=>ue(!0),className:"btn-primary flex items-center gap-2",children:[c.jsx(Qc,{className:"w-4 h-4"})," Add Doctor"]})]}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(qw,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search doctors...",value:X,onChange:xe=>ee(xe.target.value),className:"input pl-12"})]}),c.jsx("div",{className:"flex gap-2 flex-wrap",children:Nq.slice(0,5).map(xe=>c.jsx("button",{onClick:()=>q(xe),className:`px-4 py-2 rounded-xl text-sm font-medium transition-colors ${$===xe?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:xe},xe))})]}),c.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:Mt.map(xe=>{var Je;return c.jsxs("div",{className:"card hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-xl flex items-center justify-center text-2xl font-bold text-primary-600",children:((Je=xe.name.split(" ")[1])==null?void 0:Je[0])||xe.name[0]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:xe.name}),c.jsx("p",{className:"text-sm text-primary-600",children:xe.specialization}),c.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[c.jsx(ja,{className:"w-4 h-4 text-yellow-400 fill-yellow-400"}),c.jsx("span",{className:"text-sm font-medium",children:xe.rating}),c.jsxs("span",{className:"text-sm text-gray-500",children:["(",xe.reviews,")"]})]})]})]}),c.jsxs("div",{className:"mt-4 space-y-2 text-sm text-gray-600",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(To,{className:"w-4 h-4"}),c.jsxs("span",{children:[xe.experience," years experience"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(nP,{className:"w-4 h-4"}),c.jsx("span",{children:xe.hospital})]})]}),c.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["",xe.fee]}),c.jsx("span",{className:"text-sm text-gray-500",children:" / session"})]}),xe.available?c.jsx("button",{onClick:()=>{I(xe),O(0)},className:"btn-primary text-sm",children:"Book Now"}):c.jsx("span",{className:"px-3 py-1.5 bg-gray-100 text-gray-500 rounded-xl text-sm",children:"Unavailable"})]})]},xe._id)})}),J&&c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-bold",children:"Add New Doctor"}),c.jsx("button",{onClick:()=>ue(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:c.jsx(di,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Doctor Name"}),c.jsx("input",{type:"text",value:re.name,onChange:xe=>he({...re,name:xe.target.value}),className:"input",placeholder:"Dr. John Smith"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Specialization"}),c.jsxs("select",{value:re.specialization,onChange:xe=>he({...re,specialization:xe.target.value}),className:"input",children:[c.jsx("option",{value:"",children:"Select"}),Nq.slice(1).map(xe=>c.jsx("option",{children:xe},xe))]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Experience (yrs)"}),c.jsx("input",{type:"number",value:re.experience,onChange:xe=>he({...re,experience:xe.target.value}),className:"input"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fee ()"}),c.jsx("input",{type:"number",value:re.fee,onChange:xe=>he({...re,fee:xe.target.value}),className:"input"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hospital/Clinic"}),c.jsx("input",{type:"text",value:re.hospital,onChange:xe=>he({...re,hospital:xe.target.value}),className:"input"})]}),c.jsx("button",{onClick:it,className:"btn-primary w-full",children:"Add Doctor"})]})]})})]}),st=()=>{var xe;return N&&c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 max-h-[90vh] overflow-y-auto",children:[R<3&&c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-bold",children:R===0?"Book Appointment":R===1?"Select Slot":"Payment"}),c.jsx("button",{onClick:Pe,className:"p-2 hover:bg-gray-100 rounded-lg",children:c.jsx(di,{className:"w-5 h-5"})})]}),R===0&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-xl",children:[c.jsx("div",{className:"w-14 h-14 bg-primary-100 rounded-full flex items-center justify-center text-xl font-bold text-primary-600",children:(xe=N.name.split(" ")[1])==null?void 0:xe[0]}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:N.name}),c.jsx("p",{className:"text-sm text-primary-600",children:N.specialization}),c.jsx("p",{className:"text-sm text-gray-500",children:N.hospital})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Consultation Type"}),c.jsx("div",{className:"flex gap-4",children:["online","in-person"].map(Je=>c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",name:"type",checked:P.type===Je,onChange:()=>M({...P,type:Je}),className:"text-primary-600"}),Je==="online"?c.jsxs(c.Fragment,{children:[c.jsx(du,{className:"w-4 h-4"})," Online"]}):c.jsxs(c.Fragment,{children:[c.jsx(nP,{className:"w-4 h-4"})," In-Person"]})]},Je))})]}),c.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl",children:[c.jsxs("p",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Consultation Fee:"})," ",N.fee]}),c.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Pay ",N.fee/2," now to confirm (50% advance)"]})]}),c.jsx("button",{onClick:De,className:"btn-primary w-full",children:"Select Date & Time"})]}),R===1&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Date"}),c.jsx("input",{type:"date",value:P.date,onChange:Je=>M({...P,date:Je.target.value}),min:new Date().toISOString().split("T")[0],className:"input"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Available Slots"}),c.jsx("div",{className:"grid grid-cols-3 gap-2",children:N.slots.map(Je=>c.jsx("button",{onClick:()=>M({...P,slot:Je}),className:`py-2 px-3 rounded-lg text-sm font-medium transition-colors ${P.slot===Je?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:Je},Je))})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>O(0),className:"flex-1 py-2.5 border border-gray-300 rounded-xl font-medium",children:"Back"}),c.jsx("button",{onClick:De,disabled:!P.date||!P.slot,className:"flex-1 btn-primary",children:"Continue to Payment"})]})]}),R===2&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl space-y-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Doctor"}),c.jsx("span",{className:"font-medium",children:N.name})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Date"}),c.jsx("span",{className:"font-medium",children:P.date})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Time"}),c.jsx("span",{className:"font-medium",children:P.slot})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Type"}),c.jsx("span",{className:"font-medium capitalize",children:P.type})]}),c.jsxs("div",{className:"border-t pt-2 mt-2 flex justify-between",children:[c.jsx("span",{className:"font-semibold",children:"Amount to Pay"}),c.jsxs("span",{className:"font-bold text-primary-600",children:["",N.fee/2]})]})]}),c.jsxs("div",{className:"p-4 border border-gray-200 rounded-xl",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx(OQ,{className:"w-5 h-5 text-gray-600"}),c.jsx("span",{className:"font-medium",children:"Payment Method"})]}),c.jsx("div",{className:"space-y-2",children:["UPI","Credit/Debit Card","Net Banking"].map(Je=>c.jsxs("label",{className:"flex items-center gap-2 p-2 border rounded-lg cursor-pointer hover:bg-gray-50",children:[c.jsx("input",{type:"radio",name:"payment",defaultChecked:Je==="UPI"}),c.jsx("span",{children:Je})]},Je))})]}),c.jsxs("button",{onClick:De,className:"btn-primary w-full flex items-center justify-center gap-2",children:[c.jsx(my,{className:"w-4 h-4"})," Pay ",N.fee/2," Securely"]})]}),R===3&&c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:c.jsx(Xd,{className:"w-8 h-8 text-green-600"})}),c.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Booking Confirmed!"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Your appointment has been scheduled"}),c.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl text-left space-y-2 mb-4",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Doctor:"})," ",N.name]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Date:"})," ",P.date," at ",P.slot]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Type:"})," ",P.type==="online"?"Video Consultation":"In-Person"]}),P.type==="online"&&c.jsxs("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:[c.jsxs("p",{className:"text-sm text-blue-800 font-medium flex items-center gap-2",children:[c.jsx(du,{className:"w-4 h-4"})," Video Call Link"]}),c.jsxs("p",{className:"text-sm text-blue-600 mt-1 break-all",children:["https://meet.healthai.com/apt-",Math.random().toString(36).substr(2,6)]}),c.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"Link will be available in your dashboard"})]})]}),c.jsx("button",{onClick:()=>{Pe(),n("dashboard")},className:"btn-primary w-full",children:"Go to Dashboard"})]})]})})},ct=()=>{var xe,Je;return c.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Profile Settings"}),c.jsx("p",{className:"text-gray-600",children:"Manage your personal and health information"})]}),c.jsx("div",{className:"card gradient-bg text-white",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-xl flex items-center justify-center",children:c.jsx(jn,{className:"w-8 h-8"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Health Score"}),c.jsx("p",{className:"text-3xl font-bold",children:"78/100"})]}),c.jsxs("div",{className:"ml-auto text-right",children:[c.jsx("p",{className:"text-sm opacity-80",children:"BMI"}),c.jsx("p",{className:"text-2xl font-bold",children:"23.5"})]})]})}),c.jsxs("div",{className:"card",children:[c.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[c.jsx(tl,{className:"w-5 h-5 text-primary-600"})," Basic Information"]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),c.jsx("input",{type:"text",value:HO.name,className:"input",readOnly:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),c.jsx("input",{type:"email",value:HO.email,className:"input bg-gray-50",disabled:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Age"}),c.jsx("input",{type:"number",value:Ee.age,onChange:yt=>Fe({...Ee,age:yt.target.value}),className:"input"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender"}),c.jsxs("select",{value:Ee.gender,onChange:yt=>Fe({...Ee,gender:yt.target.value}),className:"input",children:[c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"}),c.jsx("option",{value:"other",children:"Other"})]})]})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Health Information"}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Height (cm)"}),c.jsx("input",{type:"number",value:Ee.height,onChange:yt=>Fe({...Ee,height:yt.target.value}),className:"input"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Weight (kg)"}),c.jsx("input",{type:"number",value:Ee.weight,onChange:yt=>Fe({...Ee,weight:yt.target.value}),className:"input"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Blood Group"}),c.jsx("select",{value:Ee.bloodGroup,onChange:yt=>Fe({...Ee,bloodGroup:yt.target.value}),className:"input",children:["A+","A-","B+","B-","AB+","AB-","O+","O-"].map(yt=>c.jsx("option",{children:yt},yt))})]})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Medical History"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allergies"}),c.jsx("input",{type:"text",value:(xe=Ee.allergies)==null?void 0:xe.join(", "),className:"input",placeholder:"e.g., Penicillin, Peanuts"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chronic Conditions"}),c.jsx("input",{type:"text",value:(Je=Ee.chronicConditions)==null?void 0:Je.join(", "),className:"input",placeholder:"e.g., Diabetes, Hypertension"})]})]})]}),c.jsxs("button",{className:"btn-primary w-full flex items-center justify-center gap-2",onClick:()=>alert("Profile saved!"),children:[c.jsx(Xd,{className:"w-5 h-5"})," Save Changes"]})]})},zt=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("button",{onClick:()=>n("dashboard"),className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back to Dashboard"]}),c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-14 h-14 bg-primary-100 rounded-xl flex items-center justify-center",children:c.jsx(Vn,{className:"w-7 h-7 text-primary-600"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Blood Test Report"}),c.jsx("p",{className:"text-gray-500",children:"Analyzed on Dec 5, 2024"})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-3xl font-bold text-primary-600",children:"78"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Health Score"})]})]}),c.jsxs("div",{className:"flex gap-3 mt-4 pt-4 border-t border-gray-100",children:[c.jsxs("button",{onClick:()=>_(!b),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-xl hover:bg-blue-100",children:[c.jsx(aH,{className:"w-4 h-4"}),b?"Hide":"Compare"]}),c.jsxs("button",{onClick:()=>E(!w),className:"flex items-center gap-2 px-4 py-2 bg-purple-50 text-purple-700 rounded-xl hover:bg-purple-100",children:[c.jsx(lH,{className:"w-4 h-4"}),"Ask AI"]})]})]}),b&&c.jsxs("div",{className:"card border-2 border-blue-200 bg-blue-50/50",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[c.jsx(aH,{className:"w-5 h-5 text-blue-600"})," Health Comparison"]}),c.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-700",children:" Improved"})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[c.jsxs("div",{className:"bg-white p-4 rounded-xl",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Previous (Oct)"}),c.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"72/100"})]}),c.jsxs("div",{className:"bg-white p-4 rounded-xl",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Current (Dec)"}),c.jsx("p",{className:"text-2xl font-bold text-primary-600",children:"78/100"})]})]}),c.jsx("p",{className:"text-gray-700 mb-4",children:Tq.summary}),c.jsx("div",{className:"space-y-2 mb-4",children:Tq.metricChanges.map((xe,Je)=>c.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(tt,{trend:xe.change}),c.jsx("span",{className:"font-medium",children:xe.metric})]}),c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"text-gray-500",children:xe.previous}),"  ",c.jsx("span",{className:"font-medium",children:xe.current})]})]},Je))})]}),w&&c.jsxs("div",{className:"card border-2 border-purple-200",children:[c.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[c.jsx(lH,{className:"w-5 h-5 text-purple-600"})," Ask About Your Report"]}),c.jsxs("div",{className:"h-48 overflow-y-auto mb-4 space-y-3 p-3 bg-gray-50 rounded-xl",children:[d.length===0&&c.jsx("p",{className:"text-gray-500 text-center py-6",children:'Try: "What does my cholesterol mean?" or "Should I be worried?"'}),d.map((xe,Je)=>c.jsx("div",{className:`flex ${xe.role==="user"?"justify-end":"justify-start"}`,children:c.jsx("div",{className:`max-w-[80%] p-3 rounded-xl ${xe.role==="user"?"bg-purple-600 text-white":"bg-white border"}`,children:xe.content})},Je)),c.jsx("div",{ref:ke})]}),c.jsxs("form",{onSubmit:Ge,className:"flex gap-2",children:[c.jsx("input",{type:"text",value:f,onChange:xe=>v(xe.target.value),placeholder:"Ask a question...",className:"input flex-1"}),c.jsx("button",{type:"submit",className:"btn-primary px-4",children:c.jsx(db,{className:"w-5 h-5"})})]})]}),c.jsxs("div",{className:"card",children:[c.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[c.jsx(jn,{className:"w-5 h-5 text-primary-600"})," Summary"]}),c.jsx("p",{className:"text-gray-700",children:rc.summary})]}),c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Health Metrics"}),c.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:Object.entries(rc.metrics).map(([xe,Je])=>c.jsxs("div",{className:`p-4 rounded-xl ${Je.status==="normal"?"bg-green-50":"bg-yellow-50"}`,children:[c.jsx("p",{className:"text-sm text-gray-600 capitalize",children:xe.replace(/([A-Z])/g," $1")}),c.jsxs("p",{className:"text-xl font-bold",children:[Je.value," ",Je.unit]}),c.jsxs("p",{className:"text-xs text-gray-500",children:["Normal: ",Je.normalRange]}),c.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded ${Je.status==="normal"?"bg-green-200 text-green-800":"bg-yellow-200 text-yellow-800"}`,children:Je.status})]},xe))})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"card",children:[c.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[c.jsx(zn,{className:"w-5 h-5 text-blue-600"})," Key Findings"]}),c.jsx("ul",{className:"space-y-2",children:rc.keyFindings.map((xe,Je)=>c.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2"}),xe]},Je))})]}),c.jsxs("div",{className:"card border-l-4 border-orange-400",children:[c.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[c.jsx($d,{className:"w-5 h-5 text-orange-600"})," Risk Factors"]}),c.jsx("ul",{className:"space-y-2",children:rc.riskFactors.map((xe,Je)=>c.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full mt-2"}),xe]},Je))})]})]}),c.jsxs("div",{className:"card",children:[c.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[c.jsx(Pa,{className:"w-5 h-5 text-green-600"})," Diet"]}),c.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:rc.recommendations.diet.map((xe,Je)=>c.jsxs("div",{className:"p-4 bg-green-50 rounded-xl",children:[c.jsxs("div",{className:"flex justify-between mb-2",children:[c.jsx("span",{className:"font-medium text-green-800",children:xe.item}),c.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${xe.priority==="high"?"bg-green-200 text-green-800":"bg-gray-200"}`,children:xe.priority})]}),c.jsx("p",{className:"text-sm text-green-700",children:xe.reason})]},Je))})]}),c.jsxs("div",{className:"card",children:[c.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[c.jsx(Of,{className:"w-5 h-5 text-blue-600"})," Exercise"]}),rc.recommendations.exercise.map((xe,Je)=>c.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl mb-3",children:[c.jsxs("div",{className:"flex justify-between mb-2",children:[c.jsx("span",{className:"font-medium text-blue-800",children:xe.activity}),c.jsxs("span",{className:"text-sm text-blue-600",children:[xe.duration,"  ",xe.frequency]})]}),c.jsx("p",{className:"text-sm text-blue-700",children:xe.reason})]},Je))]}),c.jsxs("div",{className:"card border-2 border-primary-200 bg-primary-50/30",children:[c.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[c.jsx(Pf,{className:"w-5 h-5 text-primary-600"})," Recommended Doctors"]}),c.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:Bk.filter(xe=>rc.doctorConsultation.specializations.includes(xe.specialization)).map(xe=>c.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center text-lg font-bold text-primary-600",children:xe.name.split(" ")[1][0]}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:xe.name}),c.jsx("p",{className:"text-sm text-primary-600",children:xe.specialization})]})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[c.jsx(ja,{className:"w-4 h-4 text-yellow-400 fill-yellow-400"}),xe.rating,"  ",c.jsx(To,{className:"w-4 h-4"}),xe.experience," yrs"]}),c.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t",children:[c.jsxs("span",{className:"font-semibold",children:["",xe.fee]}),c.jsx("button",{onClick:()=>{I(xe),n("doctors")},className:"text-sm bg-primary-600 text-white px-3 py-1.5 rounded-lg hover:bg-primary-700",children:"Book Now"})]})]},xe._id))})]})]}),Ke=()=>c.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 fixed h-full flex flex-col",children:[c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-10 h-10 gradient-bg rounded-xl flex items-center justify-center",children:c.jsx(jn,{className:"w-6 h-6 text-white"})}),c.jsx("span",{className:"text-xl font-bold text-gray-900",children:"HealthAI"})]}),c.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:"Demo Mode"})]}),c.jsx("nav",{className:"px-4 space-y-1 flex-1",children:[{id:"dashboard",icon:RNe,label:"Dashboard"},{id:"upload",icon:Es,label:"Upload Report"},{id:"report",icon:Vn,label:"Report & Chat"},{id:"doctors",icon:Pf,label:"Doctors"},{id:"profile",icon:tl,label:"Profile"}].map(xe=>c.jsxs("button",{onClick:()=>n(xe.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${e===xe.id?"bg-primary-50 text-primary-600":"text-gray-600 hover:bg-gray-50"}`,children:[c.jsx(xe.icon,{className:"w-5 h-5"}),c.jsx("span",{className:"font-medium",children:xe.label})]},xe.id))}),c.jsx("div",{className:"px-4 py-3 border-t border-gray-100",children:c.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:s,onChange:xe=>o(xe.target.checked),className:"w-4 h-4 text-primary-600 rounded"}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Admin Mode"}),c.jsx(pg,{className:"w-4 h-4 text-gray-400"})]})}),c.jsx("div",{className:"p-4 border-t border-gray-100",children:c.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[c.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-primary-600 font-semibold",children:"J"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s?"Admin User":"John Doe"}),c.jsx("p",{className:"text-xs text-gray-500 truncate",children:s?"admin@healthai.com":"john@example.com"})]}),c.jsx(Hj,{className:"w-5 h-5 text-gray-400"})]})})]});return c.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[c.jsx(Ke,{}),c.jsxs("main",{className:"flex-1 ml-64 p-8",children:[e==="dashboard"&&c.jsx(ft,{}),e==="upload"&&c.jsx(Rt,{}),e==="report"&&c.jsx(zt,{}),e==="doctors"&&c.jsx(Te,{}),e==="profile"&&c.jsx(ct,{})]}),c.jsx(st,{})]})}function RYe(){const[e,n]=z.useState(null),[s,o]=z.useState(!0),[d,h]=z.useState("overview");z.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:b}=await yw.getStats();n(b)}catch{et.error("Failed to load stats")}finally{o(!1)}};if(s)return c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsx("div",{className:"w-12 h-12 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin"})});const v=[{id:"overview",label:"Overview",icon:jn},{id:"doctors",label:"Doctors",icon:FQ}];return c.jsxs("div",{className:"space-y-6 animate-fade-in",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Admin Dashboard"}),c.jsx("p",{className:"text-slate-500 mt-1",children:"Manage platform settings and monitor activity"})]}),c.jsx("div",{className:"flex gap-2 p-1 bg-slate-100 rounded-xl w-fit",children:v.map(({id:b,label:_,icon:w})=>c.jsxs("button",{onClick:()=>h(b),className:`flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium transition-all ${d===b?"bg-white text-slate-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[c.jsx(w,{className:"w-4 h-4"}),c.jsx("span",{children:_})]},b))}),d==="overview"&&c.jsx(AYe,{stats:e}),d==="doctors"&&c.jsx(IYe,{})]})}function AYe({stats:e}){var n,s,o,d;return e?c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center mb-3",children:c.jsx(Pf,{className:"w-5 h-5 text-blue-600"})}),c.jsx("p",{className:"text-sm text-slate-500",children:"Total Patients"}),c.jsx("p",{className:"text-2xl font-bold text-slate-800",children:((n=e.stats)==null?void 0:n.totalUsers)||0})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center mb-3",children:c.jsx(rr,{className:"w-5 h-5 text-green-600"})}),c.jsx("p",{className:"text-sm text-slate-500",children:"Active Users"}),c.jsx("p",{className:"text-2xl font-bold text-slate-800",children:((s=e.stats)==null?void 0:s.activeUsers)||0})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-purple-100 flex items-center justify-center mb-3",children:c.jsx(Vn,{className:"w-5 h-5 text-purple-600"})}),c.jsx("p",{className:"text-sm text-slate-500",children:"Total Reports"}),c.jsx("p",{className:"text-2xl font-bold text-slate-800",children:((o=e.stats)==null?void 0:o.totalReports)||0})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center mb-3",children:c.jsx(Vr,{className:"w-5 h-5 text-amber-600"})}),c.jsx("p",{className:"text-sm text-slate-500",children:"Pending Doctors"}),c.jsx("p",{className:"text-2xl font-bold text-slate-800",children:((d=e.stats)==null?void 0:d.pendingDoctors)||0})]})]}):null}function IYe(){const[e,n]=z.useState([]),[s,o]=z.useState(!0),[d,h]=z.useState("all");z.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:E}=await yw.getDoctors();n(E.doctors||[])}catch{et.error("Failed to load doctors")}finally{o(!1)}},v=async E=>{try{await yw.approveDoctor(E),n(e.map(N=>N._id===E?{...N,approvalStatus:"approved",isListed:!0}:N)),et.success("Doctor approved!")}catch{et.error("Failed to approve")}},b=async E=>{try{await yw.rejectDoctor(E),n(e.map(N=>N._id===E?{...N,approvalStatus:"rejected",isListed:!1}:N)),et.success("Doctor rejected")}catch{et.error("Failed to reject")}},_=e.filter(E=>d==="all"?!0:E.approvalStatus===d),w=e.filter(E=>E.approvalStatus==="pending").length;return s?c.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 animate-pulse h-64"}):c.jsxs("div",{className:"space-y-4",children:[w>0&&c.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl flex items-center gap-4",children:[c.jsx(Vr,{className:"w-6 h-6 text-amber-500"}),c.jsx("div",{className:"flex-1",children:c.jsxs("p",{className:"font-medium text-amber-800",children:[w," Doctor(s) Pending Approval"]})}),c.jsx("button",{onClick:()=>h("pending"),className:"px-4 py-2 bg-amber-500 text-white font-medium rounded-lg hover:bg-amber-600",children:"Review"})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Doctor Management"}),c.jsx("div",{className:"flex gap-2",children:["all","pending","approved","rejected"].map(E=>c.jsx("button",{onClick:()=>h(E),className:`px-3 py-1.5 rounded-lg text-sm font-medium capitalize ${d===E?"bg-cyan-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:E},E))})]}),c.jsxs("div",{className:"space-y-3",children:[_.map(E=>{var N,I;return c.jsx("div",{className:`p-4 rounded-xl border ${E.approvalStatus==="pending"?"bg-amber-50 border-amber-200":E.approvalStatus==="rejected"?"bg-red-50 border-red-200":"bg-slate-50 border-slate-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center text-white font-bold",children:(I=(N=E.name)==null?void 0:N[0])==null?void 0:I.toUpperCase()}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("h3",{className:"font-semibold text-slate-800",children:["Dr. ",E.name]}),c.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${E.approvalStatus==="approved"?"bg-green-100 text-green-700":E.approvalStatus==="rejected"?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:E.approvalStatus})]}),c.jsx("p",{className:"text-sm text-cyan-600",children:E.specialization}),c.jsxs("p",{className:"text-xs text-slate-500",children:[E.experience," yrs  ",E.consultationFee||0]})]})]}),c.jsx("div",{className:"flex items-center gap-2",children:E.approvalStatus==="pending"&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>v(E._id),className:"px-3 py-1.5 bg-green-500 text-white text-sm font-medium rounded-lg hover:bg-green-600 flex items-center gap-1",children:[c.jsx(rr,{className:"w-4 h-4"})," Approve"]}),c.jsxs("button",{onClick:()=>b(E._id),className:"px-3 py-1.5 bg-slate-200 text-red-600 text-sm font-medium rounded-lg hover:bg-slate-300 flex items-center gap-1",children:[c.jsx(VQ,{className:"w-4 h-4"})," Reject"]})]})})]})},E._id)}),_.length===0&&c.jsxs("div",{className:"text-center py-8 text-slate-500",children:[c.jsx(FQ,{className:"w-10 h-10 mx-auto mb-2 text-slate-300"}),c.jsx("p",{children:"No doctors found"})]})]})]})]})}const OYe=[{id:"free",name:"Free",price:0,period:"forever",features:["1 Report analysis per month","Basic AI insights","View doctor listings","Email support"],color:"slate",icon:ja},{id:"basic",name:"Basic",price:0,period:"month",features:["5 Report analyses per month","Full AI analysis with deficiencies","Personalized diet plans","Supplement recommendations","Health trend tracking","Priority support"],color:"cyan",icon:xo,popular:!0},{id:"premium",name:"Premium",price:0,period:"month",features:["Unlimited report analyses","Advanced AI insights","Personalized diet & exercise plans","Supplement recommendations","Health trend analytics","Chat with AI about reports","Doctor recommendations","24/7 Priority support"],color:"violet",icon:Z2}];function PYe(){var _;const{user:e}=as(),[n,s]=z.useState(null),[o,d]=z.useState(!0),[h,f]=z.useState("monthly");z.useEffect(()=>{v()},[]);const v=async()=>{try{const{data:w}=await uNe.getSubscription();s(w)}catch{console.error("Failed to fetch subscription")}finally{d(!1)}},b=(n==null?void 0:n.plan)||((_=e==null?void 0:e.subscription)==null?void 0:_.plan)||"free";return o?c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsx("div",{className:"w-12 h-12 border-4 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin"})}):c.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fade-in",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"inline-flex items-center gap-2 bg-violet-500/20 text-violet-400 px-4 py-2 rounded-full text-sm font-semibold mb-4",children:[c.jsx(Z2,{className:"w-4 h-4"}),"Subscription Plans"]}),c.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Choose Your Plan"}),c.jsx("p",{className:"text-slate-400 max-w-lg mx-auto",children:"Unlock the full potential of AI-powered health insights with our premium plans"})]}),c.jsxs("div",{className:"bg-gradient-to-r from-cyan-600 to-blue-600 rounded-2xl p-6 text-white relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 opacity-10",children:c.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white rounded-full -translate-y-1/2 translate-x-1/2"})}),c.jsxs("div",{className:"relative flex flex-col md:flex-row md:items-center justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-14 h-14 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center",children:c.jsx(Z2,{className:"w-7 h-7"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white/70 text-sm",children:"Current Plan"}),c.jsx("h2",{className:"text-2xl font-bold capitalize",children:b})]})]}),c.jsxs("div",{className:"flex items-center gap-6",children:[(n==null?void 0:n.endDate)&&c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-white/70 text-sm",children:"Renewal Date"}),c.jsx("p",{className:"font-semibold",children:new Date(n.endDate).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]}),c.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-white/20 backdrop-blur-sm rounded-xl",children:[c.jsx(qr,{className:"w-4 h-4"}),c.jsx("span",{className:"font-medium capitalize",children:(n==null?void 0:n.status)||"Active"})]})]})]})]}),c.jsx("div",{className:"flex justify-center",children:c.jsxs("div",{className:"flex items-center gap-3 p-1 bg-slate-800 rounded-xl",children:[c.jsx("button",{onClick:()=>f("monthly"),className:`px-6 py-2.5 rounded-lg font-medium transition-all ${h==="monthly"?"bg-slate-700 text-white":"text-slate-400"}`,children:"Monthly"}),c.jsxs("button",{onClick:()=>f("yearly"),className:`px-6 py-2.5 rounded-lg font-medium transition-all flex items-center gap-2 ${h==="yearly"?"bg-slate-700 text-white":"text-slate-400"}`,children:["Yearly",c.jsx("span",{className:"text-xs bg-emerald-500/20 text-emerald-400 px-2 py-0.5 rounded-full",children:"Save 20%"})]})]})}),c.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:OYe.map(w=>{const E=w.icon,N=b===w.id,I=h==="yearly"?Math.round(w.price*12*.8):w.price;return c.jsxs("div",{className:`bg-[#111827] rounded-2xl border p-6 relative ${w.popular?"border-cyan-500":"border-slate-700"} ${N?"ring-2 ring-cyan-500 ring-offset-2 ring-offset-[#0a0f1a]":""}`,children:[w.popular&&c.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2",children:c.jsx("span",{className:"bg-cyan-500 text-white text-xs font-bold px-4 py-1.5 rounded-full shadow-lg",children:"Most Popular"})}),c.jsxs("div",{className:"text-center mb-6 pt-2",children:[c.jsx("div",{className:`w-14 h-14 rounded-2xl mx-auto mb-4 flex items-center justify-center bg-${w.color}-500/20`,children:c.jsx(E,{className:`w-7 h-7 text-${w.color}-400`})}),c.jsx("h3",{className:"text-xl font-bold text-white",children:w.name}),c.jsxs("div",{className:"mt-4",children:[c.jsxs("span",{className:"text-4xl font-bold text-white",children:["",I]}),c.jsxs("span",{className:"text-slate-400",children:["/",h==="yearly"?"year":w.period]})]})]}),c.jsx("ul",{className:"space-y-3 mb-8",children:w.features.map((R,O)=>c.jsxs("li",{className:"flex items-start gap-3 text-sm",children:[c.jsx("div",{className:`w-5 h-5 rounded-full bg-${w.color}-500/20 flex items-center justify-center flex-shrink-0 mt-0.5`,children:c.jsx(Xd,{className:`w-3 h-3 text-${w.color}-400`})}),c.jsx("span",{className:"text-slate-400",children:R})]},O))}),c.jsx("button",{className:`w-full py-3 rounded-xl font-semibold transition-all ${N?"bg-slate-800 text-slate-500 cursor-default":w.popular?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white hover:opacity-90":"border-2 border-slate-700 text-slate-300 hover:border-cyan-500 hover:text-cyan-400"}`,disabled:N,children:N?"Current Plan":w.price===0?"Downgrade":"Upgrade Now"})]},w.id)})}),c.jsx("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center flex-shrink-0",children:c.jsx(OQ,{className:"w-6 h-6 text-blue-400"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-white mb-2",children:"Secure Payment"}),c.jsx("p",{className:"text-slate-400 text-sm",children:"All payments are processed securely. You can upgrade, downgrade, or cancel your subscription at any time. Changes take effect immediately and unused time is prorated."})]})]})})]})}const Cv=[{id:"apple_watch",name:"Apple Watch",icon:Ol,description:"Sync health data from your Apple Watch and iPhone",tags:["Heart Rate","Activity","Sleep"],color:"bg-slate-800",textColor:"text-slate-800"},{id:"google_fit",name:"Google Fit",icon:jn,description:"Aggregates data from Android devices and apps",tags:["Activity","Nutrition","Weight"],color:"bg-blue-500",textColor:"text-blue-600"},{id:"fitbit",name:"Fitbit",icon:xo,description:"Track steps, heart rate, and sleep patterns",tags:["Steps","Heart","Sleep"],color:"bg-cyan-500",textColor:"text-cyan-600"},{id:"garmin",name:"Garmin Connect",icon:Or,description:"High-fidelity GPS and heart rate data",tags:["Cardio","GPS","Training"],color:"bg-indigo-600",textColor:"text-indigo-600"},{id:"samsung",name:"Samsung Health",icon:UQ,description:"Galaxy Watch and phone health data",tags:["Activity","Sleep","Stress"],color:"bg-purple-600",textColor:"text-purple-600"},{id:"oura",name:"Oura Ring",icon:hg,description:"Advanced sleep and recovery tracking",tags:["Sleep","Recovery","HRV"],color:"bg-slate-700",textColor:"text-slate-700"}];function kYe(){const[e,n]=z.useState([]),[s,o]=z.useState(!0),[d,h]=z.useState(!1),[f,v]=z.useState(!1),[b,_]=z.useState(null);z.useEffect(()=>{w()},[]);const w=async()=>{try{const{data:P}=await $m.getDashboard();P.devices&&n(P.devices)}catch(P){console.error("Failed to fetch devices:",P)}finally{o(!1)}},E=async()=>{h(!0);try{e.length>0?(await $m.generateDemoData(e[0].type),await w(),et.success("All devices synced successfully!")):et.error("No devices connected")}catch(P){console.error("Sync failed:",P),et.error("Failed to sync devices")}finally{h(!1)}},N=async P=>{try{const M=Cv.find(D=>D.id===P);await $m.connectDevice(P,M==null?void 0:M.name),await $m.generateDemoData(P),await w(),v(!1),et.success(`${M==null?void 0:M.name} connected successfully!`)}catch(M){console.error("Failed to connect:",M),et.error("Failed to connect device")}},I=async P=>{try{await $m.disconnectDevice(P),await w(),et.success("Device disconnected")}catch(M){console.error("Failed to disconnect:",M),et.error("Failed to disconnect device")}},R=P=>{const M=Cv.find(D=>D.id===P);return(M==null?void 0:M.icon)||Ol},O=P=>{const M=Cv.find(D=>D.id===P);return(M==null?void 0:M.color)||"bg-slate-600"};return s?c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-slate-500",children:"Loading devices..."})]})}):c.jsxs("div",{className:"space-y-6 animate-fade-in",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Connected Devices"}),c.jsxs("p",{className:"text-slate-500 mt-1 flex items-center gap-2",children:[c.jsx(To,{className:"w-4 h-4"}),"Last synced: ",new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})]})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("button",{onClick:E,disabled:d||e.length===0,className:"flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 text-slate-700 rounded-xl hover:bg-slate-50 transition-all disabled:opacity-50",children:[c.jsx(jNe,{className:`w-4 h-4 ${d?"animate-spin":""}`}),"Sync All"]}),c.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-xl hover:shadow-lg transition-all",children:[c.jsx(Qc,{className:"w-4 h-4"}),"Add Device"]})]})]}),e.length===0&&c.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded-xl p-4 flex items-start gap-3",children:[c.jsx("div",{className:"w-6 h-6 rounded-full bg-cyan-100 flex items-center justify-center shrink-0 mt-0.5",children:c.jsx(Vr,{className:"w-4 h-4 text-cyan-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-cyan-900 font-medium",children:"No devices connected yet"}),c.jsx("p",{className:"text-cyan-700 text-sm mt-1",children:"Connect your wearable devices to automatically track your health metrics and get personalized insights."})]})]}),e.length>0&&c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(ANe,{className:"w-5 h-5 text-slate-600"}),c.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Your Devices"}),c.jsxs("span",{className:"px-2 py-0.5 bg-cyan-100 text-cyan-700 rounded-full text-xs font-medium",children:[e.length," connected"]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map((P,M)=>{const D=R(P.type),U=O(P.type),B=Math.floor(Math.random()*50)+50;return c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm hover:shadow-md transition-all",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:`w-12 h-12 rounded-xl ${U} flex items-center justify-center`,children:c.jsx(D,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-slate-800 font-semibold",children:P.name}),c.jsx("p",{className:"text-slate-500 text-sm",children:P.type})]})]}),c.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-emerald-100 text-emerald-700 rounded-full text-xs font-medium",children:[c.jsx(rr,{className:"w-3 h-3"}),"Active"]})]}),c.jsx("div",{className:"flex gap-1 mb-4 h-16 bg-slate-50 rounded-lg p-2",children:[...Array(7)].map((G,$)=>{const q=30+Math.random()*70;return c.jsx("div",{className:"flex-1 bg-gradient-to-t from-cyan-500 to-blue-500 rounded-sm",style:{height:`${q}%`,marginTop:"auto"}},$)})}),c.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-slate-200",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-1 text-slate-600",children:[c.jsx(zn,{className:"w-4 h-4"}),c.jsx("span",{className:"text-xs",children:"Heart"})]}),c.jsxs("div",{className:"flex items-center gap-1 text-slate-600",children:[c.jsx(jQ,{className:"w-4 h-4"}),c.jsx("span",{className:"text-xs",children:"Steps"})]}),c.jsxs("div",{className:"flex items-center gap-1 text-slate-600",children:[c.jsx(hg,{className:"w-4 h-4"}),c.jsx("span",{className:"text-xs",children:"Sleep"})]})]}),c.jsxs("div",{className:"flex items-center gap-1 text-slate-500 text-xs",children:[c.jsx(gNe,{className:"w-4 h-4"}),B,"%"]})]}),c.jsxs("div",{className:"mt-4 flex gap-2",children:[c.jsx("button",{onClick:()=>E(),className:"flex-1 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors text-sm font-medium",children:"Sync Now"}),c.jsx("button",{onClick:()=>I(P.type),className:"px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors text-sm",children:"Disconnect"})]})]},M)})})]}),c.jsxs("div",{children:[c.jsx("div",{className:"flex items-center justify-between mb-4",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ol,{className:"w-5 h-5 text-slate-600"}),c.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Available Integrations"})]})}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Cv.map(P=>{const M=P.icon,D=e.some(U=>U.type===P.id);return c.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm hover:shadow-md transition-all",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[c.jsx("div",{className:`w-12 h-12 rounded-xl ${P.color} flex items-center justify-center shrink-0`,children:c.jsx(M,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx("p",{className:"text-slate-800 font-semibold",children:P.name}),D&&c.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded-full text-xs font-medium",children:"Connected"})]}),c.jsx("p",{className:"text-slate-500 text-sm mb-3",children:P.description}),c.jsx("div",{className:"flex flex-wrap gap-2",children:P.tags.map(U=>c.jsx("span",{className:"px-2 py-1 bg-slate-100 rounded-lg text-slate-600 text-xs",children:U},U))})]})]}),c.jsx("button",{onClick:()=>D?I(P.id):N(P.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${D?"bg-slate-100 text-slate-700 hover:bg-slate-200":"bg-gradient-to-r from-cyan-500 to-blue-500 text-white hover:shadow-lg"}`,children:D?"Disconnect":"Connect"})]})},P.id)})})]}),f&&c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 animate-fade-in",children:c.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-xl animate-slide-up",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Connect a Device"}),c.jsx("button",{onClick:()=>v(!1),className:"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-slate-600 hover:bg-slate-200 transition-colors",children:c.jsx(di,{className:"w-5 h-5"})})]}),c.jsx("p",{className:"text-slate-500 mb-6",children:"Select a device or service to connect"}),c.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto",children:Cv.map(P=>{const M=P.icon,D=e.some(U=>U.type===P.id);return c.jsxs("button",{onClick:()=>!D&&N(P.id),disabled:D,className:`w-full p-4 border rounded-xl transition-all flex items-center gap-4 text-left ${D?"bg-slate-50 border-slate-200 opacity-60 cursor-not-allowed":"bg-white border-slate-200 hover:border-cyan-500 hover:shadow-sm"}`,children:[c.jsx("div",{className:`w-10 h-10 rounded-xl ${P.color} flex items-center justify-center shrink-0`,children:c.jsx(M,{className:"w-5 h-5 text-white"})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("p",{className:"text-slate-800 font-medium",children:P.name}),D&&c.jsx(rr,{className:"w-4 h-4 text-emerald-500"})]}),c.jsx("p",{className:"text-slate-500 text-sm",children:P.description})]})]},P.id)})})]})})]})}function jYe(){var O,P,M,D,U,B,G,$,q,X,ee,ce,Q,ae,ve,le,fe,re,he;const{patientId:e}=rb(),[n]=zwe(),s=n.get("appointmentId"),[o,d]=z.useState(null),[h,f]=z.useState(!0),[v,b]=z.useState("overview");if(z.useEffect(()=>{(async()=>{try{const{data:ue}=await ra.getPatientProfile(e,s);d(ue)}catch(ue){console.error("Failed to fetch patient profile:",ue)}finally{f(!1)}})()},[e,s]),h)return c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-slate-400",children:"Loading patient profile..."})]})});if(!o)return c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6 text-center py-16",children:[c.jsx("p",{className:"text-slate-400",children:"Patient not found or access denied."}),c.jsx(Ct,{to:"/doctors",className:"mt-4 inline-block px-6 py-2 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-semibold rounded-xl",children:"Go Back"})]});const{patient:_,healthSummary:w,healthReports:E,wearableSummary:N,appointmentHistory:I}=o,R=[{id:"overview",label:"Overview",icon:tl},{id:"reports",label:"Health Reports",icon:Vn},{id:"wearables",label:"Wearable Data",icon:Ol},{id:"history",label:"Appointment History",icon:qr}];return c.jsxs("div",{className:"space-y-6 animate-fade-in",children:[c.jsxs(Ct,{to:"/doctor/dashboard",className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 transition-colors",children:[c.jsx(Ci,{className:"w-4 h-4"}),"Back to Dashboard"]}),c.jsx("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-6",children:[c.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center text-white text-3xl font-bold",children:(P=(O=_.name)==null?void 0:O.charAt(0))==null?void 0:P.toUpperCase()}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:_.name}),c.jsxs("div",{className:"flex flex-wrap gap-4 mt-2 text-sm text-slate-400",children:[_.email&&c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(lb,{className:"w-4 h-4"})," ",_.email]}),_.phone&&c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(Kj,{className:"w-4 h-4"})," ",_.phone]}),((M=_.profile)==null?void 0:M.age)&&c.jsxs("span",{children:[_.profile.age," years old"]}),((D=_.profile)==null?void 0:D.gender)&&c.jsx("span",{className:"capitalize",children:_.profile.gender})]})]}),(w==null?void 0:w.healthScore)&&c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:`text-4xl font-bold ${w.healthScore>=80?"text-emerald-400":w.healthScore>=60?"text-amber-400":"text-red-400"}`,children:w.healthScore}),c.jsx("p",{className:"text-sm text-slate-400",children:"Health Score"})]})]})}),c.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:R.map(J=>c.jsxs("button",{onClick:()=>b(J.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-all whitespace-nowrap ${v===J.id?"bg-cyan-500 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"}`,children:[c.jsx(J.icon,{className:"w-4 h-4"}),J.label]},J.id))}),v==="overview"&&c.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[c.jsx(tl,{className:"w-5 h-5 text-cyan-400"})," Basic Information"]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[((U=_.profile)==null?void 0:U.height)&&c.jsxs("div",{className:"p-3 bg-slate-800 rounded-xl",children:[c.jsx("p",{className:"text-sm text-slate-400",children:"Height"}),c.jsxs("p",{className:"font-semibold text-white",children:[_.profile.height," cm"]})]}),((B=_.profile)==null?void 0:B.weight)&&c.jsxs("div",{className:"p-3 bg-slate-800 rounded-xl",children:[c.jsx("p",{className:"text-sm text-slate-400",children:"Weight"}),c.jsxs("p",{className:"font-semibold text-white",children:[_.profile.weight," kg"]})]}),((G=_.profile)==null?void 0:G.bloodGroup)&&c.jsxs("div",{className:"p-3 bg-slate-800 rounded-xl",children:[c.jsx("p",{className:"text-sm text-slate-400",children:"Blood Group"}),c.jsx("p",{className:"font-semibold text-white",children:_.profile.bloodGroup})]}),(($=_.healthMetrics)==null?void 0:$.bmi)&&c.jsxs("div",{className:"p-3 bg-slate-800 rounded-xl",children:[c.jsx("p",{className:"text-sm text-slate-400",children:"BMI"}),c.jsx("p",{className:"font-semibold text-white",children:_.healthMetrics.bmi.toFixed(1)})]})]}),((X=(q=_.profile)==null?void 0:q.allergies)==null?void 0:X.length)>0&&c.jsxs("div",{className:"mt-4",children:[c.jsx("p",{className:"text-sm text-slate-400 mb-2",children:"Allergies"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:_.profile.allergies.map((J,ue)=>c.jsx("span",{className:"px-3 py-1 bg-red-500/20 text-red-400 rounded-full text-sm",children:J},ue))})]}),((ce=(ee=_.profile)==null?void 0:ee.chronicConditions)==null?void 0:ce.length)>0&&c.jsxs("div",{className:"mt-4",children:[c.jsx("p",{className:"text-sm text-slate-400 mb-2",children:"Chronic Conditions"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:_.profile.chronicConditions.map((J,ue)=>c.jsx("span",{className:"px-3 py-1 bg-amber-500/20 text-amber-400 rounded-full text-sm",children:J},ue))})]})]}),w&&c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[c.jsx(zn,{className:"w-5 h-5 text-red-400"})," Health Summary"]}),((Q=w.deficiencies)==null?void 0:Q.length)>0&&c.jsxs("div",{className:"mb-4",children:[c.jsxs("p",{className:"text-sm text-slate-400 mb-2",children:["Deficiencies (",w.deficiencies.length,")"]}),c.jsx("div",{className:"space-y-2",children:w.deficiencies.slice(0,3).map((J,ue)=>{var ke,Ge,De;const Ee=typeof J.currentValue=="object"?((ke=J.currentValue)==null?void 0:ke.value)||JSON.stringify(J.currentValue):J.currentValue,Fe=typeof J.normalRange=="object"?((Ge=J.normalRange)==null?void 0:Ge.value)||JSON.stringify(J.normalRange):J.normalRange;return c.jsxs("div",{className:`p-3 rounded-xl ${J.severity==="severe"?"bg-red-500/10 border border-red-500/30":J.severity==="moderate"?"bg-amber-500/10 border border-amber-500/30":"bg-yellow-500/10 border border-yellow-500/30"}`,children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"font-medium text-white",children:typeof J.name=="object"?((De=J.name)==null?void 0:De.value)||"Unknown":J.name}),c.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${J.severity==="severe"?"bg-red-500/20 text-red-400":J.severity==="moderate"?"bg-amber-500/20 text-amber-400":"bg-yellow-500/20 text-yellow-400"}`,children:J.severity})]}),c.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["Current: ",Ee," | Normal: ",Fe]})]},ue)})})]}),((ae=w.riskFactors)==null?void 0:ae.length)>0&&c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-sm text-slate-400 mb-2",children:"Risk Factors"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:w.riskFactors.map((J,ue)=>c.jsx("span",{className:"px-3 py-1 bg-orange-500/20 text-orange-400 rounded-full text-sm",children:typeof J=="object"?(J==null?void 0:J.name)||(J==null?void 0:J.value)||JSON.stringify(J):J},ue))})]}),((ve=w.keyFindings)==null?void 0:ve.length)>0&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-slate-400 mb-2",children:"Key Findings"}),c.jsx("ul",{className:"space-y-1",children:w.keyFindings.slice(0,4).map((J,ue)=>{const Ee=typeof J=="object"?(J==null?void 0:J.title)||(J==null?void 0:J.finding)||(J==null?void 0:J.value)||JSON.stringify(J):J;return c.jsxs("li",{className:"text-sm text-slate-300 flex items-start gap-2",children:[c.jsx("span",{className:"text-cyan-400 mt-1",children:""}),Ee]},ue)})})]})]}),N&&c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6 lg:col-span-2",children:[c.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[c.jsx(Ol,{className:"w-5 h-5 text-blue-400"})," Wearable Data Summary"]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"p-4 bg-blue-500/10 rounded-xl text-center border border-blue-500/20",children:[c.jsx(jn,{className:"w-6 h-6 text-blue-400 mx-auto mb-2"}),c.jsx("p",{className:"text-2xl font-bold text-white",children:((le=N.avgSteps)==null?void 0:le.toLocaleString())||"N/A"}),c.jsx("p",{className:"text-sm text-slate-400",children:"Avg Steps/Day"})]}),c.jsxs("div",{className:"p-4 bg-red-500/10 rounded-xl text-center border border-red-500/20",children:[c.jsx(zn,{className:"w-6 h-6 text-red-400 mx-auto mb-2"}),c.jsx("p",{className:"text-2xl font-bold text-white",children:N.avgHeartRate||"N/A"}),c.jsx("p",{className:"text-sm text-slate-400",children:"Avg Heart Rate"})]}),c.jsxs("div",{className:"p-4 bg-indigo-500/10 rounded-xl text-center border border-indigo-500/20",children:[c.jsx(To,{className:"w-6 h-6 text-indigo-400 mx-auto mb-2"}),c.jsx("p",{className:"text-2xl font-bold text-white",children:N.avgSleepHours||"N/A"}),c.jsx("p",{className:"text-sm text-slate-400",children:"Avg Sleep (hrs)"})]}),c.jsxs("div",{className:"p-4 bg-emerald-500/10 rounded-xl text-center border border-emerald-500/20",children:[c.jsx(Ol,{className:"w-6 h-6 text-emerald-400 mx-auto mb-2"}),c.jsx("p",{className:"text-2xl font-bold text-white",children:((fe=N.devices)==null?void 0:fe.length)||0}),c.jsx("p",{className:"text-sm text-slate-400",children:"Connected Devices"})]})]})]})]}),v==="reports"&&c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsx("h2",{className:"text-lg font-bold text-white mb-4",children:"Health Reports"}),(E==null?void 0:E.length)>0?c.jsx("div",{className:"space-y-3",children:E.map(J=>c.jsxs("div",{className:"p-4 bg-slate-800 rounded-xl flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-slate-700 flex items-center justify-center",children:c.jsx(Vn,{className:"w-6 h-6 text-slate-400"})}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold text-white",children:J.reportType}),c.jsx("p",{className:"text-sm text-slate-400",children:new Date(J.createdAt).toLocaleDateString()})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[J.healthScore&&c.jsxs("span",{className:`font-bold ${J.healthScore>=80?"text-emerald-400":J.healthScore>=60?"text-amber-400":"text-red-400"}`,children:["Score: ",J.healthScore]}),c.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${J.status==="completed"?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"}`,children:J.status})]})]},J._id))}):c.jsx("p",{className:"text-slate-400 text-center py-8",children:"No health reports available"})]}),v==="wearables"&&c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsx("h2",{className:"text-lg font-bold text-white mb-4",children:"Wearable Device Data"}),N?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Connected Devices"}),c.jsx("div",{className:"flex flex-wrap gap-3",children:(re=N.devices)==null?void 0:re.map((J,ue)=>c.jsxs("div",{className:"px-4 py-2 bg-cyan-500/10 border border-cyan-500/20 rounded-xl flex items-center gap-2",children:[c.jsx(Ol,{className:"w-4 h-4 text-cyan-400"}),c.jsx("span",{className:"font-medium text-cyan-300",children:J.name||J.type})]},ue))})]}),((he=N.recentMetrics)==null?void 0:he.length)>0&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Recent Activity (Last 7 Days)"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b border-slate-700",children:[c.jsx("th",{className:"text-left py-2 text-slate-400 font-medium",children:"Date"}),c.jsx("th",{className:"text-right py-2 text-slate-400 font-medium",children:"Steps"}),c.jsx("th",{className:"text-right py-2 text-slate-400 font-medium",children:"Calories"}),c.jsx("th",{className:"text-right py-2 text-slate-400 font-medium",children:"Active Min"}),c.jsx("th",{className:"text-right py-2 text-slate-400 font-medium",children:"Distance"})]})}),c.jsx("tbody",{children:N.recentMetrics.map((J,ue)=>{var Ee,Fe;return c.jsxs("tr",{className:"border-b border-slate-700/50",children:[c.jsx("td",{className:"py-2 text-white",children:new Date(J.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}),c.jsx("td",{className:"py-2 text-right text-slate-300",children:(Ee=J.steps)==null?void 0:Ee.toLocaleString()}),c.jsx("td",{className:"py-2 text-right text-slate-300",children:J.caloriesBurned}),c.jsx("td",{className:"py-2 text-right text-slate-300",children:J.activeMinutes}),c.jsxs("td",{className:"py-2 text-right text-slate-300",children:[(Fe=J.distance)==null?void 0:Fe.toFixed(1)," km"]})]},ue)})})]})})]})]}):c.jsx("p",{className:"text-slate-400 text-center py-8",children:"No wearable data available"})]}),v==="history"&&c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsx("h2",{className:"text-lg font-bold text-white mb-4",children:"Appointment History"}),(I==null?void 0:I.length)>0?c.jsx("div",{className:"space-y-3",children:I.map(J=>c.jsxs("div",{className:"p-4 bg-slate-800 rounded-xl",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(qr,{className:"w-5 h-5 text-slate-400"}),c.jsx("span",{className:"font-semibold text-white",children:new Date(J.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),c.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${J.status==="completed"?"bg-emerald-500/20 text-emerald-400":J.status==="scheduled"?"bg-amber-500/20 text-amber-400":"bg-red-500/20 text-red-400"}`,children:J.status})]}),J.doctor&&c.jsxs("p",{className:"text-sm text-slate-400",children:["Dr. ",J.doctor.name," - ",J.doctor.specialization]}),J.symptoms&&c.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:[c.jsx("span",{className:"font-medium text-slate-400",children:"Symptoms:"})," ",J.symptoms]}),J.notes&&c.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[c.jsx("span",{className:"font-medium text-slate-400",children:"Notes:"})," ",J.notes]})]},J._id))}):c.jsx("p",{className:"text-slate-400 text-center py-8",children:"No appointment history"})]})]})}var Xne={exports:{}};(function(e,n){(function(s,o){e.exports=o()})(Hd,function(){function s(t,r){return r.forEach(function(i){i&&typeof i!="string"&&!Array.isArray(i)&&Object.keys(i).forEach(function(a){if(a!=="default"&&!(a in t)){var l=Object.getOwnPropertyDescriptor(i,a);Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:function(){return i[a]}})}})}),Object.freeze(t)}var o=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Hd<"u"?Hd:typeof self<"u"?self:{};function d(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var h=function(t){try{return!!t()}catch{return!0}},f=!h(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),v=f,b=Function.prototype,_=b.call,w=v&&b.bind.bind(_,_),E=v?w:function(t){return function(){return _.apply(t,arguments)}},N=E({}.isPrototypeOf),I=function(t){return t&&t.Math===Math&&t},R=I(typeof globalThis=="object"&&globalThis)||I(typeof window=="object"&&window)||I(typeof self=="object"&&self)||I(typeof o=="object"&&o)||I(typeof o=="object"&&o)||function(){return this}()||Function("return this")(),O=f,P=Function.prototype,M=P.apply,D=P.call,U=typeof Reflect=="object"&&Reflect.apply||(O?D.bind(M):function(){return D.apply(M,arguments)}),B=E,G=B({}.toString),$=B("".slice),q=function(t){return $(G(t),8,-1)},X=q,ee=E,ce=function(t){if(X(t)==="Function")return ee(t)},Q=typeof document=="object"&&document.all,ae=Q===void 0&&Q!==void 0?function(t){return typeof t=="function"||t===Q}:function(t){return typeof t=="function"},ve={},le=!h(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),fe=f,re=Function.prototype.call,he=fe?re.bind(re):function(){return re.apply(re,arguments)},J={},ue={}.propertyIsEnumerable,Ee=Object.getOwnPropertyDescriptor,Fe=Ee&&!ue.call({1:2},1);J.f=Fe?function(t){var r=Ee(this,t);return!!r&&r.enumerable}:ue;var ke,Ge,De=function(t,r){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:r}},Pe=h,Ve=q,it=Object,Mt=E("".split),tt=Pe(function(){return!it("z").propertyIsEnumerable(0)})?function(t){return Ve(t)==="String"?Mt(t,""):it(t)}:it,ft=function(t){return t==null},Rt=ft,Te=TypeError,st=function(t){if(Rt(t))throw new Te("Can't call method on "+t);return t},ct=tt,zt=st,Ke=function(t){return ct(zt(t))},xe=ae,Je=function(t){return typeof t=="object"?t!==null:xe(t)},yt={},Yn=yt,Jr=R,os=ae,Ao=function(t){return os(t)?t:void 0},Ne=function(t,r){return arguments.length<2?Ao(Yn[t])||Ao(Jr[t]):Yn[t]&&Yn[t][r]||Jr[t]&&Jr[t][r]},Ze=R.navigator,Gn=Ze&&Ze.userAgent,on=Gn?String(Gn):"",Br=R,Wi=on,Fs=Br.process,al=Br.Deno,mp=Fs&&Fs.versions||al&&al.version,fp=mp&&mp.v8;fp&&(Ge=(ke=fp.split("."))[0]>0&&ke[0]<4?1:+(ke[0]+ke[1])),!Ge&&Wi&&(!(ke=Wi.match(/Edge\/(\d+)/))||ke[1]>=74)&&(ke=Wi.match(/Chrome\/(\d+)/))&&(Ge=+ke[1]);var Va=Ge,gp=Va,Og=h,Pg=R.String,vc=!!Object.getOwnPropertySymbols&&!Og(function(){var t=Symbol("symbol detection");return!Pg(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&gp&&gp<41}),bb=vc&&!Symbol.sham&&typeof Symbol.iterator=="symbol",ere=Ne,tre=ae,nre=N,rre=Object,kg=bb?function(t){return typeof t=="symbol"}:function(t){var r=ere("Symbol");return tre(r)&&nre(r.prototype,rre(t))},ire=String,vp=function(t){try{return ire(t)}catch{return"Object"}},sre=ae,are=vp,ore=TypeError,Vs=function(t){if(sre(t))return t;throw new ore(are(t)+" is not a function")},cre=Vs,lre=ft,jg=function(t,r){var i=t[r];return lre(i)?void 0:cre(i)},sL=he,aL=ae,oL=Je,dre=TypeError,cL={exports:{}},lL=R,ure=Object.defineProperty,hre=R,pre=function(t,r){try{ure(lL,t,{value:r,configurable:!0,writable:!0})}catch{lL[t]=r}return r},dL="__core-js_shared__",uL=cL.exports=hre[dL]||pre(dL,{});(uL.versions||(uL.versions=[])).push({version:"3.46.0",mode:"pure",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"});var mN=cL.exports,hL=mN,yp=function(t,r){return hL[t]||(hL[t]=r||{})},mre=st,fre=Object,yc=function(t){return fre(mre(t))},gre=yc,vre=E({}.hasOwnProperty),ui=Object.hasOwn||function(t,r){return vre(gre(t),r)},yre=E,bre=0,xre=Math.random(),_re=yre(1.1.toString),fN=function(t){return"Symbol("+(t===void 0?"":t)+")_"+_re(++bre+xre,36)},Ere=yp,pL=ui,wre=fN,Sre=vc,Tre=bb,bp=R.Symbol,gN=Ere("wks"),Nre=Tre?bp.for||bp:bp&&bp.withoutSetter||wre,ar=function(t){return pL(gN,t)||(gN[t]=Sre&&pL(bp,t)?bp[t]:Nre("Symbol."+t)),gN[t]},Cre=he,mL=Je,fL=kg,Rre=jg,Are=function(t,r){var i,a;if(aL(i=t.toString)&&!oL(a=sL(i,t))||aL(i=t.valueOf)&&!oL(a=sL(i,t)))return a;throw new dre("Can't convert object to primitive value")},Ire=TypeError,Ore=ar("toPrimitive"),Pre=function(t,r){if(!mL(t)||fL(t))return t;var i,a=Rre(t,Ore);if(a){if(i=Cre(a,t,r),!mL(i)||fL(i))return i;throw new Ire("Can't convert object to primitive value")}return Are(t)},kre=kg,vN=function(t){var r=Pre(t,"string");return kre(r)?r:r+""},gL=Je,yN=R.document,jre=gL(yN)&&gL(yN.createElement),bN=function(t){return jre?yN.createElement(t):{}},Dre=bN,vL=!le&&!h(function(){return Object.defineProperty(Dre("div"),"a",{get:function(){return 7}}).a!==7}),Lre=le,Mre=he,Ure=J,Fre=De,Vre=Ke,Bre=vN,Gre=ui,Wre=vL,yL=Object.getOwnPropertyDescriptor;ve.f=Lre?yL:function(t,r){if(t=Vre(t),r=Bre(r),Wre)try{return yL(t,r)}catch{}if(Gre(t,r))return Fre(!Mre(Ure.f,t,r),t[r])};var $re=h,zre=ae,Hre=/#|\.prototype\./,Dg=function(t,r){var i=Yre[Kre(t)];return i===Xre||i!==qre&&(zre(r)?$re(r):!!r)},Kre=Dg.normalize=function(t){return String(t).replace(Hre,".").toLowerCase()},Yre=Dg.data={},qre=Dg.NATIVE="N",Xre=Dg.POLYFILL="P",bL=Dg,Jre=Vs,Qre=f,Zre=ce(ce.bind),rd=function(t,r){return Jre(t),r===void 0?t:Qre?Zre(t,r):function(){return t.apply(r,arguments)}},Ba={},xL=le&&h(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),eie=Je,tie=String,nie=TypeError,Ss=function(t){if(eie(t))return t;throw new nie(tie(t)+" is not an object")},rie=le,iie=vL,sie=xL,xb=Ss,_L=vN,aie=TypeError,xN=Object.defineProperty,oie=Object.getOwnPropertyDescriptor,_N="enumerable",EN="configurable",wN="writable";Ba.f=rie?sie?function(t,r,i){if(xb(t),r=_L(r),xb(i),typeof t=="function"&&r==="prototype"&&"value"in i&&wN in i&&!i[wN]){var a=oie(t,r);a&&a[wN]&&(t[r]=i.value,i={configurable:EN in i?i[EN]:a[EN],enumerable:_N in i?i[_N]:a[_N],writable:!1})}return xN(t,r,i)}:xN:function(t,r,i){if(xb(t),r=_L(r),xb(i),iie)try{return xN(t,r,i)}catch{}if("get"in i||"set"in i)throw new aie("Accessors not supported");return"value"in i&&(t[r]=i.value),t};var cie=Ba,lie=De,Nu=le?function(t,r,i){return cie.f(t,r,lie(1,i))}:function(t,r,i){return t[r]=i,t},Lg=R,die=U,uie=ce,hie=ae,pie=ve.f,mie=bL,xp=yt,fie=rd,_p=Nu,EL=ui,gie=function(t){var r=function(i,a,l){if(this instanceof r){switch(arguments.length){case 0:return new t;case 1:return new t(i);case 2:return new t(i,a)}return new t(i,a,l)}return die(t,this,arguments)};return r.prototype=t.prototype,r},en=function(t,r){var i,a,l,u,p,m,g,y,x,S=t.target,T=t.global,C=t.stat,V=t.proto,j=T?Lg:C?Lg[S]:Lg[S]&&Lg[S].prototype,L=T?xp:xp[S]||_p(xp,S,{})[S],H=L.prototype;for(u in r)a=!(i=mie(T?u:S+(C?".":"#")+u,t.forced))&&j&&EL(j,u),m=L[u],a&&(g=t.dontCallGetSet?(x=pie(j,u))&&x.value:j[u]),p=a&&g?g:r[u],(i||V||typeof m!=typeof p)&&(y=t.bind&&a?fie(p,Lg):t.wrap&&a?gie(p):V&&hie(p)?uie(p):p,(t.sham||p&&p.sham||m&&m.sham)&&_p(y,"sham",!0),_p(L,u,y),V&&(EL(xp,l=S+"Prototype")||_p(xp,l,{}),_p(xp[l],u,p),t.real&&H&&(i||!H[u])&&_p(H,u,p)))},vie=Math.ceil,yie=Math.floor,bie=Math.trunc||function(t){var r=+t;return(r>0?yie:vie)(r)},xie=bie,SN=function(t){var r=+t;return r!=r||r===0?0:xie(r)},_ie=SN,Eie=Math.max,wie=Math.min,TN=function(t,r){var i=_ie(t);return i<0?Eie(i+r,0):wie(i,r)},Sie=SN,Tie=Math.min,wL=function(t){var r=Sie(t);return r>0?Tie(r,9007199254740991):0},Nie=wL,id=function(t){return Nie(t.length)},Cie=Ke,Rie=TN,Aie=id,SL=function(t){return function(r,i,a){var l=Cie(r),u=Aie(l);if(u===0)return!t&&-1;var p,m=Rie(a,u);if(t&&i!=i){for(;u>m;)if((p=l[m++])!=p)return!0}else for(;u>m;m++)if((t||m in l)&&l[m]===i)return t||m||0;return!t&&-1}},NN={includes:SL(!0),indexOf:SL(!1)},Iie=NN.includes;en({target:"Array",proto:!0,forced:h(function(){return!Array(1).includes()})},{includes:function(t){return Iie(this,t,arguments.length>1?arguments[1]:void 0)}});var Oie=R,Pie=yt,ha=function(t,r){var i=Pie[t+"Prototype"],a=i&&i[r];if(a)return a;var l=Oie[t],u=l&&l.prototype;return u&&u[r]},kie=ha("Array","includes"),jie=Je,Die=q,Lie=ar("match"),CN=function(t){var r;return jie(t)&&((r=t[Lie])!==void 0?!!r:Die(t)==="RegExp")},Mie=CN,Uie=TypeError,TL={};TL[ar("toStringTag")]="z";var RN=String(TL)==="[object z]",Fie=RN,Vie=ae,_b=q,Bie=ar("toStringTag"),Gie=Object,Wie=_b(function(){return arguments}())==="Arguments",sd=Fie?_b:function(t){var r,i,a;return t===void 0?"Undefined":t===null?"Null":typeof(i=function(l,u){try{return l[u]}catch{}}(r=Gie(t),Bie))=="string"?i:Wie?_b(r):(a=_b(r))==="Object"&&Vie(r.callee)?"Arguments":a},$ie=sd,zie=String,Ts=function(t){if($ie(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return zie(t)},Hie=ar("match"),Kie=en,Yie=function(t){if(Mie(t))throw new Uie("The method doesn't accept regular expressions");return t},qie=st,NL=Ts,Xie=function(t){var r=/./;try{"/./"[t](r)}catch{try{return r[Hie]=!1,"/./"[t](r)}catch{}}return!1},Jie=E("".indexOf);Kie({target:"String",proto:!0,forced:!Xie("includes")},{includes:function(t){return!!~Jie(NL(qie(this)),NL(Yie(t)),arguments.length>1?arguments[1]:void 0)}});var Qie=ha("String","includes"),CL=N,Zie=kie,ese=Qie,AN=Array.prototype,IN=String.prototype,tse=function(t){var r=t.includes;return t===AN||CL(AN,t)&&r===AN.includes?Zie:typeof t=="string"||t===IN||CL(IN,t)&&r===IN.includes?ese:r},Ce=d(tse),nse=Vs,rse=yc,ise=tt,sse=id,RL=TypeError,AL="Reduce of empty array with no initial value",ase=function(t){return function(r,i,a,l){var u=rse(r),p=ise(u),m=sse(u);if(nse(i),m===0&&a<2)throw new RL(AL);var g=t?m-1:0,y=t?-1:1;if(a<2)for(;;){if(g in p){l=p[g],g+=y;break}if(g+=y,t?g<0:m<=g)throw new RL(AL)}for(;t?g>=0:m>g;g+=y)g in p&&(l=i(l,p[g],g,u));return l}},ose={left:ase(!1)},cse=h,Eb=function(t,r){var i=[][t];return!!i&&cse(function(){i.call(null,r||function(){return 1},1)})},Mg=R,lse=on,dse=q,wb=function(t){return lse.slice(0,t.length)===t},ON=wb("Bun/")?"BUN":wb("Cloudflare-Workers")?"CLOUDFLARE":wb("Deno/")?"DENO":wb("Node.js/")?"NODE":Mg.Bun&&typeof Bun.version=="string"?"BUN":Mg.Deno&&typeof Deno.version=="object"?"DENO":dse(Mg.process)==="process"?"NODE":Mg.window&&Mg.document?"BROWSER":"REST",Sb=ON==="NODE",use=ose.left;en({target:"Array",proto:!0,forced:!Sb&&Va>79&&Va<83||!Eb("reduce")},{reduce:function(t){var r=arguments.length;return use(this,t,r,r>1?arguments[1]:void 0)}});var hse=ha("Array","reduce"),pse=N,mse=hse,PN=Array.prototype,fse=function(t){var r=t.reduce;return t===PN||pse(PN,t)&&r===PN.reduce?mse:r},IL=fse,pa=d(IL),gse=q,Ug=Array.isArray||function(t){return gse(t)==="Array"},vse=en,yse=Ug,bse=E([].reverse),OL=[1,2];vse({target:"Array",proto:!0,forced:String(OL)===String(OL.reverse())},{reverse:function(){return yse(this)&&(this.length=this.length),bse(this)}});var xse=ha("Array","reverse"),_se=N,Ese=xse,kN=Array.prototype,wse=function(t){var r=t.reverse;return t===kN||_se(kN,t)&&r===kN.reverse?Ese:r},PL=wse,kL=d(PL),Sse=fN,jL=yp("keys"),Tb=function(t){return jL[t]||(jL[t]=Sse(t))},Tse=!h(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Nse=ui,Cse=ae,Rse=yc,Ase=Tse,DL=Tb("IE_PROTO"),jN=Object,Ise=jN.prototype,DN=Ase?jN.getPrototypeOf:function(t){var r=Rse(t);if(Nse(r,DL))return r[DL];var i=r.constructor;return Cse(i)&&r instanceof i?i.prototype:r instanceof jN?Ise:null},Ose=E,Pse=Vs,kse=Je,jse=function(t){return kse(t)||t===null},Dse=String,Lse=TypeError,Mse=function(t,r,i){try{return Ose(Pse(Object.getOwnPropertyDescriptor(t,r)[i]))}catch{}},Use=Je,Fse=st,Vse=function(t){if(jse(t))return t;throw new Lse("Can't set "+Dse(t)+" as a prototype")},Bse=Object.setPrototypeOf||("__proto__"in{}?function(){var t,r=!1,i={};try{(t=Mse(Object.prototype,"__proto__","set"))(i,[]),r=i instanceof Array}catch{}return function(a,l){return Fse(a),Vse(l),Use(a)&&(r?t(a,l):a.__proto__=l),a}}():void 0),Nb={},Cb={},LN=ui,Gse=Ke,Wse=NN.indexOf,$se=Cb,LL=E([].push),ML=function(t,r){var i,a=Gse(t),l=0,u=[];for(i in a)!LN($se,i)&&LN(a,i)&&LL(u,i);for(;r.length>l;)LN(a,i=r[l++])&&(~Wse(u,i)||LL(u,i));return u},MN=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],zse=ML,Hse=MN.concat("length","prototype");Nb.f=Object.getOwnPropertyNames||function(t){return zse(t,Hse)};var Fg={};Fg.f=Object.getOwnPropertySymbols;var Kse=Ne,Yse=Nb,qse=Fg,Xse=Ss,Jse=E([].concat),Qse=Kse("Reflect","ownKeys")||function(t){var r=Yse.f(Xse(t)),i=qse.f;return i?Jse(r,i(t)):r},UL=ui,Zse=Qse,eae=ve,tae=Ba,UN={},nae=ML,rae=MN,Rb=Object.keys||function(t){return nae(t,rae)},iae=le,sae=xL,aae=Ba,oae=Ss,cae=Ke,lae=Rb;UN.f=iae&&!sae?Object.defineProperties:function(t,r){oae(t);for(var i,a=cae(r),l=lae(r),u=l.length,p=0;u>p;)aae.f(t,i=l[p++],a[i]);return t};var Ab,FL=Ne("document","documentElement"),dae=Ss,uae=UN,VL=MN,hae=Cb,pae=FL,mae=bN,FN="prototype",VN="script",BL=Tb("IE_PROTO"),BN=function(){},GL=function(t){return"<"+VN+">"+t+"</"+VN+">"},WL=function(t){t.write(GL("")),t.close();var r=t.parentWindow.Object;return t=null,r},Ib=function(){try{Ab=new ActiveXObject("htmlfile")}catch{}var t,r,i;Ib=typeof document<"u"?document.domain&&Ab?WL(Ab):(r=mae("iframe"),i="java"+VN+":",r.style.display="none",pae.appendChild(r),r.src=String(i),(t=r.contentWindow.document).open(),t.write(GL("document.F=Object")),t.close(),t.F):WL(Ab);for(var a=VL.length;a--;)delete Ib[FN][VL[a]];return Ib()};hae[BL]=!0;var Vg=Object.create||function(t,r){var i;return t!==null?(BN[FN]=dae(t),i=new BN,BN[FN]=null,i[BL]=t):i=Ib(),r===void 0?i:uae.f(i,r)},fae=Je,gae=Nu,$L=Error,vae=E("".replace),yae=String(new $L("zxcasd").stack),zL=/\n\s*at [^:]*:[^\n]*/,bae=zL.test(yae),xae=De,_ae=!h(function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",xae(1,7)),t.stack!==7)}),Eae=Nu,wae=function(t,r){if(bae&&typeof t=="string"&&!$L.prepareStackTrace)for(;r--;)t=vae(t,zL,"");return t},Sae=_ae,HL=Error.captureStackTrace,Ep={},Tae=Ep,Nae=ar("iterator"),Cae=Array.prototype,KL=function(t){return t!==void 0&&(Tae.Array===t||Cae[Nae]===t)},Rae=sd,YL=jg,Aae=ft,Iae=Ep,Oae=ar("iterator"),Ob=function(t){if(!Aae(t))return YL(t,Oae)||YL(t,"@@iterator")||Iae[Rae(t)]},Pae=he,kae=Vs,jae=Ss,Dae=vp,Lae=Ob,Mae=TypeError,GN=function(t,r){var i=arguments.length<2?Lae(t):r;if(kae(i))return jae(Pae(i,t));throw new Mae(Dae(t)+" is not iterable")},Uae=he,qL=Ss,Fae=jg,XL=function(t,r,i){var a,l;qL(t);try{if(!(a=Fae(t,"return"))){if(r==="throw")throw i;return i}a=Uae(a,t)}catch(u){l=!0,a=u}if(r==="throw")throw i;if(l)throw a;return qL(a),i},Vae=rd,Bae=he,Gae=Ss,Wae=vp,$ae=KL,zae=id,JL=N,Hae=GN,Kae=Ob,QL=XL,Yae=TypeError,Pb=function(t,r){this.stopped=t,this.result=r},ZL=Pb.prototype,Bg=function(t,r,i){var a,l,u,p,m,g,y,x=i&&i.that,S=!(!i||!i.AS_ENTRIES),T=!(!i||!i.IS_RECORD),C=!(!i||!i.IS_ITERATOR),V=!(!i||!i.INTERRUPTED),j=Vae(r,x),L=function(Y){return a&&QL(a,"normal"),new Pb(!0,Y)},H=function(Y){return S?(Gae(Y),V?j(Y[0],Y[1],L):j(Y[0],Y[1])):V?j(Y,L):j(Y)};if(T)a=t.iterator;else if(C)a=t;else{if(!(l=Kae(t)))throw new Yae(Wae(t)+" is not iterable");if($ae(l)){for(u=0,p=zae(t);p>u;u++)if((m=H(t[u]))&&JL(ZL,m))return m;return new Pb(!1)}a=Hae(t,l)}for(g=T?t.next:a.next;!(y=Bae(g,a)).done;){try{m=H(y.value)}catch(Y){QL(a,"throw",Y)}if(typeof m=="object"&&m&&JL(ZL,m))return m}return new Pb(!1)},qae=Ts,Xae=en,Jae=N,Qae=DN,kb=Bse,Zae=function(t,r,i){for(var a=Zse(r),l=tae.f,u=eae.f,p=0;p<a.length;p++){var m=a[p];UL(t,m)||i&&UL(i,m)||l(t,m,u(r,m))}},eM=Vg,WN=Nu,$N=De,eoe=function(t,r){fae(r)&&"cause"in r&&gae(t,"cause",r.cause)},toe=function(t,r,i,a){Sae&&(HL?HL(t,r):Eae(t,"stack",wae(i,a)))},noe=Bg,roe=function(t,r){return t===void 0?arguments.length<2?"":r:qae(t)},ioe=ar("toStringTag"),jb=Error,soe=[].push,wp=function(t,r){var i,a=Jae(zN,this);kb?i=kb(new jb,a?Qae(this):zN):(i=a?this:eM(zN),WN(i,ioe,"Error")),r!==void 0&&WN(i,"message",roe(r)),toe(i,wp,i.stack,1),arguments.length>2&&eoe(i,arguments[2]);var l=[];return noe(t,soe,{that:l}),WN(i,"errors",l),i};kb?kb(wp,jb):Zae(wp,jb,{name:!0});var zN=wp.prototype=eM(jb.prototype,{constructor:$N(1,wp),message:$N(1,""),name:$N(1,"AggregateError")});Xae({global:!0},{AggregateError:wp});var Db,Gg,Lb,aoe=ae,tM=R.WeakMap,ooe=aoe(tM)&&/native code/.test(String(tM)),nM=R,coe=Je,loe=Nu,HN=ui,KN=mN,doe=Tb,uoe=Cb,rM="Object already initialized",YN=nM.TypeError,hoe=nM.WeakMap;if(ooe||KN.state){var bc=KN.state||(KN.state=new hoe);bc.get=bc.get,bc.has=bc.has,bc.set=bc.set,Db=function(t,r){if(bc.has(t))throw new YN(rM);return r.facade=t,bc.set(t,r),r},Gg=function(t){return bc.get(t)||{}},Lb=function(t){return bc.has(t)}}else{var Sp=doe("state");uoe[Sp]=!0,Db=function(t,r){if(HN(t,Sp))throw new YN(rM);return r.facade=t,loe(t,Sp,r),r},Gg=function(t){return HN(t,Sp)?t[Sp]:{}},Lb=function(t){return HN(t,Sp)}}var Cu,iM,sM,Ru={set:Db,get:Gg,has:Lb,enforce:function(t){return Lb(t)?Gg(t):Db(t,{})},getterFor:function(t){return function(r){var i;if(!coe(r)||(i=Gg(r)).type!==t)throw new YN("Incompatible receiver, "+t+" required");return i}}},qN=le,poe=ui,aM=Function.prototype,moe=qN&&Object.getOwnPropertyDescriptor,oM=poe(aM,"name"),cM={PROPER:oM&&(function(){}).name==="something",CONFIGURABLE:oM&&(!qN||qN&&moe(aM,"name").configurable)},foe=Nu,ad=function(t,r,i,a){return a&&a.enumerable?t[r]=i:foe(t,r,i),t},goe=h,voe=ae,yoe=Je,boe=Vg,lM=DN,xoe=ad,XN=ar("iterator"),dM=!1;[].keys&&("next"in(sM=[].keys())?(iM=lM(lM(sM)))!==Object.prototype&&(Cu=iM):dM=!0);var _oe=!yoe(Cu)||goe(function(){var t={};return Cu[XN].call(t)!==t});voe((Cu=_oe?{}:boe(Cu))[XN])||xoe(Cu,XN,function(){return this});var uM={IteratorPrototype:Cu,BUGGY_SAFARI_ITERATORS:dM},Eoe=sd,woe=RN?{}.toString:function(){return"[object "+Eoe(this)+"]"},Soe=RN,Toe=Ba.f,Noe=Nu,Coe=ui,Roe=woe,hM=ar("toStringTag"),ol=function(t,r,i,a){var l=i?t:t&&t.prototype;l&&(Coe(l,hM)||Toe(l,hM,{configurable:!0,value:r}),a&&!Soe&&Noe(l,"toString",Roe))},Aoe=uM.IteratorPrototype,Ioe=Vg,Ooe=De,Poe=ol,koe=Ep,joe=function(){return this},JN=function(t,r,i,a){var l=r+" Iterator";return t.prototype=Ioe(Aoe,{next:Ooe(+!a,i)}),Poe(t,l,!1,!0),koe[l]=joe,t},Doe=en,Loe=he,Moe=cM,Uoe=JN,Foe=DN,Voe=ol,pM=ad,mM=Ep,Boe=uM,Goe=Moe.PROPER,Mb=Boe.BUGGY_SAFARI_ITERATORS,QN=ar("iterator"),fM="keys",Ub="values",gM="entries",Woe=function(){return this},vM=function(t,r,i,a,l,u,p){Uoe(i,r,a);var m,g,y,x=function(H){if(H===l&&j)return j;if(!Mb&&H&&H in C)return C[H];switch(H){case fM:case Ub:case gM:return function(){return new i(this,H)}}return function(){return new i(this)}},S=r+" Iterator",T=!1,C=t.prototype,V=C[QN]||C["@@iterator"]||l&&C[l],j=!Mb&&V||x(l),L=r==="Array"&&C.entries||V;if(L&&(m=Foe(L.call(new t)))!==Object.prototype&&m.next&&(Voe(m,S,!0,!0),mM[S]=Woe),Goe&&l===Ub&&V&&V.name!==Ub&&(T=!0,j=function(){return Loe(V,this)}),l)if(g={values:x(Ub),keys:u?j:x(fM),entries:x(gM)},p)for(y in g)(Mb||T||!(y in C))&&pM(C,y,g[y]);else Doe({target:r,proto:!0,forced:Mb||T},g);return p&&C[QN]!==j&&pM(C,QN,j,{}),mM[r]=j,g},Fb=function(t,r){return{value:t,done:r}},$oe=Ke,yM=Ep,bM=Ru;Ba.f;var zoe=vM,Vb=Fb,xM="Array Iterator",Hoe=bM.set,Koe=bM.getterFor(xM);zoe(Array,"Array",function(t,r){Hoe(this,{type:xM,target:$oe(t),index:0,kind:r})},function(){var t=Koe(this),r=t.target,i=t.index++;if(!r||i>=r.length)return t.target=null,Vb(void 0,!0);switch(t.kind){case"keys":return Vb(i,!1);case"values":return Vb(r[i],!1)}return Vb([i,r[i]],!1)},"values"),yM.Arguments=yM.Array;var Yoe=Ba,Bb=function(t,r,i){return Yoe.f(t,r,i)},qoe=Ne,Xoe=Bb,Joe=le,_M=ar("species"),Qoe=N,Zoe=TypeError,ZN=function(t,r){if(Qoe(r,t))return t;throw new Zoe("Incorrect invocation")},ece=ae,eC=mN,tce=E(Function.toString);ece(eC.inspectSource)||(eC.inspectSource=function(t){return tce(t)});var EM=eC.inspectSource,nce=E,rce=h,wM=ae,ice=sd,sce=EM,SM=function(){},TM=Ne("Reflect","construct"),tC=/^\s*(?:class|function)\b/,ace=nce(tC.exec),oce=!tC.test(SM),Wg=function(t){if(!wM(t))return!1;try{return TM(SM,[],t),!0}catch{return!1}},NM=function(t){if(!wM(t))return!1;switch(ice(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return oce||!!ace(tC,sce(t))}catch{return!0}};NM.sham=!0;var $g,Tp,CM,nC,Gb=!TM||rce(function(){var t;return Wg(Wg.call)||!Wg(Object)||!Wg(function(){t=!0})||t})?NM:Wg,cce=Gb,lce=vp,dce=TypeError,RM=Ss,uce=function(t){if(cce(t))return t;throw new dce(lce(t)+" is not a constructor")},hce=ft,pce=ar("species"),rC=function(t,r){var i,a=RM(t).constructor;return a===void 0||hce(i=RM(a)[pce])?r:uce(i)},od=E([].slice),mce=TypeError,Au=function(t,r){if(t<r)throw new mce("Not enough arguments");return t},AM=/(?:ipad|iphone|ipod).*applewebkit/i.test(on),ma=R,fce=U,gce=rd,IM=ae,vce=ui,OM=h,PM=FL,yce=od,kM=bN,bce=Au,xce=AM,_ce=Sb,iC=ma.setImmediate,sC=ma.clearImmediate,Ece=ma.process,aC=ma.Dispatch,wce=ma.Function,jM=ma.MessageChannel,Sce=ma.String,oC=0,zg={},DM="onreadystatechange";OM(function(){$g=ma.location});var cC=function(t){if(vce(zg,t)){var r=zg[t];delete zg[t],r()}},lC=function(t){return function(){cC(t)}},LM=function(t){cC(t.data)},MM=function(t){ma.postMessage(Sce(t),$g.protocol+"//"+$g.host)};iC&&sC||(iC=function(t){bce(arguments.length,1);var r=IM(t)?t:wce(t),i=yce(arguments,1);return zg[++oC]=function(){fce(r,void 0,i)},Tp(oC),oC},sC=function(t){delete zg[t]},_ce?Tp=function(t){Ece.nextTick(lC(t))}:aC&&aC.now?Tp=function(t){aC.now(lC(t))}:jM&&!xce?(nC=(CM=new jM).port2,CM.port1.onmessage=LM,Tp=gce(nC.postMessage,nC)):ma.addEventListener&&IM(ma.postMessage)&&!ma.importScripts&&$g&&$g.protocol!=="file:"&&!OM(MM)?(Tp=MM,ma.addEventListener("message",LM,!1)):Tp=DM in kM("script")?function(t){PM.appendChild(kM("script"))[DM]=function(){PM.removeChild(this),cC(t)}}:function(t){setTimeout(lC(t),0)});var Wb={set:iC,clear:sC},UM=R,Tce=le,Nce=Object.getOwnPropertyDescriptor,FM=function(t){if(!Tce)return UM[t];var r=Nce(UM,t);return r&&r.value},VM=function(){this.head=null,this.tail=null};VM.prototype={add:function(t){var r={item:t,next:null},i=this.tail;i?i.next=r:this.head=r,this.tail=r},get:function(){var t=this.head;if(t)return(this.head=t.next)===null&&(this.tail=null),t.item}};var Np,dC,uC,hC,BM,GM=VM,Cce=/ipad|iphone|ipod/i.test(on)&&typeof Pebble<"u",Rce=/web0s(?!.*chrome)/i.test(on),Cp=R,Ace=FM,WM=rd,pC=Wb.set,Ice=GM,Oce=AM,Pce=Cce,kce=Rce,mC=Sb,$M=Cp.MutationObserver||Cp.WebKitMutationObserver,zM=Cp.document,HM=Cp.process,$b=Cp.Promise,fC=Ace("queueMicrotask");if(!fC){var zb=new Ice,Hb=function(){var t,r;for(mC&&(t=HM.domain)&&t.exit();r=zb.get();)try{r()}catch(i){throw zb.head&&Np(),i}t&&t.enter()};Oce||mC||kce||!$M||!zM?!Pce&&$b&&$b.resolve?((hC=$b.resolve(void 0)).constructor=$b,BM=WM(hC.then,hC),Np=function(){BM(Hb)}):mC?Np=function(){HM.nextTick(Hb)}:(pC=WM(pC,Cp),Np=function(){pC(Hb)}):(dC=!0,uC=zM.createTextNode(""),new $M(Hb).observe(uC,{characterData:!0}),Np=function(){uC.data=dC=!dC}),fC=function(t){zb.head||Np(),zb.add(t)}}var KM=fC,Rp=function(t){try{return{error:!1,value:t()}}catch(r){return{error:!0,value:r}}},Iu=R.Promise,jce=R,Hg=Iu,Dce=ae,Lce=bL,Mce=EM,Uce=ar,YM=ON,gC=Va,qM=Hg&&Hg.prototype,Fce=Uce("species"),XM=Dce(jce.PromiseRejectionEvent),Vce=Lce("Promise",function(){var t=Mce(Hg),r=t!==String(Hg);if(!r&&gC===66||!qM.catch||!qM.finally)return!0;if(!gC||gC<51||!/native code/.test(t)){var i=new Hg(function(l){l(1)}),a=function(l){l(function(){},function(){})};if((i.constructor={})[Fce]=a,!(i.then(function(){})instanceof a))return!0}return!(r||YM!=="BROWSER"&&YM!=="DENO"||XM)}),Kg={CONSTRUCTOR:Vce,REJECTION_EVENT:XM},xc={},JM=Vs,Bce=TypeError,Gce=function(t){var r,i;this.promise=new t(function(a,l){if(r!==void 0||i!==void 0)throw new Bce("Bad Promise constructor");r=a,i=l}),this.resolve=JM(r),this.reject=JM(i)};xc.f=function(t){return new Gce(t)};var vC,QM,ZM,Wce=en,Kb=Sb,cd=R,$ce=yt,Yg=he,zce=ad,Hce=ol,Kce=function(t){var r=qoe(t);Joe&&r&&!r[_M]&&Xoe(r,_M,{configurable:!0,get:function(){return this}})},Yce=Vs,yC=ae,qce=Je,Xce=ZN,Jce=rC,e5=Wb.set,bC=KM,Qce=function(t,r){try{arguments.length===1?console.error(t):console.error(t,r)}catch{}},Zce=Rp,ele=GM,t5=Ru,xC=Iu,n5=Kg,r5=xc,Yb="Promise",i5=n5.CONSTRUCTOR,tle=n5.REJECTION_EVENT,_C=t5.getterFor(Yb),nle=t5.set,rle=xC&&xC.prototype,qg=xC,EC=rle,s5=cd.TypeError,wC=cd.document,SC=cd.process,TC=r5.f,ile=TC,sle=!!(wC&&wC.createEvent&&cd.dispatchEvent),a5="unhandledrejection",o5=function(t){var r;return!(!qce(t)||!yC(r=t.then))&&r},c5=function(t,r){var i,a,l,u=r.value,p=r.state===1,m=p?t.ok:t.fail,g=t.resolve,y=t.reject,x=t.domain;try{m?(p||(r.rejection===2&&ole(r),r.rejection=1),m===!0?i=u:(x&&x.enter(),i=m(u),x&&(x.exit(),l=!0)),i===t.promise?y(new s5("Promise-chain cycle")):(a=o5(i))?Yg(a,i,g,y):g(i)):y(u)}catch(S){x&&!l&&x.exit(),y(S)}},l5=function(t,r){t.notified||(t.notified=!0,bC(function(){for(var i,a=t.reactions;i=a.get();)c5(i,t);t.notified=!1,r&&!t.rejection&&ale(t)}))},d5=function(t,r,i){var a,l;sle?((a=wC.createEvent("Event")).promise=r,a.reason=i,a.initEvent(t,!1,!0),cd.dispatchEvent(a)):a={promise:r,reason:i},!tle&&(l=cd["on"+t])?l(a):t===a5&&Qce("Unhandled promise rejection",i)},ale=function(t){Yg(e5,cd,function(){var r,i=t.facade,a=t.value;if(u5(t)&&(r=Zce(function(){Kb?SC.emit("unhandledRejection",a,i):d5(a5,i,a)}),t.rejection=Kb||u5(t)?2:1,r.error))throw r.value})},u5=function(t){return t.rejection!==1&&!t.parent},ole=function(t){Yg(e5,cd,function(){var r=t.facade;Kb?SC.emit("rejectionHandled",r):d5("rejectionhandled",r,t.value)})},Ap=function(t,r,i){return function(a){t(r,a,i)}},Ip=function(t,r,i){t.done||(t.done=!0,i&&(t=i),t.value=r,t.state=2,l5(t,!0))},NC=function(t,r,i){if(!t.done){t.done=!0,i&&(t=i);try{if(t.facade===r)throw new s5("Promise can't be resolved itself");var a=o5(r);a?bC(function(){var l={done:!1};try{Yg(a,r,Ap(NC,l,t),Ap(Ip,l,t))}catch(u){Ip(l,u,t)}}):(t.value=r,t.state=1,l5(t,!1))}catch(l){Ip({done:!1},l,t)}}};i5&&(EC=(qg=function(t){Xce(this,EC),Yce(t),Yg(vC,this);var r=_C(this);try{t(Ap(NC,r),Ap(Ip,r))}catch(i){Ip(r,i)}}).prototype,(vC=function(t){nle(this,{type:Yb,done:!1,notified:!1,parent:!1,reactions:new ele,rejection:!1,state:0,value:null})}).prototype=zce(EC,"then",function(t,r){var i=_C(this),a=TC(Jce(this,qg));return i.parent=!0,a.ok=!yC(t)||t,a.fail=yC(r)&&r,a.domain=Kb?SC.domain:void 0,i.state===0?i.reactions.add(a):bC(function(){c5(a,i)}),a.promise}),QM=function(){var t=new vC,r=_C(t);this.promise=t,this.resolve=Ap(NC,r),this.reject=Ap(Ip,r)},r5.f=TC=function(t){return t===qg||t===ZM?new QM(t):ile(t)}),Wce({global:!0,wrap:!0,forced:i5},{Promise:qg}),ZM=$ce.Promise,Hce(qg,Yb,!1,!0),Kce(Yb);var h5=ar("iterator"),p5=!1;try{var cle=0,m5={next:function(){return{done:!!cle++}},return:function(){p5=!0}};m5[h5]=function(){return this},Array.from(m5,function(){throw 2})}catch{}var lle=Iu,dle=function(t,r){try{if(!r&&!p5)return!1}catch{return!1}var i=!1;try{var a={};a[h5]=function(){return{next:function(){return{done:i=!0}}}},t(a)}catch{}return i},qb=Kg.CONSTRUCTOR||!dle(function(t){lle.all(t).then(void 0,function(){})}),ule=he,hle=Vs,ple=xc,mle=Rp,fle=Bg;en({target:"Promise",stat:!0,forced:qb},{all:function(t){var r=this,i=ple.f(r),a=i.resolve,l=i.reject,u=mle(function(){var p=hle(r.resolve),m=[],g=0,y=1;fle(t,function(x){var S=g++,T=!1;y++,ule(p,r,x).then(function(C){T||(T=!0,m[S]=C,--y||a(m))},l)}),--y||a(m)});return u.error&&l(u.value),i.promise}});var gle=en,vle=Kg.CONSTRUCTOR;Iu&&Iu.prototype,gle({target:"Promise",proto:!0,forced:vle,real:!0},{catch:function(t){return this.then(void 0,t)}});var yle=he,ble=Vs,xle=xc,_le=Rp,Ele=Bg;en({target:"Promise",stat:!0,forced:qb},{race:function(t){var r=this,i=xle.f(r),a=i.reject,l=_le(function(){var u=ble(r.resolve);Ele(t,function(p){yle(u,r,p).then(i.resolve,a)})});return l.error&&a(l.value),i.promise}});var wle=xc;en({target:"Promise",stat:!0,forced:Kg.CONSTRUCTOR},{reject:function(t){var r=wle.f(this);return(0,r.reject)(t),r.promise}});var Sle=Ss,Tle=Je,Nle=xc,f5=function(t,r){if(Sle(t),Tle(r)&&r.constructor===t)return r;var i=Nle.f(t);return(0,i.resolve)(r),i.promise},Cle=en,Rle=Iu,Ale=Kg.CONSTRUCTOR,Ile=f5,Ole=Ne("Promise"),Ple=!Ale;Cle({target:"Promise",stat:!0,forced:!0},{resolve:function(t){return Ile(Ple&&this===Ole?Rle:this,t)}});var kle=he,jle=Vs,Dle=xc,Lle=Rp,Mle=Bg;en({target:"Promise",stat:!0,forced:qb},{allSettled:function(t){var r=this,i=Dle.f(r),a=i.resolve,l=i.reject,u=Lle(function(){var p=jle(r.resolve),m=[],g=0,y=1;Mle(t,function(x){var S=g++,T=!1;y++,kle(p,r,x).then(function(C){T||(T=!0,m[S]={status:"fulfilled",value:C},--y||a(m))},function(C){T||(T=!0,m[S]={status:"rejected",reason:C},--y||a(m))})}),--y||a(m)});return u.error&&l(u.value),i.promise}});var Ule=he,Fle=Vs,Vle=Ne,Ble=xc,Gle=Rp,Wle=Bg,g5="No one promise resolved";en({target:"Promise",stat:!0,forced:qb},{any:function(t){var r=this,i=Vle("AggregateError"),a=Ble.f(r),l=a.resolve,u=a.reject,p=Gle(function(){var m=Fle(r.resolve),g=[],y=0,x=1,S=!1;Wle(t,function(T){var C=y++,V=!1;x++,Ule(m,r,T).then(function(j){V||S||(S=!0,l(j))},function(j){V||S||(V=!0,g[C]=j,--x||u(new i(g,g5)))})}),--x||u(new i(g,g5))});return p.error&&u(p.value),a.promise}});var $le=en,zle=U,Hle=od,Kle=xc,Yle=Vs,v5=Rp,CC=R.Promise,y5=!1;$le({target:"Promise",stat:!0,forced:!CC||!CC.try||v5(function(){CC.try(function(t){y5=t===8},8)}).error||!y5},{try:function(t){var r=arguments.length>1?Hle(arguments,1):[],i=Kle.f(this),a=v5(function(){return zle(Yle(t),void 0,r)});return(a.error?i.reject:i.resolve)(a.value),i.promise}});var qle=xc;en({target:"Promise",stat:!0},{withResolvers:function(){var t=qle.f(this);return{promise:t.promise,resolve:t.resolve,reject:t.reject}}});var Xle=en,RC=Iu,Jle=h,Qle=Ne,Zle=ae,ede=rC,b5=f5,tde=RC&&RC.prototype;Xle({target:"Promise",proto:!0,real:!0,forced:!!RC&&Jle(function(){tde.finally.call({then:function(){}},function(){})})},{finally:function(t){var r=ede(this,Qle("Promise")),i=Zle(t);return this.then(i?function(a){return b5(r,t()).then(function(){return a})}:t,i?function(a){return b5(r,t()).then(function(){throw a})}:t)}});var AC=E,nde=SN,rde=Ts,ide=st,sde=AC("".charAt),x5=AC("".charCodeAt),ade=AC("".slice),_5=function(t){return function(r,i){var a,l,u=rde(ide(r)),p=nde(i),m=u.length;return p<0||p>=m?t?"":void 0:(a=x5(u,p))<55296||a>56319||p+1===m||(l=x5(u,p+1))<56320||l>57343?t?sde(u,p):a:t?ade(u,p,p+2):l-56320+(a-55296<<10)+65536}},IC={codeAt:_5(!1),charAt:_5(!0)},ode=IC.charAt,cde=Ts,E5=Ru,lde=vM,w5=Fb,S5="String Iterator",dde=E5.set,ude=E5.getterFor(S5);lde(String,"String",function(t){dde(this,{type:S5,string:cde(t),index:0})},function(){var t,r=ude(this),i=r.string,a=r.index;return a>=i.length?w5(void 0,!0):(t=ode(i,a),r.index+=t.length,w5(t,!1))});var hde=yt.Promise,pde={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},mde=R,fde=ol,T5=Ep;for(var OC in pde)fde(mde[OC],OC),T5[OC]=T5.Array;var N5=hde,je=d(N5),gde=ha("Array","values"),vde=sd,yde=ui,bde=N,xde=gde,PC=Array.prototype,_de={DOMTokenList:!0,NodeList:!0},Ede=function(t){var r=t.values;return t===PC||bde(PC,t)&&r===PC.values||yde(_de,vde(t))?xde:r},Ns=d(Ede),C5=vp,wde=TypeError,R5=od,Sde=Math.floor,kC=function(t,r){var i=t.length;if(i<8)for(var a,l,u=1;u<i;){for(l=u,a=t[u];l&&r(t[l-1],a)>0;)t[l]=t[--l];l!==u++&&(t[l]=a)}else for(var p=Sde(i/2),m=kC(R5(t,0,p),r),g=kC(R5(t,p),r),y=m.length,x=g.length,S=0,T=0;S<y||T<x;)t[S+T]=S<y&&T<x?r(m[S],g[T])<=0?m[S++]:g[T++]:S<y?m[S++]:g[T++];return t},A5=kC,I5=on.match(/firefox\/(\d+)/i),Tde=!!I5&&+I5[1],Nde=/MSIE|Trident/.test(on),O5=on.match(/AppleWebKit\/(\d+)\./),Cde=!!O5&&+O5[1],Rde=en,P5=E,Ade=Vs,Ide=yc,k5=id,Ode=function(t,r){if(!delete t[r])throw new wde("Cannot delete property "+C5(r)+" of "+C5(t))},j5=Ts,jC=h,Pde=A5,kde=Eb,D5=Tde,jde=Nde,L5=Va,M5=Cde,ld=[],U5=P5(ld.sort),Dde=P5(ld.push),Lde=jC(function(){ld.sort(void 0)}),Mde=jC(function(){ld.sort(null)}),Ude=kde("sort"),F5=!jC(function(){if(L5)return L5<70;if(!(D5&&D5>3)){if(jde)return!0;if(M5)return M5<603;var t,r,i,a,l="";for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(a=0;a<47;a++)ld.push({k:r+a,v:i})}for(ld.sort(function(u,p){return p.v-u.v}),a=0;a<ld.length;a++)r=ld[a].k.charAt(0),l.charAt(l.length-1)!==r&&(l+=r);return l!=="DGBEFHACIJK"}});Rde({target:"Array",proto:!0,forced:Lde||!Mde||!Ude||!F5},{sort:function(t){t!==void 0&&Ade(t);var r=Ide(this);if(F5)return t===void 0?U5(r):U5(r,t);var i,a,l=[],u=k5(r);for(a=0;a<u;a++)a in r&&Dde(l,r[a]);for(Pde(l,function(p){return function(m,g){return g===void 0?-1:m===void 0?1:p!==void 0?+p(m,g)||0:j5(m)>j5(g)?1:-1}}(t)),i=k5(l),a=0;a<i;)r[a]=l[a++];for(;a<u;)Ode(r,a++);return r}});var Fde=ha("Array","sort"),Vde=N,Bde=Fde,DC=Array.prototype,Gde=function(t){var r=t.sort;return t===DC||Vde(DC,t)&&r===DC.sort?Bde:r},Ou=d(Gde),Wde=en,$de=E,zde=TN,Hde=RangeError,V5=String.fromCharCode,B5=String.fromCodePoint,Kde=$de([].join);Wde({target:"String",stat:!0,forced:!!B5&&B5.length!==1},{fromCodePoint:function(t){for(var r,i=[],a=arguments.length,l=0;a>l;){if(r=+arguments[l++],zde(r,1114111)!==r)throw new Hde(r+" is not a valid code point");i[l]=r<65536?V5(r):V5(55296+((r-=65536)>>10),r%1024+56320)}return Kde(i,"")}});var Yde=h,qde=ar("iterator"),Xb=!Yde(function(){var t=new URL("b?a=1&b=2&c=3","https://a"),r=t.searchParams,i=new URLSearchParams("a=1&a=2&b=3"),a="";return t.pathname="c%20d",r.forEach(function(l,u){r.delete("b"),a+=u+l}),i.delete("a",2),i.delete("b",void 0),!t.toJSON||!i.has("a",1)||i.has("a",2)||!i.has("a",void 0)||i.has("b")||!r.size&&!0||!r.sort||t.href!=="https://a/c%20d?a=1&c=3"||r.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!r[qde]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||a!=="a1c3"||new URL("https://x",void 0).host!=="x"}),Xde=ad,LC=en,G5=R,MC=FM,Jde=Ne,Jb=he,Io=E,Xg=le,W5=Xb,$5=ad,Qde=Bb,Zde=function(t,r,i){for(var a in r)i&&i.unsafe&&t[a]?t[a]=r[a]:Xde(t,a,r[a],i);return t},eue=ol,tue=JN,UC=Ru,z5=ZN,FC=ae,nue=ui,rue=rd,iue=sd,sue=Ss,H5=Je,Cs=Ts,aue=Vg,K5=De,Y5=GN,oue=Ob,Qb=Fb,Op=Au,cue=A5,lue=ar("iterator"),Pp="URLSearchParams",q5=Pp+"Iterator",X5=UC.set,Ga=UC.getterFor(Pp),due=UC.getterFor(q5),J5=MC("fetch"),Zb=MC("Request"),Jg=MC("Headers"),VC=Zb&&Zb.prototype,Q5=Jg&&Jg.prototype,uue=G5.TypeError,hue=G5.encodeURIComponent,pue=String.fromCharCode,mue=Jde("String","fromCodePoint"),fue=parseInt,ex=Io("".charAt),Z5=Io([].join),dd=Io([].push),eU=Io("".replace),gue=Io([].shift),tU=Io([].splice),nU=Io("".split),rU=Io("".slice),vue=Io(/./.exec),yue=/\+/g,bue=/^[0-9a-f]+$/i,iU=function(t,r){var i=rU(t,r,r+2);return vue(bue,i)?fue(i,16):NaN},xue=function(t){for(var r=0,i=128;i>0&&t&i;i>>=1)r++;return r},_ue=function(t){var r=null;switch(t.length){case 1:r=t[0];break;case 2:r=(31&t[0])<<6|63&t[1];break;case 3:r=(15&t[0])<<12|(63&t[1])<<6|63&t[2];break;case 4:r=(7&t[0])<<18|(63&t[1])<<12|(63&t[2])<<6|63&t[3]}return r>1114111?null:r},sU=function(t){for(var r=(t=eU(t,yue," ")).length,i="",a=0;a<r;){var l=ex(t,a);if(l==="%"){if(ex(t,a+1)==="%"||a+3>r){i+="%",a++;continue}var u=iU(t,a+1);if(u!=u){i+=l,a++;continue}a+=2;var p=xue(u);if(p===0)l=pue(u);else{if(p===1||p>4){i+="",a++;continue}for(var m=[u],g=1;g<p&&!(++a+3>r||ex(t,a)!=="%");){var y=iU(t,a+1);if(y!=y){a+=3;break}if(y>191||y<128)break;dd(m,y),a+=2,g++}if(m.length!==p){i+="";continue}var x=_ue(m);x===null?i+="":l=mue(x)}}i+=l,a++}return i},Eue=/[!'()~]|%20/g,wue={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Sue=function(t){return wue[t]},aU=function(t){return eU(hue(t),Eue,Sue)},BC=tue(function(t,r){X5(this,{type:q5,target:Ga(t).entries,index:0,kind:r})},Pp,function(){var t=due(this),r=t.target,i=t.index++;if(!r||i>=r.length)return t.target=null,Qb(void 0,!0);var a=r[i];switch(t.kind){case"keys":return Qb(a.key,!1);case"values":return Qb(a.value,!1)}return Qb([a.key,a.value],!1)},!0),oU=function(t){this.entries=[],this.url=null,t!==void 0&&(H5(t)?this.parseObject(t):this.parseQuery(typeof t=="string"?ex(t,0)==="?"?rU(t,1):t:Cs(t)))};oU.prototype={type:Pp,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var r,i,a,l,u,p,m,g=this.entries,y=oue(t);if(y)for(i=(r=Y5(t,y)).next;!(a=Jb(i,r)).done;){if(u=(l=Y5(sue(a.value))).next,(p=Jb(u,l)).done||(m=Jb(u,l)).done||!Jb(u,l).done)throw new uue("Expected sequence with length 2");dd(g,{key:Cs(p.value),value:Cs(m.value)})}else for(var x in t)nue(t,x)&&dd(g,{key:x,value:Cs(t[x])})},parseQuery:function(t){if(t)for(var r,i,a=this.entries,l=nU(t,"&"),u=0;u<l.length;)(r=l[u++]).length&&(i=nU(r,"="),dd(a,{key:sU(gue(i)),value:sU(Z5(i,"="))}))},serialize:function(){for(var t,r=this.entries,i=[],a=0;a<r.length;)t=r[a++],dd(i,aU(t.key)+"="+aU(t.value));return Z5(i,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var tx=function(){z5(this,kp);var t=X5(this,new oU(arguments.length>0?arguments[0]:void 0));Xg||(this.size=t.entries.length)},kp=tx.prototype;if(Zde(kp,{append:function(t,r){var i=Ga(this);Op(arguments.length,2),dd(i.entries,{key:Cs(t),value:Cs(r)}),Xg||this.length++,i.updateURL()},delete:function(t){for(var r=Ga(this),i=Op(arguments.length,1),a=r.entries,l=Cs(t),u=i<2?void 0:arguments[1],p=u===void 0?u:Cs(u),m=0;m<a.length;){var g=a[m];if(g.key!==l||p!==void 0&&g.value!==p)m++;else if(tU(a,m,1),p!==void 0)break}Xg||(this.size=a.length),r.updateURL()},get:function(t){var r=Ga(this).entries;Op(arguments.length,1);for(var i=Cs(t),a=0;a<r.length;a++)if(r[a].key===i)return r[a].value;return null},getAll:function(t){var r=Ga(this).entries;Op(arguments.length,1);for(var i=Cs(t),a=[],l=0;l<r.length;l++)r[l].key===i&&dd(a,r[l].value);return a},has:function(t){for(var r=Ga(this).entries,i=Op(arguments.length,1),a=Cs(t),l=i<2?void 0:arguments[1],u=l===void 0?l:Cs(l),p=0;p<r.length;){var m=r[p++];if(m.key===a&&(u===void 0||m.value===u))return!0}return!1},set:function(t,r){var i=Ga(this);Op(arguments.length,1);for(var a,l=i.entries,u=!1,p=Cs(t),m=Cs(r),g=0;g<l.length;g++)(a=l[g]).key===p&&(u?tU(l,g--,1):(u=!0,a.value=m));u||dd(l,{key:p,value:m}),Xg||(this.size=l.length),i.updateURL()},sort:function(){var t=Ga(this);cue(t.entries,function(r,i){return r.key>i.key?1:-1}),t.updateURL()},forEach:function(t){for(var r,i=Ga(this).entries,a=rue(t,arguments.length>1?arguments[1]:void 0),l=0;l<i.length;)a((r=i[l++]).value,r.key,this)},keys:function(){return new BC(this,"keys")},values:function(){return new BC(this,"values")},entries:function(){return new BC(this,"entries")}},{enumerable:!0}),$5(kp,lue,kp.entries,{}),$5(kp,"toString",function(){return Ga(this).serialize()},{enumerable:!0}),Xg&&Qde(kp,"size",{get:function(){return Ga(this).entries.length},configurable:!0,enumerable:!0}),eue(tx,Pp),LC({global:!0,forced:!W5},{URLSearchParams:tx}),!W5&&FC(Jg)){var Tue=Io(Q5.has),Nue=Io(Q5.set),cU=function(t){if(H5(t)){var r,i=t.body;if(iue(i)===Pp)return r=t.headers?new Jg(t.headers):new Jg,Tue(r,"content-type")||Nue(r,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),aue(t,{body:K5(0,Cs(i)),headers:K5(0,r)})}return t};if(FC(J5)&&LC({global:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return J5(t,arguments.length>1?cU(arguments[1]):{})}}),FC(Zb)){var GC=function(t){return z5(this,VC),new Zb(t,arguments.length>1?cU(arguments[1]):{})};VC.constructor=GC,GC.prototype=VC,LC({global:!0,dontCallGetSet:!0,forced:!0},{Request:GC})}}var Wa,Cue={URLSearchParams:tx,getState:Ga},Rue=yt.URLSearchParams,lU=le,Aue=E,Iue=he,Oue=h,WC=Rb,Pue=Fg,kue=J,jue=yc,Due=tt,jp=Object.assign,dU=Object.defineProperty,Lue=Aue([].concat),Mue=!jp||Oue(function(){if(lU&&jp({b:1},jp(dU({},"a",{enumerable:!0,get:function(){dU(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var t={},r={},i=Symbol("assign detection"),a="abcdefghijklmnopqrst";return t[i]=7,a.split("").forEach(function(l){r[l]=l}),jp({},t)[i]!==7||WC(jp({},r)).join("")!==a})?function(t,r){for(var i=jue(t),a=arguments.length,l=1,u=Pue.f,p=kue.f;a>l;)for(var m,g=Due(arguments[l++]),y=u?Lue(WC(g),u(g)):WC(g),x=y.length,S=0;x>S;)m=y[S++],lU&&!Iue(p,g,m)||(i[m]=g[m]);return i}:jp,Uue=Ss,Fue=XL,Vue=le,Bue=Ba,Gue=De,$C=function(t,r,i){Vue?Bue.f(t,r,Gue(0,i)):t[r]=i},Wue=rd,$ue=he,zue=yc,Hue=function(t,r,i,a){try{return a?r(Uue(i)[0],i[1]):r(i)}catch(l){Fue(t,"throw",l)}},Kue=KL,Yue=Gb,que=id,uU=$C,Xue=GN,Jue=Ob,hU=Array,Pu=E,zC=2147483647,Que=/[^\0-\u007E]/,pU=/[.\u3002\uFF0E\uFF61]/g,mU="Overflow: input needs wider integers to process",fU=RangeError,Zue=Pu(pU.exec),Dp=Math.floor,HC=String.fromCharCode,gU=Pu("".charCodeAt),vU=Pu([].join),ud=Pu([].push),ehe=Pu("".replace),the=Pu("".split),nhe=Pu("".toLowerCase),yU=function(t){return t+22+75*(t<26)},rhe=function(t,r,i){var a=0;for(t=i?Dp(t/700):t>>1,t+=Dp(t/r);t>455;)t=Dp(t/35),a+=36;return Dp(a+36*t/(t+38))},ihe=function(t){var r=[];t=function(H){for(var Y=[],te=0,se=H.length;te<se;){var oe=gU(H,te++);if(oe>=55296&&oe<=56319&&te<se){var ne=gU(H,te++);(64512&ne)==56320?ud(Y,((1023&oe)<<10)+(1023&ne)+65536):(ud(Y,oe),te--)}else ud(Y,oe)}return Y}(t);var i,a,l=t.length,u=128,p=0,m=72;for(i=0;i<t.length;i++)(a=t[i])<128&&ud(r,HC(a));var g=r.length,y=g;for(g&&ud(r,"-");y<l;){var x=zC;for(i=0;i<t.length;i++)(a=t[i])>=u&&a<x&&(x=a);var S=y+1;if(x-u>Dp((zC-p)/S))throw new fU(mU);for(p+=(x-u)*S,u=x,i=0;i<t.length;i++){if((a=t[i])<u&&++p>zC)throw new fU(mU);if(a===u){for(var T=p,C=36;;){var V=C<=m?1:C>=m+26?26:C-m;if(T<V)break;var j=T-V,L=36-V;ud(r,HC(yU(V+j%L))),T=Dp(j/L),C+=36}ud(r,HC(yU(T))),m=rhe(p,S,y===g),p=0,y++}}p++,u++}return vU(r,"")},she=en,KC=le,ahe=Xb,YC=R,bU=rd,$a=E,nx=ad,za=Bb,ohe=ZN,qC=ui,XC=Mue,Lp=function(t){var r=zue(t),i=Yue(this),a=arguments.length,l=a>1?arguments[1]:void 0,u=l!==void 0;u&&(l=Wue(l,a>2?arguments[2]:void 0));var p,m,g,y,x,S,T=Jue(r),C=0;if(!T||this===hU&&Kue(T))for(p=que(r),m=i?new this(p):hU(p);p>C;C++)S=u?l(r[C],C):r[C],uU(m,C,S);else for(m=i?new this:[],x=(y=Xue(r,T)).next;!(g=$ue(x,y)).done;C++)S=u?Hue(y,l,[g.value,C],!0):g.value,uU(m,C,S);return m.length=C,m},Oo=od,che=IC.codeAt,lhe=function(t){var r,i,a=[],l=the(ehe(nhe(t),pU,"."),".");for(r=0;r<l.length;r++)i=l[r],ud(a,Zue(Que,i)?"xn--"+ihe(i):i);return vU(a,".")},cl=Ts,dhe=ol,uhe=Au,xU=Cue,_U=Ru,hhe=_U.set,rx=_U.getterFor("URL"),phe=xU.URLSearchParams,mhe=xU.getState,Qg=YC.URL,JC=YC.TypeError,ix=YC.parseInt,fhe=Math.floor,EU=Math.pow,Ha=$a("".charAt),Po=$a(/./.exec),Zg=$a([].join),ghe=$a(1.1.toString),vhe=$a([].pop),Mp=$a([].push),QC=$a("".replace),yhe=$a([].shift),bhe=$a("".split),e0=$a("".slice),sx=$a("".toLowerCase),xhe=$a([].unshift),ZC="Invalid scheme",ku="Invalid host",wU="Invalid port",SU=/[a-z]/i,_he=/[\d+-.a-z]/i,eR=/\d/,Ehe=/^0x/i,whe=/^[0-7]+$/,She=/^\d+$/,TU=/^[\da-f]+$/i,The=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Nhe=/[\0\t\n\r #/:<>?@[\\\]^|]/,Che=/^[\u0000-\u0020]+/,Rhe=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,Ahe=/[\t\n\r]/g,t0=function(t){var r,i,a,l;if(typeof t=="number"){for(r=[],i=0;i<4;i++)xhe(r,t%256),t=fhe(t/256);return Zg(r,".")}if(typeof t=="object"){for(r="",a=function(u){for(var p=null,m=1,g=null,y=0,x=0;x<8;x++)u[x]!==0?(y>m&&(p=g,m=y),g=null,y=0):(g===null&&(g=x),++y);return y>m?g:p}(t),i=0;i<8;i++)l&&t[i]===0||(l&&(l=!1),a===i?(r+=i?":":"::",l=!0):(r+=ghe(t[i],16),i<7&&(r+=":")));return"["+r+"]"}return t},ax={},NU=XC({},ax,{" ":1,'"':1,"<":1,">":1,"`":1}),CU=XC({},NU,{"#":1,"?":1,"{":1,"}":1}),tR=XC({},CU,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),hd=function(t,r){var i=che(t,0);return i>32&&i<127&&!qC(r,t)?t:encodeURIComponent(t)},ox={ftp:21,file:null,http:80,https:443,ws:80,wss:443},n0=function(t,r){var i;return t.length===2&&Po(SU,Ha(t,0))&&((i=Ha(t,1))===":"||!r&&i==="|")},RU=function(t){var r;return t.length>1&&n0(e0(t,0,2))&&(t.length===2||(r=Ha(t,2))==="/"||r==="\\"||r==="?"||r==="#")},Ihe=function(t){return t==="."||sx(t)==="%2e"},nR={},AU={},rR={},IU={},OU={},iR={},PU={},kU={},cx={},lx={},sR={},aR={},oR={},cR={},jU={},lR={},Up={},_c={},DU={},ju={},ll={},dR=function(t,r,i){var a,l,u,p=cl(t);if(r){if(l=this.parse(p))throw new JC(l);this.searchParams=null}else{if(i!==void 0&&(a=new dR(i,!0)),l=this.parse(p,null,a))throw new JC(l);(u=mhe(new phe)).bindURL(this),this.searchParams=u}};dR.prototype={type:"URL",parse:function(t,r,i){var a,l,u,p,m,g=this,y=r||nR,x=0,S="",T=!1,C=!1,V=!1;for(t=cl(t),r||(g.scheme="",g.username="",g.password="",g.host=null,g.port=null,g.path=[],g.query=null,g.fragment=null,g.cannotBeABaseURL=!1,t=QC(t,Che,""),t=QC(t,Rhe,"$1")),t=QC(t,Ahe,""),a=Lp(t);x<=a.length;){switch(l=a[x],y){case nR:if(!l||!Po(SU,l)){if(r)return ZC;y=rR;continue}S+=sx(l),y=AU;break;case AU:if(l&&(Po(_he,l)||l==="+"||l==="-"||l==="."))S+=sx(l);else{if(l!==":"){if(r)return ZC;S="",y=rR,x=0;continue}if(r&&(g.isSpecial()!==qC(ox,S)||S==="file"&&(g.includesCredentials()||g.port!==null)||g.scheme==="file"&&!g.host))return;if(g.scheme=S,r)return void(g.isSpecial()&&ox[g.scheme]===g.port&&(g.port=null));S="",g.scheme==="file"?y=cR:g.isSpecial()&&i&&i.scheme===g.scheme?y=IU:g.isSpecial()?y=kU:a[x+1]==="/"?(y=OU,x++):(g.cannotBeABaseURL=!0,Mp(g.path,""),y=DU)}break;case rR:if(!i||i.cannotBeABaseURL&&l!=="#")return ZC;if(i.cannotBeABaseURL&&l==="#"){g.scheme=i.scheme,g.path=Oo(i.path),g.query=i.query,g.fragment="",g.cannotBeABaseURL=!0,y=ll;break}y=i.scheme==="file"?cR:iR;continue;case IU:if(l!=="/"||a[x+1]!=="/"){y=iR;continue}y=cx,x++;break;case OU:if(l==="/"){y=lx;break}y=_c;continue;case iR:if(g.scheme=i.scheme,l===Wa)g.username=i.username,g.password=i.password,g.host=i.host,g.port=i.port,g.path=Oo(i.path),g.query=i.query;else if(l==="/"||l==="\\"&&g.isSpecial())y=PU;else if(l==="?")g.username=i.username,g.password=i.password,g.host=i.host,g.port=i.port,g.path=Oo(i.path),g.query="",y=ju;else{if(l!=="#"){g.username=i.username,g.password=i.password,g.host=i.host,g.port=i.port,g.path=Oo(i.path),g.path.length--,y=_c;continue}g.username=i.username,g.password=i.password,g.host=i.host,g.port=i.port,g.path=Oo(i.path),g.query=i.query,g.fragment="",y=ll}break;case PU:if(!g.isSpecial()||l!=="/"&&l!=="\\"){if(l!=="/"){g.username=i.username,g.password=i.password,g.host=i.host,g.port=i.port,y=_c;continue}y=lx}else y=cx;break;case kU:if(y=cx,l!=="/"||Ha(S,x+1)!=="/")continue;x++;break;case cx:if(l!=="/"&&l!=="\\"){y=lx;continue}break;case lx:if(l==="@"){T&&(S="%40"+S),T=!0,u=Lp(S);for(var j=0;j<u.length;j++){var L=u[j];if(L!==":"||V){var H=hd(L,tR);V?g.password+=H:g.username+=H}else V=!0}S=""}else if(l===Wa||l==="/"||l==="?"||l==="#"||l==="\\"&&g.isSpecial()){if(T&&S==="")return"Invalid authority";x-=Lp(S).length+1,S="",y=sR}else S+=l;break;case sR:case aR:if(r&&g.scheme==="file"){y=lR;continue}if(l!==":"||C){if(l===Wa||l==="/"||l==="?"||l==="#"||l==="\\"&&g.isSpecial()){if(g.isSpecial()&&S==="")return ku;if(r&&S===""&&(g.includesCredentials()||g.port!==null))return;if(p=g.parseHost(S))return p;if(S="",y=Up,r)return;continue}l==="["?C=!0:l==="]"&&(C=!1),S+=l}else{if(S==="")return ku;if(p=g.parseHost(S))return p;if(S="",y=oR,r===aR)return}break;case oR:if(!Po(eR,l)){if(l===Wa||l==="/"||l==="?"||l==="#"||l==="\\"&&g.isSpecial()||r){if(S!==""){var Y=ix(S,10);if(Y>65535)return wU;g.port=g.isSpecial()&&Y===ox[g.scheme]?null:Y,S=""}if(r)return;y=Up;continue}return wU}S+=l;break;case cR:if(g.scheme="file",l==="/"||l==="\\")y=jU;else{if(!i||i.scheme!=="file"){y=_c;continue}switch(l){case Wa:g.host=i.host,g.path=Oo(i.path),g.query=i.query;break;case"?":g.host=i.host,g.path=Oo(i.path),g.query="",y=ju;break;case"#":g.host=i.host,g.path=Oo(i.path),g.query=i.query,g.fragment="",y=ll;break;default:RU(Zg(Oo(a,x),""))||(g.host=i.host,g.path=Oo(i.path),g.shortenPath()),y=_c;continue}}break;case jU:if(l==="/"||l==="\\"){y=lR;break}i&&i.scheme==="file"&&!RU(Zg(Oo(a,x),""))&&(n0(i.path[0],!0)?Mp(g.path,i.path[0]):g.host=i.host),y=_c;continue;case lR:if(l===Wa||l==="/"||l==="\\"||l==="?"||l==="#"){if(!r&&n0(S))y=_c;else if(S===""){if(g.host="",r)return;y=Up}else{if(p=g.parseHost(S))return p;if(g.host==="localhost"&&(g.host=""),r)return;S="",y=Up}continue}S+=l;break;case Up:if(g.isSpecial()){if(y=_c,l!=="/"&&l!=="\\")continue}else if(r||l!=="?")if(r||l!=="#"){if(l!==Wa&&(y=_c,l!=="/"))continue}else g.fragment="",y=ll;else g.query="",y=ju;break;case _c:if(l===Wa||l==="/"||l==="\\"&&g.isSpecial()||!r&&(l==="?"||l==="#")){if((m=sx(m=S))===".."||m==="%2e."||m===".%2e"||m==="%2e%2e"?(g.shortenPath(),l==="/"||l==="\\"&&g.isSpecial()||Mp(g.path,"")):Ihe(S)?l==="/"||l==="\\"&&g.isSpecial()||Mp(g.path,""):(g.scheme==="file"&&!g.path.length&&n0(S)&&(g.host&&(g.host=""),S=Ha(S,0)+":"),Mp(g.path,S)),S="",g.scheme==="file"&&(l===Wa||l==="?"||l==="#"))for(;g.path.length>1&&g.path[0]==="";)yhe(g.path);l==="?"?(g.query="",y=ju):l==="#"&&(g.fragment="",y=ll)}else S+=hd(l,CU);break;case DU:l==="?"?(g.query="",y=ju):l==="#"?(g.fragment="",y=ll):l!==Wa&&(g.path[0]+=hd(l,ax));break;case ju:r||l!=="#"?l!==Wa&&(l==="'"&&g.isSpecial()?g.query+="%27":g.query+=l==="#"?"%23":hd(l,ax)):(g.fragment="",y=ll);break;case ll:l!==Wa&&(g.fragment+=hd(l,NU))}x++}},parseHost:function(t){var r,i,a;if(Ha(t,0)==="["){if(Ha(t,t.length-1)!=="]"||(r=function(l){var u,p,m,g,y,x,S,T=[0,0,0,0,0,0,0,0],C=0,V=null,j=0,L=function(){return Ha(l,j)};if(L()===":"){if(Ha(l,1)!==":")return;j+=2,V=++C}for(;L();){if(C===8)return;if(L()!==":"){for(u=p=0;p<4&&Po(TU,L());)u=16*u+ix(L(),16),j++,p++;if(L()==="."){if(p===0||(j-=p,C>6))return;for(m=0;L();){if(g=null,m>0){if(!(L()==="."&&m<4))return;j++}if(!Po(eR,L()))return;for(;Po(eR,L());){if(y=ix(L(),10),g===null)g=y;else{if(g===0)return;g=10*g+y}if(g>255)return;j++}T[C]=256*T[C]+g,++m!=2&&m!==4||C++}if(m!==4)return;break}if(L()===":"){if(j++,!L())return}else if(L())return;T[C++]=u}else{if(V!==null)return;j++,V=++C}}if(V!==null)for(x=C-V,C=7;C!==0&&x>0;)S=T[C],T[C--]=T[V+x-1],T[V+--x]=S;else if(C!==8)return;return T}(e0(t,1,-1)),!r))return ku;this.host=r}else if(this.isSpecial()){if(t=lhe(t),Po(The,t)||(r=function(l){var u,p,m,g,y,x,S,T=bhe(l,".");if(T.length&&T[T.length-1]===""&&T.length--,(u=T.length)>4)return l;for(p=[],m=0;m<u;m++){if((g=T[m])==="")return l;if(y=10,g.length>1&&Ha(g,0)==="0"&&(y=Po(Ehe,g)?16:8,g=e0(g,y===8?1:2)),g==="")x=0;else{if(!Po(y===10?She:y===8?whe:TU,g))return l;x=ix(g,y)}Mp(p,x)}for(m=0;m<u;m++)if(x=p[m],m===u-1){if(x>=EU(256,5-u))return null}else if(x>255)return null;for(S=vhe(p),m=0;m<p.length;m++)S+=p[m]*EU(256,3-m);return S}(t),r===null))return ku;this.host=r}else{if(Po(Nhe,t))return ku;for(r="",i=Lp(t),a=0;a<i.length;a++)r+=hd(i[a],ax);this.host=r}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return qC(ox,this.scheme)},shortenPath:function(){var t=this.path,r=t.length;!r||this.scheme==="file"&&r===1&&n0(t[0],!0)||t.length--},serialize:function(){var t=this,r=t.scheme,i=t.username,a=t.password,l=t.host,u=t.port,p=t.path,m=t.query,g=t.fragment,y=r+":";return l!==null?(y+="//",t.includesCredentials()&&(y+=i+(a?":"+a:"")+"@"),y+=t0(l),u!==null&&(y+=":"+u)):r==="file"&&(y+="//"),y+=t.cannotBeABaseURL?p[0]:p.length?"/"+Zg(p,"/"):"",m!==null&&(y+="?"+m),g!==null&&(y+="#"+g),y},setHref:function(t){var r=this.parse(t);if(r)throw new JC(r);this.searchParams.update()},getOrigin:function(){var t=this.scheme,r=this.port;if(t==="blob")try{return new Fp(t.path[0]).origin}catch{return"null"}return t!=="file"&&this.isSpecial()?t+"://"+t0(this.host)+(r!==null?":"+r:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(t){this.parse(cl(t)+":",nR)},getUsername:function(){return this.username},setUsername:function(t){var r=Lp(cl(t));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var i=0;i<r.length;i++)this.username+=hd(r[i],tR)}},getPassword:function(){return this.password},setPassword:function(t){var r=Lp(cl(t));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var i=0;i<r.length;i++)this.password+=hd(r[i],tR)}},getHost:function(){var t=this.host,r=this.port;return t===null?"":r===null?t0(t):t0(t)+":"+r},setHost:function(t){this.cannotBeABaseURL||this.parse(t,sR)},getHostname:function(){var t=this.host;return t===null?"":t0(t)},setHostname:function(t){this.cannotBeABaseURL||this.parse(t,aR)},getPort:function(){var t=this.port;return t===null?"":cl(t)},setPort:function(t){this.cannotHaveUsernamePasswordPort()||((t=cl(t))===""?this.port=null:this.parse(t,oR))},getPathname:function(){var t=this.path;return this.cannotBeABaseURL?t[0]:t.length?"/"+Zg(t,"/"):""},setPathname:function(t){this.cannotBeABaseURL||(this.path=[],this.parse(t,Up))},getSearch:function(){var t=this.query;return t?"?"+t:""},setSearch:function(t){(t=cl(t))===""?this.query=null:(Ha(t,0)==="?"&&(t=e0(t,1)),this.query="",this.parse(t,ju)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var t=this.fragment;return t?"#"+t:""},setHash:function(t){(t=cl(t))!==""?(Ha(t,0)==="#"&&(t=e0(t,1)),this.fragment="",this.parse(t,ll)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Fp=function(t){var r=ohe(this,Rs),i=uhe(arguments.length,1)>1?arguments[1]:void 0,a=hhe(r,new dR(t,!1,i));KC||(r.href=a.serialize(),r.origin=a.getOrigin(),r.protocol=a.getProtocol(),r.username=a.getUsername(),r.password=a.getPassword(),r.host=a.getHost(),r.hostname=a.getHostname(),r.port=a.getPort(),r.pathname=a.getPathname(),r.search=a.getSearch(),r.searchParams=a.getSearchParams(),r.hash=a.getHash())},Rs=Fp.prototype,Ka=function(t,r){return{get:function(){return rx(this)[t]()},set:r&&function(i){return rx(this)[r](i)},configurable:!0,enumerable:!0}};if(KC&&(za(Rs,"href",Ka("serialize","setHref")),za(Rs,"origin",Ka("getOrigin")),za(Rs,"protocol",Ka("getProtocol","setProtocol")),za(Rs,"username",Ka("getUsername","setUsername")),za(Rs,"password",Ka("getPassword","setPassword")),za(Rs,"host",Ka("getHost","setHost")),za(Rs,"hostname",Ka("getHostname","setHostname")),za(Rs,"port",Ka("getPort","setPort")),za(Rs,"pathname",Ka("getPathname","setPathname")),za(Rs,"search",Ka("getSearch","setSearch")),za(Rs,"searchParams",Ka("getSearchParams")),za(Rs,"hash",Ka("getHash","setHash"))),nx(Rs,"toJSON",function(){return rx(this).serialize()},{enumerable:!0}),nx(Rs,"toString",function(){return rx(this).serialize()},{enumerable:!0}),Qg){var LU=Qg.createObjectURL,MU=Qg.revokeObjectURL;LU&&nx(Fp,"createObjectURL",bU(LU,Qg)),MU&&nx(Fp,"revokeObjectURL",bU(MU,Qg))}dhe(Fp,"URL"),she({global:!0,forced:!ahe,sham:!KC},{URL:Fp});var Ohe=en,UU=h,Phe=Au,FU=Ts,khe=Xb,uR=Ne("URL"),jhe=khe&&UU(function(){uR.canParse()}),Dhe=UU(function(){return uR.canParse.length!==1});Ohe({target:"URL",stat:!0,forced:!jhe||Dhe},{canParse:function(t){var r=Phe(arguments.length,1),i=FU(t),a=r<2||arguments[1]===void 0?void 0:FU(arguments[1]);try{return!!new uR(i,a)}catch{return!1}}});var Lhe=en,Mhe=Au,VU=Ts,Uhe=Xb,Fhe=Ne("URL");Lhe({target:"URL",stat:!0,forced:!Uhe},{parse:function(t){var r=Mhe(arguments.length,1),i=VU(t),a=r<2||arguments[1]===void 0?void 0:VU(arguments[1]);try{return new Fhe(i,a)}catch{return null}}});var dx=d(yt.URL);let BU=!0,GU=!0;function ux(t,r,i){const a=t.match(r);return a&&a.length>=i&&parseInt(a[i],10)}function Du(t,r,i){if(!t.RTCPeerConnection)return;const a=t.RTCPeerConnection.prototype,l=a.addEventListener;a.addEventListener=function(p,m){if(p!==r)return l.apply(this,arguments);const g=y=>{const x=i(y);x&&(m.handleEvent?m.handleEvent(x):m(x))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(m,g),l.apply(this,[p,g])};const u=a.removeEventListener;a.removeEventListener=function(p,m){if(p!==r||!this._eventMap||!this._eventMap[r])return u.apply(this,arguments);if(!this._eventMap[r].has(m))return u.apply(this,arguments);const g=this._eventMap[r].get(m);return this._eventMap[r].delete(m),this._eventMap[r].size===0&&delete this._eventMap[r],Object.keys(this._eventMap).length===0&&delete this._eventMap,u.apply(this,[p,g])},Object.defineProperty(a,"on"+r,{get(){return this["_on"+r]},set(p){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),p&&this.addEventListener(r,this["_on"+r]=p)},enumerable:!0,configurable:!0})}function Vhe(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(BU=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function Bhe(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(GU=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function WU(){if(typeof window=="object"){if(BU)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function hR(t,r){GU&&console.warn(t+" is deprecated, please use "+r+" instead.")}function $U(t){return Object.prototype.toString.call(t)==="[object Object]"}function zU(t){var r;return $U(t)?pa(r=Object.keys(t)).call(r,function(i,a){const l=$U(t[a]),u=l?zU(t[a]):t[a],p=l&&!Object.keys(u).length;return u===void 0||p?i:Object.assign(i,{[a]:u})},{}):t}function pR(t,r,i){r&&!i.has(r.id)&&(i.set(r.id,r),Object.keys(r).forEach(a=>{a.endsWith("Id")?pR(t,t.get(r[a]),i):a.endsWith("Ids")&&r[a].forEach(l=>{pR(t,t.get(l),i)})}))}function HU(t,r,i){const a=i?"outbound-rtp":"inbound-rtp",l=new Map;if(r===null)return l;const u=[];return t.forEach(p=>{p.type==="track"&&p.trackIdentifier===r.id&&u.push(p)}),u.forEach(p=>{t.forEach(m=>{m.type===a&&m.trackId===p.id&&pR(t,m,l)})}),l}const KU=WU;function YU(t,r){const i=t&&t.navigator;if(!i.mediaDevices)return;const a=function(p){if(typeof p!="object"||p.mandatory||p.optional)return p;const m={};return Object.keys(p).forEach(g=>{if(g==="require"||g==="advanced"||g==="mediaSource")return;const y=typeof p[g]=="object"?p[g]:{ideal:p[g]};y.exact!==void 0&&typeof y.exact=="number"&&(y.min=y.max=y.exact);const x=function(S,T){return S?S+T.charAt(0).toUpperCase()+T.slice(1):T==="deviceId"?"sourceId":T};if(y.ideal!==void 0){m.optional=m.optional||[];let S={};typeof y.ideal=="number"?(S[x("min",g)]=y.ideal,m.optional.push(S),S={},S[x("max",g)]=y.ideal,m.optional.push(S)):(S[x("",g)]=y.ideal,m.optional.push(S))}y.exact!==void 0&&typeof y.exact!="number"?(m.mandatory=m.mandatory||{},m.mandatory[x("",g)]=y.exact):["min","max"].forEach(S=>{y[S]!==void 0&&(m.mandatory=m.mandatory||{},m.mandatory[x(S,g)]=y[S])})}),p.advanced&&(m.optional=(m.optional||[]).concat(p.advanced)),m},l=function(p,m){if(r.version>=61)return m(p);if((p=JSON.parse(JSON.stringify(p)))&&typeof p.audio=="object"){const g=function(y,x,S){x in y&&!(S in y)&&(y[S]=y[x],delete y[x])};g((p=JSON.parse(JSON.stringify(p))).audio,"autoGainControl","googAutoGainControl"),g(p.audio,"noiseSuppression","googNoiseSuppression"),p.audio=a(p.audio)}if(p&&typeof p.video=="object"){let g=p.video.facingMode;g=g&&(typeof g=="object"?g:{ideal:g});const y=r.version<66;if(g&&(g.exact==="user"||g.exact==="environment"||g.ideal==="user"||g.ideal==="environment")&&(!i.mediaDevices.getSupportedConstraints||!i.mediaDevices.getSupportedConstraints().facingMode||y)){let x;if(delete p.video.facingMode,g.exact==="environment"||g.ideal==="environment"?x=["back","rear"]:g.exact!=="user"&&g.ideal!=="user"||(x=["front"]),x)return i.mediaDevices.enumerateDevices().then(S=>{S=S.filter(C=>C.kind==="videoinput");let T=S.find(C=>x.some(V=>{var j;return Ce(j=C.label.toLowerCase()).call(j,V)}));return!T&&S.length&&Ce(x).call(x,"back")&&(T=S[S.length-1]),T&&(p.video.deviceId=g.exact?{exact:T.deviceId}:{ideal:T.deviceId}),p.video=a(p.video),KU("chrome: "+JSON.stringify(p)),m(p)})}p.video=a(p.video)}return KU("chrome: "+JSON.stringify(p)),m(p)},u=function(p){return r.version>=64?p:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[p.name]||p.name,message:p.message,constraint:p.constraint||p.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(i.getUserMedia=(function(p,m,g){l(p,y=>{i.webkitGetUserMedia(y,m,x=>{g&&g(u(x))})})}).bind(i),i.mediaDevices.getUserMedia){const p=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(m){return l(m,g=>p(g).then(y=>{if(g.audio&&!y.getAudioTracks().length||g.video&&!y.getVideoTracks().length)throw y.getTracks().forEach(x=>{x.stop()}),new DOMException("","NotFoundError");return y},y=>je.reject(u(y))))}}}function qU(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function XU(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(i){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=i)},enumerable:!0,configurable:!0});const r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",a=>{let l;l=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(p=>p.track&&p.track.id===a.track.id):{track:a.track};const u=new Event("track");u.track=a.track,u.receiver=l,u.transceiver={receiver:l},u.streams=[i.stream],this.dispatchEvent(u)}),i.stream.getTracks().forEach(a=>{let l;l=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(p=>p.track&&p.track.id===a.id):{track:a};const u=new Event("track");u.track=a,u.receiver=l,u.transceiver={receiver:l},u.streams=[i.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else Du(t,"track",r=>(r.transceiver||Object.defineProperty(r,"transceiver",{value:{receiver:r.receiver}}),r))}function JU(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const r=function(l,u){return{track:u,get dtmf(){return this._dtmf===void 0&&(u.kind==="audio"?this._dtmf=l.createDTMFSender(u):this._dtmf=null),this._dtmf},_pc:l}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const l=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(p,m){let g=l.apply(this,arguments);return g||(g=r(this,p),this._senders.push(g)),g};const u=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(p){u.apply(this,arguments);const m=this._senders.indexOf(p);m!==-1&&this._senders.splice(m,1)}}const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],i.apply(this,[l]),l.getTracks().forEach(u=>{this._senders.push(r(this,u))})};const a=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],a.apply(this,[l]),l.getTracks().forEach(u=>{const p=this._senders.find(m=>m.track===u);p&&this._senders.splice(this._senders.indexOf(p),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const r=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=r.apply(this,[]);return i.forEach(a=>a._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function QU(t){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[i,a,l]=arguments;if(arguments.length>0&&typeof i=="function")return r.apply(this,arguments);if(r.length===0&&(arguments.length===0||typeof i!="function"))return r.apply(this,[]);const u=function(m){const g={};return m.result().forEach(y=>{const x={id:y.id,timestamp:y.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[y.type]||y.type};y.names().forEach(S=>{x[S]=y.stat(S)}),g[x.id]=x}),g},p=function(m){return new Map(Object.keys(m).map(g=>[g,m[g]]))};if(arguments.length>=2){const m=function(g){a(p(u(g)))};return r.apply(this,[m,i])}return new je((m,g)=>{r.apply(this,[function(y){m(p(u(y)))},g])}).then(a,l)}}function ZU(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const i=t.RTCPeerConnection.prototype.getSenders;i&&(t.RTCPeerConnection.prototype.getSenders=function(){const l=i.apply(this,[]);return l.forEach(u=>u._pc=this),l});const a=t.RTCPeerConnection.prototype.addTrack;a&&(t.RTCPeerConnection.prototype.addTrack=function(){const l=a.apply(this,arguments);return l._pc=this,l}),t.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(u=>HU(u,l.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const i=t.RTCPeerConnection.prototype.getReceivers;i&&(t.RTCPeerConnection.prototype.getReceivers=function(){const a=i.apply(this,[]);return a.forEach(l=>l._pc=this),a}),Du(t,"track",a=>(a.receiver._pc=a.srcElement,a)),t.RTCRtpReceiver.prototype.getStats=function(){const a=this;return this._pc.getStats().then(l=>HU(l,a.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype)||!("getStats"in t.RTCRtpReceiver.prototype))return;const r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let a,l,u;return this.getSenders().forEach(p=>{p.track===i&&(a?u=!0:a=p)}),this.getReceivers().forEach(p=>(p.track===i&&(l?u=!0:l=p),p.track===i)),u||a&&l?je.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):a?a.getStats():l?l.getStats():je.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}}function e4(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(u,p){if(!p)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const m=r.apply(this,arguments);return this._shimmedLocalStreams[p.id]?this._shimmedLocalStreams[p.id].indexOf(m)===-1&&this._shimmedLocalStreams[p.id].push(m):this._shimmedLocalStreams[p.id]=[p,m],m};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(g=>{if(this.getSenders().find(x=>x.track===g))throw new DOMException("Track already exists.","InvalidAccessError")});const p=this.getSenders();i.apply(this,arguments);const m=this.getSenders().filter(g=>p.indexOf(g)===-1);this._shimmedLocalStreams[u.id]=[u].concat(m)};const a=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],a.apply(this,arguments)};const l=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(p=>{const m=this._shimmedLocalStreams[p].indexOf(u);m!==-1&&this._shimmedLocalStreams[p].splice(m,1),this._shimmedLocalStreams[p].length===1&&delete this._shimmedLocalStreams[p]}),l.apply(this,arguments)}}function t4(t,r){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&r.version>=65)return e4(t);const i=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const g=i.apply(this);return this._reverseStreams=this._reverseStreams||{},g.map(y=>this._reverseStreams[y.id])};const a=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(g){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},g.getTracks().forEach(y=>{if(this.getSenders().find(S=>S.track===y))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[g.id]){const y=new t.MediaStream(g.getTracks());this._streams[g.id]=y,this._reverseStreams[y.id]=g,g=y}a.apply(this,[g])};const l=t.RTCPeerConnection.prototype.removeStream;function u(g,y){let x=y.sdp;return Object.keys(g._reverseStreams||[]).forEach(S=>{const T=g._reverseStreams[S],C=g._streams[T.id];x=x.replace(new RegExp(C.id,"g"),T.id)}),new RTCSessionDescription({type:y.type,sdp:x})}t.RTCPeerConnection.prototype.removeStream=function(g){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},l.apply(this,[this._streams[g.id]||g]),delete this._reverseStreams[this._streams[g.id]?this._streams[g.id].id:g.id],delete this._streams[g.id]},t.RTCPeerConnection.prototype.addTrack=function(g,y){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const x=[].slice.call(arguments,1);if(x.length!==1||!x[0].getTracks().find(C=>C===g))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(C=>C.track===g))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const T=this._streams[y.id];if(T)T.addTrack(g),je.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const C=new t.MediaStream([g]);this._streams[y.id]=C,this._reverseStreams[C.id]=y,this.addStream(C)}return this.getSenders().find(C=>C.track===g)},["createOffer","createAnswer"].forEach(function(g){const y=t.RTCPeerConnection.prototype[g],x={[g](){const S=arguments;return arguments.length&&typeof arguments[0]=="function"?y.apply(this,[T=>{const C=u(this,T);S[0].apply(null,[C])},T=>{S[1]&&S[1].apply(null,T)},arguments[2]]):y.apply(this,arguments).then(T=>u(this,T))}};t.RTCPeerConnection.prototype[g]=x[g]});const p=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(g,y){let x=y.sdp;return Object.keys(g._reverseStreams||[]).forEach(S=>{const T=g._reverseStreams[S],C=g._streams[T.id];x=x.replace(new RegExp(T.id,"g"),C.id)}),new RTCSessionDescription({type:y.type,sdp:x})}(this,arguments[0]),p.apply(this,arguments)):p.apply(this,arguments)};const m=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const g=m.get.apply(this);return g.type===""?g:u(this,g)}}),t.RTCPeerConnection.prototype.removeTrack=function(g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!g._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(g._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let y;this._streams=this._streams||{},Object.keys(this._streams).forEach(x=>{this._streams[x].getTracks().find(S=>g.track===S)&&(y=this._streams[x])}),y&&(y.getTracks().length===1?this.removeStream(this._reverseStreams[y.id]):y.removeTrack(g.track),this.dispatchEvent(new Event("negotiationneeded")))}}function mR(t,r){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const a=t.RTCPeerConnection.prototype[i],l={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=l[i]})}function n4(t,r){Du(t,"negotiationneeded",i=>{const a=i.target;if(!(r.version<72||a.getConfiguration&&a.getConfiguration().sdpSemantics==="plan-b")||a.signalingState==="stable")return i})}var r4=Object.freeze({__proto__:null,fixNegotiationNeeded:n4,shimAddTrackRemoveTrack:t4,shimAddTrackRemoveTrackWithNative:e4,shimGetDisplayMedia:function(t,r){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(typeof r=="function"?t.navigator.mediaDevices.getDisplayMedia=function(i){return r(i).then(a=>{const l=i.video&&i.video.width,u=i.video&&i.video.height,p=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:p||3}},l&&(i.video.mandatory.maxWidth=l),u&&(i.video.mandatory.maxHeight=u),t.navigator.mediaDevices.getUserMedia(i)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:JU,shimGetStats:QU,shimGetUserMedia:YU,shimMediaStream:qU,shimOnTrack:XU,shimPeerConnection:mR,shimSenderReceiverGetStats:ZU});function i4(t,r){const i=t&&t.navigator,a=t&&t.MediaStreamTrack;if(i.getUserMedia=function(l,u,p){hR("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(l).then(u,p)},!(r.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const l=function(p,m,g){m in p&&!(g in p)&&(p[g]=p[m],delete p[m])},u=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(p){return typeof p=="object"&&typeof p.audio=="object"&&(p=JSON.parse(JSON.stringify(p)),l(p.audio,"autoGainControl","mozAutoGainControl"),l(p.audio,"noiseSuppression","mozNoiseSuppression")),u(p)},a&&a.prototype.getSettings){const p=a.prototype.getSettings;a.prototype.getSettings=function(){const m=p.apply(this,arguments);return l(m,"mozAutoGainControl","autoGainControl"),l(m,"mozNoiseSuppression","noiseSuppression"),m}}if(a&&a.prototype.applyConstraints){const p=a.prototype.applyConstraints;a.prototype.applyConstraints=function(m){return this.kind==="audio"&&typeof m=="object"&&(m=JSON.parse(JSON.stringify(m)),l(m,"autoGainControl","mozAutoGainControl"),l(m,"noiseSuppression","mozNoiseSuppression")),p.apply(this,[m])}}}}function s4(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fR(t,r){if(typeof t!="object"||!t.RTCPeerConnection&&!t.mozRTCPeerConnection)return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],p={[l](){return arguments[0]=new(l==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),u.apply(this,arguments)}};t.RTCPeerConnection.prototype[l]=p[l]});const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[l,u,p]=arguments;return a.apply(this,[l||null]).then(m=>{if(r.version<53&&!u)try{m.forEach(g=>{g.type=i[g.type]||g.type})}catch(g){if(g.name!=="TypeError")throw g;m.forEach((y,x)=>{m.set(x,Object.assign({},y,{type:i[y.type]||y.type}))})}return m}).then(u,p)}}function a4(t){if(typeof t!="object"||!t.RTCPeerConnection||!t.RTCRtpSender||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function(){const a=r.apply(this,[]);return a.forEach(l=>l._pc=this),a});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const a=i.apply(this,arguments);return a._pc=this,a}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):je.resolve(new Map)}}function o4(t){if(typeof t!="object"||!t.RTCPeerConnection||!t.RTCRtpSender||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=r.apply(this,[]);return i.forEach(a=>a._pc=this),i}),Du(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function c4(t){t.RTCPeerConnection&&!("removeStream"in t.RTCPeerConnection.prototype)&&(t.RTCPeerConnection.prototype.removeStream=function(r){hR("removeStream","removeTrack"),this.getSenders().forEach(i=>{var a;i.track&&Ce(a=r.getTracks()).call(a,i.track)&&this.removeTrack(i)})})}function l4(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function d4(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.addTransceiver;r&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const a=i.length>0;a&&i.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=r.apply(this,arguments);if(a){const{sender:u}=l,p=u.getParameters();(!("encodings"in p)||p.encodings.length===1&&Object.keys(p.encodings[0]).length===0)&&(p.encodings=i,u.sendEncodings=i,this.setParametersPromises.push(u.setParameters(p).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return l})}function u4(t){if(typeof t!="object"||!t.RTCRtpSender)return;const r=t.RTCRtpSender.prototype.getParameters;r&&(t.RTCRtpSender.prototype.getParameters=function(){const i=r.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function h4(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?je.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}function p4(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?je.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}var m4=Object.freeze({__proto__:null,shimAddTransceiver:d4,shimCreateAnswer:p4,shimCreateOffer:h4,shimGetDisplayMedia:function(t,r){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!i||!i.video){const a=new DOMException("getDisplayMedia without video constraints is undefined");return a.name="NotFoundError",a.code=8,je.reject(a)}return i.video===!0?i.video={mediaSource:r}:i.video.mediaSource=r,t.navigator.mediaDevices.getUserMedia(i)})},shimGetParameters:u4,shimGetUserMedia:i4,shimOnTrack:s4,shimPeerConnection:fR,shimRTCDataChannel:l4,shimReceiverGetStats:o4,shimRemoveStream:c4,shimSenderGetStats:a4});function f4(t){if(typeof t=="object"&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){var a;this._localStreams||(this._localStreams=[]),Ce(a=this._localStreams).call(a,i)||this._localStreams.push(i),i.getAudioTracks().forEach(l=>r.call(this,l,i)),i.getVideoTracks().forEach(l=>r.call(this,l,i))},t.RTCPeerConnection.prototype.addTrack=function(i){for(var a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];return l&&l.forEach(p=>{var m;this._localStreams?Ce(m=this._localStreams).call(m,p)||this._localStreams.push(p):this._localStreams=[p]}),r.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(r){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(r);if(i===-1)return;this._localStreams.splice(i,1);const a=r.getTracks();this.getSenders().forEach(l=>{Ce(a).call(a,l.track)&&this.removeTrack(l)})})}}function g4(t){if(typeof t=="object"&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(i){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=i),this.addEventListener("track",this._onaddstreampoly=a=>{a.streams.forEach(l=>{var u;if(this._remoteStreams||(this._remoteStreams=[]),Ce(u=this._remoteStreams).call(u,l))return;this._remoteStreams.push(l);const p=new Event("addstream");p.stream=l,this.dispatchEvent(p)})})}});const r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(l=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(l)>=0)return;i._remoteStreams.push(l);const u=new Event("addstream");u.stream=l,i.dispatchEvent(u)})}),r.apply(i,arguments)}}}function v4(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.createOffer,a=r.createAnswer,l=r.setLocalDescription,u=r.setRemoteDescription,p=r.addIceCandidate;r.createOffer=function(g,y){const x=arguments.length>=2?arguments[2]:arguments[0],S=i.apply(this,[x]);return y?(S.then(g,y),je.resolve()):S},r.createAnswer=function(g,y){const x=arguments.length>=2?arguments[2]:arguments[0],S=a.apply(this,[x]);return y?(S.then(g,y),je.resolve()):S};let m=function(g,y,x){const S=l.apply(this,[g]);return x?(S.then(y,x),je.resolve()):S};r.setLocalDescription=m,m=function(g,y,x){const S=u.apply(this,[g]);return x?(S.then(y,x),je.resolve()):S},r.setRemoteDescription=m,m=function(g,y,x){const S=p.apply(this,[g]);return x?(S.then(y,x),je.resolve()):S},r.addIceCandidate=m}function y4(t){const r=t&&t.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){const i=r.mediaDevices,a=i.getUserMedia.bind(i);r.mediaDevices.getUserMedia=l=>a(b4(l))}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=(function(i,a,l){r.mediaDevices.getUserMedia(i).then(a,l)}).bind(r))}function b4(t){return t&&t.video!==void 0?Object.assign({},t,{video:zU(t.video)}):t}function x4(t){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection;t.RTCPeerConnection=function(i,a){if(i&&i.iceServers){const l=[];for(let u=0;u<i.iceServers.length;u++){let p=i.iceServers[u];!p.hasOwnProperty("urls")&&p.hasOwnProperty("url")?(hR("RTCIceServer.url","RTCIceServer.urls"),p=JSON.parse(JSON.stringify(p)),p.urls=p.url,delete p.url,l.push(p)):l.push(i.iceServers[u])}i.iceServers=l}return new r(i,a)},t.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:()=>r.generateCertificate})}function _4(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function E4(t){const r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){i.offerToReceiveAudio!==void 0&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const a=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):i.offerToReceiveAudio!==!0||a||this.addTransceiver("audio",{direction:"recvonly"}),i.offerToReceiveVideo!==void 0&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const l=this.getTransceivers().find(u=>u.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):i.offerToReceiveVideo!==!0||l||this.addTransceiver("video",{direction:"recvonly"})}return r.apply(this,arguments)}}function w4(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var S4=Object.freeze({__proto__:null,shimAudioContext:w4,shimCallbacksAPI:v4,shimConstraints:b4,shimCreateOfferLegacy:E4,shimGetUserMedia:y4,shimLocalStreamsAPI:f4,shimRTCIceServerUrls:x4,shimRemoteStreamsAPI:g4,shimTrackEventTransceiver:_4}),T4=`	
\v\f\r \u2028\u2029\uFEFF`,Ghe=st,Whe=Ts,gR=T4,N4=E("".replace),$he=RegExp("^["+gR+"]+"),zhe=RegExp("(^|[^"+gR+"])["+gR+"]+$"),Hhe=function(t){return function(r){var i=Whe(Ghe(r));return 1&t&&(i=N4(i,$he,"")),2&t&&(i=N4(i,zhe,"$1")),i}},Khe={trim:Hhe(3)},Yhe=cM.PROPER,qhe=h,C4=T4,Xhe=Khe.trim;en({target:"String",proto:!0,forced:function(t){return qhe(function(){return!!C4[t]()||""[t]()!==""||Yhe&&C4[t].name!==t})}("trim")},{trim:function(){return Xhe(this)}});var Jhe=ha("String","trim"),Qhe=N,Zhe=Jhe,vR=String.prototype,epe=function(t){var r=t.trim;return typeof t=="string"||t===vR||Qhe(vR,t)&&r===vR.trim?Zhe:r},Ii=d(epe),R4={exports:{}};(function(t){const r={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};r.localCName=r.generateIdentifier(),r.splitLines=function(i){return i.trim().split(`
`).map(a=>a.trim())},r.splitSections=function(i){return i.split(`
m=`).map((a,l)=>(l>0?"m="+a:a).trim()+`\r
`)},r.getDescription=function(i){const a=r.splitSections(i);return a&&a[0]},r.getMediaSections=function(i){const a=r.splitSections(i);return a.shift(),a},r.matchPrefix=function(i,a){return r.splitLines(i).filter(l=>l.indexOf(a)===0)},r.parseCandidate=function(i){let a;a=i.indexOf("a=candidate:")===0?i.substring(12).split(" "):i.substring(10).split(" ");const l={foundation:a[0],component:{1:"rtp",2:"rtcp"}[a[1]]||a[1],protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]};for(let u=8;u<a.length;u+=2)switch(a[u]){case"raddr":l.relatedAddress=a[u+1];break;case"rport":l.relatedPort=parseInt(a[u+1],10);break;case"tcptype":l.tcpType=a[u+1];break;case"ufrag":l.ufrag=a[u+1],l.usernameFragment=a[u+1];break;default:l[a[u]]===void 0&&(l[a[u]]=a[u+1])}return l},r.writeCandidate=function(i){const a=[];a.push(i.foundation);const l=i.component;l==="rtp"?a.push(1):l==="rtcp"?a.push(2):a.push(l),a.push(i.protocol.toUpperCase()),a.push(i.priority),a.push(i.address||i.ip),a.push(i.port);const u=i.type;return a.push("typ"),a.push(u),u!=="host"&&i.relatedAddress&&i.relatedPort&&(a.push("raddr"),a.push(i.relatedAddress),a.push("rport"),a.push(i.relatedPort)),i.tcpType&&i.protocol.toLowerCase()==="tcp"&&(a.push("tcptype"),a.push(i.tcpType)),(i.usernameFragment||i.ufrag)&&(a.push("ufrag"),a.push(i.usernameFragment||i.ufrag)),"candidate:"+a.join(" ")},r.parseIceOptions=function(i){return i.substring(14).split(" ")},r.parseRtpMap=function(i){let a=i.substring(9).split(" ");const l={payloadType:parseInt(a.shift(),10)};return a=a[0].split("/"),l.name=a[0],l.clockRate=parseInt(a[1],10),l.channels=a.length===3?parseInt(a[2],10):1,l.numChannels=l.channels,l},r.writeRtpMap=function(i){let a=i.payloadType;i.preferredPayloadType!==void 0&&(a=i.preferredPayloadType);const l=i.channels||i.numChannels||1;return"a=rtpmap:"+a+" "+i.name+"/"+i.clockRate+(l!==1?"/"+l:"")+`\r
`},r.parseExtmap=function(i){const a=i.substring(9).split(" ");return{id:parseInt(a[0],10),direction:a[0].indexOf("/")>0?a[0].split("/")[1]:"sendrecv",uri:a[1],attributes:a.slice(2).join(" ")}},r.writeExtmap=function(i){return"a=extmap:"+(i.id||i.preferredId)+(i.direction&&i.direction!=="sendrecv"?"/"+i.direction:"")+" "+i.uri+(i.attributes?" "+i.attributes:"")+`\r
`},r.parseFmtp=function(i){const a={};let l;const u=i.substring(i.indexOf(" ")+1).split(";");for(let p=0;p<u.length;p++)l=u[p].trim().split("="),a[l[0].trim()]=l[1];return a},r.writeFmtp=function(i){let a="",l=i.payloadType;if(i.preferredPayloadType!==void 0&&(l=i.preferredPayloadType),i.parameters&&Object.keys(i.parameters).length){const u=[];Object.keys(i.parameters).forEach(p=>{i.parameters[p]!==void 0?u.push(p+"="+i.parameters[p]):u.push(p)}),a+="a=fmtp:"+l+" "+u.join(";")+`\r
`}return a},r.parseRtcpFb=function(i){const a=i.substring(i.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}},r.writeRtcpFb=function(i){let a="",l=i.payloadType;return i.preferredPayloadType!==void 0&&(l=i.preferredPayloadType),i.rtcpFeedback&&i.rtcpFeedback.length&&i.rtcpFeedback.forEach(u=>{a+="a=rtcp-fb:"+l+" "+u.type+(u.parameter&&u.parameter.length?" "+u.parameter:"")+`\r
`}),a},r.parseSsrcMedia=function(i){const a=i.indexOf(" "),l={ssrc:parseInt(i.substring(7,a),10)},u=i.indexOf(":",a);return u>-1?(l.attribute=i.substring(a+1,u),l.value=i.substring(u+1)):l.attribute=i.substring(a+1),l},r.parseSsrcGroup=function(i){const a=i.substring(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(l=>parseInt(l,10))}},r.getMid=function(i){const a=r.matchPrefix(i,"a=mid:")[0];if(a)return a.substring(6)},r.parseFingerprint=function(i){const a=i.substring(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1].toUpperCase()}},r.getDtlsParameters=function(i,a){return{role:"auto",fingerprints:r.matchPrefix(i+a,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(i,a){let l="a=setup:"+a+`\r
`;return i.fingerprints.forEach(u=>{l+="a=fingerprint:"+u.algorithm+" "+u.value+`\r
`}),l},r.parseCryptoLine=function(i){const a=i.substring(9).split(" ");return{tag:parseInt(a[0],10),cryptoSuite:a[1],keyParams:a[2],sessionParams:a.slice(3)}},r.writeCryptoLine=function(i){return"a=crypto:"+i.tag+" "+i.cryptoSuite+" "+(typeof i.keyParams=="object"?r.writeCryptoKeyParams(i.keyParams):i.keyParams)+(i.sessionParams?" "+i.sessionParams.join(" "):"")+`\r
`},r.parseCryptoKeyParams=function(i){if(i.indexOf("inline:")!==0)return null;const a=i.substring(7).split("|");return{keyMethod:"inline",keySalt:a[0],lifeTime:a[1],mkiValue:a[2]?a[2].split(":")[0]:void 0,mkiLength:a[2]?a[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(i){return i.keyMethod+":"+i.keySalt+(i.lifeTime?"|"+i.lifeTime:"")+(i.mkiValue&&i.mkiLength?"|"+i.mkiValue+":"+i.mkiLength:"")},r.getCryptoParameters=function(i,a){return r.matchPrefix(i+a,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(i,a){const l=r.matchPrefix(i+a,"a=ice-ufrag:")[0],u=r.matchPrefix(i+a,"a=ice-pwd:")[0];return l&&u?{usernameFragment:l.substring(12),password:u.substring(10)}:null},r.writeIceParameters=function(i){let a="a=ice-ufrag:"+i.usernameFragment+`\r
a=ice-pwd:`+i.password+`\r
`;return i.iceLite&&(a+=`a=ice-lite\r
`),a},r.parseRtpParameters=function(i){const a={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},l=r.splitLines(i)[0].split(" ");a.profile=l[2];for(let p=3;p<l.length;p++){const m=l[p],g=r.matchPrefix(i,"a=rtpmap:"+m+" ")[0];if(g){const y=r.parseRtpMap(g),x=r.matchPrefix(i,"a=fmtp:"+m+" ");switch(y.parameters=x.length?r.parseFmtp(x[0]):{},y.rtcpFeedback=r.matchPrefix(i,"a=rtcp-fb:"+m+" ").map(r.parseRtcpFb),a.codecs.push(y),y.name.toUpperCase()){case"RED":case"ULPFEC":a.fecMechanisms.push(y.name.toUpperCase())}}}r.matchPrefix(i,"a=extmap:").forEach(p=>{a.headerExtensions.push(r.parseExtmap(p))});const u=r.matchPrefix(i,"a=rtcp-fb:* ").map(r.parseRtcpFb);return a.codecs.forEach(p=>{u.forEach(m=>{p.rtcpFeedback.find(g=>g.type===m.type&&g.parameter===m.parameter)||p.rtcpFeedback.push(m)})}),a},r.writeRtpDescription=function(i,a){let l="";l+="m="+i+" ",l+=a.codecs.length>0?"9":"0",l+=" "+(a.profile||"UDP/TLS/RTP/SAVPF")+" ",l+=a.codecs.map(p=>p.preferredPayloadType!==void 0?p.preferredPayloadType:p.payloadType).join(" ")+`\r
`,l+=`c=IN IP4 0.0.0.0\r
`,l+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,a.codecs.forEach(p=>{l+=r.writeRtpMap(p),l+=r.writeFmtp(p),l+=r.writeRtcpFb(p)});let u=0;return a.codecs.forEach(p=>{p.maxptime>u&&(u=p.maxptime)}),u>0&&(l+="a=maxptime:"+u+`\r
`),a.headerExtensions&&a.headerExtensions.forEach(p=>{l+=r.writeExtmap(p)}),l},r.parseRtpEncodingParameters=function(i){const a=[],l=r.parseRtpParameters(i),u=l.fecMechanisms.indexOf("RED")!==-1,p=l.fecMechanisms.indexOf("ULPFEC")!==-1,m=r.matchPrefix(i,"a=ssrc:").map(T=>r.parseSsrcMedia(T)).filter(T=>T.attribute==="cname"),g=m.length>0&&m[0].ssrc;let y;const x=r.matchPrefix(i,"a=ssrc-group:FID").map(T=>T.substring(17).split(" ").map(C=>parseInt(C,10)));x.length>0&&x[0].length>1&&x[0][0]===g&&(y=x[0][1]),l.codecs.forEach(T=>{if(T.name.toUpperCase()==="RTX"&&T.parameters.apt){let C={ssrc:g,codecPayloadType:parseInt(T.parameters.apt,10)};g&&y&&(C.rtx={ssrc:y}),a.push(C),u&&(C=JSON.parse(JSON.stringify(C)),C.fec={ssrc:g,mechanism:p?"red+ulpfec":"red"},a.push(C))}}),a.length===0&&g&&a.push({ssrc:g});let S=r.matchPrefix(i,"b=");return S.length&&(S=S[0].indexOf("b=TIAS:")===0?parseInt(S[0].substring(7),10):S[0].indexOf("b=AS:")===0?1e3*parseInt(S[0].substring(5),10)*.95-16e3:void 0,a.forEach(T=>{T.maxBitrate=S})),a},r.parseRtcpParameters=function(i){const a={},l=r.matchPrefix(i,"a=ssrc:").map(m=>r.parseSsrcMedia(m)).filter(m=>m.attribute==="cname")[0];l&&(a.cname=l.value,a.ssrc=l.ssrc);const u=r.matchPrefix(i,"a=rtcp-rsize");a.reducedSize=u.length>0,a.compound=u.length===0;const p=r.matchPrefix(i,"a=rtcp-mux");return a.mux=p.length>0,a},r.writeRtcpParameters=function(i){let a="";return i.reducedSize&&(a+=`a=rtcp-rsize\r
`),i.mux&&(a+=`a=rtcp-mux\r
`),i.ssrc!==void 0&&i.cname&&(a+="a=ssrc:"+i.ssrc+" cname:"+i.cname+`\r
`),a},r.parseMsid=function(i){let a;const l=r.matchPrefix(i,"a=msid:");if(l.length===1)return a=l[0].substring(7).split(" "),{stream:a[0],track:a[1]};const u=r.matchPrefix(i,"a=ssrc:").map(p=>r.parseSsrcMedia(p)).filter(p=>p.attribute==="msid");return u.length>0?(a=u[0].value.split(" "),{stream:a[0],track:a[1]}):void 0},r.parseSctpDescription=function(i){const a=r.parseMLine(i),l=r.matchPrefix(i,"a=max-message-size:");let u;l.length>0&&(u=parseInt(l[0].substring(19),10)),isNaN(u)&&(u=65536);const p=r.matchPrefix(i,"a=sctp-port:");if(p.length>0)return{port:parseInt(p[0].substring(12),10),protocol:a.fmt,maxMessageSize:u};const m=r.matchPrefix(i,"a=sctpmap:");if(m.length>0){const g=m[0].substring(10).split(" ");return{port:parseInt(g[0],10),protocol:g[1],maxMessageSize:u}}},r.writeSctpDescription=function(i,a){let l=[];return l=i.protocol!=="DTLS/SCTP"?["m="+i.kind+" 9 "+i.protocol+" "+a.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+a.port+`\r
`]:["m="+i.kind+" 9 "+i.protocol+" "+a.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+a.port+" "+a.protocol+` 65535\r
`],a.maxMessageSize!==void 0&&l.push("a=max-message-size:"+a.maxMessageSize+`\r
`),l.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,22)},r.writeSessionBoilerplate=function(i,a,l){let u;const p=a!==void 0?a:2;return u=i||r.generateSessionId(),`v=0\r
o=`+(l||"thisisadapterortc")+" "+u+" "+p+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},r.getDirection=function(i,a){const l=r.splitLines(i);for(let u=0;u<l.length;u++)switch(l[u]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return l[u].substring(2)}return a?r.getDirection(a):"sendrecv"},r.getKind=function(i){return r.splitLines(i)[0].split(" ")[0].substring(2)},r.isRejected=function(i){return i.split(" ",2)[1]==="0"},r.parseMLine=function(i){const a=r.splitLines(i)[0].substring(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}},r.parseOLine=function(i){const a=r.matchPrefix(i,"o=")[0].substring(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}},r.isValidSDP=function(i){if(typeof i!="string"||i.length===0)return!1;const a=r.splitLines(i);for(let l=0;l<a.length;l++)if(a[l].length<2||a[l].charAt(1)!=="=")return!1;return!0},t.exports=r})(R4);var A4=R4.exports,Vp=d(A4),tpe=s({__proto__:null,default:Vp},[A4]);function hx(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const r=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&((i=JSON.parse(JSON.stringify(i))).candidate=i.candidate.substr(2)),i.candidate&&i.candidate.length){const a=new r(i),l=Vp.parseCandidate(i.candidate),u=Object.assign(a,l);return u.toJSON=function(){return{candidate:u.candidate,sdpMid:u.sdpMid,sdpMLineIndex:u.sdpMLineIndex,usernameFragment:u.usernameFragment}},u}return new r(i)},t.RTCIceCandidate.prototype=r.prototype,Du(t,"icecandidate",i=>(i.candidate&&Object.defineProperty(i,"candidate",{value:new t.RTCIceCandidate(i.candidate),writable:"false"}),i))}function yR(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Du(t,"icecandidate",r=>{if(r.candidate){const i=Vp.parseCandidate(r.candidate.candidate);i.type==="relay"&&(r.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[i.priority>>24])}return r})}function px(t,r){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const i=function(m){if(!m||!m.sdp)return!1;const g=Vp.splitSections(m.sdp);return g.shift(),g.some(y=>{const x=Vp.parseMLine(y);return x&&x.kind==="application"&&x.protocol.indexOf("SCTP")!==-1})},a=function(m){const g=m.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(g===null||g.length<2)return-1;const y=parseInt(g[1],10);return y!=y?-1:y},l=function(m){let g=65536;return r.browser==="firefox"&&(g=r.version<57?m===-1?16384:2147483637:r.version<60?r.version===57?65535:65536:2147483637),g},u=function(m,g){let y=65536;r.browser==="firefox"&&r.version===57&&(y=65535);const x=Vp.matchPrefix(m.sdp,"a=max-message-size:");return x.length>0?y=parseInt(x[0].substr(19),10):r.browser==="firefox"&&g!==-1&&(y=2147483637),y},p=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r.browser==="chrome"&&r.version>=76){const{sdpSemantics:m}=this.getConfiguration();m==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){const m=a(arguments[0]),g=l(m),y=u(arguments[0],m);let x;x=g===0&&y===0?Number.POSITIVE_INFINITY:g===0||y===0?Math.max(g,y):Math.min(g,y);const S={};Object.defineProperty(S,"maxMessageSize",{get:()=>x}),this._sctp=S}return p.apply(this,arguments)}}function mx(t){if(!t.RTCPeerConnection||!("createDataChannel"in t.RTCPeerConnection.prototype))return;function r(a,l){const u=a.send;a.send=function(){const p=arguments[0],m=p.length||p.size||p.byteLength;if(a.readyState==="open"&&l.sctp&&m>l.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+l.sctp.maxMessageSize+" bytes)");return u.apply(a,arguments)}}const i=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const a=i.apply(this,arguments);return r(a,this),a},Du(t,"datachannel",a=>(r(a.channel,a.target),a))}function bR(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const r=t.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(i){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),i&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=i)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(i=>{const a=r[i];r[i]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=l=>{const u=l.target;if(u._lastConnectionState!==u.connectionState){u._lastConnectionState=u.connectionState;const p=new Event("connectionstatechange",l);u.dispatchEvent(p)}return l},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),a.apply(this,arguments)}})}function xR(t,r){if(!t.RTCPeerConnection||r.browser==="chrome"&&r.version>=71||r.browser==="safari"&&r.version>=605)return;const i=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(a){if(a&&a.sdp&&a.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=a.sdp.split(`
`).filter(u=>Ii(u).call(u)!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&a instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:a.type,sdp:l}):a.sdp=l}return i.apply(this,arguments)}}function fx(t,r){if(!t.RTCPeerConnection||!t.RTCPeerConnection.prototype)return;const i=t.RTCPeerConnection.prototype.addIceCandidate;i&&i.length!==0&&(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(r.browser==="chrome"&&r.version<78||r.browser==="firefox"&&r.version<68||r.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?je.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),je.resolve())})}function gx(t,r){if(!t.RTCPeerConnection||!t.RTCPeerConnection.prototype)return;const i=t.RTCPeerConnection.prototype.setLocalDescription;i&&i.length!==0&&(t.RTCPeerConnection.prototype.setLocalDescription=function(){let a=arguments[0]||{};if(typeof a!="object"||a.type&&a.sdp)return i.apply(this,arguments);if(a={type:a.type,sdp:a.sdp},!a.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":a.type="offer";break;default:a.type="answer"}return a.sdp||a.type!=="offer"&&a.type!=="answer"?i.apply(this,[a]):(a.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(l=>i.apply(this,[l]))})}var npe=Object.freeze({__proto__:null,removeExtmapAllowMixed:xR,shimAddIceCandidateNullOrEmpty:fx,shimConnectionState:bR,shimMaxMessageSize:px,shimParameterlessSetLocalDescription:gx,shimRTCIceCandidate:hx,shimRTCIceCandidateRelayProtocol:yR,shimSendThrowTypeError:mx});(function(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const i=WU,a=function(u){const p={browser:null,version:null};if(u===void 0||!u.navigator)return p.browser="Not a browser.",p;const{navigator:m}=u;if(m.mozGetUserMedia)p.browser="firefox",p.version=ux(m.userAgent,/Firefox\/(\d+)\./,1);else if(m.webkitGetUserMedia||u.isSecureContext===!1&&u.webkitRTCPeerConnection)p.browser="chrome",p.version=ux(m.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!u.RTCPeerConnection||!m.userAgent.match(/AppleWebKit\/(\d+)\./))return p.browser="Not a supported browser.",p;p.browser="safari",p.version=ux(m.userAgent,/AppleWebKit\/(\d+)\./,1),p.supportsUnifiedPlan=u.RTCRtpTransceiver&&"currentDirection"in u.RTCRtpTransceiver.prototype}return p}(t),l={browserDetails:a,commonShim:npe,extractVersion:ux,disableLog:Vhe,disableWarnings:Bhe,sdp:tpe};switch(a.browser){case"chrome":if(!r4||!mR||!r.shimChrome)return i("Chrome shim is not included in this adapter release."),l;if(a.version===null)return i("Chrome shim can not determine version, not shimming."),l;i("adapter.js shimming chrome."),l.browserShim=r4,fx(t,a),gx(t),YU(t,a),qU(t),mR(t,a),XU(t),t4(t,a),JU(t),QU(t),ZU(t),n4(t,a),hx(t),yR(t),bR(t),px(t,a),mx(t),xR(t,a);break;case"firefox":if(!m4||!fR||!r.shimFirefox)return i("Firefox shim is not included in this adapter release."),l;i("adapter.js shimming firefox."),l.browserShim=m4,fx(t,a),gx(t),i4(t,a),fR(t,a),s4(t),c4(t),a4(t),o4(t),l4(t),d4(t),u4(t),h4(t),p4(t),hx(t),bR(t),px(t,a),mx(t);break;case"safari":if(!S4||!r.shimSafari)return i("Safari shim is not included in this adapter release."),l;i("adapter.js shimming safari."),l.browserShim=S4,fx(t,a),gx(t),x4(t),E4(t),v4(t),f4(t),g4(t),_4(t),y4(t),w4(t),hx(t),yR(t),px(t,a),mx(t),xR(t,a);break;default:i("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var rpe=h,I4=R.RegExp,ipe=!rpe(function(){var t=!0;try{I4(".","d")}catch{t=!1}var r={},i="",a=t?"dgimsy":"gimsy",l=function(m,g){Object.defineProperty(r,m,{get:function(){return i+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var p in t&&(u.hasIndices="d"),u)l(p,u[p]);return Object.getOwnPropertyDescriptor(I4.prototype,"flags").get.call(r)!==a||i!==a}),spe=Ss,ape=he,ope=ui,cpe=N,O4={correct:ipe},lpe=function(){var t=spe(this),r="";return t.hasIndices&&(r+="d"),t.global&&(r+="g"),t.ignoreCase&&(r+="i"),t.multiline&&(r+="m"),t.dotAll&&(r+="s"),t.unicode&&(r+="u"),t.unicodeSets&&(r+="v"),t.sticky&&(r+="y"),r},dpe=RegExp.prototype,_R=O4.correct?function(t){return t.flags}:function(t){return O4.correct||!cpe(dpe,t)||ope(t,"flags")?t.flags:ape(lpe,t)},ER=E,upe=Math.floor,wR=ER("".charAt),hpe=ER("".replace),SR=ER("".slice),ppe=/\$([$&'`]|\d{1,2})/g,mpe=en,fpe=he,TR=E,P4=st,gpe=ae,vpe=Je,ype=CN,Bp=Ts,bpe=jg,xpe=_R,_pe=function(t,r,i,a,l,u){var p=i+t.length,m=a.length,g=ppe;return hpe(u,g,function(y,x){var S;switch(wR(x,0)){case"$":return"$";case"&":return t;case"`":return SR(r,0,i);case"'":return SR(r,p);case"<":S=l[SR(x,1,-1)];break;default:var T=+x;if(T===0)return y;if(T>m){var C=upe(T/10);return C===0?y:C<=m?a[C-1]===void 0?wR(x,1):a[C-1]+wR(x,1):y}S=a[T-1]}return S===void 0?"":S})},Epe=ar("replace"),wpe=TypeError,NR=TR("".indexOf),Spe=TR("".replace),k4=TR("".slice),Tpe=Math.max;mpe({target:"String",proto:!0},{replaceAll:function(t,r){var i,a,l,u,p,m,g,y,x,S,T=P4(this),C=0,V="";if(vpe(t)){if((i=ype(t))&&(a=Bp(P4(xpe(t))),!~NR(a,"g")))throw new wpe("`.replaceAll` does not allow non-global regexes");if(l=bpe(t,Epe))return fpe(l,t,T,r);if(i)return Spe(Bp(T),t,r)}for(u=Bp(T),p=Bp(t),(m=gpe(r))||(r=Bp(r)),g=p.length,y=Tpe(1,g),x=NR(u,p);x!==-1;)S=m?Bp(r(p,x,u)):_pe(p,u,x,[],void 0,r),V+=k4(u,C,x)+S,C=x+g,x=x+y>u.length?-1:NR(u,p,x+y);return C<u.length&&(V+=k4(u,C)),V}});var Npe=ha("String","replaceAll"),Cpe=N,Rpe=Npe,CR=String.prototype,Ape=function(t){var r=t.replaceAll;return typeof t=="string"||t===CR||Cpe(CR,t)&&r===CR.replaceAll?Rpe:r},Ipe=d(Ape),RR=R;en({global:!0,forced:RR.globalThis!==RR},{globalThis:RR});var j4=d(R),AR={exports:{}};(function(t,r){(function(i,a){var l="function",u="undefined",p="object",m="string",g="major",y="model",x="name",S="type",T="vendor",C="version",V="architecture",j="console",L="mobile",H="tablet",Y="smarttv",te="wearable",se="embedded",oe="Amazon",ne="Apple",de="ASUS",be="BlackBerry",Se="Browser",Be="Chrome",mt="Firefox",ut="Google",Tt="Honor",Et="Huawei",Xt="LG",An="Microsoft",_e="Motorola",Oe="Nvidia",He="OnePlus",we="Opera",k="OPPO",Z="Samsung",ie="Sharp",Ae="Sony",bt="Xiaomi",yn="Zebra",Nr="Facebook",Sa="Chromium OS",kd="Mac OS",gE=" Browser",Lm=function(lr){for(var gr={},Nn=0;Nn<lr.length;Nn++)gr[lr[Nn].toUpperCase()]=lr[Nn];return gr},vE=function(lr,gr){return typeof lr===m&&yh(gr).indexOf(yh(lr))!==-1},yh=function(lr){return lr.toLowerCase()},sv=function(lr,gr){if(typeof lr===m)return lr=lr.replace(/^\s\s*/,""),typeof gr===u?lr:lr.substring(0,500)},bh=function(lr,gr){for(var Nn,ps,Qo,Jn,_l,$t,Zo=0;Zo<gr.length&&!_l;){var xh=gr[Zo],Vc=gr[Zo+1];for(Nn=ps=0;Nn<xh.length&&!_l&&xh[Nn];)if(_l=xh[Nn++].exec(lr))for(Qo=0;Qo<Vc.length;Qo++)$t=_l[++ps],typeof(Jn=Vc[Qo])===p&&Jn.length>0?Jn.length===2?typeof Jn[1]==l?this[Jn[0]]=Jn[1].call(this,$t):this[Jn[0]]=Jn[1]:Jn.length===3?typeof Jn[1]!==l||Jn[1].exec&&Jn[1].test?this[Jn[0]]=$t?$t.replace(Jn[1],Jn[2]):a:this[Jn[0]]=$t?Jn[1].call(this,$t,Jn[2]):a:Jn.length===4&&(this[Jn[0]]=$t?Jn[3].call(this,$t.replace(Jn[1],Jn[2])):a):this[Jn]=$t||a;Zo+=2}},jd=function(lr,gr){for(var Nn in gr)if(typeof gr[Nn]===p&&gr[Nn].length>0){for(var ps=0;ps<gr[Nn].length;ps++)if(vE(gr[Nn][ps],lr))return Nn==="?"?a:Nn}else if(vE(gr[Nn],lr))return Nn==="?"?a:Nn;return gr.hasOwnProperty("*")?gr["*"]:lr},wz={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Sz={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[C,[x,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[C,[x,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[x,C],[/opios[\/ ]+([\w\.]+)/i],[C,[x,we+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[C,[x,we+" GX"]],[/\bopr\/([\w\.]+)/i],[C,[x,we]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[C,[x,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[C,[x,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[x,C],[/quark(?:pc)?\/([-\w\.]+)/i],[C,[x,"Quark"]],[/\bddg\/([\w\.]+)/i],[C,[x,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[C,[x,"UC"+Se]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[C,[x,"WeChat"]],[/konqueror\/([\w\.]+)/i],[C,[x,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[C,[x,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[C,[x,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[C,[x,"Smart Lenovo "+Se]],[/(avast|avg)\/([\w\.]+)/i],[[x,/(.+)/,"$1 Secure "+Se],C],[/\bfocus\/([\w\.]+)/i],[C,[x,mt+" Focus"]],[/\bopt\/([\w\.]+)/i],[C,[x,we+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[C,[x,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[C,[x,"Dolphin"]],[/coast\/([\w\.]+)/i],[C,[x,we+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[C,[x,"MIUI"+gE]],[/fxios\/([\w\.-]+)/i],[C,[x,mt]],[/\bqihoobrowser\/?([\w\.]*)/i],[C,[x,"360"]],[/\b(qq)\/([\w\.]+)/i],[[x,/(.+)/,"$1Browser"],C],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[x,/(.+)/,"$1"+gE],C],[/samsungbrowser\/([\w\.]+)/i],[C,[x,Z+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[C,[x,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[x,"Sogou Mobile"],C],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[x,C],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[x],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[C,x],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[x,Nr],C],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[x,C],[/\bgsa\/([\w\.]+) .*safari\//i],[C,[x,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[C,[x,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[C,[x,Be+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[x,Be+" WebView"],C],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[C,[x,"Android "+Se]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[x,C],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[C,[x,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[C,x],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[x,[C,jd,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[x,C],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[x,"Netscape"],C],[/(wolvic|librewolf)\/([\w\.]+)/i],[x,C],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[C,[x,mt+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[x,[C,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[x,[C,/master.|lts./,""]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[V,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[V,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[V,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[V,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[V,"arm"]],[/((ppc|powerpc)(64)?)( mac|;|\))/i],[[V,/ower/,"",yh]],[/ sun4\w[;\)]/i],[[V,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i],[[V,yh]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[y,[T,Z],[S,H]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[y,[T,Z],[S,L]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[y,[T,ne],[S,L]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[y,[T,ne],[S,H]],[/(macintosh);/i],[y,[T,ne]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[y,[T,ie],[S,L]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[y,[T,Tt],[S,H]],[/honor([-\w ]+)[;\)]/i],[y,[T,Tt],[S,L]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[y,[T,Et],[S,H]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[y,[T,Et],[S,L]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[y,/_/g," "],[T,bt],[S,H]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[y,/_/g," "],[T,bt],[S,L]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[y,[T,k],[S,L]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[y,[T,jd,{OnePlus:["304","403","203"],"*":k}],[S,H]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[y,[T,"Vivo"],[S,L]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[y,[T,"Realme"],[S,L]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto(?! 360)[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[y,[T,_e],[S,L]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[y,[T,_e],[S,H]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[y,[T,Xt],[S,H]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv|watch)\w+)/i,/\blg-?([\d\w]+) bui/i],[y,[T,Xt],[S,L]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[y,[T,"Lenovo"],[S,H]],[/(nokia) (t[12][01])/i],[T,y,[S,H]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*))/i],[[y,/_/g," "],[S,L],[T,"Nokia"]],[/(pixel (c|tablet))\b/i],[y,[T,ut],[S,H]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[y,[T,ut],[S,L]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[y,[T,Ae],[S,L]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[y,"Xperia Tablet"],[T,Ae],[S,H]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[y,[T,He],[S,L]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[y,[T,oe],[S,H]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[y,/(.+)/g,"Fire Phone $1"],[T,oe],[S,L]],[/(playbook);[-\w\),; ]+(rim)/i],[y,T,[S,H]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[y,[T,be],[S,L]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[y,[T,de],[S,H]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[y,[T,de],[S,L]],[/(nexus 9)/i],[y,[T,"HTC"],[S,H]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[T,[y,/_/g," "],[S,L]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[y,[T,"TCL"],[S,H]],[/(itel) ((\w+))/i],[[T,yh],y,[S,jd,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[y,[T,"Acer"],[S,H]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[y,[T,"Meizu"],[S,L]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[y,[T,"Ulefone"],[S,L]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[y,[T,"Energizer"],[S,L]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[y,[T,"Cat"],[S,L]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[y,[T,"Smartfren"],[S,L]],[/droid.+; (a(?:015|06[35]|142p?))/i],[y,[T,"Nothing"],[S,L]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[y,[T,"Archos"],[S,H]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[y,[T,"Archos"],[S,L]],[/(imo) (tab \w+)/i,/(infinix) (x1101b?)/i],[T,y,[S,H]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (hmd|imo) ([\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i,/(oppo) ?([\w ]+) bui/i],[T,y,[S,L]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[T,y,[S,H]],[/(surface duo)/i],[y,[T,An],[S,H]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[y,[T,"Fairphone"],[S,L]],[/(u304aa)/i],[y,[T,"AT&T"],[S,L]],[/\bsie-(\w*)/i],[y,[T,"Siemens"],[S,L]],[/\b(rct\w+) b/i],[y,[T,"RCA"],[S,H]],[/\b(venue[\d ]{2,7}) b/i],[y,[T,"Dell"],[S,H]],[/\b(q(?:mv|ta)\w+) b/i],[y,[T,"Verizon"],[S,H]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[y,[T,"Barnes & Noble"],[S,H]],[/\b(tm\d{3}\w+) b/i],[y,[T,"NuVision"],[S,H]],[/\b(k88) b/i],[y,[T,"ZTE"],[S,H]],[/\b(nx\d{3}j) b/i],[y,[T,"ZTE"],[S,L]],[/\b(gen\d{3}) b.+49h/i],[y,[T,"Swiss"],[S,L]],[/\b(zur\d{3}) b/i],[y,[T,"Swiss"],[S,H]],[/\b((zeki)?tb.*\b) b/i],[y,[T,"Zeki"],[S,H]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[T,"Dragon Touch"],y,[S,H]],[/\b(ns-?\w{0,9}) b/i],[y,[T,"Insignia"],[S,H]],[/\b((nxa|next)-?\w{0,9}) b/i],[y,[T,"NextBook"],[S,H]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[T,"Voice"],y,[S,L]],[/\b(lvtel\-)?(v1[12]) b/i],[[T,"LvTel"],y,[S,L]],[/\b(ph-1) /i],[y,[T,"Essential"],[S,L]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[y,[T,"Envizen"],[S,H]],[/\b(trio[-\w\. ]+) b/i],[y,[T,"MachSpeed"],[S,H]],[/\btu_(1491) b/i],[y,[T,"Rotor"],[S,H]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[y,[T,Oe],[S,H]],[/(sprint) (\w+)/i],[T,y,[S,L]],[/(kin\.[onetw]{3})/i],[[y,/\./g," "],[T,An],[S,L]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[y,[T,yn],[S,H]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[y,[T,yn],[S,L]],[/smart-tv.+(samsung)/i],[T,[S,Y]],[/hbbtv.+maple;(\d+)/i],[[y,/^/,"SmartTV"],[T,Z],[S,Y]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[T,Xt],[S,Y]],[/(apple) ?tv/i],[T,[y,ne+" TV"],[S,Y]],[/crkey/i],[[y,Be+"cast"],[T,ut],[S,Y]],[/droid.+aft(\w+)( bui|\))/i],[y,[T,oe],[S,Y]],[/(shield \w+ tv)/i],[y,[T,Oe],[S,Y]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[y,[T,ie],[S,Y]],[/(bravia[\w ]+)( bui|\))/i],[y,[T,Ae],[S,Y]],[/(mi(tv|box)-?\w+) bui/i],[y,[T,bt],[S,Y]],[/Hbbtv.*(technisat) (.*);/i],[T,y,[S,Y]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[T,sv],[y,sv],[S,Y]],[/droid.+; ([\w- ]+) (?:android tv|smart[- ]?tv)/i],[y,[S,Y]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[S,Y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[T,y,[S,j]],[/droid.+; (shield)( bui|\))/i],[y,[T,Oe],[S,j]],[/(playstation \w+)/i],[y,[T,Ae],[S,j]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[y,[T,An],[S,j]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[y,[T,Z],[S,te]],[/((pebble))app/i,/(asus|google|lg|oppo) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[T,y,[S,te]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[y,[T,k],[S,te]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[y,[T,ne],[S,te]],[/(opwwe\d{3})/i],[y,[T,He],[S,te]],[/(moto 360)/i],[y,[T,_e],[S,te]],[/(smartwatch 3)/i],[y,[T,Ae],[S,te]],[/(g watch r)/i],[y,[T,Xt],[S,te]],[/droid.+; (wt63?0{2,3})\)/i],[y,[T,yn],[S,te]],[/droid.+; (glass) \d/i],[y,[T,ut],[S,te]],[/(pico) (4|neo3(?: link|pro)?)/i],[T,y,[S,te]],[/; (quest( \d| pro)?)/i],[y,[T,Nr],[S,te]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[T,[S,se]],[/(aeobc)\b/i],[y,[T,oe],[S,se]],[/(homepod).+mac os/i],[y,[T,ne],[S,se]],[/windows iot/i],[[S,se]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[y,[S,L]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[y,[S,H]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[S,H]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[S,L]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[y,[T,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[C,[x,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[x,C],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[C,[x,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[x,C],[/ladybird\//i],[[x,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[C,x]],os:[[/microsoft (windows) (vista|xp)/i],[x,C],[/(windows (?:phone(?: os)?|mobile|iot))[\/ ]?([\d\.\w ]*)/i],[x,[C,jd,wz]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[C,jd,wz],[x,"Windows"]],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[C,/_/g,"."],[x,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[x,kd],[C,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[C,x],[/(ubuntu) ([\w\.]+) like android/i],[[x,/(.+)/,"$1 Touch"],C],[/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\w*[-\/; ]?([\d\.]*)/i],[x,C],[/\(bb(10);/i],[C,[x,be]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[C,[x,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[C,[x,mt+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[C,[x,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[C,[x,"watchOS"]],[/crkey\/([\d\.]+)/i],[C,[x,Be+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[x,Sa],C],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux)(?: arm\w*| x86\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[x,C],[/(sunos) ?([\w\.\d]*)/i],[[x,"Solaris"],C],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[x,C]]},Jo=function(lr,gr){if(typeof lr===p&&(gr=lr,lr=a),!(this instanceof Jo))return new Jo(lr,gr).getResult();var Nn=typeof i!==u&&i.navigator?i.navigator:a,ps=lr||(Nn&&Nn.userAgent?Nn.userAgent:""),Qo=Nn&&Nn.userAgentData?Nn.userAgentData:a,Jn=gr?function($t,Zo){var xh={};for(var Vc in $t)Zo[Vc]&&Zo[Vc].length%2==0?xh[Vc]=Zo[Vc].concat($t[Vc]):xh[Vc]=$t[Vc];return xh}(Sz,gr):Sz,_l=Nn&&Nn.userAgent==ps;return this.getBrowser=function(){var $t={};return $t[x]=a,$t[C]=a,bh.call($t,ps,Jn.browser),$t[g]=function(Zo){return typeof Zo===m?Zo.replace(/[^\d\.]/g,"").split(".")[0]:a}($t[C]),_l&&Nn&&Nn.brave&&typeof Nn.brave.isBrave==l&&($t[x]="Brave"),$t},this.getCPU=function(){var $t={};return $t[V]=a,bh.call($t,ps,Jn.cpu),$t},this.getDevice=function(){var $t={};return $t[T]=a,$t[y]=a,$t[S]=a,bh.call($t,ps,Jn.device),_l&&!$t[S]&&Qo&&Qo.mobile&&($t[S]=L),_l&&$t[y]=="Macintosh"&&Nn&&typeof Nn.standalone!==u&&Nn.maxTouchPoints&&Nn.maxTouchPoints>2&&($t[y]="iPad",$t[S]=H),$t},this.getEngine=function(){var $t={};return $t[x]=a,$t[C]=a,bh.call($t,ps,Jn.engine),$t},this.getOS=function(){var $t={};return $t[x]=a,$t[C]=a,bh.call($t,ps,Jn.os),_l&&!$t[x]&&Qo&&Qo.platform&&Qo.platform!="Unknown"&&($t[x]=Qo.platform.replace(/chrome os/i,Sa).replace(/macos/i,kd)),$t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return ps},this.setUA=function($t){return ps=typeof $t===m&&$t.length>500?sv($t,500):$t,this},this.setUA(ps),this};Jo.VERSION="0.7.41",Jo.BROWSER=Lm([x,C,g]),Jo.CPU=Lm([V]),Jo.DEVICE=Lm([y,T,S,j,L,Y,H,te,se]),Jo.ENGINE=Jo.OS=Lm([x,C]),t.exports&&(r=t.exports=Jo),r.UAParser=Jo;var Mm=typeof i!==u&&(i.jQuery||i.Zepto);if(Mm&&!Mm.ua){var yE=new Jo;Mm.ua=yE.getResult(),Mm.ua.get=function(){return yE.getUA()},Mm.ua.set=function(lr){yE.setUA(lr);var gr=yE.getResult();for(var Nn in gr)Mm.ua[Nn]=gr[Nn]}}})(typeof window=="object"?window:o)})(AR,AR.exports);var Ope=d(AR.exports),D4=Wb.clear;en({global:!0,bind:!0,forced:R.clearImmediate!==D4},{clearImmediate:D4});var L4=R,Ppe=U,kpe=ae,jpe=ON,Dpe=on,Lpe=od,Mpe=Au,Upe=L4.Function,Fpe=/MSIE .\./.test(Dpe)||jpe==="BUN"&&function(){var t=L4.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),Vpe=en,M4=R,U4=Wb.set,Bpe=function(t,r){var i=1;return Fpe?function(a,l){var u=Mpe(arguments.length,1)>i,p=kpe(a)?a:Upe(a),m=u?Lpe(arguments,i):[],g=u?function(){Ppe(p,this,m)}:p;return t(g)}:t},F4=M4.setImmediate?Bpe(U4):U4;Vpe({global:!0,bind:!0,forced:M4.setImmediate!==F4},{setImmediate:F4});var V4=d(yt.setImmediate),Gpe=R,Wpe=KM,$pe=Vs,zpe=Au,Hpe=le;en({global:!0,dontCallGetSet:!0,forced:h(function(){return Hpe&&Object.getOwnPropertyDescriptor(Gpe,"queueMicrotask").value.length!==1})},{queueMicrotask:function(t){zpe(arguments.length,1),Wpe($pe(t))}});var B4=d(yt.queueMicrotask);function G4(t,r){return function(){return t.apply(r,arguments)}}const{toString:Kpe}=Object.prototype,{getPrototypeOf:IR}=Object,{iterator:vx,toStringTag:W4}=Symbol,yx=(OR=Object.create(null),t=>{const r=Kpe.call(t);return OR[r]||(OR[r]=r.slice(8,-1).toLowerCase())});var OR;const ko=t=>(t=t.toLowerCase(),r=>yx(r)===t),bx=t=>r=>typeof r===t,{isArray:Gp}=Array,Wp=bx("undefined");function r0(t){return t!==null&&!Wp(t)&&t.constructor!==null&&!Wp(t.constructor)&&Bs(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const $4=ko("ArrayBuffer"),Ype=bx("string"),Bs=bx("function"),z4=bx("number"),i0=t=>t!==null&&typeof t=="object",xx=t=>{if(yx(t)!=="object")return!1;const r=IR(t);return!(r!==null&&r!==Object.prototype&&Object.getPrototypeOf(r)!==null||W4 in t||vx in t)},qpe=ko("Date"),Xpe=ko("File"),Jpe=ko("Blob"),Qpe=ko("FileList"),Zpe=ko("URLSearchParams"),[eme,tme,nme,rme]=["ReadableStream","Request","Response","Headers"].map(ko);function s0(t,r){let i,a,{allOwnKeys:l=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(t!=null)if(typeof t!="object"&&(t=[t]),Gp(t))for(i=0,a=t.length;i<a;i++)r.call(null,t[i],i,t);else{if(r0(t))return;const u=l?Object.getOwnPropertyNames(t):Object.keys(t),p=u.length;let m;for(i=0;i<p;i++)m=u[i],r.call(null,t[m],m,t)}}function H4(t,r){if(r0(t))return null;r=r.toLowerCase();const i=Object.keys(t);let a,l=i.length;for(;l-- >0;)if(a=i[l],r===a.toLowerCase())return a;return null}const Lu=j4!==void 0?j4:typeof self<"u"?self:typeof window<"u"?window:Hd,K4=t=>!Wp(t)&&t!==Lu,ime=(PR=typeof Uint8Array<"u"&&IR(Uint8Array),t=>PR&&t instanceof PR);var PR;const sme=ko("HTMLFormElement"),Y4=(t=>{let{hasOwnProperty:r}=t;return(i,a)=>r.call(i,a)})(Object.prototype),ame=ko("RegExp"),q4=(t,r)=>{const i=Object.getOwnPropertyDescriptors(t),a={};s0(i,(l,u)=>{let p;(p=r(l,u,t))!==!1&&(a[u]=p||l)}),Object.defineProperties(t,a)},ome=ko("AsyncFunction"),X4=(J4=typeof V4=="function",Q4=Bs(Lu.postMessage),J4?V4:Q4?(kR="axios@".concat(Math.random()),_x=[],Lu.addEventListener("message",t=>{let{source:r,data:i}=t;r===Lu&&i===kR&&_x.length&&_x.shift()()},!1),t=>{_x.push(t),Lu.postMessage(kR,"*")}):t=>setTimeout(t));var J4,Q4,kR,_x;const cme=B4!==void 0?B4.bind(Lu):typeof process<"u"&&process.nextTick||X4;var Me={isArray:Gp,isArrayBuffer:$4,isBuffer:r0,isFormData:t=>{let r;return t&&(typeof FormData=="function"&&t instanceof FormData||Bs(t.append)&&((r=yx(t))==="formdata"||r==="object"&&Bs(t.toString)&&t.toString()==="[object FormData]"))},isArrayBufferView:function(t){let r;return r=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&$4(t.buffer),r},isString:Ype,isNumber:z4,isBoolean:t=>t===!0||t===!1,isObject:i0,isPlainObject:xx,isEmptyObject:t=>{if(!i0(t)||r0(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},isReadableStream:eme,isRequest:tme,isResponse:nme,isHeaders:rme,isUndefined:Wp,isDate:qpe,isFile:Xpe,isBlob:Jpe,isRegExp:ame,isFunction:Bs,isStream:t=>i0(t)&&Bs(t.pipe),isURLSearchParams:Zpe,isTypedArray:ime,isFileList:Qpe,forEach:s0,merge:function t(){const{caseless:r,skipUndefined:i}=K4(this)&&this||{},a={},l=(u,p)=>{const m=r&&H4(a,p)||p;xx(a[m])&&xx(u)?a[m]=t(a[m],u):xx(u)?a[m]=t({},u):Gp(u)?a[m]=u.slice():i&&Wp(u)||(a[m]=u)};for(let u=0,p=arguments.length;u<p;u++)arguments[u]&&s0(arguments[u],l);return a},extend:function(t,r,i){let{allOwnKeys:a}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return s0(r,(l,u)=>{i&&Bs(l)?t[u]=G4(l,i):t[u]=l},{allOwnKeys:a}),t},trim:t=>Ii(t)?Ii(t).call(t):t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),inherits:(t,r,i,a)=>{t.prototype=Object.create(r.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),i&&Object.assign(t.prototype,i)},toFlatObject:(t,r,i,a)=>{let l,u,p;const m={};if(r=r||{},t==null)return r;do{for(l=Object.getOwnPropertyNames(t),u=l.length;u-- >0;)p=l[u],a&&!a(p,t,r)||m[p]||(r[p]=t[p],m[p]=!0);t=i!==!1&&IR(t)}while(t&&(!i||i(t,r))&&t!==Object.prototype);return r},kindOf:yx,kindOfTest:ko,endsWith:(t,r,i)=>{t=String(t),(i===void 0||i>t.length)&&(i=t.length),i-=r.length;const a=t.indexOf(r,i);return a!==-1&&a===i},toArray:t=>{if(!t)return null;if(Gp(t))return t;let r=t.length;if(!z4(r))return null;const i=new Array(r);for(;r-- >0;)i[r]=t[r];return i},forEachEntry:(t,r)=>{const i=(t&&t[vx]).call(t);let a;for(;(a=i.next())&&!a.done;){const l=a.value;r.call(t,l[0],l[1])}},matchAll:(t,r)=>{let i;const a=[];for(;(i=t.exec(r))!==null;)a.push(i);return a},isHTMLForm:sme,hasOwnProperty:Y4,hasOwnProp:Y4,reduceDescriptors:q4,freezeMethods:t=>{q4(t,(r,i)=>{if(Bs(t)&&["arguments","caller","callee"].indexOf(i)!==-1)return!1;const a=t[i];Bs(a)&&(r.enumerable=!1,"writable"in r?r.writable=!1:r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")}))})},toObjectSet:(t,r)=>{const i={},a=l=>{l.forEach(u=>{i[u]=!0})};return Gp(t)?a(t):a(String(t).split(r)),i},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,a){return i.toUpperCase()+a}),noop:()=>{},toFiniteNumber:(t,r)=>t!=null&&Number.isFinite(t=+t)?t:r,findKey:H4,global:Lu,isContextDefined:K4,isSpecCompliantForm:function(t){return!!(t&&Bs(t.append)&&t[W4]==="FormData"&&t[vx])},toJSONObject:t=>{const r=new Array(10),i=(a,l)=>{if(i0(a)){if(r.indexOf(a)>=0)return;if(r0(a))return a;if(!("toJSON"in a)){r[l]=a;const u=Gp(a)?[]:{};return s0(a,(p,m)=>{const g=i(p,l+1);!Wp(g)&&(u[m]=g)}),r[l]=void 0,u}}return a};return i(t,0)},isAsyncFn:ome,isThenable:t=>t&&(i0(t)||Bs(t))&&Bs(t.then)&&Bs(t.catch),setImmediate:X4,asap:cme,isIterable:t=>t!=null&&Bs(t[vx])};function dn(t,r,i,a,l){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),i&&(this.config=i),a&&(this.request=a),l&&(this.response=l,this.status=l.status?l.status:null)}Me.inherits(dn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Me.toJSONObject(this.config),code:this.code,status:this.status}}});const Z4=dn.prototype,e3={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{e3[t]={value:t}}),Object.defineProperties(dn,e3),Object.defineProperty(Z4,"isAxiosError",{value:!0}),dn.from=(t,r,i,a,l,u)=>{const p=Object.create(Z4);Me.toFlatObject(t,p,function(y){return y!==Error.prototype},y=>y!=="isAxiosError");const m=t&&t.message?t.message:"Error",g=r==null&&t?t.code:r;return dn.call(p,m,g,i,a,l),t&&p.cause==null&&Object.defineProperty(p,"cause",{value:t,configurable:!0}),p.name=t&&t.name||"Error",u&&Object.assign(p,u),p};function jR(t){return Me.isPlainObject(t)||Me.isArray(t)}function t3(t){return Me.endsWith(t,"[]")?t.slice(0,-2):t}function n3(t,r,i){return t?t.concat(r).map(function(a,l){return a=t3(a),!i&&l?"["+a+"]":a}).join(i?".":""):r}const lme=Me.toFlatObject(Me,{},null,function(t){return/^is[A-Z]/.test(t)});function Ex(t,r,i){if(!Me.isObject(t))throw new TypeError("target must be an object");r=r||new FormData;const a=(i=Me.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,function(T,C){return!Me.isUndefined(C[T])})).metaTokens,l=i.visitor||y,u=i.dots,p=i.indexes,m=(i.Blob||typeof Blob<"u"&&Blob)&&Me.isSpecCompliantForm(r);if(!Me.isFunction(l))throw new TypeError("visitor must be a function");function g(T){if(T===null)return"";if(Me.isDate(T))return T.toISOString();if(Me.isBoolean(T))return T.toString();if(!m&&Me.isBlob(T))throw new dn("Blob is not supported. Use a Buffer instead.");return Me.isArrayBuffer(T)||Me.isTypedArray(T)?m&&typeof Blob=="function"?new Blob([T]):Buffer.from(T):T}function y(T,C,V){let j=T;if(T&&!V&&typeof T=="object"){if(Me.endsWith(C,"{}"))C=a?C:C.slice(0,-2),T=JSON.stringify(T);else if(Me.isArray(T)&&function(L){return Me.isArray(L)&&!L.some(jR)}(T)||(Me.isFileList(T)||Me.endsWith(C,"[]"))&&(j=Me.toArray(T)))return C=t3(C),j.forEach(function(L,H){!Me.isUndefined(L)&&L!==null&&r.append(p===!0?n3([C],H,u):p===null?C:C+"[]",g(L))}),!1}return!!jR(T)||(r.append(n3(V,C,u),g(T)),!1)}const x=[],S=Object.assign(lme,{defaultVisitor:y,convertValue:g,isVisitable:jR});if(!Me.isObject(t))throw new TypeError("data must be an object");return function T(C,V){if(!Me.isUndefined(C)){if(x.indexOf(C)!==-1)throw Error("Circular reference detected in "+V.join("."));x.push(C),Me.forEach(C,function(j,L){(!(Me.isUndefined(j)||j===null)&&l.call(r,j,Me.isString(L)?Ii(L).call(L):L,V,S))===!0&&T(j,V?V.concat(L):[L])}),x.pop()}}(t),r}function r3(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(i){return r[i]})}function DR(t,r){this._pairs=[],t&&Ex(t,this,r)}const i3=DR.prototype;function dme(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function s3(t,r,i){if(!r)return t;const a=i&&i.encode||dme;Me.isFunction(i)&&(i={serialize:i});const l=i&&i.serialize;let u;if(u=l?l(r,i):Me.isURLSearchParams(r)?r.toString():new DR(r,i).toString(a),u){const p=t.indexOf("#");p!==-1&&(t=t.slice(0,p)),t+=(t.indexOf("?")===-1?"?":"&")+u}return t}i3.append=function(t,r){this._pairs.push([t,r])},i3.toString=function(t){const r=t?function(i){return t.call(this,i,r3)}:r3;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};var a3=class{constructor(){this.handlers=[]}use(t,r,i){return this.handlers.push({fulfilled:t,rejected:r,synchronous:!!i&&i.synchronous,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Me.forEach(this.handlers,function(r){r!==null&&t(r)})}},o3={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},c3={exports:{}},ume=en,hme=le,l3=Ba.f;ume({target:"Object",stat:!0,forced:Object.defineProperty!==l3,sham:!hme},{defineProperty:l3});var d3=yt.Object,pme=c3.exports=function(t,r,i){return d3.defineProperty(t,r,i)};d3.defineProperty.sham&&(pme.sham=!0);var u3=d(c3.exports),mme=TypeError,h3=Ug,fme=Gb,gme=Je,vme=ar("species"),p3=Array,yme=function(t){var r;return h3(t)&&(r=t.constructor,(fme(r)&&(r===p3||h3(r.prototype))||gme(r)&&(r=r[vme])===null)&&(r=void 0)),r===void 0?p3:r},m3=function(t,r){return new(yme(t))(r===0?0:r)},bme=h,xme=Va,_me=ar("species"),f3=function(t){return xme>=51||!bme(function(){var r=[];return(r.constructor={})[_me]=function(){return{foo:1}},r[t](Boolean).foo!==1})},Eme=en,wme=h,Sme=Ug,Tme=Je,Nme=yc,Cme=id,g3=function(t){if(t>9007199254740991)throw mme("Maximum allowed index exceeded");return t},v3=$C,Rme=m3,Ame=f3,Ime=Va,y3=ar("isConcatSpreadable"),Ome=Ime>=51||!wme(function(){var t=[];return t[y3]=!1,t.concat()[0]!==t}),Pme=function(t){if(!Tme(t))return!1;var r=t[y3];return r!==void 0?!!r:Sme(t)};Eme({target:"Array",proto:!0,forced:!Ome||!Ame("concat")},{concat:function(t){var r,i,a,l,u,p=Nme(this),m=Rme(p,0),g=0;for(r=-1,a=arguments.length;r<a;r++)if(Pme(u=r===-1?p:arguments[r]))for(l=Cme(u),g3(g+l),i=0;i<l;i++,g++)i in u&&v3(m,g,u[i]);else g3(g+1),v3(m,g++,u);return m.length=g,m}});var b3={},kme=q,jme=Ke,x3=Nb.f,Dme=od,_3=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];b3.f=function(t){return _3&&kme(t)==="Window"?function(r){try{return x3(r)}catch{return Dme(_3)}}(t):x3(jme(t))};var $p={},Lme=ar;$p.f=Lme;var E3=yt,Mme=ui,Ume=$p,Fme=Ba.f,Gr=function(t){var r=E3.Symbol||(E3.Symbol={});Mme(r,t)||Fme(r,t,{value:Ume.f(t)})},Vme=he,Bme=Ne,Gme=ar,Wme=ad,w3=function(){var t=Bme("Symbol"),r=t&&t.prototype,i=r&&r.valueOf,a=Gme("toPrimitive");r&&!r[a]&&Wme(r,a,function(l){return Vme(i,this)},{})},$me=rd,zme=tt,Hme=yc,Kme=id,Yme=m3,S3=E([].push),qme=function(t){var r=t===1,i=t===2,a=t===3,l=t===4,u=t===6,p=t===7,m=t===5||u;return function(g,y,x,S){for(var T,C,V=Hme(g),j=zme(V),L=Kme(j),H=$me(y,x),Y=0,te=S||Yme,se=r?te(g,L):i||p?te(g,0):void 0;L>Y;Y++)if((m||Y in j)&&(C=H(T=j[Y],Y,V),t))if(r)se[Y]=C;else if(C)switch(t){case 3:return!0;case 5:return T;case 6:return Y;case 2:S3(se,T)}else switch(t){case 4:return!1;case 7:S3(se,T)}return u?-1:a||l?l:se}},T3={forEach:qme(0)},wx=en,a0=R,LR=he,Xme=E,zp=le,Hp=vc,Jme=h,Oi=ui,Qme=N,MR=Ss,Sx=Ke,UR=vN,Zme=Ts,FR=De,Kp=Vg,N3=Rb,efe=Nb,C3=b3,tfe=Fg,R3=ve,A3=Ba,nfe=UN,I3=J,O3=ad,rfe=Bb,VR=yp,P3=Cb,k3=fN,ife=ar,sfe=$p,afe=Gr,ofe=w3,cfe=ol,j3=Ru,Tx=T3.forEach,Gs=Tb("hidden"),Nx="Symbol",o0="prototype",lfe=j3.set,D3=j3.getterFor(Nx),jo=Object[o0],Mu=a0.Symbol,Cx=Mu&&Mu[o0],dfe=a0.RangeError,ufe=a0.TypeError,BR=a0.QObject,L3=R3.f,Uu=A3.f,M3=C3.f,hfe=I3.f,U3=Xme([].push),dl=VR("symbols"),c0=VR("op-symbols"),pfe=VR("wks"),GR=!BR||!BR[o0]||!BR[o0].findChild,F3=function(t,r,i){var a=L3(jo,r);a&&delete jo[r],Uu(t,r,i),a&&t!==jo&&Uu(jo,r,a)},WR=zp&&Jme(function(){return Kp(Uu({},"a",{get:function(){return Uu(this,"a",{value:7}).a}})).a!==7})?F3:Uu,$R=function(t,r){var i=dl[t]=Kp(Cx);return lfe(i,{type:Nx,tag:t,description:r}),zp||(i.description=r),i},Rx=function(t,r,i){t===jo&&Rx(c0,r,i),MR(t);var a=UR(r);return MR(i),Oi(dl,a)?(i.enumerable?(Oi(t,Gs)&&t[Gs][a]&&(t[Gs][a]=!1),i=Kp(i,{enumerable:FR(0,!1)})):(Oi(t,Gs)||Uu(t,Gs,FR(1,Kp(null))),t[Gs][a]=!0),WR(t,a,i)):Uu(t,a,i)},zR=function(t,r){MR(t);var i=Sx(r),a=N3(i).concat(W3(i));return Tx(a,function(l){zp&&!LR(V3,i,l)||Rx(t,l,i[l])}),t},V3=function(t){var r=UR(t),i=LR(hfe,this,r);return!(this===jo&&Oi(dl,r)&&!Oi(c0,r))&&(!(i||!Oi(this,r)||!Oi(dl,r)||Oi(this,Gs)&&this[Gs][r])||i)},B3=function(t,r){var i=Sx(t),a=UR(r);if(i!==jo||!Oi(dl,a)||Oi(c0,a)){var l=L3(i,a);return!l||!Oi(dl,a)||Oi(i,Gs)&&i[Gs][a]||(l.enumerable=!0),l}},G3=function(t){var r=M3(Sx(t)),i=[];return Tx(r,function(a){Oi(dl,a)||Oi(P3,a)||U3(i,a)}),i},W3=function(t){var r=t===jo,i=M3(r?c0:Sx(t)),a=[];return Tx(i,function(l){!Oi(dl,l)||r&&!Oi(jo,l)||U3(a,dl[l])}),a};Hp||(Mu=function(){if(Qme(Cx,this))throw new ufe("Symbol is not a constructor");var t=arguments.length&&arguments[0]!==void 0?Zme(arguments[0]):void 0,r=k3(t),i=function(a){var l=this===void 0?a0:this;l===jo&&LR(i,c0,a),Oi(l,Gs)&&Oi(l[Gs],r)&&(l[Gs][r]=!1);var u=FR(1,a);try{WR(l,r,u)}catch(p){if(!(p instanceof dfe))throw p;F3(l,r,u)}};return zp&&GR&&WR(jo,r,{configurable:!0,set:i}),$R(r,t)},O3(Cx=Mu[o0],"toString",function(){return D3(this).tag}),O3(Mu,"withoutSetter",function(t){return $R(k3(t),t)}),I3.f=V3,A3.f=Rx,nfe.f=zR,R3.f=B3,efe.f=C3.f=G3,tfe.f=W3,sfe.f=function(t){return $R(ife(t),t)},zp&&rfe(Cx,"description",{configurable:!0,get:function(){return D3(this).description}})),wx({global:!0,wrap:!0,forced:!Hp,sham:!Hp},{Symbol:Mu}),Tx(N3(pfe),function(t){afe(t)}),wx({target:Nx,stat:!0,forced:!Hp},{useSetter:function(){GR=!0},useSimple:function(){GR=!1}}),wx({target:"Object",stat:!0,forced:!Hp,sham:!zp},{create:function(t,r){return r===void 0?Kp(t):zR(Kp(t),r)},defineProperty:Rx,defineProperties:zR,getOwnPropertyDescriptor:B3}),wx({target:"Object",stat:!0,forced:!Hp},{getOwnPropertyNames:G3}),ofe(),cfe(Mu,Nx),P3[Gs]=!0;var $3=vc&&!!Symbol.for&&!!Symbol.keyFor,mfe=en,ffe=Ne,gfe=ui,vfe=Ts,z3=yp,yfe=$3,HR=z3("string-to-symbol-registry"),bfe=z3("symbol-to-string-registry");mfe({target:"Symbol",stat:!0,forced:!yfe},{for:function(t){var r=vfe(t);if(gfe(HR,r))return HR[r];var i=ffe("Symbol")(r);return HR[r]=i,bfe[i]=r,i}});var xfe=en,_fe=ui,Efe=kg,wfe=vp,Sfe=$3,H3=yp("symbol-to-string-registry");xfe({target:"Symbol",stat:!0,forced:!Sfe},{keyFor:function(t){if(!Efe(t))throw new TypeError(wfe(t)+" is not a symbol");if(_fe(H3,t))return H3[t]}});var K3=Ug,Tfe=ae,Y3=q,Nfe=Ts,q3=E([].push),Cfe=en,X3=Ne,J3=U,Rfe=he,l0=E,Q3=h,Z3=ae,eF=kg,tF=od,Afe=function(t){if(Tfe(t))return t;if(K3(t)){for(var r=t.length,i=[],a=0;a<r;a++){var l=t[a];typeof l=="string"?q3(i,l):typeof l!="number"&&Y3(l)!=="Number"&&Y3(l)!=="String"||q3(i,Nfe(l))}var u=i.length,p=!0;return function(m,g){if(p)return p=!1,g;if(K3(this))return g;for(var y=0;y<u;y++)if(i[y]===m)return g}}},Ife=vc,Ofe=String,pd=X3("JSON","stringify"),Ax=l0(/./.exec),nF=l0("".charAt),Pfe=l0("".charCodeAt),kfe=l0("".replace),jfe=l0(1.1.toString),Dfe=/[\uD800-\uDFFF]/g,rF=/^[\uD800-\uDBFF]$/,iF=/^[\uDC00-\uDFFF]$/,sF=!Ife||Q3(function(){var t=X3("Symbol")("stringify detection");return pd([t])!=="[null]"||pd({a:t})!=="{}"||pd(Object(t))!=="{}"}),aF=Q3(function(){return pd("\uDF06\uD834")!=='"\\udf06\\ud834"'||pd("\uDEAD")!=='"\\udead"'}),Lfe=function(t,r){var i=tF(arguments),a=Afe(r);if(Z3(a)||t!==void 0&&!eF(t))return i[1]=function(l,u){if(Z3(a)&&(u=Rfe(a,this,Ofe(l),u)),!eF(u))return u},J3(pd,null,i)},Mfe=function(t,r,i){var a=nF(i,r-1),l=nF(i,r+1);return Ax(rF,t)&&!Ax(iF,l)||Ax(iF,t)&&!Ax(rF,a)?"\\u"+jfe(Pfe(t,0),16):t};pd&&Cfe({target:"JSON",stat:!0,forced:sF||aF},{stringify:function(t,r,i){var a=tF(arguments),l=J3(sF?Lfe:pd,null,a);return aF&&typeof l=="string"?kfe(l,Dfe,Mfe):l}});var oF=Fg,Ufe=yc;en({target:"Object",stat:!0,forced:!vc||h(function(){oF.f(1)})},{getOwnPropertySymbols:function(t){var r=oF.f;return r?r(Ufe(t)):[]}}),Gr("asyncDispose"),Gr("asyncIterator"),Gr("dispose"),Gr("hasInstance"),Gr("isConcatSpreadable"),Gr("iterator"),Gr("match"),Gr("matchAll"),Gr("replace"),Gr("search"),Gr("species"),Gr("split");var Ffe=w3;Gr("toPrimitive"),Ffe();var Vfe=Ne,Bfe=ol;Gr("toStringTag"),Bfe(Vfe("Symbol"),"Symbol"),Gr("unscopables"),ol(R.JSON,"JSON",!0);var Gfe=yt.Symbol,Wfe=ar,$fe=Ba.f,cF=Wfe("metadata"),lF=Function.prototype;lF[cF]===void 0&&$fe(lF,cF,{value:null}),Gr("metadata");var zfe=Gfe,Hfe=E,KR=Ne("Symbol"),Kfe=KR.keyFor,Yfe=Hfe(KR.prototype.valueOf),dF=KR.isRegisteredSymbol||function(t){try{return Kfe(Yfe(t))!==void 0}catch{return!1}};en({target:"Symbol",stat:!0},{isRegisteredSymbol:dF});for(var qfe=yp,uF=Ne,Xfe=E,Jfe=kg,Qfe=ar,Ix=uF("Symbol"),hF=Ix.isWellKnownSymbol,pF=uF("Object","getOwnPropertyNames"),Zfe=Xfe(Ix.prototype.valueOf),mF=qfe("wks"),YR=0,fF=pF(Ix),ege=fF.length;YR<ege;YR++)try{var gF=fF[YR];Jfe(Ix[gF])&&Qfe(gF)}catch{}var vF=function(t){if(hF&&hF(t))return!0;try{for(var r=Zfe(t),i=0,a=pF(mF),l=a.length;i<l;i++)if(mF[a[i]]==r)return!0}catch{}return!1};en({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:vF}),Gr("customMatcher"),Gr("observable"),en({target:"Symbol",stat:!0},{isRegistered:dF}),en({target:"Symbol",stat:!0,forced:!0},{isWellKnown:vF}),Gr("matcher"),Gr("metadataKey"),Gr("patternMatch"),Gr("replaceAll");var Yp=d(zfe),yF=d($p.f("iterator"));function d0(t){return d0=typeof Yp=="function"&&typeof yF=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Yp=="function"&&r.constructor===Yp&&r!==Yp.prototype?"symbol":typeof r},d0(t)}var tge=d($p.f("toPrimitive"));function nge(t){var r=function(i,a){if(d0(i)!="object"||!i)return i;var l=i[tge];if(l!==void 0){var u=l.call(i,a);if(d0(u)!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(i)}(t,"string");return d0(r)=="symbol"?r:r+""}function F(t,r,i){return(r=nge(r))in t?u3(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t}var bF=d(Rue),rge={isBrowser:!0,classes:{URLSearchParams:bF!==void 0?bF:DR,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const qR=typeof window<"u"&&typeof document<"u",XR=typeof navigator=="object"&&navigator||void 0,ige=qR&&(!XR||["ReactNative","NativeScript","NS"].indexOf(XR.product)<0),sge=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",age=qR&&window.location.href||"http://localhost";function xF(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function _F(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?xF(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):xF(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}var cs=_F(_F({},Object.freeze({__proto__:null,hasBrowserEnv:qR,hasStandardBrowserEnv:ige,hasStandardBrowserWebWorkerEnv:sge,navigator:XR,origin:age})),rge);function EF(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function oge(t,r){return Ex(t,new cs.classes.URLSearchParams,function(i){for(var a=1;a<arguments.length;a++){var l=arguments[a]!=null?arguments[a]:{};a%2?EF(Object(l),!0).forEach(function(u){F(i,u,l[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(l)):EF(Object(l)).forEach(function(u){Object.defineProperty(i,u,Object.getOwnPropertyDescriptor(l,u))})}return i}({visitor:function(i,a,l,u){return cs.isNode&&Me.isBuffer(i)?(this.append(a,i.toString("base64")),!1):u.defaultVisitor.apply(this,arguments)}},r))}var cge=IC.charAt,wF=he,lge=Ss,dge=ae,uge=q,hge=/./.exec,pge=TypeError,mge=en,SF=he,TF=ce,fge=JN,Ox=Fb,NF=st,CF=wL,u0=Ts,gge=Ss,vge=Je,yge=q,bge=CN,RF=_R,xge=jg,_ge=h,Ege=rC,wge=function(t,r,i){return r+(i?cge(t,r).length:1)},Sge=function(t,r){var i=t.exec;if(dge(i)){var a=wF(i,t,r);return a!==null&&lge(a),a}if(uge(t)==="RegExp")return wF(hge,t,r);throw new pge("RegExp#exec called on incompatible receiver")},AF=Ru,Tge=ar("matchAll"),IF="RegExp String",OF=IF+" Iterator",Nge=AF.set,Cge=AF.getterFor(OF),Rge=TypeError,JR=TF("".indexOf),Px=TF("".matchAll),QR=!!Px&&!_ge(function(){Px("a",/./)}),Age=fge(function(t,r,i,a){Nge(this,{type:OF,regexp:t,string:r,global:i,unicode:a,done:!1})},IF,function(){var t=Cge(this);if(t.done)return Ox(void 0,!0);var r=t.regexp,i=t.string,a=Sge(r,i);return a===null?(t.done=!0,Ox(void 0,!0)):t.global?(u0(a[0])===""&&(r.lastIndex=wge(i,CF(r.lastIndex),t.unicode)),Ox(a,!1)):(t.done=!0,Ox(a,!1))}),PF=function(t){var r,i,a,l=gge(this),u=u0(t),p=Ege(l,RegExp),m=u0(RF(l));return r=new p(p===RegExp?l.source:l,m),i=!!~JR(m,"g"),a=!!~JR(m,"u"),r.lastIndex=CF(l.lastIndex),new Age(r,u,i,a)};mge({target:"String",proto:!0,forced:QR},{matchAll:function(t){var r,i,a,l,u=NF(this);if(vge(t)){if(bge(t)&&(r=u0(NF(RF(t))),!~JR(r,"g")))throw new Rge("`.matchAll` does not allow non-global regexes");if(QR)return Px(u,t);if((a=xge(t,Tge))===void 0&&yge(t)==="RegExp"&&(a=PF),a)return SF(a,t,u)}else if(QR)return Px(u,t);return i=u0(u),l=new RegExp(t,"g"),SF(PF,l,i)}});var Ige=ha("String","matchAll"),Oge=N,Pge=Ige,ZR=String.prototype,kge=function(t){var r=t.matchAll;return typeof t=="string"||t===ZR||Oge(ZR,t)&&r===ZR.matchAll?Pge:r},jge=d(kge);function kF(t){function r(i,a,l,u){let p=i[u++];if(p==="__proto__")return!0;const m=Number.isFinite(+p),g=u>=i.length;return p=!p&&Me.isArray(l)?l.length:p,g?(Me.hasOwnProp(l,p)?l[p]=[l[p],a]:l[p]=a,!m):(l[p]&&Me.isObject(l[p])||(l[p]=[]),r(i,a,l[p],u)&&Me.isArray(l[p])&&(l[p]=function(y){const x={},S=Object.keys(y);let T;const C=S.length;let V;for(T=0;T<C;T++)V=S[T],x[V]=y[V];return x}(l[p])),!m)}if(Me.isFormData(t)&&Me.isFunction(t.entries)){const i={};return Me.forEachEntry(t,(a,l)=>{r(function(u){return jge(Me).call(Me,/\w+|\[(\w*)]/g,u).map(p=>p[0]==="[]"?"":p[1]||p[0])}(a),l,i,0)}),i}return null}const eA={transitional:o3,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const i=r.getContentType()||"",a=i.indexOf("application/json")>-1,l=Me.isObject(t);if(l&&Me.isHTMLForm(t)&&(t=new FormData(t)),Me.isFormData(t))return a?JSON.stringify(kF(t)):t;if(Me.isArrayBuffer(t)||Me.isBuffer(t)||Me.isStream(t)||Me.isFile(t)||Me.isBlob(t)||Me.isReadableStream(t))return t;if(Me.isArrayBufferView(t))return t.buffer;if(Me.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(l){if(i.indexOf("application/x-www-form-urlencoded")>-1)return oge(t,this.formSerializer).toString();if((u=Me.isFileList(t))||i.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return Ex(u?{"files[]":t}:t,p&&new p,this.formSerializer)}}return l||a?(r.setContentType("application/json",!1),function(p,m,g){if(Me.isString(p))try{return(m||JSON.parse)(p),Ii(Me).call(Me,p)}catch(y){if(y.name!=="SyntaxError")throw y}return(g||JSON.stringify)(p)}(t)):t}],transformResponse:[function(t){const r=this.transitional||eA.transitional,i=r&&r.forcedJSONParsing,a=this.responseType==="json";if(Me.isResponse(t)||Me.isReadableStream(t))return t;if(t&&Me.isString(t)&&(i&&!this.responseType||a)){const l=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(u){if(l)throw u.name==="SyntaxError"?dn.from(u,dn.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:cs.classes.FormData,Blob:cs.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Me.forEach(["delete","get","head","post","put","patch"],t=>{eA.headers[t]={}});var tA=eA;const Dge=Me.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jF=Symbol("internals");function h0(t){var r;return t&&Ii(r=String(t)).call(r).toLowerCase()}function kx(t){return t===!1||t==null?t:Me.isArray(t)?t.map(kx):String(t)}function nA(t,r,i,a,l){return Me.isFunction(a)?a.call(this,r,i):(l&&(r=i),Me.isString(r)?Me.isString(a)?r.indexOf(a)!==-1:Me.isRegExp(a)?a.test(r):void 0:void 0)}class jx{constructor(r){r&&this.set(r)}set(r,i,a){const l=this;function u(g,y,x){const S=h0(y);if(!S)throw new Error("header name must be a non-empty string");const T=Me.findKey(l,S);(!T||l[T]===void 0||x===!0||x===void 0&&l[T]!==!1)&&(l[T||y]=kx(g))}const p=(g,y)=>Me.forEach(g,(x,S)=>u(x,S,y));if(Me.isPlainObject(r)||r instanceof this.constructor)p(r,i);else if(Me.isString(r)&&(r=Ii(r).call(r))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(Ii(m=r).call(m)))p((g=>{const y={};let x,S,T;return g&&g.split(`
`).forEach(function(C){var V,j;T=C.indexOf(":"),x=Ii(V=C.substring(0,T)).call(V).toLowerCase(),S=Ii(j=C.substring(T+1)).call(j),!x||y[x]&&Dge[x]||(x==="set-cookie"?y[x]?y[x].push(S):y[x]=[S]:y[x]=y[x]?y[x]+", "+S:S)}),y})(r),i);else if(Me.isObject(r)&&Me.isIterable(r)){let g,y,x={};for(const S of r){if(!Me.isArray(S))throw TypeError("Object iterator must return a key-value pair");x[y=S[0]]=(g=x[y])?Me.isArray(g)?[...g,S[1]]:[g,S[1]]:S[1]}p(x,i)}else r!=null&&u(i,r,a);var m;return this}get(r,i){if(r=h0(r)){const a=Me.findKey(this,r);if(a){const l=this[a];if(!i)return l;if(i===!0)return function(u){const p=Object.create(null),m=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let g;for(;g=m.exec(u);)p[g[1]]=g[2];return p}(l);if(Me.isFunction(i))return i.call(this,l,a);if(Me.isRegExp(i))return i.exec(l);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,i){if(r=h0(r)){const a=Me.findKey(this,r);return!(!a||this[a]===void 0||i&&!nA(0,this[a],a,i))}return!1}delete(r,i){const a=this;let l=!1;function u(p){if(p=h0(p)){const m=Me.findKey(a,p);!m||i&&!nA(0,a[m],m,i)||(delete a[m],l=!0)}}return Me.isArray(r)?r.forEach(u):u(r),l}clear(r){const i=Object.keys(this);let a=i.length,l=!1;for(;a--;){const u=i[a];r&&!nA(0,this[u],u,r,!0)||(delete this[u],l=!0)}return l}normalize(r){const i=this,a={};return Me.forEach(this,(l,u)=>{var p;const m=Me.findKey(a,u);if(m)return i[m]=kx(l),void delete i[u];const g=r?function(y){return Ii(y).call(y).toLowerCase().replace(/([a-z\d])(\w*)/g,(x,S,T)=>S.toUpperCase()+T)}(u):Ii(p=String(u)).call(p);g!==u&&delete i[u],i[g]=kx(l),a[g]=!0}),this}concat(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return this.constructor.concat(this,...i)}toJSON(r){const i=Object.create(null);return Me.forEach(this,(a,l)=>{a!=null&&a!==!1&&(i[l]=r&&Me.isArray(a)?a.join(", "):a)}),i}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(r=>{let[i,a]=r;return i+": "+a}).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r){const i=new this(r);for(var a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];return l.forEach(p=>i.set(p)),i}static accessor(r){const i=(this[jF]=this[jF]={accessors:{}}).accessors,a=this.prototype;function l(u){const p=h0(u);i[p]||(function(m,g){const y=Me.toCamelCase(" "+g);["get","set","has"].forEach(x=>{Object.defineProperty(m,x+y,{value:function(S,T,C){return this[x].call(this,g,S,T,C)},configurable:!0})})}(a,u),i[p]=!0)}return Me.isArray(r)?r.forEach(l):l(r),this}}jx.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Me.reduceDescriptors(jx.prototype,(t,r)=>{let{value:i}=t,a=r[0].toUpperCase()+r.slice(1);return{get:()=>i,set(l){this[a]=l}}}),Me.freezeMethods(jx);var Do=jx;function rA(t,r){const i=this||tA,a=r||i,l=Do.from(a.headers);let u=a.data;return Me.forEach(t,function(p){u=p.call(i,u,l.normalize(),r?r.status:void 0)}),l.normalize(),u}function DF(t){return!(!t||!t.__CANCEL__)}function qp(t,r,i){dn.call(this,t??"canceled",dn.ERR_CANCELED,r,i),this.name="CanceledError"}function LF(t,r,i){const a=i.config.validateStatus;i.status&&a&&!a(i.status)?r(new dn("Request failed with status code "+i.status,[dn.ERR_BAD_REQUEST,dn.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i)):t(i)}Me.inherits(qp,dn,{__CANCEL__:!0});const Dx=function(t,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,a=0;const l=function(u,p){u=u||10;const m=new Array(u),g=new Array(u);let y,x=0,S=0;return p=p!==void 0?p:1e3,function(T){const C=Date.now(),V=g[S];y||(y=C),m[x]=T,g[x]=C;let j=S,L=0;for(;j!==x;)L+=m[j++],j%=u;if(x=(x+1)%u,x===S&&(S=(S+1)%u),C-y<p)return;const H=V&&C-V;return H?Math.round(1e3*L/H):void 0}}(50,250);return function(u,p){let m,g,y=0,x=1e3/p;const S=function(T){y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Date.now(),m=null,g&&(clearTimeout(g),g=null),u(...T)};return[function(){const T=Date.now(),C=T-y;for(var V=arguments.length,j=new Array(V),L=0;L<V;L++)j[L]=arguments[L];C>=x?S(j,T):(m=j,g||(g=setTimeout(()=>{g=null,S(m)},x-C)))},()=>m&&S(m)]}(u=>{const p=u.loaded,m=u.lengthComputable?u.total:void 0,g=p-a,y=l(g);a=p,t({loaded:p,total:m,progress:m?p/m:void 0,bytes:g,rate:y||void 0,estimated:y&&m&&p<=m?(m-p)/y:void 0,event:u,lengthComputable:m!=null,[r?"download":"upload"]:!0})},i)},MF=(t,r)=>{const i=t!=null;return[a=>r[0]({lengthComputable:i,total:t,loaded:a}),r[1]]},UF=t=>function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return Me.asap(()=>t(...i))};var Lge=cs.hasStandardBrowserEnv?((t,r)=>i=>(i=new dx(i,cs.origin),t.protocol===i.protocol&&t.host===i.host&&(r||t.port===i.port)))(new dx(cs.origin),cs.navigator&&/(msie|trident)/i.test(cs.navigator.userAgent)):()=>!0,Mge=cs.hasStandardBrowserEnv?{write(t,r,i,a,l,u,p){if(typeof document>"u")return;const m=["".concat(t,"=").concat(encodeURIComponent(r))];Me.isNumber(i)&&m.push("expires=".concat(new Date(i).toUTCString())),Me.isString(a)&&m.push("path=".concat(a)),Me.isString(l)&&m.push("domain=".concat(l)),u===!0&&m.push("secure"),Me.isString(p)&&m.push("SameSite=".concat(p)),document.cookie=m.join("; ")},read(t){if(typeof document>"u")return null;const r=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return r?decodeURIComponent(r[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function FF(t,r,i){let a=!function(l){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(l)}(r);return t&&(a||i==0)?function(l,u){return u?l.replace(/\/?\/$/,"")+"/"+u.replace(/^\/+/,""):l}(t,r):r}function VF(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function iA(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?VF(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):VF(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}const BF=t=>t instanceof Do?iA({},t):t;function Fu(t,r){r=r||{};const i={};function a(y,x,S,T){return Me.isPlainObject(y)&&Me.isPlainObject(x)?Me.merge.call({caseless:T},y,x):Me.isPlainObject(x)?Me.merge({},x):Me.isArray(x)?x.slice():x}function l(y,x,S,T){return Me.isUndefined(x)?Me.isUndefined(y)?void 0:a(void 0,y,0,T):a(y,x,0,T)}function u(y,x){if(!Me.isUndefined(x))return a(void 0,x)}function p(y,x){return Me.isUndefined(x)?Me.isUndefined(y)?void 0:a(void 0,y):a(void 0,x)}function m(y,x,S){return S in r?a(y,x):S in t?a(void 0,y):void 0}const g={url:u,method:u,data:u,baseURL:p,transformRequest:p,transformResponse:p,paramsSerializer:p,timeout:p,timeoutMessage:p,withCredentials:p,withXSRFToken:p,adapter:p,responseType:p,xsrfCookieName:p,xsrfHeaderName:p,onUploadProgress:p,onDownloadProgress:p,decompress:p,maxContentLength:p,maxBodyLength:p,beforeRedirect:p,transport:p,httpAgent:p,httpsAgent:p,cancelToken:p,socketPath:p,responseEncoding:p,validateStatus:m,headers:(y,x,S)=>l(BF(y),BF(x),0,!0)};return Me.forEach(Object.keys(iA(iA({},t),r)),function(y){const x=g[y]||l,S=x(t[y],r[y],y);Me.isUndefined(S)&&x!==m||(i[y]=S)}),i}var GF=t=>{const r=Fu({},t);let{data:i,withXSRFToken:a,xsrfHeaderName:l,xsrfCookieName:u,headers:p,auth:m}=r;if(r.headers=p=Do.from(p),r.url=s3(FF(r.baseURL,r.url,r.allowAbsoluteUrls),t.params,t.paramsSerializer),m&&p.set("Authorization","Basic "+btoa((m.username||"")+":"+(m.password?unescape(encodeURIComponent(m.password)):""))),Me.isFormData(i)){if(cs.hasStandardBrowserEnv||cs.hasStandardBrowserWebWorkerEnv)p.setContentType(void 0);else if(Me.isFunction(i.getHeaders)){const g=i.getHeaders(),y=["content-type","content-length"];Object.entries(g).forEach(x=>{let[S,T]=x;Ce(y).call(y,S.toLowerCase())&&p.set(S,T)})}}if(cs.hasStandardBrowserEnv&&(a&&Me.isFunction(a)&&(a=a(r)),a||a!==!1&&Lge(r.url))){const g=l&&u&&Mge.read(u);g&&p.set(l,g)}return r},Uge=typeof XMLHttpRequest<"u"&&function(t){return new je(function(r,i){const a=GF(t);let l=a.data;const u=Do.from(a.headers).normalize();let p,m,g,y,x,{responseType:S,onUploadProgress:T,onDownloadProgress:C}=a;function V(){y&&y(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(p),a.signal&&a.signal.removeEventListener("abort",p)}let j=new XMLHttpRequest;function L(){if(!j)return;const Y=Do.from("getAllResponseHeaders"in j&&j.getAllResponseHeaders());LF(function(te){r(te),V()},function(te){i(te),V()},{data:S&&S!=="text"&&S!=="json"?j.response:j.responseText,status:j.status,statusText:j.statusText,headers:Y,config:t,request:j}),j=null}j.open(a.method.toUpperCase(),a.url,!0),j.timeout=a.timeout,"onloadend"in j?j.onloadend=L:j.onreadystatechange=function(){j&&j.readyState===4&&(j.status!==0||j.responseURL&&j.responseURL.indexOf("file:")===0)&&setTimeout(L)},j.onabort=function(){j&&(i(new dn("Request aborted",dn.ECONNABORTED,t,j)),j=null)},j.onerror=function(Y){const te=new dn(Y&&Y.message?Y.message:"Network Error",dn.ERR_NETWORK,t,j);te.event=Y||null,i(te),j=null},j.ontimeout=function(){let Y=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const te=a.transitional||o3;a.timeoutErrorMessage&&(Y=a.timeoutErrorMessage),i(new dn(Y,te.clarifyTimeoutError?dn.ETIMEDOUT:dn.ECONNABORTED,t,j)),j=null},l===void 0&&u.setContentType(null),"setRequestHeader"in j&&Me.forEach(u.toJSON(),function(Y,te){j.setRequestHeader(te,Y)}),Me.isUndefined(a.withCredentials)||(j.withCredentials=!!a.withCredentials),S&&S!=="json"&&(j.responseType=a.responseType),C&&([g,x]=Dx(C,!0),j.addEventListener("progress",g)),T&&j.upload&&([m,y]=Dx(T),j.upload.addEventListener("progress",m),j.upload.addEventListener("loadend",y)),(a.cancelToken||a.signal)&&(p=Y=>{j&&(i(!Y||Y.type?new qp(null,t,j):Y),j.abort(),j=null)},a.cancelToken&&a.cancelToken.subscribe(p),a.signal&&(a.signal.aborted?p():a.signal.addEventListener("abort",p)));const H=function(Y){const te=/^([-+\w]{1,25})(:?\/\/|:)/.exec(Y);return te&&te[1]||""}(a.url);H&&cs.protocols.indexOf(H)===-1?i(new dn("Unsupported protocol "+H+":",dn.ERR_BAD_REQUEST,t)):j.send(l||null)})},Fge=(t,r)=>{const{length:i}=t=t?t.filter(Boolean):[];if(r||i){let a,l=new AbortController;const u=function(y){if(!a){a=!0,m();const x=y instanceof Error?y:this.reason;l.abort(x instanceof dn?x:new qp(x instanceof Error?x.message:x))}};let p=r&&setTimeout(()=>{p=null,u(new dn("timeout ".concat(r," of ms exceeded"),dn.ETIMEDOUT))},r);const m=()=>{t&&(p&&clearTimeout(p),p=null,t.forEach(y=>{y.unsubscribe?y.unsubscribe(u):y.removeEventListener("abort",u)}),t=null)};t.forEach(y=>y.addEventListener("abort",u));const{signal:g}=l;return g.unsubscribe=()=>Me.asap(m),g}},sA=d(N5),WF=$p.f("asyncIterator"),Vge=d(WF);function aA(t,r){this.v=t,this.k=r}function $i(t){return function(){return new p0(t.apply(this,arguments))}}function p0(t){var r,i;function a(u,p){try{var m=t[u](p),g=m.value,y=g instanceof aA;sA.resolve(y?g.v:g).then(function(x){if(y){var S=u==="return"?"return":"next";if(!g.k||x.done)return a(S,x);x=t[S](x).value}l(m.done?"return":"normal",x)},function(x){a("throw",x)})}catch(x){l("throw",x)}}function l(u,p){switch(u){case"return":r.resolve({value:p,done:!0});break;case"throw":r.reject(p);break;default:r.resolve({value:p,done:!1})}(r=r.next)?a(r.key,r.arg):i=null}this._invoke=function(u,p){return new sA(function(m,g){var y={key:u,arg:p,resolve:m,reject:g,next:null};i?i=i.next=y:(r=i=y,a(u,p))})},typeof t.return!="function"&&(this.return=void 0)}function Nt(t){return new aA(t,0)}function Xp(t){var r={},i=!1;function a(l,u){return i=!0,u=new sA(function(p){p(t[l](u))}),{done:!1,value:new aA(u,1)}}return r[Yp!==void 0&&yF||"@@iterator"]=function(){return this},r.next=function(l){return i?(i=!1,l):a("next",l)},typeof t.throw=="function"&&(r.throw=function(l){if(i)throw i=!1,l;return a("throw",l)}),typeof t.return=="function"&&(r.return=function(l){return i?(i=!1,l):a("return",l)}),r}p0.prototype[typeof Yp=="function"&&Vge||"@@asyncIterator"]=function(){return this},p0.prototype.next=function(t){return this._invoke("next",t)},p0.prototype.throw=function(t){return this._invoke("throw",t)},p0.prototype.return=function(t){return this._invoke("return",t)};var Lx=d(WF);function oA(t){var r,i,a,l=2;for(typeof Symbol<"u"&&(i=Lx,a=Symbol.iterator);l--;){if(i&&(r=t[i])!=null)return r.call(t);if(a&&(r=t[a])!=null)return new Mx(r.call(t));i="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function Mx(t){function r(i){if(Object(i)!==i)return je.reject(new TypeError(i+" is not an object."));var a=i.done;return je.resolve(i.value).then(function(l){return{value:l,done:a}})}return Mx=function(i){this.s=i,this.n=i.next},Mx.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(i){var a=this.s.return;return a===void 0?je.resolve({value:i,done:!0}):r(a.apply(this.s,arguments))},throw:function(i){var a=this.s.return;return a===void 0?je.reject(i):r(a.apply(this.s,arguments))}},new Mx(t)}const Bge=function*(t,r){let i=t.byteLength;if(!r||i<r)return void(yield t);let a,l=0;for(;l<i;)a=l+r,yield t.slice(l,a),l=a},Gge=function(){var t=$i(function*(r,i){var a,l=!1,u=!1;try{for(var p,m=oA(Wge(r));l=!(p=yield Nt(m.next())).done;l=!1){const g=p.value;yield*Xp(oA(Bge(g,i)))}}catch(g){u=!0,a=g}finally{try{l&&m.return!=null&&(yield Nt(m.return()))}finally{if(u)throw a}}});return function(r,i){return t.apply(this,arguments)}}(),Wge=function(){var t=$i(function*(r){if(r[Lx])return void(yield*Xp(oA(r)));const i=r.getReader();try{for(;;){const{done:a,value:l}=yield Nt(i.read());if(a)break;yield l}}finally{yield Nt(i.cancel())}});return function(r){return t.apply(this,arguments)}}(),$F=(t,r,i,a)=>{const l=Gge(t,r);let u,p=0,m=g=>{u||(u=!0,a&&a(g))};return new ReadableStream({async pull(g){try{const{done:y,value:x}=await l.next();if(y)return m(),void g.close();let S=x.byteLength;if(i){let T=p+=S;i(T)}g.enqueue(new Uint8Array(x))}catch(y){throw m(y),y}},cancel:g=>(m(g),l.return())},{highWaterMark:2})};function zF(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function HF(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?zF(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):zF(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}const{isFunction:Ux}=Me,$ge=(t=>{let{Request:r,Response:i}=t;return{Request:r,Response:i}})(Me.global),{ReadableStream:KF,TextEncoder:YF}=Me.global,qF=function(t){try{for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return!!t(...i)}catch{return!1}},zge=t=>{t=Me.merge.call({skipUndefined:!0},$ge,t);const{fetch:r,Request:i,Response:a}=t,l=r?Ux(r):typeof fetch=="function",u=Ux(i),p=Ux(a);if(!l)return!1;const m=l&&Ux(KF),g=l&&(typeof YF=="function"?(y=new YF,V=>y.encode(V)):async V=>new Uint8Array(await new i(V).arrayBuffer()));var y;const x=u&&m&&qF(()=>{let V=!1;const j=new i(cs.origin,{body:new KF,method:"POST",get duplex(){return V=!0,"half"}}).headers.has("Content-Type");return V&&!j}),S=p&&m&&qF(()=>Me.isReadableStream(new a("").body)),T={stream:S&&(V=>V.body)};l&&["text","arrayBuffer","blob","formData","stream"].forEach(V=>{!T[V]&&(T[V]=(j,L)=>{let H=j&&j[V];if(H)return H.call(j);throw new dn("Response type '".concat(V,"' is not supported"),dn.ERR_NOT_SUPPORT,L)})});const C=async(V,j)=>{const L=Me.toFiniteNumber(V.getContentLength());return L??(async H=>H==null?0:Me.isBlob(H)?H.size:Me.isSpecCompliantForm(H)?(await new i(cs.origin,{method:"POST",body:H}).arrayBuffer()).byteLength:Me.isArrayBufferView(H)||Me.isArrayBuffer(H)?H.byteLength:(Me.isURLSearchParams(H)&&(H+=""),Me.isString(H)?(await g(H)).byteLength:void 0))(j)};return async V=>{let{url:j,method:L,data:H,signal:Y,cancelToken:te,timeout:se,onDownloadProgress:oe,onUploadProgress:ne,responseType:de,headers:be,withCredentials:Se="same-origin",fetchOptions:Be}=GF(V),mt=r||fetch;de=de?(de+"").toLowerCase():"text";let ut=Fge([Y,te&&te.toAbortSignal()],se),Tt=null;const Et=ut&&ut.unsubscribe&&(()=>{ut.unsubscribe()});let Xt;try{if(ne&&x&&L!=="get"&&L!=="head"&&(Xt=await C(be,H))!==0){let k,Z=new i(j,{method:"POST",body:H,duplex:"half"});if(Me.isFormData(H)&&(k=Z.headers.get("content-type"))&&be.setContentType(k),Z.body){const[ie,Ae]=MF(Xt,Dx(UF(ne)));H=$F(Z.body,65536,ie,Ae)}}Me.isString(Se)||(Se=Se?"include":"omit");const An=u&&"credentials"in i.prototype,_e=HF(HF({},Be),{},{signal:ut,method:L.toUpperCase(),headers:be.normalize().toJSON(),body:H,duplex:"half",credentials:An?Se:void 0});Tt=u&&new i(j,_e);let Oe=await(u?mt(Tt,Be):mt(j,_e));const He=S&&(de==="stream"||de==="response");if(S&&(oe||He&&Et)){const k={};["status","statusText","headers"].forEach(bt=>{k[bt]=Oe[bt]});const Z=Me.toFiniteNumber(Oe.headers.get("content-length")),[ie,Ae]=oe&&MF(Z,Dx(UF(oe),!0))||[];Oe=new a($F(Oe.body,65536,ie,()=>{Ae&&Ae(),Et&&Et()}),k)}de=de||"text";let we=await T[Me.findKey(T,de)||"text"](Oe,V);return!He&&Et&&Et(),await new je((k,Z)=>{LF(k,Z,{data:we,headers:Do.from(Oe.headers),status:Oe.status,statusText:Oe.statusText,config:V,request:Tt})})}catch(An){throw Et&&Et(),An&&An.name==="TypeError"&&/Load failed|fetch/i.test(An.message)?Object.assign(new dn("Network Error",dn.ERR_NETWORK,V,Tt),{cause:An.cause||An}):dn.from(An,An&&An.code,V,Tt)}}},Hge=new Map,XF=t=>{let r=t&&t.env||{};const{fetch:i,Request:a,Response:l}=r,u=[a,l,i];let p,m,g=u.length,y=Hge;for(;g--;)p=u[g],m=y.get(p),m===void 0&&y.set(p,m=g?new Map:zge(r)),y=m;return m};XF();const cA={http:null,xhr:Uge,fetch:{get:XF}};Me.forEach(cA,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const JF=t=>"- ".concat(t),Kge=t=>Me.isFunction(t)||t===null||t===!1;var QF={getAdapter:function(t,r){t=Me.isArray(t)?t:[t];const{length:i}=t;let a,l;const u={};for(let p=0;p<i;p++){let m;if(a=t[p],l=a,!Kge(a)&&(l=cA[(m=String(a)).toLowerCase()],l===void 0))throw new dn("Unknown adapter '".concat(m,"'"));if(l&&(Me.isFunction(l)||(l=l.get(r))))break;u[m||"#"+p]=l}if(!l){const p=Object.entries(u).map(m=>{let[g,y]=m;return"adapter ".concat(g," ")+(y===!1?"is not supported by the environment":"is not available in the build")});throw new dn("There is no suitable adapter to dispatch the request "+(i?p.length>1?`since :
`+p.map(JF).join(`
`):" "+JF(p[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return l},adapters:cA};function lA(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new qp(null,t)}function ZF(t){return lA(t),t.headers=Do.from(t.headers),t.data=rA.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),QF.getAdapter(t.adapter||tA.adapter,t)(t).then(function(r){return lA(t),r.data=rA.call(t,t.transformResponse,r),r.headers=Do.from(r.headers),r},function(r){return DF(r)||(lA(t),r&&r.response&&(r.response.data=rA.call(t,t.transformResponse,r.response),r.response.headers=Do.from(r.response.headers))),je.reject(r)})}const eV="1.13.2",Fx={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{Fx[t]=function(i){return typeof i===t||"a"+(r<1?"n ":" ")+t}});const tV={};Fx.transitional=function(t,r,i){function a(l,u){return"[Axios v"+eV+"] Transitional option '"+l+"'"+u+(i?". "+i:"")}return(l,u,p)=>{if(t===!1)throw new dn(a(u," has been removed"+(r?" in "+r:"")),dn.ERR_DEPRECATED);return r&&!tV[u]&&(tV[u]=!0,console.warn(a(u," has been deprecated since v"+r+" and will be removed in the near future"))),!t||t(l,u,p)}},Fx.spelling=function(t){return(r,i)=>(console.warn("".concat(i," is likely a misspelling of ").concat(t)),!0)};var Vx={assertOptions:function(t,r,i){if(typeof t!="object")throw new dn("options must be an object",dn.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let l=a.length;for(;l-- >0;){const u=a[l],p=r[u];if(p){const m=t[u],g=m===void 0||p(m,u,t);if(g!==!0)throw new dn("option "+u+" must be "+g,dn.ERR_BAD_OPTION_VALUE)}else if(i!==!0)throw new dn("Unknown option "+u,dn.ERR_BAD_OPTION)}},validators:Fx};const Ec=Vx.validators;let Bx=class{constructor(t){this.defaults=t||{},this.interceptors={request:new a3,response:new a3}}async request(t,r){try{return await this._request(t,r)}catch(i){if(i instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{i.stack?l&&!String(i.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+l):i.stack=l}catch{}}throw i}}_request(t,r){typeof t=="string"?(r=r||{}).url=t:r=t||{},r=Fu(this.defaults,r);const{transitional:i,paramsSerializer:a,headers:l}=r;i!==void 0&&Vx.assertOptions(i,{silentJSONParsing:Ec.transitional(Ec.boolean),forcedJSONParsing:Ec.transitional(Ec.boolean),clarifyTimeoutError:Ec.transitional(Ec.boolean)},!1),a!=null&&(Me.isFunction(a)?r.paramsSerializer={serialize:a}:Vx.assertOptions(a,{encode:Ec.function,serialize:Ec.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Vx.assertOptions(r,{baseUrl:Ec.spelling("baseURL"),withXsrfToken:Ec.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let u=l&&Me.merge(l.common,l[r.method]);l&&Me.forEach(["delete","get","head","post","put","patch","common"],C=>{delete l[C]}),r.headers=Do.concat(u,l);const p=[];let m=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(r)===!1||(m=m&&C.synchronous,p.unshift(C.fulfilled,C.rejected))});const g=[];let y;this.interceptors.response.forEach(function(C){g.push(C.fulfilled,C.rejected)});let x,S=0;if(!m){const C=[ZF.bind(this),void 0];for(C.unshift(...p),C.push(...g),x=C.length,y=je.resolve(r);S<x;)y=y.then(C[S++],C[S++]);return y}x=p.length;let T=r;for(;S<x;){const C=p[S++],V=p[S++];try{T=C(T)}catch(j){V.call(this,j);break}}try{y=ZF.call(this,T)}catch(C){return je.reject(C)}for(S=0,x=g.length;S<x;)y=y.then(g[S++],g[S++]);return y}getUri(t){return s3(FF((t=Fu(this.defaults,t)).baseURL,t.url,t.allowAbsoluteUrls),t.params,t.paramsSerializer)}};Me.forEach(["delete","get","head","options"],function(t){Bx.prototype[t]=function(r,i){return this.request(Fu(i||{},{method:t,url:r,data:(i||{}).data}))}}),Me.forEach(["post","put","patch"],function(t){function r(i){return function(a,l,u){return this.request(Fu(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Bx.prototype[t]=r(),Bx.prototype[t+"Form"]=r(!0)});var Gx=Bx;class dA{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let i;this.promise=new je(function(l){i=l});const a=this;this.promise.then(l=>{if(!a._listeners)return;let u=a._listeners.length;for(;u-- >0;)a._listeners[u](l);a._listeners=null}),this.promise.then=l=>{let u;const p=new je(m=>{a.subscribe(m),u=m}).then(l);return p.cancel=function(){a.unsubscribe(u)},p},r(function(l,u,p){a.reason||(a.reason=new qp(l,u,p),i(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){this.reason?r(this.reason):this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const i=this._listeners.indexOf(r);i!==-1&&this._listeners.splice(i,1)}toAbortSignal(){const r=new AbortController,i=a=>{r.abort(a)};return this.subscribe(i),r.signal.unsubscribe=()=>this.unsubscribe(i),r.signal}static source(){let r;return{token:new dA(function(a){r=a}),cancel:r}}}var Yge=dA;const uA={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(uA).forEach(t=>{let[r,i]=t;uA[i]=r});var qge=uA;const hi=function t(r){const i=new Gx(r),a=G4(Gx.prototype.request,i);return Me.extend(a,Gx.prototype,i,{allOwnKeys:!0}),Me.extend(a,i,null,{allOwnKeys:!0}),a.create=function(l){return t(Fu(r,l))},a}(tA);hi.Axios=Gx,hi.CanceledError=qp,hi.CancelToken=Yge,hi.isCancel=DF,hi.VERSION=eV,hi.toFormData=Ex,hi.AxiosError=dn,hi.Cancel=hi.CanceledError,hi.all=function(t){return je.all(t)},hi.spread=function(t){return function(r){return t.apply(null,r)}},hi.isAxiosError=function(t){return Me.isObject(t)&&t.isAxiosError===!0},hi.mergeConfig=Fu,hi.AxiosHeaders=Do,hi.formToJSON=t=>kF(Me.isHTMLForm(t)?new FormData(t):t),hi.getAdapter=QF.getAdapter,hi.HttpStatusCode=qge,hi.default=hi;var zi=hi;const Xge=()=>{};function m0(){const t={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:Xge};return t.promise=new je((r,i)=>{t.resolve=a=>{t.isFinished||(t.isResolved=!0,t.isFinished=!0,r(a),t.value=a)},t.reject=a=>{t.isFinished||(t.isRejected=!0,t.isFinished=!0,i(a))}}),t}const Wx=new Map,$x=new Map,wc=new Map;let _r=function(t){return t.WIN_10="Windows 10",t.WIN_81="Windows 8.1",t.WIN_8="Windows 8",t.WIN_7="Windows 7",t.WIN_VISTA="Windows Vista",t.WIN_SERVER_2003="Windows Server 2003",t.WIN_XP="Windows XP",t.WIN_2000="Windows 2000",t.ANDROID="Android",t.HARMONY_OS="HarmonyOS",t.OPEN_BSD="Open BSD",t.SUN_OS="Sun OS",t.LINUX="Linux",t.IOS="iOS",t.MAC_OS="Mac OS",t.CHROMIUM_OS="Chromium OS",t.QNX="QNX",t.UNIX="UNIX",t.BEOS="BeOS",t.OS_2="OS/2",t.SEARCH_BOT="Search Bot",t}({}),Yt=function(t){return t.CHROME="Chrome",t.SAFARI="Safari",t.EDGE="Edge",t.FIREFOX="Firefox",t.OPERA="OPR",t.QQ="QQBrowser",t.WECHAT="MicroMessenger",t}({});const nV=new Ope;let Lo=nV.getResult(),hA=null;function Ht(t){if(!hA){Lo=nV.getResult();const r=function(m){if(m.engine.name==="Blink"&&m.browser.name!=="WeChat")return Yt.CHROME;switch(m.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return Yt.CHROME;case"Safari":case"Mobile Safari":return Yt.SAFARI;case"Edge":return Yt.EDGE;case"Firefox":return Yt.FIREFOX;case"QQ":case"QQBrowser":return Yt.QQ;case"Opera":return Yt.OPERA;case"WeChat":return Yt.WECHAT;default:return m.browser.name||""}}(Lo),i=rV(Lo),a=function(m){return m.os.name==="Windows"?m.os.version?m.os.name+" "+m.os.version:m.os.name:m.os.name||""}(Lo),l=Lo.os.version,u=rV(Lo,!1),p=Lo.device.type;if(!(r&&i&&a&&l))return{name:r,version:i,os:a,osVersion:l,browserVersion:u,deviceType:p};hA={name:r,version:i,os:a,osVersion:l,browserVersion:u,deviceType:p}}return hA}function rV(t){let r,i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return r=t.engine.name==="Blink"?t.engine.version||"":t.browser.version||"",i?r.split(".")[0]:r}function zx(){return Ht().os}function iV(){const t=Ht();return"".concat(t.os," ").concat(t.osVersion)}function Hx(){const t=Ht();return!!(Lo.engine.name==="WebKit"&&t.os===_r.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&t.name!==Yt.SAFARI||pi()&&t.name!==Yt.SAFARI)}function ul(){return Ht().name===Yt.CHROME}function Pr(){return Ht().name===Yt.SAFARI}function sV(){const t=Ht();if(t.name!==Yt.SAFARI||!t.browserVersion)return!1;const r=t.browserVersion.split(".");return Number(r[0])>15||Number(r[0])===15&&Number(r[1])>=4}function aV(){return Ht().name===Yt.EDGE}function wn(){return Ht().name===Yt.FIREFOX}function pi(){return Ht().os===_r.IOS}function Mo(t){const r=Ht();return!(r.name!==Yt.CHROME||!r.osVersion)&&Number(r.version)>=t}function oV(t){const r=Ht();return!(r.name!==Yt.CHROME||!r.osVersion)&&Number(r.version)<t}function pA(t,r,i){const a=Ht();return!(a.name!==t||!a.osVersion)&&(i?Number(a.version)>=r&&Number(a.version)<=i:Number(a.version)===r)}function md(t){const r=Ht();return!(r.name!==Yt.EDGE||!r.osVersion)&&Number(r.version)>=t}function mA(t){const r=Ht();return!(r.name!==Yt.FIREFOX||!r.osVersion)&&Number(r.version)>=t}function cV(t){const r=Ht();return!(r.name!==Yt.SAFARI||!r.osVersion)&&Number(r.version)>=t}function lV(t,r,i){const a=Ht();if(a.os!==_r.IOS||!a.osVersion)return!1;const l=a.osVersion.split(".");return i?r&&Number(l[0])===t&&Number(l[1])>r||Number(l[0])>t:r?Number(l[0])===t&&Number(l[1])>=r||Number(l[0])>t:Number(l[0])>=t}function dV(t,r,i){const a=Ht();if(a.os!==_r.IOS||!a.osVersion)return!1;const l=a.osVersion.split(".");return i?r&&Number(l[0])===t&&Number(l[1])<r||Number(l[0])<t:r?Number(l[0])===t&&Number(l[1])<=r||Number(l[0])<t:Number(l[0])<=t}function fA(t,r,i){const a=Ht();if(a.name!==Yt.SAFARI||!a.osVersion||!a.browserVersion)return!1;const l=a.browserVersion.split(".");return i?r&&Number(l[0])===t&&Number(l[1])<r||Number(l[0])<t:r?Number(l[0])===t&&Number(l[1])<=r||Number(l[0])<t:Number(l[0])<=t}function Vu(t){const r=Ht();return!(r.name!==Yt.OPERA||!r.osVersion)&&Number(r.version)>=t}function uV(){const t=Ht();if(t.os!==_r.IOS||!t.osVersion)return!1;const r=t.osVersion.split(".");return Number(r[0])<14||Number(r[0])===14&&Number(r[1])<=6}function Jp(){const t=Ht();if(t.os!==_r.IOS||!t.osVersion)return!1;const r=t.osVersion.split(".");return Number(r[0])===15}function gA(){const t=Ht();if(t.os!==_r.IOS||!t.osVersion)return!1;const r=t.osVersion.split(".");return Number(r[0])===16}function hV(){const t=Ht();if(t.os!==_r.IOS||!t.osVersion)return!1;const r=t.osVersion.split(".");return Number(r[0])===15&&Number(r[1])>=1}function Ya(){return Pr()&&navigator.maxTouchPoints>0}function pV(){return Ht().name===Yt.WECHAT}function mV(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function fV(){const t=zx();return function(){const{deviceType:r}=Ht();return r==="mobile"||r==="tablet"}()||t===_r.ANDROID||t===_r.IOS||t===_r.HARMONY_OS}function Sc(){const t=Ht();return t.name!==Yt.EDGE&&t.name!==Yt.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function f0(){return zx()===_r.ANDROID}function g0(){const t=Ht();return f0()&&(t.name===Yt.CHROME||t.name===Yt.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function xt(t,r,i){return(r=function(a){var l=function(u,p){if(typeof u!="object"||!u)return u;var m=u[Symbol.toPrimitive];if(m!==void 0){var g=m.call(u,"string");if(typeof g!="object")return g;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(a);return typeof l=="symbol"?l:l+""}(r))in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t}function gV(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function Ie(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?gV(Object(i),!0).forEach(function(a){xt(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):gV(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}let K=function(t){return t.UNEXPECTED_ERROR="UNEXPECTED_ERROR",t.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",t.TIMEOUT="TIMEOUT",t.INVALID_PARAMS="INVALID_PARAMS",t.NOT_READABLE="NOT_READABLE",t.NOT_SUPPORTED="NOT_SUPPORTED",t.INVALID_OPERATION="INVALID_OPERATION",t.OPERATION_ABORTED="OPERATION_ABORTED",t.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",t.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",t.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",t.DATACHANNEL_FAILED="DATACHANNEL_FAILED",t.NETWORK_ERROR="NETWORK_ERROR",t.NETWORK_TIMEOUT="NETWORK_TIMEOUT",t.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",t.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",t.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",t.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",t.ELECTRON_IS_NULL="ELECTRON_IS_NULL",t.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",t.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",t.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",t.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",t.PERMISSION_DENIED="PERMISSION_DENIED",t.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",t.TRACK_IS_DISABLED="TRACK_IS_DISABLED",t.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",t.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",t.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",t.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",t.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",t.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",t.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",t.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",t.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",t.UID_CONFLICT="UID_CONFLICT",t.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",t.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",t.TOKEN_EXPIRE="TOKEN_EXPIRE",t.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",t.INVALID_TRACK="INVALID_TRACK",t.SENDER_NOT_FOUND="SENDER_NOT_FOUND",t.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",t.SET_ANSWER_FAILED="SET_ANSWER_FAILED",t.ICE_FAILED="ICE_FAILED",t.PC_CLOSED="PC_CLOSED",t.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",t.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",t.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",t.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",t.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",t.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",t.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",t.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",t.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",t.INVALID_REMOTE_USER="INVALID_REMOTE_USER",t.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",t.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",t.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",t.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",t.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",t.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",t.WS_ABORT="WS_ABORT",t.WS_DISCONNECT="WS_DISCONNECT",t.WS_ERR="WS_ERR",t.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",t.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",t.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",t.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",t.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",t.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",t.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",t.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",t.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",t.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",t.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",t.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",t.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",t.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",t.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",t.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",t.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",t.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",t.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",t.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",t.INVALID_PLUGIN="INVALID_PLUGIN",t.DISCONNECT_P2P="DISCONNECT_P2P",t.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",t.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",t.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",t.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",t.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",t.PROHIBITED_OPERATION="PROHIBITED_OPERATION",t.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",t.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",t}({}),ge=class extends Error{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0;super(r),xt(this,"code",void 0),xt(this,"message",void 0),xt(this,"data",void 0),xt(this,"name","AgoraRTCException"),this.code=t,this.message="AgoraRTCError ".concat(this.code,": ").concat(r),this.data=i}toString(){return this.data?"".concat(this.message,`
data: `).concat(JSON.stringify(this.data)):this.message}print(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",r=arguments.length>1?arguments[1]:void 0;return t==="error"&&(r||console).error(this.toString()),t==="warning"&&(r||console).warn(this.toString()),this}throw(t){throw this.print("error",t),this}};function qa(t,r){if(typeof t!="boolean")throw new ge(K.INVALID_PARAMS,"Invalid ".concat(r,": The value is of the boolean type."))}function Zn(t,r,i){if(!Ce(i).call(i,t))throw new ge(K.INVALID_PARAMS,"".concat(r," can only be set as ").concat(JSON.stringify(i)))}function un(t,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(t<i||t>a||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(l){return typeof l=="number"&&l%1==0}(t))throw new ge(K.INVALID_PARAMS,"invalid ".concat(r,": the value range is [").concat(i,", ").concat(a,"]. integer only"))}function vA(t,r){if(typeof t!="number"){if(!(t.min||t.max||t.ideal||t.exact))throw new ge(K.INVALID_PARAMS,"".concat(r," is not a valid ConstrainLong"));t.min!==void 0&&un(t.min,"".concat(r,".min"),0,1/0),t.max!==void 0&&un(t.max,"".concat(r,".max"),1,1/0),t.exact!==void 0&&un(t.exact,"".concat(r,".exact"),1,1/0),t.ideal!==void 0&&un(t.ideal,"".concat(r,".ideal"),1,1/0)}else un(t,r,1,1/0)}function Wr(t,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,l=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(t==null)throw new ge(K.INVALID_PARAMS,"".concat(r||"param"," cannot be empty"));if(!vV(t,i,a,l))throw new ge(K.INVALID_PARAMS,"Invalid ".concat(r||"string param",": Length of the string: [").concat(i,",").concat(a,"].").concat(l?" ASCII characters only.":""))}function hl(t,r){if(!Array.isArray(t))throw new ge(K.INVALID_PARAMS,"".concat(r," should be an array"))}function Mn(t){return t==null}function vV(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,a=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof t=="string"&&t.length<=i&&t.length>=r&&(!a||function(l){if(typeof l!="string")return!1;for(let u=0;u<l.length;u+=1){const p=l.charCodeAt(u);if(p<0||p>255)return!1}return!0}(t))}function yV(t,r,i){if("getBigUint64"in DataView.prototype)return t.getBigUint64(r,i);const a=t.getUint32(r,i),l=t.getUint32(r+4,i),u=0,p=+!i;return BigInt(a*p+l*u)<<BigInt(32)|BigInt(a*u+l*p)}function bV(t,r,i,a){if("setBigUint64"in DataView.prototype)return t.setBigUint64(r,i,a);const l=Number(i>>BigInt(32)),u=Number(i&BigInt(4294967295));t.setUint32(r,l,a),t.setUint32(r+4,u,a)}var v0=function(t){return t.COVERED="COVERED",t.POSITION="POSITION",t.SIZE="SIZE",t.STYLE="STYLE",t}(v0||{}),yA=function(t){return t.UNMOUNTED="UNMOUNTED",t.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",t}(yA||{});const xV=new class{constructor(){xt(this,"_clientSize",null),xt(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),xt(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),xt(this,"getStyle",t=>window.getComputedStyle(t,null)),xt(this,"checkCssVisibleProperty",t=>{var r;let i=!0;const a=this.getStyle(t),{display:l,visibility:u,opacity:p,filter:m}=a;return(l==="none"||Ce(r=["hidden","collapse"]).call(r,u)||Number(p)<.1)&&(i=!1),!!i&&(m&&m.split(" ").filter(g=>{var y;const x=g.split("(")[0];return Ce(y=["brightness","blur","opacity"]).call(y,x)}).map(g=>{const[y,x]=g.split(/\(|\)/);return[y,Number(x.match(/^[0-9\.]+/))]}).forEach(g=>{const[y,x]=g;switch(y){case"brightness":(x<.1||x>3)&&(i=!1);break;case"blur":x>3&&(i=!1);break;case"opacity":x<.1&&(i=!1)}}),i)}),xt(this,"checkPropertyUpToAllParentNodes",(t,r)=>{let i=!0,a=!0;const l=p=>r(p);let u=t;for(;u&&a;)l(u)||(i=!1,a=!1),u=u.parentElement,u||(a=!1);return i}),xt(this,"checkActualCssVisibleIncludeInherit",t=>this.checkPropertyUpToAllParentNodes(t,this.checkCssVisibleProperty)),xt(this,"getSizeAboutClient",t=>{const{width:r,height:i,left:a,right:l,top:u,bottom:p}=t.getBoundingClientRect(),m=this.getClientWidth(),g=this.getClientHeight();return{width:r,height:i,left:a,right:l,top:u,bottom:p,clientWidth:m,clientHeight:g,clientMin:Math.min(m,g)}}),xt(this,"checkActualSize",()=>{const{width:t,height:r,clientMin:i}=this._clientSize;return this.checkSizeIsVisible(t,r,i)}),xt(this,"elementFromPoint",(t,r)=>document.elementFromPoint?document.elementFromPoint(t,r):null),xt(this,"checkCoverForAPoint",(t,r,i)=>{const a=this.elementFromPoint(t,r);return a!==null&&a!==i}),xt(this,"getPointPositionList",()=>{const{width:t,height:r,left:i,top:a}=this._clientSize,l=t/6,u=r/6,p=[],m=10**6;for(let g=0;g<5;g++)for(let y=0;y<5;y++){const x=(i*m+(g===0?.1:g===4?(l*g*m-1e5)/m:l*g)*m)/m,S=(a*m+(y===0?.1:y===4?(u*y*m-1e5)/m:u*y)*m)/m;p.push({x,y:S})}return[...p]}),xt(this,"checkElementCover",t=>this.getPointPositionList().map(r=>this.checkCoverForAPoint(r.x,r.y,t)).filter(r=>!!r).length>6),xt(this,"checkSizeIsVisible",(t,r,i)=>(t>50||i/t<=10)&&(r>50||i/r<=10)),xt(this,"checkSizeOfPartInClient",()=>{const{left:t,right:r,top:i,bottom:a,clientHeight:l,clientWidth:u,clientMin:p}=this._clientSize;let m,g,y,x;if(t<0)m=0;else{if(!(t<u))return!1;m=t}if(r<0)return!1;if(g=r<u?r:u,i<0)y=0;else{if(!(i<l))return!1;y=i}if(a<0)return!1;x=a<l?a:l;const S=g-m,T=x-y;return this.checkSizeIsVisible(S,T,p)}),xt(this,"returnHiddenResult",t=>(this._clientSize=null,{visible:!1,reason:t})),xt(this,"checkOneElementVisible",t=>{if(t instanceof HTMLElement){if(this.checkElementIsMountedOnDom(t)){if(this.checkActualCssVisibleIncludeInherit(t)){if(this._clientSize=this.getSizeAboutClient(t),this.checkElementCover(t))return this.returnHiddenResult(v0.COVERED);{const r=this.checkActualSize(),i=this.checkSizeOfPartInClient();return r&&!i?this.returnHiddenResult(v0.POSITION):r?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(v0.SIZE)}}return this.returnHiddenResult(v0.STYLE)}return this.returnHiddenResult(yA.UNMOUNTED)}return this.returnHiddenResult(yA.INVALID_HTML_ELEMENT)}),xt(this,"checkElementIsMountedOnDom",t=>this.checkPropertyUpToAllParentNodes(t,r=>r.nodeName.toUpperCase()!=="HTML"?r.parentElement!==null:!!document.documentElement))}};function bA(t){return new TextEncoder().encode(t)}const _V=function(t,r){const i=new Uint8Array(t.byteLength+r.byteLength);return i.set(new Uint8Array(t),0),i.set(new Uint8Array(r),t.byteLength),i},xA=async t=>function(r,i){let a="";return new Uint8Array(r).forEach(l=>{a+=l.toString(i).padStart(2,"0")}),a}(await crypto.subtle.digest("SHA-256",bA(t)),16);let Pn=class{constructor(){xt(this,"_events",{}),xt(this,"addListener",this.on)}getListeners(t){return this._events[t]?this._events[t].map(r=>r.listener):[]}on(t,r){this._events[t]||(this._events[t]=[]);const i=this._events[t];this._indexOfListener(i,r)===-1&&i.push({listener:r,once:!1})}once(t,r){this._events[t]||(this._events[t]=[]);const i=this._events[t];this._indexOfListener(i,r)===-1&&i.push({listener:r,once:!0})}off(t,r){if(!this._events[t])return;const i=this._events[t],a=this._indexOfListener(i,r);a!==-1&&i.splice(a,1),this._events[t].length===0&&delete this._events[t]}removeAllListeners(t){t?delete this._events[t]:this._events={}}emit(t){this._events[t]||(this._events[t]=[]);const r=this._events[t].map(u=>u);for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];for(let u=0;u<r.length;u+=1){const p=r[u];p.once&&this.off(t,p.listener),p.listener.apply(this,a||[])}}safeEmit(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];[...this._events[t]||[]].forEach(l=>{l.once&&this.off(t,l.listener);try{l.listener.apply(this,i)}catch(u){console.error("safeEmit event:".concat(t," error ").concat(u==null?void 0:u.toString()))}})}_indexOfListener(t,r){let i=t.length;for(;i--;)if(t[i].listener===r)return i;return-1}},y0=null;function EV(){if(y0)return y0;if(window.electron)return y0=window.electron;if(!window.require)return null;try{return y0=window.require("electron"),y0}catch{return null}}let Cn=function(t){return t.CREATE_CLIENT="createClient",t.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",t.SET_AREA="setArea",t.PRELOAD="PRELOAD",t.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",t.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",t.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",t.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",t.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",t.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",t.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",t.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",t.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",t.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",t.START_PROXY_SERVER="Client.startProxyServer",t.STOP_PROXY_SERVER="Client.stopProxyServer",t.SET_PROXY_SERVER="Client.setProxyServer",t.SET_TURN_SERVER="Client.setTurnServer",t.SET_CLIENT_ROLE="Client.setClientRole",t.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",t.ENABLE_DUAL_STREAM="Client.enableDualStream",t.DISABLE_DUAL_STREAM="Client.disableDualStream",t.JOIN="Client.join",t.LEAVE="Client.leave",t.PUBLISH="Client.publish",t.UNPUBLISH="Client.unpublish",t.SUBSCRIBE="Client.subscribe",t.MASS_SUBSCRIBE="Client.massSubscribe",t.MASS_UNSUBSCRIBE="Client.massUnsubscribe",t.UNSUBSCRIBE="Client.unsubscribe",t.RENEW_TOKEN="Client.renewToken",t.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",t.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",t.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",t.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",t.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",t.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",t.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",t.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",t.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",t.START_LIVE_STREAMING="Client.startLiveStreaming",t.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",t.STOP_LIVE_STREAMING="Client.stopLiveStreaming",t.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",t.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",t.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",t.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",t.SET_CONFIG_DISTRIBUTE="_configDistribute",t.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",t.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",t.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",t.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",t.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",t.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",t.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",t.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",t.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",t.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",t.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",t.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",t.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",t.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",t.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",t.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",t.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",t.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",t.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",t.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",t.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",t.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",t.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",t.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",t.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",t.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",t.STREAM_TYPE_CHANGE="streamTypeChange",t.CONNECTION_STATE_CHANGE="connectionStateChange",t.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",t.IMAGE_MODERATION_UPLOAD="imageModerationUpload",t.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",t.PRELOAD_MEDIA_FAILED="preloadMediaFailed",t.MISMATCH_DTLS_PARAMETERS="mismatchDtlsParameters",t.VOS_FALLBACK_CN="vosFallbackCN",t.DATACHANNEL_FAILBACK="datachannelFailback",t}({}),hn=function(t){return t.TRACER="tracer",t}({});function wV(t){return un(t.timeout,"config.timeout",0,1e5),un(t.timeoutFactor,"config.timeoutFactor",0,100,!1),un(t.maxRetryCount,"config.maxRetryConfig",0,1/0),un(t.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let Jge=function(t){return t[t.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",t[t.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",t[t.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",t}({}),Ut=function(t){return t.LEAVE="LEAVE",t.NETWORK_ERROR="NETWORK_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.UID_BANNED="UID_BANNED",t.FALLBACK="FALLBACK",t.IP_BANNED="IP_BANNED",t.CHANNEL_BANNED="CHANNEL_BANNED",t.LICENSE_MISSING="LICENSE_MISSING",t.LICENSE_EXPIRED="LICENSE_EXPIRED",t.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",t.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",t.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",t.LICENSE_ILLEGAL="LICENSE_ILLEGAL",t.TOKEN_EXPIRE="TOKEN_EXPIRE",t.FALLBACK_TO_HLS="FALLBACK_TO_HLS",t.UID_CONFLICT="UID_CONFLICT",t}({});function Bu(t){if(!Array.isArray(t)||t.length<1)return!1;try{t.forEach(r=>{if(!r.urls)throw Error()})}catch{return!1}return!0}function SV(t){return Wr(t.turnServerURL,"turnServerURL"),Wr(t.username,"username"),Wr(t.password,"password"),t.udpport&&un(t.udpport,"udpport",1,99999,!0),t.forceturn&&qa(t.forceturn,"forceturn"),t.security&&qa(t.security,"security"),t.tcpport&&un(t.tcpport,"tcpport",1,99999,!0),!0}let Qp=function(t){return t[t.AUTO_SIMULCAST_STREAM=-1]="AUTO_SIMULCAST_STREAM",t[t.DISABLE_SIMULCAST_STREM=0]="DISABLE_SIMULCAST_STREM",t[t.ENABLE_SIMULCAST_STREAM=1]="ENABLE_SIMULCAST_STREAM",t}({});function _A(t){return t.level!==void 0&&Zn(t.level,"level",[1,2,3]),t.delay!==void 0&&un(t.delay,"delay",0,3e3,!0),!0}let Ot=function(t){return t.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",t.AUDIO_METADATA="audio-metadata",t.AUDIO_PTS="audio-pts",t.CONNECTION_STATE_CHANGE="connection-state-change",t.MEDIA_RECONNECT_START="media-reconnect-start",t.MEDIA_RECONNECT_END="media-reconnect-end",t.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",t.USER_JOINED="user-joined",t.USER_LEAVED="user-left",t.USER_PUBLISHED="user-published",t.USER_UNPUBLISHED="user-unpublished",t.USER_INFO_UPDATED="user-info-updated",t.CLIENT_BANNED="client-banned",t.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",t.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",t.VOLUME_INDICATOR="volume-indicator",t.CRYPT_ERROR="crypt-error",t.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",t.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",t.NETWORK_QUALITY="network-quality",t.STREAM_TYPE_CHANGED="stream-type-changed",t.STREAM_FALLBACK="stream-fallback",t.RECEIVE_METADATA="receive-metadata",t.STREAM_MESSAGE="stream-message",t.LIVE_STREAMING_ERROR="live-streaming-error",t.LIVE_STREAMING_WARNING="live-streaming-warning",t.EXCEPTION="exception",t.ERROR="error",t.P2P_LOST="p2p_lost",t.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",t.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",t.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",t.PUBLISHED_USER_LIST="published-user-list",t.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",t.CONTENT_INSPECT_ERROR="content-inspect-error",t.CONTENT_INSPECT_RESULT="content-inspect-result",t.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",t.FALLBACK_TO_HLS="fallback-to-hls",t.FIRST_VIDEO_BUFFER_READY="first-video-buffer-ready",t.FIRST_VIDEO_PRE_RENDER="first-video-pre-render",t.AV1_DECODABLE_RESULT="av1-decodable-result",t}({}),EA=function(t){return t.CONFIG="config",t.VOSERROR="vos_error",t.AP_ERROR="ap_error",t}({}),Qr=function(t){return t.NETWORK_ERROR="NETWORK_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.MULTI_IP="MULTI_IP",t.TIMEOUT="TIMEOUT",t.OFFLINE="OFFLINE",t.LEAVE="LEAVE",t.P2P_FAILED="P2P_FAILED",t.FALLBACK="FALLBACK",t.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",t}({}),Pi=function(t){return t.ONLINE="ONLINE",t.OFFLINE="OFFLINE",t}({}),Gu=function(t){return t.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",t.ONLINE="ONLINE",t.OFFLINE="OFFLINE",t}({});function or(t,r){for(var i=arguments.length,a=new Array(i>2?i-2:0),l=2;l<i;l++)a[l-2]=arguments[l];return t.getListeners(r).length===0?je.reject(new ge(K.UNEXPECTED_ERROR,"can not emit promise")):new je((u,p)=>{t.emit(r,...a,u,p)})}function gn(t,r){if(t.getListeners(r).length===0)return je.resolve();for(var i=arguments.length,a=new Array(i>2?i-2:0),l=2;l<i;l++)a[l-2]=arguments[l];return or(t,r,...a)}function As(t,r){if(t.getListeners(r).length===0)return null;for(var i=arguments.length,a=new Array(i>2?i-2:0),l=2;l<i;l++)a[l-2]=arguments[l];return Wu(t,r,...a)}function Wu(t,r){let i=null,a=null;for(var l=arguments.length,u=new Array(l>2?l-2:0),p=2;p<l;p++)u[p-2]=arguments[p];if(t.emit(r,...u,m=>{i=m},m=>{a=m}),a!==null)throw a;if(i===null)throw new ge(K.UNEXPECTED_ERROR,"handler is not sync");return i}const Un=new class extends Pn{set networkState(t){this.emit(Gu.NETWORK_STATE_CHANGE,t,this._networkState),t===Pi.ONLINE?this.emit(Gu.ONLINE):t===Pi.OFFLINE&&(this.onlineWaiter=new je(r=>{this.once(Gu.ONLINE,()=>{this.onlineWaiter=void 0,r(Pi.ONLINE)})}),this.emit(Gu.OFFLINE)),this._networkState=t}get networkState(){return this._networkState}get isOnline(){return this._networkState===Pi.ONLINE}constructor(){super(),xt(this,"_moduleName","network-indicator"),xt(this,"_networkState",Pi.ONLINE),xt(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Pi.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Pi.OFFLINE})}},Hi=[];for(let t=0;t<256;++t)Hi.push((t+256).toString(16).slice(1));const TV=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);let wA;const Qge=new Uint8Array(16);function Zge(){return TV?TV():function(i,a,l){var u,p,m,g;const y=(u=(p=(i=i||{}).random)!==null&&p!==void 0?p:(m=(g=i).rng)===null||m===void 0?void 0:m.call(g))!==null&&u!==void 0?u:function(){if(!wA){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");wA=crypto.getRandomValues.bind(crypto)}return wA(Qge)}();if(y.length<16)throw new Error("Random bytes length must be >= 16");if(y[6]=15&y[6]|64,y[8]=63&y[8]|128,a){if((l=l||0)<0||l+16>a.length)throw new RangeError("UUID byte range ".concat(l,":").concat(l+15," is out of buffer bounds"));for(let x=0;x<16;++x)a[l+x]=y[x];return a}return function(x){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(Hi[x[S+0]]+Hi[x[S+1]]+Hi[x[S+2]]+Hi[x[S+3]]+"-"+Hi[x[S+4]]+Hi[x[S+5]]+"-"+Hi[x[S+6]]+Hi[x[S+7]]+"-"+Hi[x[S+8]]+Hi[x[S+9]]+"-"+Hi[x[S+10]]+Hi[x[S+11]]+Hi[x[S+12]]+Hi[x[S+13]]+Hi[x[S+14]]+Hi[x[S+15]]).toLowerCase()}(y)}(t,r,void 0);var t,r}function Kx(t,r){const i=t.indexOf(r);i!==-1&&t.splice(i,1)}function Zp(t){const r=[];return t.forEach(i=>{r.indexOf(i)===-1&&r.push(i)}),r}function Yx(t){je!==void 0?je.resolve().then(t):setTimeout(t,0)}function Sn(t){return JSON.parse(JSON.stringify(t))}function $u(t){try{return Sn(t)}catch{return t}}const NV={};function fd(t,r){NV[r]||(NV[r]=!0,t())}function zu(t){const r=window.atob(t),i=new Uint8Array(new ArrayBuffer(r.length));for(let a=0;a<r.length;a+=1)i[a]=r.charCodeAt(a);return i}function gd(t){let r="";for(let i=0;i<t.length;i+=1)r+=String.fromCharCode(t[i]);return window.btoa(r)}function CV(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,i=new TextEncoder().encode(t);if(i.length>r)i=i.slice(0,r);else if(i.length<r){const a=new Uint8Array(r);a.set(i),i=a}return i}function RV(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];const a=pa(r).call(r,(p,m)=>p+m.length,0),l=new Uint8Array(new ArrayBuffer(a));let u=0;return r.forEach(p=>{l.set(p,u),u+=p.length}),l}function Tc(t){return window.TextEncoder?new TextEncoder().encode(t).length:t.length}function AV(t){let r=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&t.realFormData&&(t=t.realFormData),t.forEach(i=>{r+=typeof i=="string"?Tc(i):i.size}),r+138}function e0e(t){const r=new ge(K.TIMEOUT,"timeout");return new je((i,a)=>{window.setTimeout(()=>a(r),t)})}function Er(t){return new je(r=>{window.setTimeout(r,t)})}function tn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,r=arguments.length>1?arguments[1]:void 0;const i=Math.random().toString(16).substr(2,t).toLowerCase();return i.length===t?"".concat(r).concat(i):"".concat(r).concat(i)+tn(t-i.length,"")}function Hu(){let t,r=!1;try{var i;t=Ipe(i=Zge()).call(i,"-","")}catch{r=!0}return!r&&t&&t.length===32||(t=tn(32,"")),t.toUpperCase()}const b0=()=>{},IV=new class{constructor(){xt(this,"fnMap",new Map)}throttleByKey(t,r,i,a){for(var l=arguments.length,u=new Array(l>4?l-4:0),p=4;p<l;p++)u[p-4]=arguments[p];if(this.fnMap.has(r)){const m=this.fnMap.get(r);if(m.threshold!==i){m.fn(...m.args),clearTimeout(m.timer);const g=window.setTimeout(()=>{const y=this.fnMap.get(r);y&&y.fn(...y.args),this.fnMap.delete(r)},i);this.fnMap.set(r,{fn:t,threshold:i,timer:g,args:u,skipFn:a})}else m.skipFn&&m.skipFn(...m.args),this.fnMap.set(r,Ie(Ie({},m),{},{fn:t,args:u,skipFn:a}))}else{const m=window.setTimeout(()=>{const g=this.fnMap.get(r);g&&g.fn(...g.args),this.fnMap.delete(r)},i);this.fnMap.set(r,{fn:t,threshold:i,timer:m,args:u,skipFn:a})}}},OV=IV.throttleByKey.bind(IV);function PV(t){return typeof t=="object"&&t!==null&&!(t instanceof RegExp)}function SA(t,r){if(!PV(t)||!PV(r)||Array.isArray(t)&&!Array.isArray(r)||!Array.isArray(t)&&Array.isArray(r))return r;if(Array.isArray(r)&&Array.isArray(t)){const i=[...t];for(let a=0;a<r.length;a++)i[a]=SA(t[a],r[a]);return i}{const i=Ie({},t);for(const a in r)Object.prototype.hasOwnProperty.call(r,a)&&(Object.prototype.hasOwnProperty.call(t,a)?i[a]=SA(t[a],r[a]):i[a]=r[a]);return i}}function kV(t,r){let i=[0];if(i=new Array(r).fill(0),t===0)return i;let a=0;for(;t>0&&(i[a]=255&t,t>>=8,a++,a!==r););return i}function em(t){return typeof t=="number"?t:t.exact||t.ideal||t.max||t.min||0}function TA(t,r){try{return typeof t=="object"&&typeof r=="object"&&JSON.stringify(t)===JSON.stringify(r)}catch{return!1}}function NA(t){return pa(t).call(t,(r,i)=>r+i,0)}function jV(t){const r="0123456789abcdef";function i(te){let se,oe="";for(se=0;se<=3;se++)oe+=r.charAt(te>>8*se+4&15)+r.charAt(te>>8*se&15);return oe}function a(te,se){const oe=(65535&te)+(65535&se);return(te>>16)+(se>>16)+(oe>>16)<<16|65535&oe}function l(te,se,oe,ne,de,be){return a(function(Se,Be){return Se<<Be|Se>>>32-Be}(a(a(se,te),a(ne,be)),de),oe)}function u(te,se,oe,ne,de,be,Se){return l(se&oe|~se&ne,te,se,de,be,Se)}function p(te,se,oe,ne,de,be,Se){return l(se&ne|oe&~ne,te,se,de,be,Se)}function m(te,se,oe,ne,de,be,Se){return l(se^oe^ne,te,se,de,be,Se)}function g(te,se,oe,ne,de,be,Se){return l(oe^(se|~ne),te,se,de,be,Se)}const y=function(te){let se;const oe=1+(te.length+8>>6),ne=new Array(16*oe);for(se=0;se<16*oe;se++)ne[se]=0;for(se=0;se<te.length;se++)ne[se>>2]|=te.charCodeAt(se)<<se%4*8;return ne[se>>2]|=128<<se%4*8,ne[16*oe-2]=8*te.length,ne}(t);let x,S,T,C,V,j=1732584193,L=-271733879,H=-1732584194,Y=271733878;for(x=0;x<y.length;x+=16)S=j,T=L,C=H,V=Y,j=u(j,L,H,Y,y[x+0],7,-680876936),Y=u(Y,j,L,H,y[x+1],12,-389564586),H=u(H,Y,j,L,y[x+2],17,606105819),L=u(L,H,Y,j,y[x+3],22,-1044525330),j=u(j,L,H,Y,y[x+4],7,-176418897),Y=u(Y,j,L,H,y[x+5],12,1200080426),H=u(H,Y,j,L,y[x+6],17,-1473231341),L=u(L,H,Y,j,y[x+7],22,-45705983),j=u(j,L,H,Y,y[x+8],7,1770035416),Y=u(Y,j,L,H,y[x+9],12,-1958414417),H=u(H,Y,j,L,y[x+10],17,-42063),L=u(L,H,Y,j,y[x+11],22,-1990404162),j=u(j,L,H,Y,y[x+12],7,1804603682),Y=u(Y,j,L,H,y[x+13],12,-40341101),H=u(H,Y,j,L,y[x+14],17,-1502002290),L=u(L,H,Y,j,y[x+15],22,1236535329),j=p(j,L,H,Y,y[x+1],5,-165796510),Y=p(Y,j,L,H,y[x+6],9,-1069501632),H=p(H,Y,j,L,y[x+11],14,643717713),L=p(L,H,Y,j,y[x+0],20,-373897302),j=p(j,L,H,Y,y[x+5],5,-701558691),Y=p(Y,j,L,H,y[x+10],9,38016083),H=p(H,Y,j,L,y[x+15],14,-660478335),L=p(L,H,Y,j,y[x+4],20,-405537848),j=p(j,L,H,Y,y[x+9],5,568446438),Y=p(Y,j,L,H,y[x+14],9,-1019803690),H=p(H,Y,j,L,y[x+3],14,-187363961),L=p(L,H,Y,j,y[x+8],20,1163531501),j=p(j,L,H,Y,y[x+13],5,-1444681467),Y=p(Y,j,L,H,y[x+2],9,-51403784),H=p(H,Y,j,L,y[x+7],14,1735328473),L=p(L,H,Y,j,y[x+12],20,-1926607734),j=m(j,L,H,Y,y[x+5],4,-378558),Y=m(Y,j,L,H,y[x+8],11,-2022574463),H=m(H,Y,j,L,y[x+11],16,1839030562),L=m(L,H,Y,j,y[x+14],23,-35309556),j=m(j,L,H,Y,y[x+1],4,-1530992060),Y=m(Y,j,L,H,y[x+4],11,1272893353),H=m(H,Y,j,L,y[x+7],16,-155497632),L=m(L,H,Y,j,y[x+10],23,-1094730640),j=m(j,L,H,Y,y[x+13],4,681279174),Y=m(Y,j,L,H,y[x+0],11,-358537222),H=m(H,Y,j,L,y[x+3],16,-722521979),L=m(L,H,Y,j,y[x+6],23,76029189),j=m(j,L,H,Y,y[x+9],4,-640364487),Y=m(Y,j,L,H,y[x+12],11,-421815835),H=m(H,Y,j,L,y[x+15],16,530742520),L=m(L,H,Y,j,y[x+2],23,-995338651),j=g(j,L,H,Y,y[x+0],6,-198630844),Y=g(Y,j,L,H,y[x+7],10,1126891415),H=g(H,Y,j,L,y[x+14],15,-1416354905),L=g(L,H,Y,j,y[x+5],21,-57434055),j=g(j,L,H,Y,y[x+12],6,1700485571),Y=g(Y,j,L,H,y[x+3],10,-1894986606),H=g(H,Y,j,L,y[x+10],15,-1051523),L=g(L,H,Y,j,y[x+1],21,-2054922799),j=g(j,L,H,Y,y[x+8],6,1873313359),Y=g(Y,j,L,H,y[x+15],10,-30611744),H=g(H,Y,j,L,y[x+6],15,-1560198380),L=g(L,H,Y,j,y[x+13],21,1309151649),j=g(j,L,H,Y,y[x+4],6,-145523070),Y=g(Y,j,L,H,y[x+11],10,-1120210379),H=g(H,Y,j,L,y[x+2],15,718787259),L=g(L,H,Y,j,y[x+9],21,-343485551),j=a(j,S),L=a(L,T),H=a(H,C),Y=a(Y,V);return i(j)+i(L)+i(H)+i(Y)}let t0e=1,DV=console,kr=class{static setLogger(t){DV=t}constructor(t,r){xt(this,"id",void 0),xt(this,"lockingPromise",je.resolve()),xt(this,"locks",0),xt(this,"name",""),xt(this,"lockId",void 0),this.lockId=t0e++,t&&(this.name=t),r&&(this.id=r),this.logger("created")}logger(t,r){const i=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),a=t==="created"?"is ".concat(t,"."):"is ".concat(t,", current queue ").concat(this.locks,". ").concat(r??"");DV.debug("".concat(i," ").concat(a))}setId(t){this.id=t}get isLocked(){return this.locks>0}lock(t){let r;this.locks+=1,this.logger("locked",t);const i=new je(l=>{r=()=>{this.locks-=1,this.logger("unlocked",t),l()}}),a=this.lockingPromise.then(()=>r);return this.lockingPromise=this.lockingPromise.then(()=>i),a}};function tm(t,r){return function(i,a,l){const u=l.value;if(typeof u!="function")throw new Error("Cannot use mutex on object property.");return l.value=async function(){const p=this[r];if(!p)throw new Error("mutex property key ".concat(r," doesn't exist on ").concat(t));const m=await p.lock("From ".concat(t,".").concat(a));try{for(var g=arguments.length,y=new Array(g),x=0;x<g;x++)y[x]=arguments[x];return await u.apply(this,y)}finally{m()}},l}}const er={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function qx(t,r){const i=Math.floor(r.timeout*Math.pow(r.timeoutFactor,t));return Math.min(r.maxRetryTimeout,i)}function Uo(t,r,i,a){const l=Object.assign({},er,a);let u=l.timeout;const p=async()=>{await function(y){return new je(x=>{window.setTimeout(x,y)})}(u),u*=l.timeoutFactor,u=Math.min(l.maxRetryTimeout,u)};let m=!1;const g=new je(async(y,x)=>{r=r||(()=>!1),i=i||(()=>!0);for(let S=0;S<l.maxRetryCount;S+=1){if(m)return x(new ge(K.OPERATION_ABORTED));try{const T=await t();if(!r(T,S)||S+1===l.maxRetryCount)return y(T);await p()}catch(T){if(!i(T,S)||S+1===l.maxRetryCount)return x(T);await p()}}});return g.cancel=()=>m=!0,g}let Xx,CA=class{constructor(t){xt(this,"input",[]),xt(this,"size",void 0),this.size=t}add(t){this.input.push(t),this.input.length>this.size&&this.input.splice(0,1)}mean(){var t;return this.input.length===0?0:pa(t=this.input).call(t,(r,i)=>r+i)/this.input.length}},Jx=0,RA=0;function AA(t,r,i,a){return new je((l,u)=>{r.responseType=r.responseType||"json",r.data&&!i?(r.data=JSON.stringify(r.data),Jx+=Tc(r.data)):i&&(r.data.size?Jx+=r.data.size:r.data instanceof FormData?Jx+=AV(r.data):Jx+=Tc(JSON.stringify(r.data))),r.headers=r.headers||{},r.headers["Content-Type"]=r.headers["Content-Type"]||"application/json",r.method="POST",r.url=t,zi.request(r).then(p=>{typeof p.data=="string"?RA+=Tc(p.data):p.data instanceof ArrayBuffer||p.data instanceof Uint8Array?RA+=p.data.byteLength:RA+=Tc(JSON.stringify(p.data)),l(p.data)}).catch(p=>{zi.isCancel(p)?u(new ge(K.OPERATION_ABORTED,"cancel token canceled")):p.code==="ECONNABORTED"?u(new ge(K.NETWORK_TIMEOUT,p.message)):p.response?u(new ge(K.NETWORK_RESPONSE_ERROR,p.response.status)):u(new ge(K.NETWORK_ERROR,p.message))})})}async function n0e(t,r){const i=new Blob([r.data],{type:"buffer"});return await AA(t,Ie(Ie({},r),{},{data:i,headers:{"Content-Type":"application/octet-stream"}}),!0)}const LV=()=>window.isSecureContext!==void 0;function Xa(t){if(Array.isArray(t))return t.map(i=>i);if(!MV(t))return t;const r={};for(const i in t){const a=t[i];MV(a)||Array.isArray(a)?r[i]=Xa(a):r[i]=a}return r}function MV(t){return!(typeof t!="object"||Array.isArray(t)||!t)}let IA=class{constructor(t){xt(this,"input",[]),xt(this,"size",void 0),this.size=t}add(t){this.input.push(t),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}};const Ja={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},x0={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],transport:{bytesSent:0,bytesReceived:0,packetsSent:0,packetsReceived:0},selectedCandidatePair:{id:"unknown",localCandidate:Ja,remoteCandidate:Ja},updateInterval:0},UV={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},FV={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},VV={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},BV={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0,totalSamplesReceived:0,silentConcealedSamples:0,concealmentEvents:0,freezeMs80:0,freezeMs200:0,freezeSamples80:0,freezeSamples200:0};let OA=class{constructor(t,r){xt(this,"onFirstVideoReceived",void 0),xt(this,"onFirstVideoDecoded",void 0),xt(this,"onFirstAudioReceived",void 0),xt(this,"onFirstVideoDecodedTimeout",void 0),xt(this,"onFirstAudioDecoded",void 0),xt(this,"onSelectedLocalCandidateChanged",void 0),xt(this,"onSelectedRemoteCandidateChanged",void 0),xt(this,"videoIsReady",!1),xt(this,"videoIsReady2",{}),xt(this,"pc",void 0),xt(this,"options",void 0),xt(this,"intervalTimer",void 0),xt(this,"stats",Xa(x0)),xt(this,"isFirstVideoReceived",{}),xt(this,"isFirstVideoDecoded",{}),xt(this,"isFirstAudioReceived",{}),xt(this,"isFirstAudioDecoded",{}),xt(this,"isFirstVideoDecodedTimeout",{}),xt(this,"lossRateWindowStats",[]),this.pc=t,this.options=r,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new je(t=>{t({local:Ie({},Ja),remote:Ie({},Ja)})})}setVideoIsReady(t){this.videoIsReady=t}setVideoIsReady2(t,r){this.videoIsReady2[t]=r}getVideoIsReady(t){return this.videoIsReady2[t]||!1}setIsFirstAudioDecoded(t){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(t){this.lossRateWindowStats.push(t),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const r=this.lossRateWindowStats.length,i=["videoSend","audioSend","videoRecv","audioRecv"];let a=0,l=0,u=0,p=0;for(const m of i)t[m].forEach((g,y)=>{if(!this.lossRateWindowStats[r-1][m][y]||!this.lossRateWindowStats[0][m][y])return;const x=this.lossRateWindowStats[r-1][m][y].packets-this.lossRateWindowStats[0][m][y].packets,S=this.lossRateWindowStats[r-1][m][y].packetsLost-this.lossRateWindowStats[0][m][y].packetsLost;m==="videoSend"||m==="audioSend"?(a+=x,u+=S):(l+=x,p+=S),Number.isNaN(x)||Number.isNaN(x)?g.packetLostRate=0:g.packetLostRate=x<=0||S<=0?0:S/(x+S)});t.sendPacketLossRate=a<=0||u<=0?0:u/(a+u),t.recvPacketLossRate=l<=0||p<=0?0:p/(l+p)}},r0e=class extends OA{constructor(){super(...arguments),xt(this,"_stats",x0),xt(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const t=await this._getStats(),r=this.statsResponsesToObjects(t);this._stats=Xa(x0);const i=r.filter(l=>l.type==="ssrc");this.processSSRCStats(i);const a=r.find(l=>l.type==="VideoBwe");a&&this.processBandwidthStats(a),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(t){this._stats.bitrate={actualEncoded:Number(t.googActualEncBitrate),targetEncoded:Number(t.googTargetEncBitrate),retransmit:Number(t.googRetransmitBitrate),transmit:Number(t.googTransmitBitrate)},this._stats.sendBandwidth=Number(t.googAvailableSendBandwidth)}processSSRCStats(t){t.forEach(r=>{var i;const a=Ce(i=r.id).call(i,"send");switch("".concat(r.mediaType,"_").concat(a?"send":"recv")){case"video_send":{const l=Xa(FV);l.codec=r.googCodecName,l.adaptionChangeReason="none",r.googCpuLimitedResolution&&(l.adaptionChangeReason="cpu"),r.googBandwidthLimitedResolution&&(l.adaptionChangeReason="bandwidth"),l.avgEncodeMs=Number(r.googAvgEncodeMs),l.inputFrame={width:Number(r.googFrameWidthInput)||Number(r.googFrameWidthSent),height:Number(r.googFrameHeightInput)||Number(r.googFrameHeightSent),frameRate:Number(r.googFrameRateInput)},l.sentFrame={width:Number(r.googFrameWidthSent),height:Number(r.googFrameHeightSent),frameRate:Number(r.googFrameRateInput)},l.firsCount=Number(r.googFirReceived),l.nacksCount=Number(r.googNacksReceived),l.plisCount=Number(r.googPlisReceived),l.frameCount=Number(r.framesEncoded),l.bytes=Number(r.bytesSent),l.packets=Number(r.packetsSent),l.packetsLost=Number(r.packetsLost),l.ssrc=Number(r.ssrc),l.rttMs=Number(r.googRtt||0),this._stats.videoSend.push(l),this._stats.rtt=l.rttMs;break}case"video_recv":{const l=Xa(UV),u=this.lastDecodeVideoReceiverStats.get(Number(r.ssrc));if(l.codec=r.googCodecName,l.targetDelayMs=Number(r.googTargetDelayMs),l.renderDelayMs=Number(r.googRenderDelayMs),l.currentDelayMs=Number(r.googCurrentDelayMs),l.minPlayoutDelayMs=Number(r.googMinPlayoutDelayMs),l.decodeMs=Number(r.googDecodeMs),l.maxDecodeMs=Number(r.googMaxDecodeMs),l.receivedFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateReceived)},l.decodedFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateDecoded)},l.decodeFrameRate=Number(r.googFrameRateDecoded),l.outputFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateOutput)},l.jitterBufferMs=Number(r.googJitterBufferMs),l.firsCount=Number(r.googFirsSent),l.nacksCount=Number(r.googNacksSent),l.plisCount=Number(r.googPlisSent),l.framesDecodeCount=Number(r.framesDecoded),l.bytes=Number(r.bytesReceived),l.packets=Number(r.packetsReceived),l.packetsLost=Number(r.packetsLost),l.ssrc=Number(r.ssrc),l.packets>0&&!this.isFirstVideoReceived[l.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(l.ssrc),this.isFirstVideoReceived[l.ssrc]=!0),l.framesDecodeCount>0&&!this.isFirstVideoDecoded[l.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(l.ssrc,l.decodedFrame.width,l.decodedFrame.height),this.isFirstVideoDecoded[l.ssrc]=!0),u){const p=u.stats,m=Date.now()-u.lts;l.framesDecodeFreezeTime=p.framesDecodeFreezeTime,l.framesDecodeInterval=p.framesDecodeInterval,l.framesDecodeCount>p.framesDecodeCount&&this.isFirstVideoDecoded[l.ssrc]?(u.lts=Date.now(),l.framesDecodeInterval=m,l.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(r.ssrc,10))?l.framesDecodeFreezeTime+=l.framesDecodeInterval:this.setVideoIsReady2(parseInt(r.ssrc,10),!0))):l.framesDecodeCount<u.stats.framesDecodeCount&&(l.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(l.ssrc,{stats:Ie({},l),lts:Date.now()}),this._stats.videoRecv.push(l);break}case"audio_recv":{const l=Xa(BV);l.codec=r.googCodecName,l.outputLevel=Math.abs(Number(r.audioOutputLevel))/32767,l.decodingCNG=Number(r.googDecodingCNG),l.decodingCTN=Number(r.googDecodingCTN),l.decodingCTSG=Number(r.googDecodingCTSG),l.decodingNormal=Number(r.googDecodingNormal),l.decodingPLC=Number(r.googDecodingPLC),l.decodingPLCCNG=Number(r.googDecodingPLCCNG),l.expandRate=Number(r.googExpandRate),l.accelerateRate=Number(r.googAccelerateRate),l.preemptiveExpandRate=Number(r.googPreemptiveExpandRate),l.secondaryDecodedRate=Number(r.googSecondaryDecodedRate),l.speechExpandRate=Number(r.googSpeechExpandRate),l.preferredJitterBufferMs=Number(r.googPreferredJitterBufferMs),l.jitterBufferMs=Number(r.googJitterBufferMs),l.jitterMs=Number(r.googJitterReceived),l.bytes=Number(r.bytesReceived),l.packets=Number(r.packetsReceived),l.packetsLost=Number(r.packetsLost),l.ssrc=Number(r.ssrc),l.receivedFrames=Number(r.googDecodingCTN)||Number(r.packetsReceived),l.droppedFrames=Number(r.googDecodingPLC)+Number(r.googDecodingPLCCNG)||Number(r.packetsLost),l.receivedFrames>0&&!this.isFirstAudioReceived[l.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(l.ssrc),this.isFirstAudioReceived[l.ssrc]=!0),l.decodingNormal>0&&!this.isFirstAudioDecoded[l.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(l.ssrc),this.isFirstAudioDecoded[l.ssrc]=!0),this._stats.audioRecv.push(l);break}case"audio_send":{const l=Xa(VV);l.codec=r.googCodecName,l.inputLevel=Math.abs(Number(r.audioInputLevel))/32767,l.aecReturnLoss=Number(r.googEchoCancellationReturnLoss||0),l.aecReturnLossEnhancement=Number(r.googEchoCancellationReturnLossEnhancement||0),l.residualEchoLikelihood=Number(r.googResidualEchoLikelihood||0),l.residualEchoLikelihoodRecentMax=Number(r.googResidualEchoLikelihoodRecentMax||0),l.bytes=Number(r.bytesSent),l.packets=Number(r.packetsSent),l.packetsLost=Number(r.packetsLost),l.ssrc=Number(r.ssrc),l.rttMs=Number(r.googRtt||0),this._stats.rtt=l.rttMs,this._stats.audioSend.push(l);break}}})}_getStats(){return new je((t,r)=>{this.pc.getStats(t,r)})}statsResponsesToObjects(t){const r=[];return t.result().forEach(i=>{const a={id:i.id,timestamp:i.timestamp.valueOf().toString(),type:i.type};i.names().forEach(l=>{a[l]=i.stat(l)}),r.push(a)}),r}},nm=function(t){return t.BANDWIDTH="bandwidth",t.CPU="cpu",t.NONE="none",t.OTHER="other",t}({}),Qx=function(t){return t.L1T1="L1T1",t.L1T2="L1T2",t.L1T3="L1T3",t.L1T3_KEY="L1T3_KEY",t.L2T1_KEY="L2T1_KEY",t.L2T2_KEY="L2T2_KEY",t.L2T3_KEY="L2T3_KEY",t.L3T1_KEY="L3T1_KEY",t.L3T2_KEY="L3T2_KEY",t.L3T3_KEY="L3T3_KEY",t}({}),PA=function(t){return t[t.new=0]="new",t[t.connecting=1]="connecting",t[t.connected=2]="connected",t[t.disconnected=3]="disconnected",t[t.failed=4]="failed",t[t.closed=5]="closed",t}({}),Ws=function(t){return t.CERTIFICATE="certificate",t.CODEC="codec",t.CANDIDATE_PAIR="candidate-pair",t.LOCAL_CANDIDATE="local-candidate",t.REMOTE_CANDIDATE="remote-candidate",t.INBOUND="inbound-rtp",t.TRACK="track",t.OUTBOUND="outbound-rtp",t.PC="peer-connection",t.REMOTE_INBOUND="remote-inbound-rtp",t.REMOTE_OUTBOUND="remote-outbound-rtp",t.TRANSPORT="transport",t.CSRC="csrc",t.DATA_CHANNEL="data-channel",t.STREAM="stream",t.SENDER="sender",t.RECEIVER="receiver",t}({});var rm=function(t){return t[t.kNone=1]="kNone",t[t.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",t[t.kBytesToBits=8]="kBytesToBits",t}(rm||{});function _0(t,r,i,a){let l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:rm.kNone;if(!r)return;const u=Number(r[i]);if(typeof u!="number")return;const p=Number(r[a]);if(typeof p!="number")return;if(!t)return p?u/p*l:void 0;const m=Number(t[i]);if(typeof m!="number")return;const g=Number(t[a]);if(typeof g!="number")return;const y=p-g;return y?(u-m)/y*l:void 0}let GV=class extends OA{constructor(){super(...arguments),xt(this,"_stats",x0),xt(this,"report",void 0),xt(this,"lastDecodeVideoReceiverStats",new Map),xt(this,"lastVideoFramesRecv",new Map),xt(this,"lastVideoFramesSent",new Map),xt(this,"lastVideoFramesDecode",new Map),xt(this,"lastVideoFramesOutput",new Map),xt(this,"lastVideoJBDelay",new Map),xt(this,"lastAudioJBDelay",new Map),xt(this,"mediaBytesSent",new Map),xt(this,"mediaBytesRetransmit",new Map),xt(this,"mediaBytesTargetEncode",new Map),xt(this,"lastDecodeAudioReceiverStats",new Map),xt(this,"lastAudioConcealment",new Map),xt(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=Xa(x0),this.report.forEach(t=>{switch(t.type){case Ws.OUTBOUND:case Ws.INBOUND:{const r=t.mediaType||t.kind,i=!r&&"frameWidth"in t,a=!r&&!("frameWidth"in t);t.type===Ws.OUTBOUND?r==="audio"||a?this.processAudioOutboundStats(t):(r==="video"||i)&&this.processVideoOutboundStats(t):t.type===Ws.INBOUND&&(r==="audio"||a?this.processAudioInboundStats(t):(r==="video"||i)&&this.processVideoInboundStats(t));break}case Ws.TRANSPORT:{this.processTransportStats(t);const r=this.report.get(t.selectedCandidatePairId);r&&this.processCandidatePairStats(r);break}case Ws.CANDIDATE_PAIR:t.selected&&this.processCandidatePairStats(t)}}),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const t=await this.pc.getStats(),r={local:Ie({},Ja),remote:Ie({},Ja)};return t.forEach(i=>{let a;if(i.type===Ws.TRANSPORT&&(a=t.get(i.selectedCandidatePairId)),i.type===Ws.CANDIDATE_PAIR&&i.selected&&(a=i),a){const l=(u,p)=>{u.type=p.type,u.id=p.id,p.address&&(u.address=p.address),p.candidateType&&(u.candidateType=p.candidateType),p.port&&(u.port=p.port),p.priority&&(u.priority=p.priority),p.protocol&&(u.protocol=p.protocol),p.relayProtocol&&(u.relayProtocol=p.relayProtocol)};if(a.localCandidateId){const u=t.get(a.localCandidateId);u&&l(r.local,u)}if(a.remoteCandidateId){const u=t.get(a.remoteCandidateId);u&&l(r.remote,u)}}}),r}processCandidatePairStats(t){if(this._stats.sendBandwidth=t.availableOutgoingBitrate||0,t.currentRoundTripTime&&(this._stats.rtt=1e3*t.currentRoundTripTime),this._stats.videoSend.forEach(r=>{t.currentRoundTripTime&&(r.rttMs=1e3*t.currentRoundTripTime)}),this._stats.audioSend.forEach(r=>{t.currentRoundTripTime&&(r.rttMs=1e3*t.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=t.id,t.localCandidateId){const r=this.report.get(t.localCandidateId);r&&this.processCandidateStats(r)}if(t.remoteCandidateId){const r=this.report.get(t.remoteCandidateId);r&&this.processCandidateStats(r)}}processCandidateStats(t){let r;t.type===Ws.LOCAL_CANDIDATE&&(r=this._stats.selectedCandidatePair.localCandidate),t.type===Ws.REMOTE_CANDIDATE&&(r=this._stats.selectedCandidatePair.remoteCandidate),r&&(r.type=t.type,r.id=t.id,t.address&&(r.address=t.address),t.candidateType&&(r.candidateType=t.candidateType),t.port&&(r.port=t.port),t.priority&&(r.priority=t.priority),t.protocol&&(r.protocol=t.protocol),t.relayProtocol&&(r.relayProtocol=t.relayProtocol),t.type===Ws.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==r.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(Ie({},r),Ie({},this.stats.selectedCandidatePair.localCandidate)),t.type===Ws.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==r.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(Ie({},r),Ie({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(t){let r=this._stats.audioRecv.find(a=>a.ssrc===t.ssrc);r||(r=Xa(BV),this._stats.audioRecv.push(r)),r.ssrc=t.ssrc,r.packets=t.packetsReceived,r.packetsLost=t.packetsLost,r.packetsDiscarded=t.packetsDiscarded,r.bytes=t.bytesReceived,r.jitterMs=1e3*t.jitter,r.retransmittedBytesReceived=t.retransmittedBytesReceived,r.retransmittedPacketsReceived=t.retransmittedPacketsReceived,r.totalProcessingDelay=t.totalProcessingDelay,r.jitterBufferEmittedCount=t.jitterBufferEmittedCount,r.estimatedPlayoutTimestamp=t.estimatedPlayoutTimestamp;const i=this.lastDecodeAudioReceiverStats.get(r.ssrc);r.avgProcessingDelayMs=_0(i,r,"totalProcessingDelay","jitterBufferEmittedCount",rm.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(t,t.trackId,r),this.calculateAudioFreeze(r,i,t),t.codecId&&(r.codec=this.getCodecFromCodecStats(t.codecId)),r.receivedFrames||(r.receivedFrames=t.packetsReceived),r.droppedFrames||(r.droppedFrames=t.packetsLost),r.receivedFrames>0&&!this.isFirstAudioReceived[r.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(r.ssrc),this.isFirstAudioReceived[r.ssrc]=!0),r.outputLevel&&r.outputLevel>0&&!this.isFirstAudioDecoded[r.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(r.ssrc),this.isFirstAudioDecoded[r.ssrc]=!0),typeof t.concealedSamples=="number"&&(r.concealedSamples=t.concealedSamples),this.lastDecodeAudioReceiverStats.set(r.ssrc,Ie({},r))}calculateAudioFreeze(t,r,i){const a=this.lastAudioConcealment.get(t.ssrc);if(r!=null&&a!=null){const l=a.lts,u=i.timestamp,p=u-l;if(p<=0)return;const m=t.concealedSamples-r.concealedSamples-0,g=a.nonSilent+m,y=t.totalSamplesReceived-r.totalSamplesReceived;if(y<=0)return;const x=80*y/p,S=200*y/p,T=p/y;let C=0;t.freezeSamples80=r.freezeSamples80,t.freezeMs80=r.freezeMs80,g>x&&(a.plc80>0?(t.freezeSamples80+=m,t.freezeMs80+=Math.round(m*T)):(t.freezeSamples80+=g,t.freezeMs80+=Math.round(g*T)),C=a.plc80+1);let V=0;t.freezeSamples200=r.freezeSamples200,t.freezeMs200=r.freezeMs200,g>S&&(a.plc200>0?(t.freezeSamples200+=m,t.freezeMs200+=Math.round(m*T)):(t.freezeSamples200+=g,t.freezeMs200+=Math.round(g*T)),V=a.plc200+1),this.lastAudioConcealment.set(t.ssrc,{nonSilent:m,lts:u,plc80:C,plc200:V})}else t.freezeSamples80=0,t.freezeSamples200=0,t.freezeMs80=0,t.freezeMs200=0,this.lastAudioConcealment.set(t.ssrc,{nonSilent:0,lts:i.timestamp,plc80:0,plc200:0})}processVideoInboundStats(t){let r=this._stats.videoRecv.find(p=>p.ssrc===t.ssrc);r||(r=Xa(UV),this._stats.videoRecv.push(r)),r.ssrc=t.ssrc,r.packets=t.packetsReceived,r.packetsLost=t.packetsLost,r.bytes=t.bytesReceived,r.firsCount=t.firCount,r.nacksCount=t.nackCount,r.plisCount=t.pliCount,r.framesDecodeCount=t.framesDecoded,r.framesDroppedCount=t.framesDropped,r.totalInterFrameDelay=t.totalInterFrameDelay,r.totalSquaredInterFrameDelay=t.totalSquaredInterFrameDelay,r.totalFreezesDuration=t.totalFreezesDuration,r.totalProcessingDelay=t.totalProcessingDelay,r.packetsDiscarded=t.packetsDiscarded,r.framesAssembledFromMultiplePackets=t.framesAssembledFromMultiplePackets,r.totalAssemblyTime=t.totalAssemblyTime,r.keyFramesDecoded=t.keyFramesDecoded,r.retransmittedBytesReceived=t.retransmittedBytesReceived,r.retransmittedPacketsReceived=t.retransmittedPacketsReceived,r.estimatedPlayoutTimestamp=t.estimatedPlayoutTimestamp;const i=this.lastDecodeVideoReceiverStats.get(r.ssrc),a=this.lastVideoFramesDecode.get(r.ssrc),l=this.lastVideoFramesOutput.get(r.ssrc),u=Date.now();if(r.framesDecodeCount>0&&!this.isFirstVideoDecoded[r.ssrc]){const p=r.decodedFrame?r.decodedFrame.width:0,m=r.decodedFrame?r.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(r.ssrc,p,m),this.isFirstVideoDecoded[r.ssrc]=!0}if(i){const p=i.stats,m=u-i.lts;r.framesDecodeFreezeTime=p.framesDecodeFreezeTime,r.framesDecodeInterval=p.framesDecodeInterval,!this.isFirstVideoDecoded[r.ssrc]&&m>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[r.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(r.ssrc),this.isFirstVideoDecodedTimeout[r.ssrc]=!0),r.framesDecodeCount>p.framesDecodeCount&&this.isFirstVideoDecoded[r.ssrc]?(i.lts=Date.now(),r.framesDecodeInterval=m,r.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(t.ssrc))?r.framesDecodeFreezeTime+=r.framesDecodeInterval:this.setVideoIsReady2(parseInt(t.ssrc,10),!0))):r.framesDecodeCount<p.framesDecodeCount&&(r.framesDecodeInterval=0),t.framesDecoded&&t.qpSum&&(i.stats.framesDecodeCount>t.framesDecoded?r.qpSumPerFrame=t.qpSum/t.framesDecoded:r.qpSumPerFrame=(t.qpSum-i.qpSum)/(t.framesDecoded-i.stats.framesDecodeCount))}t.totalDecodeTime&&(r.decodeMs=1e3*t.totalDecodeTime,r.avgDecodeMs=_0(i==null?void 0:i.stats,r,"decodeMs","framesDecodeCount")),r.avgProcessingDelayMs=_0(i==null?void 0:i.stats,r,"totalProcessingDelay","framesDecodeCount",rm.kMillisecondsFromSeconds),r.avgFramesAssembledFromMultiplePacketsMs=_0(i==null?void 0:i.stats,r,"totalAssemblyTime","framesAssembledFromMultiplePackets",rm.kMillisecondsFromSeconds),r.avgInterFrameDelayMs=_0(i==null?void 0:i.stats,r,"totalInterFrameDelay","framesDecodeCount",rm.kMillisecondsFromSeconds),a&&u-a.lts>=800?(r.decodeFrameRate=Math.round((r.framesDecodeCount-a.count)/((u-a.lts)/1e3)),this.lastVideoFramesDecode.set(r.ssrc,{count:r.framesDecodeCount,lts:u,rate:r.decodeFrameRate})):a?r.decodeFrameRate=a.rate:this.lastVideoFramesDecode.set(r.ssrc,{count:r.framesDecodeCount,lts:u,rate:0}),r.framesDroppedCount&&t.framesReceived&&(l&&u-l.lts>=800?(r.outputFrameRate=Math.round((t.framesReceived-r.framesDroppedCount-l.count)/((u-l.lts)/1e3)),this.lastVideoFramesOutput.set(r.ssrc,{count:t.framesReceived-r.framesDroppedCount,lts:u,rate:Math.max(r.outputFrameRate,0)})):l?r.outputFrameRate=l.rate:this.lastVideoFramesOutput.set(r.ssrc,{count:t.framesReceived-r.framesDroppedCount,lts:u,rate:0})),this.processVideoTrackReceiverStats(t,t.trackId,r),t.codecId&&(r.codec=this.getCodecFromCodecStats(t.codecId)),t.framerateMean&&(r.framesRateFirefox=t.framerateMean),r.packets>0&&!this.isFirstVideoReceived[r.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(r.ssrc),this.isFirstVideoReceived[r.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(r.ssrc,{stats:Ie({},r),lts:i?i.lts:Date.now(),qpSum:t.qpSum})}processVideoOutboundStats(t){let r=this._stats.videoSend.find(a=>a.ssrc===t.ssrc);r||(r=Xa(FV),this._stats.videoSend.push(r));const i=this.mediaBytesSent.get(t.ssrc);if(i)i.add(t.bytesSent);else{const a=new IA(10);a.add(t.bytesSent),this.mediaBytesSent.set(t.ssrc,a)}if(t.retransmittedBytesSent!==void 0){const a=this.mediaBytesRetransmit.get(t.ssrc);if(a)a.add(t.retransmittedBytesSent);else{const l=new IA(10);l.add(t.retransmittedBytesSent),this.mediaBytesRetransmit.set(t.ssrc,l)}}if(t.totalEncodedBytesTarget){const a=this.mediaBytesTargetEncode.get(t.ssrc);if(a)a.add(t.totalEncodedBytesTarget);else{const l=new IA(10);l.add(t.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(t.ssrc,l)}}if(r.ssrc=t.ssrc,r.bytes=t.bytesSent,r.packets=t.packetsSent,r.firsCount=t.firCount,r.nacksCount=t.nackCount,r.plisCount=t.pliCount,r.frameCount=t.framesEncoded,r.adaptionChangeReason=t.qualityLimitationReason,r.scalabilityMode=t.scalabilityMode,r.retransmittedBytesSent=t.retransmittedBytesSent,r.retransmittedPacketsSent=t.retransmittedPacketsSent,r.hugeFramesSent=t.hugeFramesSent,r.keyFramesEncoded=t.keyFramesEncoded,r.targetBitrate=t.targetBitrate,t.totalEncodeTime&&t.framesEncoded){const a=this.lastEncoderMs.get(t.ssrc);if(!a||a.lastFrameCount>t.framesEncoded)r.avgEncodeMs=1e3*t.totalEncodeTime/t.framesEncoded;else{const l=t.framesEncoded-a.lastFrameCount,u=t.totalEncodeTime-a.lastEncoderTime;r.avgEncodeMs=1e3*u/l}}if(t.framesEncoded&&t.qpSum){const a=this.lastEncoderMs.get(t.ssrc);!a||a.lastFrameCount>t.framesEncoded?r.qpSumPerFrame=t.qpSum/t.framesEncoded:r.qpSumPerFrame=(t.qpSum-a.lastQpSum)/(t.framesEncoded-a.lastFrameCount)}if(this.lastEncoderMs.set(t.ssrc,{lastFrameCount:t.framesEncoded,lastEncoderTime:t.totalEncodeTime,lastQpSum:t.qpSum,lts:Date.now()}),t.codecId&&(r.codec=this.getCodecFromCodecStats(t.codecId)),t.mediaSourceId&&this.processVideoMediaSource(t.mediaSourceId,r),this.processVideoTrackSenderStats(t,t.trackId,r),t.remoteId)this.processRemoteInboundStats(t.remoteId,r);else{const a=this.findRemoteStatsId(t.ssrc,Ws.REMOTE_INBOUND);a&&this.processRemoteInboundStats(a,r)}}processAudioOutboundStats(t){let r=this._stats.audioSend.find(i=>i.ssrc===t.ssrc);if(r||(r=Xa(VV),this._stats.audioSend.push(r)),r.ssrc=t.ssrc,r.packets=t.packetsSent,r.bytes=t.bytesSent,r.retransmittedBytesSent=t.retransmittedBytesSent,r.retransmittedPacketsSent=t.retransmittedPacketsSent,t.mediaSourceId&&this.processAudioMediaSource(t.mediaSourceId,r),t.codecId&&(r.codec=this.getCodecFromCodecStats(t.codecId)),this.processAudioTrackSenderStats(t,t.trackId,r),t.remoteId)this.processRemoteInboundStats(t.remoteId,r);else{const i=this.findRemoteStatsId(t.ssrc,Ws.REMOTE_INBOUND);i&&this.processRemoteInboundStats(i,r)}}processTransportStats(t){this._stats.transport.bytesReceived=t.bytesReceived||this._stats.transport.bytesReceived,this._stats.transport.bytesSent=t.bytesSent||this._stats.transport.bytesSent,this._stats.transport.packetsReceived=t.packetsReceived||this._stats.transport.packetsReceived,this._stats.transport.packetsSent=t.packetsSent||this._stats.transport.packetsSent}findRemoteStatsId(t,r){var i;const a=Array.from(Ns(i=this.report).call(i)).find(l=>l.type===r&&l.ssrc===t);return a?a.id:null}processVideoMediaSource(t,r){const i=this.report.get(t);i&&i.width&&i.height&&i.framesPerSecond&&(r.inputFrame={width:i.width,height:i.height,frameRate:i.framesPerSecond})}processAudioMediaSource(t,r){const i=this.report.get(t);i&&(r.inputLevel=i.audioLevel)}processVideoTrackSenderStats(t,r,i){var a,l,u,p;const m=r?this.report.get(r):void 0,g=(a=m==null?void 0:m.framesSent)!==null&&a!==void 0?a:t.framesSent;if(typeof g!="number")return;let y=(l=m==null?void 0:m.frameWidth)!==null&&l!==void 0?l:t.frameWidth,x=(u=m==null?void 0:m.frameHeight)!==null&&u!==void 0?u:t.frameHeight,S=(p=m==null?void 0:m.framesPerSecond)!==null&&p!==void 0?p:t.framesPerSecond;if(typeof y=="number"&&typeof x=="number"||(y=0,x=0),S==null){const T=Date.now(),C=this.lastVideoFramesSent.get(i.ssrc);C&&T-C.lts>=800?(S=Math.round((g-C.count)/((T-C.lts)/1e3)),this.lastVideoFramesSent.set(i.ssrc,{count:g,lts:T,rate:S})):C?S=C.rate:this.lastVideoFramesSent.set(i.ssrc,{count:g,lts:T,rate:0})}i.sentFrame={width:y,height:x,frameRate:Math.max(0,S)}}processVideoTrackReceiverStats(t,r,i){var a,l,u,p,m;const g=r?this.report.get(r):void 0,y=(a=g==null?void 0:g.framesReceived)!==null&&a!==void 0?a:t.framesReceived,x=(l=g==null?void 0:g.frameWidth)!==null&&l!==void 0?l:t.frameWidth,S=(u=g==null?void 0:g.frameHeight)!==null&&u!==void 0?u:t.frameHeight,T=(p=g==null?void 0:g.jitterBufferDelay)!==null&&p!==void 0?p:t.jitterBufferDelay,C=(m=g==null?void 0:g.jitterBufferEmittedCount)!==null&&m!==void 0?m:t.jitterBufferEmittedCount;if(typeof y=="number"){const V=this.lastVideoFramesRecv.get(i.ssrc),j=Date.now();i.framesReceivedCount=y;let L=0;V&&j-V.lts>=800?(L=Math.round((y-V.count)/((j-V.lts)/1e3)),this.lastVideoFramesRecv.set(i.ssrc,{count:y,lts:j,rate:L})):V?L=V.rate:this.lastVideoFramesRecv.set(i.ssrc,{count:y,lts:j,rate:0}),i.receivedFrame={width:x||0,height:S||0,frameRate:L||0},i.decodedFrame={width:x||0,height:S||0,frameRate:i.decodeFrameRate||0},i.outputFrame={width:x||0,height:S||0,frameRate:i.outputFrameRate||i.decodeFrameRate||0}}if(T&&C){const V=this.lastVideoJBDelay.get(i.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let j=V.jitterBufferMs;const L=C-V.jitterBufferEmittedCount;L>0&&(j=1e3*(T-V.jitterBufferDelay)/L),i.jitterBufferMs=j,i.currentDelayMs=Math.round(j),this.lastVideoJBDelay.set(i.ssrc,{jitterBufferDelay:T,jitterBufferEmittedCount:C,jitterBufferMs:i.currentDelayMs})}}processAudioTrackSenderStats(t,r,i){var a,l,u,p;const m=r?this.report.get(r):void 0,g=(a=(l=m==null?void 0:m.echoReturnLoss)!==null&&l!==void 0?l:t.echoReturnLoss)!==null&&a!==void 0?a:0,y=(u=(p=m==null?void 0:m.echoReturnLossEnhancement)!==null&&p!==void 0?p:t.echoReturnLossEnhancement)!==null&&u!==void 0?u:0;i.aecReturnLoss=g,i.aecReturnLossEnhancement=y}processAudioTrackReceiverStats(t,r,i){var a,l,u,p,m,g,y,x,S;const T=r?this.report.get(r):void 0,C=(a=T==null?void 0:T.removedSamplesForAcceleration)!==null&&a!==void 0?a:t.removedSamplesForAcceleration,V=(l=T==null?void 0:T.totalSamplesReceived)!==null&&l!==void 0?l:t.totalSamplesReceived,j=(u=T==null?void 0:T.jitterBufferDelay)!==null&&u!==void 0?u:t.jitterBufferDelay,L=(p=T==null?void 0:T.jitterBufferEmittedCount)!==null&&p!==void 0?p:t.jitterBufferEmittedCount,H=(m=T==null?void 0:T.audioLevel)!==null&&m!==void 0?m:t==null?void 0:t.audioLevel,Y=(g=T==null?void 0:T.totalSamplesDuration)!==null&&g!==void 0?g:t==null?void 0:t.totalSamplesDuration,te=(y=T==null?void 0:T.concealedSamples)!==null&&y!==void 0?y:t.concealedSamples,se=(x=T==null?void 0:T.silentConcealedSamples)!==null&&x!==void 0?x:t.silentConcealedSamples,oe=(S=T==null?void 0:T.concealmentEvents)!==null&&S!==void 0?S:t.concealmentEvents;if(typeof V=="number"&&(i.totalSamplesReceived=V),typeof se=="number"&&(i.silentConcealedSamples=se),typeof oe=="number"&&(i.concealmentEvents=oe),typeof te=="number"&&(i.concealedSamples=te),C&&V&&(i.accelerateRate=C/V),j&&L){const de=this.lastAudioJBDelay.get(i.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let be=de.jitterBufferMs;const Se=L-de.jitterBufferEmittedCount;Se>0&&(be=1e3*(j-de.jitterBufferDelay)/Se),i.jitterBufferMs=Math.round(be),this.lastAudioJBDelay.set(i.ssrc,{jitterBufferDelay:j,jitterBufferEmittedCount:L,jitterBufferMs:i.jitterBufferMs})}i.outputLevel=H;let ne=1920;Y&&V&&(ne=V/Y/50,i.receivedFrames=Math.round(V/ne)),te&&(i.droppedFrames=Math.round(te/ne))}processRemoteInboundStats(t,r){const i=this.report.get(t);i&&(r.packetsLost=i.packetsLost,i.roundTripTime&&(r.rttMs=1e3*i.roundTripTime),i.jitter&&(r.jitterMs=1e3*i.jitter),i.timestamp&&(r.timestamp=i.timestamp))}getCodecFromCodecStats(t){const r=this.report.get(t);if(!r)return"";const i=r.mimeType.match(/\/(.*)$/);return i&&i[1]?i[1]:""}updateSendBitrate(){let t=0,r=null,i=null;this.mediaBytesSent.forEach(l=>{t+=l.diffMean()}),this.mediaBytesRetransmit.forEach(l=>{r=r===null?l.diffMean():r+l.diffMean()}),this.mediaBytesTargetEncode.forEach(l=>{i=i===null?l.diffMean():i+l.diffMean()});const a=r!==null?t-r:t;this._stats.bitrate={actualEncoded:8*a/(this.options.updateInterval/1e3),transmit:8*t/(this.options.updateInterval/1e3)},r!==null&&(this._stats.bitrate.retransmit=8*r/(this.options.updateInterval/1e3)),i!==null&&(this._stats.bitrate.targetEncoded=8*i/(this.options.updateInterval/1e3))}},i0e=class extends OA{updateStats(){return je.resolve()}};function Zx(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const u=function(){const p=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return p&&p[0]?Number(p[0].split("/")[1]):null}();return u?u<76?new r0e(t,{updateInterval:r,lossRateInterval:i,freezeRateLimit:a,firstVideoDecodedTimeout:l}):new GV(t,{updateInterval:r,lossRateInterval:i,freezeRateLimit:a,firstVideoDecodedTimeout:l}):function(p){if(!window.RTCStatsReport)return!1;const m=p.getStats();return!!(m instanceof je||function(g){return!!g&&(typeof g=="object"||typeof g=="function")&&typeof g.then=="function"}(m))}(t)?new GV(t,{updateInterval:r,lossRateInterval:i,freezeRateLimit:a,firstVideoDecodedTimeout:l}):new i0e(t,{updateInterval:r,lossRateInterval:i,freezeRateLimit:a,firstVideoDecodedTimeout:l})}const WV="websdk_ng_install_id";function kA(){try{if(W("INSTALL_ID"))return W("INSTALL_ID");let t=window.localStorage.getItem(WV);return t||(t=Hu(),window.localStorage.setItem(WV,t)),cn("INSTALL_ID",t),t}catch{return}}const fa=function(t){if(t.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return t;const r=t.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(r&&r[1]&&r[2]){const i=r[1],a=r[2];return"".concat(i,".").concat(a)}return"4.0.0.999"}("4.24.2"),jA=function(){try{return JSON.parse("true")===!0}catch{return!0}}();let Ku=function(t){return t.Default="default",t.Auto="auto",t.Relay="relay",t.SdRtn="sd-rtn",t}({});const Zr=function(){const t="us".concat("erna","me"),r="pa".concat("sswo","rd"),i=["t","s","t"];i.splice(1,0,"e");const a=i.join(""),l=[];for(let m=0;m<6;m++)l.push("1");const u=l.join(""),p={};return p[t]=a,p[r]=u,Object.assign(p,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=Zr;const e_={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!0,FORCE_ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:1,ENABLE_AUT_FEEDBACK:!0,SVC_EXTENDED:["VP9"]},DA={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},LA="v4.24.2-0-g002485b1-dirty(12/12/2025, 5:26:54 PM)",MA={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"],FIRST_TCP_CANDIDATE:!1,FIRST_TCP_CANDIDATE_INTERVAL:1e3,TURN_DOMAIN:"edge.agora.io",TURN_DOMAINS:["edge.agora.io"],USE_TURN_IP:!0,NEW_TURN_MODE:4,NEW_FORCE_TURN:!1,USE_NEW_RENDER_FREEZE_TIME:!1,FLS_FALLBACK_TIMEOUT:3e4,RTE_DETAIL_REPORT_INTERVAL:6e4,ENCODE_EXCEPTION_TIMES:5,ENABLE_ENCODE_EXCEPTION:!0,ENCODE_EXCEPTION_VALIDATE_CODEC:["h264"],VIDEO_ENCODER_CONFIG_LIST:[{width:240,height:180},{width:320,height:240},{width:400,height:300},{width:480,height:360},{width:560,height:420},{width:640,height:480}],DELETE_NEQ_AFTER_USER_LEAVE:!0,UPDATE_RTP_CAP_IN_HOST:!1,IOS_BG_TAG:!0,IOS_AUTO_RESTART_BG_TAG:!0,IGNORE_UID_CHECK:!1,ENABLE_UP_SPS_PPS:!1,ENABLE_DOWN_SPS_PPS:!1,NO_EDGES_RETRY:!0,BUFFER_READY_FRAMES:3,FLS_SYNC_AV_PLAY_LIMIT:0,FLS_BUFFER_WAIT_TIME:1500,VOS_CONFIGURE:void 0,ENABLE_QUALITY_FALLBACK:!1,QUALITY_FALLBACK_REHEARSAL:!0,ENABLE_FLS_AV1_FIRST:!1,ENABLE_AP_MULTI_IP:!0,FLS_ENABLE_AV1_DETECT:!0,FLS_ENABLE_AV1_DECODE_DETECT:!0},nn=Ie(Ie(Ie(Ie({},MA),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_MANAGER_WSS:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,ENABLE_AUDIO_PTS:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_WSS:"",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ENABLE_AUDIO_RED:!1,OPUS_PTIME:void 0,AUDIO_DUPLICATE_NUM:void 0,ENABLE_ABSSENDTIME_AS_SENTTS:!0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,DC_JOIN_WITH_FAILBACK:4e3,DC_CONNECTION_TIMEOUT:2e3,DC_PINGPONG_INTERVAL:2e3,DC_DEBUG_LOG:!1,UNSUPPORTED_VIDEO_UPLINK_CODEC:[],UNSUPPORTED_VIDEO_DOWNLINK_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:DA,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},e_),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,REMOTE_VIDEO_STREAM_TYPE:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1,ENABLE_FORCE_HLS:!1,MAX_WEBAUDIO_VOLUME:300,ENABLE_VOS_FALLBACK:!1,ENABLE_FALLBACK_TO_HLS:!1,ENABLE_PRE_RENDER:!1,FORCE_DISABLE_AUTO_SUB:!1,ENABLE_PRE_SUB_WITH_PRE_PC:!0,PRE_USE_LOCAL_CODECS:!0},{INSTALL_ID:""}),{},{K_MIN_RENDER_DELAY:66,USE_STANDARD_BITRATE_DEFAULT:!1,VIDEO_NEW_BITRATE_RATIO:void 0,VIDEO_STANDARD_BITRATE_VERSION:2,BASELINE_MORE_H264_BITRATE_RATIO:1.1,IGNORE_RTC_DEVICE_CHECK:!1,FLS_AUTOPLAY_EMITS:!1,ENABLE_DUAL_STREAM_FLAG:!1,FORBID_MODIFY_LOCAL_OFFER_SDP:!1,RESERVE_MID_1_MLINE:!1});function cn(t,r,i){var a,l,u;Ce(a=Object.keys(nn)).call(a,t)&&(!i&&Ce(l=Object.keys($s)).call(l,t)||(nn[t]=r,t!=="ENABLE_VIDEO_SEI"&&t!=="ENABLE_AUDIO_TOPN"&&t!=="ENABLE_AUDIO_METADATA"&&t!=="ENABLE_AUDIO_PTS"||r!==!0||(nn.ENABLE_ENCODED_TRANSFORM=!0),t==="USE_NEW_NETWORK_CONFIG"&&r&&(u=!!r,nn.USE_NEW_NETWORK_CONFIG=u,u&&(nn.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],nn.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],nn.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],nn.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],nn.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",nn.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",nn.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),t==="ENABLE_PRE_SUB"&&r&&(nn.ENABLE_INSTANT_VIDEO=!0,nn.ENABLE_PREALLOC_PC=!0),t==="ENABLE_SVC"&&r&&(nn.ENABLE_AUT_CC=!0),t==="NEW_FORCE_TURN"&&r&&(nn.NEW_TURN_MODE||(nn.NEW_TURN_MODE=4))))}function W(t){if(t==="TURN_DOMAINS"){const r=nn.TURN_DOMAINS;return Ce(r).call(r,W("TURN_DOMAIN"))?r:[W("TURN_DOMAIN")].concat(r)}return nn[t]}jA||(nn.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],nn.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],nn.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],nn.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],nn.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],nn.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],nn.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",nn.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",nn.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",nn.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",nn.AREAS=["NORTH_AMERICA","OVERSEA"]);let $V=function(t){return t[t.REALTIME=1]="REALTIME",t}({});const $s={};var gt=function(t){return t.SET_SESSION_ID="SET_SESSION_ID",t.SET_RTE_URL="SET_RTE_URL",t.SET_RTE_SID="SET_RTE_SID",t.SET_P2P_ID="SET_P2P_id",t.SET_DC_ID="SET_DC_id",t.SET_UID="SET_UID",t.SET_INT_UID="SET_INT_UID",t.SET_PUB_ID="SET_PUB_ID",t.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",t.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",t.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",t.KEY_METRIC_PRELOAD_START="KEY_METRIC_PRELOAD_START",t.KEY_METRIC_PRELOAD_END="KEY_METRIC_PRELOAD_END",t.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",t.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",t.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",t.KEY_METRIC_REQUEST_SUA_END="KEY_METRIC_REQUEST_SUA_END",t.KEY_METRIC_BEFORE_CONNECT="KEY_METRIC_BEFORE_CONNECT",t.KEY_METRIC_PEER_RECEIVER="KEY_METRIC_PEER_RECEIVER",t.KEY_METRIC_SIGNAL_CONNECTED="KEY_METRIC_SIGNAL_CONNECTED",t.KEY_METRIC_JOIN_REQ="KEY_METRIC_JOIN_REQ",t.KEY_METRIC_JOIN_REP="KEY_METRIC_JOIN_REP",t.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",t.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",t.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",t.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",t.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED="KEY_METRIC_FIRST_VIDEO_FRAME_DECODED",t.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",t.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",t.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",t.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",t.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",t.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",t.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",t.RESET_KEY_METRICS="RESET_KEY_METRICS",t.RESET_FIRST_VIDEO_FRAME_DECODED="RESET_FIRST_VIDEO_FRAME_DECODED",t.SET_USE_P2P="SET_USE_P2P",t.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",t}(gt||{});let Yu=function(t){return t.h264="h264",t.h265="h265",t.vp8="vp8",t.vp9="vp9",t.av1="av1",t}({});(function(t){t.opus="opus",t.pcma="pcma",t.pcmu="pcmu",t.g722="g722"})({});const zV=128,s0e=96,HV=1e3,im=10;let a0e=0;var KV=(()=>{var t={8:(a,l,u)=>{u.r(l),u.d(l,{Parser:()=>Se,Printer:()=>Et,parse:()=>Oe,print:()=>He});const p=`
`,m="".concat("\r").concat(p),g=" ";let y;function x(we){return we>="0"&&we<="9"}function S(we){return we>="!"&&we<="~"}function T(we){return S(we)||we>=""&&we<=""}function C(we){return we==="!"||we>="#"&&we<="'"||we>="*"&&we<="+"||we>="-"&&we<="."||we>="0"&&we<="9"||we>="A"&&we<="Z"||we>="^"&&we<="~"}function V(we){return we>="1"&&we<="9"}function j(we){return we>="A"&&we<="Z"||we>="a"&&we<="z"}function L(we){return we==="d"||we==="h"||we==="m"||we==="s"}function H(we){return we>""&&we<"	"||we>"\v"&&we<"\f"||we>""&&we<""}function Y(we){return j(we)||x(we)||we==="+"||we==="/"}function te(we){return x(we)||j(we)||we==="+"||we==="/"||we==="-"||we==="_"}function se(we){return j(we)||x(we)||we==="+"||we==="/"}function oe(we,k){var Z=Object.keys(we);if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(we);k&&(ie=ie.filter(function(Ae){return Object.getOwnPropertyDescriptor(we,Ae).enumerable})),Z.push.apply(Z,ie)}return Z}function ne(we){for(var k=1;k<arguments.length;k++){var Z=arguments[k]!=null?arguments[k]:{};k%2?oe(Object(Z),!0).forEach(function(ie){de(we,ie,Z[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(we,Object.getOwnPropertyDescriptors(Z)):oe(Object(Z)).forEach(function(ie){Object.defineProperty(we,ie,Object.getOwnPropertyDescriptor(Z,ie))})}return we}function de(we,k,Z){return k in we?Object.defineProperty(we,k,{value:Z,enumerable:!0,configurable:!0,writable:!0}):we[k]=Z,we}(function(we){we.VERSION="v",we.ORIGIN="o",we.SESSION_NAME="s",we.INFORMATION="i",we.URI="u",we.EMAIL="e",we.PHONE="p",we.CONNECTION="c",we.BANDWIDTH="b",we.TIME="t",we.REPEAT="r",we.ZONE_ADJUSTMENTS="z",we.KEY="k",we.ATTRIBUTE="a",we.MEDIA="m"})(y||(y={}));class be{consumeText(k,Z){let ie=Z;for(;ie<k.length;){const Ae=k[ie];if(Ae==="\0"||Ae==="\r"||Ae===p)break;ie+=1}if(ie-Z==0)throw new Error("Invalid text, at ".concat(k));return ie}consumeUnicastAddress(k,Z,ie){return this.consumeTill(k,Z,g)}consumeOneOrMore(k,Z,ie){let Ae=Z;for(;ie(k[Ae]);)Ae++;if(Ae-Z==0)throw new Error("Invalid rule at ".concat(Z,"."));return Ae}consumeSpace(k,Z){if(k[Z]===g)return Z+1;throw new Error("Invalid space at ".concat(Z,"."))}consumeIP4Address(k,Z){let ie=Z;for(let Ae=0;Ae<4;Ae++)if(ie=this.consumeDecimalUChar(k,ie),Ae!==3){if(k[ie]!==".")throw new Error("Invalid IP4 address.");ie++}return ie}consumeDecimalUChar(k,Z){let ie=Z;for(let bt=0;bt<3&&x(k[ie]);bt++,ie++);if(ie-Z==0)throw new Error("Invalid decimal uchar.");const Ae=parseInt(k.slice(Z,ie));if(Ae>=0&&Ae<=255)return ie;throw new Error("Invalid decimal uchar")}consumeIP6Address(k,Z){let ie=this.consumeHexpart(k,Z);return k[ie]===":"&&(ie+=1,ie=this.consumeIP4Address(k,ie)),ie}consumeHexpart(k,Z){let ie=Z;if(k[ie]===":"&&k[ie+1]===":"){ie+=2;try{ie=this.consumeHexseq(k,ie)}catch{}return ie}if(ie=this.consumeHexseq(k,ie),k[ie]===":"&&k[ie+1]===":"){ie+=2;try{ie=this.consumeHexseq(k,ie)}catch{}return ie}return ie}consumeHexseq(k,Z){let ie=Z;for(;ie=this.consumeHex4(k,ie),k[ie]===":"&&k[ie+1]!==":";)ie+=1;return ie}consumeHex4(k,Z){let ie=0;for(;ie<4;ie++)if(!((Ae=k[Z+ie])>="0"&&Ae<="9"||Ae>="a"&&Ae<="f"||Ae>="A"&&Ae<="F")){if(ie===0)throw new Error("Invalid hex 4");break}var Ae;return Z+ie}consumeFQDN(k,Z){let ie=Z;for(;x(k[ie])||j(k[ie])||k[ie]==="-"||k[ie]===".";)ie+=1;if(ie-Z<4)throw new Error("Invalid FQDN");return ie}consumeExtnAddr(k,Z){return this.consumeOneOrMore(k,Z,T)}consumeMulticastAddress(k,Z,ie){switch(ie){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(k,Z);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(k,Z);default:try{return this.consumeFQDN(k,Z)}catch{return this.consumeExtnAddr(k,Z)}}}consumeIP6MulticastAddress(k,Z){const ie=this.consumeHexpart(k,Z);return k[ie]==="/"?this.consumeInteger(k,ie+1):ie}consumeIP4MulticastAddress(k,Z){let ie=Z+3;const Ae=k.slice(Z,ie),bt=parseInt(Ae);if(bt<224||bt>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let yn=0;yn<3;yn++){if(k[ie]!==".")throw new Error("Invalid IP4 multicast address.");ie+=1,ie=this.consumeDecimalUChar(k,ie)}return k[ie]==="/"&&(ie+=1),ie=this.consumeTTL(k,ie),k[ie]==="/"&&(ie=this.consumeInteger(k,ie)),ie}consumeInteger(k,Z){if(!V(k[Z]))throw new Error("Invalid integer.");for(Z+=1;x(k[Z]);)Z+=1;return Z}consumeTTL(k,Z){if(k[Z]==="0")return Z+1;if(!V(k[Z]))throw new Error("Invalid TTL.");Z+=1;for(let ie=0;ie<2&&x(k[Z]);ie++)Z+=1;return Z}consumeToken(k,Z){return this.consumeOneOrMore(k,Z,C)}consumeTime(k,Z){let ie=Z;if(k[ie]==="0")return ie+1;for(V(k[ie])&&(ie+=1);x(k[ie]);)ie++;if(ie-Z<10)throw new Error("Invalid time");return ie}consumeAddress(k,Z){return this.consumeTill(k,Z,g)}consumeTypedTime(k,Z){let ie=Z;return ie=this.consumeOneOrMore(k,ie,x),L(k[ie])?ie+1:ie}consumeRepeatInterval(k,Z){if(!V(k[Z]))throw new Error("Invalid repeat interval");for(Z+=1;x(k[Z]);)Z+=1;return L(k[Z])&&(Z+=1),Z}consumePort(k,Z){return this.consumeOneOrMore(k,Z,x)}consume(k,Z,ie){for(let Ae=0;Ae<ie.length;Ae++){if(Z+Ae>=k.length)throw new Error("consume exceeding value length");if(k[Z+Ae]!==ie[Ae])throw new Error("consume ".concat(ie," failed at ").concat(Ae))}return Z+ie.length}consumeTill(k,Z,ie){let Ae=Z;for(;Ae<k.length&&(typeof ie!="string"||k[Ae]!==ie)&&(typeof ie!="function"||!ie(k[Ae]));)Ae++;return Ae}}class Se extends be{constructor(){super(),de(this,"records",[]),de(this,"currentLine",0)}parse(k){const Z=this.probeEOL(k);this.records=k.split(Z).filter(jd=>!!Ii(jd).call(jd)).map(this.parseLine),this.currentLine=0;const ie=this.parseVersion(),Ae=this.parseOrigin(),bt=this.parseSessionName(),yn=this.parseInformation(),Nr=this.parseUri(),Sa=this.parseEmail(),kd=this.parsePhone(),gE=this.parseConnection(),Lm=this.parseBandWidth(),vE=this.parseTimeFields(),yh=this.parseKey(),sv=this.parseSessionAttribute(),bh=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:ie,origin:Ae,sessionName:bt,information:yn,uri:Nr,emails:Sa,phones:kd,connection:gE,bandwidths:Lm,timeFields:vE,key:yh,attributes:sv,mediaDescriptions:bh}}getCurrentRecord(){const k=this.records[this.currentLine];if(!k)throw new Error("Record doesn't exit.");return k}probeEOL(k){for(let Z=0;Z<k.length;Z++)if(k[Z]===p)return k[Z-1]==="\r"?m:p;throw new Error("Invalid newline character.")}parseLine(k,Z){if(k.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const ie=k[0];if(k[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:ie,value:k.slice(2),line:Z,cur:0}}parseSessionAttribute(){const k=new mt;for(;this.currentLine<this.records.length;){const Z=this.getCurrentRecord();if(Z.type!==y.ATTRIBUTE)break;const ie={attField:this.extractOneOrMore(Z,Ae=>C(Ae)&&Ae!==":"),_cur:0};Z.value[Z.cur]===":"&&(Z.cur+=1,ie.attValue=this.extractOneOrMore(Z,H)),k.parse(ie),this.currentLine++}return k.digest()}parseMediaAttributes(k){const Z=new ut(k);for(;this.currentLine<this.records.length;){const ie=this.getCurrentRecord();if(ie.type!==y.ATTRIBUTE)break;const Ae={attField:this.extractOneOrMore(ie,bt=>C(bt)&&bt!==":"),_cur:0};ie.value[ie.cur]===":"&&(ie.cur+=1,Ae.attValue=this.extractOneOrMore(ie,H)),Z.parse(Ae),this.currentLine++}return Z.digest()}parseKey(){const k=this.getCurrentRecord();if(k.type===y.KEY){if(k.value==="prompt"||k.value==="clear:"||k.value==="base64:"||k.value==="uri:")return k.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const k=this.getCurrentRecord();if(k.type===y.ZONE_ADJUSTMENTS){const Z=[];for(;;)try{const ie=this.extract(k,this.consumeTime);this.consumeSpaceForRecord(k);let Ae=!1;k.value[k.cur]==="-"&&(Ae=!0,k.cur+=1);const bt=this.extract(k,this.consumeTypedTime);Z.push({time:ie,typedTime:bt,back:Ae})}catch{break}if(Z.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,Z}return[]}parseRepeat(){const k=[];for(;;){const Z=this.getCurrentRecord();if(Z.type!==y.REPEAT)break;{const ie=this.extract(Z,this.consumeRepeatInterval),Ae=this.parseTypedTime(Z);k.push({repeatInterval:ie,typedTimes:Ae}),this.currentLine++}}return k}parseTypedTime(k){const Z=[];for(;;)try{this.consumeSpaceForRecord(k),Z.push(this.extract(k,this.consumeTypedTime))}catch{break}if(Z.length===0)throw new Error("Invalid typed time.");return Z}parseTime(){const k=this.getCurrentRecord(),Z=this.extract(k,this.consumeTime);this.consumeSpaceForRecord(k);const ie=this.extract(k,this.consumeTime);return this.currentLine++,{startTime:Z,stopTime:ie}}parseBandWidth(){const k=[];for(;this.currentLine<this.records.length;){const Z=this.getCurrentRecord();if(Z.type!==y.BANDWIDTH)break;{const ie=this.extractOneOrMore(Z,C);if(Z.value[Z.cur]!==":")throw new Error("Invalid bandwidth field.");Z.cur++;const Ae=this.extractOneOrMore(Z,x);k.push({bwtype:ie,bandwidth:Ae}),this.currentLine++}}return k}parseVersion(){const k=this.getCurrentRecord();if(k.type!==y.VERSION)throw new Error("first sdp record must be version");const Z=k.value.slice(0,this.consumeOneOrMore(k.value,0,x));if(Z.length!==k.value.length)throw new Error('invalid proto version, "v='.concat(k.value,'"'));return this.currentLine++,Z}parseOrigin(){const k=this.getCurrentRecord();if(k.type!==y.ORIGIN)throw new Error("second line of sdp must be origin");const Z=this.extractOneOrMore(k,T);this.consumeSpaceForRecord(k);const ie=this.extractOneOrMore(k,x);this.consumeSpaceForRecord(k);const Ae=this.extractOneOrMore(k,x);this.consumeSpaceForRecord(k);const bt=this.extractOneOrMore(k,C);this.consumeSpaceForRecord(k);const yn=this.extractOneOrMore(k,C);this.consumeSpaceForRecord(k);const Nr=this.extract(k,this.consumeUnicastAddress);return this.currentLine++,{username:Z,sessId:ie,sessVersion:Ae,nettype:bt,addrtype:yn,unicastAddress:Nr}}parseSessionName(){const k=this.getCurrentRecord();if(k.type===y.SESSION_NAME){const Z=this.extract(k,this.consumeText);return this.currentLine++,Z}}parseInformation(){const k=this.getCurrentRecord();if(k.type!==y.INFORMATION)return;const Z=this.extract(k,this.consumeText);return this.currentLine++,Z}parseUri(){const k=this.getCurrentRecord();if(k.type===y.URI)return this.currentLine++,k.value}parseEmail(){const k=[];for(;;){const Z=this.getCurrentRecord();if(Z.type!==y.EMAIL)break;k.push(Z.value),this.currentLine++}return k}parsePhone(){const k=[];for(;;){const Z=this.getCurrentRecord();if(Z.type!==y.PHONE)break;k.push(Z.value),this.currentLine++}return k}parseConnection(){const k=this.getCurrentRecord();if(k.type===y.CONNECTION){const Z=this.extractOneOrMore(k,C);this.consumeSpaceForRecord(k);const ie=this.extractOneOrMore(k,C);this.consumeSpaceForRecord(k);const Ae=this.extract(k,this.consumeAddress);return this.currentLine++,{nettype:Z,addrtype:ie,address:Ae}}}parseMedia(){const k=this.getCurrentRecord(),Z=this.extract(k,this.consumeToken);this.consumeSpaceForRecord(k);let ie=this.extract(k,this.consumePort);k.value[k.cur]==="/"&&(k.cur+=1,ie+=this.extract(k,this.consumeInteger)),this.consumeSpaceForRecord(k);const Ae=[];for(Ae.push(this.extract(k,this.consumeToken));k.value[k.cur]==="/";)k.cur+=1,Ae.push(this.extract(k,this.consumeToken));if(Ae.length===0)throw new Error("Invalid proto");const bt=this.parseFmt(k);return this.currentLine++,{mediaType:Z,port:ie,protos:Ae,fmts:bt}}parseTimeFields(){const k=[];for(;this.getCurrentRecord().type===y.TIME;){const Z=this.parseTime(),ie=this.parseRepeat(),Ae=this.parseZone();k.push({time:Z,repeats:ie,zones:Ae})}return k}parseMediaDescription(){const k=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===y.MEDIA;){const Z=this.parseMedia(),ie=this.parseInformation(),Ae=this.parseConnections(),bt=this.parseBandWidth(),yn=this.parseKey(),Nr=this.parseMediaAttributes(Z);k.push({media:Z,information:ie,connections:Ae,bandwidths:bt,key:yn,attributes:Nr})}return k}parseConnections(){const k=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===y.CONNECTION;)k.push(this.parseConnection());return k}parseFmt(k){const Z=[];for(;;)try{this.consumeSpaceForRecord(k),Z.push(this.extract(k,this.consumeToken))}catch{break}if(Z.length===0)throw new Error("Invalid fmts");return Z}extract(k,Z){for(var ie=arguments.length,Ae=new Array(ie>2?ie-2:0),bt=2;bt<ie;bt++)Ae[bt-2]=arguments[bt];const yn=Z.call(this,k.value,k.cur,...Ae),Nr=k.value.slice(k.cur,yn);return k.cur=yn,Nr}extractOneOrMore(k,Z){const ie=this.consumeOneOrMore(k.value,k.cur,Z),Ae=k.value.slice(k.cur,ie);return k.cur=ie,Ae}consumeSpaceForRecord(k){if(k.value[k.cur]!==g)throw new Error("Invalid space at ".concat(k.cur,"."));k.cur+=1}}class Be extends be{constructor(){super(...arguments),de(this,"attributes",void 0),de(this,"digested",!1)}extractOneOrMore(k,Z,ie){const Ae=this.consumeOneOrMore(k.attValue,k._cur,Z),bt=k.attValue.slice(k._cur,Ae),[yn,Nr]=ie||[];if(typeof yn=="number"&&bt.length<yn)throw new Error("error in length, should be more or equal than ".concat(yn," characters."));if(typeof Nr=="number"&&bt.length>Nr)throw new Error("error in length, should be less or equal than ".concat(Nr," characters."));return k._cur=Ae,bt}consumeAttributeSpace(k){if(k.attValue[k._cur]!==g)throw new Error("Invalid space at ".concat(k._cur,"."));k._cur+=1}extract(k,Z){if(!k.attValue)throw new Error("Nothing to extract from attValue.");for(var ie=arguments.length,Ae=new Array(ie>2?ie-2:0),bt=2;bt<ie;bt++)Ae[bt-2]=arguments[bt];const yn=Z.call(this,k.attValue,k._cur,...Ae),Nr=k.attValue.slice(k._cur,yn);return k._cur=yn,Nr}atEnd(k){if(!k.attValue)throw new Error;return k._cur>=k.attValue.length}peekChar(k){if(!k.attValue)throw new Error;return k.attValue[k._cur]}peek(k,Z){if(!k.attValue)throw new Error;for(let ie=0;ie<Z.length;ie++)if(Z[ie]!==k.attValue[k._cur+ie])return!1;return!0}parseIceUfrag(k){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(k,Y,[4,256])}parseIcePwd(k){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(k,Y,[22,256])}parseIceOptions(k){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const Z=[];for(;!this.atEnd(k);){Z.push(this.extractOneOrMore(k,Y));try{this.consumeAttributeSpace(k)}catch(ie){if(this.atEnd(k))break;throw ie}}this.attributes.iceOptions=Z}parseFingerprint(k){const Z=this.extract(k,this.consumeToken);this.consumeAttributeSpace(k);const ie=this.extract(k,this.consumeTill);this.attributes.fingerprints.push({hashFunction:Z,fingerprint:ie})}parseExtmap(k){const Z=this.extractOneOrMore(k,x);let ie;this.peekChar(k)==="/"&&(this.extract(k,this.consume,"/"),ie=this.extract(k,this.consumeToken)),this.consumeAttributeSpace(k);const Ae=this.extract(k,this.consumeTill,g),bt=ne(ne({entry:parseInt(Z,10)},ie&&{direction:ie}),{},{extensionName:Ae});this.peekChar(k)===g&&(this.consumeAttributeSpace(k),bt.extensionAttributes=this.extract(k,this.consumeTill)),this.attributes.extmaps.push(bt)}parseSetup(k){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const Z=this.extract(k,this.consumeTill);if(Z!=="active"&&Z!=="passive"&&Z!=="actpass"&&Z!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=Z}}class mt extends Be{constructor(){super(...arguments),de(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(k){if(this.digested)throw new Error("already digested");try{switch(k.attField){case"group":this.parseGroup(k);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(k);break;case"ice-pwd":this.parseIcePwd(k);break;case"ice-options":this.parseIceOptions(k);break;case"fingerprint":this.parseFingerprint(k);break;case"setup":this.parseSetup(k);break;case"tls-id":this.parseTlsId(k);break;case"identity":this.parseIdentity(k);break;case"extmap":this.parseExtmap(k);break;case"msid-semantic":this.parseMsidSemantic(k);break;default:k.ignored=!0,this.attributes.unrecognized.push(k)}}catch(Z){throw console.error("parsing session attribute ".concat(k.attField,' error, "a=').concat(k.attField,":").concat(k.attValue,'"')),Z}if(!k.ignored&&k.attValue&&!this.atEnd(k))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(k){const Z=this.extract(k,this.consumeToken),ie=[];for(;!this.atEnd(k)&&this.peekChar(k)===g;)this.consumeAttributeSpace(k),ie.push(this.extract(k,this.consumeToken));this.attributes.groups.push({semantic:Z,identificationTag:ie})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(k){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(k,te)}parseIdentity(k){const Z=this.extractOneOrMore(k,se),ie=[];for(;!this.atEnd(k)&&this.peekChar(k)===g;){this.consumeAttributeSpace(k);const Ae=this.extract(k,this.consumeToken);this.extract(k,this.consume,"=");const bt=this.extractOneOrMore(k,yn=>yn!==g&&H(yn));ie.push({name:Ae,value:bt})}this.attributes.identities.push({assertionValue:Z,extensions:ie})}parseMsidSemantic(k){this.peekChar(k)===g&&this.consumeAttributeSpace(k);const Z={semantic:this.extract(k,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(k)}catch{break}if(this.peekChar(k)==="*"){this.extract(k,this.consume,"*"),Z.applyForAll=!0;break}{const ie=this.extract(k,this.consumeTill,g);Z.identifierList.push(ie)}}this.attributes.msidSemantic=Z}}class ut extends Be{constructor(k){super(),de(this,"attributes",void 0),k.protos.indexOf("RTP")!==-1||k.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(k){if(this.digested)throw new Error("already digested");try{switch(k.attField){case"extmap":this.parseExtmap(k);break;case"setup":this.parseSetup(k);break;case"ice-ufrag":this.parseIceUfrag(k);break;case"ice-pwd":this.parseIcePwd(k);break;case"ice-options":this.parseIceOptions(k);break;case"candidate":this.parseCandidate(k);break;case"remote-candidate":this.parseRemoteCandidate(k);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(k);break;case"rtpmap":this.parseRtpmap(k);break;case"ptime":this.parsePtime(k);break;case"maxptime":this.parseMaxPtime(k);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(k);break;case"ssrc":this.parseSSRC(k);break;case"fmtp":this.parseFmtp(k);break;case"rtcp-fb":this.parseRtcpFb(k);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(k);break;case"mid":this.parseMid(k);break;case"msid":this.parseMsid(k);break;case"imageattr":this.parseImageAttr(k);break;case"rid":this.parseRid(k);break;case"simulcast":this.parseSimulcast(k);break;case"sctp-port":this.parseSctpPort(k);break;case"max-message-size":this.parseMaxMessageSize(k);break;case"ssrc-group":this.parseSSRCGroup(k);break;default:k.ignored=!0,this.attributes.unrecognized.push(k)}}catch(Z){throw console.error("parsing media attribute ".concat(k.attField,' error, "a=').concat(k.attField,":").concat(k.attValue,'"')),Z}if(!k.ignored&&k.attValue&&!this.atEnd(k))throw new Error("attribute parsing error")}parseCandidate(k){const Z=this.extractOneOrMore(k,Y,[1,32]);this.consumeAttributeSpace(k);const ie=this.extractOneOrMore(k,x,[1,5]);this.consumeAttributeSpace(k);const Ae=this.extract(k,this.consumeToken);this.consumeAttributeSpace(k);const bt=this.extractOneOrMore(k,x,[1,10]);this.consumeAttributeSpace(k);const yn=this.extract(k,this.consumeAddress);this.consumeAttributeSpace(k);const Nr=this.extract(k,this.consumePort);this.consumeAttributeSpace(k),this.extract(k,this.consume,"typ"),this.consumeAttributeSpace(k);const Sa={foundation:Z,componentId:ie,transport:Ae,priority:bt,connectionAddress:yn,port:Nr,type:this.extract(k,this.consumeToken),extension:{}};for(this.peek(k," raddr")&&(this.extract(k,this.consume," raddr"),this.consumeAttributeSpace(k),Sa.relAddr=this.extract(k,this.consumeAddress)),this.peek(k," rport")&&(this.extract(k,this.consume," rport"),this.consumeAttributeSpace(k),Sa.relPort=this.extract(k,this.consumePort));this.peekChar(k)===g;){this.consumeAttributeSpace(k);const kd=this.extract(k,this.consumeToken);this.consumeAttributeSpace(k),Sa.extension[kd]=this.extractOneOrMore(k,S)}this.attributes.candidates.push(Sa)}parseRemoteCandidate(k){const Z=[];for(;;){const ie=this.extractOneOrMore(k,x,[1,5]);this.consumeAttributeSpace(k);const Ae=this.extract(k,this.consumeAddress);this.consumeAttributeSpace(k);const bt=this.extract(k,this.consumePort);Z.push({componentId:ie,connectionAddress:Ae,port:bt});try{this.consumeAttributeSpace(k)}catch{break}}this.attributes.remoteCandidatesList.push(Z)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(k){const Z=this.extract(k,this.consumeToken);this.consumeAttributeSpace(k);const ie=this.extract(k,this.consumeTill,"/");this.extract(k,this.consume,"/");const Ae={encodingName:ie,clockRate:this.extractOneOrMore(k,x)};this.atEnd(k)||this.peekChar(k)!=="/"||(this.extract(k,this.consume,"/"),Ae.encodingParameters=parseInt(this.extract(k,this.consumeTill),10));const bt=this.attributes.payloads.find(yn=>yn.payloadType===parseInt(Z,10));bt?bt.rtpMap=Ae:this.attributes.payloads.push({payloadType:parseInt(Z,10),rtpMap:Ae,rtcpFeedbacks:[]})}parsePtime(k){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(k,this.consumeTill)}parseMaxPtime(k){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(k,this.consumeTill)}parseDirection(k){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=k.attField}parseSSRC(k){const Z=this.extractOneOrMore(k,x);this.consumeAttributeSpace(k);const ie=this.extract(k,this.consumeTill,":");let Ae;this.peekChar(k)===":"&&(this.extract(k,this.consume,":"),Ae=this.extract(k,this.consumeTill));const bt=this.attributes.ssrcs.find(yn=>yn.ssrcId===parseInt(Z,10));bt?bt.attributes[ie]=Ae:this.attributes.ssrcs.push({ssrcId:parseInt(Z,10),attributes:{[ie]:Ae}})}parseFmtp(k){const Z=this.extract(k,this.consumeTill,g);this.consumeAttributeSpace(k);const ie=this.extract(k,this.consumeTill),Ae={};ie.split(";").forEach(yn=>{let[Nr,Sa]=yn.split("=");Nr=Ii(Nr).call(Nr);const kd=typeof Sa=="string"?Ii(Sa).call(Sa):null;typeof Nr=="string"&&Nr.length>0&&(Ae[Nr]=kd)});const bt=this.attributes.payloads.find(yn=>yn.payloadType===parseInt(Z,10));bt?bt.fmtp={parameters:Ae}:this.attributes.payloads.push({payloadType:parseInt(Z,10),rtcpFeedbacks:[],fmtp:{parameters:Ae}})}parseFmtParameters(k){const Z={},ie=this.extract(k,this.consumeTill,"=");k._cur++;const Ae=this.extract(k,this.consumeTill,";");for(Z[ie]=Ae;k.attValue[k._cur]===";";){const bt=this.extract(k,this.consumeTill,"=");k._cur++;const yn=this.extract(k,this.consumeTill,";");Z[bt]=yn}return Z}parseRtcpFb(k){let Z="";Z=this.peekChar(k)==="*"?this.extract(k,this.consume,"*"):this.extract(k,this.consumeTill,g),this.consumeAttributeSpace(k);const ie=this.extract(k,this.consumeTill,g);let Ae;if(ie==="trr-int")Ae={type:ie,interval:this.extract(k,this.consumeTill)};else{const bt={type:ie};this.peekChar(k)===g&&(this.consumeAttributeSpace(k),bt.parameter=this.extract(k,this.consumeToken),this.peekChar(k)===g&&(bt.additional=this.extract(k,this.consumeTill))),Ae=bt}if(Z==="*")this.attributes.rtcpFeedbackWildcards.push(Ae);else{const bt=this.attributes.payloads.find(yn=>yn.payloadType===parseInt(Z,10));bt?bt.rtcpFeedbacks.push(Ae):this.attributes.payloads.push({payloadType:parseInt(Z,10),rtcpFeedbacks:[Ae]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(k){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const Z={port:this.extract(k,this.consumePort)};this.peekChar(k)===g&&(this.consumeAttributeSpace(k),Z.netType=this.extractOneOrMore(k,C),this.consumeAttributeSpace(k),Z.addressType=this.extractOneOrMore(k,C),this.consumeAttributeSpace(k),Z.address=this.extract(k,this.consumeAddress)),this.attributes.rtcp=Z}parseMsid(k){const Z={id:this.extractOneOrMore(k,C,[1,64])};this.peekChar(k)===g&&(this.consumeAttributeSpace(k),Z.appdata=this.extractOneOrMore(k,C,[1,64])),this.attributes.msids.push(Z)}parseImageAttr(k){this.attributes.imageattr.push(k.attValue)}parseRid(k){const Z=this.extractOneOrMore(k,Ae=>j(Ae)||x(Ae)||Ae==="_"||Ae==="-");this.consumeAttributeSpace(k);const ie={id:Z,direction:this.extract(k,this.consumeToken),params:[]};if(this.peekChar(k)===g){if(this.consumeAttributeSpace(k),this.peek(k,"pt=")){this.extract(k,this.consume,"pt=");const Ae=[];for(;;){const bt=this.extract(k,this.consumeToken);Ae.push(bt);try{this.extract(k,this.consume,",")}catch{break}}ie.payloads=Ae,this.peekChar(k)===g&&this.extract(k,this.consume,g)}for(;;){const Ae=this.extract(k,this.consumeToken);switch(Ae){case"depend":{const bt={type:Ae,rids:this.extract(k,this.consume,"=").split(",")};ie.params.push(bt);break}default:{const bt={type:Ae};this.peekChar(k)==="="&&(this.extract(k,this.consume,"="),bt.val=this.extract(k,this.consumeTill,";")),ie.params.push(bt)}}try{this.extract(k,this.consume,";")}catch{break}}}this.attributes.rids.push(ie)}parseSimulcast(k){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=k.attValue,this.extract(k,this.consumeTill)}parseSctpPort(k){this.attributes.sctpPort=this.extractOneOrMore(k,x,[1,5])}parseMaxMessageSize(k){this.attributes.maxMessageSize=this.extractOneOrMore(k,x,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(k){this.attributes.mid=this.extract(k,this.consumeToken)}parseSSRCGroup(k){const Z=this.extract(k,this.consumeToken),ie=[];for(;;)try{this.consumeAttributeSpace(k);const Ae=this.extract(k,this.consumeInteger);ie.push(parseInt(Ae,10))}catch{break}this.attributes.ssrcGroups.push({semantic:Z,ssrcIds:ie})}}function Tt(we,k,Z){return k in we?Object.defineProperty(we,k,{value:Z,enumerable:!0,configurable:!0,writable:!0}):we[k]=Z,we}class Et{constructor(){Tt(this,"eol",m)}print(k,Z){let ie="";return Z&&(this.eol=Z),ie+=this.printVersion(k.version),ie+=this.printOrigin(k.origin),ie+=this.printSessionName(k.sessionName),ie+=this.printInformation(k.information),ie+=this.printUri(k.uri),ie+=this.printEmail(k.emails),ie+=this.printPhone(k.phones),ie+=this.printConnection(k.connection),ie+=this.printBandwidth(k.bandwidths),ie+=this.printTimeFields(k.timeFields),ie+=this.printKey(k.key),ie+=this.printSessionAttributes(k.attributes),ie+=this.printMediaDescription(k.mediaDescriptions),ie}printVersion(k){return"v=".concat(k).concat(this.eol)}printOrigin(k){return"o=".concat(k.username," ").concat(k.sessId," ").concat(k.sessVersion," ").concat(k.nettype," ").concat(k.addrtype," ").concat(k.unicastAddress).concat(this.eol)}printSessionName(k){return k?"s=".concat(k).concat(this.eol):""}printInformation(k){return k?"i=".concat(k).concat(this.eol):""}printUri(k){return k?"u=".concat(k).concat(this.eol):""}printEmail(k){let Z="";for(const ie of k)Z+="e=".concat(ie).concat(this.eol);return Z}printPhone(k){let Z="";for(const ie of k)Z+="e=".concat(ie).concat(this.eol);return Z}printConnection(k){return k?"c=".concat(k.nettype," ").concat(k.addrtype," ").concat(k.address).concat(this.eol):""}printBandwidth(k){let Z="";for(const ie of k)Z+="b=".concat(ie.bwtype,":").concat(ie.bandwidth).concat(this.eol);return Z}printTimeFields(k){let Z="";for(const ie of k){Z+="t=".concat(ie.time.startTime," ").concat(ie.time.startTime).concat(this.eol);for(const Ae of ie.repeats)Z+="r=".concat(Ae.repeatInterval," ").concat(Ae.typedTimes.join(" ")).concat(this.eol);ie.zoneAdjustments&&(Z+="z=",Z+="z=".concat(ie.zoneAdjustments.map(Ae=>"".concat(Ae.time," ").concat(Ae.back?"-":""," ").concat(Ae.typedTime)).join(" ")).concat(this.eol),Z+=this.eol)}return Z}printKey(k){return k?"k=".concat(k).concat(this.eol):""}printAttributes(k){let Z="";for(const ie of k)Z+="a=".concat(ie.attField).concat(ie.attValue?":".concat(ie.attValue):"").concat(this.eol);return Z}printMediaDescription(k){let Z="";for(const ie of k)Z+=this.printMedia(ie.media),Z+=this.printInformation(ie.information),Z+=this.printConnections(ie.connections),Z+=this.printBandwidth(ie.bandwidths),Z+=this.printKey(ie.key),Z+=this.printMediaAttributes(ie);return Z}printConnections(k){let Z="";for(const ie of k)Z+=this.printConnection(ie);return Z}printMedia(k){return"m=".concat(k.mediaType," ").concat(k.port," ").concat(k.protos.join("/")," ").concat(k.fmts.join(" ")).concat(this.eol)}printSessionAttributes(k){return new An(this.eol).print(k)}printMediaAttributes(k){return new _e(this.eol).print(k)}}class Xt{constructor(k){Tt(this,"eol",void 0),this.eol=k}printIceUfrag(k){return k===void 0?"":"a=ice-ufrag:".concat(k).concat(this.eol)}printIcePwd(k){return k===void 0?"":"a=ice-pwd:".concat(k).concat(this.eol)}printIceOptions(k){return k===void 0?"":"a=ice-options:".concat(k.join(g)).concat(this.eol)}printFingerprints(k){return k.length>0?k.map(Z=>"a=fingerprint:".concat(Z.hashFunction).concat(g).concat(Z.fingerprint)).join(this.eol)+this.eol:""}printExtmap(k){return k.map(Z=>"a=extmap:".concat(Z.entry).concat(Z.direction?"/".concat(Z.direction):"").concat(g).concat(Z.extensionName).concat(Z.extensionAttributes?"".concat(g).concat(Z.extensionAttributes):"").concat(this.eol)).join("")}printSetup(k){return k===void 0?"":"a=setup:".concat(k).concat(this.eol)}printUnrecognized(k){return k.map(Z=>"a=".concat(Z.attField).concat(Z.attValue?":".concat(Z.attValue):"").concat(this.eol)).join("")}}class An extends Xt{print(k){let Z="";return Z+=this.printGroups(k.groups),Z+=this.printMsidSemantic(k.msidSemantic),Z+=this.printIceLite(k.iceLite),Z+=this.printIceUfrag(k.iceUfrag),Z+=this.printIcePwd(k.icePwd),Z+=this.printIceOptions(k.iceOptions),Z+=this.printFingerprints(k.fingerprints),Z+=this.printSetup(k.setup),Z+=this.printTlsId(k.tlsId),Z+=this.printIdentity(k.identities),Z+=this.printExtmap(k.extmaps),Z+=this.printUnrecognized(k.unrecognized),Z}printGroups(k){let Z="";return k.length>0&&(Z+=k.map(ie=>"a=group:".concat(ie.semantic).concat(ie.identificationTag.map(Ae=>"".concat(g).concat(Ae)).join("")).concat(this.eol)).join("")),Z}printIceLite(k){return k===void 0?"":"a=ice-lite"+this.eol}printTlsId(k){return k?"a=tls-id:".concat(k).concat(this.eol):""}printIdentity(k){return k.length===0?"":k.map(Z=>"a=identity:".concat(Z.assertionValue).concat(Z.extensions.map(ie=>"".concat(g).concat(ie.name).concat(ie.value?"=".concat(ie.value):"")))).join(this.eol)+this.eol}printMsidSemantic(k){if(!k)return"";let Z="a=msid-semantic:".concat(k.semantic);return k.applyForAll?Z+="".concat(g,"*"):k.identifierList.length>0&&(Z+=k.identifierList.map(ie=>"".concat(g).concat(ie))),Z+this.eol}}class _e extends Xt{print(k){const Z=k.attributes;let ie="";return ie+=this.printRTCP(Z.rtcp),ie+=this.printIceUfrag(Z.iceUfrag),ie+=this.printIcePwd(Z.icePwd),ie+=this.printIceOptions(Z.iceOptions),ie+=this.printCandidates(Z.candidates),ie+=this.printRemoteCandidatesList(Z.remoteCandidatesList),ie+=this.printEndOfCandidates(Z.endOfCandidates),ie+=this.printFingerprints(Z.fingerprints),ie+=this.printSetup(Z.setup),ie+=this.printMid(Z.mid),ie+=this.printExtmap(Z.extmaps),ie+=this.printRTPRelated(Z),ie+=this.printPtime(Z.ptime),ie+=this.printMaxPtime(Z.maxPtime),ie+=this.printDirection(Z.direction),ie+=this.printSSRCGroups(Z.ssrcGroups),ie+=this.printSSRC(Z.ssrcs),ie+=this.printRTCPMux(Z.rtcpMux),ie+=this.printRTCPMuxOnly(Z.rtcpMuxOnly),ie+=this.printRTCPRsize(Z.rtcpRsize),ie+=this.printMSId(Z.msids),ie+=this.printImageattr(Z.imageattr),ie+=this.printRid(Z.rids),ie+=this.printSimulcast(Z.simulcast),ie+=this.printSCTPPort(Z.sctpPort),ie+=this.printMaxMessageSize(Z.maxMessageSize),ie+=this.printUnrecognized(Z.unrecognized),ie}printCandidates(k){return k.map(Z=>"a=candidate:".concat(Z.foundation).concat(g).concat(Z.componentId).concat(g).concat(Z.transport).concat(g).concat(Z.priority).concat(g).concat(Z.connectionAddress).concat(g).concat(Z.port).concat(g,"typ").concat(g).concat(Z.type).concat(Z.relAddr?"".concat(g,"raddr").concat(g).concat(Z.relAddr):"").concat(Z.relPort?"".concat(g,"rport").concat(g).concat(Z.relPort):"").concat(Object.keys(Z.extension).map(ie=>"".concat(g).concat(ie).concat(g).concat(Z.extension[ie])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(k){return k.map(Z=>"a=remote-candidates:".concat(Z.join(g)).concat(this.eol)).join("")}printEndOfCandidates(k){return k===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(k){if(!k.payloads)return"";const Z=k.payloads;let ie="";ie+=k.rtcpFeedbackWildcards.map(Ae=>this.printRTCPFeedback("*",Ae)).join("");for(const Ae of Z)ie+=this.printRtpMap(Ae.payloadType,Ae.rtpMap),ie+=this.printFmtp(Ae.payloadType,Ae.fmtp),ie+=Ae.rtcpFeedbacks.map(bt=>this.printRTCPFeedback(Ae.payloadType,bt)).join("");return ie}printFmtp(k,Z){if(!Z)return"";const ie=Object.keys(Z.parameters);return ie.length===1&&Z.parameters[ie[0]]===null?"a=fmtp:".concat(k).concat(g).concat(ie[0]).concat(this.eol):"a=fmtp:".concat(k).concat(g).concat(Object.keys(Z.parameters).map(Ae=>"".concat(Ae,"=").concat(Z.parameters[Ae])).join(";")).concat(this.eol)}printRtpMap(k,Z){return Z?"a=rtpmap:".concat(k).concat(g).concat(Z.encodingName,"/").concat(Z.clockRate).concat(Z.encodingParameters?"/".concat(Z.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(k,Z){let ie="a=rtcp-fb:".concat(k).concat(g),Ae=Z;return Ae.type==="trr-int"?ie+="ttr-int".concat(g).concat(Ae.interval):(ie+="".concat(Ae.type),Ae.parameter&&(ie+="".concat(g).concat(Ae.parameter),Ae.additional&&(ie+="".concat(g).concat(Ae.additional)))),ie+this.eol}printPtime(k){return k===void 0?"":"a=ptime:".concat(k).concat(this.eol)}printMaxPtime(k){return k===void 0?"":"a=maxptime:".concat(k).concat(this.eol)}printDirection(k){return k===void 0?"":"a=".concat(k).concat(this.eol)}printSSRC(k){return k.map(Z=>Object.keys(Z.attributes).map(ie=>"a=ssrc:".concat(Z.ssrcId.toString(10)).concat(g).concat(ie).concat(Z.attributes[ie]?":".concat(Z.attributes[ie]):"").concat(this.eol)).join("")).join("")}printRTCPMux(k){return k===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(k){return k===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(k){return k===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(k){if(k===void 0)return"";let Z="a=rtcp:".concat(k.port);return k.netType&&(Z+="".concat(g).concat(k.netType)),k.addressType&&(Z+="".concat(g).concat(k.addressType)),k.address&&(Z+="".concat(g).concat(k.address)),Z+this.eol}printMSId(k){return k.map(Z=>"a=msid:".concat(Z.id).concat(Z.appdata?"".concat(g).concat(Z.appdata):"").concat(this.eol)).join("")}printImageattr(k){return k.map(Z=>"a=imageattr:".concat(Z).concat(this.eol)).join("")}printRid(k){return k.map(Z=>{let ie="a=rid:".concat(Z.id).concat(g).concat(Z.direction);return Z.payloads&&(ie+="".concat(g,"pt=").concat(Z.payloads.join(","))),Z.params.length>0&&(ie+="".concat(g).concat(Z.params.map(Ae=>Ae.type==="depend"?"depend=".concat(Ae.rids.join(",")):"".concat(Ae.type,"=").concat(Ae.val)).join(";"))),ie+this.eol}).join("")}printSimulcast(k){return k===void 0?"":"a=simulcast:".concat(k).concat(this.eol)}printSCTPPort(k){return k===void 0?"":"a=sctp-port:".concat(k).concat(this.eol)}printMaxMessageSize(k){return k===void 0?"":"a=max-message-size:".concat(k).concat(this.eol)}printMid(k){return k===void 0?"":"a=mid:".concat(k).concat(this.eol)}printSSRCGroups(k){return k.map(Z=>"a=ssrc-group:".concat(Z.semantic).concat(Z.ssrcIds.map(ie=>"".concat(g).concat(ie.toString(10))).join("")).concat(this.eol)).join("")}}function Oe(we){return new Se().parse(we)}function He(we,k){return new Et().print(we,k)}}},r={};function i(a){if(r[a])return r[a].exports;var l=r[a]={exports:{}};return t[a](l,l.exports,i),l.exports}return i.d=(a,l)=>{for(var u in l)i.o(l,u)&&!i.o(a,u)&&Object.defineProperty(a,u,{enumerable:!0,get:l[u]})},i.o=(a,l)=>Object.prototype.hasOwnProperty.call(a,l),i.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i(8)})();function ki(t){return KV.parse(t)}function pl(t,r){return KV.print(t,r)}var o0e=ha("Array","keys"),c0e=sd,l0e=ui,d0e=N,u0e=o0e,UA=Array.prototype,h0e={DOMTokenList:!0,NodeList:!0},p0e=function(t){var r=t.keys;return t===UA||d0e(UA,t)&&r===UA.keys||l0e(h0e,c0e(t))?u0e:r},mi=d(p0e);function Fn(t,r,i){return(r=function(a){var l=function(u,p){if(typeof u!="object"||!u)return u;var m=u[Symbol.toPrimitive];if(m!==void 0){var g=m.call(u,"string");if(typeof g!="object")return g;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(a);return typeof l=="symbol"?l:l+""}(r))in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t}function YV(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function St(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?YV(Object(i),!0).forEach(function(a){Fn(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):YV(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}function t_(t,r){return t_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},t_(t,r)}function FA(){FA=function(l,u){return new i(l,void 0,u)};var t=RegExp.prototype,r=new WeakMap;function i(l,u,p){var m=RegExp(l,u);return r.set(m,p||r.get(l)),t_(m,i.prototype)}function a(l,u){var p,m=r.get(u);return pa(p=Object.keys(m)).call(p,function(g,y){var x=m[y];if(typeof x=="number")g[y]=l[x];else{for(var S=0;l[x[S]]===void 0&&S+1<x.length;)S++;g[y]=l[x[S]]}return g},Object.create(null))}return function(l,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(u&&u.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),u&&t_(l,u)}(i,RegExp),i.prototype.exec=function(l){var u=t.exec.call(this,l);if(u){u.groups=a(u,this);var p=u.indices;p&&(p.groups=a(p,this))}return u},i.prototype[Symbol.replace]=function(l,u){if(typeof u=="string"){var p=r.get(this);return t[Symbol.replace].call(this,l,u.replace(/\$<([^>]+)(>|$)/g,function(g,y,x){if(x==="")return g;var S=p[y];return Array.isArray(S)?"$"+S.join("$"):typeof S=="number"?"$"+S:""}))}if(typeof u=="function"){var m=this;return t[Symbol.replace].call(this,l,function(){var g=arguments;return typeof g[g.length-1]!="object"&&(g=[].slice.call(g)).push(a(g,m)),u.apply(this,g)})}return t[Symbol.replace].call(this,l,u)},FA.apply(this,arguments)}const qV=new class extends Pn{constructor(){super(...arguments),Fn(this,"currentUploadLogID",0)}reportLogUploadError(t){const{errorRange:r}=t;r[r.length-1]&&r[r.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=r[r.length-1],this.emit("REPORT_LOG_UPLOAD",t))}};class m0e{constructor(r){Fn(this,"logger",void 0),Fn(this,"prefixLists",[]),this.logger=r}debug(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];this.logger.debug(...this.prefixLists,...i)}info(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];this.logger.info(...this.prefixLists,...i)}warning(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];this.logger.warning(...this.prefixLists,...i)}error(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];this.logger.error(...this.prefixLists,...i)}prefix(r){return this.prefixLists.push(r),this}popPrefix(){return this.prefixLists.pop(),this}}function VA(){const t=new Date;return t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}function XV(){const t=new Date,r=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return r?(r==null?void 0:r[0])+":"+t.getUTCMilliseconds():t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}const ga={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},n_=Date.now(),E0=t=>{for(const r in ga)if(Object.prototype.hasOwnProperty.call(ga,r)&&ga[r]===t)return r;return"DEFAULT"},A=new class{constructor(){Fn(this,"proxyServerURL",void 0),Fn(this,"logLevel",ga.DEBUG),Fn(this,"uploadState","collecting"),Fn(this,"uploadLogWaitingList",[]),Fn(this,"uploadLogUploadingList",[]),Fn(this,"uploadErrorCount",0),Fn(this,"currentLogID",0),Fn(this,"url",void 0),Fn(this,"extLog",(t,r)=>{this.appendLogToWaitingList(t,...r)})}debug(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];const a=[ga.DEBUG].concat(r);this.log.apply(this,a)}info(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];const a=[ga.INFO].concat(r);this.log.apply(this,a)}warning(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];const a=[ga.WARNING].concat(r);this.log.apply(this,a)}warn(){this.warning(...arguments)}error(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];const a=[ga.ERROR].concat(r);this.log.apply(this,a)}upload(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];const a=[ga.DEBUG].concat(r);this.uploadLog.apply(this,a)}setLogLevel(t){t=Math.min(Math.max(0,t),4),this.logLevel=t}enableLogUpload(){cn("UPLOAD_LOG",!0)}disableLogUpload(){cn("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(t){this.proxyServerURL=t}prefix(t){return new m0e(this).prefix(t)}log(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];if(Date.now()-n_<100)return void setTimeout(()=>{this.log(...r)},Date.now()-n_);const a=Math.max(0,Math.min(4,r[0]));if(r[0]=VA()+" Agora-SDK [".concat(E0(a),"]:"),this.appendLogToWaitingList(a,...r),a<this.logLevel)return;const l=VA()+" %cAgora-SDK [".concat(E0(a),"]:");let u=[];if(!W("USE_NEW_LOG"))switch(a){case ga.DEBUG:u=[l,"color: #64B5F6;"].concat(r.slice(1)),console.log.apply(console,u);break;case ga.INFO:u=[l,"color: #1E88E5; font-weight: bold;"].concat(r.slice(1)),console.log.apply(console,u);break;case ga.WARNING:u=[l,"color: #FB8C00; font-weight: bold;"].concat(r.slice(1)),console.warn.apply(console,u);break;case ga.ERROR:u=[l,"color: #B00020; font-weight: bold;"].concat(r.slice(1)),console.error.apply(console,u)}}uploadLog(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];if(Date.now()-n_<100)return void setTimeout(()=>{this.uploadLog(...r)},Date.now()-n_);const a=Math.max(0,Math.min(4,r[0]));r[0]=VA()+" Agora-SDK [".concat(E0(a),"]:"),this.appendLogToWaitingList(a,...r)}appendLogToWaitingList(t){if(!W("UPLOAD_LOG"))return;for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];Array.isArray(i[0])?i[0][0]=XV()+" Agora-SDK [".concat(E0(t),"]:"):i[0]=XV()+" Agora-SDK [".concat(E0(t),"]:");let l="";i.forEach(u=>{typeof u=="object"&&(u=JSON.stringify(u)),l+="".concat(u," ")}),this.uploadLogWaitingList.push({payload_str:l,log_level:t,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const t=this.uploadLogUploadingList,r={sdk_version:fa,process_id:W("PROCESS_ID"),payload:JSON.stringify(t)};return Uo(async()=>{const i=await zi.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(W("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(W("LOG_UPLOAD_SERVER"),"/upload/v1")),r,{responseType:"text"});if(i.data!=="OK"){const a=new Error("unexpected upload log response");throw a.response=i,a}},()=>(this.uploadLogUploadingList=[],!1),i=>{const a={status:-1,message:i.message,errorRange:t.map(l=>l.log_item_id)};return i.response?(a.status=i.response.status,a.data=i.response.data,a.headers=i.response.headers):i.request&&(a.status=i.request.status),qV.reportLogUploadError(a),!0},{timeout:W("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:W("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,W("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),W("UPLOAD_LOG_INTERVAL"))}).catch(t=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),W("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),W("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var JV;function f0e(t){return Wr(t.reportId,"params.reportId",0,100,!1),Wr(t.category,"params.category",0,100,!1),Wr(t.event,"params.event",0,100,!1),Wr(t.label,"params.label",0,100,!1),un(t.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(JV={}).FREE="free",JV.UPLOADING="uploading",function(t){t[t.MISC=0]="MISC",t[t.INTERNAL_EVENT=1]="INTERNAL_EVENT",t[t.PUBLIC_EVENT=2]="PUBLIC_EVENT",t[t.WEB_EVENT=3]="WEB_EVENT",t[t.INTERNAL_API=4]="INTERNAL_API",t[t.WEB_API=5]="WEB_API",t[t.PUBLIC_API=6]="PUBLIC_API"}({});const g0e={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let hr=function(t){return t.PUBLISH="publish",t.SUBSCRIBE="subscribe",t.WS_COMPRESSOR_INIT="ws_compressor_init",t.SESSION_INIT="session_init",t.JOIN_CHOOSE_SERVER="join_choose_server",t.RTE_DETAIL="rte_detail_stats",t.REQ_USER_ACCOUNT="req_user_account",t.JOIN_GATEWAY="join_gateway",t.REJOIN_GATEWAY="rejoin_gateway",t.STREAM_SWITCH="stream_switch",t.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",t.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",t.FIRST_VIDEO_RECEIVED="first_video_received",t.FIRST_AUDIO_RECEIVED="first_audio_received",t.FIRST_VIDEO_DECODE="first_video_decode",t.FIRST_AUDIO_DECODE="first_audio_decode",t.XLA_PEER_FIRST_VIDEO_FRAME="xla_peer_first_video_frame",t.ON_ADD_AUDIO_STREAM="on_add_audio_stream",t.ON_ADD_VIDEO_STREAM="on_add_video_stream",t.ON_UPDATE_STREAM="on_update_stream",t.ON_REMOVE_STREAM="on_remove_stream",t.USER_ANALYTICS="req_user_analytics",t.PC_STATS="pc_stats",t.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",t.AB_TEST="ab_test",t}({}),Rn=function(t){return t.SESSION="io.agora.pb.Wrtc.Session",t.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",t.RTE_DETAIL="io.agora.pb.Wrtc.RteDetailStats",t.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",t.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",t.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",t.PUBLISH="io.agora.pb.Wrtc.Publish",t.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",t.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",t.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",t.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",t.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",t.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",t.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",t.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",t.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",t.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",t.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",t.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",t.XLA_PEER_FIRST_VIDEO_FRAME="io.agora.pb.Wrtc.XLAPeerFirstVideoFrame",t.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",t.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",t.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",t.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",t.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",t.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",t.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",t.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",t.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",t.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",t.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",t.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",t.PC_STATS="io.agora.pb.Wrtc.PCStats",t.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",t.AB_TEST="io.agora.pb.Wrtc.ABTest",t}({});(function(t){t[t.WORKER_EVENT=156]="WORKER_EVENT",t[t.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({});let v0e=function(t){return t[t.SESSION=26]="SESSION",t[t.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",t[t.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",t[t.JOIN_GATEWAY=28]="JOIN_GATEWAY",t[t.PUBLISH=30]="PUBLISH",t[t.SUBSCRIBE=29]="SUBSCRIBE",t[t.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",t[t.STREAM_SWITCH=32]="STREAM_SWITCH",t[t.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",t[t.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",t[t.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",t[t.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",t[t.API_INVOKE=41]="API_INVOKE",t[t.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",t[t.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",t[t.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",t[t.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",t[t.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",t[t.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",t[t.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",t[t.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",t[t.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",t[t.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",t[t.WORKER_EVENT=156]="WORKER_EVENT",t[t.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",t[t.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",t[t.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",t[t.USER_ANALYTICS=1e4]="USER_ANALYTICS",t[t.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",t}({});function lt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(r,i,a){const l=a.value;if(typeof l=="function"){const u=t.className||r.__className__||(r.constructor.name==="AgoraRTCClient"?"Client":r.constructor.name);a.value=function(){for(var p,m=arguments.length,g=new Array(m),y=0;y<m;y++)g[y]=arguments[y];let x=g;if(t.argsMap)try{x=t.argsMap(this,...g)}catch(T){A.warning(T),x=[]}try{JSON.stringify(x)}catch{A.warning("arguments for method ".concat(u,".").concat(String(i)," not serializable for apiInvoke.")),x=[]}const S=(t.report||Ye).reportApiInvoke(this._sessionId||null,{id:this._clientId||((p=this.store)===null||p===void 0?void 0:p.clientId)||this._ID,name:"".concat(u,".").concat(String(i)),options:x,tag:hn.TRACER,reportResult:t.reportResult},t.throttleTime);try{const T=l.apply(this,g);return T instanceof je?T.then(C=>(S.onSuccess(t.reportResult&&C),C)).catch(C=>{throw S.onError(C),C}):(S.onSuccess(t.reportResult&&T),T)}catch(T){throw S.onError(T),T}}}return a}}const Ye=new class{constructor(){Fn(this,"baseInfoMap",new Map),Fn(this,"proxyServer",void 0),Fn(this,"eventUploadTimer",void 0),Fn(this,"setSessionIdTimer",void 0),Fn(this,"url",void 0),Fn(this,"sids",new Set),Fn(this,"backupUrl",void 0),Fn(this,"_appId",void 0),Fn(this,"_aid",0),Fn(this,"keyEventUploadPendingItems",[]),Fn(this,"normalEventUploadPendingItems",[]),Fn(this,"apiInvokeUploadPendingItems",[]),Fn(this,"apiInvokeCount",0),Fn(this,"apiInvokeLoggedCount",0),Fn(this,"ltsList",[]),Fn(this,"lastSendNormalEventTime",Date.now()),Fn(this,"customReportCounterTimer",void 0),Fn(this,"customReportCount",0),Fn(this,"extApiInvoke",async t=>{for(const r of t){const i=St(St({},r),{},{sid:null,invokeId:++this.apiInvokeCount,tag:hn.TRACER});this.sendApiInvoke(i)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),W("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),W("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(t){return this.baseInfoMap.get(t)}setAppId(t){this._appId=t,this._aid=parseInt(t.replace(/[a-fA-F0-9]{8}/g,r=>{let[i,a]=r;return i+a}),16)||0}reportApiInvoke(t,r,i){r.timeout=r.timeout||6e4,r.reportResult=r.reportResult===void 0||r.reportResult;const a=Date.now();this.apiInvokeCount+=1;const l=this.apiInvokeCount,u=!!W("SHOW_REPORT_INVOKER_LOG"),p=!!W("SHOW_REPORT_USER_INVOKER_LOG"),m=u||p&&r.id;m&&(this.apiInvokeLoggedCount+=1);const g=this.apiInvokeLoggedCount;function y(C,V){if(m){let j="[apiInvoke-".concat(g,"]");if(r.id&&(j+="[".concat(r.id,"]")),r.name&&(j+="[".concat(r.name,"]"),r.name===Cn.JOIN))return A.info("".concat(j," ").concat(C));A.info("".concat(j," ").concat(C),C==="start"?r.options:V||"")}}const x=()=>({tag:r.tag,invokeId:l,sid:t,name:r.name,apiInvokeTime:a,options:r.options,states:r.states||null});y("start");let S=!1;Er(r.timeout).then(()=>{S||(this.sendApiInvoke(St(St({},x()),{},{error:K.API_INVOKE_TIMEOUT,success:!1})),y("timeout"))});const T=new ge(K.UNEXPECTED_ERROR,"".concat(r.name,": this api invoke is end"));return{onSuccess:C=>{const V=()=>{if(S)throw T;return S=!0,this.sendApiInvoke(St(St({},x()),{},{success:!0},r.reportResult&&{result:C})),y("onSuccess"),C};return i?OV(V,r.name+"Success",i,()=>S=!0):V()},onError:C=>{const V=()=>{if(S)throw C;S=!0,this.sendApiInvoke(St(St({},x()),{},{success:!1,error:C})),y("onFailure",C.toString())};return i?OV(V,r.name+"Error",i,()=>S=!0):V()}}}_send(t,r,i){this.send({type:t,data:r},i)}_sendApiInvoke(t){return this.sendApiInvoke(t)}sessionInit(t,r){if(this.baseInfoMap.has(t))return;const i=Date.now(),a=this.createBaseInfo(t,i);a.cname=r.cname,a.rteUrl=r.rteUrl;const l=Object.assign({},{willUploadConsoleLog:W("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:jA?"global":"oversea",areas:W("AREAS")&&W("AREAS").join(",")},r.extend),{stringUid:u,channelProfile:p,channelMode:m,isABTestSuccess:g,lsid:y,clientRole:x}=r,S=Date.now(),T=St(St({},a),{},{eventType:hr.SESSION_INIT,appid:r.appid,browser:navigator.userAgent,buildFormat:r.buildFormat,build:LA,lts:S,elapse:S-i,extend:JSON.stringify(l),mode:r.mode,process:W("PROCESS_ID"),appType:W("APP_TYPE"),success:!0,version:fa,stringUid:u,channelProfile:p,channelMode:m,isABTestSuccess:g,lsid:y,clientType:Ce(C=window.navigator.userAgent).call(C,"AgoraWebView")?42:20,clientRole:x,serviceId:W("PROCESS_ID"),extensionID:W("PLUGIN_INFO").join(",")||"",rteUrl:r.rteUrl,rteSid:r.rteSid});var C;this.send({type:Rn.SESSION,data:T},!0)}reportRteDetail(t){const r=this.baseInfoMap.get(t);if(!r)return;const i=r.info,a=Date.now(),l=St(St({},i),{},{eventType:hr.RTE_DETAIL,lts:a,success:!0,elapse:a-r.startTime,vid:i.vid===void 0?0:Number(i.vid),ua:navigator.userAgent});this.send({type:Rn.RTE_DETAIL,data:l},!0)}joinChooseServer(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info;r.vid&&(a.vid=r.vid);const l=Date.now(),u=St(St({},a),{},{role:r.role,eventType:hr.JOIN_CHOOSE_SERVER,lts:l,eventElapse:r.elapse||l-r.lts,chooseServerAddr:r.csAddr,errorCode:r.ec,elapse:l-i.startTime,success:r.succ,chooseServerAddrList:JSON.stringify(r.serverList),uid:r.uid?parseInt(r.uid):null,cid:r.cid?parseInt(r.cid):null,chooseServerIp:r.csIp||"",opid:r.opid,unilbsServerIds:r.unilbsServerIds,extend:r.extend||void 0,isHttp3:r.isHttp3,corssRegionTagReq:r.corssRegionTagReq||void 0,corssRegionTagRes:r.corssRegionTagRes||void 0,ua:navigator.userAgent,resourceTimingInfo:r.resourceTimingInfo||void 0});this.send({type:Rn.JOIN_CHOOSE_SERVER,data:u},!0)}reqUserAccount(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St({},a),{},{eventType:hr.REQ_USER_ACCOUNT,lts:l,success:r.success,serverAddress:r.serverAddr,stringUid:r.stringUid,uid:r.uid,errorCode:r.errorCode,elapse:r.elapse||l-i.startTime,eventElapse:l-r.lts,extend:JSON.stringify(r.extend)});this.send({type:Rn.REQ_USER_ACCOUNT,data:u},!0)}joinGateway(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info;r.vid&&(a.vid=r.vid),a.uid=r.uid,a.cid=r.cid;const l=Date.now(),{firstSuccess:u,addr:p,isProxy:m}=r,g=l-i.startTime,y=St(St({},a),{},{eventType:hr.JOIN_GATEWAY,lts:l,gatewayAddr:r.addr,success:r.succ,errorCode:r.ec,errorMsg:r.errorMsg||"",elapse:g,eventElapse:l-r.lts,firstSuccess:u,signalChannel:r.signalChannel,preload:r.preload?1:0,installId:kA(),isABTestSuccess:r.isABTestSuccess?1:0,gatewayIp:null,gatewayPort:null,isProxy:m?1:0}),x=y.success?1:0;if(r.succ&&(i.lastJoinSuccessTime=l),p)if(y.signalChannel==="1"){const S=FA(/(\d+\.\d+\.\d+\.\d+):(\d+)/,{ip:1,port:2}),T=p.match(S);y.gatewayIp=T&&T.groups?T.groups.ip:"",y.gatewayPort=T&&T.groups?T.groups.port:""}else if(m){const S=p.match(/h=(\d{1,3}-){3}\d{1,3}/g),T=p.match(/p=[0-9]{1,6}/g);y.gatewayIp=S&&S.length?S[0].split("=")[1].replace(/-/g,"."):"",y.gatewayPort=T&&T.length?T[0].split("=")[1]:""}else{const S=p.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),T=p.match(/(:|p=)[0-9]{1,6}/g);y.gatewayIp=S&&S.length?S[0].split("//")[1].replace(/-/g,"."):"",y.gatewayPort=T&&T.length?T[0].split(/:|p=/g)[1]:""}if(u)this.send({type:Rn.JOIN_GATEWAY,data:y},!0);else{let S={isSuccess:x,port:y.gatewayPort};delete y.success,delete y.eventType,delete y.firstSuccess,delete y.gatewayPort,y.vid=Number(y.vid);const T=Object.assign({},y,S,{eventType:hr.REJOIN_GATEWAY});this.send({type:Rn.RE_JOIN_GATEWAY,data:T},!0)}}joinChannelTimeout(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=Date.now(),l=St(St({},i.info),{},{lts:a,timeout:r,elapse:a-i.startTime});this.send({type:Rn.JOIN_CHANNEL_TIMEOUT,data:l},!0)}publish(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St({},a),{},{eventType:hr.PUBLISH,lts:l,eventElapse:r.eventElapse,elapse:l-i.startTime,success:r.succ,errorCode:r.ec,videoName:r.videoName,audioName:r.audioName,screenName:r.screenName,screenshare:r.screenshare,audio:r.audio,video:r.video,p2pid:r.p2pid,publishRequestid:r.publishRequestid});this.send({type:Rn.PUBLISH,data:u},!0)}subscribe(t,r,i){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),p=St(St({},l),{},{eventType:hr.SUBSCRIBE,lts:u,eventElapse:r.eventElapse,elapse:u-a.startTime,success:r.succ,errorCode:r.ec,video:r.video,audio:r.audio,subscribeRequestid:r.subscribeRequestid,p2pid:r.p2pid,preSsrc:r.preSsrc?1:0},i&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof r.peerid=="string"?p.peerSuid=r.peerid:p.peer=r.peerid,this.send({type:Rn.SUBSCRIBE,data:p},!0)}wsCompressorInit(t){var r;const i=[...mi(r=this.baseInfoMap).call(r)],a=i.length?i[0]:"UnableToGetSid",l=this.baseInfoMap.get(a);if(!l)return;const u=l.info,p=Date.now(),m=St(St({},u),{},{eventType:hr.WS_COMPRESSOR_INIT,lts:p,eventElapse:t.eventElapse,elapse:p-l.startTime,status:t.status?1:2});this.send({type:Rn.WS_COMPRESSOR_INIT,data:m},!0)}firstXLAPeerFirstVideoFrame(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=r.peerPubStatusMs-(i.lastJoinSuccessTime||l),p=St(St({},a),{},{elapse:l-i.startTime,eventType:hr.XLA_PEER_FIRST_VIDEO_FRAME,lts:l,peer:r.peer,width:r.width,height:r.height,ssrc:r.ssrc,p2pid:r.p2pid,peerPublishDuration:r.peerPublishDuration,joinChannelSuccessElapse:u,peerPubStatusMs:r.peerPubStatusMs-r.joinChannelStart,availablePublish:r.peerPublishDuration>u?1:0,preloadStart:Math.max(r.preloadStart-r.joinChannelStart,0),preloadEnd:Math.max(r.preloadEnd-r.joinChannelStart,0),encrypt:Math.max(r.apStart-r.joinChannelStart,0),ap:Math.max(r.apEnd-r.joinChannelStart,0),sua:Math.max(r.suaEnd-r.joinChannelStart,0),beforeConnect:Math.max(r.beforeConnect-r.joinChannelStart,0),peerRecevier:Math.max(r.peerReceiver-r.joinChannelStart,0),ice:Math.max(r.ice-r.joinChannelStart,0),pc:Math.max(r.pc-r.joinChannelStart,0),signalConnected:Math.max(r.signalConnected-r.joinChannelStart,0),joinReq:Math.max(r.joinReq-r.joinChannelStart,0),joinRes:Math.max(r.joinRes-r.joinChannelStart,0),userJoinNotify:Math.max(r.userJoinNotify-r.joinChannelStart,0),videoSsrcNotify:Math.max(r.videoAddNotify-r.joinChannelStart,0),subscribeDelayMs:Math.max(r.subscribeStart-r.videoAddNotify,0),subscribeStart:Math.max(r.subscribeStart-r.joinChannelStart,0),subscribeEnd:Math.max(r.subscribeEnd-r.joinChannelStart,0),firstReceived:Math.max(r.firstReceived-r.joinChannelStart,0),firstDecoded:Math.max(r.firstDecoded-r.joinChannelStart,0),firstPreRender:Math.max(r.firstPreRender-r.joinChannelStart,0),firstRender:Math.max(r.firstRender-r.joinChannelStart,0),playDelayMs:Math.max(r.playStart-r.subscribeEnd,0),playStart:Math.max(r.playStart-r.joinChannelStart,0),playEnd:Math.max(r.playEnd-r.joinChannelStart,0),isPreSub:r.isPreSub?1:0,isPrePc:r.isPrePc?1:0,isPreInstantVideo:r.isPreInstantVideo?1:0,firstReceivedEncodedFrame:r.firstReceivedEncodedFrame?Math.max(r.firstReceivedEncodedFrame-r.joinChannelStart,0):void 0,frameType:r.frameType||"",rtpTimestamp:r.rtpTimestamp||0,framePayloadType:r.framePayloadType||0,frameDataLength:r.frameDataLength||0,mimeType:r.mimeType||""});this.send({type:Rn.XLA_PEER_FIRST_VIDEO_FRAME,data:p},!0)}firstRemoteVideoDecode(t,r,i,a){const l=this.baseInfoMap.get(t);if(!l)return;const u=l.info,p=Date.now(),m=St(St(St({},u),a),{},{elapse:p-l.startTime,eventType:r,lts:p,firstDecodeFrame:Math.max((a.firstFrame||p)-l.startTime,0),apEnd:Math.max(a.apEnd-l.startTime,0),apStart:Math.max(a.apStart-l.startTime,0),joinGwEnd:Math.max(a.joinGwEnd-l.startTime,0),joinGwStart:Math.max(a.joinGwStart-l.startTime,0),pcEnd:Math.max(a.pcEnd-l.startTime,0),pcStart:Math.max(a.pcStart-l.startTime,0),subscriberEnd:Math.max(a.subscriberEnd-l.startTime,0),subscriberStart:Math.max(a.subscriberStart-l.startTime,0),videoAddNotify:Math.max(a.videoAddNotify-l.startTime,0)});this.send({type:i,data:m},!0)}firstRemoteFrame(t,r,i,a){const l=this.baseInfoMap.get(t);if(!l)return;const u=l.info,p=Date.now(),m=St(St(St({},u),a),{},{elapse:p-l.startTime,eventType:r,lts:p});this.send({type:i,data:m},!0)}abTest(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St(St({},a),r),{},{vid:a.vid===void 0?0:Number(a.vid),elapse:l-i.startTime,eventType:hr.AB_TEST,lts:l});this.send({type:Rn.AB_TEST,data:u},!0)}pcStats(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St(St({},a),r),{},{vid:a.vid===void 0?0:Number(a.vid),elapse:l-i.startTime,eventType:hr.PC_STATS,lts:l,preallocation:r.preallocation?1:0});this.send({type:Rn.PC_STATS,data:u},!0)}updateRemoteRTPCapabilities(t,r){if(t){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St(St({},a),r),{},{vid:a.vid===void 0?0:Number(a.vid),eventType:hr.UPDATE_REMOTE_RTPCAPABILITIES,lts:l});this.send({type:Rn.UPDATE_REMOTE_RTPCAPABILITIES,data:u},!0)}}onGatewayStream(t,r,i,a){const l=this.baseInfoMap.get(t);if(!l)return;const u=l.info,p=Date.now(),m=St(St(St({},u),a),{},{eventType:r,lts:p});this.send({type:i,data:m},!0)}streamSwitch(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St({},a),{},{eventType:hr.STREAM_SWITCH,lts:l,isDual:r.isdual,elapse:l-i.startTime,success:r.succ});this.send({type:Rn.STREAM_SWITCH,data:u},!0)}requestProxyAppCenter(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St({},a),{},{eventType:hr.REQUEST_PROXY_APPCENTER,lts:l,eventElapse:l-r.lts,elapse:l-i.startTime,APAddr:r.APAddr,workerManagerList:r.workerManagerList,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:Rn.REQUEST_PROXY_APPCENTER,data:u},!0)}requestProxyWorkerManager(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St({},a),{},{eventType:hr.REQUEST_PROXY_WORKER_MANAGER,lts:l,eventElapse:l-r.lts,elapse:l-i.startTime,workerManagerAddr:r.workerManagerAddr,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:Rn.REQUEST_PROXY_WORKER_MANAGER,data:u},!0)}setProxyServer(t){this.proxyServer=t,t?A.debug("reportProxyServerurl: ".concat(t)):A.debug("disable reportProxyServerurl: ".concat(t))}peerPublishStatus(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St({},a),{},{subscribeElapse:r.subscribeElapse,peer:r.peer,peerPublishDuration:Math.max(r.audioPublishDuration,r.videoPublishDuration),audiotag:r.audioPublishDuration>0?1:-1,videotag:r.videoPublishDuration>0?1:-1,lts:l,elapse:l-i.startTime,joinChannelSuccessElapse:l-(i.lastJoinSuccessTime||l),peerPublishDurationVideo:r.videoPublishDuration,peerPublishDurationAudio:r.audioPublishDuration});this.send({type:Rn.PEER_PUBLISH_STATUS,data:u},!0)}workerEvent(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now();(function(u,p,m){const g=u[p];if(!g||typeof g!="string")return[u];u[p]="";const y=Tc(JSON.stringify(u));let x=0;const S=[];let T=0;for(let C=0;C<g.length;C++)T+=g.charCodeAt(C)<=127?1:3,T<=m-y||(S[S.length]=Ie(Ie({},u),{},{[p]:g.substring(x,C)}),x=C,T=g.charCodeAt(C)<=127?1:3);return x!==g.length-1&&(S[S.length]=Ie(Ie({},u),{},{[p]:g.substring(x)})),S})(St(St(St({},a),r),{},{elapse:l-i.startTime,lts:l,productType:"WebRTC"}),"payload",1300).forEach(u=>this.send({type:Rn.WORKER_EVENT,data:u},!0))}apworkerEvent(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St(St({},a),r),{},{elapse:l-i.startTime,lts:l});this.send({type:Rn.AP_WORKER_EVENT,data:u},!0)}joinWebProxyAP(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St(St({},a),r),{},{elapse:l-i.startTime,lts:l,extend:r.extend||void 0});this.send({type:Rn.JOIN_WEB_PROXY_AP,data:u},!0)}WebSocketQuit(t,r){const i=this.baseInfoMap.get(t);if(!i)return;const a=i.info,l=Date.now(),u=St(St(St({},a),r),{},{elapse:l-i.startTime,lts:l});this.send({type:Rn.WEBSOCKET_QUIT,data:u},!0)}async sendCustomReportMessage(t,r){if(this.customReportCount+=r.length,this.customReportCount>W("CUSTOM_REPORT_LIMIT"))throw new ge(K.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const i=Date.now(),a=r.map(l=>({type:Rn.USER_ANALYTICS,data:St(St({sid:t},l),{},{lts:i})}));try{W("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(a):await this.postDataToStatsCollector(a)}catch(l){throw A.error("send custom report message failed",l.toString()),new ge(K.CUSTOM_REPORT_SEND_FAILED,l.message)}}sendApiInvoke(t){const r=W("NOT_REPORT_EVENT");if(t.tag&&Ce(r)&&Ce(r).call(r,t.tag))return!1;if(t.sid===null)return this.apiInvokeUploadPendingItems.push(t),!1;const i=this.baseInfoMap.get(t.sid);if(!i)return this.apiInvokeUploadPendingItems.push(t),!1;const{cname:a,uid:l,cid:u}=i.info;let p;if(t.lts=t.lts||Date.now(),t.error)if(t.error instanceof ge){const{code:g,message:y}=t.error;p=g||y||t.error.toString()}else p=t.error.toString();const m={invokeId:t.invokeId,sid:t.sid,cname:a,cid:u,uid:l,lts:t.lts,success:t.success,elapse:t.lts-i.startTime,execElapse:t.lts-t.apiInvokeTime,apiName:t.name,options:t.options?JSON.stringify(t.options):void 0,execStates:t.states?JSON.stringify(t.states):void 0,execResult:t.result?JSON.stringify(t.result):void 0,errorCode:t.error?p:void 0,errorMsg:t.error?JSON.stringify(t.error):void 0};return this.send({type:Rn.API_INVOKE,data:m},!1),!0}addSid(t){this.sids.add(t)}removeSid(t){this.sids.delete(t)}appendSessionId(){const t=this.apiInvokeUploadPendingItems;if(t.length===0)return;const r=Array.from(this.sids).find(i=>i!==null);r&&t.forEach(i=>{i&&(i.sid=r,this.sendApiInvoke(Object.assign({},i)))}),t.length=0}send(t,r){if(r)return this.keyEventUploadPendingItems.push(t),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(t),this.normalEventUploadPendingItems.length>W("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(t,r){const i=[],a=[];for(;t.length;){const u=t.shift();i.length<20?i.push(u):a.push(u)}t.push(...a);for(const u of[...i]){var l;this.ltsList.indexOf(u.data.lts)!==-1?(u.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(u.data.lts)):(this.ltsList.push(u.data.lts),Ou(l=this.ltsList).call(l,(p,m)=>p-m))}return r||(this.lastSendNormalEventTime=Date.now()),W("ENABLE_EVENT_REPORT")&&i.length&&(W("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(i):this.postDataToStatsCollector(i)).catch((u=>p=>{W("EVENT_REPORT_RETRY")&&(r?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(u):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(u),this.normalEventUploadPendingItems.length>W("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-W("NORMAL_EVENT_QUEUE_CAPACITY")),A.warning("report: drop normal events"))))})(i)),t}async postDataToStatsCollector2(t){Un.networkState===Pi.OFFLINE&&await je.race([Un.onlineWaiter,Er(2*er.maxRetryTimeout)]);const r=l=>{let u=new Uint8Array;return l.forEach(p=>{const m=bA(JSON.stringify(p.data)),g=new ArrayBuffer(5),y=(S=>{let T=0;return Object.entries(Rn).forEach(C=>{let[V,j]=C;j===S.type&&(T=v0e[V])}),T})(p),x=new DataView(g);x.setUint16(0,m.byteLength,!0),x.setUint8(2,255&y),x.setUint8(3,y>>>8&255),x.setUint8(4,y>>>16&255),u=_V(u,new Uint8Array(g)),u=_V(u,m)}),u},i="event";let a=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(W("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(i):"https://".concat(W("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(i);for(let l=0;l<2;l+=1){l===1&&(a=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(W("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(i):"https://".concat(W("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(i));try{await AA(a,{timeout:1e4,data:r(t),headers:St(St({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(u){if(l===1)throw u;continue}return}}async postDataToStatsCollector(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=(m=>{const g=m&&m.data.sid&&this.baseInfoMap.get(m.data.sid);return g&&g.info.vid&&+g.info.vid||0})(t[0]),a=i?void 0:this._aid,l={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:t.map(m=>JSON.stringify(m)),vid:i,aid:a};Un.networkState===Pi.OFFLINE&&await je.race([Un.onlineWaiter,Er(2*er.maxRetryTimeout)]);const u=r?"/events/proto-raws":"/events/messages";let p=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(W("EVENT_REPORT_DOMAIN"),"&p=").concat(W("STATS_COLLECTOR_PORT"),"&d=").concat(u):"https://".concat(W("EVENT_REPORT_DOMAIN"),":").concat(W("STATS_COLLECTOR_PORT")).concat(u));for(let m=0;m<2;m+=1){m===1&&(p=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(W("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(W("STATS_COLLECTOR_PORT"),"&d=").concat(u):"https://".concat(W("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(W("STATS_COLLECTOR_PORT")).concat(u)));try{r?await n0e(p,{timeout:1e4,data:l}):await AA(p,{timeout:1e4,data:l})}catch(g){if(m===1)throw g;continue}return}}createBaseInfo(t,r){const i=Object.assign({},g0e);return i.sid=t,this.baseInfoMap.set(t,{info:i,startTime:r}),i}reportResourceTiming(t,r){const i=performance.getEntriesByName(t),a=i[i.length-1];a&&this.reportApiInvoke(r,{name:"Client.resourceTiming",options:a,tag:hn.TRACER}).onSuccess()}};qV.on("REPORT_LOG_UPLOAD",t=>{t.networkState=Un.networkState,Ye.reportApiInvoke(null,{name:"logUploadError",options:t,tag:hn.TRACER}).onSuccess("logUploadError")});let pe=class extends ge{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),Fn(this,"name","AgoraRTCException")}print(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(t,A)}throw(){super.throw(A)}};const wr={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1,supportSuppressLocalAudioPlayback:!1,supportRestrictOwnAudio:!1};function jt(){return wr}function QV(){return"setSinkId"in HTMLAudioElement.prototype&&(!W("RESTRICTION_SET_PLAYBACK_DEVICE")||(ul()||aV())&&!fV())}function r_(){return!wr.supportUnifiedPlan||W("CHROME_FORCE_PLAN_B")&&Sc()}function w0(t){return!(wn()||oV(87)||r_()||!W("ENABLE_PRE_SUB")&&(t==null||!t.autoSubscribe||W("FORCE_DISABLE_AUTO_SUB")))}function ZV(t){return W("ENABLE_INSTANT_VIDEO")?W("ENABLE_INSTANT_VIDEO"):!(t==null||!t.autoSubscribe||W("FORCE_DISABLE_AUTO_SUB"))}function e6(){return navigator.mediaDevices&&"getSupportedConstraints"in navigator.mediaDevices}function t6(){if(e6()){const t=navigator.mediaDevices.getSupportedConstraints();return!(!("suppressLocalAudioPlayback"in t)||!t.suppressLocalAudioPlayback)}return Mo(141)||md(141)||Vu(141)}function n6(){if(e6()){const t=navigator.mediaDevices.getSupportedConstraints();return!(!("restrictOwnAudio"in t)||!t.restrictOwnAudio)}return Mo(141)||md(141)||Vu(125)}let $r=function(t){return t.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",t.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",t.IOS_INTERRUPTION_START="ios-interruption-start",t.IOS_INTERRUPTION_END="ios-interruption-end",t.STATE_CHANGE="state-change",t}({});function sm(t,r,i){return{sampleRate:t,stereo:r,bitrate:i}}function Kt(t,r,i,a,l){return{width:t,height:r,frameRate:i,bitrateMin:a,bitrateMax:l}}function Qa(t,r,i,a,l){return{width:{max:t},height:{max:r},frameRate:i,bitrateMin:a,bitrateMax:l}}function BA(t,r){return{numSpatialLayers:t,numTemporalLayers:r}}const y0e={"90p":Kt(160,90),"90p_1":Kt(160,90),"120p":Kt(160,120,15,30,65),"120p_1":Kt(160,120,15,30,65),"120p_3":Kt(120,120,15,30,50),"120p_4":Kt(212,120),"180p":Kt(320,180,15,30,140),"180p_1":Kt(320,180,15,30,140),"180p_3":Kt(180,180,15,30,100),"180p_4":Kt(240,180,15,30,120),"240p":Kt(320,240,15,40,200),"240p_1":Kt(320,240,15,40,200),"240p_3":Kt(240,240,15,40,140),"240p_4":Kt(424,240,15,40,220),"360p":Kt(640,360,15,80,400),"360p_1":Kt(640,360,15,80,400),"360p_3":Kt(360,360,15,80,260),"360p_4":Kt(640,360,30,80,600),"360p_6":Kt(360,360,30,80,400),"360p_7":Kt(480,360,15,80,320),"360p_8":Kt(480,360,30,80,490),"360p_9":Kt(640,360,15,80,800),"360p_10":Kt(640,360,24,80,800),"360p_11":Kt(640,360,24,80,1e3),"480p":Kt(640,480,15,100,500),"480p_1":Kt(640,480,15,100,500),"480p_2":Kt(640,480,30,100,1e3),"480p_3":Kt(480,480,15,100,400),"480p_4":Kt(640,480,30,100,750),"480p_6":Kt(480,480,30,100,600),"480p_8":Kt(848,480,15,100,610),"480p_9":Kt(848,480,30,100,930),"480p_10":Kt(640,480,10,100,400),"720p":Kt(1280,720,15,120,1130),"720p_auto":Kt(1280,720,30,900,3e3),"720p_1":Kt(1280,720,15,120,1130),"720p_2":Kt(1280,720,30,120,2e3),"720p_3":Kt(1280,720,30,120,1710),"720p_5":Kt(960,720,15,120,910),"720p_6":Kt(960,720,30,120,1380),"1080p":Kt(1920,1080,15,120,2080),"1080p_1":Kt(1920,1080,15,120,2080),"1080p_2":Kt(1920,1080,30,120,3e3),"1080p_3":Kt(1920,1080,30,120,3150),"1080p_5":Kt(1920,1080,60,120,4780),"1440p":Kt(2560,1440,30,120,4850),"1440p_1":Kt(2560,1440,30,120,4850),"1440p_2":Kt(2560,1440,60,120,7350),"4k":Kt(3840,2160,30,120,8910),"4k_1":Kt(3840,2160,30,120,8910),"4k_3":Kt(3840,2160,60,120,13500)},b0e={"480p":Qa(640,480,5),"480p_1":Qa(640,480,5),"480p_2":Qa(640,480,30),"480p_3":Qa(640,480,15),"720p":Qa(1280,720,5),"720p_auto":Kt(1280,720,30,900,3e3),"720p_1":Qa(1280,720,5),"720p_2":Qa(1280,720,30),"720p_3":Qa(1280,720,15),"1080p":Qa(1920,1080,5),"1080p_1":Qa(1920,1080,5),"1080p_2":Qa(1920,1080,30),"1080p_3":Qa(1920,1080,15)},x0e={"1SL1TL":BA(1,1),"3SL3TL":BA(3,3),"2SL3TL":BA(2,3)};function Za(t){return t||(t="480p_1"),typeof t=="string"?Object.assign({},y0e[t]):t}function GA(t){return typeof t=="string"?Object.assign({},b0e[t]):t}function i_(t){return typeof t=="string"?Object.assign({},x0e[t]):t}const _0e={speech_low_quality:sm(16e3,!1),speech_standard:sm(32e3,!1,18),music_standard:sm(48e3,!1),standard_stereo:sm(48e3,!0,56),high_quality:sm(48e3,!1,128),high_quality_stereo:sm(48e3,!0,192)};function s_(t){return typeof t=="string"?Object.assign({},_0e[t]):t}const qu=[];function r6(t){return Zn(t,"mediaSource",["screen","window","application"]),!0}let qe=function(t){return t.NEED_RENEGOTIATE="@need_renegotiate",t.NEED_REPLACE_TRACK="@need_replace_track",t.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",t.NEED_CLOSE="@need_close",t.NEED_ENABLE_TRACK="@need_enable_track",t.NEED_DISABLE_TRACK="@need_disable_track",t.NEED_SESSION_ID="@need_sid",t.SET_OPTIMIZATION_MODE="@set_optimization_mode",t.GET_STATS="@get_stats",t.GET_RTC_STATS="@get_rtc_stats",t.GET_LOW_VIDEO_TRACK="@get_low_video_track",t.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",t.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",t.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",t.NEED_MUTE_TRACK="@need_mute_track",t.NEED_UNMUTE_TRACK="@need_unmute_track",t}({}),Zt=function(t){return t.SCREEN_TRACK="screen_track",t.CUSTOM_TRACK="custome_track",t.LOW_STREAM="low_stream",t.SCREEN_LOW_TRACK="screen_low_track",t}({}),am=function(t){return t[t.HIGH_STREAM=0]="HIGH_STREAM",t[t.LOW_STREAM=1]="LOW_STREAM",t}({}),E0e=function(t){return t[t.HIGH_STREAM=0]="HIGH_STREAM",t[t.LOW_STREAM=1]="LOW_STREAM",t[t.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",t[t.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",t[t.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",t[t.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",t[t.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",t[t.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",t}({}),w0e=function(t){return t[t.DISABLE=0]="DISABLE",t[t.LOW_STREAM=1]="LOW_STREAM",t[t.AUDIO_ONLY=2]="AUDIO_ONLY",t[t.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",t[t.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",t[t.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",t[t.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",t[t.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",t[t.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",t}({}),Xu=function(t){return t.TRANSCEIVER_UPDATED="transceiver-updated",t.SEI_TO_SEND="sei-to-send",t.SEI_RECEIVED="sei-received",t.TRACK_UPDATED="track-updated",t}({}),om=function(t){return t.SOURCE_STATE_CHANGE="source-state-change",t.TRACK_ENDED="track-ended",t.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",t.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",t.CLOSED="closed",t}({}),va=function(t){return t.FIRST_FRAME_DECODED="first-frame-decoded",t.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",t.VIDEO_STATE_CHANGED="video-state-changed",t.PLAY_START="play-start",t.PLAY_END="play-end",t.FIRST_FRAME_RENDER="first-frame-render",t}({}),cm=function(t){return t.AUDIO="audio",t.VIDEO="video",t.DATA="data",t}({}),zs=function(t){return t.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",t.RECEIVE_TRACK_BUFFER="receive_track_buffer",t.ON_AUDIO_BUFFER="on_audio_buffer",t.UPDATE_SOURCE="update_source",t}({});(function(t){t.UPDATE_TRACK_SOURCE="update-track-source"})({});const WA={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},$A={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},i6={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},S0e={uplinkNetworkQuality:0,downlinkNetworkQuality:0},s6={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let ji=function(t){return t.ON_TRACK="on_track",t.ON_NODE="on_node",t}({}),Hs=function(t){return t.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",t.REQUEST_CONSTRAINTS="request_constraints",t}({}),S0=function(t){return t.IDLE="IDLE",t.INITING="INITING",t.INITEND="INITEND",t}({}),Ju=function(t){return t.STATE_CHANGE="state_change",t.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",t.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",t.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",t}({}),ii=function(t){return t.NONE="none",t.INIT="init",t.CANPLAY="canplay",t.PLAYING="playing",t.PAUSED="paused",t.SUSPEND="suspend",t.STALLED="stalled",t.WAITING="waiting",t.ERROR="error",t.DESTROYED="destroyed",t.ABORT="abort",t.ENDED="ended",t.EMPTIED="emptied",t.LOADEDDATA="loadeddata",t}({}),Nc=function(t){return t[t.VideoStateStopped=0]="VideoStateStopped",t[t.VideoStateStarting=1]="VideoStateStarting",t[t.VideoStateDecoding=2]="VideoStateDecoding",t[t.VideoStateFrozen=3]="VideoStateFrozen",t}({});const zA={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let a_=function(t){return t.OPEN="open",t.MESSAGE="message",t.CLOSE="close",t.CLOSING="closing",t.ERROR="error",t}({});function Bt(t,r,i,a,l){var u,p,m={};return Object.keys(a).forEach(function(g){m[g]=a[g]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=pa(u=kL(p=i.slice()).call(p)).call(u,function(g,y){return y(t,r,g)||g},m),l&&m.initializer!==void 0&&(m.value=m.initializer?m.initializer.call(l):void 0,m.initializer=void 0),m.initializer===void 0?(Object.defineProperty(t,r,m),null):m}function me(t,r,i){return(r=function(a){var l=function(u,p){if(typeof u!="object"||!u)return u;var m=u[Symbol.toPrimitive];if(m!==void 0){var g=m.call(u,"string");if(typeof g!="object")return g;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(a);return typeof l=="symbol"?l:l+""}(r))in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t}function a6(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function xn(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?a6(Object(i),!0).forEach(function(a){me(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a6(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}class o6 extends Pn{set _mediaStreamTrack(r){r!==this.mediaStreamTrack&&(this.safeEmit(Xu.TRACK_UPDATED,r),this.mediaStreamTrack=r)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(r,i){super(),me(this,"trackMediaType",void 0),me(this,"_ID",void 0),me(this,"_rtpTransceiver",void 0),me(this,"_lowRtpTransceiver",void 0),me(this,"_hints",[]),me(this,"_isClosed",!1),me(this,"_originMediaStreamTrack",void 0),me(this,"mediaStreamTrack",void 0),me(this,"_external",{}),this._ID=i||tn(8,"track-"),this._originMediaStreamTrack=r,this.mediaStreamTrack=r,function(a){Ce(qu).call(qu,a)||qu.push(a)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(r){return r||fd(()=>{var i;Ye.reportApiInvoke(null,{name:Cn.GET_MEDIA_STREAM_TRACK,options:[],tag:hn.TRACER}).onSuccess(((i=this._mediaStreamTrack)===null||i===void 0?void 0:i.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(r){return r===am.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(r){const i=qu.indexOf(r);i!==-1&&qu.splice(i,1)}(this),this.emit(om.CLOSED),this.removeAllListeners(Xu.SEI_RECEIVED)}_updateRtpTransceiver(r,i){if(i===am.LOW_STREAM){if(this._lowRtpTransceiver===r)return;this._lowRtpTransceiver=r}else{if(this._rtpTransceiver===r)return;this._rtpTransceiver=r}this.emit(Xu.TRANSCEIVER_UPDATED,r,i)}}class lm extends o6{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(r,i){super(r,i),me(this,"_enabled",!0),me(this,"_muted",!1),me(this,"_isExternalTrack",!1),me(this,"_isClosed",!1),me(this,"_enabledMutex",void 0),me(this,"processor",void 0),me(this,"_processorContext",void 0),me(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new kr("".concat(this.getTrackId())),r.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var r,i;return(r=(i=this._originMediaStreamTrack)===null||i===void 0?void 0:i.label)!==null&&r!==void 0?r:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,A.debug("[".concat(this.getTrackId(),"] close")),this.emit(qe.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(r,i){let a=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=a,r!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),i&&this._originMediaStreamTrack.stop()),r.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=r,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await gn(this,qe.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){A.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(om.TRACK_ENDED)}stateCheck(r,i){if(A.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(r,": ").concat(i,"]")),qa(i,r),this._enabled&&this._muted&&r==="enabled"&&i===!1)throw new ge(K.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",A);if(!this._enabled&&!this._muted&&r==="muted"&&i===!0)throw new ge(K.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",A)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():je.resolve([])}}const c6=window.AudioContext||window.webkitAudioContext;let HA,Ks=null;const ln=new class extends Pn{constructor(){super(...arguments),me(this,"prevState",void 0),me(this,"curState",void 0),me(this,"currentTime",void 0),me(this,"currentTimeStuckAt",void 0),me(this,"interruptDetectorTrack",void 0),me(this,"onLocalAudioTrackMute",()=>{A.info("ios15-interruption-start"),this.emit($r.IOS_15_16_INTERRUPTION_START)}),me(this,"onLocalAudioTrackUnmute",async()=>{A.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?A.info("ios15-interruption-end-canceled"):(Ks&&await Ks.suspend(),this.emit($r.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(t){A.debug("webaudio bindInterruptDetectorTrack ".concat(t.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=t,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(t){A.debug("webaudio unbindInterruptDetectorTrack ".concat(t.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===t&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function dm(){if(!Ks){if(function(){if(!c6)return void A.error("your browser is not support web audio");A.info("create audio context");const t=xn({},W("WEBAUDIO_INIT_OPTIONS"));A.debug("audio context init option:",JSON.stringify(t)),Ks=new c6(t),ln.curState=Ks.state,Ks.onstatechange=()=>{ln.prevState=ln.curState,ln.curState=Ks?Ks.state:void 0;const{prevState:r,curState:i}=ln,a=i==="running",l=i==="interrupted",u=r==="running",p=r==="suspended",m=r==="interrupted",g=Ht().osVersion;(pi()||Ya())&&u&&l&&(A.info("ios".concat(g,"-interruption-start")),ln.emit($r.IOS_INTERRUPTION_START)),(pi()||Ya())&&(p||m)&&a&&(A.info("ios".concat(g,"-interruption-end")),ln.emit($r.IOS_INTERRUPTION_END)),r!==i&&ln.emit($r.STATE_CHANGE,i,r)},setInterval(()=>{var r;const i=(r=Ks)===null||r===void 0?void 0:r.currentTime;ln.currentTime!==i?(ln.currentTimeStuckAt&&(A.debug("AudioContext current time resume at ".concat(i)),ln.currentTimeStuckAt=void 0),ln.currentTime=i):(i!==ln.currentTimeStuckAt&&(Ye.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:i},tag:hn.TRACER}).onSuccess(),A.warning("AudioContext current time stuck at ".concat(i))),ln.currentTimeStuckAt=i)},5e3),async function(r){const i=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let a,l,u=!1,p=!1,m=!1;function g(H){r.state==="running"?y(!1):pi()||Ya()?r.state==="suspended"&&(y(!0),H&&r.resume().then(x,x)):r.state!=="closed"&&(y(!0),H&&r.resume().then(x,x))}function y(H){if(u!==H){u=H;for(let Y=0,te=i;Y<te.length;Y+=1){const se=te[Y];H?window.addEventListener(se,S,{capture:!0,passive:!0}):window.removeEventListener(se,S,{capture:!0,passive:!0})}}}function x(){g(!1)}function S(){g(!0)}function T(){let H;try{H=a.play(),H?H.then(j,j):(a.addEventListener("playing",j),a.addEventListener("abort",j),a.addEventListener("error",j))}catch{j()}}function C(H){m||(a.paused?H?(V(!1),m=!0,T()):V(!0):V(!1))}function V(H){if(p!==H){p=H;for(let Y=0,te=i;Y<te.length;Y++){const se=te[Y];H?window.addEventListener(se,L,{capture:!0,passive:!0}):window.removeEventListener(se,L,{capture:!0,passive:!0})}}}function j(){a.removeEventListener("playing",j),a.removeEventListener("abort",j),a.removeEventListener("error",j),m=!1,C(!1)}function L(){C(!0)}if(pi()&&W("IOS_BG_TAG")){const H=r.createMediaStreamDestination(),Y=document.createElement("div");Y.innerHTML="<audio x-webkit-airplay='deny'></audio>",a=Y.children.item(0),a.controls=!1,a.disableRemotePlayback=!0,a.preload="auto",a.srcObject=H.stream,l=()=>{if(W("IOS_AUTO_RESTART_BG_TAG")&&a&&a.srcObject&&!m&&(!a.paused||p!==!0)){a.paused||a.pause();try{m=!0,T()}catch{m=!1}return!0}},C(!0)}return ln.on($r.STATE_CHANGE,function(){g(!0)}),g(!1),l}(Ks).then(r=>{HA=r})}(),!Ks)throw new ge(K.NOT_SUPPORTED,"can not create audio context");return Ks}return Ks}function Qu(t){if(function(){if(KA!==null)return KA;const a=dm(),l=a.createBufferSource(),u=a.createGain(),p=a.createGain();l.connect(u),l.connect(p),l.disconnect(u);let m=!1;try{l.disconnect(u)}catch{m=!0}return l.disconnect(),KA=m,m}())return;const r=t.connect,i=t.disconnect;t.connect=(a,l,u)=>{var p;return t._inputNodes||(t._inputNodes=[]),Ce(p=t._inputNodes).call(p,a)||(a instanceof AudioNode?(t._inputNodes.push(a),r.call(t,a,l,u)):r.call(t,a,l)),t},t.disconnect=(a,l,u)=>{i.call(t),a?Kx(t._inputNodes,a):t._inputNodes=[];for(const p of t._inputNodes)r.call(t,p)}}let KA=null;function YA(t,r){let i=!1;const a=1/r;if(W("DISABLE_WEBAUDIO")){const l=window.setInterval(()=>{i?window.clearInterval(l):t(performance.now()/1e3)},1e3*a)}else{const l=dm();let u=l.createGain();u.gain.value=0,u.connect(l.destination);const p=()=>{if(i)return void(u=null);const m=l.createOscillator();m.onended=p,m.connect(u),m.start(0),m.stop(l.currentTime+a),t(l.currentTime)};p()}return()=>{i=!0}}class l6{constructor(){me(this,"context",void 0),me(this,"analyserNode",void 0),me(this,"sourceNode",void 0),this.context=dm(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(r){if(r!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=r,r==null||r.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||pi()||Ya()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const r=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(r);else{const a=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(a);for(let l=0;l<r.length;++l)r[l]=a[l]/128-1}const i=pa(r).call(r,(a,l)=>a+l*l,0)/r.length;return Math.max(10*Math.log10(i)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var r,i;(r=this.sourceNode)===null||r===void 0||r.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(i=this.sourceNode)===null||i===void 0||i.connect(this.analyserNode)}catch{A.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class d6 extends Pn{get processSourceNode(){return this.sourceNode}set processedNode(r){var i;if(!this.isDestroyed&&this._processedNode!==r){try{var a;(a=this.sourceNode)===null||a===void 0||a.disconnect(this.outputNode)}catch{}(i=this._processedNode)===null||i===void 0||i.disconnect(),this._processedNode=r,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),me(this,"outputNode",void 0),me(this,"outputTrack",void 0),me(this,"isPlayed",!1),me(this,"sourceNode",void 0),me(this,"context",void 0),me(this,"audioBufferNode",void 0),me(this,"destNode",void 0),me(this,"audioOutputLevel",0),me(this,"volumeLevelAnalyser",void 0),me(this,"_processedNode",void 0),me(this,"playNode",void 0),me(this,"isDestroyed",!1),me(this,"onNoAudioInput",void 0),me(this,"isNoAudioInput",!1),me(this,"_noAudioInputCount",0),this.context=dm(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),Qu(this.outputNode),this.volumeLevelAnalyser=new l6}startGetAudioBuffer(r){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(r),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=i=>{this.emit(zs.ON_AUDIO_BUFFER,function(a){for(let l=0;l<a.outputBuffer.numberOfChannels;l+=1){const u=a.outputBuffer.getChannelData(l);for(let p=0;p<u.length;p+=1)u[p]=0}return a.inputBuffer}(i))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!jt().webAudioMediaStreamDest)throw new ge(K.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(r){this.context.state!=="running"&&Yx(()=>{ln.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=r||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(r>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;pi()||Ya()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const i=this.volumeLevelAnalyser.getAnalyserNode();let a;i.getFloatTimeDomainData?(a=new Float32Array(i.fftSize),i.getFloatTimeDomainData(a)):(a=new Uint8Array(i.fftSize),i.getByteTimeDomainData(a));let l=!1;for(let u=0;u<a.length;u++)a[u]!==0&&(l=!0);return l?(this.isNoAudioInput=!1,!0):(await Er(200),await this.checkHasAudioInput(r?r+1:1)&&l)}getAudioVolume(){return this.outputNode.gain.value}setVolume(r){this.outputNode.gain.setValueAtTime(r,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var r,i;(r=this.processedNode)===null||r===void 0||r.disconnect(),(i=this.sourceNode)===null||i===void 0||i.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var r;this.processedNode?(r=this.processedNode)===null||r===void 0||r.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class qA extends d6{get isFreeze(){return!1}constructor(r,i,a){var l;if(super(),me(this,"sourceNode",void 0),me(this,"track",void 0),me(this,"clonedTrack",void 0),me(this,"audioElement",void 0),me(this,"isCurrentTrackCloned",!1),me(this,"isRemoteTrack",!1),me(this,"originVolumeLevelAnalyser",void 0),me(this,"rebuildWebAudio",async()=>{if(A.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void A.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>A.info("resume success")),A.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const m=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?m.stop():this.isCurrentTrackCloned=!0;const g=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(g),Qu(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const y=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(y,this.context.currentTime),Qu(this.outputNode),this.emit(zs.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=g,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),r.kind!=="audio")throw new ge(K.UNEXPECTED_ERROR);this.track=r;const u=new MediaStream([this.track]);if(this.isRemoteTrack=!!i,this.sourceNode=this.context.createMediaStreamSource(u),Qu(this.sourceNode),a){const m=a.clone();m.enabled=!0,this.clonedTrack=m,A.debug("create an unmuted track ".concat(m.id," from the original track ").concat(a.id," to get the volume"));const g=this.context.createMediaStreamSource(new MediaStream([m]));Qu(g),this.originVolumeLevelAnalyser=new l6,this.originVolumeLevelAnalyser.updateSource(g)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=u;const p=Ht();i&&p.os===_r.IOS&&Number((l=p.osVersion)===null||l===void 0?void 0:l.split(".")[0])<15&&(ln.on($r.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(m=>{m||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(r){this.sourceNode.disconnect(),this.track=r,this.isCurrentTrackCloned=!1;const i=new MediaStream([r]);this.sourceNode=this.context.createMediaStreamSource(i),Qu(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(zs.UPDATE_SOURCE),this.audioElement.srcObject=i}destroy(){var r;this.audioElement.srcObject=null,this.audioElement.remove(),ln.off("state-change",this.rebuildWebAudio),(r=this.originVolumeLevelAnalyser)===null||r===void 0||r.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(r){return this.context.createMediaStreamSource(new MediaStream([r]))}updateOriginTrack(r){const i=r.clone();i.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=i),A.debug("create an unmuted track ".concat(i.id," from the original track ").concat(r.id," to get the volume"));const a=this.context.createMediaStreamSource(new MediaStream([i]));Qu(a),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(a)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function u6(t,r,i){const a=(u,p)=>u?typeof u!="number"?u.max||u.exact||u.ideal||u.min||p:u:p,l={audio:!!i&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxHeight:a(r.height,1080),maxWidth:a(r.width,1920)}}};return r.frameRate&&typeof r.frameRate!="number"?(l.video.mandatory.maxFrameRate=r.frameRate.max,l.video.mandatory.minFrameRate=r.frameRate.min):typeof r.frameRate=="number"&&(l.video.mandatory.maxFrameRate=r.frameRate),await navigator.mediaDevices.getUserMedia(l)}async function T0e(t,r){const i=await h6(t.mediaSource),{sourceId:a,audio:l}=await function(u){let p=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new je((m,g)=>{const y=document.createElement("div");y.innerText="share screen",y.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const x=document.createElement("div");x.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const S=document.createElement("div");S.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",S.setAttribute("style","height: 12%;");const T=document.createElement("div");T.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const C=document.createElement("div");C.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const V=document.createElement("button");V.innerHTML="cancel",V.setAttribute("style","width: 85px;"),V.onclick=()=>{document.body.removeChild(H);const Y=new Error("NotAllowedError");Y.name="NotAllowedError",g(Y)};let j=p;const L=document.createElement("div");if(p){const Y=document.createElement("input");Y.setAttribute("type","checkbox");const te=document.createElement("span");Y.setAttribute("style","margin-right: 6px;"),te.innerText="Share audio",Y.checked=j,Y.onchange=()=>{j=Y.checked},L.appendChild(Y),L.appendChild(te)}C.appendChild(L),C.appendChild(V),x.appendChild(S),x.appendChild(T),x.appendChild(C);const H=document.createElement("div");H.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),H.appendChild(y),H.appendChild(x),document.body.appendChild(H),u.map(Y=>{if(Y.id){const te=document.createElement("div");te.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let se=Y.thumbnail;try{const{width:oe}=se.getSize();oe>1920&&(se=se.resize({width:1920}))}catch(oe){throw oe&&oe.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),oe}te.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+se.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+Y.name.replace(/[\u00A0-\u9999<>\&]/g,function(oe){return"&#"+oe.charCodeAt(0)+";"})+"</span>",te.onclick=()=>{document.body.removeChild(H),m({sourceId:Y.id,audio:j})},T.appendChild(te)}})})}(i,r);return await u6(a,t,l)}async function h6(t){let r=["window","screen"];t!=="application"&&t!=="window"||(r=["window"]),t==="screen"&&(r=["screen"]);const i=EV();if(!i)throw console.error("failed to fetch electron, please mount it to window"),new ge(K.ELECTRON_IS_NULL);let a=null;try{var l;a=((l=i.desktopCapturer)===null||l===void 0?void 0:l.getSources({types:r}))||i.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:r})}catch{a=null}a&&a.then||(a=new je((u,p)=>{i.desktopCapturer.getSources({types:r},(m,g)=>{m?p(m):u(g)})}));try{return await a}catch(u){throw new ge(K.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,u.toString())}}const XA=new kr("safari");let p6=!1,m6=!1;async function Ys(t,r){let i=0,a=null;for(;i<2;)try{a=await N0e(t,r,i>0);break}catch(l){if(l instanceof ge)throw A.error("[".concat(r,"] ").concat(l.toString())),l;const u=o_(l.name||l.code||l,l.message);if(u.code===K.MEDIA_OPTION_INVALID){A.debug("[".concat(r,"] detect media option invalid, retry")),i+=1,await Er(500);continue}throw A.error("[".concat(r,"] ").concat(u.toString())),u}if(!a)throw new ge(K.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return a}async function N0e(t,r,i){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new ge(K.NOT_SUPPORTED,"can not find getUserMedia");i&&(t.video&&(delete t.video.width,delete t.video.height),t.screen&&(delete t.screen.width,delete t.screen.height));const a=jt(),l=new MediaStream;if(t.audioSource&&l.addTrack(t.audioSource),t.videoSource&&l.addTrack(t.videoSource),!t.audio&&!t.video&&!t.screen)return A.debug("Using Video Source/ Audio Source"),l;if(t.screen)if(EV())t.screen.sourceId?um(l,await u6(t.screen.sourceId,t.screen,!!t.screenAudio)):um(l,await T0e(t.screen,!!t.screenAudio));else if(ul()&&t.screen.extensionId&&t.screen.mandatory){if(!a.getStreamFromExtension)throw new ge(K.NOT_SUPPORTED,"This browser does not support screen sharing");A.debug("[".concat(r,'] Screen access on chrome stable, looking for extension"'));const T=await(p=t.screen.extensionId,m=r,new je((C,V)=>{try{chrome.runtime.sendMessage(p,{getStream:!0},j=>{if(!j||!j.streamId)return A.error("[".concat(m,"] No response from Chrome Plugin. Plugin not installed properly"),j),void V(new ge(K.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));C(j.streamId)})}catch(j){A.error("[".concat(m,"] AgoraRTC screensharing plugin is not accessible(").concat(p,")"),j.toString()),V(new ge(K.CHROME_PLUGIN_NOT_INSTALL))}}));t.screen.mandatory.chromeMediaSourceId=T,um(l,await navigator.mediaDevices.getUserMedia({video:{mandatory:t.screen.mandatory}}))}else if(a.getDisplayMedia){var u;t.screen.mediaSource&&r6(t.screen.mediaSource);const T={width:t.screen.width,height:t.screen.height,frameRate:t.screen.frameRate,displaySurface:(u=t.screen.displaySurface)!==null&&u!==void 0?u:t.screen.mediaSource==="screen"?"monitor":t.screen.mediaSource},{selfBrowserSurface:C,surfaceSwitching:V,systemAudio:j,preferCurrentTab:L,windowAudio:H,monitorTypeSurfaces:Y}=t.screen,te={selfBrowserSurface:C,surfaceSwitching:V,systemAudio:j,preferCurrentTab:L,windowAudio:H,monitorTypeSurfaces:Y};!C&&delete te.selfBrowserSurface,!V&&delete te.surfaceSwitching,!j&&delete te.systemAudio,!L&&delete te.preferCurrentTab,!H&&delete te.windowAudio,!Y&&delete te.monitorTypeSurfaces,A.debug("[".concat(r,"] getDisplayMedia:"),JSON.stringify({video:T,audio:t.screenAudio,controls:te})),um(l,await navigator.mediaDevices.getDisplayMedia(xn({video:T,audio:t.screenAudio},te)))}else{if(!wn())throw A.error("[".concat(r,"] This browser does not support screenSharing")),new ge(K.NOT_SUPPORTED,"This browser does not support screen sharing");{t.screen.mediaSource&&r6(t.screen.mediaSource);const T={video:{mediaSource:t.screen.mediaSource,width:t.screen.width,height:t.screen.height,frameRate:t.screen.frameRate}};A.debug("[".concat(r,"] getUserMedia: ").concat(JSON.stringify(T))),um(l,await navigator.mediaDevices.getUserMedia(T))}}var p,m;if(!t.video&&!t.audio)return l;let g={video:t.video,audio:t.audio},y=W("MEDIA_DEVICE_CONSTRAINTS");if(y)try{typeof y=="string"&&(y=JSON.parse(y)),g=SA(g,y)}catch{}A.debug("[".concat(r,"] GetUserMedia"),JSON.stringify(g)),Ht();let x,S=null;(Pr()||pi()||Hx())&&(S=await XA.lock());try{x=await navigator.mediaDevices.getUserMedia(g)}catch(T){throw S&&S(),T}return g.audio&&(p6=!0),g.video&&(m6=!0),um(l,x),S&&S(),l}function o_(t,r){switch(t){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new ge(K.MEDIA_OPTION_INVALID,"".concat(t,": ").concat(r));case"NotFoundError":case"DevicesNotFoundError":return new ge(K.DEVICE_NOT_FOUND,"".concat(t,": ").concat(r));case"NotSupportedError":return new ge(K.NOT_SUPPORTED,"".concat(t,": ").concat(r));case"NotReadableError":return new ge(K.NOT_READABLE,"".concat(t,": ").concat(r));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new ge(K.PERMISSION_DENIED,"".concat(t,": ").concat(r));case"ConstraintNotSatisfiedError":return new ge(K.CONSTRAINT_NOT_SATISFIED,"".concat(t,": ").concat(r));default:return A.error("getUserMedia unexpected error",t),new ge(K.UNEXPECTED_ERROR,"".concat(t,": ").concat(r))}}function um(t,r){const i=t.getVideoTracks()[0],a=t.getAudioTracks()[0],l=r.getVideoTracks()[0],u=r.getAudioTracks()[0];u&&(a&&t.removeTrack(a),t.addTrack(u)),l&&(i&&t.removeTrack(i),t.addTrack(l))}const qs=new class extends Pn{get state(){return this._state}set state(t){t!==this._state&&(this.emit(Ju.STATE_CHANGE,t),this._state=t)}constructor(){super(),me(this,"_state",S0.IDLE),me(this,"isAccessMicrophonePermission",!1),me(this,"isAccessCameraPermission",!1),me(this,"lastAccessMicrophonePermission",!1),me(this,"lastAccessCameraPermission",!1),me(this,"checkdeviceMatched",!1),me(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(W("ENUMERATE_DEVICES_INTERVAL")||(f0()||zx()===_r.HARMONY_OS)&&Sc())&&this.updateDevicesInfo()},W("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(t=>A.error(t.toString()))}async enumerateDevices(t,r){let i=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)throw new ge(K.NOT_SUPPORTED,"enumerateDevices() not supported.");const a=await navigator.mediaDevices.enumerateDevices(),l=this.checkMediaDeviceInfoIsOk(a);let u=!this.isAccessMicrophonePermission&&t,p=!this.isAccessCameraPermission&&r;l.audio&&(u=!1),l.video&&(p=!1);let m=null,g=null,y=null;if(!i&&(u||p)){if(XA.isLocked&&(A.debug("[device manager] wait GUM lock"),(await XA.lock())(),A.debug("[device manager] GUM unlock")),p6&&(u=!1,this.isAccessMicrophonePermission=!0),m6&&(p=!1,this.isAccessCameraPermission=!0),A.debug("[device manager] check media device permissions",t,r,u,p),u&&p){try{y=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(x){const S=o_(x.name||x.code||x,x.message);if(S.code===K.PERMISSION_DENIED)throw S;A.warning("getUserMedia failed in getDevices",S)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(u){try{m=await navigator.mediaDevices.getUserMedia({audio:t})}catch(x){const S=o_(x.name||x.code||x,x.message);if(S.code===K.PERMISSION_DENIED)throw S;A.warning("getUserMedia failed in getDevices",S)}this.isAccessMicrophonePermission=!0}else if(p){try{g=await navigator.mediaDevices.getUserMedia({video:r})}catch(x){const S=o_(x.name||x.code||x,x.message);if(S.code===K.PERMISSION_DENIED)throw S;A.warning("getUserMedia failed in getDevices",S)}this.isAccessCameraPermission=!0}A.debug("[device manager] mic permission",t,"cam permission",r)}try{const x=await navigator.mediaDevices.enumerateDevices();return m&&m.getTracks().forEach(S=>S.stop()),g&&g.getTracks().forEach(S=>S.stop()),y&&y.getTracks().forEach(S=>S.stop()),m=null,g=null,y=null,x}catch(x){return m&&m.getTracks().forEach(S=>S.stop()),g&&g.getTracks().forEach(S=>S.stop()),y&&y.getTracks().forEach(S=>S.stop()),m=null,g=null,y=null,new ge(K.ENUMERATE_DEVICES_FAILED,x.toString()).throw()}}async getRecordingDevices(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,t)).filter(r=>r.kind==="audioinput")}async getCamerasDevices(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,t)).filter(r=>r.kind==="videoinput")}async getSpeakers(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,t)).filter(r=>r.kind==="audiooutput")}searchDeviceIdByName(t){let r=null;return this.deviceInfoMap.forEach(i=>{i.device.label===t&&(r=i.device.deviceId)}),r}async getDeviceById(t){const r=(await this.enumerateDevices(!0,!0,!0)).find(i=>i.deviceId===t);if(!r)throw new ge(K.DEVICE_NOT_FOUND,"deviceId: ".concat(t));return r}async init(){this.state=S0.INITING;try{await this.updateDevicesInfo(),this.state=S0.INITEND}catch(t){throw this.state=S0.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")?(A.warning("Device Detection functionality cannot start properly.",t.toString()),t):new ge(K.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.")}}async updateDevicesInfo(){const t=await this.enumerateDevices(!0,!0,!0),r=Date.now(),i=[];if(t[0]&&t[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const l=t.find(p=>p.kind==="audioinput"&&p.deviceId==="default"),u=t.find(p=>p.kind==="audiooutput"&&p.deviceId==="default");l&&u?u.groupId===l.groupId?A.debug("[device-check] default input ".concat(l.label," and output ").concat(u.label," is the same group")):A.debug("[device-check] default input ".concat(l.label," and output ").concat(u.label," is not the same group")):A.debug("[device-check] default input or output not found")}const a=this.checkMediaDeviceInfoIsOk(t);if(t.forEach(l=>{if(!l.deviceId)return;const u=this.deviceInfoMap.get("".concat(l.kind,"_").concat(l.deviceId));if((u?u.state:"INACTIVE")!=="ACTIVE"){const p={initAt:r,updateAt:r,device:l,state:"ACTIVE"};this.deviceInfoMap.set("".concat(l.kind,"_").concat(l.deviceId),p),i.push(p)}u&&(u.updateAt=r)}),this.deviceInfoMap.forEach((l,u)=>{l.state==="ACTIVE"&&l.updateAt!==r&&(l.state="INACTIVE",i.push(l))}),this.state!==S0.INITEND)return a.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(a.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));i.forEach(l=>{switch(l.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Ju.RECORDING_DEVICE_CHANGED,l);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(Ju.CAMERA_DEVICE_CHANGED,l);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Ju.PLAYOUT_DEVICE_CHANGED,l)}}),a.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),a.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(t){const r=t.filter(l=>l.kind==="audioinput"),i=t.filter(l=>l.kind==="videoinput"),a={audio:!1,video:!1};for(const l of r)if(l.label&&l.deviceId){a.audio=!0;break}for(const l of i)if(l.label&&l.deviceId){a.video=!0;break}return a}};let JA=!1;const Ki=new class extends Pn{constructor(){super(...arguments),me(this,"onAutoplayFailed",void 0),me(this,"onAudioAutoplayFailed",void 0)}};function f6(){if(JA)return W("FLS_AUTOPLAY_EMITS")?(Ki.onAutoplayFailed&&Ki.onAutoplayFailed(),Ki.emit("autoplay-failed")):void 0;{const t=r=>{r.preventDefault(),JA=!1,g0()?document.body.removeEventListener("click",t,!0):(document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0))};JA=!0,g0()?document.body.addEventListener("click",t,!0):(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)),A.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),Ki.onAutoplayFailed?Ki.onAutoplayFailed():Ki.onAudioAutoplayFailed?A.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):A.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),Ki.emit("autoplay-failed")}}function g6(t,r,i,a){if(!t)return;const l=Ye.getBaseInfoBySessionId(t);if(!l)return;const u=l.info,p=Date.now(),m=xn(xn({},u),{},{vid:u.vid===void 0?0:Number(u.vid),lts:p,elapse:p-l.startTime,cbRegistered:Ki.onAutoplayFailed||Ki.onAudioAutoplayFailed?1:-1,errorMsg:i,mediaType:r,trackId:a,extend:void 0});Ye.send({type:Rn.AUTOPLAY_FAILED,data:m},!0)}const C0e=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],yi=new class{constructor(){me(this,"onAutoplayFailed",void 0),me(this,"elementMap",new Map),me(this,"elementStateMap",new Map),me(this,"elementsNeedToResume",[]),me(this,"sinkIdMap",new Map),me(this,"autoResumeAfterInterruption",t=>je.all(Array.from(this.elementMap.entries()).map(async r=>{let[i,a]=r;const l=this.elementStateMap.get(i),u=a.srcObject.getAudioTracks()[0],p=u&&u.readyState;if(A.debug("resume after interrupted, ele: ".concat(l," audio: ").concat(p," ").concat(t)),p==="live"){if(t)return a.pause(),a.play();if(ln.curState==="running")return Jp()?(a.pause(),a.play()):l&&l==="paused"?a.play():void 0}}))),me(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(t=>{let[r,i]=t;const a=i.srcObject.getAudioTracks()[0];a&&a.readyState==="live"&&(A.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),i.pause(),i.play())})}),this.autoResumeAudioElement(),ln.on($r.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),ln.on($r.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),ln.on($r.STATE_CHANGE,()=>{pi()&&ln.prevState==="suspended"&&ln.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(t,r){const i=this.elementMap.get(t);if(this.sinkIdMap.set(t,r),i)try{await i.setSinkId(r)}catch(a){throw new ge(K.PERMISSION_DENIED,"can not set sink id: "+a.toString())}}play(t,r,i,a){if(this.elementMap.has(r))return;const l=document.createElement("audio");l.autoplay=!0,l.srcObject=new MediaStream([t]),this.bindAudioElementEvents(r,l),this.elementMap.set(r,l),this.elementStateMap.set(r,ii.INIT),this.setVolume(r,i);const u=this.sinkIdMap.get(r);if(u)try{l.setSinkId(u).catch(m=>{A.warning("[".concat(r,"] set sink id failed"),m.toString())})}catch(m){A.warning("[".concat(r,"] set sink id failed"),m.toString())}const p=l.play();p&&p.then&&p.catch(m=>{a&&g6(a,"audio",m.message,r),A.warning("audio element play warning",m.toString()),this.elementMap.has(r)&&m.name==="NotAllowedError"&&(A.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(l),Yx(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),f6()}))})}updateTrack(t,r){const i=this.elementMap.get(t);i&&(i.srcObject=new MediaStream([r]))}isPlaying(t){return this.elementMap.has(t)&&this.elementStateMap.get(t)==="playing"}setVolume(t,r){const i=this.elementMap.get(t);i&&(r=Math.max(0,Math.min(100,r)),i.volume=r/100)}getVolume(t){const r=this.elementMap.get(t);return r?r.volume:0}stop(t){const r=this.elementMap.get(t);if(this.sinkIdMap.delete(t),!r)return;const i=this.elementsNeedToResume.indexOf(r);this.elementsNeedToResume.splice(i,1),r.srcObject=null,r.remove(),this.elementMap.delete(t),this.elementStateMap.delete(t)}bindAudioElementEvents(t,r){C0e.forEach(i=>{r.addEventListener(i,a=>{const l=this.elementStateMap.get(t),u=a.type==="pause"?"paused":a.type;if(A.debug("[".concat(t,"] audio-element-status change ").concat(l," => ").concat(u)),a.type==="error"){const p=r==null?void 0:r.error;p&&A.error("[".concat(t,"] media error, code: ").concat(p.code,", message: ").concat(p.message))}this.elementStateMap.set(t,u)})})}getPlayerState(t){return this.elementStateMap.get(t)||"uninit"}autoResumeAudioElement(){const t=()=>{this.elementsNeedToResume.forEach(r=>{r.play().then(i=>{A.debug("Auto resume audio element success")}).catch(i=>{A.warning("Auto resume audio element failed!",i)})}),this.elementsNeedToResume=[]};new je(r=>{document.body?r():window.addEventListener("load",()=>r())}).then(()=>{g0()?document.body.addEventListener("click",t,!0):(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0))})}};function Wn(){return function(t,r,i){const a=i.value;return typeof a=="function"&&(i.value=function(){this._isClosed&&new ge(K.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",A);for(var l=arguments.length,u=new Array(l),p=0;p<l;p++)u[p]=arguments[p];const m=a.apply(this,u);return m instanceof je?new je((g,y)=>{m.then(g).catch(y)}):m}),i}}class v6 extends Pn{constructor(r){super(),me(this,"name","VideoProcessorDestination"),me(this,"ID","0"),me(this,"_source",void 0),me(this,"videoContext",void 0),me(this,"inputTrack",void 0),this.videoContext=r}get kind(){return"video"}get enabled(){return!0}pipe(){throw new ge(K.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new ge(K.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(r){if(r.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);r.track&&r.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=r.track,this.emit(ji.ON_TRACK,r.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(ji.ON_TRACK,void 0)}}class y6 extends Pn{set chained(r){this._chained=r}get chained(){return this._chained}constructor(r,i){super(),me(this,"constraintsMap",new Map),me(this,"statsRegistry",[]),me(this,"usageRegistry",[]),me(this,"trackId",void 0),me(this,"direction",void 0),me(this,"_chained",!1),this.trackId=r,this.direction=i}async getConstraints(){return await or(this,Hs.REQUEST_CONSTRAINTS)}async requestApplyConstraints(r,i){var a;return A.info("processor ".concat(i.name," requestApplyConstraints for ").concat(this.trackId)),r&&this.constraintsMap.set(i,r),gn(this,Hs.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ns(a=this.constraintsMap).call(a)))}async requestRevertConstraints(r){var i;if(this.constraintsMap.has(r))return A.info("processor ".concat(r.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(r),gn(this,Hs.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ns(i=this.constraintsMap).call(i)))}registerStats(r,i,a){this.statsRegistry.find(l=>l.processorID===r.ID&&l.processorName===r.name&&l.type===i)||this.statsRegistry.push({processorName:r.name,processorID:r.ID,type:i,cb:a})}unregisterStats(r,i){const a=this.statsRegistry.findIndex(l=>l.processorID===r.ID&&l.processorName===r.name&&l.type===i);a!==-1&&this.statsRegistry.splice(a,1)}gatherStats(){const r=[];for(const{processorID:i,processorName:a,type:l,cb:u}of this.statsRegistry)try{const p=u();r.push({processorID:i,processorName:a,type:l,stats:p})}catch(p){A.error(new ge(K.UNEXPECTED_ERROR,p.message))}return r}registerUsage(r,i){this.usageRegistry.find(a=>a.processorID===r.ID&&a.processorName===r.name)||this.usageRegistry.push({processorID:r.ID,processorName:r.name,cb:i})}unregisterUsage(r){const i=this.usageRegistry.findIndex(a=>a.processorID===r.ID&&a.processorName===r.name);i!==-1&&this.usageRegistry.splice(i,1)}async gatherUsage(){const r=[];if(!this.chained)return[];for(const{cb:i}of this.usageRegistry)try{let a=i();a instanceof je&&(a=await a),r.push(xn(xn({},a),{},{direction:this.direction}))}catch(a){A.error("gather extension usage error",a)}return r}getDirection(){return this.direction}}class b6 extends Pn{constructor(r){super(),me(this,"name","AudioProcessorDestination"),me(this,"ID","0"),me(this,"inputTrack",void 0),me(this,"inputNode",void 0),me(this,"audioProcessorContext",void 0),me(this,"_source",void 0),this.audioProcessorContext=r}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new ge(K.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new ge(K.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(ji.ON_TRACK,void 0),this.emit(ji.ON_NODE,void 0)}updateInput(r){if(r.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);r.track&&this.inputTrack!==r.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=r.track,this.emit(ji.ON_TRACK,this.inputTrack)),r.node&&this.inputNode!==r.node&&(this.audioProcessorContext.chained=!0,this.inputNode=r.node,this.emit(ji.ON_NODE,this.inputNode))}}class x6 extends Pn{set chained(r){this._chained=r}get chained(){return this._chained}constructor(r,i,a){super(),me(this,"constraintsMap",new Map),me(this,"statsRegistry",[]),me(this,"audioContext",void 0),me(this,"trackId",void 0),me(this,"direction",void 0),me(this,"usageRegistry",[]),me(this,"_chained",!1),this.audioContext=r,this.trackId=i,this.direction=a}async getConstraints(){return or(this,Hs.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(r,i){var a;return A.info("processor ".concat(i.name," requestApplyConstraints for ").concat(this.trackId)),r&&this.constraintsMap.set(i,r),gn(this,Hs.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ns(a=this.constraintsMap).call(a)))}async requestRevertConstraints(r){var i;if(this.constraintsMap.has(r))return this.constraintsMap.delete(r),gn(this,Hs.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ns(i=this.constraintsMap).call(i)))}registerStats(r,i,a){this.statsRegistry.find(l=>l.processorID===r.ID&&l.processorName===r.name&&l.type===i)||this.statsRegistry.push({processorName:r.name,processorID:r.ID,type:i,cb:a})}unregisterStats(r,i){const a=this.statsRegistry.findIndex(l=>l.processorID===r.ID&&l.processorName===r.name&&l.type===i);a!==-1&&this.statsRegistry.splice(a,1)}gatherStats(){const r=[];for(const{processorID:i,processorName:a,type:l,cb:u}of this.statsRegistry)try{const p=u();r.push({processorID:i,processorName:a,type:l,stats:p})}catch(p){A.error(new ge(K.UNEXPECTED_ERROR,p.message))}return r}registerUsage(r,i){this.usageRegistry.find(a=>a.processorID===r.ID&&a.processorName===r.name)||this.usageRegistry.push({processorID:r.ID,processorName:r.name,cb:i})}unregisterUsage(r){const i=this.usageRegistry.findIndex(a=>a.processorID===r.ID&&a.processorName===r.name);i!==-1&&this.usageRegistry.splice(i,1)}async gatherUsage(){const r=[];if(!this.chained)return[];for(const{cb:i}of this.usageRegistry)try{let a=i();a instanceof je&&(a=await a),r.push(xn(xn({},a),{},{direction:this.direction}))}catch(a){A.error("gather extension usage error",a)}return r}getDirection(){return this.direction}}class QA extends Pn{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),me(this,"context",void 0),me(this,"processSourceNode",void 0),me(this,"outputTrack",void 0),me(this,"processedNode",void 0),me(this,"clonedTrack",void 0),me(this,"outputNode",void 0),this.outputNode=new R0e}setVolume(){}createOutputTrack(){throw new ge(K.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class R0e{disconnect(){}connect(){}}function _6(t){return new je((r,i)=>{let a=!1;const l=document.createElement("video");l.setAttribute("autoplay",""),l.setAttribute("muted",""),l.muted=!0,l.autoplay=!0,l.setAttribute("playsinline",""),l.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(l);const u=pi()?"canplay":"playing";l.addEventListener(u,()=>{const p=l.videoWidth,m=l.videoHeight;!p&&wn()||(a=!0,l.srcObject=null,l.remove(),r([p,m]))}),l.srcObject=new MediaStream([t]),l.play().catch(b0),setTimeout(()=>{a||(l.srcObject=null,l.remove(),r([l.videoWidth,l.videoHeight]))},4e3)})}function c_(t){const r={};t.facingMode&&(r.facingMode=t.facingMode),t.cameraId&&(r.deviceId={exact:t.cameraId});const i=Za(t.encoderConfig);return i.width!=null&&(r.width=i.width),i.height!=null&&(r.height=i.height),!mV()&&i.frameRate&&(r.frameRate=i.frameRate),aV()&&typeof r.frameRate=="object"&&(r.frameRate.max=60),wn()&&(r.frameRate={ideal:30,max:30}),r}function E6(t){const r={};return mV()||(t.AGC!==void 0&&(r.autoGainControl=t.AGC),t.AEC!==void 0&&(r.echoCancellation=t.AEC),t.ANS!==void 0&&(r.noiseSuppression=t.ANS,ul()&&t.ANS&&(r.googHighpassFilter=t.ANS))),r}function w6(t){const r=E6(t);if(t.encoderConfig){const i=s_(t.encoderConfig);r.channelCount=i.stereo?2:1,r.sampleRate=i.sampleRate,r.sampleSize=i.sampleSize}return t.microphoneId&&(r.deviceId={exact:t.microphoneId}),f0()&&(r.sampleRate=void 0),r}const S6=t=>{const r=t._encoderConfig;if(!r)return;const{frameRate:i,width:a,height:l}=t.getMediaStreamTrackSettings();let{frameRate:u=i,width:p=a,height:m=l}=r;if(!u||!p||!m)return;p=em(p),m=em(m),u=em(u);const{max:g,min:y}=function(C,V,j){const L=200*Math.pow(j/15,.6)*Math.pow(C*V/640/360,.75);return{min:Math.floor(L),max:Math.floor(4*L)}}(p,m,u),{bitrateMax:x,bitrateMin:S}=r||{};x||A.debug("calculate bitrate: [w: ".concat(p,", h: ").concat(m,", fps: ").concat(u,"] => [brMax: ").concat(x,", brMin: ").concat(S,"]"));const{maxFramerate:T}=W("ENCODER_CONFIG_LIMIT");return T&&typeof T=="number"&&(u=Math.min(u,T)),{frameRate:u,bitrateMax:x||g,bitrateMin:S||y,scaleResolutionDownBy:1,scale:0}},T6=async(t,r,i)=>await(async(a,l,u)=>{const p=function(y){const x=[];for(let S=0;S<y.length;S+=2)x.push(parseInt(y.slice(S,S+2),16));return Uint8Array.from(x)}(jV(""+l+u)).slice(0,16),m=p.slice(0,12),g=await window.crypto.subtle.importKey("raw",p,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:m},g,a))})(t.buffer,r,i),ZA=t=>{const r=document.createElement("canvas");return r.width=2,r.height=2,new je((i,a)=>{r.toBlob(async l=>{if(r.remove(),l){const u=await N6(l);i({buffer:u,width:r.width,height:r.height})}else a(new ge(K.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},t,1)})},N6=async t=>{const r=await t.arrayBuffer();return new Uint8Array(r)};var C6,R6,A6,I6,O6,P6,k6,j6,D6,L6,M6,U6,F6,V6,B6,G6,W6,$6,Dn,z6,H6,K6,Y6,q6,X6,Cc,J6,Q6,Z6,eB,tB,nB,rB,iB,sB,aB,oB,cB,lB,ei;let $n=(C6=lt({argsMap:(t,r)=>[t.getTrackId(),r],throttleTime:300}),R6=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),A6=Wn(),I6=tm("LocalAudioTrack","_enabledMutex"),O6=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),P6=Wn(),k6=tm("LocalAudioTrack","_enabledMutex"),j6=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),D6=Wn(),L6=Wn(),M6=Wn(),U6=lt({argsMap:t=>[t.getTrackId()]}),F6=Wn(),V6=lt({argsMap:t=>[t.getTrackId()]}),B6=Wn(),G6=lt({argsMap:t=>[t.getTrackId()]}),W6=lt({argsMap:(t,r)=>[t.getTrackId(),r.name]}),$6=lt({argsMap:t=>[t.getTrackId()]}),Bt((Dn=class extends lm{get _source(){return this.initWebAudio()}set _source(t){this._trackSource=t}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?yi.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(t,r,i,a){super(t,i),me(this,"trackMediaType",cm.AUDIO),me(this,"_encoderConfig",void 0),me(this,"_trackSource",void 0),me(this,"metadata",[]),me(this,"_enabled",!0),me(this,"_volume",100),me(this,"_useAudioElement",!0),me(this,"_bypassWebAudio",!1),me(this,"processor",void 0),me(this,"_processorContext",void 0),me(this,"_processorDestination",void 0),me(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=r,this._getOriginVolumeLevel=!!a,this._trackSource=new QA,W("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),W("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),Pr()&&!Ks?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(t){un(t,"volume",0,1e3),this._volume=t,this._source.setVolume(t/100),this._useAudioElement&&yi.setVolume(this.getTrackId(),t);try{if(this._bypassWebAudio)return void A.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const r=this._source.createOutputTrack();this._mediaStreamTrack!==r&&(this._mediaStreamTrack=r,gn(this,qe.NEED_REPLACE_TRACK,this).then(()=>{A.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(i=>{A.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),i)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(t){if(!this._useAudioElement||!QV())throw new ge(K.NOT_SUPPORTED,"your browser does not support setting the audio output device");await yi.setSinkID(this.getTrackId(),t)}async setEnabled(t,r,i){return this._setEnabled(t,r,i)}async _setEnabled(t,r,i){if(!i){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(A.info("[".concat(this.getTrackId(),"] start setEnabled"),t),t){this._originMediaStreamTrack.enabled=!0;try{i||(this._enabled=!0),await gn(this,qe.NEED_ENABLE_TRACK,this),A.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(t," success"))}catch(a){throw i||(this._enabled=!1),A.error("[".concat(this.getTrackId(),"] setEnabled to true error"),a.toString()),a}}else{this._originMediaStreamTrack.enabled=!1,i||(this._enabled=!1);try{await gn(this,qe.NEED_DISABLE_TRACK,this)}catch(a){throw i||(this._enabled=!0),A.error("[".concat(this.getTrackId(),"] setEnabled to false error"),a.toString()),a}}}async setMuted(t){t!==this._muted&&(this.stateCheck("muted",t),this._muted=t,this._originMediaStreamTrack.enabled=!t,A.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(t)),t?await gn(this,qe.NEED_MUTE_TRACK,this):await gn(this,qe.NEED_UNMUTE_TRACK,this))}getStats(){return fd(()=>{A.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),As(this,qe.GET_STATS)||xn({},WA)}setAudioFrameCallback(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!t)return this._source.removeAllListeners(zs.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(r),this._source.removeAllListeners(zs.ON_AUDIO_BUFFER),this._source.on(zs.ON_AUDIO_BUFFER,i=>t(i))}play(){A.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(A.debug("[".concat(this.getTrackId(),"] start audio playback in element")),yi.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){A.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?yi.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];A.debug("[".concat(this.getTrackId(),"] update player source track")),t&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&yi.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(t,r){this._originMediaStreamTrack!==t&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),r&&this._originMediaStreamTrack.stop()),t.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=t,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:t,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await gn(this,qe.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(t))}renewMediaStreamTrack(t){return je.resolve(void 0)}pipe(t){if(this._bypassWebAudio)throw new ge(K.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===t)return t;if(t._source)throw new ge(K.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),t}unpipe(){var t;if(!this.processor)return;const r=this.processor;(t=this._source.processSourceNode)===null||t===void 0||t.disconnect(),this.processor._source=!1,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(t){t.on(ji.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(r),await gn(this,qe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await gn(this,qe.NEED_REPLACE_TRACK,this))}),t.on(ji.ON_NODE,r=>{this._source.processedNode=r})}unbindProcessorDestinationEvents(t){t.removeAllListeners(ji.ON_TRACK),t.removeAllListeners(ji.ON_NODE)}bindProcessorContextEvents(t){t.on(Hs.REQUEST_CONSTRAINTS,async r=>{r(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(t){t.removeAllListeners(Hs.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof QA&&(this._trackSource=new qA(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const t=new x6(this._source.context,this.getTrackId(),"local"),r=new b6(t);return this._processorContext=t,this._processorDestination=r,this.bindProcessorContextEvents(t),this.bindProcessorDestinationEvents(r),this._source.on(zs.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:t})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(yi.stop(this.getTrackId()),this._source.play()),gn(this,qe.NEED_REPLACE_MIXING_TRACK,this).then(()=>{A.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(i=>{A.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),i)})),{processorContext:t,processorDestination:r}}}).prototype,"setVolume",[C6],Object.getOwnPropertyDescriptor(Dn.prototype,"setVolume"),Dn.prototype),Bt(Dn.prototype,"setPlaybackDevice",[R6,A6],Object.getOwnPropertyDescriptor(Dn.prototype,"setPlaybackDevice"),Dn.prototype),Bt(Dn.prototype,"setEnabled",[I6,O6,P6],Object.getOwnPropertyDescriptor(Dn.prototype,"setEnabled"),Dn.prototype),Bt(Dn.prototype,"setMuted",[k6,j6,D6],Object.getOwnPropertyDescriptor(Dn.prototype,"setMuted"),Dn.prototype),Bt(Dn.prototype,"getStats",[L6],Object.getOwnPropertyDescriptor(Dn.prototype,"getStats"),Dn.prototype),Bt(Dn.prototype,"setAudioFrameCallback",[M6],Object.getOwnPropertyDescriptor(Dn.prototype,"setAudioFrameCallback"),Dn.prototype),Bt(Dn.prototype,"play",[U6,F6],Object.getOwnPropertyDescriptor(Dn.prototype,"play"),Dn.prototype),Bt(Dn.prototype,"stop",[V6,B6],Object.getOwnPropertyDescriptor(Dn.prototype,"stop"),Dn.prototype),Bt(Dn.prototype,"close",[G6],Object.getOwnPropertyDescriptor(Dn.prototype,"close"),Dn.prototype),Bt(Dn.prototype,"pipe",[W6],Object.getOwnPropertyDescriptor(Dn.prototype,"pipe"),Dn.prototype),Bt(Dn.prototype,"unpipe",[$6],Object.getOwnPropertyDescriptor(Dn.prototype,"unpipe"),Dn.prototype),Dn),T0=(z6=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),H6=Wn(),K6=tm("MicrophoneAudioTrack","_enabledMutex"),Y6=lt({argsMap:(t,r,i)=>[t.getTrackId(),r,i]}),q6=Wn(),X6=lt({argsMap:t=>[t.getTrackId()]}),Bt((Cc=class extends $n{get __className__(){return"MicrophoneAudioTrack"}constructor(t,r,i,a){super(t,r.encoderConfig?s_(r.encoderConfig):{},a,W("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),me(this,"_config",void 0),me(this,"_deviceName","default"),me(this,"_constraints",void 0),me(this,"_originalConstraints",void 0),me(this,"_enabled",!0),this._config=r,this._constraints=i,this._originalConstraints=i,this._deviceName=t.label,typeof r.bypassWebAudio=="boolean"&&(this._bypassWebAudio=r.bypassWebAudio),(Jp()||gA())&&ln.bindInterruptDetectorTrack(this)}async setDevice(t){if(A.info("[".concat(this.getTrackId(),"] start set device to ").concat(t)),this._enabled)try{const r=await qs.getDeviceById(t),i={};i.audio=xn({},this._constraints),i.audio.deviceId={exact:t},this._originMediaStreamTrack.stop();let a=null;try{a=await Ys(i,this.getTrackId())}catch(l){throw A.error("[".concat(this.getTrackId(),"] setDevice failed"),l.toString()),a=await Ys({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(a.getAudioTracks()[0],!1),l}await this._updateOriginMediaStreamTrack(a.getAudioTracks()[0],!1),this._deviceName=r.label,this._config.microphoneId=t,this._constraints.deviceId={exact:t}}catch(r){throw A.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}else try{const r=await qs.getDeviceById(t);this._deviceName=r.label,this._config.microphoneId=t,this._constraints.deviceId={exact:t}}catch(r){throw A.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}A.info("[".concat(this.getTrackId(),"] set device to ").concat(t," success"))}async setEnabled(t,r,i){if(r)return A.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(t);if(!i){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(A.info("[".concat(this.getTrackId(),"] start setEnabled"),t),W("AUTO_RESET_AUDIO_ROUTE")&&(pi()||Ya())){const p=navigator.audioSession;p&&(t||(p.type="playback"),p.type="auto")}if(!t){var a;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(a=this._source.clonedTrack)===null||a===void 0||a.stop(),i||(this._enabled=!1);try{await gn(this,qe.NEED_DISABLE_TRACK,this)}catch(p){throw A.error("[".concat(this.getTrackId(),"] setEnabled false failed"),p.toString()),p}return}const l=xn({},this._constraints),u=qs.searchDeviceIdByName(this._deviceName);u&&!l.deviceId&&(l.deviceId=u);try{i||(this._enabled=!0);const p=await Ys({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(p.getAudioTracks()[0],!1),await gn(this,qe.NEED_ENABLE_TRACK,this)}catch(p){throw i||(this._enabled=!1),A.error("[".concat(this.getTrackId(),"] setEnabled true failed"),p.toString()),p}A.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(Jp()||gA())&&ln.unbindInterruptDetectorTrack(this),qu.some(t=>function(r){return"__className__"in r&&r.__className__==="MicrophoneAudioTrack"}(t))||HA&&HA()&&(Ye.reportApiInvoke(null,{name:"BG_AUDIO_TAG_RESTART",options:{},tag:hn.TRACER}).onSuccess(),A.debug("restart background audio tag success"))}onTrackEnded(){if((pi()||Ya())&&this._enabled&&!this._isClosed&&ln.duringInterruption){const t=async()=>{ln.off($r.IOS_INTERRUPTION_END,t),this._enabled&&!this._isClosed&&(A.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};ln.on($r.IOS_INTERRUPTION_END,t)}else A.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(om.TRACK_ENDED)}async renewMediaStreamTrack(t){const r=t||this._constraints,i=qs.searchDeviceIdByName(this._deviceName);if(i&&!r.deviceId&&(r.deviceId=i),this._constraints=r,this._enabled){this._originMediaStreamTrack.stop();const a=await Ys({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(a.getAudioTracks()[0],!0)}}bindProcessorContextEvents(t){super.bindProcessorContextEvents(t),t.on(Hs.REQUEST_UPDATE_CONSTRAINTS,async(r,i,a)=>{try{const l=Object.assign({},this._originalConstraints,...r);await this.renewMediaStreamTrack(l),i()}catch(l){a(l)}})}unbindProcessorContextEvents(t){super.unbindProcessorContextEvents(t),t.removeAllListeners(Hs.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[z6,H6],Object.getOwnPropertyDescriptor(Cc.prototype,"setDevice"),Cc.prototype),Bt(Cc.prototype,"setEnabled",[K6,Y6,q6],Object.getOwnPropertyDescriptor(Cc.prototype,"setEnabled"),Cc.prototype),Bt(Cc.prototype,"close",[X6],Object.getOwnPropertyDescriptor(Cc.prototype,"close"),Cc.prototype),Cc),A0e=(J6=lt({argsMap:(t,r)=>[t.getTrackId(),r,t.duration]}),Q6=Wn(),Z6=lt({argsMap:t=>[t.getTrackId()]}),eB=Wn(),tB=lt({argsMap:t=>[t.getTrackId()]}),nB=Wn(),rB=lt({argsMap:t=>[t.getTrackId()]}),iB=Wn(),sB=lt({argsMap:t=>[t.getTrackId()]}),aB=Wn(),oB=lt({argsMap:t=>[t.getTrackId()]}),cB=lt({argsMap:t=>[t.getTrackId()]}),lB=Wn(),Bt((ei=class extends $n{get __className__(){return"BufferSourceAudioTrack"}constructor(t,r,i,a){super(r.createOutputTrack(),i,a),me(this,"source",void 0),me(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=t,this._bufferSource=r,this._bufferSource.on(zs.AUDIO_SOURCE_STATE_CHANGE,l=>{this.safeEmit(om.SOURCE_STATE_CHANGE,l)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(t){t&&this._bufferSource.updateOptions(t),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(t){this._bufferSource.seekAudioBuffer(t)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(t){un(t,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(t)}}).prototype,"startProcessAudioBuffer",[J6,Q6],Object.getOwnPropertyDescriptor(ei.prototype,"startProcessAudioBuffer"),ei.prototype),Bt(ei.prototype,"pauseProcessAudioBuffer",[Z6,eB],Object.getOwnPropertyDescriptor(ei.prototype,"pauseProcessAudioBuffer"),ei.prototype),Bt(ei.prototype,"seekAudioBuffer",[tB,nB],Object.getOwnPropertyDescriptor(ei.prototype,"seekAudioBuffer"),ei.prototype),Bt(ei.prototype,"resumeProcessAudioBuffer",[rB,iB],Object.getOwnPropertyDescriptor(ei.prototype,"resumeProcessAudioBuffer"),ei.prototype),Bt(ei.prototype,"stopProcessAudioBuffer",[sB,aB],Object.getOwnPropertyDescriptor(ei.prototype,"stopProcessAudioBuffer"),ei.prototype),Bt(ei.prototype,"close",[oB],Object.getOwnPropertyDescriptor(ei.prototype,"close"),ei.prototype),Bt(ei.prototype,"setAudioBufferPlaybackSpeed",[cB,lB],Object.getOwnPropertyDescriptor(ei.prototype,"setAudioBufferPlaybackSpeed"),ei.prototype),ei);class pr extends $n{get __className__(){return"MixingAudioTrack"}get isActive(){for(const r of this.trackList)if(r._enabled&&!r._isClosed&&!r.muted)return!0;return!1}constructor(){const r=dm().createMediaStreamDestination();super(r.stream.getAudioTracks()[0],void 0,tn(8,"track-mix-")),me(this,"trackList",void 0),me(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=r,this.trackList=[]}hasAudioTrack(r){return this.trackList.indexOf(r)!==-1}addAudioTrack(r){this.trackList.indexOf(r)===-1?(A.debug("add ".concat(r.getTrackId()," to mixing track")),r._source.outputNode.connect(this.destNode),this.trackList.push(r),this.updateEncoderConfig()):A.debug("track ".concat(r.getTrackId()," is already added"))}removeAudioTrack(r){if(this.trackList.indexOf(r)!==-1){A.debug("remove ".concat(r.getTrackId()," from mixing track"));try{r._source.outputNode.disconnect(this.destNode)}catch{}Kx(this.trackList,r),this.updateEncoderConfig()}}updateEncoderConfig(){const r={};this.trackList.forEach(i=>{i._encoderConfig&&((i._encoderConfig.bitrate||0)>(r.bitrate||0)&&(r.bitrate=i._encoderConfig.bitrate),(i._encoderConfig.sampleRate||0)>(r.sampleRate||0)&&(r.sampleRate=i._encoderConfig.sampleRate),(i._encoderConfig.sampleSize||0)>(r.sampleSize||0)&&(r.sampleSize=i._encoderConfig.sampleSize),i._encoderConfig.stereo&&(r.stereo=!0))}),this._encoderConfig=r}_updateRtpTransceiver(r){this._rtpTransceiver!==r&&(this._rtpTransceiver=r,this.trackList.forEach(i=>{i instanceof pr?i.emit(Xu.TRANSCEIVER_UPDATED,r):i._updateRtpTransceiver(r)}))}}class I0e extends d6{set currentState(r){r!==this._currentState&&(this._currentState=r,this.safeEmit(zs.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),me(this,"audioBuffer",void 0),me(this,"sourceNode",void 0),me(this,"startPlayTime",0),me(this,"startPlayOffset",0),me(this,"pausePlayTime",0),me(this,"options",void 0),me(this,"currentLoopCount",0),me(this,"currentPlaybackSpeed",100),me(this,"_currentState","stopped"),this.audioBuffer=r,this.options=i,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(r){this.currentState==="stopped"?(this.options=r,this.startPlayOffset=this.options.startPlayTime||0):A.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(r){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=r,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=r))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(r){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=r/100),this.currentPlaybackSpeed=r}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const r=this.context.createBufferSource();return r.buffer=this.audioBuffer,r.loop=!!this.options.loop,r.connect(this.outputNode),r.playbackRate.value=this.currentPlaybackSpeed/100,r}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const dB=new Map;function uB(t,r){if(t.length===0||r.length===0)return 1/0;const i=NA(t),a=NA(r);return Math.floor(a/i)}class e1{get rendFrameRate(){const r=Math.max(1,uB(this._render_interframe_delays_sizes,this._render_interframe_delays));return Math.floor(1e3/r)}get videoElementStatus(){return this._isInPage?this._videoElementStatus:ii.DESTROYED}set videoElementStatus(r){r!==this._videoElementStatus&&(A.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(r)),this._videoElementStatus=r)}get videoState(){return this._videoState}set videoState(r){var i;r!==this._videoState&&(this._videoState=r,(i=this.onVideoStateChanged)===null||i===void 0||i.call(this,this.videoState))}constructor(r){me(this,"trackId",void 0),me(this,"config",void 0),me(this,"onFirstVideoFrameDecoded",void 0),me(this,"onFirstVideoFrameRender",void 0),me(this,"onVideoBufferReady",void 0),me(this,"onVideoStateChanged",void 0),me(this,"freezeTimeCounterList",[]),me(this,"renderFreezeAccTime",0),me(this,"renderFreezeAccTime2",0),me(this,"isKeepLastFrame",!1),me(this,"isDestroyed",!1),me(this,"timeUpdatedCount",0),me(this,"freezeTime",0),me(this,"playbackTime",0),me(this,"lastTimeUpdatedTime",0),me(this,"autoplayFailed",!1),me(this,"videoTrack",void 0),me(this,"videoElement",void 0),me(this,"cacheVideoElement",void 0),me(this,"cancelRVFId",void 0),me(this,"internal",!1),me(this,"_render_interframe_delays",[]),me(this,"_render_interframe_delays_sizes",[]),me(this,"_videoState",Nc.VideoStateStopped),me(this,"videoElementCheckInterval",void 0),me(this,"videoElementFreezeTimeout",void 0),me(this,"_videoElementStatus",ii.NONE),me(this,"_isInPage",!0),me(this,"isGettingVideoDimensions",!1),me(this,"startGetVideoDimensions",()=>{const i=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return A.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(i,500)};!this.isGettingVideoDimensions&&i()}),me(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&ln.curState==="running"&&(A.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(iV())),hV()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),me(this,"handleVideoEvents",i=>{switch(i.type){case"play":case"playing":i.type==="play"&&A.debug("[".concat(this.trackId,"] video element status: play")),this.startGetVideoDimensions(),this.videoElementStatus=ii.PLAYING;break;case"loadeddata":if(this.videoState=Nc.VideoStateStarting,this.onFirstVideoFrameRender&&this.onFirstVideoFrameRender(),this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=ii.CANPLAY;break;case"stalled":this.videoElementStatus=ii.STALLED;break;case"suspend":this.videoElementStatus=ii.SUSPEND;break;case"pause":this.videoElementStatus=ii.PAUSED,pi()||Ya()||Pr()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(A.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=ii.WAITING;break;case"abort":this.videoElementStatus=ii.ABORT;break;case"ended":this.videoElementStatus=ii.ENDED;break;case"emptied":this.videoElementStatus=ii.EMPTIED;break;case"error":{const a=this.videoElement.error;a&&(this.videoElementStatus=ii.ERROR,A.error("[".concat(this.trackId,"] media error: ").concat(a.message," (").concat(a.code,")")));break}case"timeupdate":{const a=performance.now();if(this.timeUpdatedCount+=1,this.onVideoBufferReady&&this.timeUpdatedCount>W("BUFFER_READY_FRAMES")&&this.onVideoBufferReady(),this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=a);const l=a-this.lastTimeUpdatedTime,u=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=a,Is.lastVisibleTime<Is.lastHiddenTime||u<Is.lastHiddenTime||u<Is.lastVisibleTime||this.isSkipCalcRenderFreezeTime())return;for(l>W("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=l),this.playbackTime+=l;this.playbackTime>=6e3;){this.playbackTime-=6e3;const p=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(p),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),me(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(A.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(iV())),hV()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=r.trackId,this.config=r,r.element instanceof HTMLVideoElement?this.videoElement=r.element:this.videoElement=document.createElement("video"),ln.on($r.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),ln.on($r.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var r;return(r=this.videoElement.parentElement)!==null&&r!==void 0?r:void 0}updateConfig(r){this.config=r,this.trackId=r.trackId,r.element!==this.videoElement&&(this.destroy(),this.videoElement=r.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(r){this.videoTrack!==r&&(this.videoTrack=r,this.initVideoElement())}play(r){const i=this.videoElement.play();i&&i.catch&&i.catch(l=>{r&&g6(r,"video",l.message,this.trackId),l.name==="NotAllowedError"?(A.warning("detected video element autoplay failed",l),this.autoplayFailed=!0,this.handleAutoPlayFailed()):A.warning("[".concat(this.trackId,"] play warning: "),l)});const a=Ht();if((a.name==="Safari"&&Number(a.version)===15||Jp())&&i&&i.then){const l=()=>{this.config.mirror&&!this.config.noStyle&&(this.videoElement.style.transform="rotateY(180deg)")};i.then(l).catch(l)}}getCurrentFrame(){const r=document.createElement("canvas");r.width=this.videoElement.videoWidth,r.height=this.videoElement.videoHeight;const i=r.getContext("2d");if(!i)return A.error("create canvas context failed!"),new ImageData(2,2);i.drawImage(this.videoElement,0,0,r.width,r.height);const a=i.getImageData(0,0,r.width,r.height);return r.remove(),a}async getCurrentFrameToUint8Array(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const a=document.createElement("canvas");a.width=this.videoElement.videoWidth,a.height=this.videoElement.videoHeight;const l=a.getContext("2d");return l?(l.drawImage(this.videoElement,0,0,a.width,a.height),new je((u,p)=>{a.toBlob(async m=>{if(a.remove(),m){const g=await N6(m);u({buffer:g,width:a.width,height:a.height})}else p(new ge(K.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},r,i<0?.1:i>1?1:i)})):await ZA(r)}destroy(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.isDestroyed=!0,ln.off($r.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),ln.off($r.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),r?this.videoElement.pause():this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=Nc.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=ii.INIT,!this.videoElementCheckInterval&&(hB.forEach(u=>{this.videoElement.addEventListener(u,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{this._isInPage=function(u){return u!==document.body&&document.body.contains(u)}(this.videoElement)},1e3),W("ENABLE_VIDEO_FRAME_CALLBACK"))){var r,i;let u;const p=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",p),this.videoElementFreezeTimeout=window.setTimeout(m,W("VIDEO_FREEZE_DURATION")))},m=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===Nc.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=Nc.VideoStateFrozen:document.addEventListener("visibilitychange",p))},g=(y,x)=>{if(this.videoElementStatus===ii.PLAYING){if(u){const C=x.presentationTime-u.presentationTime,V=x.presentedFrames-u.presentedFrames;this._render_interframe_delays_sizes.push(V),this._render_interframe_delays.push(C);const j=NA(this._render_interframe_delays_sizes),L=j-this._render_interframe_delays_sizes[0];if(j>30&&L>5&&(this._render_interframe_delays_sizes.shift(),this._render_interframe_delays.shift()),this.videoState===Nc.VideoStateStarting&&(this.videoState=Nc.VideoStateDecoding),this.videoState===Nc.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(m,W("VIDEO_FREEZE_DURATION"))),C<W("VIDEO_FREEZE_DURATION")&&this.videoState===Nc.VideoStateFrozen&&(this.videoState=Nc.VideoStateDecoding),C>W("VIDEO_FREEZE_DURATION")&&Is.lastVisibleTime>=Is.lastHiddenTime&&u.timestamp>Is.lastVisibleTime&&u.timestamp>Is.lastHiddenTime){const H=Math.min(66,uB(this._render_interframe_delays_sizes,this._render_interframe_delays)),Y=Math.max(0,C-(V-1)*H);this.renderFreezeAccTime2+=Y>H?Y:0,this.renderFreezeAccTime+=C}}u=xn(xn({},x),{},{timestamp:y})}else this.isSkipCalcRenderFreezeTime()&&(u=xn(xn({},x),{},{timestamp:y}));var S,T;W("ENABLE_VIDEO_FRAME_CALLBACK")&&(this.cancelRVFId=(S=(T=this.videoElement).requestVideoFrameCallback)===null||S===void 0?void 0:S.call(T,g))};this.cancelRVFId=(r=(i=this.videoElement).requestVideoFrameCallback)===null||r===void 0?void 0:r.call(i,g)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),f0()&&!W("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const a=Ht();this.config.noStyle||(a.name==="Safari"&&Number(a.version)===15||Jp()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover"),this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,wn()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,wn()&&this.videoElement.load());const l=this.videoElement.play();l!==void 0&&l.catch(u=>{A.debug("[".concat(this.trackId,"] playback interrupted"),u.toString())})}resetVideoElement(){var r,i;hB.forEach(a=>{this.videoElement&&this.videoElement.removeEventListener(a,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.cancelRVFId&&this.videoElement&&((r=(i=this.videoElement).cancelVideoFrameCallback)===null||r===void 0||r.call(i,this.cancelRVFId),this.cancelRVFId=void 0),this.videoElementStatus=ii.NONE}isSkipCalcRenderFreezeTime(){return this.videoElementStatus===ii.DESTROYED||this.internal}handleAutoPlayFailed(){const r=i=>{i.preventDefault(),this.videoElement.play().then(()=>{A.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(a=>{A.error(a)}),this.autoplayFailed=!1,g0()?document.body.removeEventListener("click",r,!0):(document.body.removeEventListener("touchstart",r,!0),document.body.removeEventListener("mousedown",r,!0))};g0()?document.body.addEventListener("click",r,!0):(document.body.addEventListener("touchstart",r,!0),document.body.addEventListener("mousedown",r,!0)),f6()}}const hB=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class l_ extends e1{constructor(r){let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];super(r),me(this,"container",void 0),me(this,"slot",void 0),this.slot=r.element,this.internal=i,this.updateConfig(r)}updateConfig(r){this.config=r,this.trackId=r.trackId;const i=r.element;var a;!this.internal||this.slot?(i!==this.slot&&(this.destroy(),this.slot=i),this.createElements()):(this.slot=i,i&&this.container?(this.internal=!1,this.container.id="agora-video-player-".concat(this.trackId),this.videoElement.id="video_".concat(this.trackId),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",(a=this.slot)===null||a===void 0||a.appendChild(this.container)):this.createElements())}updateVideoTrack(r){this.videoTrack!==r&&(this.videoTrack=r,this.createElements())}play(r){var i;(i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)&&super.play(r)}getCurrentFrame(){var r;return(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(r){var i;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(r,a):await ZA(r)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{var r;this.container.remove(),(r=this.slot)===null||r===void 0||r.removeChild(this.container)}catch{}this.container=void 0}}createElements(){var r;this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",W("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),(r=this.slot)===null||r===void 0||r.appendChild(this.container)}mountedVideoElement(){var r;!this.container||(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var r;if((r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var r;(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var pB,mB,fB,gB,vB,yB,bB,xB,_B,EB,wB,SB,TB,NB,CB,RB,AB,IB,OB,PB,kB,jB,DB,LB,MB,UB,FB,VB,Dt,BB,GB,WB,$B,zB,HB,KB,YB,Xs;let pn=(pB=lt({argsMap:(t,r,i)=>[t.getTrackId(),typeof r=="string"?r:r instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",i]}),mB=Wn(),fB=lt({argsMap:t=>[t.getTrackId()]}),gB=tm("LocalVideoTrack","_enabledMutex"),vB=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),yB=Wn(),bB=tm("LocalVideoTrack","_enabledMutex"),xB=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),_B=Wn(),EB=lt({argsMap:(t,r)=>[t.getTrackId(),r,t._saveEncodeBitrateRatio]}),wB=Wn(),SB=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),TB=Wn(),NB=Wn(),CB=lt({argsMap:(t,r,i)=>[t.getTrackId(),r,i]}),RB=Wn(),AB=Wn(),IB=Wn(),OB=lt({argsMap:t=>[t.getTrackId()]}),PB=Wn(),kB=Wn(),jB=Wn(),DB=Wn(),LB=Wn(),MB=lt({argsMap:(t,r)=>[t.getTrackId(),r.name]}),UB=lt({argsMap:t=>[t.getTrackId()]}),FB=lt({argsMap:t=>[t.getTrackId()]}),VB=lt({argsMap:(t,r,i)=>[t.getTrackId(),r.label,i]}),Dt=class Jne extends lm{get videoHeight(){if(Pr()){const{height:r}=this._mediaStreamTrack.getSettings();return this._videoHeight=r,this._videoHeight}return this._videoHeight}get videoWidth(){if(Pr()){const{width:r}=this._mediaStreamTrack.getSettings();return this._videoWidth=r,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==ii.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(r){this._processorContext=r}get __className__(){return"LocalVideoTrack"}constructor(r,i,a,l,u,p){if(super(r,u),me(this,"trackMediaType",cm.VIDEO),me(this,"_player",void 0),me(this,"isUseScaleResolutionDownBy",!1),me(this,"_videoVisibleTimer",null),me(this,"_previousVideoVisibleStatus",void 0),me(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),me(this,"_encoderConfig",void 0),me(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),me(this,"_optimizationMode",void 0),me(this,"_saveEncodeBitrateRatio",1),me(this,"_videoHeight",void 0),me(this,"_videoWidth",void 0),me(this,"_forceBitrateLimit",void 0),me(this,"_enabled",!0),me(this,"_processorDestination",void 0),me(this,"_processorContext",void 0),Pr()){const{width:m,height:g}=r.getSettings();this._videoWidth=m,this._videoHeight=g}else this.updateMediaStreamTrackResolution();if(this._scalabilityMode=a,this._optimizationMode=l,this._hints=p||[],i&&this._hints.indexOf(Zt.CUSTOM_TRACK)!==-1?this._encoderConfig=Sn(i):this._encoderConfig=i,this._hints.indexOf(Zt.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(pA(Yt.CHROME,115)&&zx().indexOf("Windows")!==-1){const m=function(g,y){if("VideoFrame"in window&&"TransformStream"in window&&jt().supportWebRTCInsertableStream){const x=new MediaStreamTrackProcessor(g),S=new MediaStreamTrackGenerator({kind:"video"});let T,C,V=Date.now();const j=()=>{L&&(clearInterval(L),L=void 0),T&&(T.close(),T=void 0),g.stop(),C=void 0,S.removeEventListener("ended",j)};let L=window.setInterval(()=>{if(C&&T&&Date.now()-V>1e3)try{S.readyState==="live"?C.enqueue(T.clone()):j()}catch{j()}},1e3);const H=new TransformStream({transform:(Y,te)=>{S.readyState==="live"?(C=te,V=Date.now(),T===void 0?(T=Y,te.enqueue(Y.clone())):(te.enqueue(T),T=Y)):Y.close()}});return S.addEventListener("ended",j),x.readable.pipeThrough(H).pipeTo(S.writable),S}}(r);m&&(A.info("local screen video track begin to inject frame"),this._mediaStreamTrack=m)}i&&this._hints.indexOf(Zt.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(i),this._processorContext=new y6(this.getTrackId(),"local"),this._processorDestination=new v6(this.processorContext),this.bindProcessorDestinationEvents()}play(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof r=="string"){const l=document.getElementById(r);l?r=l:(A.warning("[".concat(this.getTrackId(),'] can not find "#').concat(r,'" element, use document.body')),r=document.body)}A.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(r instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(i));const a=xn(xn(xn({},this._getDefaultPlayerConfig()),i),{},{trackId:this.getTrackId(),element:r});this._player?this._player.updateConfig(a):(r instanceof HTMLVideoElement?this._player=new e1(a):this._player=new l_(a),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const l=this.getVideoElementVisibleStatus();this.safeEmit(om.VIDEO_ELEMENT_VISIBLE_STATUS,l)}catch{}},W("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,A.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(r,i){if(!i){if(r===this._enabled)return;this.stateCheck("enabled",r)}if(A.info("[".concat(this.getTrackId(),"] start setEnabled"),r),!r){this._originMediaStreamTrack.enabled=!1;try{await gn(this,qe.NEED_DISABLE_TRACK,this)}catch(a){throw A.error("[".concat(this.getTrackId(),"] setEnabled to false error"),a.toString()),a}return i||(this._enabled=!1),void A.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await gn(this,qe.NEED_ENABLE_TRACK,this)}catch(a){throw A.error("[".concat(this.getTrackId(),"] setEnabled to true error"),a.toString()),a}A.info("[".concat(this.getTrackId(),"] setEnabled to true success")),i||(this._enabled=!0)}async setMuted(r){r!==this._muted&&(this.stateCheck("muted",r),this._muted=r,this._originMediaStreamTrack.enabled=!r,A.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(r)),r?await gn(this,qe.NEED_MUTE_TRACK,this):await gn(this,qe.NEED_UNMUTE_TRACK,this))}async setSaveEncodeBitrateRatio(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._saveEncodeBitrateRatio;if(this._saveEncodeBitrateRatio!==1&&this._encoderConfig&&this._encoderConfig.bitrateMax&&this._encoderConfig.bitrateMin){this._encoderConfig.bitrateMin=Math.floor(this._encoderConfig.bitrateMin*r),this._encoderConfig.bitrateMax=Math.floor(this._encoderConfig.bitrateMax*r),A.debug("[".concat(this.getTrackId(),"] set save encode bitrate ratio, ").concat(r)),this._saveEncodeBitrateRatio=1;try{await gn(this,qe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(i){return i.throw(A)}}}async setEncoderConfiguration(r,i){if(!this._enabled)throw new ge(K.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(r=Za(r),W("USE_STANDARD_BITRATE_DEFAULT")&&(delete r.bitrateMax,delete r.bitrateMin),this._forceBitrateLimit&&(r.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:r.bitrateMax,r.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:r.bitrateMin),r.width||r.height||r.frameRate){const a=c_({encoderConfig:r});(Pr()||pi()||Ya())&&(a.deviceId=void 0),A.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(r),JSON.stringify(a));try{await this._originMediaStreamTrack.applyConstraints(a),this.updateMediaStreamTrackResolution()}catch(l){const u=new ge(K.UNEXPECTED_ERROR,l.toString());throw A.error("[".concat(this.getTrackId(),"] applyConstraints error"),u.toString()),u}}this._encoderConfig=r,this._hints.indexOf(Zt.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await gn(this,qe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(a){return a.throw(A)}}getStats(){return fd(()=>{A.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),As(this,qe.GET_STATS)||xn({},$A)}async setBeautyEffect(r){A.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(r,i):await ZA(r)}async findClosestProfile(){const{width:r,height:i,frameRate:a}=this.getMediaStreamTrackSettings(),{width:l,height:u,frameRate:p}=this._encoderConfig||{},m=em(this._videoWidth||r||l||0),g=em(this._videoHeight||i||u||0),y=function(x,S,T){if(!Array.isArray(W("VIDEO_ENCODER_CONFIG_LIST"))||W("VIDEO_ENCODER_CONFIG_LIST").length===0)return!1;const C=Math.min(x,S);return!(C>=480)&&xn(xn({},W("VIDEO_ENCODER_CONFIG_LIST").find(V=>V.height>C)),{},{frameRate:T})}(m,g,em(a||p||15));if(y)return A.debug("[".concat(this.getTrackId(),"] find closest profile, ").concat(m,"x").concat(g," => ").concat(JSON.stringify(y))),this.setEncoderConfiguration(y)}async setBitrateLimit(r){A.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(r))),r&&(this._forceBitrateLimit=r,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<r.max_bitrate?this._encoderConfig.bitrateMax:r.max_bitrate:this._encoderConfig.bitrateMax=r.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=r.min_bitrate))}async setOptimizationMode(r){if(r!=="motion"&&r!=="detail"&&r!=="balanced")return void A.error(K.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const i=this._optimizationMode;try{this._optimizationMode=r,await gn(this,qe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(a){throw this._optimizationMode=i,A.error("[".concat(this.getTrackId(),"] set optimization mode failed"),a.toString()),a}A.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(r,")"))}setScalabiltyMode(r){if(r.numSpatialLayers===1&&r.numTemporalLayers!==1)return A.error(K.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=r,A.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(r,")"))}updateMediaStreamTrackResolution(){_6(this._originMediaStreamTrack).then(r=>{let[i,a]=r;this._videoHeight=a,this._videoWidth=i}).catch(b0)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(r){if(!this._enabled)throw new ge(K.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");A.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(r)),r=Za(r),this._forceBitrateLimit&&(r.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:r.bitrateMax,r.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:r.bitrateMin),this._encoderConfig=r,this._hints.indexOf(Zt.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await gn(this,qe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(i){return i.throw(A)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:r,height:i,frameRate:a}=this.getMediaStreamTrackSettings();if(!r||!i||!a)return;const{bitrateMax:l,bitrateMin:u}=this._encoderConfig;if(u==null||l==null){const{max:p,min:m}=function(g,y,x,S,T){const C=W("BITRATE_ADAPTER_TYPE");if(C==="DEFAULT_BITRATE")return{min:S,max:T};if(T===void 0){const V=Math.floor(200*Math.pow(x/15,.6)*Math.pow(g*y/640/360,.75));T=C==="STANDARD_BITRATE"?4*V:2*V,S=S??V}else S=S??Math.floor(T/10);return{min:S,max:T}}(r,i,a,u,l);if(this._encoderConfig.bitrateMin=m,this._encoderConfig.bitrateMax=p,W("VIDEO_STANDARD_BITRATE_VERSION")&&u==null&&l==null){const[g,y]=function(x,S,T){const C=4*Math.floor(2e5*Math.pow(T/15,.6)*Math.pow(x*S/230400,.75)),V=x*S,j=new Map([[19200,.9],[230400,.85],[518400,.75],[921600,.7],[2073600,.6],[3686400,.5]]),L=new Map([[230400,.95],[518400,.9],[921600,.85],[2073600,.8]]);let H=Ns(j).call(j).next().value,Y=1;if(j.has(V))H=j.get(V);else{var te;const Be=Ou(te=Array.from(j.entries())).call(te,(ut,Tt)=>{let[Et]=ut,[Xt]=Tt;return Et-Xt}),mt=Be.find(ut=>{let[Tt]=ut;return Tt>V});if(mt){const ut=Be.indexOf(mt);if(ut>0){const Tt=Be[ut-1],Et=(V-Tt[0])/(mt[0]-Tt[0]);H=Tt[1]+Et*(mt[1]-Tt[1])}else H=mt[1]}else H=Be[Be.length-1][1]}if(L.has(V))Y=L.get(V);else{var se;const Be=Ou(se=Array.from(L.entries())).call(se,(ut,Tt)=>{let[Et]=ut,[Xt]=Tt;return Et-Xt}),mt=Be.find(ut=>{let[Tt]=ut;return Tt>V});if(mt){const ut=Be.indexOf(mt);if(ut>0){const Tt=Be[ut-1],Et=(V-Tt[0])/(mt[0]-Tt[0]);Y=Tt[1]+Et*(mt[1]-Tt[1])}else Y=mt[1]}else Y=Be[Be.length-1][1]}const oe=W("VIDEO_NEW_BITRATE_RATIO");oe&&oe>0&&(H=oe/100);const ne=Math.floor(C*H),de=Math.floor(65e4*Math.pow(x*S/230400,.5)*Math.pow(T/15,.69));let be=ne;const Se=W("VIDEO_STANDARD_BITRATE_VERSION");return Se&&Se>0&&(Se===1?be=C:Se===2?be=ne:Se===3&&(be=de)),[Math.floor(be/1e3),Y]}(r,i,a);this._encoderConfig.bitrateMax=g,this._encoderConfig.bitrateMin=m?Math.min(m,g):g,this._saveEncodeBitrateRatio=y,A.debug("[".concat(this.getTrackId(),"] update new bitrate from profile, [w: ").concat(r,", h: ").concat(i,", fps: ").concat(a,"] => [brMax: ").concat(this._encoderConfig.bitrateMax,", brMin: ").concat(this._encoderConfig.bitrateMin,", save_bitrate_ratio: ").concat(this._saveEncodeBitrateRatio,"]"))}else A.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(r,", h: ").concat(i,", fps: ").concat(a,"] => [brMax: ").concat(p,", brMin: ").concat(m,"]")),this._saveEncodeBitrateRatio=1}}getVideoElementVisibleStatus(){try{var r,i;const a=this==null||(r=this._player)===null||r===void 0?void 0:r.getContainerElement(),l={track:this,element:this==null||(i=this._player)===null||i===void 0?void 0:i.getVideoElement(),slot:a==null?void 0:a.parentElement},{element:u,slot:p}=l;if(this.isPlaying&&u instanceof HTMLVideoElement&&p instanceof HTMLElement){const m=xV.checkOneElementVisible(u),g=Object.assign({},m);if(g.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=g.visible;const y=Ye.reportApiInvoke(null,{tag:hn.TRACER,name:Cn.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});g.visible?y.onSuccess("Video is visible"):y.onSuccess("Invisible because of ".concat(g.reason))}return g}return}catch(a){throw new ge(K.GET_VIDEO_ELEMENT_VISIBLE_ERROR,a.message)}}async renewMediaStreamTrack(r){}pipe(r){if(this.processor===r)return r;if(r._source)throw new ge(K.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),r}unpipe(){if(!this.processor)return;const r=this.processor;this.processor._source=void 0,this.processor=void 0,r.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(r){let i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],a=this._encoderConfig;r&&(a=xn(xn({},a),Za(r))),a=$u(a);const l=tn(8,"track-video-cloned-"),u=new Jne(i?this._mediaStreamTrack.clone():this._mediaStreamTrack,a,$u(this._scalabilityMode),this._optimizationMode,l,$u(this._hints));return r&&a&&u.setEncoderConfiguration(a),A.debug("clone video track from ".concat(this.getTrackId()," to ").concat(l,", clone ").concat(i)),u}async replaceTrack(r,i){if(!(r instanceof MediaStreamTrack))throw new ge(K.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(r.kind!=="video")throw new ge(K.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(r,i,!0),this.updateMediaStreamTrackResolution()}sendSeiData(r){if(fd(()=>{Ye.reportApiInvoke(null,{name:Cn.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:hn.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!W("ENABLE_VIDEO_SEI")||!W("ENABLE_ENCODED_TRANSFORM"))return void A.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(r instanceof Uint8Array==0)return new ge(K.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const i=this.getRTCRtpTransceiver();if(!i)return void A.warning("Video track is not published, SEI can not be send");const a=i.sender.getParameters();if(a.codecs.length===0)return;const l=a.codecs[0].mimeType.toLocaleLowerCase();l==="video/h264"||l==="video/h265"?this.safeEmit("sei-to-send",r):A.warning("SEI is not supported by ".concat(l))}bindProcessorDestinationEvents(){this.processorDestination.on(ji.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource(),await gn(this,qe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await gn(this,qe.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ji.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(Hs.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(Hs.REQUEST_CONSTRAINTS)}},Bt(Dt.prototype,"play",[pB,mB],Object.getOwnPropertyDescriptor(Dt.prototype,"play"),Dt.prototype),Bt(Dt.prototype,"stop",[fB],Object.getOwnPropertyDescriptor(Dt.prototype,"stop"),Dt.prototype),Bt(Dt.prototype,"setEnabled",[gB,vB,yB],Object.getOwnPropertyDescriptor(Dt.prototype,"setEnabled"),Dt.prototype),Bt(Dt.prototype,"setMuted",[bB,xB,_B],Object.getOwnPropertyDescriptor(Dt.prototype,"setMuted"),Dt.prototype),Bt(Dt.prototype,"setSaveEncodeBitrateRatio",[EB,wB],Object.getOwnPropertyDescriptor(Dt.prototype,"setSaveEncodeBitrateRatio"),Dt.prototype),Bt(Dt.prototype,"setEncoderConfiguration",[SB,TB],Object.getOwnPropertyDescriptor(Dt.prototype,"setEncoderConfiguration"),Dt.prototype),Bt(Dt.prototype,"getStats",[NB],Object.getOwnPropertyDescriptor(Dt.prototype,"getStats"),Dt.prototype),Bt(Dt.prototype,"setBeautyEffect",[CB,RB],Object.getOwnPropertyDescriptor(Dt.prototype,"setBeautyEffect"),Dt.prototype),Bt(Dt.prototype,"getCurrentFrameData",[AB],Object.getOwnPropertyDescriptor(Dt.prototype,"getCurrentFrameData"),Dt.prototype),Bt(Dt.prototype,"getCurrentFrameImage",[IB],Object.getOwnPropertyDescriptor(Dt.prototype,"getCurrentFrameImage"),Dt.prototype),Bt(Dt.prototype,"findClosestProfile",[OB,PB],Object.getOwnPropertyDescriptor(Dt.prototype,"findClosestProfile"),Dt.prototype),Bt(Dt.prototype,"setBitrateLimit",[kB],Object.getOwnPropertyDescriptor(Dt.prototype,"setBitrateLimit"),Dt.prototype),Bt(Dt.prototype,"setOptimizationMode",[jB],Object.getOwnPropertyDescriptor(Dt.prototype,"setOptimizationMode"),Dt.prototype),Bt(Dt.prototype,"setScalabiltyMode",[DB],Object.getOwnPropertyDescriptor(Dt.prototype,"setScalabiltyMode"),Dt.prototype),Bt(Dt.prototype,"updateMediaStreamTrackResolution",[LB],Object.getOwnPropertyDescriptor(Dt.prototype,"updateMediaStreamTrackResolution"),Dt.prototype),Bt(Dt.prototype,"pipe",[MB],Object.getOwnPropertyDescriptor(Dt.prototype,"pipe"),Dt.prototype),Bt(Dt.prototype,"unpipe",[UB],Object.getOwnPropertyDescriptor(Dt.prototype,"unpipe"),Dt.prototype),Bt(Dt.prototype,"close",[FB],Object.getOwnPropertyDescriptor(Dt.prototype,"close"),Dt.prototype),Bt(Dt.prototype,"replaceTrack",[VB],Object.getOwnPropertyDescriptor(Dt.prototype,"replaceTrack"),Dt.prototype),Dt),d_=(BB=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),GB=Wn(),WB=tm("CameraVideoTrack","_enabledMutex"),$B=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),zB=Wn(),HB=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),KB=Wn(),YB=lt({argsMap:t=>[t.getTrackId()]}),Xs=class Qne extends pn{get __className__(){return"CameraVideoTrack"}constructor(r,i,a,l,u,p){super(r,Za(i.encoderConfig),l,u,p),me(this,"_config",void 0),me(this,"_originalConstraints",void 0),me(this,"_constraints",void 0),me(this,"_enabled",!0),me(this,"_deviceName","default"),me(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(Jp()||gA())&&!function(){const m=Ht();if(m.os!==_r.IOS||!m.osVersion)return!1;const g=m.osVersion.split(".");return Number(g[0])===15&&Number(g[1])>=2}()&&pV()&&this._enabled&&!this._isClosed&&(A.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=i,this._originalConstraints=a,this._constraints=a,this._deviceName=r.label,this._encoderConfig=Za(this._config.encoderConfig),ln.on($r.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),ln.on($r.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(r){return typeof r=="string"?this._setDeviceById(r):r.deviceId?this._setDeviceById(r.deviceId):r.facingMode?this._setDeviceByFacingModel(r.facingMode):void 0}async _setDeviceById(r){if(A.info("[".concat(this.getTrackId(),"] set device to ").concat(r)),this._enabled)try{const i=await qs.getDeviceById(r),a={};a.video=xn({},this._constraints),a.video.deviceId={exact:r},a.video.facingMode=void 0,this._originMediaStreamTrack.stop();let l=null;try{l=await Ys(a,this.getTrackId())}catch(u){throw A.error("[".concat(this.getTrackId(),"] setDevice failed"),u.toString()),l=await Ys({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=i.label,this._config.cameraId=r,this._constraints.deviceId={exact:r}}catch(i){throw A.error("[".concat(this.getTrackId(),"] setDevice error"),i.toString()),i}else try{const i=await qs.getDeviceById(r);this._deviceName=i.label,this._config.cameraId=r,this._constraints.deviceId={exact:r}}catch(i){throw A.error("[".concat(this.getTrackId(),"] setDevice error"),i.toString()),i}A.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(r){A.info("[".concat(this.getTrackId(),"] set facingMode ").concat(r));const i={video:xn(xn({},this._constraints),{},{deviceId:void 0,facingMode:{exact:r}})};if(this._enabled){this._originMediaStreamTrack.stop();let a=null;try{a=await Ys(i,this.getTrackId())}catch(l){throw A.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),l.toString()),a=await Ys({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),l}await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=r,this._config.cameraId=void 0,this._constraints=xn({},i.video),A.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(r,i){if(!i){if(r===this._enabled)return;this.stateCheck("enabled",r)}if(A.info("[".concat(this.getTrackId(),"] start setEnabled"),r),r){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const a=await Ys({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1)}await gn(this,qe.NEED_ENABLE_TRACK,this)}catch(a){throw A.error("[".concat(this.getTrackId(),"] setEnabled true error"),a.toString()),a}this.updateMediaStreamTrackResolution(),A.info("[".concat(this.getTrackId(),"] setEnabled to true success")),i||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),i||(this._enabled=!1);try{await gn(this,qe.NEED_DISABLE_TRACK,this)}catch(a){throw A.error("[".concat(this.getTrackId(),"] setEnabled to false error"),a.toString()),a}A.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(r,i){if(!this._enabled)throw new ge(K.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");r=Za(r),W("USE_STANDARD_BITRATE_DEFAULT")&&(delete r.bitrateMax,delete r.bitrateMin),this._forceBitrateLimit&&(r.bitrateMax=this._forceBitrateLimit.max_bitrate||r.bitrateMax,r.bitrateMin=this._forceBitrateLimit.min_bitrate||r.bitrateMin);const a=Sn(this._config);a.encoderConfig=r;const l=c_(a);(Pr()||pi()||Ya())&&(l.deviceId=void 0),A.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(r),JSON.stringify(l));try{await this._originMediaStreamTrack.applyConstraints(l),this.updateMediaStreamTrackResolution()}catch(u){const p=new ge(K.UNEXPECTED_ERROR,u.toString());throw A.error("[".concat(this.getTrackId(),"] applyConstraints error"),p.toString()),p}this._config=a,this._constraints=l,this._originalConstraints=l,this._encoderConfig=r,this._hints.indexOf(Zt.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await gn(this,qe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(u){return u.throw(A)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((pi()||Ya())&&this._enabled&&!this._isClosed&&ln.duringInterruption){const r=async()=>{ln.off($r.IOS_INTERRUPTION_END,r),this._enabled&&!this._isClosed&&(A.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};ln.on($r.IOS_INTERRUPTION_END,r)}else A.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(om.TRACK_ENDED)}async renewMediaStreamTrack(r){const i=r||this._constraints,a=qs.searchDeviceIdByName(this._deviceName);if(a&&!i.deviceId&&(i.deviceId={exact:a}),this._enabled){const l=await Ys({video:i},this.getTrackId());this._constraints=i,await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),ln.off($r.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),ln.off($r.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(r){let i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],a=this._encoderConfig;r&&(a=xn(xn({},a),Za(r))),a=$u(a);const l=tn(8,"track-cam-cloned-"),u=new Qne(i?this._mediaStreamTrack.clone():this._mediaStreamTrack,$u(xn(xn({},this._config),{},{encoderConfig:a})),$u(this._constraints),$u(this._scalabilityMode),this._optimizationMode,l);return r&&a&&u.setEncoderConfiguration(a),A.debug("clone track from ".concat(this.getTrackId()," to ").concat(l,", clone ").concat(i)),u}bindProcessorContextEvents(){this.processorContext.on(Hs.REQUEST_UPDATE_CONSTRAINTS,async(r,i,a)=>{try{const l=Object.assign({},this._originalConstraints,...r);await this.renewMediaStreamTrack(l),i()}catch(l){a(l)}}),this.processorContext.on(Hs.REQUEST_CONSTRAINTS,async r=>{r(this._originMediaStreamTrack.getSettings())})}},Bt(Xs.prototype,"setDevice",[BB,GB],Object.getOwnPropertyDescriptor(Xs.prototype,"setDevice"),Xs.prototype),Bt(Xs.prototype,"setEnabled",[WB,$B,zB],Object.getOwnPropertyDescriptor(Xs.prototype,"setEnabled"),Xs.prototype),Bt(Xs.prototype,"setEncoderConfiguration",[HB,KB],Object.getOwnPropertyDescriptor(Xs.prototype,"setEncoderConfiguration"),Xs.prototype),Bt(Xs.prototype,"close",[YB],Object.getOwnPropertyDescriptor(Xs.prototype,"close"),Xs.prototype),Xs);function qB(t){const r=tn(8,"track-cus-"),i=Ye.reportApiInvoke(null,{id:r,tag:hn.TRACER,name:Cn.CREATE_CUSTOM_AUDIO_TRACK,options:[t]}),a=new $n(t.mediaStreamTrack,t.encoderConfig?s_(t.encoderConfig):{},r,!1);return A.info("create custom audio track success with config",t,"trackId",a.getTrackId()),i.onSuccess(a.getTrackId()),a}function t1(t,r,i,a){i.optimizationMode&&(a&&a.width&&a.height?(i.encoderConfig=xn(xn({},a),{},{bitrateMin:a.bitrateMin,bitrateMax:a.bitrateMax}),i.optimizationMode!=="motion"&&i.optimizationMode!=="detail"||(r.contentHint=i.optimizationMode,r.contentHint===i.optimizationMode?A.debug("[".concat(t,"] set content hint to"),i.optimizationMode):A.debug("[".concat(t,"] set content hint failed")))):A.warning("[".concat(t,"] can not apply optimization mode bitrate config, no encoderConfig")))}var XB,JB,QB,ZB,ya,e8,t8,n8,r8,i8,s8,a8,ti;class o8 extends o6{getUserId(){return this._userId}constructor(r,i,a,l){super(r,"track-".concat(r.kind,"-").concat(i,"-").concat(l.clientId,"_").concat(tn(5,""))),me(this,"_userId",void 0),me(this,"_uintId",void 0),me(this,"_isDestroyed",!1),me(this,"store",void 0),me(this,"processor",void 0),me(this,"processorContext",void 0),this._userId=i,this._uintId=a,this.store=l}_updateOriginMediaStreamTrack(r){this._originMediaStreamTrack=r,this._mediaStreamTrack=r,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,A.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let hm=(XB=lt({argsMap:(t,r,i)=>[t.getTrackId(),typeof r=="string"?r:r instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",i]}),JB=lt({argsMap:t=>[t.getTrackId()]}),QB=lt({argsMap:(t,r)=>[t.getTrackId(),r.name]}),ZB=lt({argsMap:t=>[t.getTrackId()]}),Bt((ya=class extends o8{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==ii.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(t,r,i,a,l){super(t,r,i,a),me(this,"_videoVisibleTimer",null),me(this,"_previousVideoVisibleStatus",void 0),me(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),me(this,"trackMediaType",cm.VIDEO),me(this,"_videoWidth",void 0),me(this,"_videoHeight",void 0),me(this,"_player",void 0),me(this,"_prePlayer",void 0),me(this,"processorDestination",void 0),me(this,"processorContext",void 0),this._prePlayer=l,this.updateMediaStreamTrackResolution(),this.processorContext=new y6(this.getTrackId(),"remote"),this.processorDestination=new v6(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return fd(()=>{A.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),As(this,qe.GET_STATS)||xn({},s6)}play(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.safeEmit(va.PLAY_START),typeof t=="string"){const a=document.getElementById(t);a?t=a:(A.warning("[".concat(this.getTrackId(),'] can not find "#').concat(t,'" element, use document.body')),t=document.body)}A.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(r));const i=xn(xn({fit:"cover"},r),{},{trackId:this.getTrackId(),element:t});if(this._player)this._player.updateConfig(i);else{let a=!1,l=!1;t instanceof HTMLVideoElement?(this._player=new e1(i),this._prePlayer&&(this._prePlayer.destroy(),this._prePlayer=void 0,l=!0)):this._prePlayer&&!this._prePlayer.isDestroyed?(this._player=this._prePlayer,this._prePlayer=void 0,a=this._player.videoState>0,this._player.updateConfig(i)):this._player=new l_(i),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(va.FIRST_FRAME_DECODED),l&&this.safeEmit(va.FIRST_FRAME_RENDER)},this._player.onVideoStateChanged=u=>{this.safeEmit(va.VIDEO_STATE_CHANGED,u)},a&&(this._player.onFirstVideoFrameDecoded(),this._player.onVideoStateChanged(this._player.videoState))}this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const a=this.getVideoElementVisibleStatus();this.safeEmit(va.VIDEO_ELEMENT_VISIBLE_STATUS,a)}catch{}},W("CHECK_VIDEO_VISIBLE_INTERVAL")),this.safeEmit(va.PLAY_END)}stop(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(t),this._player=void 0,A.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){_6(this._originMediaStreamTrack).then(t=>{let[r,i]=t;this._videoHeight=i,this._videoWidth=r}).catch(b0)}_updatePlayerSource(){A.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var t,r;const i=this==null||(t=this._player)===null||t===void 0?void 0:t.getContainerElement(),a={track:this,element:this==null||(r=this._player)===null||r===void 0?void 0:r.getVideoElement(),slot:i==null?void 0:i.parentElement},{element:l,slot:u}=a;if(this.isPlaying&&l instanceof HTMLVideoElement&&u instanceof HTMLElement){const p=xV.checkOneElementVisible(l),m=Object.assign({},p);if(m.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=m.visible;const g=Ye.reportApiInvoke(null,{tag:hn.TRACER,name:Cn.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});m.visible?g.onSuccess("Video is visible"):g.onSuccess("Invisible because of ".concat(m.reason))}return m}return}catch(i){throw new ge(K.GET_VIDEO_ELEMENT_VISIBLE_ERROR,i.message)}}pipe(t){if(this.processor===t)return t;if(t._source)throw new ge(K.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),t}unpipe(){if(!this.processor)return;const t=this.processor;this.processor._source=void 0,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ji.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ji.ON_TRACK)}_destroy(){this._prePlayer&&(this._prePlayer.destroy(),this._prePlayer=void 0),super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(t){this.emit(Xu.SEI_RECEIVED,t)}}).prototype,"play",[XB],Object.getOwnPropertyDescriptor(ya.prototype,"play"),ya.prototype),Bt(ya.prototype,"stop",[JB],Object.getOwnPropertyDescriptor(ya.prototype,"stop"),ya.prototype),Bt(ya.prototype,"pipe",[QB],Object.getOwnPropertyDescriptor(ya.prototype,"pipe"),ya.prototype),Bt(ya.prototype,"unpipe",[ZB],Object.getOwnPropertyDescriptor(ya.prototype,"unpipe"),ya.prototype),ya),pm=(e8=lt({argsMap:(t,r)=>[t.getTrackId(),r],throttleTime:300}),t8=lt({argsMap:(t,r)=>[t.getTrackId(),r],throttleTime:300}),n8=lt({argsMap:(t,r)=>[t.getTrackId(),r]}),r8=lt({argsMap:t=>[t.getTrackId()]}),i8=lt({argsMap:t=>[t.getTrackId()]}),s8=lt({argsMap:(t,r)=>[t.getTrackId(),r.name]}),a8=lt({argsMap:t=>[t.getTrackId()]}),Bt((ti=class extends o8{get isPlaying(){return this._useAudioElement?yi.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(t,r,i,a){super(t,r,i,a),me(this,"trackMediaType",cm.AUDIO),me(this,"_source",void 0),me(this,"_useAudioElement",!0),me(this,"_volume",100),me(this,"processorContext",void 0),me(this,"processorDestination",void 0),me(this,"_played",!1),me(this,"_bypassWebAudio",!1),W("DISABLE_WEBAUDIO")?(this._source=new QA,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new qA(t,!0),W("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(zs.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(va.FIRST_FRAME_DECODED)}),this.processorContext=new x6(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new b6(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(zs.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!t)return this._source.removeAllListeners(zs.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(r),this._source.removeAllListeners(zs.ON_AUDIO_BUFFER),this._source.on(zs.ON_AUDIO_BUFFER,i=>t(i))}setVolume(t){this._volume=t,this._useAudioElement?yi.setVolume(this.getTrackId(),t):this._source.setVolume(t/100)}setAmplifiedVolume(t){this._useAudioElement&&this._played&&(yi.stop(this.getTrackId()),this._source.play()),this._useAudioElement=!1,t=Math.min(t,W("MAX_WEBAUDIO_VOLUME")),this._volume=t,this._source.setVolume(t/100)}async setPlaybackDevice(t){if(!this._useAudioElement||!QV())throw new ge(K.NOT_SUPPORTED,"your browser does not support setting the audio output device");await yi.setSinkID(this.getTrackId(),t)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getVolume(){return this._useAudioElement?yi.getVolume(this.getTrackId()):this._source instanceof qA?this._source.getAudioVolume():0}getStats(){return fd(()=>{A.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),As(this,qe.GET_STATS)||xn({},i6)}play(){A.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(A.debug("[".concat(this.getTrackId(),"] use audio element to play")),yi.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):(A.debug("[".concat(this.getTrackId(),"] use audio context to play")),this._source.play())}stop(){A.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?yi.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];A.debug("[".concat(this.getTrackId(),"] update player source track")),t&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&yi.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(t){if(this._bypassWebAudio)throw new ge(K.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===t)return t;if(t._source)throw new ge(K.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),t}unpipe(){var t;if(this._bypassWebAudio)throw new ge(K.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const r=this.processor;(t=this._source.processSourceNode)===null||t===void 0||t.disconnect(),this.processor._source=!1,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ji.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(t)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(ji.ON_NODE,t=>{this._source.processedNode=t;const r=!t;this._useAudioElement!==r&&(this._played?(this.stop(),this._useAudioElement=r,this.play()):this._useAudioElement=r)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ji.ON_TRACK),this.processorDestination.removeAllListeners(ji.ON_NODE)}}).prototype,"setVolume",[e8],Object.getOwnPropertyDescriptor(ti.prototype,"setVolume"),ti.prototype),Bt(ti.prototype,"setAmplifiedVolume",[t8],Object.getOwnPropertyDescriptor(ti.prototype,"setAmplifiedVolume"),ti.prototype),Bt(ti.prototype,"setPlaybackDevice",[n8],Object.getOwnPropertyDescriptor(ti.prototype,"setPlaybackDevice"),ti.prototype),Bt(ti.prototype,"play",[r8],Object.getOwnPropertyDescriptor(ti.prototype,"play"),ti.prototype),Bt(ti.prototype,"stop",[i8],Object.getOwnPropertyDescriptor(ti.prototype,"stop"),ti.prototype),Bt(ti.prototype,"pipe",[s8],Object.getOwnPropertyDescriptor(ti.prototype,"pipe"),ti.prototype),Bt(ti.prototype,"unpipe",[a8],Object.getOwnPropertyDescriptor(ti.prototype,"unpipe"),ti.prototype),ti);const Is=new class extends Pn{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),me(this,"_lastHiddenTime",0),me(this,"_lastVisibleTime",0),me(this,"needUploadStats",[]),me(this,"isCollectingStats",!1),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),this.isCollectingStats&&this.needUploadStats.push(document.visibilityState==="visible"?1:0),A.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}startCollectStats(){this.isCollectingStats=!0,this.needUploadStats.push(this.visibility==="visible"?1:0)}stopCollectStats(){this.isCollectingStats=!1,this.needUploadStats.length=0}};class c8 extends Pn{constructor(r,i){super(),me(this,"trackMediaType",cm.DATA),me(this,"_version",1),me(this,"_type",3),me(this,"_config",void 0),me(this,"_originDataChannel",void 0),me(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),me(this,"_dataStreamPacketHandler",{serialize:a=>a,deserialize:a=>a}),me(this,"_datachannelEventMap",new Map),this._config=r,i&&(this._originDataChannel=i,this._bandDataChannelEvents(i)),this._initPacketHeader()}useDataStream(r){this._dataStreamPacketHandler=r}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return W("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var r,i;return(r=(i=this._originDataChannel)===null||i===void 0?void 0:i.readyState)!==null&&r!==void 0?r:"connecting"}get _originDataChannelId(){var r,i;return(r=(i=this._originDataChannel)===null||i===void 0?void 0:i.id)!==null&&r!==void 0?r:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new je((r,i)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&r();const a=setTimeout(()=>{var l;i(new ge(K.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((l=this._originDataChannel)===null||l===void 0?void 0:l.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(a),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),r()},this._originDataChannel.onerror=()=>{throw clearTimeout(a),new ge(K.DATACHANNEL_CONNECTION_TIMEOUT)}}else i(new ge(K.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(r){this._originDataChannel=r,this._bandDataChannelEvents(r)}_initPacketHeader(){const r=new DataView(this._dataStreamPacketHeader);r.setUint16(0,this._version),r.setUint8(2,this._type),r.setUint8(3,this._config.id)}_bandDataChannelEvents(r){this._unbindDataChannelEvents(r),[a_.OPEN,a_.CLOSE,a_.ERROR].forEach(i=>{const a=()=>{this.emit(i)};this._datachannelEventMap.set(i,a),r.addEventListener(i,a)})}_unbindDataChannelEvents(r){Array.from(this._datachannelEventMap.entries()).forEach(i=>{let[a,l]=i;r.removeEventListener(a,l)}),this._datachannelEventMap.clear()}}class O0e extends c8{constructor(r){super(r),me(this,"_messageListener",void 0),this._messageListener=i=>{if(i.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const a=i.data.slice(0,this._dataStreamPacketHeader.byteLength),l=new DataView(a).getUint8(3);if(l!==this.id)return void(W("SHOW_DATASTREAM2_LOG")&&A.debug("invalid datachannel id: ".concat(l," !== ").concat(this.id)));let u=i.data.slice(this._dataStreamPacketHeader.byteLength);u=this._dataStreamPacketHandler.deserialize(u),this.emit(a_.MESSAGE,u)}}_updateOriginDataChannel(r){super._updateOriginDataChannel(r),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class P0e extends c8{send(r){if(this._originDataChannel){let i=r;i=this._dataStreamPacketHandler.serialize(r);const a=new Uint8Array(this._dataStreamPacketHeader.byteLength+i.byteLength);a.set(new Uint8Array(this._dataStreamPacketHeader),0),a.set(new Uint8Array(i),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(a.buffer)}}}function u_(){const t=new Blob([atob("Y29uc3QgdD0idmlkZW8vaDI2NCIsZT0idmlkZW8vaDI2NSI7ZnVuY3Rpb24gbih0LGUsbil7bGV0IGE9bmV3IFVpbnQ4QXJyYXkodCxlLG4pLHI9W10sbz0wO2Zvcig7ci5sZW5ndGg8bjspbyszPG4mJjA9PT1hW29dJiYwPT09YVtvKzFdJiYzPT09YVtvKzJdJiYoMD09PWFbbyszXXx8MT09PWFbbyszXXx8Mj09PWFbbyszXXx8Mz09PWFbbyszXSk/KHIucHVzaChhW29dLGFbbysxXSxhW28rM10pLG8rPTQpOihyLnB1c2goYVtvXSksbysrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkocil9ZnVuY3Rpb24gYShhLHIpe3N3aXRjaChyKXtjYXNlIHQ6cmV0dXJuIGZ1bmN0aW9uKHQpe2NvbnN0IGU9bmV3IERhdGFWaWV3KHQuZGF0YSk7bGV0IGE9MDtmb3IoO2ErNDx0LmRhdGEuYnl0ZUxlbmd0aDspe2lmKDA9PT1lLmdldFVpbnQ4KGErMCkmJjA9PT1lLmdldFVpbnQ4KGErMSkmJjA9PT1lLmdldFVpbnQ4KGErMikmJjE9PT1lLmdldFVpbnQ4KGErMykmJjY9PT1lLmdldFVpbnQ4KGErNCkpe2xldCByPWErNixvPTAsaT0wO2Zvcig7MjU1PT09KGk9ZS5nZXRVaW50OChyKyspKTspbys9MjU1O28rPWk7Y29uc3Qgcz1uKHQuZGF0YSxyLG8pO3JldHVybiBuZXcgVWludDhBcnJheShzKX1hKyt9cmV0dXJuIG51bGx9KGEpO2Nhc2UgZTpyZXR1cm4gZnVuY3Rpb24odCl7Y29uc3QgZT1uZXcgRGF0YVZpZXcodC5kYXRhKTtsZXQgYT0wO2Zvcig7YSs1PHQuZGF0YS5ieXRlTGVuZ3RoOyl7aWYoMD09PWUuZ2V0VWludDgoYSswKSYmMD09PWUuZ2V0VWludDgoYSsxKSYmMD09PWUuZ2V0VWludDgoYSsyKSYmMT09PWUuZ2V0VWludDgoYSszKSYmNzg9PT1lLmdldFVpbnQ4KGErNCkmJjE9PT1lLmdldFVpbnQ4KGErNSkmJjEwMT09PWUuZ2V0VWludDgoYSs2KSl7bGV0IHI9YSs3LG89MCxpPTA7Zm9yKDsyNTU9PT0oaT1lLmdldFVpbnQ4KHIrKykpOylvKz0yNTU7bys9aTtjb25zdCBzPW4odC5kYXRhLHIsbyk7cmV0dXJuIG5ldyBVaW50OEFycmF5KHMpfWErK31yZXR1cm4gbnVsbH0oYSk7ZGVmYXVsdDpyZXR1cm4gbnVsbH19ZnVuY3Rpb24gcih0KXtjb25zdCBlPXQubGVuZ3RoO2xldCBuPVtdLGE9MDtmb3IoO2E8ZTspYSsyPGUmJjA9PT10W2FdJiYwPT09dFthKzFdJiYoMD09PXRbYSsyXXx8MT09PXRbYSsyXXx8Mj09PXRbYSsyXXx8Mz09PXRbYSsyXSk/KG4ucHVzaCh0W2FdLHRbYSsxXSwzLHRbYSsyXSksYSs9Myk6KG4ucHVzaCh0W2FdKSxhKyspO3JldHVybiBuZXcgVWludDhBcnJheShuKX1mdW5jdGlvbiBvKG4sYSxvKXtzd2l0Y2gobyl7Y2FzZSB0OnJldHVybiBmdW5jdGlvbih0LGUpe2NvbnN0IG49cihlKSxhPW4ubGVuZ3RoLG89TWF0aC5mbG9vcihhLzI1NSksaT1hJTI1NSxzPW5ldyBVaW50OEFycmF5KDYrbysxK2ErdC5ieXRlTGVuZ3RoKTtzWzBdPTAsc1sxXT0wLHNbMl09MCxzWzNdPTEsc1s0XT02LHNbNV09MTAxO2xldCBmPTA7Zm9yKDtmPG87KXNbNitmXT0yNTUsZisrO3JldHVybiBzWzYrZl09aSxmKysscy5zZXQobiw2K2YpLHMuc2V0KG5ldyBVaW50OEFycmF5KHQpLDYrZithKSxzLmJ1ZmZlcn0obixhKTtjYXNlIGU6cmV0dXJuIGZ1bmN0aW9uKHQsZSl7Y29uc3Qgbj1yKGUpLGE9bi5sZW5ndGgsbz1NYXRoLmZsb29yKGEvMjU1KSxpPWElMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNytvKzErYSsxK3QuYnl0ZUxlbmd0aCk7c1swXT0wLHNbMV09MCxzWzJdPTAsc1szXT0xLHNbNF09Nzgsc1s1XT0xLHNbNl09MTAxO2xldCBmPTA7Zm9yKDtmPG87KXNbNytmXT0yNTUsZisrO3JldHVybiBzWzcrZl09aSxmKysscy5zZXQobiw3K2YpLGYrPWEsc1s3K2ZdPTEyOCxmKysscy5zZXQobmV3IFVpbnQ4QXJyYXkodCksNytmKSxzLmJ1ZmZlcn0obixhKTtkZWZhdWx0OnJldHVybiBudWxsfX1mdW5jdGlvbiBpKG4pe2lmKG4ubGVuZ3RoPDUpcmV0dXJuIiI7bGV0IGE9LTE7Zm9yKGxldCB0PTA7dDxuLmxlbmd0aC0zO3QrKyl7aWYoMD09PW5bdF0mJjA9PT1uW3QrMV0mJjE9PT1uW3QrMl0pe2E9dDticmVha31pZih0PG4ubGVuZ3RoLTQmJjA9PT1uW3RdJiYwPT09blt0KzFdJiYwPT09blt0KzJdJiYxPT09blt0KzNdKXthPXQ7YnJlYWt9fWlmKC0xPT09YSlyZXR1cm4iIjtjb25zdCByPWErKDA9PT1uW2ErMl0/NDozKTtpZihyPj1uLmxlbmd0aClyZXR1cm4iIjtjb25zdCBvPW5bcl07aWYoMTI4Jm8pcmV0dXJuIiI7aWYoKG8+PjEmNjMpPj0zMilyZXR1cm4gZTtpZihyKzE8bi5sZW5ndGgpe2lmKDA9PSgyNDgmbltyKzFdKSlyZXR1cm4gZX1yZXR1cm4oMzEmbyk8PTMxP3Q6IiJ9Y29uc3Qgcz03MSxmPTEsbD0yLHU9MSxnPTI7dmFyIGM7ZnVuY3Rpb24gZCh0LGU9ITEpe2NvbnN0IG49dC5nZXRVaW50OCgwKTtpZihuIT09cylyZXR1cm47Y29uc3QgYT10LmdldFVpbnQxNigxKSxyPWYrbCthLG89bmV3IFVpbnQ4QXJyYXkodC5ieXRlTGVuZ3RoLXIpO28uc2V0KG5ldyBVaW50OEFycmF5KHQuYnVmZmVyLHIsdC5ieXRlTGVuZ3RoLXIpKTtjb25zdCBpPXttOm4sdGx2TGVuOmEsdGx2OltdLGZyYW1lOm99O2xldCBkPWYrbDtmb3IoO2Q8cjspe2NvbnN0IG49dC5nZXRVaW50OChkKSxhPXQuZ2V0VWludDE2KGQrdSkscj11K2c7aWYobj09PWMuQVVESU9fTEVWRUwpe2xldCBvPXQuZ2V0VWludDgoZCtyKTtmb3IobGV0IGU9MTtlPGE7ZSsrKW89bzw8OHx0LmdldFVpbnQ4KGQrcitlKTtpLnRsdi5wdXNoKHt0YWc6bixsZW5ndGg6YSx2YWx1ZTplPzEyN15vPj4xOjEyNyZvfSl9ZWxzZSBpZihuPT09Yy5NRVRBREFUQXx8bj09PWMuQVVESU9fNjRfQklUX1BUUyl7Y29uc3QgZT1uZXcgVWludDhBcnJheShhKTtmb3IobGV0IG49MDtuPGE7bisrKWVbbl09dC5nZXRVaW50OChkK3Irbik7aS50bHYucHVzaCh7dGFnOm4sbGVuZ3RoOmEsdmFsdWU6ZX0pfWQrPXIrYX1yZXR1cm4gaX0hZnVuY3Rpb24odCl7dFt0LkFVRElPX0xFVkVMPTFdPSJBVURJT19MRVZFTCIsdFt0Lk1FVEFEQVRBPTJdPSJNRVRBREFUQSIsdFt0LkFVRElPXzY0X0JJVF9QVFM9M109IkFVRElPXzY0X0JJVF9QVFMifShjfHwoYz17fSkpLHNlbGYub25ydGN0cmFuc2Zvcm09dD0+e2NvbnN0IGU9dC50cmFuc2Zvcm1lcixuPVtdLHI9W107bGV0IGg9bnVsbDtlLm9wdGlvbnMucG9ydC5vbm1lc3NhZ2U9dD0+e3QuZGF0YS5zZWkmJm4ucHVzaCh0LmRhdGEuc2VpKSx0LmRhdGEubWV0YWRhdGEmJnIucHVzaCh0LmRhdGEubWV0YWRhdGEpfSxzZWxmLnBvc3RNZXNzYWdlKCJzdGFydGVkIik7Y29uc3QgcD1lLnJlYWRhYmxlLmdldFJlYWRlcigpLFU9ZS53cml0YWJsZS5nZXRXcml0ZXIoKTsic2VpLXJ4Ij09PWUub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQoZSl7cC5yZWFkKCkudGhlbigobj0+e2lmKCFuLmRvbmUpe2lmKG4udmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgdD1pKG5ldyBVaW50OEFycmF5KG4udmFsdWUuZGF0YSkpLHI9YShuLnZhbHVlLHQpO2lmKHImJmUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHtzZWk6cn0pLCFoKXtjb25zdCB0PW4udmFsdWUuZ2V0TWV0YWRhdGEoKXx8e307aD17dHlwZTpuLnZhbHVlLnR5cGUscnRwVGltZXN0YW1wOm4udmFsdWUudGltZXN0YW1wLHBheWxvYWRUeXBlOnQucGF5bG9hZFR5cGV8fDAsc3NyYzp0LnN5bmNocm9uaXphdGlvblNvdXJjZXx8MCxsZW5ndGg6bi52YWx1ZS5kYXRhLmJ5dGVMZW5ndGgsLi4uIm1pbWVUeXBlImluIHQ/e21pbWVUeXBlOnQubWltZVR5cGV9Ont9fSxlLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7Zmlyc3RGcmFtZUluZm86aH0pfX1VLndyaXRlKG4udmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfShlKToic2VpLXR4Ij09PWUub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQoZSl7cC5yZWFkKCkudGhlbigoYT0+e2lmKCFhLmRvbmUpe2lmKGEudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgdD1pKG5ldyBVaW50OEFycmF5KGEudmFsdWUuZGF0YSkpLGU9bi5zaGlmdCgpO2lmKGUpe2NvbnN0IG49byhhLnZhbHVlLmRhdGEsZSx0KTtuJiYoYS52YWx1ZS5kYXRhPW4pfX1VLndyaXRlKGEudmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfShlKToiYXVkaW8tbWV0YWRhdGEtcngiPT09ZS5vcHRpb25zLm5hbWU/ZnVuY3Rpb24gdChlKXtwLnJlYWQoKS50aGVuKChuPT57aWYoIW4uZG9uZSl7aWYobi52YWx1ZSBpbnN0YW5jZW9mIFJUQ0VuY29kZWRBdWRpb0ZyYW1lKXtjb25zdCB0PW5ldyBEYXRhVmlldyhuLnZhbHVlLmRhdGEpLGE9dC5nZXRVaW50OCgwKTtsZXQgcjtpZigwIT0oMTI4JmEpJiY3MSE9PWEpe2NvbnN0IGU9ZnVuY3Rpb24odCl7aWYodC5ieXRlTGVuZ3RoPD0wKXJldHVybltdO2NvbnN0IGU9W107bGV0IG49MDtmb3IoO248dC5ieXRlTGVuZ3RoOyl7Y29uc3QgYT0oMTI4JnQuZ2V0VWludDgobikpPj43LHI9MTI3JnQuZ2V0VWludDgobik7aWYoIShhJiZuKzQ8PXQuYnl0ZUxlbmd0aCkpe24rKzticmVha317Y29uc3QgYT10LmdldFVpbnQzMihuLCExKSxvPSgxNjc3NjE5MiZhKT4+MTAsaT0xMDIzJmE7ZS5wdXNoKHtwdDpyLHRzX29mZnNldDpvLGxlbmd0aDppLGRhdGE6bmV3IFVpbnQ4QXJyYXl9KSxuKz00fX1sZXQgYT10LmJ5dGVMZW5ndGgtbjtmb3IoY29uc3QgciBvZiBlKXtpZihyLmxlbmd0aD5hKXJldHVybiBjb25zb2xlLndhcm4oIkJyb2tlbiByZWQgcGF5bG9hZCIpLFtdO3IubGVuZ3RoPjAmJihyLmRhdGE9bmV3IFVpbnQ4QXJyYXkodC5idWZmZXIsdC5ieXRlT2Zmc2V0K24sci5sZW5ndGgpLG4rPXIubGVuZ3RoLGEtPXIubGVuZ3RoKX1pZihhPjApe2NvbnN0IHI9e3B0OmUubGVuZ3RoPjA/ZVtlLmxlbmd0aC0xXS5wdDowLHRzX29mZnNldDowLGxlbmd0aDphLGRhdGE6bmV3IFVpbnQ4QXJyYXkodC5idWZmZXIsdC5ieXRlT2Zmc2V0K24sYSl9O2UucHVzaChyKX1yZXR1cm4gZX0odCk7aWYoZS5sZW5ndGg+MCl7Y29uc3QgdD1mdW5jdGlvbih0KXtsZXQgZT0wO2ZvcihsZXQgbj0wO248dC5sZW5ndGg7bisrKWUrPW48dC5sZW5ndGgtMT80OjEsZSs9dFtuXS5sZW5ndGg7Y29uc3Qgbj1uZXcgVWludDhBcnJheShlKTtsZXQgYT0wO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKWlmKGU8dC5sZW5ndGgtMSl7Y29uc3Qgcj0oMjE0NzQ4MzY0OHwoMTI3JnRbZV0ucHQpPDwyNHwoMjYyMTQzJnRbZV0udHNfb2Zmc2V0KTw8MTB8MTAyMyZ0W2VdLmxlbmd0aCk+Pj4wO25bYSsrXT1yPj4yNCYyNTUsblthKytdPXI+PjE2JjI1NSxuW2ErK109cj4+OCYyNTUsblthKytdPTI1NSZyfWVsc2UgblthKytdPTEyNyZ0W2VdLnB0O2Zvcihjb25zdCBlIG9mIHQpbi5zZXQoZS5kYXRhLGEpLGErPWUubGVuZ3RoO3JldHVybiBufShlLm1hcCgodD0+e2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkodC5sZW5ndGgpO2Uuc2V0KHQuZGF0YSk7Y29uc3Qgbj1kKG5ldyBEYXRhVmlldyhlLmJ1ZmZlcikpO3JldHVybiBuPy5mcmFtZSYmKHQuZGF0YT1uPy5mcmFtZSkscj1uLHR9KSkpO24udmFsdWUuZGF0YT10LmJ1ZmZlcn19ZWxzZSByPWQodCksciYmKG4udmFsdWUuZGF0YT1yLmZyYW1lLmJ1ZmZlcik7aWYocil7bGV0IHQ9ci50bHYuZmluZCgodD0+dC50YWc9PT1jLk1FVEFEQVRBKSk7aWYodCYmdC52YWx1ZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkmJmUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHttZXRhZGF0YTp0LnZhbHVlfSksdD1yLnRsdi5maW5kKCh0PT50LnRhZz09PWMuQVVESU9fNjRfQklUX1BUUykpLHQmJnQudmFsdWUgaW5zdGFuY2VvZiBVaW50OEFycmF5JiY4PT10LnZhbHVlLmxlbmd0aCl7Y29uc3Qgbj1uZXcgRGF0YVZpZXcodC52YWx1ZS5idWZmZXIpLmdldEJpZ1VpbnQ2NCgwLCEwKTt0JiZ0LnZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3B0czpufSl9fX1VLndyaXRlKG4udmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfShlKToiYXVkaW8tbWV0YWRhdGEtdHgiPT09ZS5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIHQoZSl7cC5yZWFkKCkudGhlbigobj0+e2lmKCFuLmRvbmUpe2lmKGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHtnZXRNZXRhZGF0YTohMH0pLG4udmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkQXVkaW9GcmFtZSl7Y29uc3QgdD1yLnNoaWZ0KCk7dCYmKG4udmFsdWUuZGF0YT1mdW5jdGlvbih0LGUsbil7Y29uc3QgYT1uLmJ5dGVMZW5ndGgscj1hK3UrZyxvPWYrbCtyLGk9bmV3IEFycmF5QnVmZmVyKHQuYnl0ZUxlbmd0aCtvKSxjPW5ldyBEYXRhVmlldyhpKTtjLnNldFVpbnQ4KDAscyksYy5zZXRVaW50MTYoMSxyKSxjLnNldFVpbnQ4KDMsZSksYy5zZXRVaW50MTYoNCxhKTtmb3IobGV0IHQ9MDt0PGE7dCsrKWMuc2V0VWludDgoNit0LG5bdF0pO2NvbnN0IGQ9bmV3IFVpbnQ4QXJyYXkoYy5idWZmZXIpO3JldHVybiBkLnNldChuZXcgVWludDhBcnJheSh0KSxvKSxkLmJ1ZmZlcn0obi52YWx1ZS5kYXRhLGMuQVVESU9fNjRfQklUX1BUUyx0KSl9VS53cml0ZShuLnZhbHVlKSxlLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSx0KGUpfX0pKX0oZSl9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKTsK")],{type:"text/javascript"});return setTimeout(()=>dx.revokeObjectURL(t),0),new Worker(dx.createObjectURL(t))}const l8=71,n1=1,r1=2,i1=1,d8=2;var vd=function(t){return t[t.AUDIO_LEVEL=1]="AUDIO_LEVEL",t[t.METADATA=2]="METADATA",t[t.AUDIO_64_BIT_PTS=3]="AUDIO_64_BIT_PTS",t}(vd||{});function s1(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=t.getUint8(0);if(i!==l8)return;const a=t.getUint16(1),l=n1+r1+a,u=new Uint8Array(t.byteLength-l);u.set(new Uint8Array(t.buffer,l,t.byteLength-l));const p={m:i,tlvLen:a,tlv:[],frame:u};let m=n1+r1;for(;m<l;){const g=t.getUint8(m),y=t.getUint16(m+i1),x=i1+d8;if(g===vd.AUDIO_LEVEL){let S=t.getUint8(m+x);for(let T=1;T<y;T++)S=S<<8|t.getUint8(m+x+T);p.tlv.push({tag:g,length:y,value:r?127^S>>1:127&S})}else if(g===vd.METADATA||g===vd.AUDIO_64_BIT_PTS){const S=new Uint8Array(y);for(let T=0;T<y;T++)S[T]=t.getUint8(m+x+T);p.tlv.push({tag:g,length:y,value:S})}m+=x+y}return p}const h_=new Map,p_=127,Zu=1e-10,a1=139/13,m_=new Map;function o1(t,r,i){const a="".concat(t,"-").concat(r,"-").concat(i);let l=0;return m_.has(a)?l=m_.get(a):(l=Math.log(function(p,m){const g=p-m;m<g&&(m=g);let y=1;for(let x=p,S=1;x>m;x--,S++)y=y*x/S;return y}(r,t))+t*Math.log(.5)+(r-t)*Math.log(1-.5)-Math.log(i)+i*t,m_.set(a,l)),l<Zu&&(l=Zu),l}function u8(t,r,i){const a=r.length,l=t.length/a;let u=!1;for(let p=0,m=0;p<a;p++){let g=0;for(let y=m+l;m<y;m++)t[m]>i&&g++;r[p]!==g&&(r[p]=g,u=!0)}return u}window.cache=m_;let k0e=0;class h8{constructor(r){me(this,"id",void 0),me(this,"immediates",[]),me(this,"lastNonSilence",-1),me(this,"immediateSpeechActivityScore",Zu),me(this,"lastLevelChangedTime",Date.now()),me(this,"levels",[]),me(this,"longs",[]),me(this,"longSpeechActivityScore",Zu),me(this,"mediums",[]),me(this,"mediumSpeechActivityScore",Zu),me(this,"minLevel",0),me(this,"nextMinLevel",0),me(this,"nextMinLevelWindowLength",0),me(this,"energyScore",0),this.id=r||"".concat(k0e++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){const r=this.immediates,i=this.levels,a=this.minLevel+a1;let l=!1;for(let u=0;u<r.length;++u){let p=i[u];p<a&&(p=0);const m=Math.floor(p/a1);r[u]!==m&&(r[u]=m,l=!0)}return l}computeLongs(){return u8(this.mediums,this.longs,4)}computeMediums(){return u8(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=o1(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(r){this.longSpeechActivityScore=o1(this.longs[0],10,47),this.longSpeechActivityScore>Zu&&(this.lastNonSilence=r)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=o1(this.mediums[0],5,24)}evaluateSpeechActivityScores(r){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(r)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var r;return"[".concat(kL(r=[...this.levels]).call(r).join(),"]")}getSpeechActivityScore(r){switch(r){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+r)}}levelChanged(r,i){if(this.lastLevelChangedTime<=i){this.lastLevelChangedTime=i;let a=r;return r<0&&(a=0),r>p_&&(a=p_),this.levels.unshift(a),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(a),a>=this.minLevel+a1?a:a/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(r){if(r!==0){if(this.minLevel===0||this.minLevel>r)return this.minLevel=r,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(this.nextMinLevel===0)return this.nextMinLevel=r,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>r&&(this.nextMinLevel=r),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let i=Math.sqrt(this.minLevel*this.nextMinLevel);i<0?i=0:i>p_&&(i=p_),this.minLevel=i,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class j0e{constructor(r){me(this,"algorithm",void 0),this.algorithm=r}execute(){let r=!this.algorithm;if(!r)try{const i=this.algorithm.runInDecisionMaker(this);i<=0?r=!0:setTimeout(this.execute.bind(this),i)}catch{r=!0}r&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class c1{constructor(r,i,a){me(this,"isDominant",void 0),me(this,"energyRanking",void 0),me(this,"energyScore",void 0),this.isDominant=r,this.energyRanking=i,this.energyScore=a}}class D0e extends Pn{constructor(r){super(),me(this,"dominantId",null),me(this,"lastDecisionTime",0),me(this,"lastLevelChangedTime",0),me(this,"lastLevelIdleTime",0),me(this,"relativeSpeechActivities",[]),me(this,"speakers",new Map),me(this,"enableSilence",!1),me(this,"timeoutToSilenceInterval",0),me(this,"decisionMaker",null),me(this,"loudest",[]),me(this,"numLoudestToTrack",3),me(this,"energyExpireTimeMs",250),me(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=r,this.enableSilence=r>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=r,i!=null&&(this.energyExpireTimeMs=i),a!=null&&(this.energyAlphaPct=a),this.loudest.length>r&&this.loudest.splice(r)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(r){return this.loudest.some(i=>i.id===r)}levelChanged(r,i){const a=Date.now(),l=this.getOrCreateSpeaker(r);this.lastLevelChangedTime<a&&(this.lastLevelChangedTime=a,this.maybeStartDecisionMaker());const u=l.levelChanged(i,a);return this.updateLoudestList(l,u,a)}runInDecisionMaker(r){return this.decisionMaker!==r||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(r){this.decisionMaker===r&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(r){r.forEach(i=>{this.speakers.has(i.id)||this.speakers.set(i.id,i)})}removeSpeakers(r){r.forEach(i=>{this.speakers.delete(i.id)})}getOrCreateSpeaker(r){let i=this.speakers.get(r);return i||(i=new h8(r),this.speakers.set(r,i),this.maybeStartDecisionMaker()),i}updateLoudestList(r,i,a){const l=r.id===this.dominantId;if(i<0){let g=0;for(;g<this.loudest.length&&this.loudest[g]!==r;)++g;return new c1(l,g,r.energyScore)}if(r.energyScore=Math.floor((this.energyAlphaPct*i+(100-this.energyAlphaPct)*r.energyScore+50)/100),this.numLoudestToTrack===0)return new c1(l,0,r.energyScore);const u=a-this.energyExpireTimeMs;let p=0;for(;p<this.loudest.length;){const g=this.loudest[p];if(g.getLastLevelChangedTime()<u&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(p,1);else if(g.id!==r.id)++p;else if(this.loudest.splice(p,1),this.loudest.length<this.numLoudestToTrack)break}let m=0;for(;m<this.loudest.length&&!(this.loudest[m].energyScore<r.energyScore);)++m;return m<this.numLoudestToTrack&&(this.loudest.splice(m,0,r),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new c1(l,m,r.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new j0e(this),this.decisionMaker.execute())}makeDecision(r){let i=null,a=null;const l=this.speakers.size;let u=null;if(l===0)u=null;else if(l===1){var p;const m=Ns(p=this.speakers).call(p).next().value;this.enableSilence&&m&&(u=m.id,m.evaluateSpeechActivityScores(r),r-m.lastNonSilence>this.timeoutToSilenceInterval&&(u=null))}else{let m=this.dominantId==null?null:this.speakers.get(this.dominantId);if(m==null){const x=this.speakers.entries().next();x.value&&(u=x.value[0],m=x.value[1])}else u=m.id;m!=null&&m.evaluateSpeechActivityScores(r);const g=this.relativeSpeechActivities;let y=2;for(const x of this.speakers.entries()){const[S,T]=x;if(T===m)continue;T.evaluateSpeechActivityScores(r);for(let L=0;L<g.length;++L){const H=m==null?Zu:m.getSpeechActivityScore(L);g[L]=Math.log(T.getSpeechActivityScore(L)/H)}const C=g[0],V=g[1],j=g[2];C>3&&V>2&&j>0&&V>y&&(y=V,u=S)}this.enableSilence&&m!=null&&u===m.id&&r-m.lastNonSilence>this.timeoutToSilenceInterval&&(u=null)}u==null&&!this.enableSilence||u===this.dominantId||(i=this.dominantId,this.dominantId=u,a=this.dominantId),a==null&&!this.enableSilence||a===i||this.emit("ActiveSpeakerChanged",a)}_runInDecisionMaker(){const r=Date.now(),i=300-(r-this.lastLevelIdleTime);let a=0;i<=0?(this.lastLevelIdleTime!==0&&this.timeoutIdleLevels(r),this.lastLevelIdleTime=r):a=i;let l=300-(r-this.lastDecisionTime);return l<=0&&(this.lastDecisionTime=r,this.makeDecision(r),l=300-(Date.now()-r)),l>0&&a>l&&(a=l),a}timeoutIdleLevels(r){const i=[];for(const l of Ns(a=this.speakers).call(a)){var a;const u=r-l.getLastLevelChangedTime();36e5<u&&(this.dominantId==null||l.id!==this.dominantId)?i.push(l.id):300<u&&l.levelTimedOut()}i.forEach(l=>this.speakers.delete(l))}}const mm=new Map;let Fo=null,f_=null;const p8=3;let eh=[];const Vo=new Map,g_=new Map;class L0e{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(r,i){me(this,"id",void 0),me(this,"track",void 0),me(this,"score",0),me(this,"active",!0),me(this,"muted",!1),me(this,"timer",0),me(this,"actives",0),me(this,"inactives",0),this.id=r,this.track=i,this.setActive(Vo.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){const r=this.active;this.active=this.activeRate>=.8;const{actives:i,inactives:a}=function(){const l=[],u=[];return Array.from(Ns(Vo).call(Vo)).forEach(p=>{p.active?l.push(p):u.push(p)}),{actives:l,inactives:u}}();if(i.length>3){let l;i.forEach(u=>{(!l||l.score>u.score)&&(l=u)}),l&&l.setActive(!1)}if(i.length<3&&a.length>0){let l;a.forEach(u=>{(!l||l.score<u.score)&&u.id!==this.id&&(l=u)}),l&&r&&!this.active&&(l.samples>40&&l.activeRate-this.activeRate>.4?l.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(r){this.active=r,this.resetTimer(),this.setMuted(!r)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){const r=function(i){let a;return Array.from(Ns(Vo).call(Vo)).forEach(l=>{!l.active||l.id===i||l.samples<40||(!a||l.score<a.score)&&(a=l)}),a}(this.id);r&&this.activeRate-r.activeRate>.4&&(r.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){const r=function(i){let a;return Array.from(Ns(Vo).call(Vo)).forEach(l=>{l.active||l.id===i||l.samples<40||(!a||l.score>a.score)&&(a=l)}),a}(this.id);r&&r.activeRate-this.activeRate>.4&&(r.setActive(!0),this.setActive(!1))}addSample(r){r?this.actives+=1:this.inactives+=1,this.samples>66.66666666666667&&this.autoCheckActive()}setMuted(r){this.track&&(this.track.enabled=!r,this.muted=r)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout(()=>{if(this.samples!==0)return this.samples<50?this.resetTimer():void this.autoCheckActive()},1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let v_;function m8(t){const r=Vo.get(t);r&&(Vo.delete(t),r.clearTimer())}const y_=new Map,M0e=new Map,l1="video/h264",d1="video/h265";function f8(t,r,i){let a=new Uint8Array(t,r,i),l=[],u=0;for(;l.length<i;)u+3<i&&a[u]===0&&a[u+1]===0&&a[u+2]===3&&(a[u+3]===0||a[u+3]===1||a[u+3]===2||a[u+3]===3)?(l.push(a[u],a[u+1],a[u+3]),u+=4):(l.push(a[u]),u++);return new Uint8Array(l)}function g8(t){const r=t.length;let i=[],a=0;for(;a<r;)a+2<r&&t[a]===0&&t[a+1]===0&&(t[a+2]===0||t[a+2]===1||t[a+2]===2||t[a+2]===3)?(i.push(t[a],t[a+1],3,t[a+2]),a+=3):(i.push(t[a]),a++);return new Uint8Array(i)}function v8(t){if(t.length<5)return"";let r=-1;for(let l=0;l<t.length-3;l++){if(t[l]===0&&t[l+1]===0&&t[l+2]===1){r=l;break}if(l<t.length-4&&t[l]===0&&t[l+1]===0&&t[l+2]===0&&t[l+3]===1){r=l;break}}if(r===-1)return"";const i=r+(t[r+2]===0?4:3);if(i>=t.length)return"";const a=t[i];return 128&a?"":(a>>1&63)>=32||i+1<t.length&&!(248&t[i+1])?d1:(31&a)<=31?l1:""}const b_=new Map,N0=new Map;(function(){const t=Ht();wr.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),wr.getStreamFromExtension=t.name===Yt.CHROME&&Number(t.version)>34,wr.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const r=new RTCPeerConnection;let i=!1;try{r.addTransceiver("audio"),i=!0}catch{}return r.close(),i}(),wr.supportMinBitrate=t.name===Yt.CHROME||t.name===Yt.EDGE,wr.supportSetRtpSenderParameters=function(){const r=Ht();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!Sc()||!(!Pr()&&!Hx())||r.name===Yt.FIREFOX&&Number(r.version)>=64)}(),t.name===Yt.SAFARI&&(Number(t.version)>=14?wr.supportDualStream=!0:wr.supportDualStream=!1),wr.webAudioMediaStreamDest=function(){const r=Ht();return!(r.name===Yt.SAFARI&&Number(r.version)<12)}(),wr.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",wr.supportWebGL=typeof WebGLRenderingContext<"u",wr.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Sc()||(wr.webAudioWithAEC=!0),wr.supportShareAudio=function(){const r=Ht();return(r.os===_r.WIN_10||r.os===_r.WIN_81||r.os===_r.WIN_7||r.os===_r.LINUX||r.os===_r.MAC_OS||r.os===_r.CHROMIUM_OS)&&r.name===Yt.CHROME&&Number(r.version)>=74}(),wr.supportDataChannel=!!(Mo(76)||mA(68)||cV(14)),wr.supportPCSetConfiguration=function(){const r=window.RTCPeerConnection;return!wn()&&!!r&&r.prototype.setConfiguration instanceof Function}(),wr.supportWebRTCEncodedTransform=Mo(87)||sV()||mA(117),wr.supportWebRTCInsertableStream=function(){const r=Ht();return(r.name===Yt.CHROME||r.name===Yt.EDGE)&&Number(r.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),wr.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,wr.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,wr.supportSuppressLocalAudioPlayback=t6(),wr.supportRestrictOwnAudio=n6(),Yx(()=>{wr.supportDualStreamEncoding=function(){const r=Ht();return!!W("DISABLE_WEBAUDIO")||r.name==="Safari"&&Number(r.version)>=14||!!(r.name==="Chrome"&&/Windows/i.test(r.os||"")&&Number(r.version)>=100&&W("CHROME_DUAL_STREAM_USE_ENCODING"))}(),A.debug("browser ua: ",navigator.userAgent),A.info("browser info: ",t),A.info("browser compatibility: ",wr)})})();const U0e=["CHINA","GLOBAL"],y8=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],th=[],fm=[];function nh(t,r){return!!r&&th.some(i=>i.uid===t&&i.channelName===r)}function u1(){return fm.length>0}var F0e=T3.forEach,b8=Eb("forEach")?[].forEach:function(t){return F0e(this,t,arguments.length>1?arguments[1]:void 0)};en({target:"Array",proto:!0,forced:[].forEach!==b8},{forEach:b8});var V0e=ha("Array","forEach"),B0e=sd,G0e=ui,W0e=N,$0e=V0e,h1=Array.prototype,z0e={DOMTokenList:!0,NodeList:!0},H0e=function(t){var r=t.forEach;return t===h1||W0e(h1,t)&&r===h1.forEach||G0e(z0e,B0e(t))?$0e:r},K0e=d(H0e),Y0e=yc,x8=Rb;en({target:"Object",stat:!0,forced:h(function(){x8(1)})},{keys:function(t){return x8(Y0e(t))}});var q0e=d(yt.Object.keys),X0e=d(IL),J0e=d(PL),Q0e=en,_8=Ug,Z0e=Gb,eve=Je,E8=TN,tve=id,nve=Ke,rve=$C,ive=ar,sve=od,ave=f3("slice"),ove=ive("species"),p1=Array,cve=Math.max;Q0e({target:"Array",proto:!0,forced:!ave},{slice:function(t,r){var i,a,l,u=nve(this),p=tve(u),m=E8(t,p),g=E8(r===void 0?p:r,p);if(_8(u)&&(i=u.constructor,(Z0e(i)&&(i===p1||_8(i.prototype))||eve(i)&&(i=i[ove])===null)&&(i=void 0),i===p1||i===void 0))return sve(u,m,g);for(a=new(i===void 0?p1:i)(cve(g-m,0)),l=0;m<g;m++,l++)m in u&&rve(a,l,u[m]);return a.length=l,a}});var lve=ha("Array","slice"),dve=N,uve=lve,m1=Array.prototype,hve=function(t){var r=t.slice;return t===m1||dve(m1,t)&&r===m1.slice?uve:r},pve=d(hve);function Le(t,r,i,a,l){var u,p,m,g={};return K0e(u=q0e(a)).call(u,function(y){g[y]=a[y]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=X0e(p=J0e(m=pve(i).call(i)).call(m)).call(p,function(y,x){return x(t,r,y)||y},g),l&&g.initializer!==void 0&&(g.value=g.initializer?g.initializer.call(l):void 0,g.initializer=void 0),g.initializer===void 0?(u3(t,r,g),null):g}let x_=function(t){return t[t.ACCESS_POINT=101]="ACCESS_POINT",t[t.UNILBS=201]="UNILBS",t[t.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",t}({}),f1=function(t){return t[t.IIIEGAL_APPID=1]="IIIEGAL_APPID",t[t.IIIEGAL_UID=2]="IIIEGAL_UID",t[t.INTERNAL_ERROR=3]="INTERNAL_ERROR",t}({}),ba=function(t){return t[t.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",t[t.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",t[t.INTERNAL_ERROR=8]="INTERNAL_ERROR",t[t.NO_AUTHORIZED=9]="NO_AUTHORIZED",t[t.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",t[t.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",t[t.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",t[t.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",t[t.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",t[t.USER_OVERLOAD=16]="USER_OVERLOAD",t[t.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",t[t.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",t[t.REQ_DOWNGRADE_FALLBACK=27]="REQ_DOWNGRADE_FALLBACK",t}({}),Di=function(t){return t[t.NO_FLAG_SET=100]="NO_FLAG_SET",t[t.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",t[t.INVALID_FALG_SET=102]="INVALID_FALG_SET",t[t.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",t[t.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",t[t.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",t[t.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",t[t.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",t[t.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",t[t.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",t[t.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",t[t.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",t[t.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",t[t.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",t[t.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",t[t.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",t[t.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",t[t.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",t[t.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",t}({}),at=function(t){return t[t.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",t[t.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",t[t.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",t[t.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",t[t.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",t[t.K_TICKET_INVALID=7]="K_TICKET_INVALID",t[t.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",t[t.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",t[t.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",t[t.K_UID_BANNED=14]="K_UID_BANNED",t[t.K_IP_BANNED=15]="K_IP_BANNED",t[t.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",t[t.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",t[t.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",t[t.K_VOS_FALLBACK=30]="K_VOS_FALLBACK",t[t.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",t[t.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",t[t.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",t[t.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",t[t.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",t[t.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",t[t.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",t[t.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",t[t.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",t[t.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",t[t.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",t[t.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",t[t.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",t[t.ERR_INVALID_UID=117]="ERR_INVALID_UID",t[t.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",t[t.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",t[t.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",t[t.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",t[t.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",t[t.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",t[t.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",t[t.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",t[t.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",t[t.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",t[t.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",t[t.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",t[t.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",t[t.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",t[t.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",t[t.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",t[t.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",t[t.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",t[t.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",t[t.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",t[t.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",t[t.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",t[t.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",t[t.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",t[t.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",t[t.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",t[t.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",t[t.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",t[t.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",t[t.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",t[t.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",t[t.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",t[t.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",t[t.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",t[t.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",t[t.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",t[t.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",t}({}),Ft=function(t){return t.CONNECTING="connecting",t.CONNECTED="connected",t.RECONNECTING="reconnecting",t.CLOSED="closed",t}({}),Xe=function(t){return t.WS_CONNECTED="ws_connected",t.WS_RECONNECTING="ws_reconnecting",t.WS_CLOSED="ws_closed",t.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",t.ON_BINARY_DATA="on_binary_data",t.REQUEST_RECOVER="request_recover",t.REQUEST_JOIN_INFO="request_join_info",t.REQUEST_REJOIN_INFO="req_rejoin_info",t.IS_P2P_DISCONNECTED="is_p2p_dis",t.DISCONNECT_P2P="dis_p2p",t.ABORT_P2P_EXECUTION="abort_p2p_execution",t.NEED_RENEW_SESSION="need-sid",t.REPORT_JOIN_GATEWAY="report_join_gateway",t.REQUEST_TIMEOUT="request_timeout",t.REQUEST_SUCCESS="request_success",t.JOIN_RESPONSE="join_response",t.PRE_CONNECT_PC="pre_connect_pc",t.DATACHANNEL_PRECONNECT="datachannel_preconnect",t.DATACHANNEL_CONNECTING="datachannel_connecting",t.DATACHANNEL_FAILBACK="datachannel_failback",t.P2P_CONNECTION="p2p_connection",t.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",t.P2P_SUBSCRIBE="p2p_subscribe",t.P2P_UNSUBSCRIBE="p2p_unsubscribe",t.P2P_EXCHANGE_SDP="p2p_exchange_sdp",t.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",t.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",t.RECOVER_NOTIFICATION="recover_notification",t.VOS_FALLBACK="vos_fallback",t.VOS_FALLBACK_PROMISE="vos_fallback_promise",t}({}),nt=function(t){return t.PING="ping",t.PING_BACK="ping_back",t.JOIN="join_v3",t.REJOIN="rejoin_v3",t.LEAVE="leave",t.SET_CLIENT_ROLE="set_client_role",t.PUBLISH="publish",t.PUBLISH_DATASTREAM="publish_datastream",t.UNPUBLISH="unpublish",t.UNPUBLISH_DATASTREAM="unpublish_datastream",t.SUBSCRIBE="subscribe",t.PRE_SUBSCRIBE="pre_subscribe",t.SUBSCRIBE_DATASTREAM="subscribe_datastream",t.SUBSCRIBE_STREAMS="subscribe_streams",t.UNSUBSCRIBE="unsubscribe",t.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",t.UNSUBSCRIBE_STREAMS="unsubscribe_streams",t.SUBSCRIBE_CHANGE="subscribe_change",t.TRAFFIC_STATS="traffic_stats",t.RENEW_TOKEN="renew_token",t.SET_DUAL_STREAM_MODE="set_dual_stream_mode",t.SWITCH_VIDEO_STREAM="switch_video_stream",t.DEFAULT_VIDEO_STREAM="default_video_stream",t.SET_FALLBACK_OPTION="set_fallback_option",t.CONFIGURE="configure",t.GATEWAY_INFO="gateway_info",t.CONTROL="control",t.SEND_METADATA="send_metadata",t.DATA_STREAM="data_stream",t.PICK_SVC_LAYER="pick_svc_layer",t.RESTART_ICE="restart_ice",t.CONNECT_PC="connect_pc",t.SET_VIDEO_PROFILE="set_video_profile",t.SET_PARAMETER="set_parameter",t.SET_RTM2_FLAG="set_rtm2_flag",t.DOWNGRADE_CODEC="downgrade_codec",t}({}),rh=function(t){return t.WRTC_STATS="wrtc_stats",t.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",t.DENOISER_STATS="denoiser_stats",t.EXTENSION_USAGE_STATS="extension_usage_stats",t}({}),vt=function(t){return t.ON_USER_ONLINE="on_user_online",t.ON_USER_OFFLINE="on_user_offline",t.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",t.ON_PUBLISH_STREAM="on_publish_stream",t.ON_UPLINK_STATS="on_uplink_stats",t.ON_P2P_LOST="on_p2p_lost",t.ON_REMOVE_STREAM="on_remove_stream",t.ON_ADD_AUDIO_STREAM="on_add_audio_stream",t.ON_ADD_VIDEO_STREAM="on_add_video_stream",t.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",t.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",t.ON_USER_BANNED="on_user_banned",t.ON_USER_LICENSE_BANNED="on_user_license_banned",t.ON_NOTIFICATION="on_notification",t.ON_CRYPT_ERROR="on_crypt_error",t.MUTE_AUDIO="mute_audio",t.MUTE_VIDEO="mute_video",t.UNMUTE_AUDIO="unmute_audio",t.UNMUTE_VIDEO="unmute_video",t.ON_P2P_OK="on_p2p_ok",t.RECEIVE_METADATA="receive_metadata",t.ON_DATA_STREAM="on_data_stream",t.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",t.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",t.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",t.ENABLE_LOCAL_VIDEO="enable_local_video",t.DISABLE_LOCAL_VIDEO="disable_local_video",t.ENABLE_LOCAL_AUDIO="enable_local_audio",t.DISABLE_LOCAL_AUDIO="disable_local_audio",t.ON_PUBLISHED_USER_LIST="on_published_user_list",t.ENABLE_MULTI_STREAM="enable_multi_stream",t}({}),Li=function(t){return t.SEND_ONLY="SEND_ONLY",t.RECEIVE_ONLY="RECEIVE_ONLY",t}({}),wt=function(t){return t.CONNECTED="websocket:connected",t.RECONNECTING="websocket:reconnecting",t.WILL_RECONNECT="websocket:will_reconnect",t.CLOSED="websocket:closed",t.FAILED="websocket:failed",t.ON_MESSAGE="websocket:on_message",t.REQUEST_NEW_URLS="websocket:request_new_urls",t.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",t.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",t.ON_FALLBACK="websocket:on_fallback",t}({});function __(t){if(typeof t!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(t))throw A.error("Invalid Channel Name ".concat(t)),new pe(K.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function E_(t){if(r=t,!(typeof r=="number"&&Math.floor(r)===r&&0<=r&&r<=4294967295||vV(t,1,255)))throw new pe(K.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var r;typeof t=="string"&&A.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let ml=function(t){return t.TRANSCODE="mix_streaming",t.RAW="raw_streaming",t}({});const mve={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},g1={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function v1(t,r){Wr(t.url,"".concat(r,".url"),1,1e3,!1),Mn(t.x)||un(t.x,"".concat(r,".x"),0,1e4),Mn(t.y)||un(t.y,"".concat(r,".y"),0,1e4),Mn(t.width)||un(t.width,"".concat(r,".width"),0,1e4),Mn(t.height)||un(t.height,"".concat(r,".height"),0,1e4),Mn(t.zOrder)||un(t.zOrder,"".concat(r,".zOrder"),0,255),Mn(t.alpha)||un(t.alpha,"".concat(r,".alpha"),0,1,!1)}const fve={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let yd=function(t){return t.WARNING="@live_uap-warning",t.ERROR="@line_uap-error",t.PUBLISH_STREAM_STATUS="@live_uap-publish-status",t.WORKER_STATUS="@live_uap-worker-status",t.REQUEST_NEW_ADDRESS="@live_uap-request-address",t}({}),y1=function(t){return t.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",t}({}),mr=function(t){return t[t.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",t[t.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",t[t.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",t[t.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",t[t.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",t[t.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",t[t.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",t[t.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",t[t.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",t[t.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",t[t.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",t[t.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",t[t.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",t[t.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",t[t.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",t[t.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",t[t.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",t[t.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",t[t.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",t[t.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",t[t.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",t}({});function w8(t){if(!t.channelName)throw new pe(K.INVALID_PARAMS,"invalid channelName in info");if(typeof t.uid!="number")throw new pe(K.INVALID_PARAMS,"invalid uid in info, uid must be a number");return t.token&&Wr(t.token,"info.token",1,2047),E_(t.uid),__(t.channelName),!0}let Yi=function(t){return t[t.SetSdkProfile=0]="SetSdkProfile",t[t.SetSourceChannel=1]="SetSourceChannel",t[t.SetSourceUserId=2]="SetSourceUserId",t[t.SetDestChannel=3]="SetDestChannel",t[t.StartPacketTransfer=4]="StartPacketTransfer",t[t.StopPacketTransfer=5]="StopPacketTransfer",t[t.UpdateDestChannel=6]="UpdateDestChannel",t[t.Reconnect=7]="Reconnect",t[t.SetVideoProfile=8]="SetVideoProfile",t}({}),fl=function(t){return t.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",t.NETWORK_CONNECTED="NETWORK_CONNECTED",t.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",t.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",t.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",t.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",t.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",t.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",t.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",t.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",t}({}),ls=function(t){return t.RELAY_STATE_IDLE="RELAY_STATE_IDLE",t.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",t.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",t.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",t}({}),gm=function(t){return t.RELAY_OK="RELAY_OK",t.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",t.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",t.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",t}({}),rn=function(t){return t.High="high",t.Low="low",t.Audio="audio",t.Screen="screen",t.ScreenLow="screen_low",t}({}),qn=function(t){return t.DISCONNECT="disconnect",t.CONNECTION_STATE_CHANGE="connection-state-change",t.NETWORK_QUALITY="network-quality",t.STREAM_TYPE_CHANGE="stream-type-change",t.IS_P2P_DISCONNECTED="is-p2p-dis",t.DISCONNECT_P2P="dis-p2p",t.REQUEST_NEW_GATEWAY_LIST="req-gate-url",t.NEED_RENEW_SESSION="need-sid",t.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",t.JOIN_RESPONSE="join-response",t.RESET_CONNECTION_EVENTS="reset-connection-events",t.PRE_CONNECT_PC="pre-connect_pc",t.UPDATE_GATEWAY_CONFIG="update-gateway-config",t.VOS_FALLBACK="vos-fallback",t.VOS_FALLBACK_PROMISE="vos-fallback-promise",t.RESET_SIGNAL="reset-signal",t.DATACHANNEL_FAILBACK="datachannel-failback",t}({}),w_=function(t){return t.P2P_DISCONNECTED="P2P_DISCONNECTED",t.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",t.TIMEOUT="TIMEOUT",t.UNKNOWN_REASON="UNKNOWN_REASON",t}({}),Sr=function(t){return t[t.Nothing=0]="Nothing",t[t.Audio=1]="Audio",t[t.LwoVideo=2]="LwoVideo",t[t.Video=4]="Video",t[t.Data=8]="Data",t[t.DataStream0=256]="DataStream0",t[t.DataStream1=512]="DataStream1",t[t.DataStream2=1024]="DataStream2",t[t.DataStream3=2048]="DataStream3",t[t.DataStream4=4096]="DataStream4",t[t.DataStream5=8192]="DataStream5",t[t.DataStream6=16384]="DataStream6",t[t.DataStream7=32768]="DataStream7",t}({}),Jt=function(t){return t.CHINA="CHINA",t.ASIA="ASIA",t.NORTH_AMERICA="NORTH_AMERICA",t.EUROPE="EUROPE",t.JAPAN="JAPAN",t.INDIA="INDIA",t.KOREA="KOREA",t.HKMC="HKMC",t.US="US",t.OCEANIA="OCEANIA",t.SOUTH_AMERICA="SOUTH_AMERICA",t.AFRICA="AFRICA",t.OVERSEA="OVERSEA",t.GLOBAL="GLOBAL",t.EXTENSIONS="EXTENSIONS",t}({});const S8=[Jt.AFRICA,Jt.ASIA,Jt.CHINA,Jt.EUROPE,Jt.GLOBAL,Jt.INDIA,Jt.JAPAN,Jt.NORTH_AMERICA,Jt.OCEANIA,Jt.OVERSEA,Jt.SOUTH_AMERICA];let si=function(t){return t.CHINA="CN",t.ASIA="AS",t.NORTH_AMERICA="NA",t.EUROPE="EU",t.JAPAN="JP",t.INDIA="IN",t.KOREA="KR",t.HKMC="HK",t.US="US",t.OCEANIA="OC",t.SOUTH_AMERICA="SA",t.AFRICA="AF",t.OVERSEA="OVERSEA",t.GLOBAL="GLOBAL",t.EXTENSIONS="GLOBAL",t}({});const S_={CHINA:{},ASIA:{CODE:si.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:si.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:si.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:si.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:si.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:si.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:si.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:si.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:si.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:si.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:si.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:si.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:si.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};jA&&(S_.CHINA={CODE:si.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let Bo=function(t){return t.UPDATE_BITRATE_LIMIT="update_bitrate_limit",t.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",t.UPDATE_REMOTE_VIDEO_STREAM_TYPE="update_remote_video_stream_type",t.FALLBACK_TO_HLS="fallback_to_hls",t.UPDATE_VOS_CONFIGURE="update_vos_configure",t}({});function T8(t){return!!t&&!(!t.uplink||!t.id)&&t.uplink.max_bitrate!==void 0&&t.uplink.min_bitrate!==void 0}class N8 extends Pn{constructor(r,i){super(),F(this,"onICEConnectionStateChange",void 0),F(this,"onConnectionStateChange",void 0),F(this,"onDTLSTransportStateChange",void 0),F(this,"onDTLSTransportError",void 0),F(this,"onICETransportStateChange",void 0),F(this,"onFirstAudioReceived",void 0),F(this,"onFirstVideoReceived",void 0),F(this,"onFirstAudioDecoded",void 0),F(this,"onFirstVideoDecoded",void 0),F(this,"onFirstVideoRender",void 0),F(this,"onFirstVideoBufferReady",void 0),F(this,"onFirstVideoDecodedTimeout",void 0),F(this,"onSelectedLocalCandidateChanged",void 0),F(this,"onSelectedRemoteCandidateChanged",void 0),F(this,"onICECandidateError",void 0),F(this,"getLocalVideoStats",void 0)}}class T_ extends N8{constructor(r,i){super(r,i),F(this,"establishPromise",void 0)}}let ze=function(t){return t.VIDEO="video",t.AUDIO="audio",t}({}),jr=function(t){return t.UDP_RELAY="udp_relay",t.UDP_TCP_RELAY="udp_tcp_relay",t.TCP_RELAY="tcp_relay",t.RELAY="relay",t}({}),gl=function(t){return t[t.FIRST_CONNECTION=0]="FIRST_CONNECTION",t[t.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",t[t.RELAY_RESTART=2]="RELAY_RESTART",t[t.TCP_RESTART=3]="TCP_RESTART",t[t.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",t[t.OLD_RESTART=11]="OLD_RESTART",t[t.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",t}({});const C8=["disconnected","failed"];let Re=function(t){return t.LocalVideoTrack="videoTrack",t.LocalAudioTrack="audioTrack",t.LocalVideoLowTrack="videoLowTrack",t}({}),Qt=function(t){return t.New="new",t.Connected="connected",t.Reconnecting="reconnecting",t.Disconnected="disconnected",t}({}),rt=function(t){return t.AudioMetadata="audioMetadata",t.AudioPts="audioPts",t.StateChange="stateChange",t.IceConnectionStateChange="iceConnectionStateChange",t.RequestMuteLocal="requestMuteLocal",t.RequestUnmuteLocal="requestUnmuteLocal",t.RequestRePublish="requestRePublish",t.RequestRePublishDataChannel="requestRePublishDataChannel",t.RequestReSubscribe="requestReSubscribe",t.RequestUploadStats="requestUploadStats",t.RequestUpload="requestUpload",t.MediaReconnectStart="MediaReconnectStart",t.MediaReconnectEnd="MediaReconnectEnd",t.NeedSignalRTT="NeedSignalRTT",t.RequestRestartICE="RequestRestartIce",t.PeerConnectionStateChange="PeerConnectionStateChange",t.RequestReconnect="RequestReconnect",t.RequestReconnectPC="RequestReconnectPC",t.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",t.P2PLost="P2PLost",t.UpdateVideoEncoder="UpdateVideoEncoder",t.ConnectionTypeChange="ConnectionTypeChange",t.RequestLowStreamParameter="RequestLowStreamParameter",t.QueryClientConnectionState="QueryClientConnectionState",t.LocalCandidate="LocalCandidate",t.RequestP2PMuteLocal="requestP2PMuteLocal",t.RequestP2PUnPublish="RequestP2PUnPublish",t.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",t.RequestP2PMuteRemote="RequestP2PMuteRemote",t.RequestP2PRestartICE="RequestP2PRestartICE",t.FirstVideoPreRender="FirstVideoPreRender",t.FirstVideoBufferReady="FirstVideoBufferReady",t}({}),eo=function(t){return t.CONNECTING="CONNECTING",t.RECONNECTING="RECONNECTING",t.CONNECTED="CONNECTED",t.CLOSED="CLOSED",t}({}),to=function(t){return t[t.CONNECT_AP=0]="CONNECT_AP",t[t.AP_CONNECTED=1]="AP_CONNECTED",t[t.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",t[t.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",t[t.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",t[t.CONNECT_WORKER=5]="CONNECT_WORKER",t[t.WORKER_CONNECTED=6]="WORKER_CONNECTED",t[t.CLOSED=7]="CLOSED",t}({}),Dr=function(t){return t.CONNECTION_STATE_CHANGE="connection-state-change",t.STATE_CHANGE="state-change",t.INSPECT_RESULT="inspect-result",t.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",t.REQUEST_NEW_WORKER_URL="request-new-worker-url",t}({}),bd=function(t){return t.NETWORK_ERROR="NETWORK_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.MULTI_IP="MULTI_IP",t.TIMEOUT="TIMEOUT",t.OFFLINE="OFFLINE",t.LEAVE="LEAVE",t.P2P_FAILED="P2P_FAILED",t.FALLBACK="FALLBACK",t}({}),fr=function(t){return t.CONNECTED="transmitter:connected",t.RECONNECTING="transmitter:reconnecting",t.WILL_RECONNECT="transmitter:will_reconnect",t.CLOSED="transmitter:closed",t.FAILED="transmitter:failed",t.ON_MESSAGE="transmitter:on_message",t.REQUEST_NEW_URLS="transmitter:request_new_urls",t.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",t.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",t.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",t.FAILBACK="transmitter:failback",t.PRE_CONNECT_PC="transmitter:pre_connect_pc",t}({}),Rc=function(t){return t.CAMERA_CHANGED="camera-changed",t.MICROPHONE_CHANGED="microphone-changed",t.PLAYBACK_DEVICE_CHANGED="playback-device-changed",t.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",t.AUTOPLAY_FAILED="autoplay-failed",t.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",t.SECURITY_POLICY_VIOLATION="security-policy-violation",t}({}),xa=function(t){return t.CONNECTING="CONNECTING",t.RECONNECTING="RECONNECTING",t.CONNECTED="CONNECTED",t.CLOSED="CLOSED",t}({}),Go=function(t){return t.CONNECTION_STATE_CHANGE="connection-state-change",t.STATE_CHANGE="state-change",t.INSPECT_RESULT="inspect-result",t.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",t.REQUEST_NEW_WORKER_URL="request-new-worker-url",t}({}),vm=function(t){return t[t.CONNECT_AP=0]="CONNECT_AP",t[t.AP_CONNECTED=1]="AP_CONNECTED",t[t.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",t[t.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",t[t.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",t[t.CONNECT_WORKER=5]="CONNECT_WORKER",t[t.WORKER_CONNECTED=6]="WORKER_CONNECTED",t[t.CLOSED=7]="CLOSED",t}({}),Xn=function(t){return t.CALL="call",t.CANDIDATE="candidate",t.PUBLISH="publish",t.UNPUBLISH="unpublish",t.CONTROL="control",t.RESTART_ICE="restart_ice",t.ACK="ack",t.RESPONSE="response",t.JOIN="join",t.CHECK="check",t}({}),ym=function(t){return t.ABORT="abort",t}({}),xd=function(t){return t.MUTE_LOCAL_AUDIO="mute_local_audio",t.MUTE_LOCAL_VIDEO="mute_local_video",t.UNMUTE_LOCAL_AUDIO="unmute_local_audio",t.UNMUTE_LOCAL_VIDEO="unmute_local_video",t}({}),gve=function(t){return t.P2P_TOKEN_TIMEOUT="p2p_token_timeout",t.P2P_TOKEN_CHANGED="p2p_token_changed",t}({});const vve={[x_.ACCESS_POINT]:{[Di.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[Di.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[Di.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[Di.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[Di.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[Di.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[Di.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[x_.UNILBS]:{[ba.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[ba.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[ba.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[ba.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[ba.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[ba.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[ba.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[ba.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[ba.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[ba.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[ba.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[ba.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1},[ba.REQ_DOWNGRADE_FALLBACK]:{desc:"request downgrade fallback",retry:!1}},[x_.STRING_UID_ALLOCATOR]:{[f1.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[f1.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[f1.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function bm(t){const r=vve[Math.floor(t/1e4)];if(!r)return{desc:"unknown error",retry:!1};const i=r[t%1e4];if(!i){if(Math.floor(t/1e4)===x_.ACCESS_POINT){const a=t%1e4;if(a.toString()[0]==="1")return{desc:t.toString(),retry:!1};if(a.toString()[0]==="2")return{desc:t.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return i}const yve={[at.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[at.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[at.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[at.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[at.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[at.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[at.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[at.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[at.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[at.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[at.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[at.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[at.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[at.K_VOS_FALLBACK]:{desc:"K_VOS_FALLBACK",action:"tryNext"},[at.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[at.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[at.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[at.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[at.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[at.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[at.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[at.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[at.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[at.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[at.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[at.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[at.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[at.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[at.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[at.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[at.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[at.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[at.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[at.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[at.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[at.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[at.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[at.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[at.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[at.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[at.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[at.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[at.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[at.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[at.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[at.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[at.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[at.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[at.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[at.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[at.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[at.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[at.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[at.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[at.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[at.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[at.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[at.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[at.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[at.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[at.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[at.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[at.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[at.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[at.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function ih(t){return yve[t]||{desc:"UNKNOWN_ERROR_".concat(t),action:"failed"}}function R8(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function b1(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?R8(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):R8(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}function x1(t,r){if(typeof t=="string")return t;const{proxy:i,host:a,port:l}=t;if(r){const u=W("JOIN_GATEWAY_FALLBACK_PORT")||443;return u===443?"wss://".concat(a,"/ws/?p=").concat(Number(l)+150):"wss://".concat(a,":").concat(u,"/ws/?p=").concat(Number(l)+150)}return i?"wss://".concat(i,"/ws/?h=").concat(a,"&p=").concat(l):"wss://".concat(a,":").concat(l)}const bve=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,xve=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,_ve=/wss:\/\/(.+):([0-9]+)\/?/,Eve=/wss:\/\/(.[^\/]+)\/?/;let wve=0;class Sve{constructor(r,i){F(this,"id",0),F(this,"store",void 0),F(this,"recordIndex",void 0),F(this,"websockets",[]),F(this,"try443PortDuration",2e3),F(this,"forceCloseWSDuration",5e3),F(this,"try443PortTimeout",null),F(this,"forceCloseTimeout",null),F(this,"isTry443PortFailed",!1),F(this,"isNormalPortFailed",!1),F(this,"useDoubleDomain",!1),F(this,"useProxy",!1),F(this,"startTime",Date.now()),this.id=++wve,this.try443PortDuration=W("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=r||5e3,this.store=i}closeAllWebsockets(){this.websockets.forEach(r=>{r.onopen=null,r.onclose=null,r.onmessage=null,r.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var r;const i=Date.now()-this.startTime;for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];A.debug("[choose-best-ws ".concat((r=this.store)===null||r===void 0?void 0:r.clientId," ").concat(this.id,"] ").concat(i,"ms:"),...l)}createWebSocket(r,i,a){this.logger("createWebSocket:",r,{isTry443Port:i,hasTimeoutDetection:a});const l=W("GATEWAY_DOMAINS"),u=Date.now(),p=[],m=l.find(T=>{var C;return Ce(C=r.host).call(C,T)});m||(this.useDoubleDomain=!1);const g=[];if(this.useDoubleDomain)l.forEach(T=>{g.push(x1(b1(b1({},r),{},{host:r.host.replace(m,T)}),i))});else{const T=b1({},r);if(i&&m){const C=l.find(V=>V!==m);C&&(T.host=T.host.replace(m,C))}g.push(x1(T,i))}try{g.forEach(T=>{const C=new WebSocket(T);C.binaryType="arraybuffer",p.push(C),this.logger("ws is connecting:",C.url)})}catch(T){if(this.logger("ws create failed"),p.forEach(C=>C.close()),p.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(r,i,a);if(!i&&Number(r.port)!==443)return this.createWebSocket(r,!0,a);throw new pe(K.WS_ERR,"init websocket failed! Error: ".concat(T.toString()))}const y=m0();this.store&&this.store.recordJoinChannelService({urls:p.map(T=>T.url),service:"gateway"},this.recordIndex),p.forEach(T=>{T.onopen=()=>{this.logger("onopen: ws ".concat(T.url," open cost ").concat(Date.now()-u,"ms")),this.websockets.forEach(C=>{C!==T&&(C.onopen=null,C.onclose=null,C.onmessage=null,C.close(),this.logger("close backup websocket: ".concat(C.url)))}),this.websockets.length=0,y.resolve(T)},T.onclose=C=>{this.logger("onclose: ws ".concat(T.url," closed cost ").concat(Date.now()-u,"ms state: ").concat(T.readyState));const V=p.every(j=>j.readyState===WebSocket.CLOSED||j.readyState===WebSocket.CLOSING);this.logger("".concat(i?"443":"47xx"," websocket closed, all failed: ").concat(V)),V&&(i||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(C.reason)),y.reject({code:C.code,reason:w_.A_ROUND_WS_FAILED})):!i&&V&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),S()),i?this.isTry443PortFailed=V:this.isNormalPortFailed=V},T.onmessage=C=>this.logger("".concat(T.url," onmessage: ").concat(C.data))}),this.websockets.push(...p);const x=()=>{this.websockets.forEach(T=>T.readyState!==WebSocket.OPEN&&T.close())},S=()=>{if(y.isResolved)return x();Ht().os===_r.MAC_OS&&wn()&&x(),this.createWebSocket(r,!0,!0).then(T=>{y.resolve(T)}).catch(T=>{this.isNormalPortFailed&&y.reject(T),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",y.isResolved),this.forceCloseTimeout=null,x()},this.forceCloseWSDuration)};return a||(()=>{if(i||this.useProxy)return this.logger("add 5s timeout at ".concat(i?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(()=>{this.forceCloseTimeout=null,x()},this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{this.logger("2s timeout, isWebsocket created: ",y.isResolved),this.try443PortTimeout=null,S()},this.try443PortDuration)})(),y.promise}chooseBestWebsocket(r,i,a,l){return this.useDoubleDomain=!!i,typeof r=="string"&&(r=function(u){let p,m,g;return[,p,m,g]=u.match(bve)||[],p||([,m,g]=u.match(xve)||[]),m&&g||([,m,g]=u.match(_ve)||[]),m&&g||([,m]=u.match(Eve)||[]),m||A.warning("un-destructible url: ",u),{proxy:p,host:m,port:g||"443"}}(r)),this.recordIndex=l,this.useProxy=!!r.proxy,a&&this.useProxy&&(A.warn("cannot use 443 only when use proxy"),a=!1),this.createWebSocket(r,!!a,!1).finally(()=>this.clearTimeout())}}function A8(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}class I8 extends Pn{get url(){return this.websocket&&this.websocket.url||this._websocketUrl}get reconnectMode(){return this._reconnectMode}set reconnectMode(r){var i;Ce(i=["tryNext","recover"]).call(i,r)&&this.resetReconnectCount(r),this._reconnectMode=r}get state(){return this._state}set state(r){r!==this._state&&(this._state=r,this._state==="reconnecting"?this.emit(wt.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(wt.CONNECTED):this._state==="closed"?this.emit(wt.CLOSED):this._state==="failed"&&this.emit(wt.FAILED))}resetReconnectCount(r){A.debug("websocket reset reconnect count, reason: "+r),this.reconnectCount=0}constructor(r,i){let a=arguments.length>2&&arguments[2]!==void 0&&arguments[2],l=arguments.length>3&&arguments[3]!==void 0&&arguments[3],u=arguments.length>4&&arguments[4]!==void 0&&arguments[4],p=arguments.length>5?arguments[5]:void 0;super(),F(this,"_websocketUrl",null),F(this,"connectionID",0),F(this,"currentURLIndex",0),F(this,"urls",[]),F(this,"_reconnectMode","tryNext"),F(this,"reconnectReason",void 0),F(this,"_initMutex",void 0),F(this,"name",void 0),F(this,"_state","closed"),F(this,"reconnectInterrupter",void 0),F(this,"websocket",void 0),F(this,"retryConfig",void 0),F(this,"reconnectCount",0),F(this,"forceCloseTimeout",5e3),F(this,"onlineReconnectListener",void 0),F(this,"useCompress",void 0),F(this,"tryDoubleDomain",!1),F(this,"use443PortOnly",!1),F(this,"wsInflateLength",0),F(this,"wsDeflateLength",0),F(this,"closeEstablishingWs",()=>{}),F(this,"store",void 0),F(this,"joinGatewayRecordIndex",void 0),this.store=p,this.name=r,this.retryConfig=function(S){for(var T=1;T<arguments.length;T++){var C=arguments[T]!=null?arguments[T]:{};T%2?A8(Object(C),!0).forEach(function(V){F(S,V,C[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(S,Object.getOwnPropertyDescriptors(C)):A8(Object(C)).forEach(function(V){Object.defineProperty(S,V,Object.getOwnPropertyDescriptor(C,V))})}return S}({},i),this.useCompress=a,this.tryDoubleDomain=l,this.use443PortOnly=u,this._initMutex=new kr("websocket",p?p.clientId:void 0);const{timeout:m,timeoutFactor:g}=i,y=Math.max(300,Math.floor(3*m/5)),x=Math.max(1.2,Math.floor(8*g)/10);Pi.ONLINE&&(this.retryConfig.timeout=y,this.retryConfig.timeoutFactor=x),Un.on(Gu.NETWORK_STATE_CHANGE,(S,T)=>{S!==T&&(this.resetReconnectCount("network state change: ".concat(T," -> ").concat(S)),S===Pi.ONLINE?(this.retryConfig.timeout=y,this.retryConfig.timeoutFactor=x):(this.retryConfig.timeout=m,this.retryConfig.timeoutFactor=g))})}getConnection(){return this.websocket||void 0}async init(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const a=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=i,this.urls=r,this.state="connecting";try{var l;const u=m0(),p=this.urls[this.currentURLIndex];(l=this.store)===null||l===void 0||l.beforeConnect(),function(m){return!(r_()||W("USE_NEW_TOKEN")||!W("ENABLE_PREALLOC_PC")&&(m==null||!m.autoSubscribe||W("FORCE_DISABLE_AUTO_SUB")))}(this.store)&&this.emit(fr.PRE_CONNECT_PC),this.createWebSocketConnection(p).then(u.resolve).catch(u.reject),this.once(wt.CLOSED,()=>{u.reject(new ge(K.WS_DISCONNECT))}),this.once(wt.CONNECTED,u.resolve),await u.promise}catch{}finally{a()}}close(r,i){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const a=this.websocket;i?setTimeout(()=>a.close(),500):a.close(),this.websocket=void 0,this._websocketUrl=null}this.state=r?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(r,i){if(!this.websocket)return void A.warning("[".concat(this.name,"] can not reconnect, no websocket"));r!==void 0&&(this.reconnectMode=r),A.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(i)]},this.joinGatewayRecordIndex);const a=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),a&&a.bind(this.websocket)({code:9999,reason:i})}sendMessage(r){let i=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new ge(K.WS_ABORT,"websocket is not ready");try{i||(r=JSON.stringify(r)),this.websocket.send(r)}catch(a){throw new ge(K.WS_ERR,"send websocket message error"+a.toString())}}setWsInflateData(r){this.wsDeflateLength=this.wsDeflateLength+r.originLength,this.wsInflateLength=this.wsInflateLength+r.compressedLength}getWsInflateData(){const r=this.wsInflateLength,i=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:r,wsDeflateLength:i}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(r){var i;const a=m0();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const l=x=>{var S;(S=this.store)===null||S===void 0||S.signalChannelOpen(),A.debug("[".concat(this.name,"] websocket opened:"),x),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),a.resolve()},u=async x=>{var S;if(A.debug("[".concat(this.name,"] websocket close ").concat((S=this.websocket)===null||S===void 0?void 0:S.url,", code: ").concat(x.code,", reason: ").concat(x.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)a.reject(new ge(K.WS_DISCONNECT,"websocket close: ".concat(x.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=x.reason,this.state="reconnecting");const T=As(this,wt.WILL_RECONNECT,this.reconnectMode,x.reason)||this.reconnectMode,C=await this.reconnectWithAction(T);if(this.state==="closed")return void A.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!C)return a.reject(new ge(K.WS_DISCONNECT,"websocket reconnect failed: ".concat(x.code))),this.close(!0);a.resolve()}},p=x=>{this.emit(wt.ON_MESSAGE,x)},m=x=>{A.warn("[".concat(this.connectionID,"] ws open error ").concat(x))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),W("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(r=W("GATEWAY_WSS_ADDRESS")),A.debug("[".concat(this.name,"] start connect, url:"),r);const g=(i=this.store)===null||i===void 0?void 0:i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var y;this._websocketUrl=x1(r);const x=await this.chooseBestWebsocketConnection(r);this.websocket=x,l&&l(this.websocket.url),this.websocket.onclose=u,this.websocket.onmessage=p,this.websocket.onerror=m,(y=this.store)===null||y===void 0||y.recordJoinChannelService({endTs:Date.now(),status:"success"},g),this.joinGatewayRecordIndex=g}catch(x){const S=this.state==="closed",T=x instanceof ge,C=T&&x.code===K.WS_ABORT,V=T&&x.code===K.WS_ERR,j=T?x.message:x&&(x.reason||x.toString());A.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(j)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:C?"aborted":"error",errors:[x]},g),S||V?(a.reject(S?new ge(K.WS_DISCONNECT,"websocket is closed: ".concat(j)):new ge(K.WS_ERR,"init websocket failed: ".concat(j))),V&&A.error("[".concat(this.name,"] init websocket failed: ").concat(j))):u&&u(x)}return a.promise}async reconnectWithAction(r){let i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;A.warning("[choose-best-ws] action: =>",r),this.onlineReconnectListener||Un.isOnline||!Un.onlineWaiter||(this.onlineReconnectListener=Un.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let a=!0;if(this.reconnectInterrupter=()=>a=!1,i){const p=qx(this.reconnectCount,this.retryConfig);A.debug("[".concat(this.name,"] wait ").concat(p,"ms to reconnect websocket, mode: ").concat(r)),await je.race([Er(p),this.onlineReconnectListener||new je(()=>{})])}if(this._state==="closed"||!a)return!1;this.reconnectCount+=1;const l=async(p,m)=>{this.emit(wt.RECONNECT_CREATE_CONNECTION,m),await this.createWebSocketConnection(p)};try{if(r==="retry")await l(this.urls[this.currentURLIndex],r);else if(r==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);A.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await l(this.urls[this.currentURLIndex],r)}else r==="recover"&&(A.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await or(this,wt.REQUEST_NEW_URLS),this.currentURLIndex=0,await l(this.urls[this.currentURLIndex],r))}catch(p){var u;A.error("[".concat(this.name,"] reconnect failed ").concat(p&&p.toString()));const m=p==null||(u=p.data)===null||u===void 0?void 0:u.desc;if(Array.isArray(m)){if(Ce(m).call(m,"dynamic key expired"))return this.emit(wt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1;if(Ce(m).call(m,"request downgrade fallback"))return this.emit(wt.ON_FALLBACK),!1}return this.reconnectWithAction(r,i)}return!0}}class _1 extends I8{constructor(r,i){super(r,i,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(r,i){const a=m0(),l=function(p,m){return new Sve(p,m)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{A.debug("[choose-best-ws] close establishing websockets"),l.closeAllWebsockets(),a.reject(new ge(K.WS_ABORT,"choose best websocket aborted"))};const u=W("GATEWAY_DOMAINS");return A.debug("[choose-best-ws] currentDomain: ",r,", domains: ",u,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),l.chooseBestWebsocket(r,this.tryDoubleDomain,this.use443PortOnly,i).then(a.resolve).catch(a.reject),a.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class C0 extends I8{constructor(r,i){super(r,i,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(r,i){return new je((a,l)=>{let u=!1;const p=[];this.closeEstablishingWs=()=>{A.debug("[choose-best-ws] close establishing websockets"),p.forEach(V=>{V.onclose=null,V.onopen=null,V.onmessage=null,V.close()}),l(new ge(K.WS_ABORT,"choose best websocket aborted"))};const m=W("GATEWAY_DOMAINS");let g;const y=r.indexOf("?h="),x=m.find(V=>y!==-1?Ce(r).call(r,V,y):Ce(r).call(r,V));A.debug("[choose-best-ws] currentDomain: ",x,", domains: ",m);let S=!this.tryDoubleDomain||!x;if(!S&&x){var T;const V=Date.now();try{m.forEach(j=>{const L=y===-1?r.replace(x,j):r.substr(0,y)+r.substr(y).replace(x,j),H=new WebSocket(L);H.binaryType="arraybuffer",p.push(H),A.debug("[choose-best-ws] ws is connecting:",H.url)})}catch{for(A.debug("[choose-best-ws] ws create failed, fallback to single url"),p.forEach(L=>L.close());p.length;)p.pop();S=!0}(T=this.store)===null||T===void 0||T.recordJoinChannelService({urls:p.map(j=>j.url),service:"gateway"},i),p.forEach(j=>{j.onopen=()=>{if(u)return;const L=Date.now()-V;A.debug("[choose-best-ws] ws open cost ".concat(L,"ms")),p.filter(H=>H!==j).forEach(H=>{A.debug("[choose-best-ws]close backup websocket: ".concat(H.url)),H.close()}),u=!0,a(j)},j.onclose=L=>{g=L,!u&&(p.find(H=>!(H.readyState===WebSocket.CLOSED||H.readyState===WebSocket.CLOSING))||(A.debug("[choose-best-ws] all websocket is closed"),u=!0,l(g)))},j.onmessage=L=>{A.debug("[choose-best-ws]".concat(j.url," onmessage: ").concat(L.data))}}),Er(this.forceCloseTimeout).then(()=>{p.forEach(j=>{j.readyState!==WebSocket.OPEN&&j.close()})})}if(S){var C;let V;A.debug("[choose-best-ws] use single url: ",r),(C=this.store)===null||C===void 0||C.recordJoinChannelService({urls:[r],service:"gateway"},i);try{V=new WebSocket(r),p.push(V),V.binaryType="arraybuffer"}catch(j){const L=new ge(K.WS_ERR,"init websocket failed! Error: ".concat(j.toString()));return A.error("[".concat(this.name,"]").concat(L)),void l(L)}V.onopen=()=>{a(V)},V.onclose=j=>{l(j)},V.onmessage=j=>{A.debug("[choose-best-ws]".concat(V.url," onmessage: ").concat(j.data))},Er(this.forceCloseTimeout).then(()=>{V&&V.readyState!==WebSocket.OPEN&&V.close()})}}).then(a=>(this.closeEstablishingWs=void 0,a)).catch(a=>{throw this.closeEstablishingWs=void 0,a})}}class O8 extends Pn{get connectionState(){return this._connectionState}set connectionState(r){r!==this._connectionState&&(this._connectionState=r,r===Ft.CONNECTED?this.emit(Xe.WS_CONNECTED):r===Ft.RECONNECTING?this.emit(Xe.WS_RECONNECTING,this._websocketReconnectReason):r===Ft.CLOSED&&this.emit(Xe.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(r,i){super(),F(this,"__name__","AgoraRTCSignal"),F(this,"_disconnectedReason",void 0),F(this,"_websocketReconnectReason",void 0),F(this,"_connectionState",Ft.CLOSED),F(this,"reconnectToken",void 0),F(this,"websocket",void 0),F(this,"openConnectionTime",void 0),F(this,"clientId",void 0),F(this,"lastMsgTime",Date.now()),F(this,"uploadCache",[]),F(this,"uploadCacheInterval",void 0),F(this,"rttRolling",new CA(5)),F(this,"pingpongTimer",void 0),F(this,"wsInflateDataTimer",void 0),F(this,"pingpongTimeoutCount",0),F(this,"ortc",void 0),F(this,"joinResponse",void 0),F(this,"multiIpOption",void 0),F(this,"initError",void 0),F(this,"spec",void 0),F(this,"store",void 0),F(this,"onWebsocketMessage",a=>{if(a.data instanceof ArrayBuffer)return void this.emit(Xe.ON_BINARY_DATA,a.data);const l=JSON.parse(a.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const u="res-@".concat(l._id);this.emit(u,l._result,l._message)}else if(Object.prototype.hasOwnProperty.call(l,"_type")){if(this.emit(l._type,l._message),l._type===vt.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===vt.ON_USER_BANNED)switch(l._message.error_code){case 14:this.close(Ut.UID_BANNED);break;case 15:this.close(Ut.IP_BANNED);break;case 16:this.close(Ut.CHANNEL_BANNED)}if(l._type===vt.ON_USER_LICENSE_BANNED)switch(l._message.error_code){case at.ERR_LICENSE_MISSING:this.close(Ut.LICENSE_MISSING);break;case at.ERR_LICENSE_EXPIRED:this.close(Ut.LICENSE_EXPIRED);break;case at.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Ut.LICENSE_MINUTES_EXCEEDED);break;case at.ERR_LICENSE_PERIOD_INVALID:this.close(Ut.LICENSE_PERIOD_INVALID);break;case at.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Ut.LICENSE_MULTIPLE_SDK_SERVICE);break;case at.ERR_LICENSE_ILLEGAL:this.close(Ut.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=r.clientId,this.spec=r,this.store=i,this.websocket=new _1("gateway-".concat(this.clientId),this.spec.retryConfig,!0,W("JOIN_GATEWAY_USE_DUAL_DOMAIN"),W("JOIN_GATEWAY_USE_443PORT_ONLY"),i),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Ft.CONNECTED&&this.reconnect("retry",Qr.OFFLINE)})}async request(r,i,a,l){const u=tn(6,""),p={_id:u,_type:r,_message:i},m=this.websocket.connectionID,g=()=>new je((V,j)=>{if(this.connectionState===Ft.CONNECTED)return V();const L=()=>{this.off(Xe.WS_CLOSED,H),V()},H=()=>{this.off(Xe.WS_CONNECTED,L),j(new pe(K.WS_ABORT))};this.once(Xe.WS_CONNECTED,L),this.once(Xe.WS_CLOSED,H),r!==nt.PUBLISH&&r!==nt.PUBLISH_DATASTREAM&&r!==nt.SUBSCRIBE&&r!==nt.SUBSCRIBE_DATASTREAM&&r!==nt.UNSUBSCRIBE&&r!==nt.UNSUBSCRIBE_DATASTREAM&&r!==nt.UNPUBLISH&&r!==nt.UNPUBLISH_DATASTREAM&&r!==nt.CONTROL&&r!==nt.RESTART_ICE||this.once(Xe.DISCONNECT_P2P,()=>{j(new pe(K.DISCONNECT_P2P))}),r!==nt.PUBLISH&&r!==nt.RESTART_ICE||this.once(Xe.ABORT_P2P_EXECUTION,()=>{j(new pe(K.DISCONNECT_P2P))})});if(this.connectionState!==Ft.CONNECTING&&this.connectionState!==Ft.RECONNECTING||r===nt.JOIN||r===nt.REJOIN||await g(),this.websocket.sendMessage(p,!0),l)return;const y=new je((V,j)=>{let L=!1;const H=(te,se)=>{L=!0,V({isSuccess:te==="success",message:se||{}}),this.off(Xe.WS_CLOSED,Y),this.off(Xe.WS_RECONNECTING,Y),this.emit(Xe.REQUEST_SUCCESS,r,i)};this.once("res-@".concat(u),H);const Y=()=>{j(new pe(K.WS_ABORT,"type: ".concat(r))),this.off(Xe.WS_CLOSED,Y),this.off(Xe.WS_RECONNECTING,Y),this.off("res-@".concat(u),H)};this.once(Xe.WS_CLOSED,Y),this.once(Xe.WS_RECONNECTING,Y),Er(W("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==m||L||(A.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(r)),this.emit(Xe.REQUEST_TIMEOUT,r,i))})});let x=null;try{x=await y}catch(V){if(this.connectionState===Ft.CLOSED||r===nt.LEAVE)throw new pe(K.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?V.throw():r===nt.JOIN||r===nt.REJOIN?null:(await g(),await this.request(r,i))}if(x.isSuccess)return x.message;const S=Number(x.message.error_code||x.message.code),T=ih(S),C=new pe(K.UNEXPECTED_RESPONSE,"".concat(T.desc,": ").concat(x.message.error_str),{code:S,data:x.message,desc:T.desc});return T.action==="success"?x.message:(A.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(r,", error_code: ").concat(S,", message: ").concat(T.desc,", action: ").concat(T.action)),S===at.ERR_TOO_MANY_BROADCASTERS?((r===nt.JOIN||r===nt.REJOIN)&&(this.initError=C,this.close()),C.throw()):T.action==="failed"?C.throw():T.action==="quit"?(this.initError=C,this.close(),C.throw()):(S===at.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=x.message.option,A.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Qr.MULTI_IP)):this.reconnect(T.action,Qr.SERVER_ERROR),r===nt.JOIN||r===nt.REJOIN?null:await this.request(r,i)))}waitMessage(r,i){return new je(a=>{const l=u=>{(!i||i(u))&&(this.off(r,l),a(u))};this.on(r,l)})}uploadWRTCStats(r){if(!this.store.sessionId)return void A.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const i={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:r};this.upload(rh.WRTC_STATS,i)}upload(r,i){const a={_type:r,_message:i};try{this.websocket.sendMessage(a)}catch{const u=W("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Ft.CONNECTED)return;const p=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(p._type,p._message)},W("UPLOAD_CACHE_INTERVAL")||2e3))}}send(r,i){const a={_type:r,_message:i};this.websocket.sendMessage(a)}init(r){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new je((i,a)=>{this.once(Xe.WS_CONNECTED,()=>i(this.joinResponse)),this.once(Xe.WS_CLOSED,l=>a(this.initError||new pe(K.WS_ABORT,l))),this.connectionState=Ft.CONNECTING,this.websocket.init(r).catch(a),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=r||Ut.LEAVE,this.connectionState=Ft.CLOSED,A.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(Xe.ABORT_P2P_EXECUTION),this.store.signalConnected();const r=await or(this,Xe.REQUEST_JOIN_INFO);this.store.joinReq();const i=await this.request(nt.JOIN,r);if(this.ortc=r==null?void 0:r.ortc,this.store.joinRep(),!i)return this.emit(Xe.REPORT_JOIN_GATEWAY,w_.TIMEOUT,this.url||""),!1;this.joinResponse=i,this.emit(Xe.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Ft.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new pe(K.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const r=Wu(this,Xe.REQUEST_REJOIN_INFO);r.token=this.reconnectToken;const i=await this.request(nt.REJOIN,r);return!!i&&(this.connectionState=Ft.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),i.peers&&i.peers.forEach(a=>{this.emit(vt.ON_USER_ONLINE,{uid:a.uid}),a.audio&&this.emit(vt.ON_ADD_AUDIO_STREAM,{uid:a.uid,uint_id:a.uint_id,audio:!0,ssrcId:a.audio_ssrc}),a.video&&this.emit(vt.ON_ADD_VIDEO_STREAM,{uid:a.uid,uint_id:a.uint_id,video:!0,ssrcId:a.video_ssrc}),a.audio_mute?this.emit(vt.MUTE_AUDIO,{uid:a.uid}):this.emit(vt.UNMUTE_AUDIO,{uid:a.uid}),a.video_mute?this.emit(vt.MUTE_VIDEO,{uid:a.uid}):this.emit(vt.UNMUTE_VIDEO,{uid:a.uid}),a.audio_enable_local?this.emit(vt.ENABLE_LOCAL_AUDIO,{uid:a.uid}):this.emit(vt.DISABLE_LOCAL_AUDIO,{uid:a.uid}),a.video_enable_local?this.emit(vt.ENABLE_LOCAL_VIDEO,{uid:a.uid}):this.emit(vt.DISABLE_LOCAL_VIDEO,{uid:a.uid}),a.audio||a.video||this.emit(vt.ON_REMOVE_STREAM,{uid:a.uid,uint_id:a.uint_id})}),!0)}reconnect(r,i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(r,i)}async downgradeCodec(r){if(!this.ortc)return!1;const i={downgrade_codec:r,ortc:this.ortc};return!!await this.request(nt.DOWNGRADE_CODEC,i)}handleNotification(r){A.debug("[".concat(this.clientId,"] receive notification: "),r);const i=ih(r.code);if(r.code===28&&"detail"in r&&(A.info("[".concat(this.clientId,"] receive recover notification: "),r.detail),this.emit(Xe.RECOVER_NOTIFICATION,r.detail)),i.action!=="success"){if(i.action!=="failed")return i.action==="quit"?r.code===at.ERR_REPEAT_JOIN_CHANNEL&&W("IGNORE_UID_CHECK")?void this.close(Ut.UID_CONFLICT):(i.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Ut.UID_BANNED),void this.close()):r.code===at.K_VOS_FALLBACK&&"detail"in r?(A.info("[".concat(this.clientId,"] receive vos fallback notification: "),r.detail),r.detail==="FALLBACKCN"&&W("ENABLE_QUALITY_FALLBACK")?void or(this,Xe.VOS_FALLBACK_PROMISE,r.detail).then(()=>{this.reconnect("recover",i.desc)}).catch(a=>{A.debug("[".concat(this.clientId,"] cancel vos fallback cn, error: "),a)}):r.detail==="fallback_hls"&&W("ENABLE_FALLBACK_TO_HLS")?(this.emit(Xe.VOS_FALLBACK,r.detail),void this.close(Ut.FALLBACK_TO_HLS)):this.reconnect(i.action,i.desc)):void this.reconnect(i.action,Qr.SERVER_ERROR);A.error("[".concat(this.clientId,"] ignore error: "),i.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const r=W("PING_PONG_TIME_OUT"),i=Date.now();this.pingpongTimeoutCount>=r&&(A.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(i-this.lastMsgTime,"ms")),i-this.lastMsgTime>W("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Qr.TIMEOUT):this.request(nt.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-i;this.rttRolling.add(a),W("REPORT_STATS")&&this.send(nt.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleWsInflateData(){const{wsInflateLength:r,wsDeflateLength:i}=this.websocket.getWsInflateData();r!==0&&i!==0&&this.upload(rh.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:i,ws_inflate_length:r})}handleWebsocketEvents(){this.websocket.on(wt.RECONNECT_CREATE_CONNECTION,r=>{this.emit(Xe.WS_RECONNECT_CREATE_CONNECTION,r)}),this.websocket.on(wt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(wt.CLOSED,()=>{this.connectionState=Ft.CLOSED}),this.websocket.on(wt.FAILED,()=>{this._disconnectedReason=Ut.NETWORK_ERROR,this.connectionState=Ft.CLOSED}),this.websocket.on(wt.RECONNECTING,r=>{this._websocketReconnectReason=r,this.joinResponse=void 0,this.connectionState===Ft.CONNECTED?this.connectionState=Ft.RECONNECTING:this.connectionState=Ft.CONNECTING}),this.websocket.on(wt.WILL_RECONNECT,(r,i,a)=>{const l=Wu(this,Xe.IS_P2P_DISCONNECTED),u=l||r!=="retry";l&&r==="retry"&&(A.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),r="tryNext",i=w_.P2P_DISCONNECTED),u&&(A.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(r)),this.emit(Xe.REPORT_JOIN_GATEWAY,i||w_.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(Xe.DISCONNECT_P2P)),a(r)}),this.websocket.on(wt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(r=>{A.warning("[".concat(this.clientId,"] rejoin failed ").concat(r)),this.reconnect("tryNext",Qr.SERVER_ERROR)}):this.join().catch(r=>{if(this.emit(Xe.REPORT_JOIN_GATEWAY,r,this.url||""),r instanceof pe){if(r.code===K.UNEXPECTED_RESPONSE&&r.data.code===at.ERR_NO_AUTHORIZED)return this.initError=new pe(K.TOKEN_EXPIRE,"dynamic key expired"),void this.close(Ut.TOKEN_EXPIRE);A.error("[".concat(this.clientId,"] join gateway request failed"),r.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Qr.SERVER_ERROR):(this.initError=r,this.close())}})}),this.websocket.on(wt.REQUEST_NEW_URLS,(r,i)=>{or(this,Xe.REQUEST_RECOVER,this.multiIpOption).then(r).catch(i)}),this.websocket.on(wt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(vt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(fr.PRE_CONNECT_PC,()=>{this.emit(Xe.PRE_CONNECT_PC)}),this.websocket.on(wt.ON_FALLBACK,()=>{W("ENABLE_FALLBACK_TO_HLS")&&this.emit(Xe.VOS_FALLBACK,"fallback_hls")})}}let Tve=function(t){return t.NATIVE_RTC="native_rtc",t.NATIVE_RTM="native_rtm",t.WEB_RTC="web_rtc",t.WEB_RTM="web_rtm",t}({}),tr=function(t){return t[t.CHOOSE_SERVER=11]="CHOOSE_SERVER",t[t.CLOUD_PROXY=18]="CLOUD_PROXY",t[t.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",t[t.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",t}({});function P8(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function N_(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?P8(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):P8(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}let E1=0;function no(t){const r=W("TURN_DOMAINS");E1=(E1+1)%r.length;const i=r[E1]||"edge.agora.io";return t.match(/^[\.\:\d]+$/)?"".concat(t.replace(/[^\d]/g,"-"),".").concat(i):(A.debug("Cannot recognized as ip address: ".concat(t,", use as host2")),t)}function C_(t){try{const r=W("TURN_DOMAINS"),i=W("GATEWAY_DOMAINS").concat(r).find(a=>Ce(t).call(t,a));return i?t.split(".".concat(i))[0].replace(/-/g,"."):t}catch{return A.debug("serverUrlToIp error, fallback to url",t),t}}function w1(t,r){t.addresses||(t.addresses=[]);const i=function(m,g){if(W("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return m.map(S=>{let{ip:T,port:C}=S;return{address:"".concat(T,":").concat(C)}});const y=W("GATEWAY_DOMAINS");let x=y[1]&&Ce(g).call(g,y[1])?1:0;return m.map(S=>{let{domain_prefix:T,port:C,ip:V}=S;if(T)return{address:"".concat(T,".").concat(y[x++%y.length],":").concat(C)};const j=/^[\.\:\d]+$/.test(V),L=j?"".concat(V.replace(/[^\d]/g,"-"),".").concat(y[x++%y.length],":").concat(C):"".concat(V,":").concat(C);return j||A.debug("Cannot recognized as ip address: ".concat(V,", use as host3")),{ip:V,port:C,address:L}})}(t.addresses,r),a=Array.isArray(t.detail)&&t.detail[18];if(a&&typeof a=="string"){const m=a.split(";");for(let g=0;g<m.length;g++){var l;const y=Ii(l=m[g]).call(l);i[g]&&y&&(i[g].ip6=y)}}const u=t.detail&&t.detail.candidate;let p;if(u){const[m,g]=u.split(":");m&&g&&(p={port:Number(g),ip:m,address:"".concat(m,":").concat(g)})}return{gatewayAddrs:i,apGatewayAddress:p,uid:t.uid,cid:t.cid,cert:t.cert,vid:t.detail&&t.detail[8],uni_lbs_ip:t.detail&&t.detail[1],res:t,csIp:t.detail&&t.detail[502]}}function qi(t){return typeof t=="number"?t:t.exact||t.ideal||t.max||t.min||0}function k8(t){const r=t._encoderConfig;if(!r)return{};const i={resolution:r.width&&r.height?"".concat(qi(r.width),"x").concat(qi(r.height)):void 0,maxVideoBW:r.bitrateMax,minVideoBW:r.bitrateMin};return typeof r.frameRate=="number"?(i.maxFrameRate=r.frameRate,i.minFrameRate=r.frameRate):r.frameRate&&(i.maxFrameRate=r.frameRate.max||r.frameRate.ideal||r.frameRate.exact||r.frameRate.min,i.minFrameRate=r.frameRate.min||r.frameRate.ideal||r.frameRate.exact||r.frameRate.max),i}function R_(t){return t>=0&&t<.17?1:t>=.17&&t<.36?2:t>=.36&&t<.59?3:t>=.59&&t<=1?4:t>1?5:0}function R0(t,r){let i,a,l;switch(r){case tr.CHOOSE_SERVER:a=4096,l="choose server";break;case tr.CLOUD_PROXY:a=1048576,l="proxy";break;case tr.CLOUD_PROXY_5:a=4194304,l="proxy5";break;case tr.CLOUD_PROXY_FALLBACK:a=4194310,l="proxy fallback";break;default:throw new pe(K.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:t.detail&&t.detail[502],retry:!1})}if(t.response_body.forEach(u=>{u.buffer&&u.buffer.flag===a&&(i={code:u.buffer.code,addresses:(u.buffer.edges_services||[]).map(p=>N_(N_({},p),{},{ticket:u.buffer.cert})),server_ts:t.enter_ts,uid:u.buffer.uid,cid:u.buffer.cid,cname:u.buffer.cname,detail:N_(N_({},u.buffer.detail),t.detail),flag:u.buffer.flag,opid:t.opid,cert:u.buffer.cert})}),!i)throw new pe(K.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(l," from multi unilbs response"),{csIp:t.detail&&t.detail[502]});return i}async function j8(t,r){return await je.all(t.addresses.map(async i=>({address:no(i.ip),tcpport:i.port,udpport:i.port,username:r&&W("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?r.toString():Zr.username,password:r&&W("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await xA(r.toString()):Zr.password})))}function S1(t,r){const i=r.getMediaStreamTrack(!0).getSettings(),a=r.videoHeight||i.height,l=r.videoWidth||i.width;return a&&l?Math.max(Math.min(a,l)/Math.min(qi(t.height),qi(t.width)),1):(A.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function _d(t){let{candidateType:r,relayProtocol:i,type:a,address:l,port:u,protocol:p}=t;const m={candidateType:r,relayProtocol:i,protocol:p};if(a!=="local-candidate"){const g=l.split(".");g.length>=4&&(g[1]="*",g[2]="*"),m.address=g.join("."),m.port=u}return m}function Ac(t){const r=t.split(":"),i=t.split(/[-.]/),a=Ce(t).call(t,"-")?"-":".";let l=t;return r.length>1?i.length>1?(i[1]="**",l=i[0]+a+"**:"+r[r.length-1]):l=r.length>2?r[0]+a+"**:"+r[r.length-1]:"**:"+r[r.length-1]:i.length>1&&(l=i[0]+a+"**"),l}function D8(t,r){return t.getTransceivers().find(i=>i.sender.track===r||i.receiver.track===r)}function A0(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:W("SVC_MODE");if(W("ENABLE_SVC"))return function(r){return r in Qx}(t)?t:Qx.L1T3}const L8={[ze.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[ze.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function M8(t){t.send&&(xm(ze.VIDEO,t.send.videoExtensions),xm(ze.AUDIO,t.send.audioExtensions)),t.recv&&(xm(ze.VIDEO,t.recv.videoExtensions),xm(ze.AUDIO,t.recv.audioExtensions)),t.sendrecv&&(xm(ze.VIDEO,t.sendrecv.videoExtensions),xm(ze.AUDIO,t.sendrecv.audioExtensions))}function U8(t,r){t.send&&(A_(ze.VIDEO,t.send.videoExtensions,r.send.videoExtensions),A_(ze.AUDIO,t.send.audioExtensions,r.send.audioExtensions)),t.recv&&(A_(ze.VIDEO,t.recv.videoExtensions,r.recv.videoExtensions),A_(ze.AUDIO,t.recv.audioExtensions,r.recv.audioExtensions))}function A_(t,r,i){r.forEach(a=>{var l;const u=L8[t].find(m=>{var g;let{key:y}=m;return Ce(g=a.extensionName).call(g,y)});if(!u)return;const p=i.find(m=>{let{extensionName:g}=m;return Ce(g).call(g,u.key)});p&&Ce(l=p.extensionName).call(l,"gdpr_forbidden")&&(a.extensionName=p.extensionName)})}function xm(t,r){r.forEach(i=>{var a;const l=L8[t].find(u=>{var p;let{key:m}=u;return Ce(p=i.extensionName).call(p,m)});Ce(a=i.extensionName).call(a,"gdpr_forbidden")&&l&&(i.extensionName=l.extensionName)})}function F8(t){return t==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"||Ce(t).call(t,"abs-send-time")}function I_(t){return t==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"||Ce(t).call(t,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function V8(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function B8(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?V8(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):V8(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}function I0(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;const{filterRTX:l,filterVideoFec:u,filterAudioFec:p,filterAudioCodec:m,filterVideoCodec:g,unsupportedVideoUplinkCodec:y,unsupportedVideoDownlinkCodec:x}=r,{useXR:S}=i;let T=[],C=[],V=[],j=[],L=!1,H=!1;if(ki(t).mediaDescriptions.forEach(te=>{a&&a!==te.attributes.direction||(te.media.mediaType!=="video"||L||(C=te.attributes.payloads,j=te.attributes.extmaps,L=!0),te.media.mediaType!=="audio"||H||(T=te.attributes.payloads,V=te.attributes.extmaps,H=!0))}),!j||C.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!V||T.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(C.forEach(te=>{var se;(se=te.rtpMap)!==null&&se!==void 0&&se.clockRate&&(te.rtpMap.clockRate=parseInt(te.rtpMap.clockRate)),S&&te.rtcpFeedbacks.push({type:"rrtr"})}),T.forEach(te=>{var se;(se=te.rtpMap)!==null&&se!==void 0&&se.clockRate&&(te.rtpMap.clockRate=parseInt(te.rtpMap.clockRate)),S&&te.rtcpFeedbacks.push({type:"rrtr"})}),l&&(T=T.filter(te=>{var se;return((se=te.rtpMap)===null||se===void 0?void 0:se.encodingName.toLowerCase())!=="rtx"}),C=C.filter(te=>{var se;return((se=te.rtpMap)===null||se===void 0?void 0:se.encodingName.toLowerCase())!=="rtx"})),u){const te=C.filter(ne=>{var de;return/(red)|(ulpfec)|(flexfec)/i.test(((de=ne.rtpMap)===null||de===void 0?void 0:de.encodingName)||"")}),se=Ed(te,C).map(ne=>ne.payloadType),oe=[...te.map(ne=>ne.payloadType),...se];C=C.filter(ne=>!Ce(oe).call(oe,ne.payloadType))}if(p&&(T=T.filter(te=>{var se;return!/(red)|(ulpfec)|(flexfec)/i.test(((se=te.rtpMap)===null||se===void 0?void 0:se.encodingName)||"")})),m&&(m==null?void 0:m.length)>0&&(T=T.filter(te=>{var se;return Ce(m).call(m,((se=te.rtpMap)===null||se===void 0?void 0:se.encodingName.toLowerCase())||"")})),g&&(g==null?void 0:g.length)>0){const te=C.filter(se=>{var oe;return Ce(g).call(g,((oe=se.rtpMap)===null||oe===void 0?void 0:oe.encodingName.toLowerCase())||"")});C=te.concat(l?[]:Ed(te,C))}const Y=W("UNSUPPORTED_VIDEO_CODEC");if(Y&&Y.length>0){const te=C.filter(ne=>ne.rtpMap&&Ce(Y).call(Y,ne.rtpMap.encodingName.toLowerCase())),se=Ed(te,C),oe=te.concat(se).map(ne=>ne.payloadType);C=C.filter(ne=>!Ce(oe).call(oe,ne.payloadType)),A.debug("unsupportedVideoCodec: ".concat(Y,", toBeRemoved: ").concat(oe))}if(y&&y.length>0&&a==="sendonly"){const te=C.filter(ne=>ne.rtpMap&&Ce(y).call(y,ne.rtpMap.encodingName.toLowerCase())),se=Ed(te,C),oe=te.concat(se).map(ne=>ne.payloadType);C=C.filter(ne=>!Ce(oe).call(oe,ne.payloadType)),A.debug("unsupportedVideoUplinkCodec: ".concat(y,", toBeRemoved: ").concat(oe))}if(x&&x.length>0&&a==="recvonly"){const te=C.filter(ne=>ne.rtpMap&&Ce(x).call(x,ne.rtpMap.encodingName.toLowerCase())),se=Ed(te,C),oe=te.concat(se).map(ne=>ne.payloadType);C=C.filter(ne=>!Ce(oe).call(oe,ne.payloadType)),A.debug("unsupportedVideoDownlinkCodec: ".concat(x,", toBeRemoved: ").concat(oe))}return{audioCodecs:T,videoCodecs:C,audioExtensions:V,videoExtensions:j}}function Ic(t){const r=ki(t);let i,a;for(const l of r.mediaDescriptions){if(!i){const u=l.attributes.iceUfrag,p=l.attributes.icePwd;if(!u||!p)throw new Error("Cannot get iceUfrag or icePwd from SDP.");i={iceUfrag:u,icePwd:p}}if(!a){const u=l.attributes.fingerprints;u.length>0&&(a={fingerprints:u})}}if(!a&&r.attributes.fingerprints.length>0&&(a={fingerprints:r.attributes.fingerprints}),!a||!i)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:i,dtlsParameters:a}}function T1(t,r){const i=[],a=t.attributes.ssrcGroups.filter(p=>p.semantic==="FID"),l=t.attributes.ssrcGroups.find(p=>p.semantic==="SIM"),u=t.attributes.ssrcs;if(l)l.ssrcIds.forEach(p=>{var m;const g=(m=a.find(y=>y.ssrcIds[0]===p))===null||m===void 0?void 0:m.ssrcIds[1];i.push({ssrcId:p,rtx:r?g:void 0})});else if(a.length>0){const p=a[0].ssrcIds[0],m=a[0].ssrcIds[1];i.push({ssrcId:p,rtx:r?m:void 0})}else{if(u.length===0)throw new Error("No ssrcs found on local media description.");i.push({ssrcId:u[0].ssrcId})}return i}function G8(t,r,i){const{cname:a}=t;let l=[];r&&(l=W8(r)),l.length===0&&(l=t.iceParameters.candidates.map(x=>({foundation:x.foundation,componentId:"1",transport:x.protocol,priority:x.priority.toString(),connectionAddress:x.ip,port:x.port.toString(),type:x.type,extension:{}})),A.debug("Using candidates from gateway."));const u={fingerprints:t.dtlsParameters.fingerprints.map(x=>({hashFunction:x.algorithm,fingerprint:x.fingerprint}))},p={iceUfrag:t.iceParameters.iceUfrag,icePwd:t.iceParameters.icePwd};let m;switch(t.dtlsParameters.role){case"server":m="passive";break;case"client":m="active";break;case"auto":m="actpass"}const g=P0(t.rtpCapabilities),y=[];return Array.isArray(i)&&i.length>0&&i.forEach(x=>{y.push({kind:ze.VIDEO,ssrcMsg:[{ssrcId:x.v,rtx:x.v_rtx}],mslabel:"".concat(x.v,"_").concat(x.a)},{kind:ze.AUDIO,ssrcMsg:[{ssrcId:x.a}],mslabel:"".concat(x.v,"_").concat(x.a)})}),{dtlsParameters:u,iceParameters:p,candidates:l,rtpCapabilities:g,setup:m,cname:a,preSSRCs:y}}function W8(t){let r=[];return t.ip&&typeof t.port=="number"&&(r=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip,port:t.port.toString(),type:"host",extension:{}}],A.debug("Using remote candidate from AP ".concat(Ac(t.ip),":").concat(t.port)),t.ip6&&(r.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip6,port:t.port.toString(),type:"host",extension:{}}),A.debug("Using IPV6 remote candidate from AP ".concat(Ac(t.ip6),":").concat(t.port)))),r}function O0(t,r,i){const a=[],l=[];return t.forEach(u=>{let{ssrcId:p,rtx:m}=u;const g=tn(8,"track-"),y={ssrcId:p,attributes:B8({label:g,mslabel:i=i||tn(10,""),msid:"".concat(i," ").concat(g)},r&&{cname:r})};if(a.push(y),m!==void 0){const x={ssrcId:m,attributes:B8({label:g,mslabel:i,msid:"".concat(i," ").concat(g)},r&&{cname:r})};a.push(x),l.push({semantic:"FID",ssrcIds:[p,m]})}}),t.length>1&&l.push({semantic:"SIM",ssrcIds:t.map(u=>{let{ssrcId:p}=u;return p})}),{ssrcs:a,ssrcGroups:l}}function sh(t,r){r instanceof $n&&t.attributes.payloads.forEach(i=>{var a;const l=(a=i.rtpMap)===null||a===void 0?void 0:a.encodingName.toLowerCase();if(!l||["opus","pcmu","pcma","g722"].indexOf(l)===-1)return;i.fmtp||(i.fmtp={parameters:{}}),l==="opus"&&typeof W("OPUS_PTIME")=="number"?i.fmtp.parameters.ptime=W("OPUS_PTIME"):i.fmtp.parameters.minptime="10",i.fmtp.parameters.useinbandfec="1";const u=r._encoderConfig;u&&(l!=="pcmu"&&l!=="pcma"&&l!=="g722"&&(u.bitrate&&!wn()&&(i.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*u.bitrate))),u.sampleRate&&(i.fmtp.parameters.maxplaybackrate="".concat(u.sampleRate),i.fmtp.parameters["sprop-maxcapturerate"]="".concat(u.sampleRate)),u.stereo&&(i.fmtp.parameters.stereo="1",i.fmtp.parameters["sprop-stereo"]="1")),r instanceof T0&&l==="opus"&&r._config.DTX&&(i.fmtp.parameters.usedtx="1"))})}function N1(t){const r=t.attributes.unrecognized.findIndex(i=>i.attField==="x-google-flag"&&i.attValue==="conference");r!==-1&&t.attributes.unrecognized.splice(r,1)}function C1(t,r){var i;if(t.attributes.payloads.forEach(l=>{var u;((u=l.rtpMap)===null||u===void 0?void 0:u.encodingName.toLowerCase())==="h264"&&l.fmtp&&l.fmtp.parameters&&W("ENABLE_UP_SPS_PPS")&&(l.fmtp.parameters["sps-pps-idr-in-keyframe"]="1")}),!(r instanceof pn&&r._encoderConfig&&r._hints.indexOf(Zt.SCREEN_TRACK)===-1))return;const a=r._encoderConfig;jt().supportMinBitrate&&a.bitrateMin&&t.attributes.payloads.forEach(l=>{var u,p;Ce(u=["h264","h265","vp8","vp9","av1"]).call(u,((p=l.rtpMap)===null||p===void 0?void 0:p.encodingName.toLowerCase())||"")&&(l.fmtp||(l.fmtp={parameters:{}}),l.fmtp.parameters["x-google-min-bitrate"]="".concat(a.bitrateMin))}),jt().supportMinBitrate&&!Ce(i=r._hints).call(i,Zt.LOW_STREAM)&&a.bitrateMax&&t.attributes.payloads.forEach(l=>{var u,p;Ce(u=["h264","h265","vp8","vp9","av1"]).call(u,((p=l.rtpMap)===null||p===void 0?void 0:p.encodingName.toLowerCase())||"")&&(l.fmtp||(l.fmtp={parameters:{}}),l.fmtp.parameters["x-google-start-bitrate"]="".concat(W("X_GOOGLE_START_BITRATE")||Math.floor(a.bitrateMax)))})}function $8(t){if(t.media.mediaType!=="video")return;const r=Ht();if(r.name!==Yt.SAFARI&&r.os!==_r.IOS)return;const i=t.attributes.extmaps.findIndex(a=>/video-orientation/g.test(a.extensionName));i!==-1&&t.attributes.extmaps.splice(i,1)}function O_(t,r,i){if(!r)return;let a,l;if(t.media.mediaType==="video"?(a=i.videoExtensions,l=i.videoCodecs):(a=i.audioExtensions,l=i.audioCodecs),r.twcc===!0){const u=a.find(p=>I_(p.extensionName));if(u){const p=u.extensionName;t.attributes.extmaps.find(g=>I_(g.extensionName))||t.attributes.extmaps.push({entry:u.entry,extensionName:p}),function(g,y){return y.filter(x=>!!g.find(S=>S.payloadType===x.payloadType&&!!S.rtcpFeedbacks.find(T=>T.type==="transport-cc")))}(l,t.attributes.payloads).forEach(g=>{g.rtcpFeedbacks.find(y=>y.type==="transport-cc")||g.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(r.twcc===!1){const u=t.attributes.extmaps.findIndex(p=>I_(p.extensionName));u!==-1&&t.attributes.extmaps.splice(u,1),t.attributes.payloads.forEach(p=>{const m=p.rtcpFeedbacks.findIndex(g=>g.type==="transport-cc");m!==-1&&p.rtcpFeedbacks.splice(m,1)})}if(r.remb===!0){const u=a.find(p=>F8(p.extensionName));if(u){const p=u.extensionName;t.attributes.extmaps.find(g=>g.extensionName===p)||t.attributes.extmaps.push({entry:u.entry,extensionName:p}),function(g,y){return y.filter(x=>!!g.find(S=>S.payloadType===x.payloadType&&!!S.rtcpFeedbacks.find(T=>T.type==="goog-remb")))}(l,t.attributes.payloads).forEach(g=>{g.rtcpFeedbacks.find(y=>y.type==="goog-remb")||g.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(r.remb===!1){const u=t.attributes.extmaps.findIndex(p=>F8(p.extensionName));u!==-1&&t.attributes.extmaps.splice(u,1),t.attributes.payloads.forEach(p=>{const m=p.rtcpFeedbacks.findIndex(g=>g.type==="goog-remb");m!==-1&&p.rtcpFeedbacks.splice(m,1)})}}function R1(t,r,i){if(wn()||t.media.mediaType!=="video"||!(r instanceof pn)||i!=="vp9"&&i!=="vp8"||i==="vp8"&&!W("SIMULCAST")||i==="vp9"&&W("ENABLE_SVC")||r._scalabilityMode===void 0||r._scalabilityMode.numSpatialLayers<=1)return;const a=i==="vp8"?2:r._scalabilityMode.numSpatialLayers,l=t.attributes.ssrcs[0],u=t.attributes.ssrcGroups.find(m=>m.semantic==="FID"&&m.ssrcIds[0]===l.ssrcId),p={semantic:"SIM",ssrcIds:[l.ssrcId]};for(let m=1;m<a;m++)t.attributes.ssrcs.push({ssrcId:l.ssrcId+m,attributes:Sn(l.attributes)}),p.ssrcIds.push(l.ssrcId+m),u&&(t.attributes.ssrcs.push({ssrcId:u.ssrcIds[1]+m,attributes:Sn(l.attributes)}),t.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[l.ssrcId+m,u.ssrcIds[1]+m]}));t.attributes.ssrcGroups.unshift(p)}async function z8(){try{const t=new RTCPeerConnection;t.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:Qx.L1T3}]});const r=await t.createOffer();if(!r.sdp)return void t.close();const i=ki(r.sdp).mediaDescriptions[0];if(!i)return;const a=i.attributes.extmaps.find(l=>l.extensionName==="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension");return t.close(),a}catch{return}}async function A1(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=new RTCPeerConnection;i.addTransceiver("video",{direction:"sendonly"}),i.addTransceiver("audio",{direction:"sendonly"}),i.addTransceiver("video",{direction:"recvonly"}),i.addTransceiver("audio",{direction:"recvonly"});const a=(await i.createOffer()).sdp,{send:l,recv:u,sendrecv:p}=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2?arguments[2]:void 0;const x=I0(y,m,g,"sendonly"),S=I0(y,m,g,"recvonly"),T={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},C={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},V={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ro(x,S,"videoExtensions",T,C,V),ro(x,S,"videoCodecs",T,C,V),ro(x,S,"audioExtensions",T,C,V),ro(x,S,"audioCodecs",T,C,V),W("RAISE_H264_BASELINE_PRIORITY")){const j=[],L=[];if(V.videoCodecs.forEach((H,Y)=>{var te;if(((te=H.rtpMap)===null||te===void 0?void 0:te.encodingName.toLocaleLowerCase())==="h264"){var se,oe;const ne=V.videoCodecs[Y+1],de=ne&&q8(H,ne),be=(se=H.fmtp)===null||se===void 0?void 0:se.parameters["profile-level-id"],Se=(oe=H.fmtp)===null||oe===void 0?void 0:oe.parameters["packetization-mode"];!be||be!==W("FIRST_H264_PROFILE_LEVEL_ID")||W("FIRST_PACKETIZATION_MODE")&&Se!==W("FIRST_PACKETIZATION_MODE")?de?L.push([H,ne]):L.push([H]):de?j.push([H,ne]):j.push([H])}}),j.length>0&&L.length>0){A.debug("raising H264 baseline profile priority"),V.videoCodecs.forEach((Y,te)=>{var se;if(((se=Y.rtpMap)===null||se===void 0?void 0:se.encodingName.toLocaleLowerCase())==="h264"){const oe=q8(Y,V.videoCodecs[te+1]),ne=j.shift()||L.shift()||[];ne.length>0&&(oe?V.videoCodecs.splice(te,2,...ne):V.videoCodecs.splice(te,1,...ne))}});const H=C.videoCodecs.filter(Y=>{var te,se;return((te=Y.rtpMap)===null||te===void 0?void 0:te.encodingName.toLocaleLowerCase())==="h264"&&((se=Y.fmtp)===null||se===void 0?void 0:se.parameters["profile-level-id"])!==W("FIRST_H264_PROFILE_LEVEL_ID")});if(H.length>0){const Y=Ed(H,C.videoCodecs).map(se=>se.payloadType),te=[...H.map(se=>se.payloadType),...Y];C.videoCodecs=C.videoCodecs.filter(se=>!Ce(te).call(te,se.payloadType))}W("FILTER_SEND_H264_BASELINE")&&(T.videoCodecs=T.videoCodecs.filter(Y=>{var te,se;return!(((te=Y.rtpMap)===null||te===void 0?void 0:te.encodingName.toLocaleLowerCase())==="h264"&&((se=Y.fmtp)===null||se===void 0?void 0:se.parameters["profile-level-id"])!==W("FIRST_H264_PROFILE_LEVEL_ID"))}))}return{send:T,recv:C,sendrecv:V}}return{send:T,recv:C,sendrecv:V}}(t,r,a);try{i.close()}catch{}return{send:l,recv:u,sendrecv:p}}function H8(){const t={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},r=I0(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ro(t,r,"videoExtensions",i,a,l),ro(t,r,"videoCodecs",i,a,l),ro(t,r,"audioExtensions",i,a,l),ro(t,r,"audioCodecs",i,a,l),W("RAISE_H264_BASELINE_PRIORITY")){const u=l.videoCodecs.findIndex(p=>p.rtpMap&&p.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&p.fmtp&&p.fmtp.parameters["profile-level-id"]==="42001f");if(u!==-1){const p=l.videoCodecs.findIndex(m=>m.rtpMap&&m.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(p<u){A.debug("raising H264 baseline profile priority");const m=l.videoCodecs[u];l.videoCodecs.splice(u,1),l.videoCodecs.splice(p,0,m)}p!==-1&&(a.videoCodecs=a.videoCodecs.filter(m=>!(m.rtpMap&&m.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&m.fmtp&&m.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:i,recv:a,sendrecv:l}}function ro(t,r,i,a,l,u){if(i==="videoExtensions"||i==="audioExtensions"){const p=[];return t[i].forEach(m=>{r[i].some((g,y)=>{if(m.entry===g.entry&&m.extensionName===g.extensionName)return p.push(y),!0})?u[i].push(m):a[i].push(m)}),void r[i].forEach((m,g)=>{p.indexOf(g)===-1&&l[i].push(m)})}if(i==="videoCodecs"||i==="audioCodecs"){const p=[];return t[i].forEach(m=>{r[i].some((g,y)=>{if(m.payloadType===g.payloadType&&JSON.stringify(m)===JSON.stringify(g))return p.push(y),!0})?u[i].push(m):a[i].push(m)}),void r[i].forEach((m,g)=>{p.indexOf(g)===-1&&l[i].push(m)})}}function P0(t){const{send:r,recv:i,sendrecv:a}=t;if(!a){if(!r||!i)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:r,recv:i}}let l,u;return r?(l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l.audioCodecs=[...r.audioCodecs,...a.audioCodecs],l.videoCodecs=[...r.videoCodecs,...a.videoCodecs],l.audioExtensions=[...r.audioExtensions,...a.audioExtensions],l.videoExtensions=[...r.videoExtensions,...a.videoExtensions]):l=Sn(a),i?(u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u.audioCodecs=[...i.audioCodecs,...a.audioCodecs],u.videoCodecs=[...i.videoCodecs,...a.videoCodecs],u.audioExtensions=[...i.audioExtensions,...a.audioExtensions],u.videoExtensions=[...i.videoExtensions,...a.videoExtensions]):u=Sn(a),{send:l,recv:u}}function _m(t){t.media.mediaType==="audio"&&t.attributes.payloads.filter(r=>{var i;return((i=r.rtpMap)===null||i===void 0?void 0:i.encodingName.toLowerCase())==="opus"}).forEach(r=>{r.fmtp||(r.fmtp={parameters:{}}),r.fmtp.parameters.stereo="1",r.fmtp.parameters["sprop-stereo"]="1"})}function k0(t,r,i,a){let l=[];if(t===ze.VIDEO){if(W("H264_PROFILE_LEVEL_ID")&&a==="h264"&&(l=r.videoCodecs.filter(u=>{var p;return Ce(p=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(p,a)&&u&&u.fmtp&&u.fmtp.parameters["profile-level-id"]===W("H264_PROFILE_LEVEL_ID")})),!Array.isArray(l)||l.length===0){let u=[];const p=[],m=[],g=[];if(i.videoCodecs.forEach(y=>{const x=y.rtpMap&&y.rtpMap.encodingName.toLowerCase()||"";Ce(x).call(x,a)?u.push(y):Ce(x).call(x,"vp9")?p.push(y):Ce(x).call(x,"vp8")?m.push(y):Ce(x).call(x,"h264")&&g.push(y)}),u.length===0){let y="";p.length!==0?(u=p,y="vp9"):m.length!==0?(u=m,y="vp8"):g.length!==0&&(u=g,y="h264"),A.warning("codec ".concat(a," not included in rtpCapabilities, fallback to default payloads: ").concat(y))}u.length!==0&&(l=r.videoCodecs.filter(y=>u.some(x=>x.payloadType===y.payloadType)))}if(l.length===0&&(A.warning("codec ".concat(a," not included in rtpCapabilities, fallback to default payloads: ").concat(r.videoCodecs[0].rtpMap&&r.videoCodecs[0].rtpMap.encodingName)),l=r.videoCodecs),W("USE_PUB_RTX")||W("USE_SUB_RTX")){const u=Ed(l,r.videoCodecs);l=[...l,...u]}}else{l=r.audioCodecs.filter(p=>{var m;return Ce(m=p.rtpMap&&p.rtpMap.encodingName.toLowerCase()||"").call(m,a)});const u=r.audioCodecs.filter(p=>{var m;return Ce(m=p.rtpMap&&p.rtpMap.encodingName.toLowerCase()||"").call(m,"red")});l.length===0&&(A.warning("codec ".concat(a," not included in rtpCapabilities, fallback to opus")),l=r.audioCodecs.filter(p=>{var m;return Ce(m=p.rtpMap&&p.rtpMap.encodingName.toLowerCase()||"").call(m,"opus")})),W("ENABLE_AUDIO_RED")&&u.length!==0&&(l=[...u,...l])}return l}function Ed(t,r){const i=t.map(a=>a.payloadType.toString());return r.filter(a=>a.rtpMap&&a.rtpMap.encodingName==="rtx"&&a.fmtp&&a.fmtp.parameters.apt&&Ce(i).call(i,a.fmtp&&a.fmtp.parameters.apt))}async function ds(t,r,i){const a=r.toString(),l=K8(a,"offer","remote","exchangeSDP");await t.setRemoteDescription({type:"offer",sdp:a});const u=await t.createAnswer();if(!u.sdp)throw new Error("cannot get answer sdp");let p=u.sdp;p=I1(p,i||{}),l==null||l(p||""),await t.setLocalDescription({type:"answer",sdp:p})}function I1(t,r,i){if(W("FORBID_MODIFY_LOCAL_OFFER_SDP"))return t;const a=ki(t),{useXR:l}=r;return a.mediaDescriptions.forEach(u=>{var p;u.attributes.mid&&(Array.isArray(i)&&!Ce(i).call(i,u.attributes.mid)||(u.media.mediaType==="audio"&&_m(u),u.media.mediaType==="video"&&function(m){m.media.mediaType==="video"&&W("ENABLE_DOWN_SPS_PPS")&&m.attributes.payloads.filter(g=>{var y;return((y=g.rtpMap)===null||y===void 0?void 0:y.encodingName.toLowerCase())==="h264"}).forEach(g=>{g.fmtp||(g.fmtp={parameters:{}}),g.fmtp.parameters["sps-pps-idr-in-keyframe"]="1"})}(u),l&&Ce(p=["audio","video"]).call(p,u.media.mediaType)&&u.attributes.payloads.forEach(m=>{m.rtcpFeedbacks.findIndex(g=>g.type==="rrtr")===-1&&m.rtcpFeedbacks.push({type:"rrtr"})})))}),pl(a)}function K8(t,r,i,a){if(W("SDP_LOGGING"))return A.upload("exchanging ".concat(i," ").concat(r," SDP during P2PConnection.").concat(a,`
`),t),r==="offer"?l=>{K8(l,"answer",i==="local"?"remote":"local",a)}:void 0}async function Y8(t,r,i){try{var a;if(!jt().supportSetRtpSenderParameters||!function(g){return g==="vp9"||g==="av1"}(t)||!W("ENABLE_SVC"))return;const l={},u={},p=r.getParameters(),m=(a=p.encodings)===null||a===void 0?void 0:a[0];u.scalabilityMode=A0(i),m&&Object.assign(m,u),Object.assign(p,l),await r.setParameters(p),A.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(p.encodings)))}catch(l){A.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",l)}}function P_(t){const r=W("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(r)&&r.length>0)&&r.some(i=>Ce(t).call(t,i))}function q8(t,r){try{var i;return((i=t.fmtp)===null||i===void 0?void 0:i.parameters.apt)===r.payloadType.toString()}catch{return!1}}function X8(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function Os(t,r){return typeof W(t)===r?W(t):void 0}function Nve(){try{const t=W("EXPERIMENTS")||{};return typeof t=="string"||Array.isArray(t)?{}:function(r){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?X8(Object(a),!0).forEach(function(l){F(r,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):X8(Object(a)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(a,l))})}return r}({},t)}catch(t){return A.debug("handle gateway attributes failed: ",t),{}}}const J8={};function Oc(t){(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&A.debug("install service ".concat(t.name)),J8[t.name]=t}function Wo(t){const r=J8[t];if(!r)throw new ge(K.INVALID_OPERATION,"".concat(t," not found, please use AgoraRTC.use(").concat(t,"Service) to load it first"));return r}function Q8(t,r){return Wo("DataStream").create(t,r)}function k_(){return Wo("InterceptFrame").create()}function Z8(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function Lr(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?Z8(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Z8(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}const O1=new Map;class Cve extends Pn{get state(){return this._state}set state(r){if(r===this._state)return;const i=this._state;this._state=r,r==="DISCONNECTED"&&this._disconnectedReason?this.emit(qn.CONNECTION_STATE_CHANGE,r,i,this._disconnectedReason):this.emit(qn.CONNECTION_STATE_CHANGE,r,i)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(r){A.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(r)),this._joinGatewayStartTime=r}constructor(r,i){var a,l,u;super(),F(this,"store",void 0),F(this,"joinInfo",void 0),F(this,"key",void 0),F(this,"ntpOffset",0),F(this,"usingProxy",!1),F(this,"signal",void 0),F(this,"role",void 0),F(this,"isPreallocation",void 0),F(this,"isPreSub",void 0),F(this,"inChannelInfo",{joinAt:null,duration:0}),F(this,"spec",void 0),F(this,"_state","DISCONNECTED"),F(this,"_statsCollector",void 0),F(this,"_disconnectedReason",void 0),F(this,"isSignalRecover",!1),F(this,"hasChangeBGPAddress",!1),F(this,"trafficStatsInterval",void 0),F(this,"networkQualityInterval",void 0),F(this,"_joinGatewayStartTime",0),F(this,"_signalTimeout",!1),F(this,"_clientRoleOptions",void 0),F(this,"_isProactiveJoin",!1),this.store=r,this.spec=i,this.signal=this.store.useP2P?(a={spec:Lr(Lr({},i),{},{retryConfig:i.websocketRetryConfig}),store:r},(l=(u=Wo("P2PChannel")).createSubmodule)===null||l===void 0?void 0:l.call(u,a)):this.store.useDcSignal?function(p){return Wo("DataChannelSignal").create(p)}({spec:Lr(Lr({},i),{},{retryConfig:i.websocketRetryConfig}),store:r}):new O8(Lr(Lr({},i),{},{retryConfig:i.websocketRetryConfig}),r),this._statsCollector=i.statsCollector,this.role=i.role||"audience",this._clientRoleOptions=i.clientRoleOptions,this.handleSignalEvents()}setUsingProxy(r){this.usingProxy=r}async join(r,i,a){if(this.store.useDcSignal){let x=!1;r.cloudProxyServer!=="disabled"?(A.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(r.cloudProxyServer,")")),x=!0):"".concat(r.apResponse.cid,"_").concat(r.apResponse.cert).length>255||"".concat(r.apResponse.cid,"_").concat(r.apResponse.cert).length<22?(A.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),x=!0):r.apResponse.addresses.some(S=>S.fingerprint)||W("FINGERPRINT")||(A.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),x=!0),x&&this.resetSignal()}this.store.joinGatewayStart(),r.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const l=Date.now();let u=O1.get(r.cname);if(u||(u=new Map,O1.set(r.cname,u)),this._isProactiveJoin=!0,u.has(r.uid)){const x=new pe(K.UID_CONFLICT);throw Ye.joinGateway(r.sid,{lts:l,succ:!1,ec:x.code,addr:null,uid:r.uid,cid:r.cid,firstSuccess:this._isProactiveJoin,isProxy:!!r.proxyServer||this.usingProxy,signalChannel:this.store.useDcSignal?"1":"0",preload:r.preload}),x}u.set(r.uid,!0),this.joinInfo=r,this.key=i;let p=0;this.joinGatewayStartTime=l;const m=r.proxyServer,g=this.store.useDcSignal?"datachannel":"websocket";try{A.debug("[".concat(this.store.clientId,"] use ").concat(g," join uid ").concat(p));const x=r.gatewayAddrs.map(T=>{let{address:C}=T;const[V,j]=C.split(":"),L={host:V,port:j};return r.proxyServer&&(L.proxy=r.proxyServer),L});let S;S=this.store.useDcSignal?await this.signal.init(r.apResponse.addresses):await this.signal.init(x),p=S.uid,A.debug("[".concat(this.store.clientId,"] ").concat(g," join uid ").concat(p," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(x){var y;throw x.code===K.INIT_DATACHANNEL_TIMEOUT&&this.signal.__name__==="AgoraRTCSignal"||Ye.joinGateway(r.sid,{lts:l,succ:!1,ec:((y=x.data)===null||y===void 0?void 0:y.desc)||x.code,errorMsg:x.message,addr:this.signal.url,uid:r.uid,cid:r.cid,firstSuccess:this._isProactiveJoin,isProxy:!!m||this.usingProxy,signalChannel:this.signal.__name__==="DataChannelSignal"?"1":"0",preload:r.preload}),x&&x.code===K.INIT_DATACHANNEL_TIMEOUT?(A.warning("[".concat(this.store.clientId,"] User join datachannel failed"),x.toString()),this.resetSignal(),x):(A.error("[".concat(this.store.clientId,"] User join failed"),x.toString()),u.delete(r.uid),this.signal.close(),x)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),A.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(x=>{A.warning("[".concat(this.store.clientId,"] get traffic stats error"),x.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(qn.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(qn.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(qn.NETWORK_QUALITY,{uplinkNetworkQuality:R_(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:R_(this._statsCollector.trafficStats.B_dnq)}):this.emit(qn.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),p}async leave(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],i=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){i!==Ut.FALLBACK&&(this.state="DISCONNECTING");try{r||this.signal.connectionState!==Ft.CONNECTED||await function(a,l){return l===1/0?a:je.race([a,e0e(l)])}(this.signal.request(nt.LEAVE,void 0,!0),3e3)}catch(a){A.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),a)}this.signal.close(i),i!==Ut.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(r,i,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const l={state:"offer",p2p_id:this.store.p2pId,ortc:i,mode:this.spec.mode,extend:W("PUB_EXTEND"),twcc:!!W("PUBLISH_TWCC"),rtx:!!W("USE_PUB_RTX")};try{return(await this.signal.request(nt.PUBLISH,l,!0))._message}catch(u){if(a&&u.data&&u.data.code===at.ERR_PUBLISH_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),u.toString()),await this.tryUnpubBeforeRepub(r,i),this.publish(r,i,!1);throw u}}async publishDataChannel(r,i,a){var l;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const u={stream_id:i.streamId,ordered:i.ordered?1:0,max_retrans_times:(l=i.maxRetransmits)!==null&&l!==void 0?l:10,channel_id:i.channelId,metadata:i.metadata};try{await this.signal.request(nt.PUBLISH_DATASTREAM,u,!0)}catch(p){if(a&&p.data&&p.data.code===at.ERR_PUBLISH_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),p.toString()),await this.tryUnpubDataChannelBeforeRepub(r,i),this.publishDataChannel(r,i,!1);throw p}}async unpublish(r,i){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(nt.UNPUBLISH,{stream_id:i,ortc:r},!0)}catch(a){A.warning("[".concat(this.store.clientId,"] unpublish warning: "),a)}}async unpublishDataChannel(r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await je.all(r.map(i=>this.signal.request(nt.UNPUBLISH_DATASTREAM,{channel_id:i},!0)))}catch(i){A.warning("unpublish datachannels warning: ",i)}}async presubscribe(r,i,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const l={stream_id:r,stream_type:i,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!W("SUBSCRIBE_TWCC"),rtx:!!W("USE_SUB_RTX")||void 0,extend:W("SUB_EXTEND"),svc:Array.isArray(W("SVC"))&&W("SVC").length!==0?W("SVC"):void 0};try{return await this.signal.request(nt.PRE_SUBSCRIBE,l,!0)}catch(u){if(a&&u.data&&u.data.code===at.ERR_SUBSCRIBE_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),u.toString()),this.presubscribe(r,i,!1);throw u}}async subscribe(r,i,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const l={stream_id:r,stream_type:i.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!W("SUBSCRIBE_TWCC"),rtx:!!W("USE_SUB_RTX"),extend:W("SUB_EXTEND"),ssrcId:i.ssrcId,svc:Array.isArray(W("SVC"))&&W("SVC").length!==0?W("SVC"):void 0};try{return(await this.signal.request(nt.SUBSCRIBE,l,!0))._message}catch(u){if(a&&u.data&&u.data.code===at.ERR_SUBSCRIBE_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),u.toString()),await this.tryUnsubBeforeResub(r,i),await this.subscribe(r,i,!1);throw u}}async subscribeDataChannel(r,i,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const l={uid:r,stream_id:i.id,channel_id:i.datachannelId};try{return void await this.signal.request(nt.SUBSCRIBE_DATASTREAM,l,!0)}catch(u){if(a&&u.data&&u.data.code===at.ERR_SUBSCRIBE_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),u.toString()),await this.tryUnsubDataChannelBeforeResub(r,i),await this.subscribeDataChannel(r,i,!1);throw u}}async subscribeAll(r,i){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const a={p2p_id:this.store.p2pId,users:r,dtx:!1,rtx:!!W("USE_SUB_RTX"),twcc:!!W("SUBSCRIBE_TWCC"),svc:Array.isArray(W("SVC"))&&W("SVC").length!==0?W("SVC"):void 0};try{return await this.signal.request(nt.SUBSCRIBE_STREAMS,a,!0)}catch(l){if(i&&l.data&&l.data.code===at.ERR_SUBSCRIBE_REQUEST_INVALID)return A.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),l.toString()),await this.tryMassUnsubBeforeResub(r),await this.subscribeAll(r,!1);throw l}}async setVideoProfile(r){const i=function(a){if(!(a.bitrateMax&&a.bitrateMin&&a.frameRate&&a.height&&a.width))return;let l=a.frameRate,u=a.width,p=a.height,m=!0;return typeof l!="number"&&(l=l.exact||l.ideal||l.max||l.min||0,l||(m=!1)),typeof u!="number"&&(u=u.exact||u.ideal||u.max||u.min||0,u||(m=!1)),typeof p!="number"&&(p=p.exact||p.ideal||p.max||p.min||0,l||(m=!1)),m?{stream_type:0,width:u,height:p,fps:l,start_bps:1e3*a.bitrateMax,min_bps:1e3*a.bitrateMin,target_bps:1e3*a.bitrateMax}:void 0}(r);if(i)return this.signal.request(nt.SET_VIDEO_PROFILE,i);A.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(r,i){try{await this.signal.request(nt.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:r,stream_id:i},!0)}catch(a){A.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),a)}}async unsubscribeDataChannel(r,i){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await je.all(r.map(a=>this.signal.request(nt.UNSUBSCRIBE_DATASTREAM,{stream_id:a,uid:i},!0)))}catch(a){A.warning("unsubscribeDataChannel warning: ",a)}}async massUnsubscribe(r){try{await this.signal.request(nt.UNSUBSCRIBE_STREAMS,r,!0)}catch(i){A.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),i)}}async reconnectPC(r){const{iceParameters:i,dtlsParameters:a,rtpCapabilities:l}=r;return{gatewayEstablishParams:await this.signal.request(nt.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:i,dtlsParameters:a,rtpCapabilities:l}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(nt.GATEWAY_INFO)}async renewToken(r){await this.signal.request(nt.RENEW_TOKEN,r),this.key=r.token}updateClientRole(r,i){i&&(this._clientRoleOptions=Object.assign({},i)),W("CLIENT_ROLE_OPTIONS")&&(A.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(W("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},W("CLIENT_ROLE_OPTIONS"))),this.role=r}async setClientRole(r,i){if(i&&(this._clientRoleOptions=Object.assign({},i)),W("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},W("CLIENT_ROLE_OPTIONS")),A.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(W("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),this.state!=="CONNECTED")return void(this.role=r);let a,l=0;r==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(a=this._clientRoleOptions.delay,l=1):l=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:l=0;const u=Object.assign({},i);delete u.delay,delete u.level,await this.signal.request(nt.SET_CLIENT_ROLE,Lr(Lr({role:r,level:l,delay:a},u),{},{client_ts:Date.now()})),this.role=r}async setDualStreamMode(r,i,a){await this.signal.request(nt.SET_DUAL_STREAM_MODE,{mode:r},a,i)}async setRemoteVideoStreamType(r,i){await this.signal.request(nt.SWITCH_VIDEO_STREAM,{stream_id:r,stream_type:i})}async setDefaultRemoteVideoStreamType(r){await this.signal.request(nt.DEFAULT_VIDEO_STREAM,{stream_type:r})}async setStreamFallbackOption(r,i){await this.signal.request(nt.SET_FALLBACK_OPTION,{stream_id:r,fallback_type:i})}async pickSVCLayer(r,i){await this.signal.request(nt.PICK_SVC_LAYER,{stream_id:r,spatial_layer:i.spatialLayer,temporal_layer:i.temporalLayer})}async setRTM2Flag(r){await this.signal.request(nt.SET_RTM2_FLAG,{rtm2_flag:r})}async sendExtensionMessage(r,i,a){if(this.store.useP2P)return this.signal.sendExtensionMessage(r,i,a)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),Lr({},this.inChannelInfo)}async setConfigure(r){if(r&&Array.isArray(r)&&r.length!==0)return this.signal.request(nt.CONFIGURE,r)}async getGatewayVersion(){return(await this.signal.request(nt.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const r=O1.get(this.joinInfo.cname);r&&r.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0),this.usingProxy=!1}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const r=function(i){let a;return a=i.startsWith("dc")?i.match(/(dc\:\/\/)?([^:]+):(\d+)/):i.match(/(wss\:\/\/)?([^:]+):(\d+)/),a?{username:Zr.username,password:Zr.password,turnServerURL:a[2],tcpport:parseInt(a[3])+30,udpport:parseInt(a[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],r&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(Lr(Lr({},Zr),{},{turnServerURL:r.turnServerURL,tcpport:r.tcpport,udpport:r.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const r=await this.signal.request(nt.TRAFFIC_STATS,void 0,!0);r.timestamp=Date.now(),r.ntp_offset!=null&&(this.ntpOffset=r.ntp_offset),r.peer_delay.forEach(i=>{const a=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(l=>l.peer_uid===i.peer_uid);a&&a.B_st!==i.B_st&&Yx(()=>{this.emit(qn.STREAM_TYPE_CHANGE,i.peer_uid,i.B_st)})}),this._statsCollector.updateTrafficStats(r)}getJoinMessage(r){var i,a,l,u;if(!this.joinInfo||!this.key)throw new pe(K.UNEXPECTED_ERROR,"can not generate join message, no join info");const p=Object.assign({},this.joinInfo.apResponse);let m=W("REPORT_APP_SCENARIO");if(typeof m!="string")try{m=JSON.stringify(m)}catch{m=void 0}var g;m&&m.length>128&&(m=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(qn.UPDATE_GATEWAY_CONFIG),g=this.store.clientId,Ce(fm).call(fm,g)||fm.push(g);const y=w0(this.store),x=!((i=this.isPreallocation)===null||i===void 0||!i.call(this)),S=ZV(this.store),T=Nve(),C=Mo(87)||sV()||mA(117),V=(function(){const Y=Ht();if(Y.name!==Yt.SAFARI||!Y.browserVersion)return!1;const te=Y.browserVersion.split(".");return Number(te[0])>18||Number(te[0])===18&&Number(te[1])>=4}()||lV(18,4,!1))&&fA(18,6,!0)&&this.spec.codec==="h264"&&W("ENABLE_ABSSENDTIME_AS_SENTTS"),j=!(((a=p.detail)===null||a===void 0?void 0:a[3])!=="CN"||!W("ENABLE_QUALITY_FALLBACK"))&&W("ENABLE_QUALITY_FALLBACK"),L=!!W("ENABLE_AP_MULTI_IP")&&((l=p.detail)===null||l===void 0?void 0:l[5])==="multi-ip",H=Lr({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:fa,browser:navigator.userAgent,process_id:W("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:L||this.hasChangeBGPAddress,ap_response:p,extend:W("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:m,attributes:{userAttributes:Lr(Lr({enableEncodedTransform:(!!W("ENABLE_AUDIO_METADATA")||!!W("ENABLE_AUDIO_PTS"))&&C||!!W("ENABLE_AUDIO_TOPN")&&pA(Yt.CHROME,87,116)||void 0,enableAudioMetadata:!!W("ENABLE_AUDIO_METADATA")&&C,enableAudioPts:!!W("ENABLE_AUDIO_PTS")&&C,topnSmoothLevel:W("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:W("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:W("TOPN_SWITCH_HOLD_MS"),topnAudioGain:W("TOPN_AUDIO_GAIN"),enableNetworkQualityProbe:this.store.networkQualityProbe,enablePublishedUserList:W("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:W("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:Os("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:Os("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:Os("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:W("USE_PUB_RTX")===!0||W("USE_SUB_RTX")===!0||void 0,disableFEC:W("DISABLE_FEC"),enableNTPReport:!!W("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:S,enableFulllinkAvSync:!!W("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:Os("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!W("FORCE_ENABLE_AUT_CC")||!r_()&&(!!W("ENABLE_AUT_FEEDBACK")||void 0),rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!W("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:Os("USE_XR","boolean"),enableLossbasedBwe:Os("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!W("FORCE_ENABLE_AUT_CC")||!r_()&&(!!W("ENABLE_AUT_CC")||void 0),enableCCFallback:Os("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:x,preSubNum:y?Os("PRE_SUB_NUM","number"):void 0,enablePubTWCC:Os("PUBLISH_TWCC","boolean"),enableSubTWCC:Os("SUBSCRIBE_TWCC","boolean"),enablePubRTX:Os("USE_PUB_RTX","boolean"),enableSubRTX:Os("USE_SUB_RTX","boolean"),enableSubSVC:W("ENABLE_SVC")?W("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(W("SVC"))&&W("SVC").length!==0?W("SVC"):void 0,enableSvcExtended:W("ENABLE_SVC")&&Array.isArray(W("SVC_EXTENDED"))&&W("SVC_EXTENDED").length!==0?W("SVC_EXTENDED"):void 0,enableVosFallback:W("ENABLE_VOS_FALLBACK"),enableQualityFallback:j},T),{},{audioDuplicate:Os("ENABLE_AUDIO_RED","boolean")?(u=Os("AUDIO_DUPLICATE_NUM","number"))!==null&&u!==void 0?u:2:void 0,senttsUsesAbsSendTime:!!V||void 0,enableDualStreamFlag:Os("ENABLE_DUAL_STREAM_FLAG","boolean")})},join_ts:this.joinGatewayStartTime},r);return this.joinInfo.stringUid&&(H.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(H.aes_mode=this.joinInfo.aesmode,W("ENCRYPT_AES")?(H.aes_secret=this.joinInfo.aespassword,H.aes_encrypt=!0):H.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(H.aes_salt=this.joinInfo.aessalt)),p.addresses[this.signal.websocket.currentURLIndex]&&(H.ap_response.ticket=p.addresses[this.signal.websocket.currentURLIndex].ticket,delete p.addresses),this.joinInfo.defaultVideoStream!==void 0&&(H.default_video_stream=this.joinInfo.defaultVideoStream),H}getRejoinMessage(){if(!this.joinInfo)throw new pe(K.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(Xe.WS_RECONNECT_CREATE_CONNECTION,r=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(Xe.WS_RECONNECTING,r=>{this.joinInfo&&Ye.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:r||Qr.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",Ye.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(Xe.WS_CLOSED,r=>{let i;switch(r){case Ut.LEAVE:i=Qr.LEAVE;break;case Ut.UID_BANNED:case Ut.IP_BANNED:case Ut.CHANNEL_BANNED:case Ut.SERVER_ERROR:i=Qr.SERVER_ERROR;break;case Ut.FALLBACK:i=Qr.FALLBACK;break;case Ut.LICENSE_MISSING:case Ut.LICENSE_EXPIRED:case Ut.LICENSE_MINUTES_EXCEEDED:case Ut.LICENSE_PERIOD_INVALID:case Ut.LICENSE_MULTIPLE_SDK_SERVICE:case Ut.LICENSE_ILLEGAL:case Ut.TOKEN_EXPIRE:i=r;break;default:i=Qr.NETWORK_ERROR}A.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(i||"undefined -> "+Qr.NETWORK_ERROR)),this.joinInfo&&Ye.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:r===Ut.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:i}),this._disconnectedReason=r,r!==Ut.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(Xe.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if(this.role==="audience"){const r=W("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;r&&(r.level||r.delay)&&(A.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(r.level,", delay: ").concat(r.delay)),this.setClientRole(this.role,r))}if(Ye.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer||this.usingProxy,signalChannel:this.signal.__name__==="DataChannelSignal"?"1":"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1){const r=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!r)return void A.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(r));cn("EVENT_REPORT_DOMAIN",r[1]),cn("EVENT_REPORT_BACKUP_DOMAIN",r[1]),cn("LOG_UPLOAD_SERVER","".concat(r[1],":6444"))}}}),this.signal.on(vt.ON_UPLINK_STATS,r=>{this._statsCollector.updateUplinkStats(r)}),this.signal.on(Xe.REQUEST_RECOVER,(r,i,a)=>{if(!this.joinInfo)return a(new pe(K.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));r&&(this.joinInfo.multiIP=r,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,or(this,qn.REQUEST_NEW_GATEWAY_LIST).then(i).catch(a)}),this.signal.on(Xe.REQUEST_JOIN_INFO,async(r,i,a)=>{var l,u,p;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void r(this.getJoinMessage({ortc:{}}));const m=Sn((l=this.joinInfo)===null||l===void 0?void 0:l.turnServer);if(W("NEW_TURN_MODE")&&m&&((u=this.joinInfo)===null||u===void 0?void 0:u.cloudProxyServer)==="disabled"){var g;let T=m.servers.map(j=>"turnServerURL"in j&&W("USE_TURN_IP")?Lr(Lr({},j),{},{turnServerURL:C_(j.turnServerURL)}):j),C=(g=m.serversFromGateway)===null||g===void 0?void 0:g.map(j=>W("USE_TURN_IP")?Lr(Lr({},j),{},{turnServerURL:C_(j.turnServerURL)}):j);const V=this.signal.currentURLIndex;T.length>0&&(T=[T[V%T.length]],m.servers=T),Array.isArray(C)&&C.length>0&&(C=[C[0]],m.serversFromGateway=C),A.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(V))}const{iceParameters:y,dtlsParameters:x,rtpCapabilities:S}=await or(this,qn.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:m,cloudProxyServer:(p=this.joinInfo)===null||p===void 0?void 0:p.cloudProxyServer});try{r(this.getJoinMessage({ortc:{iceParameters:y,dtlsParameters:x,rtpCapabilities:S,version:"2"}}))}catch(T){i(T)}}),this.signal.on(Xe.REQUEST_REJOIN_INFO,r=>{r(this.getRejoinMessage())}),this.signal.on(Xe.REPORT_JOIN_GATEWAY,(r,i)=>{if(!this.joinInfo)return;let a,l="";var u;r instanceof pe?(a=((u=r.data)===null||u===void 0?void 0:u.desc)||r.code,l=r.message):a=r,Ye.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:a,errorMsg:l,addr:i,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer||this.usingProxy,signalChannel:this.signal.__name__==="DataChannelSignal"?"1":"0",preload:this.joinInfo.preload})}),this.signal.on(Xe.IS_P2P_DISCONNECTED,r=>{r(Wu(this,qn.IS_P2P_DISCONNECTED))}),this.signal.on(Xe.DISCONNECT_P2P,()=>{this.emit(qn.DISCONNECT_P2P)}),this.signal.on(Xe.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(Xe.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(Xe.JOIN_RESPONSE,r=>{const i=this.getCurrentGatewayAddress();this.emit(qn.JOIN_RESPONSE,r,i)}),this.signal.on(Xe.PRE_CONNECT_PC,async(r,i)=>{if(this.joinInfo){var a,l;this.updateTurnConfigFromSignal();const p=this.getCurrentGatewayAddress(),m=Sn((a=this.joinInfo)===null||a===void 0?void 0:a.turnServer);if(W("NEW_TURN_MODE")&&m&&((l=this.joinInfo)===null||l===void 0?void 0:l.cloudProxyServer)==="disabled"){var u;let y=m.servers.map(T=>"turnServerURL"in T&&W("USE_TURN_IP")?Lr(Lr({},T),{},{turnServerURL:C_(T.turnServerURL)}):T),x=(u=m.serversFromGateway)===null||u===void 0?void 0:u.map(T=>W("USE_TURN_IP")?Lr(Lr({},T),{},{turnServerURL:C_(T.turnServerURL)}):T);const S=this.signal.currentURLIndex;y.length>0&&(y=[y[S%y.length]],m.servers=y),Array.isArray(x)&&x.length>0&&(x=[x[0]],m.serversFromGateway=x),A.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(S,",in pre pc"))}const g=W("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(p&&g){const y=W8(p);or(this,qn.PRE_CONNECT_PC,{candidates:y,fingerprint:g,turnServer:m}).then(x=>{r==null||r(x)}).catch(i||(()=>{}))}}}),this.signal.on(Xe.RECOVER_NOTIFICATION,r=>{this.joinInfo&&typeof W("AP_REQUEST_DETAIL")=="string"&&(this.joinInfo.apRequestDetail="".concat(W("AP_REQUEST_DETAIL"),";").concat(r))}),this.signal.on(Xe.VOS_FALLBACK,r=>{this.emit(qn.VOS_FALLBACK,r)}),this.signal.on(Xe.DATACHANNEL_FAILBACK,r=>{A.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(qn.DATACHANNEL_FAILBACK)})}async tryUnsubBeforeResub(r,i){try{await this.signal.request(nt.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:r,ortc:[i]},!0)}catch(a){throw A.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),a),a}}async tryUnsubDataChannelBeforeResub(r,i){try{await this.signal.request(nt.UNSUBSCRIBE,{stream_id:i.id},!0)}catch(a){throw A.warning("unsubscribe datachannel warning",a),a}}async tryUnpubBeforeRepub(r,i){try{await this.signal.request(nt.UNPUBLISH,{stream_id:r,ortc:i},!0)}catch(a){throw A.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),a),a}}async tryUnpubDataChannelBeforeRepub(r,i){try{await this.signal.request(nt.UNPUBLISH_DATASTREAM,{channnel_id:i.channelId},!0)}catch(a){throw A.warning("unpublish datastream warning: ",a),a}}async tryMassUnsubBeforeResub(r){const i={users:r.map(a=>({stream_id:a.stream_id,stream_type:a.stream_type}))};try{await this.signal.request(nt.UNSUBSCRIBE_STREAMS,i,!0)}catch(a){throw A.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),a),a}}async muteLocal(r,i){const a={action:r.find(l=>l.stream_type===rn.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:r,stream_id:i};try{await this.signal.request(nt.CONTROL,a,!0,!0)}catch(l){throw A.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),l),l}}async unmuteLocal(r,i){const a={action:r.find(l=>l.stream_type===rn.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:r,stream_id:i};try{await this.signal.request(nt.CONTROL,a,!0,!0)}catch(l){throw A.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),l),l}}async muteRemote(r,i){const a={action:r===ze.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:i};try{await this.signal.request(nt.CONTROL,a,!0,!0)}catch(l){throw A.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),l),l}}async unmuteRemote(r,i){const a={action:r===ze.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:i};try{await this.signal.request(nt.CONTROL,a,!0,!0)}catch(l){throw A.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),l),l}}uploadWRTCStats(r){this.signal.uploadWRTCStats(r)}upload(r,i){this.signal.upload(r,i)}getSignalRTT(){return this.signal.rtt}async restartICE(r){const i={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:r};try{return await this.signal.request(nt.RESTART_ICE,i,!0)}catch(a){throw A.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),a),a}}reconnect(r,i){this.state==="CONNECTED"&&this.signal.reconnect(r||void 0,i||Qr.P2P_FAILED)}getCurrentGatewayAddress(){var r,i;if(!W("GATEWAY_WSS_ADDRESS"))return W("USE_CANDIDATE_FROM_AP_DETAIL")&&(r=this.joinInfo)!==null&&r!==void 0&&r.apGatewayAddress?(A.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):(i=this.joinInfo)!==null&&i!==void 0&&i.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(r){await this.signal.request(nt.SET_PARAMETER,{enablePublishAudioFilter:r})}downgradeCodec(r){this.signal.downgradeCodec(r)}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(Ut.FALLBACK)),this.store.useDcSignal=!1,this.signal=new O8(Lr(Lr({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(qn.RESET_SIGNAL)}}let j_=0,P1=0;function $o(t,r,i,a){return new je((l,u)=>{r.timeout=r.timeout||W("HTTP_CONNECT_TIMEOUT"),r.responseType=r.responseType||"json",r.data&&!i?(r.data=JSON.stringify(r.data),j_+=Tc(r.data)):i&&(r.data.size?j_+=r.data.size:r.data instanceof FormData?j_+=AV(r.data):j_+=Tc(JSON.stringify(r.data))),r.headers=r.headers||{},r.headers["Content-Type"]=r.headers["Content-Type"]||"application/json",r.method="POST",r.url=t,zi.request(r).then(p=>{typeof p.data=="string"?P1+=Tc(p.data):p.data instanceof ArrayBuffer||p.data instanceof Uint8Array?P1+=p.data.byteLength:P1+=Tc(JSON.stringify(p.data)),a&&l({data:p.data,headers:p.headers}),l(p.data)}).catch(p=>{zi.isCancel(p)?u(new pe(K.OPERATION_ABORTED,"cancel token canceled")):p.code==="ECONNABORTED"?u(new pe(K.NETWORK_TIMEOUT,p.message)):p.response?u(new pe(K.NETWORK_RESPONSE_ERROR,p.response.status)):u(new pe(K.NETWORK_ERROR,p.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var t;function r(_e){var Oe=0;return function(){return Oe<_e.length?{done:!1,value:_e[Oe++]}:{done:!0}}}var i=typeof Object.defineProperties=="function"?Object.defineProperty:function(_e,Oe,He){return _e==Array.prototype||_e==Object.prototype||(_e[Oe]=He.value),_e},a,l=function(_e){_e=[typeof globalThis=="object"&&globalThis,_e,typeof window=="object"&&window,typeof self=="object"&&self,typeof o=="object"&&o];for(var Oe=0;Oe<_e.length;++Oe){var He=_e[Oe];if(He&&He.Math==Math)return He}throw Error("Cannot find global object")}(this);function u(_e,Oe){if(Oe)e:{var He=l;_e=_e.split(".");for(var we=0;we<_e.length-1;we++){var k=_e[we];if(!(k in He))break e;He=He[k]}(Oe=Oe(we=He[_e=_e[_e.length-1]]))!=we&&Oe!=null&&i(He,_e,{configurable:!0,writable:!0,value:Oe})}}function p(_e){return(_e={next:_e})[Symbol.iterator]=function(){return this},_e}function m(_e){var Oe=typeof Symbol<"u"&&Symbol.iterator&&_e[Symbol.iterator];return Oe?Oe.call(_e):{next:r(_e)}}if(u("Symbol",function(_e){function Oe(k,Z){this.A=k,i(this,"description",{configurable:!0,writable:!0,value:Z})}if(_e)return _e;Oe.prototype.toString=function(){return this.A};var He="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",we=0;return function k(Z){if(this instanceof k)throw new TypeError("Symbol is not a constructor");return new Oe(He+(Z||"")+"_"+we++,Z)}}),u("Symbol.iterator",function(_e){if(_e)return _e;_e=Symbol("Symbol.iterator");for(var Oe="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),He=0;He<Oe.length;He++){var we=l[Oe[He]];typeof we=="function"&&typeof we.prototype[_e]!="function"&&i(we.prototype,_e,{configurable:!0,writable:!0,value:function(){return p(r(this))}})}return _e}),typeof Object.setPrototypeOf=="function")a=Object.setPrototypeOf;else{var g;e:{var y={};try{y.__proto__={a:!0},g=y.a;break e}catch{}g=!1}a=g?function(_e,Oe){if(_e.__proto__=Oe,_e.__proto__!==Oe)throw new TypeError(_e+" is not extensible");return _e}:null}var x=a;function S(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function T(_e){if(_e.m)throw new TypeError("Generator is already running");_e.m=!0}function C(_e,Oe){return _e.h=3,{value:Oe}}function V(_e){this.g=new S,this.G=_e}function j(_e,Oe,He,we){try{var k=Oe.call(_e.g.j,He);if(!(k instanceof Object))throw new TypeError("Iterator result "+k+" is not an object");if(!k.done)return _e.g.m=!1,k;var Z=k.value}catch(ie){return _e.g.j=null,_e.g.s(ie),L(_e)}return _e.g.j=null,we.call(_e.g,Z),L(_e)}function L(_e){for(;_e.g.h;)try{var Oe=_e.G(_e.g);if(Oe)return _e.g.m=!1,{value:Oe.value,done:!1}}catch(He){_e.g.v=void 0,_e.g.s(He)}if(_e.g.m=!1,_e.g.l){if(Oe=_e.g.l,_e.g.l=null,Oe.F)throw Oe.D;return{value:Oe.return,done:!0}}return{value:void 0,done:!0}}function H(_e){this.next=function(Oe){return _e.o(Oe)},this.throw=function(Oe){return _e.s(Oe)},this.return=function(Oe){return function(He,we){T(He.g);var k=He.g.j;return k?j(He,"return"in k?k.return:function(Z){return{value:Z,done:!0}},we,He.g.return):(He.g.return(we),L(He))}(_e,Oe)},this[Symbol.iterator]=function(){return this}}function Y(_e,Oe){return Oe=new H(new V(Oe)),x&&_e.prototype&&x(Oe,_e.prototype),Oe}if(S.prototype.o=function(_e){this.v=_e},S.prototype.s=function(_e){this.l={D:_e,F:!0},this.h=this.C||this.u},S.prototype.return=function(_e){this.l={return:_e},this.h=this.u},V.prototype.o=function(_e){return T(this.g),this.g.j?j(this,this.g.j.next,_e,this.g.o):(this.g.o(_e),L(this))},V.prototype.s=function(_e){return T(this.g),this.g.j?j(this,this.g.j.throw,_e,this.g.o):(this.g.s(_e),L(this))},u("Array.prototype.entries",function(_e){return _e||function(){return function(Oe,He){Oe instanceof String&&(Oe+="");var we=0,k=!1,Z={next:function(){if(!k&&we<Oe.length){var ie=we++;return{value:He(ie,Oe[ie]),done:!1}}return k=!0,{done:!0,value:void 0}}};return Z[Symbol.iterator]=function(){return Z},Z}(this,function(Oe,He){return[Oe,He]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var te=function(_e,Oe){for(var He=0;He<_e.length;He++)Oe(_e[He])},se=function(_e){return _e.replace(/\r?\n|\r/g,`\r
`)},oe=function(_e,Oe,He){return Oe instanceof Blob?(He=He!==void 0?He+"":typeof Oe.name=="string"?Oe.name:"blob",Oe.name===He&&Object.prototype.toString.call(Oe)!=="[object Blob]"||(Oe=new File([Oe],He)),[String(_e),Oe]):[String(_e),String(Oe)]},ne=function(_e,Oe){if(_e.length<Oe)throw new TypeError(Oe+" argument required, but only "+_e.length+" present.")},de=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,be=de.FormData,Se=de.XMLHttpRequest&&de.XMLHttpRequest.prototype.send,Be=de.Request&&de.fetch,mt=de.navigator&&de.navigator.sendBeacon,ut=de.Element&&de.Element.prototype,Tt=de.Symbol&&Symbol.toStringTag;Tt&&(Blob.prototype[Tt]||(Blob.prototype[Tt]="Blob"),"File"in de&&!File.prototype[Tt]&&(File.prototype[Tt]="File"));try{new File([],"")}catch{de.File=function(Oe,He,we){return Oe=new Blob(Oe,we||{}),Object.defineProperties(Oe,{name:{value:He},lastModified:{value:+(we&&we.lastModified!==void 0?new Date(we.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),Tt&&Object.defineProperty(Oe,Tt,{value:"File"}),Oe}}var Et=function(_e){return _e.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},Xt=function(_e){this.i=[];var Oe=this;_e&&te(_e.elements,function(He){if(He.name&&!He.disabled&&He.type!=="submit"&&He.type!=="button"&&!He.matches("form fieldset[disabled] *"))if(He.type==="file"){var we=He.files&&He.files.length?He.files:[new File([],"",{type:"application/octet-stream"})];te(we,function(k){Oe.append(He.name,k)})}else He.type==="select-multiple"||He.type==="select-one"?te(He.options,function(k){!k.disabled&&k.selected&&Oe.append(He.name,k.value)}):He.type==="checkbox"||He.type==="radio"?He.checked&&Oe.append(He.name,He.value):(we=He.type==="textarea"?se(He.value):He.value,Oe.append(He.name,we))})};if((t=Xt.prototype).append=function(_e,Oe,He){ne(arguments,2),this.i.push(oe(_e,Oe,He))},t.delete=function(_e){ne(arguments,1);var Oe=[];_e=String(_e),te(this.i,function(He){He[0]!==_e&&Oe.push(He)}),this.i=Oe},t.entries=function _e(){var Oe,He=this;return Y(_e,function(we){if(we.h==1&&(Oe=0),we.h!=3)return Oe<He.i.length?we=C(we,He.i[Oe]):(we.h=0,we=void 0),we;Oe++,we.h=2})},t.forEach=function(_e,Oe){ne(arguments,1);for(var He=m(this),we=He.next();!we.done;we=He.next()){var k=m(we.value);we=k.next().value,k=k.next().value,_e.call(Oe,k,we,this)}},t.get=function(_e){ne(arguments,1);var Oe=this.i;_e=String(_e);for(var He=0;He<Oe.length;He++)if(Oe[He][0]===_e)return Oe[He][1];return null},t.getAll=function(_e){ne(arguments,1);var Oe=[];return _e=String(_e),te(this.i,function(He){He[0]===_e&&Oe.push(He[1])}),Oe},t.has=function(_e){ne(arguments,1),_e=String(_e);for(var Oe=0;Oe<this.i.length;Oe++)if(this.i[Oe][0]===_e)return!0;return!1},t.keys=function _e(){var Oe,He,we,k,Z=this;return Y(_e,function(ie){if(ie.h==1&&(Oe=m(Z),He=Oe.next()),ie.h!=3)return He.done?void(ie.h=0):(we=He.value,k=m(we),C(ie,k.next().value));He=Oe.next(),ie.h=2})},t.set=function(_e,Oe,He){ne(arguments,2),_e=String(_e);var we=[],k=oe(_e,Oe,He),Z=!0;te(this.i,function(ie){ie[0]===_e?Z&&(Z=!we.push(k)):we.push(ie)}),Z&&we.push(k),this.i=we},t.values=function _e(){var Oe,He,we,k,Z=this;return Y(_e,function(ie){if(ie.h==1&&(Oe=m(Z),He=Oe.next()),ie.h!=3)return He.done?void(ie.h=0):(we=He.value,(k=m(we)).next(),C(ie,k.next().value));He=Oe.next(),ie.h=2})},Xt.prototype._asNative=function(){for(var _e=new be,Oe=m(this),He=Oe.next();!He.done;He=Oe.next()){var we=m(He.value);He=we.next().value,we=we.next().value,_e.append(He,we)}return _e},Xt.prototype._blob=function(){var _e="----formdata-polyfill-"+Math.random(),Oe=[],He="--"+_e+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(we,k){return typeof we=="string"?Oe.push(He+Et(se(k))+`"\r
\r
`+se(we)+`\r
`):Oe.push(He+Et(se(k))+'"; filename="'+Et(we.name)+`"\r
Content-Type: `+(we.type||"application/octet-stream")+`\r
\r
`,we,`\r
`)}),Oe.push("--"+_e+"--"),new Blob(Oe,{type:"multipart/form-data; boundary="+_e})},Xt.prototype[Symbol.iterator]=function(){return this.entries()},Xt.prototype.toString=function(){return"[object FormData]"},ut&&!ut.matches&&(ut.matches=ut.matchesSelector||ut.mozMatchesSelector||ut.msMatchesSelector||ut.oMatchesSelector||ut.webkitMatchesSelector||function(_e){for(var Oe=(_e=(this.document||this.ownerDocument).querySelectorAll(_e)).length;0<=--Oe&&_e.item(Oe)!==this;);return-1<Oe}),Tt&&(Xt.prototype[Tt]="FormData"),Se){var An=de.XMLHttpRequest.prototype.setRequestHeader;de.XMLHttpRequest.prototype.setRequestHeader=function(_e,Oe){An.call(this,_e,Oe),_e.toLowerCase()==="content-type"&&(this.B=!0)},de.XMLHttpRequest.prototype.send=function(_e){_e instanceof Xt?(_e=_e._blob(),this.B||this.setRequestHeader("Content-Type",_e.type),Se.call(this,_e)):Se.call(this,_e)}}Be&&(de.fetch=function(_e,Oe){return Oe&&Oe.body&&Oe.body instanceof Xt&&(Oe.body=Oe.body._blob()),Be.call(this,_e,Oe)}),mt&&(de.navigator.sendBeacon=function(_e,Oe){return Oe instanceof Xt&&(Oe=Oe._asNative()),mt.call(this,_e,Oe)}),de.FormData=Xt}})();const j0=()=>{const t=W("AREAS");return t.length===0&&t.push(Jt.GLOBAL),pa(t).call(t,(r,i,a)=>{const l=eG(i);return l?a===0?l:"".concat(r,",").concat(l):r},"")},eG=t=>t===Jt.OVERSEA?"".concat(si.ASIA,",").concat(si.EUROPE,",").concat(si.AFRICA,",").concat(si.NORTH_AMERICA,",").concat(si.SOUTH_AMERICA,",").concat(si.OCEANIA):si[t],Rve=t=>{const r={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return t.map(i=>{const a=S_[i],l=Object.keys(a);l&&l.map(u=>{u!=="CODE"&&(r[u]=r[u].concat(a[u]))})}),r},D_={GLOBAL:{ASIA:[Jt.CHINA,Jt.JAPAN,Jt.INDIA,Jt.KOREA,Jt.HKMC],EUROPE:[],NORTH_AMERICA:[Jt.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},L_=Object.keys(D_[Jt.GLOBAL]),k1=[Jt.CHINA,Jt.NORTH_AMERICA,Jt.EUROPE,Jt.ASIA,Jt.JAPAN,Jt.INDIA,Jt.OCEANIA,Jt.SOUTH_AMERICA,Jt.AFRICA,Jt.KOREA,Jt.HKMC,Jt.US],Ave=function(t,r){let i=[];if(Ce(t).call(t,Jt.GLOBAL)){const u=[Jt.GLOBAL,Jt.OVERSEA],p=Object.keys(S_);if(r===Jt.GLOBAL)throw new pe(K.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(r===Jt.CHINA)i=[Jt.OVERSEA];else if(l=r,Ce(L_).call(L_,l)){const m=(a=r,D_[Jt.GLOBAL][a]||[]),g=[...u,r,...m];i=p.filter(y=>!Ce(g).call(g,y))}else if(function(m){let g=!1;return L_.forEach(y=>{var x;Ce(x=D_[Jt.GLOBAL][y]).call(x,m)&&(g=!0)}),g}(r)){const m=function(y){let x;return L_.forEach(S=>{var T;Ce(T=D_[Jt.GLOBAL][S]).call(T,y)&&(x=S)}),x}(r),g=[...u,m,r];i=p.filter(y=>!Ce(g).call(g,y))}else i=t;i=function(m){const g=[];return k1.forEach(y=>{Ce(m).call(m,y)&&g.push(y)}),g.concat(m.filter(y=>!Ce(k1).call(k1,y)))}(i)}else i=t;var a,l;return i};function tG(t){var r,i;if(!t&&Ce(r=W("AREAS")).call(r,Jt.EXTENSIONS))return A.debug("update area from ap : reset"),void j1(U0e,!0);if(!Ce(i=W("AREAS")).call(i,Jt.GLOBAL)||!t)return;let a=S_.EXTENSIONS;a&&(a={CODE:eG(Jt.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(t,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(t,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(t,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(t,".agora.io"),"cds-ap-web-2-".concat(t,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(t,".agora.io"),"sua-ap-web-2-".concat(t,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(t,".agora.io"),"uap-ap-web-2-".concat(t,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(t,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(t,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(t,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(t,".agora.io")]},A.debug("update area from ap success: ".concat(t,",config is "),a),cn("AREAS",[Jt.EXTENSIONS],!0),Object.keys(a).map(l=>{l==="LOG_UPLOAD_SERVER"||l==="EVENT_REPORT_DOMAIN"||l==="EVENT_REPORT_BACKUP_DOMAIN"||l==="PROXY_SERVER_TYPE3"?cn(l,a[l][0]):cn(l,a[l])}))}function j1(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=Ye.reportApiInvoke(null,{name:Cn.SET_AREA,options:t,tag:hn.TRACER});try{let a=[];if(typeof t=="string"&&(a=[t]),Array.isArray(t)&&(t.forEach(u=>{if(!Ce(S8).call(S8,u))throw new pe(K.INVALID_PARAMS,"invalid area code")}),a=t),Object.prototype.toString.call(t)==="[object Object]"){const{areaCode:u,excludedArea:p}=t;if(!u)throw new pe(K.INVALID_PARAMS,"area code is needed");let m=u;typeof u=="string"&&(m=[u]),a=p?Ave(m,p):m}if(!r){if($s.AREAS){const u=new pe(K.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return i.onError(u),void A.warning("setArea is prohibited because of config-distribute")}if(Ce(a).call(a,Jt.GLOBAL)&&W("AREAS")===Jt.EXTENSIONS){const u=new pe(K.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return i.onError(u),void A.warning("setArea is prohibited because of ap extensions")}}cn("AREAS",a,r);const l=Rve(a);Object.keys(l).map(u=>{u==="LOG_UPLOAD_SERVER"||u==="EVENT_REPORT_DOMAIN"||u==="EVENT_REPORT_BACKUP_DOMAIN"||u==="PROXY_SERVER_TYPE3"?cn(u,l[u][0]):cn(u,l[u])}),A.debug("set area success:",a.join(","))}catch(a){throw i.onError(a),a}i.onSuccess()}function nG(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function Pc(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?nG(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):nG(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}let D1=1;function Ive(t,r,i,a,l){D1+=1;const u={sid:i.sid,command:"convergeAllocateEdge",uid:"666",appId:i.appId,ts:Math.floor(Date.now()/1e3),seq:D1,requestId:D1,version:fa,cname:i.cname},p={service_name:r,json_body:JSON.stringify(u)};let m,g,y=t[0];return Uo(async()=>{m=Date.now();const x=await $o(y,{data:p,cancelToken:a,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(g=Date.now()-m,x.code!==0){const C=new pe(K.UNEXPECTED_RESPONSE,"live streaming ap error, code"+x.code,{retry:!0,responseTime:g});throw A.error(C.toString()),C}const S=JSON.parse(x.json_body);if(S.code!==200){const C=new pe(K.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(S.code,", reason: ").concat(S.reason),{code:S.code,responseTime:g});throw A.error(C.toString()),C}if(!S.servers||S.servers.length===0){const C=new pe(K.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:S.code,responseTime:g});throw A.error(C.toString()),C}const T=function(C,V){return{addressList:C.servers.map(j=>"wss://".concat(j.address.replace(/\./g,"-"),".").concat(W("WORKER_DOMAIN"),":").concat(j.wss,"?serviceName=").concat(encodeURIComponent(V))),workerToken:C.workerToken,vid:C.vid}}(S,r);return W("LIVE_STREAMING_ADDRESS")&&(T.addressList=W("LIVE_STREAMING_ADDRESS")instanceof Array?W("LIVE_STREAMING_ADDRESS"):[W("LIVE_STREAMING_ADDRESS")]),Pc(Pc({},T),{},{responseTime:g})},(x,S)=>(Ye.apworkerEvent(i.sid,{success:!0,sc:200,serviceName:r,responseDetail:JSON.stringify(x.addressList),firstSuccess:S===0,responseTime:g,serverIp:t[S%t.length]}),!1),(x,S)=>(Ye.apworkerEvent(i.sid,{success:!1,sc:x.data&&x.data.code||200,serviceName:r,responseTime:g,serverIp:t[S%t.length]}),!!(x.code!==K.OPERATION_ABORTED&&x.code!==K.UNEXPECTED_RESPONSE||x.data&&x.data.retry)&&(y=t[(S+1)%t.length],!0)),l)}let L1=1;function rG(t,r,i,a){let{url:l,areaCode:u}=t;const{clientId:p,sid:m}=r,g=Date.now();let y;const x=r.role,[S,T]=U1(r,u,[tr.CHOOSE_SERVER]);let C=Un.networkState;return Uo(async()=>{C&&Un.networkState===Pi.OFFLINE&&Un.onlineWaiter&&await je.race([Un.onlineWaiter,Er(a&&a.maxRetryTimeout||er.maxRetryTimeout)]),C=Un.networkState;const{data:V,headers:j}=await $o(l,{data:S,cancelToken:i,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);y=j.http3==="1"?1:-1,Ye.reportResourceTiming(l,m),sG(V,l,r,g,[tr.CHOOSE_SERVER],y);const L=R0(V,tr.CHOOSE_SERVER);return M1(L),w1(L,l)},V=>(V&&Ye.joinChooseServer(m,{role:x,lts:g,succ:!0,csAddr:l,opid:T,serverList:V.gatewayAddrs.map(j=>j.address),ec:null,cid:V.cid.toString(),uid:V.uid.toString(),csIp:V.csIp,unilbsServerIds:[tr.CHOOSE_SERVER].toString(),isHttp3:y,corssRegionTagReq:r.apRequestDetail,corssRegionTagRes:V.res.detail&&V.res.detail[38],vid:V.vid}),!1),V=>V.code!==K.OPERATION_ABORTED&&(V.code===K.CAN_NOT_GET_GATEWAY_SERVER?V.data.retry:(Ye.joinChooseServer(m,{role:x,lts:g,succ:!1,csAddr:l,serverList:null,opid:T,ec:V.code,csIp:V.data&&V.data.csIp,unilbsServerIds:[tr.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:C}),isHttp3:y,corssRegionTagReq:r.apRequestDetail}),A.warning("[".concat(p||"sid-".concat(m.slice(0,6)),"] Choose server network error, retry"),V),!0)),a)}function iG(t,r,i,a){let l,{url:u,areaCode:p,serviceIds:m}=t;const g=Date.now(),y=r.role,[x,S]=U1(r,p,m);let T;return Uo(async()=>{T&&Un.networkState===Pi.OFFLINE&&Un.onlineWaiter&&await je.race([Un.onlineWaiter,Er(a&&a.maxRetryTimeout||er.maxRetryTimeout)]),T=Un.networkState;const{data:C,headers:V}=await $o(u,{data:x,cancelToken:i,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);l=V.http3==="1"?1:-1,Ye.reportResourceTiming(u,r.sid),sG(C,u,r,g,m,l);const j=R0(C,tr.CHOOSE_SERVER),L=R0(C,r.cloudProxyServer==="proxy5"?tr.CLOUD_PROXY_5:r.cloudProxyServer==="proxy3"||r.cloudProxyServer==="proxy4"?tr.CLOUD_PROXY:tr.CLOUD_PROXY_FALLBACK),H=performance.getEntriesByName(u),Y=H[H.length-1];let te;return Y&&(te={name:Y.name,protocol:"nextHopProtocol"in Y?Y.nextHopProtocol:"",dnscost:"domainLookupEnd"in Y&&"domainLookupStart"in Y&&typeof Y.domainLookupEnd=="number"&&typeof Y.domainLookupStart=="number"?Y.domainLookupEnd-Y.domainLookupStart:-1,tcpTlsCost:"connectEnd"in Y&&"connectStart"in Y&&typeof Y.connectEnd=="number"&&typeof Y.connectStart=="number"?Y.connectEnd-Y.connectStart:-1,reqCost:"requestStart"in Y&&typeof Y.requestStart=="number"&&"responseEnd"in Y&&typeof Y.responseEnd=="number"?Y.responseEnd-Y.requestStart:-1,handleCost:"leave_ts"in C&&"enter_ts"in C&&typeof C.leave_ts=="number"&&typeof C.enter_ts=="number"?C.leave_ts-C.enter_ts:-1}),M1(j),{gatewayInfo:w1(j,u),proxyInfo:L,url:u,resourceTimingInfo:te}},C=>{var V;return C.gatewayInfo&&Ye.joinChooseServer(r.sid,{role:y,lts:g,succ:!0,csAddr:u,serverList:C.gatewayInfo.gatewayAddrs.map(j=>j.address),ec:null,opid:S,cid:C.gatewayInfo.cid.toString(),uid:C.gatewayInfo.uid.toString(),csIp:C.gatewayInfo.csIp,unilbsServerIds:m.toString(),isHttp3:l,corssRegionTagReq:r.apRequestDetail,corssRegionTagRes:C.gatewayInfo.res.detail&&C.gatewayInfo.res.detail[38],vid:(V=C.gatewayInfo)===null||V===void 0?void 0:V.vid,resourceTimingInfo:C.resourceTimingInfo?JSON.stringify(C.resourceTimingInfo):void 0}),C.proxyInfo&&Ye.joinWebProxyAP(r.sid,{lts:g,sucess:1,apServerAddr:u,turnServerAddrList:C.proxyInfo.addresses.map(j=>j.ip).join(","),errorCode:null,eventType:r.cloudProxyServer,unilbsServerIds:m.toString()}),!1},C=>C.code!==K.OPERATION_ABORTED&&(C.code===K.CAN_NOT_GET_GATEWAY_SERVER?C.data.retry:(Ye.joinWebProxyAP(r.sid,{lts:g,sucess:0,apServerAddr:u,turnServerAddrList:null,errorCode:C.code,eventType:r.cloudProxyServer,unilbsServerIds:m.toString(),extend:JSON.stringify({networkState:T})}),A.warning("[".concat(r.clientId,"] multi unilbs network error, retry"),C),!0)),a)}const sG=(t,r,i,a,l,u)=>{const{sid:p,clientId:m,cloudProxyServer:g}=i,y=[],x=S=>{S.flag===4096?Ye.joinChooseServer(p,{role:i.role,lts:a,succ:!1,csAddr:r,opid:t.opid,serverList:null,ec:S.error.message,csIp:S.error.data&&S.error.data.csIp,unilbsServerIds:l.toString(),isHttp3:u,corssRegionTagReq:i.apRequestDetail}):S.flag!==1048576&&S.flag!==4194304&&S.flag!==4194310||Ye.joinWebProxyAP(p,{lts:a,sucess:0,apServerAddr:r,turnServerAddrList:null,errorCode:S.error.code,eventType:g,unilbsServerIds:l.toString()})};if(t.response_body.forEach(S=>{const T=S.buffer.code;if(S.uri===23&&T===0&&!S.buffer.edges_services)if(S.buffer.flag===4194310)A.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),S.buffer.edges_services=[];else{const C={error:new pe(K.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:W("NO_EDGES_RETRY"),csIp:t.detail[502]}),flag:S.buffer.flag};y.push(C),x(C)}if(T!==0){const C=bm(T),V={error:new pe(K.CAN_NOT_GET_GATEWAY_SERVER,C.desc,{desc:C.desc,retry:C.retry,csIp:t.detail[502]}),flag:S.buffer.flag};S.buffer.flag===4194310?A.warning(V.error.toString()):y.push(V),x(V)}}),y.length)throw A.warning("[".concat(m||"sid-".concat(p.slice(0,6)),"] multi unilbs ").concat(r," failed, ").concat(y.map(S=>"flag: ".concat(S.flag,", message: ").concat(S.error.message,", retry: ").concat(S.error.data.retry)).join(" | "))),new pe(K.CAN_NOT_GET_GATEWAY_SERVER,y.map(S=>"flag: ".concat(S.flag,", message: ").concat(S.error.message)).join(" | "),{retry:!!y.find(S=>S.error.data.retry),csIp:t.detail[502],desc:[...new Set(y.map(S=>{var T;return S==null||(T=S.error)===null||T===void 0||(T=T.data)===null||T===void 0?void 0:T.desc}).filter(S=>!!S))]})},M1=t=>{var r,i,a,l;if(t.addresses&&t.addresses.length===0&&t.code===0)throw new pe(K.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:t.detail&&t.detail[502]});if(W("AP_AREA")&&((a=t.detail)!==null&&a!==void 0&&a[23]&&typeof((l=t.detail)===null||l===void 0?void 0:l[23])=="string"?tG(t.detail[23].toLowerCase()):tG()),(r=t.detail)!==null&&r!==void 0&&r[19]&&typeof((i=t.detail)===null||i===void 0?void 0:i[19])=="string"){const p=t.detail[19],m=p==null?void 0:p.split(";");for(let g=0;g<m.length;g++){var u;const y=Ii(u=m[g]).call(u);t.addresses[g]&&m&&(t.addresses[g].fingerprint=y)}}if(W("GATEWAY_ADDRESS")&&W("GATEWAY_ADDRESS").length>0){A.debug("assign gateway address to",W("GATEWAY_ADDRESS"));const p=W("GATEWAY_ADDRESS").map(m=>{var g,y;const x=(g=(y=t.addresses.find(S=>S.ip===m.ip&&S.port===m.port))===null||y===void 0?void 0:y.fingerprint)!==null&&g!==void 0?g:"";return{ip:m.ip,port:m.port,ticket:t.addresses[0]&&t.addresses[0].ticket,fingerprint:m.fingerprint||x}});t.addresses=p}},Ove=(t,r)=>{if(t.response_body&&t.response_body.length){const i=t.response_body[0];if(i.buffer.code!==0){const a=bm(i.buffer.code);throw new pe(K.UPDATE_TICKET_FAILED,"[".concat(i.buffer.code,"]: ").concat(a.desc),{retry:a.retry})}return i.buffer.ticket}throw A.debug("update ticket request received ap response without response body:",r),new pe(K.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},U1=(t,r,i)=>{const a=Math.floor(Math.random()*1e12),l=t.role==="host"?"1":t.role==="audience"?"2":void 0,u={appid:t.appId,client_ts:Date.now(),opid:a,sid:t.sid,request_bodies:[{uri:22,buffer:{cname:t.cname,detail:Pc(Pc(Pc({6:t.stringUid,11:r,12:W("USE_NEW_TOKEN")?"1":void 0},l?{17:l}:{}),{},{22:r},t.apRequestDetail?{33:t.apRequestDetail}:{}),t.apRTM?{26:"RTM2"}:{}),key:t.token,service_ids:i,uid:t.uid||0}}]};u.request_bodies.forEach(m=>{t.multiIP&&t.multiIP.gateway_ip&&(m.buffer.detail[5]=JSON.stringify({vocs_ip:[t.multiIP.uni_lbs_ip],vos_ip:[t.multiIP.gateway_ip]}))});const p=new FormData;return p.append("request",JSON.stringify(u)),[p,a]},Pve=(t,r)=>{const i=Math.floor(Math.random()*1e12),a={appid:t.appId,client_ts:Date.now(),opid:i,sid:t.sid,request_bodies:[{uri:28,buffer:{cname:t.cname,detail:{1:"",6:t.stringUid,12:"1"},token:t.token,service_ids:r,uid:t.uid||0,edges_services:t.apResponse.addresses.map(u=>({ip:u.ip,port:u.port}))}}]},l=new FormData;return l.append("request",JSON.stringify(a)),[l,i]};let Em=0;function wm(t){return je.all(t.map(r=>r.then(i=>{throw i},i=>i))).then(r=>{throw r},r=>r)}const D0=async t=>{let{fragementLength:r,referenceList:i,asyncMapHandler:a,allFailedhandler:l,promisesCollector:u}=t,p=0;const m=r;let g,y=0;const x=async()=>{const S=(()=>{const T=p*m,C=T+m;return i.slice(T,C).map(a)})();u&&u.push(...S);try{g=await wm(S)}catch(T){if(y+=m,p++,!(y>=i.length))return void await x();l(T)}S.forEach(T=>T.cancel())};return await x(),g},aG=async t=>{let{referenceList:r,asyncMapHandler:i,closeFn:a}=t;const l=r.length;let u=0;const p=async()=>{const m=i(r.shift());try{return await m}catch(g){if(u++,u>=l||a!=null&&a(g))throw g;return p()}};return p()};async function kve(){if(typeof VideoDecoder>"u")return!0;let t;const r=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,85,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,149,160,133,4,144,43,122,168,159,120,159,205,39,82,131,57,52,87,187,68,23,248,134,204,226,97,17,49,183,55,236,219,249,221,98,208,215,190,59,179,167,213,47,1,246,150,14,194,245,159,83,35,64,103,218,38,21,82,3,135,21,185,84,248,134],i=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,87,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,148,62,134,140,92,172,141,77,35,94,181,164,65,169,65,156,154,43,221,162,11,252,67,102,113,48,136,137,219,62,43,113,239,23,126,250,186,252,10,138,218,25,193,244,74,68,194,209,107,23,52,206,199,78,72,98,103,151,71,96,62,51,210,158,72,231,158],a=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,87,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,143,233,163,51,196,98,95,151,224,22,134,33,240,150,248,67,18,34,196,142,81,238,173,140,80,205,232,132,144,67,12,131,157,4,171,243,86,122,35,6,166,184,243,85,126,13,206,103,152,62,168,160,187,2,241,138,52,211,72,121,128,151,63,147,128,19,42],l=[18,0,50,138,1,48,192,64,253,248,65,17,67,192,32,0,16,0,0,0,0,0,0,0,195,12,48,144,64,32,0,209,75,61,9,204,25,115,79,226,115,63,63,208,70,210,220,153,126,241,237,37,107,195,153,1,99,112,230,189,209,169,130,10,11,22,167,215,159,205,197,7,183,162,26,48,254,141,134,103,32,16,235,45,1,15,18,119,169,110,206,251,51,115,202,60,148,1,46,39,109,25,28,86,168,15,77,211,239,2,58,43,146,26,230,184,81,48,140,226,226,250,222,146,171,133,164,13,188,180,64,122,142,146,32,208,238,170,193,35,53,44,225],u=[18,0,50,107,48,0,133,125,248,65,26,195,64,62,32,31,16,0,0,0,0,0,1,4,16,64,144,64,32,0,204,24,122,65,56,165,18,52,206,218,4,187,51,97,9,29,191,90,253,106,185,31,197,155,52,205,245,185,203,131,20,226,25,124,95,113,220,113,141,15,15,104,211,144,152,237,150,157,127,51,143,24,231,218,171,255,176,241,128,229,149,150,148,66,245,228,91,27,182,228,136,61,182,237,133,45,220,24,103,214,152],p=[18,0,50,122,48,1,9,253,248,65,26,67,64,62,32,31,16,0,0,0,0,0,1,4,16,64,144,64,32,0,198,182,231,242,220,235,163,140,12,36,36,166,46,132,210,4,71,23,218,132,27,30,17,45,244,79,31,243,195,136,100,169,76,88,142,85,204,217,121,168,29,163,198,17,251,223,73,12,212,244,139,123,151,179,75,216,96,208,136,40,229,42,59,149,10,116,228,85,99,93,221,108,255,140,248,20,30,167,122,109,206,164,108,197,110,251,23,243,133,160,63,13,207,177,12,128];return await new je((g,y)=>{let x;(async function(){t&&t.state!=="closed"||await async function(){t=new VideoDecoder({output:T=>{T.close(),clearTimeout(x),g(!0)},error:T=>{clearTimeout(x),g(!1)}}),await t.configure({codec:"av01.0.05M.08",width:160,height:90})}();const S=[r,i,a,l,u,p];for(let T=0;T<S.length;T++){const C=new EncodedVideoChunk({type:T==0?"key":"delta",timestamp:33333*T,duration:33333,data:new Uint8Array(S[T])});try{await t.decode(C)}catch{return void g(!1)}}})(),x=setTimeout(()=>{g(!1)},5e3)})}async function M_(t,r,i,a){return{gatewayInfo:await async function(u,p,m,g){let y=null;const x=[],S=async()=>{const C=W("WEBCS_DOMAIN").slice(0,W("AJAX_REQUEST_CONCURRENT")).map(L=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(L+"/api/v2/transpond/webrtc?v=2"):"https://".concat(L,"/api/v2/transpond/webrtc?v=2"),areaCode:j0()})),V=g.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:C.map(L=>L.url)}),j=await D0({fragementLength:W("FRAGEMENT_LENGTH"),referenceList:C,asyncMapHandler:L=>(A.debug("[".concat(u.clientId,"] Connect to choose_server:"),L.url),rG(L,u,p,m)),allFailedhandler:L=>{throw g.recordJoinChannelService({endTs:Date.now(),status:"error",errors:L},V),L[0]},promisesCollector:x});return g.recordJoinChannelService({endTs:Date.now(),status:"success"},V),j},T=async()=>{if(await Er(1e3),y!==null)return y;const C=W("WEBCS_DOMAIN_BACKUP_LIST").map(L=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(L+"/api/v2/transpond/webrtc?v=2"):"https://".concat(L,"/api/v2/transpond/webrtc?v=2"),areaCode:j0()})),V=g.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:C.map(L=>L.url)}),j=await D0({fragementLength:W("FRAGEMENT_LENGTH"),referenceList:C,asyncMapHandler:L=>(A.debug("[".concat(u.clientId,"] Connect to backup choose_server:"),L.url),rG(L,u,p,m)),allFailedhandler:L=>{throw g.recordJoinChannelService({endTs:Date.now(),status:"error",errors:L},V),L[0]},promisesCollector:x});return g.recordJoinChannelService({endTs:Date.now(),status:"success"},V),j};try{return y=await wm([S(),T()]),x.length&&x.forEach(C=>C.cancel&&typeof C.cancel=="function"&&C.cancel()),y}catch(C){throw C[0]}}(t,r,i,a)}}async function oG(t,r,i,a,l){const u=t.cloudProxyServer;if(u==="disabled"){if(t.useLocalAccessPoint)return await M_(t,r,i,l);if(W("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:T,proxyInfo:C}=await dG(t,r,i,l);if(t.turnServer&&t.turnServer.mode!=="auto")return{gatewayInfo:T};const V=C.map(j=>({turnServerURL:j.address,tcpport:j.tcpport||Zr.tcpport,udpport:j.udpport||Zr.udpport,username:j.username||Zr.username,password:j.password||Zr.password,forceturn:!1,security:!0}));if(l.useP2P){var p;const j=(p=t.uid)!==null&&p!==void 0?p:T.uid,L="glb:".concat(j.toString()),H=await xA(L),Y=C.map(te=>({turnServerURL:te.address,tcpport:te.tcpport||Zr.tcpport,udpport:te.udpport||Zr.udpport,username:L,password:H,forceturn:!1,security:!0}));V.push(...Y)}return t.turnServer={mode:"manual",servers:V},{gatewayInfo:T}}return await M_(t,r,i,l)}const{proxyInfo:m,gatewayInfo:g}=await dG(t,r,i,l),y={gatewayInfo:g},x=m.map(T=>({turnServerURL:T.address,tcpport:u==="proxy3"?void 0:T.tcpport?T.tcpport:Zr.tcpport,udpport:u==="proxy4"?void 0:T.udpport?T.udpport:Zr.udpport,username:T.username||Zr.username,password:T.password||Zr.password,forceturn:u!=="proxy4",security:u==="proxy5"}));if(l.useP2P){var S;const T=(S=t.uid)!==null&&S!==void 0?S:g.uid,C="glb:".concat(T.toString()),V=await xA(C),j=m.map(L=>({turnServerURL:L.address,tcpport:u==="proxy3"?void 0:L.tcpport||Zr.tcpport,udpport:u==="proxy4"?void 0:L.udpport||Zr.udpport,username:C,password:V,forceturn:u!=="proxy4",security:u==="proxy5"}));x.push(...j)}return t.turnServer={mode:"manual",servers:x},A.debug("[".concat(t.clientId,"] set proxy server: ").concat(t.proxyServer,", mode: ").concat(u)),y}async function cG(t,r,i,a,l){const u=W("ACCOUNT_REGISTER").slice(0,W("AJAX_REQUEST_CONCURRENT"));let p=[];p=r.proxyServer?u.map(g=>"https://".concat(r.proxyServer,"/ap/?url=").concat(g+"/api/v1")):u.map(g=>"https://".concat(g,"/api/v1"));const m=l==null?void 0:l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:p});try{const g=await async function(y,x,S,T,C){const V=Date.now(),j={sid:S.sid,opid:10,appid:S.appId,string_uid:x};let L=y[0];const H=await Uo(()=>$o(L+"".concat(L.indexOf("?")===-1?"?":"&","action=stringuid"),{data:j,cancelToken:T,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(Y,te)=>{if(Y.code===0){if(Y.uid<=0||Y.uid>=Math.pow(2,32))throw A.error("Invalid Uint Uid ".concat(x," => ").concat(Y.uid),Y),Ye.reqUserAccount(j.sid,{lts:V,success:!1,serverAddr:L,stringUid:j.string_uid,uid:Y.uid,errorCode:K.INVALID_UINT_UID_FROM_STRING_UID,extend:j}),new pe(K.INVALID_UINT_UID_FROM_STRING_UID);return Ye.reqUserAccount(j.sid,{lts:V,success:!0,serverAddr:L,stringUid:j.string_uid,uid:Y.uid,errorCode:null,extend:j}),!1}const se=bm(Y.code);return se.retry&&(L=y[(te+1)%y.length]),Ye.reqUserAccount(j.sid,{lts:V,success:!1,serverAddr:L,stringUid:j.string_uid,uid:Y.uid,errorCode:se.desc,extend:j}),se.retry},(Y,te)=>Y.code!==K.OPERATION_ABORTED&&(Ye.reqUserAccount(j.sid,{lts:V,success:!1,serverAddr:L,stringUid:j.string_uid,uid:null,errorCode:Y.code,extend:j}),L=y[(te+1)%y.length],!0),C);if(H.code!==0){const Y=bm(H.code);throw new pe(K.UNEXPECTED_RESPONSE,Y.desc)}return H}(p,t,r,i,a);return l==null||l.recordJoinChannelService({status:"success",endTs:Date.now()},m),g.uid}catch(g){throw l==null||l.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[g]},m),g}}async function jve(t,r,i){const a=W("ACCOUNT_REGISTER");let l=[];l=r.proxyServer?a.map(u=>"https://".concat(r.proxyServer,"/ap/?url=").concat(u+"/api/v1")):a.map(u=>"https://".concat(u,"/api/v1"));try{return await aG({referenceList:l,asyncMapHandler:p=>async function(m,g,y,x){const S=Date.now(),T={sid:y.sid,opid:10,appid:y.appId,string_uid:g};try{const C=await $o(m+"".concat(m.indexOf("?")===-1?"?":"&","action=stringuid"),{data:T,cancelToken:x,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(C.code!==0){const V=bm(C.code);throw new pe(K.UNEXPECTED_RESPONSE,"preload sua error:".concat(V.desc),V)}if(C.uid<=0||C.uid>=Math.pow(2,32))throw new pe(K.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:S,url:m,req:T,uid:C.uid,elapse:Date.now()-S}}catch(C){throw C}}(p,t,r,i),closeFn:p=>p.code===K.OPERATION_ABORTED||p.code===K.UNEXPECTED_RESPONSE&&!p.data.retry})}catch(u){throw u}}async function Dve(t,r,i){const a=W("CDS_AP").slice(0,W("AJAX_REQUEST_CONCURRENT")).map(g=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(g+"/api/v1"):"https://".concat(g,"/api/v1?action=config")),l=a.map(g=>function(y,x,S,T){const C=Ht(),V={flag:64,cipher_method:0,features:Pc(Pc(Pc(Pc(Pc({install_id:kA(),device:C.name,system:C.os,system_general:navigator.userAgent,vendor:x.appId,version:fa,cname:x.cname,session_id:x.sid,proxyServer:x.proxyServer,sdk_type:Tve.WEB_RTC,browser_name:C.name,browser_version:C.version,user_agent:navigator.userAgent,channel_name:x.cname},x.stringUid&&{string_uid:x.stringUid}),x.uid&&{uid:x.uid+""}),C.os&&{os_name:C.os}),C.osVersion&&{os_version:C.osVersion}),{},{detail:""})};return Uo(()=>$o(y,{data:V,timeout:1e3,cancelToken:S,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,j=>j.code!==K.OPERATION_ABORTED,T)}(g,t,r,i));let u=null,p=null,m={};try{u=await wm(l)}catch(g){if(g.code===K.OPERATION_ABORTED)throw g;p=g}if(l.forEach(g=>g.cancel()),Ye.reportApiInvoke(t.sid,{name:Cn.REQUEST_CONFIG_DISTRIBUTE,options:{error:p,res:u}}).onSuccess(),u&&u.test_tags)try{m=function(g){if(!g.test_tags)return{};const y=g.test_tags,x=Object.keys(y),S={};return x.forEach(T=>{var C;const V=Ii(C=T.slice(4)).call(C),j=JSON.parse(y[T]),L=j[1];S[V]={tag:j[0]||"",value:L}}),S}(u)}catch{}return m}async function lG(t,r){const i=W("WEBCS_DOMAIN").concat(W("WEBCS_DOMAIN_BACKUP_LIST")).map(a=>({url:"https://".concat(a,"/api/v2/transpond/webrtc?v=2"),areaCode:j0(),serviceIds:[tr.CHOOSE_SERVER,tr.CLOUD_PROXY_FALLBACK]}));try{return await aG({referenceList:i,asyncMapHandler:l=>async function(u,p,m){let g,{url:y,areaCode:x,serviceIds:S}=u;const T=Date.now(),[C,V]=U1(p,x,S);let j=Un.networkState;try{j&&Un.networkState===Pi.OFFLINE&&Un.onlineWaiter&&await je.race([Un.onlineWaiter,Er(er.maxRetryTimeout)]),j=Un.networkState;const{data:L,headers:H}=await $o(y,{data:C,cancelToken:m,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);g=H.http3==="1"?1:-1,(oe=>{const ne=[];if(oe.response_body.forEach(de=>{const be=de.buffer.code;if(de.uri===23&&be===0&&!de.buffer.edges_services)if(de.buffer.flag===4194310)de.buffer.edges_services=[];else{const Se={error:new pe(K.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:W("NO_EDGES_RETRY"),csIp:oe.detail[502]}),flag:de.buffer.flag};ne.push(Se)}if(be!==0){const Se=bm(be),Be={error:new pe(K.CAN_NOT_GET_GATEWAY_SERVER,Se.desc,{desc:Se.desc,retry:Se.retry,csIp:oe.detail[502]}),flag:de.buffer.flag};de.buffer.flag===4194310?A.warning(Be.error.toString()):ne.push(Be)}}),ne.length)throw new pe(K.CAN_NOT_GET_GATEWAY_SERVER,ne.map(de=>"flag: ".concat(de.flag,", message: ").concat(de.error.message)).join(" | "),{retry:!!ne.find(de=>de.error.data.retry),csIp:oe.detail[502],desc:[...new Set(ne.map(de=>{var be;return de==null||(be=de.error)===null||be===void 0||(be=be.data)===null||be===void 0?void 0:be.desc}).filter(de=>!!de))]})})(L);const te=R0(L,tr.CHOOSE_SERVER),se=R0(L,tr.CLOUD_PROXY_FALLBACK);return M1(te),{gatewayInfo:w1(te,y),proxyInfo:se,opid:V,requestTime:T,url:y,isHttp3:g,elapse:Date.now()-T}}catch(L){throw L}}(l,t,r),closeFn:l=>l.code===K.OPERATION_ABORTED||l.code===K.CAN_NOT_GET_GATEWAY_SERVER&&!l.data.retry})}catch(a){throw a}}async function dG(t,r,i,a){const l=W("PROXY_SERVER_TYPE3"),u=(C,V,j)=>{let L=j||l;return Array.isArray(L)&&(L=V%2==0&&l[1]||l[0]),"https://".concat(L,"/ap/?url=").concat(C)};let p=null;const m=[],g=async()=>{const C=W("WEBCS_DOMAIN").slice(0,W("AJAX_REQUEST_CONCURRENT")).map((L,H)=>{let Y;return Y=t.cloudProxyServer==="disabled"&&t.proxyServer?u("".concat(L,"/api/v2/transpond/webrtc?v=2"),H,t.proxyServer):t.cloudProxyServer==="disabled"||t.cloudProxyServer==="fallback"?"https://".concat(L,"/api/v2/transpond/webrtc?v=2"):u("".concat(L,"/api/v2/transpond/webrtc?v=2"),H),{url:Y,areaCode:j0(),serviceIds:[tr.CHOOSE_SERVER,t.cloudProxyServer==="proxy5"?tr.CLOUD_PROXY_5:t.cloudProxyServer==="proxy3"||t.cloudProxyServer==="proxy4"?tr.CLOUD_PROXY:tr.CLOUD_PROXY_FALLBACK]}}),V=a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:C.map(L=>L.url)}),j=await D0({fragementLength:W("FRAGEMENT_LENGTH"),referenceList:C,asyncMapHandler:L=>(A.debug("[".concat(t.clientId,"] Connect to choose_server:"),L.url),iG(L,t,r,i)),allFailedhandler:L=>{throw a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:L},V),L[0]},promisesCollector:m});return a.recordJoinChannelService({endTs:Date.now(),status:"success"},V),j},y=async()=>{if(await Er(1e3),p!==null)return p;const C=W("WEBCS_DOMAIN_BACKUP_LIST").map((L,H)=>{let Y;return Y=t.cloudProxyServer==="disabled"&&t.proxyServer?u("".concat(L,"/api/v2/transpond/webrtc?v=2"),H,t.proxyServer):t.cloudProxyServer==="disabled"||t.cloudProxyServer==="fallback"?"https://".concat(L,"/api/v2/transpond/webrtc?v=2"):u("".concat(L,"/api/v2/transpond/webrtc?v=2"),H),{url:Y,areaCode:j0(),serviceIds:[tr.CHOOSE_SERVER,t.cloudProxyServer==="proxy5"?tr.CLOUD_PROXY_5:t.cloudProxyServer==="proxy3"||t.cloudProxyServer==="proxy4"?tr.CLOUD_PROXY:tr.CLOUD_PROXY_FALLBACK]}}),V=a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:C.map(L=>L.url)}),j=await D0({fragementLength:W("FRAGEMENT_LENGTH"),referenceList:C,asyncMapHandler:L=>(A.debug("[".concat(t.clientId,"] Connect to backup choose_server:"),L.url),iG(L,t,r,i)),allFailedhandler:L=>{throw a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:L},V),L[0]},promisesCollector:m});return a.recordJoinChannelService({endTs:Date.now(),status:"success"},V),j};let x,S,T;try{({gatewayInfo:x,proxyInfo:S,url:T}=await wm([g(),y()]))}catch(C){throw C[0]}if(m.length&&m.forEach(C=>C.cancel&&typeof C.cancel=="function"&&C.cancel()),!x||!S)throw new pe(K.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(t.apUrl=T,t.cloudProxyServer!=="disabled"&&Array.isArray(l)&&T){const C=/^https?:\/\/(.+?)(\/.*)?$/.exec(T)[1];Ce(l).call(l,C)&&(t.proxyServer=C,A.setProxyServer(C),Ye.setProxyServer(C))}return p={gatewayInfo:x,proxyInfo:await j8(S,x.uid)},p}async function Lve(t,r,i){const a=W("UAP_AP").slice(0,W("AJAX_REQUEST_CONCURRENT")).map(u=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(u+"/api/v1?action=uap"):"https://".concat(u,"/api/v1?action=uap")),l=a.map(u=>function(p,m,g,y){const x={command:"convergeAllocateEdge",sid:m.sid,appId:m.appId,token:m.token,ts:Date.now(),version:fa,cname:m.cname,uid:m.uid.toString(),requestId:L1,seq:L1};L1+=1;const S={service_name:"tele_channel",json_body:JSON.stringify(x)};return Uo(async()=>{const T=await $o(p,{data:S,cancelToken:g,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(T.code!==0){const V=new pe(K.UNEXPECTED_RESPONSE,"cross channel ap error, code"+T.code,{retry:!0});throw A.error(V.toString()),V}const C=JSON.parse(T.json_body);if(C.code!==200){const V=new pe(K.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(C.code,", reason: ").concat(C.reason));throw A.error(V.toString()),V}if(!C.servers||C.servers.length===0){const V=new pe(K.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw A.error(V.toString()),V}return{vid:C.vid,workerToken:C.workerToken,addressList:(W("CHANNEL_MEDIA_RELAY_SERVERS")||C.servers).map(V=>"wss://".concat(V.address.replace(/\./g,"-"),".").concat(W("WORKER_DOMAIN"),":").concat(V.wss))}},void 0,T=>!!(T.code!==K.OPERATION_ABORTED&&T.code!==K.UNEXPECTED_RESPONSE||T.data&&T.data.retry),y)}(u,t,r,i));try{const u=await wm(l);return l.forEach(p=>p.cancel()),u}catch(u){throw u[0]}}async function Mve(t,r,i){let a=null;const l=[],u=async p=>{const m=W(p?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(g=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(g+"/api/v2/transpond/webrtc?v=2"):"https://".concat(g,"/api/v2/transpond/webrtc?v=2"));return p&&(await Er(1e3),a!==null)?a:await D0({fragementLength:W("FRAGEMENT_LENGTH"),referenceList:m,asyncMapHandler:g=>(A.debug("[".concat(t.clientId,"] update ticket, Connect to ").concat(p?"backup":""," choose_server:"),g),function(y,x,S,T){const[C]=Pve(x,[tr.CHOOSE_SERVER]);let V=Un.networkState;return Uo(async()=>{V&&Un.networkState===Pi.OFFLINE&&Un.onlineWaiter&&await je.race([Un.onlineWaiter,Er(T&&T.maxRetryTimeout||er.maxRetryTimeout)]),V=Un.networkState;const j=await $o(y,{data:C,cancelToken:S,headers:{"Content-Type":"multipart/form-data;"}},!0);return Ove(j,y)},()=>!1,j=>j.code!==K.OPERATION_ABORTED&&(j.code===K.UPDATE_TICKET_FAILED?j.data.retry:(A.warning("[".concat(x.clientId,"] update ticket network error, retry"),j),!0)),T)}(g,t,r,i)),allFailedhandler:g=>{throw g[0]},promisesCollector:l})};try{return a=await wm([u(!1),u(!0)]),l.length&&l.forEach(p=>p.cancel&&typeof p.cancel=="function"&&p.cancel()),a}catch(p){throw p[0]}}function uG(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function F1(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?uG(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):uG(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}class Uve extends Pn{get isSuccess(){return!!this.configs}constructor(r,i){super(),F(this,"configs",void 0),F(this,"store",void 0),F(this,"joinInfo",void 0),F(this,"cancelToken",void 0),F(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),F(this,"interval",void 0),F(this,"mutex",void 0),F(this,"mutableParamsRead",!1),F(this,"configCache",{}),F(this,"limit_bitrate",void 0),this.mutex=new kr("config-distribute",r),this.store=i}startGetConfigDistribute(r,i){this.joinInfo=r,this.cancelToken=i,this.interval&&this.stopGetConfigDistribute(),W("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},W("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,Ye.reportApiInvoke(null,{options:void 0,name:Cn.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:hn.TRACER}).onSuccess(JSON.stringify($s))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void A.debug("[config-distribute] get config distribute interrupted have no joininfo");let r;const i=await this.mutex.lock();try{r=await Dve(this.joinInfo,this.cancelToken,this.retryConfig),A.debug("[config-distribute] get config distribute",JSON.stringify(r));const a=function(l){var u;const p=Ou(u=Object.keys(l).filter(y=>/^webrtc_ng_global_parameter/.test(y))).call(u);for(let y=0;y<p.length;y++)for(let x=p.length-1;x>y;x--){const S=p[x],T=l[S].value;if(typeof T.__priority=="number"){const C=T.__priority,V=p[x-1],j=l[V].value;if(typeof j.__priority=="number"){if(!(C>j.__priority))continue;{const L=S;p[x]=p[x-1],p[x-1]=L}}else{const L=S;p[x]=p[x-1],p[x-1]=L}}}const m=Date.now(),g={};return p.forEach(y=>{const x=l[y].value.__expires;x&&x<=m||(g[y]=l[y])}),g}(r);this.cacheGlobalParameterConfig(a),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=a}catch(a){const l=new pe(K.NETWORK_RESPONSE_ERROR,a);A.warning("[config-distribute] ".concat(l.toString()))}finally{i()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(r){T8(r)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==r.id&&this.emit(Bo.UPDATE_BITRATE_LIMIT,r):this.emit(Bo.UPDATE_BITRATE_LIMIT,r))}getLowStreamConfigDistribute(){return this.limit_bitrate&&F1({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(r){try{const i={},a=Object.keys(r),l=[];a.forEach(u=>{const p=r[u].value;i[u]=p;const m=p.__id;if(m&&this.configCache[u]&&this.configCache[u].__id===m)return;const g=p.__type,y=r[u].value,x=r[u].tag;let S=0;g?g===$V.REALTIME&&(S=1):Object.keys(y).some(T=>Object.prototype.hasOwnProperty.call(MA,T)||!u1()&&Object.prototype.hasOwnProperty.call(e_,T)?(S=1,!0):void 0),l.push({tag:x,isApplied:S,feature:u,params:JSON.stringify(p)})}),l.forEach(u=>{let{tag:p,feature:m,params:g,isApplied:y}=u;this.store.sessionId&&Ye.abTest(this.store.sessionId,{intSucc:1,isApplied:y,tag:p,feature:m,params:g,cid:this.store.cid,uid:this.store.intUid})}),this.configCache=i}catch(i){A.debug("handleABTestConfigDistribute error",i)}}cacheGlobalParameterConfig(r){const i=function(l){const u={};return Object.keys(l).forEach(p=>{const m=l[p].value,g=m.__expires,y=m.__type;Object.keys(m).forEach(x=>{x==="__id"||x==="__type"||x==="__priority"||x==="__expires"||Object.prototype.hasOwnProperty.call(u,x)||(u[x]=F1(F1({value:m[x]},g&&{expires:g}),y&&{type:y}))})}),u}(r);try{var a;const l=(a=i.LIMIT_BITRATE)===null||a===void 0?void 0:a.value;delete i.LIMIT_BITRATE,l&&T8(l)&&this.handleBitrateLimit(l),this.limit_bitrate=l,this.handleGlobalParameterConfig(i),this.handleABTestConfigDistribute(r),function(m){try{const g=Date.now();Object.keys(m).forEach(y=>{const{value:x,type:S,expires:T}=m[y];T&&T<=g||((S===$V.REALTIME||Object.prototype.hasOwnProperty.call(MA,y))&&($s[y]=x,nn[y]=x,A.debug("Update realtime parameters from config distribute",y,x)),S||u1()||!Object.prototype.hasOwnProperty.call(e_,y)||($s[y]=x,nn[y]=x,A.debug("Update gateway parameters from config distribute",y,x)))})}catch(g){A.error("Error update config immediately: ".concat(m),g.message)}}(i);const u=JSON.stringify(i),p=window.btoa(u);window.localStorage.setItem("websdk_ng_global_parameter",p),A.debug("Caching global parameters ".concat(u))}catch(l){A.error("Error caching global parameters:",l.message)}}handleGlobalParameterConfig(r){try{const i=Date.now();Object.keys(r).forEach(a=>{switch(a){case"CLIENT_ROLE_OPTIONS":if(Object.prototype.hasOwnProperty.call(nn,a)){const{value:u,expires:p}=r[a];if(p&&p<=i)return;TA(nn[a],u)||($s[a]=u,nn[a]=u,this.emit(Bo.UPDATE_CLIENT_ROLE_OPTIONS,u),A.debug("Updating client role options: ".concat(JSON.stringify(u))))}break;case"REMOTE_VIDEO_STREAM_TYPE":if(Object.prototype.hasOwnProperty.call(nn,a)){var l;const{value:u,expires:p}=r[a];if(p&&p<=i)return;typeof u=="number"&&Ce(l=[0,1,4,5,6,7,8,9]).call(l,u)&&($s[a]={value:u},nn[a]=u,this.emit(Bo.UPDATE_REMOTE_VIDEO_STREAM_TYPE,u),A.debug("Updating client remote stream type: ".concat(JSON.stringify(u))))}break;case"ENABLE_FORCE_HLS":if(Object.prototype.hasOwnProperty.call(nn,a)){const{value:u,expires:p}=r[a];if(p&&p<=i)return;TA(nn[a],u)||($s[a]=u,nn[a]=u,this.emit(Bo.FALLBACK_TO_HLS,u),A.debug("Updating enable force hls: ".concat(JSON.stringify(u))))}break;case"VOS_CONFIGURE":if(Object.prototype.hasOwnProperty.call(nn,a)){const{value:u,expires:p}=r[a];if(p&&p<=i)return;TA(nn[a],u)||($s[a]=u,nn[a]=u,this.emit(Bo.UPDATE_VOS_CONFIGURE,u),A.debug("Updating vos configure: ".concat(JSON.stringify(u))))}}})}catch(i){A.error("Error handling global parameter config:",i.message)}}}class Fve extends Pn{constructor(){super(...arguments),F(this,"resultStorage",new Map)}setLocalAudioStats(r,i,a){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",r,this.checkAudioInputLevel(a,i)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",r,this.checkSendAudioBitrate(a,i))}setLocalVideoStats(r,i,a){this.record("SEND_VIDEO_BITRATE_TOO_LOW",r,this.checkSendVideoBitrate(a,i)),this.record("FRAMERATE_INPUT_TOO_LOW",r,this.checkFramerateInput(a,i)),this.record("FRAMERATE_SENT_TOO_LOW",r,this.checkFramerateSent(a)),!i.muted&&this.record("VIDEO_ENCODE_FAILED",r,this.checResolutionSent(a))}setRemoteAudioStats(r,i){const a=r.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",a,this.checkAudioOutputLevel(i))}setRemoteVideoStats(r,i){const a=r.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",a,this.checkVideoDecode(i))}record(r,i,a){if(W("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(r)||this.resultStorage.set(r,{result:[],isPrevNormal:!0});const l=this.resultStorage.get(r);if(!l)return;l.result.push(a);const u=r==="VIDEO_ENCODE_FAILED"?W("ENCODE_EXCEPTION_TIMES"):5;if(l.result.length>=u){var p;const m=Ce(p=l.result).call(p,!0);l.isPrevNormal&&!m&&this.emit("exception",V1[r],r,i),!l.isPrevNormal&&m&&this.emit("exception",V1[r]+2e3,r+"_RECOVER",i),l.isPrevNormal=m,l.result=[]}}checkAudioOutputLevel(r){return!(r.receiveBitrate>0&&r.receiveLevel===0)}checkAudioInputLevel(r,i){return i instanceof pr&&!i.isActive||!!i.muted||r.sendVolumeLevel!==0}checkFramerateInput(r,i){let a=null;i._encoderConfig&&i._encoderConfig.frameRate&&(a=qi(i._encoderConfig.frameRate));const l=r.captureFrameRate;return!a||!l||!(a>10&&l<5||a<10&&a>=5&&l<=1)}checkFramerateSent(r){return!(r.captureFrameRate&&r.sendFrameRate&&r.captureFrameRate>5&&r.sendFrameRate<=1)}checResolutionSent(r){var i;return!(!r.codecType||Ce(i=W("ENCODE_EXCEPTION_VALIDATE_CODEC")).call(i,r.codecType.toLocaleLowerCase()))||!r.captureFrameRate||r.sendFrameRate!==0||r.sendResolutionWidth!==0||r.sendResolutionHeight!==0}checkSendVideoBitrate(r,i){return!!i.muted||r.sendBitrate!==0}checkSendAudioBitrate(r,i){return i instanceof pr&&!i.isActive||!!i.muted||r.sendBitrate!==0}checkVideoDecode(r){return r.receiveBitrate===0||r.decodeFrameRate!==0}}const V1={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003,VIDEO_ENCODE_FAILED:2004},ai=new class{markSubscribeStart(t,r){performance.mark("agora-web-sdk/".concat(t,"/subscribe-").concat(r))}markPublishStart(t,r){performance.mark("agora-web-sdk/".concat(t,"/publish-").concat(r))}measureFromSubscribeStart(t,r){const i=performance.getEntriesByName("agora-web-sdk/".concat(t,"/subscribe-").concat(r));if(i.length>0){const a=i[i.length-1];return Math.round(performance.now()-a.startTime)}return 0}measureFromPublishStart(t,r){const i=performance.getEntriesByName("agora-web-sdk/".concat(t,"/publish-").concat(r));if(i.length>0){const a=i[i.length-1];return Math.round(performance.now()-a.startTime)}return 0}};function hG(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function ah(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?hG(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):hG(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}class L0{constructor(r){F(this,"store",void 0),F(this,"onStatsException",void 0),F(this,"onUploadPublishDuration",void 0),F(this,"onStatsChanged",void 0),F(this,"onVideoCodecChanged",void 0),F(this,"localStats",new Map),F(this,"remoteStats",new Map),F(this,"updateStatsInterval",void 0),F(this,"trafficStats",void 0),F(this,"trafficStatsPeerList",[]),F(this,"uplinkStats",void 0),F(this,"exceptionMonitor",void 0),F(this,"p2pChannel",void 0),F(this,"scalabilityMode",Qx.L1T1),F(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=r,this.exceptionMonitor=new Fve,this.exceptionMonitor.on("exception",(i,a,l)=>{this.onStatsException&&this.onStatsException(i,a,l)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Re.LocalAudioTrack)||ah({},WA)}getLocalVideoTrackStats(){return this.localStats.get(Re.LocalVideoTrack)||ah({},$A)}getRemoteAudioTrackStats(r){const i=(u,p)=>{if(!this.trafficStats)return p;const m=this.trafficStats.peer_delay.find(g=>g.peer_uid===u);return m&&(p.publishDuration=m.B_ppad+(Date.now()-this.trafficStats.timestamp)),p},a={};if(r){var l;const u=(l=this.remoteStats.get(r))===null||l===void 0?void 0:l.audioStats;u&&(a[r]=i(r,u))}else Array.from(this.remoteStats.entries()).forEach(u=>{let[p,{audioStats:m}]=u;m&&(a[p]=i(p,m))});return a}getRemoteNetworkQualityStats(r){const i={};if(r){var a;const l=(a=this.remoteStats.get(r))===null||a===void 0?void 0:a.networkStats;l&&(i[r]=l)}else Array.from(this.remoteStats.entries()).forEach(l=>{let[u,{networkStats:p}]=l;p&&(i[u]=p)});return i}getNetworkQuality(){let r=0,i=0;return this.trafficStats&&(r=R_(this.trafficStats.B_unq),i=R_(this.trafficStats.B_dnq)),{uplinkNetworkQuality:r,downlinkNetworkQuality:i}}getRemoteVideoTrackStats(r){const i=(u,p)=>{if(!this.trafficStats)return p;const m=this.trafficStats.peer_delay.find(g=>g.peer_uid===u);return m&&(p.publishDuration=m.B_ppvd+(Date.now()-this.trafficStats.timestamp)),p},a={};if(r){var l;const u=(l=this.remoteStats.get(r))===null||l===void 0?void 0:l.videoStats;u&&(a[r]=i(r,u))}else Array.from(this.remoteStats.entries()).forEach(u=>{let[p,{videoStats:m}]=u;m&&(a[p]=i(p,m))});return a}getRTCStats(){let r=0,i=0,a=0,l=0;const u=this.localStats.get(Re.LocalAudioTrack);u&&(r+=u.sendBytes,i+=u.sendBitrate);const p=this.localStats.get(Re.LocalVideoTrack);p&&(r+=p.sendBytes,i+=p.sendBitrate);const m=this.localStats.get(Re.LocalVideoLowTrack);m&&(r+=m.sendBytes,i+=m.sendBitrate),this.remoteStats.forEach(y=>{let{audioStats:x,videoStats:S}=y;x&&(a+=x.receiveBytes,l+=x.receiveBitrate),S&&(a+=S.receiveBytes,l+=S.receiveBitrate)});let g=1;return this.trafficStats&&(g+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:g,SendBitrate:i,SendBytes:r,RecvBytes:a,RecvBitrate:l,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(r){this.localStats.set(r,void 0)}removeLocalStats(r){r?this.localStats.delete(r):this.localStats.clear()}addRemoteStats(r){this.remoteStats.set(r,{})}removeRemoteStats(r){r?this.remoteStats.delete(r):this.remoteStats.clear()}addP2PChannel(r){this.p2pChannel=r}updateTrafficStats(r){r.peer_delay=r.peer_delay.filter(i=>i.B_ppad!==void 0||i.B_ppvd!==void 0),r.peer_delay.filter(i=>this.trafficStatsPeerList.indexOf(i.peer_uid)===-1).forEach(i=>{var a;const l=(a=this.p2pChannel)===null||a===void 0?void 0:a.getRemoteMedia(i.peer_uid),u=l!=null&&l.videoSSRC?ai.measureFromSubscribeStart(this.store.clientId,l.videoSSRC):0,p=l!=null&&l.audioSSRC?ai.measureFromSubscribeStart(this.store.clientId,l.audioSSRC):0;i.B_ppad!==void 0&&i.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(i.peer_uid,i.B_ppad,i.B_ppvd,u>p?u:p),this.trafficStatsPeerList.push(i.peer_uid))}),this.trafficStats=r}updateUplinkStats(r){this.uplinkStats&&this.uplinkStats.B_fir!==r.B_fir&&A.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(r.B_fir)),this.uplinkStats=r}static isRemoteVideoFreeze(r,i,a){if(!r)return!1;const l=!!a&&i.framesDecodeFreezeTime>a.framesDecodeFreezeTime,u=!a||i.framesDecodeCount>a.framesDecodeCount;return l||!u}static isRemoteAudioFreeze(r){return!!r&&r._isFreeze()}isLocalVideoFreeze(r){return!(!r.inputFrame||!r.sentFrame)&&r.inputFrame.frameRate>5&&r.sentFrame.frameRate<3}updateLocalStats(r){Array.from(this.localStats.entries()).forEach(i=>{let[a,l]=i;switch(a){case Re.LocalVideoTrack:case Re.LocalVideoLowTrack:{const m=l,g=ah({},$A),y=r.getStats(),x=r.getLocalMedia(a);if(y){const S=y.videoSend.find(T=>T.ssrc===(x==null?void 0:x.ssrcs[0].ssrcId));if(S){const T=r.getLocalVideoSize(),C=r.getEncoderConfig(Re.LocalVideoTrack);var u;(S.codec==="H264"||S.codec==="H265"||S.codec==="VP8"||S.codec==="VP9"||S.codec==="AV1X"||S.codec==="AV1")&&(g.codecType=S.codec,(m==null?void 0:m.codecType)!==S.codec&&((u=this.onVideoCodecChanged)===null||u===void 0||u.call(this,S.codec.toLocaleLowerCase()))),g.sendBytes=S.bytes,g.sendBitrate=m?8*Math.max(0,g.sendBytes-m.sendBytes):0,S.inputFrame?(g.captureFrameRate=S.inputFrame.frameRate,g.captureResolutionHeight=S.inputFrame.height,g.captureResolutionWidth=S.inputFrame.width):T&&(g.captureResolutionWidth=T.width,g.captureResolutionHeight=T.height),S.sentFrame?(g.sendFrameRate=S.sentFrame.frameRate,g.sendResolutionHeight=S.sentFrame.height,g.sendResolutionWidth=S.sentFrame.width):T&&(g.sendResolutionWidth=T.width,g.sendResolutionHeight=T.height),S.avgEncodeMs&&(g.encodeDelay=S.avgEncodeMs),C&&C.bitrateMax?g.targetSendBitrate=1e3*C.bitrateMax:S.targetBitrate&&(g.targetSendBitrate=S.targetBitrate),g.sendPackets=S.packets,g.sendPacketsLost=S.packetsLost,g.sendJitterMs=S.jitterMs,g.sendRttMs=S.rttMs,g.totalDuration=m?m.totalDuration+1:1,g.totalFreezeTime=m?m.totalFreezeTime:0,this.isLocalVideoFreeze(S)&&(g.totalFreezeTime+=1),S.scalabilityMode&&this.scalabilityMode!==S.scalabilityMode&&(A.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(S.scalabilityMode)),this.scalabilityMode=S.scalabilityMode)}this.trafficStats&&(g.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var p;this.localStats.set(a,g),((m==null?void 0:m.sendResolutionWidth)!==g.sendResolutionWidth||(m==null?void 0:m.sendResolutionHeight)!==g.sendResolutionHeight)&&((p=this.onStatsChanged)===null||p===void 0||p.call(this,"resolution",{width:g.sendResolutionWidth,height:g.sendResolutionHeight})),g&&x&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,x.track,g);break}case Re.LocalAudioTrack:{const m=l,g=ah({},WA),y=r.getStats(),x=r.getLocalMedia(a);if(y){const S=y.audioSend.find(T=>T.ssrc===(x==null?void 0:x.ssrcs[0].ssrcId));if(S){if(S.codec!=="opus"&&S.codec!=="aac"&&S.codec!=="PCMU"&&S.codec!=="PCMA"&&S.codec!=="G722"||(g.codecType=S.codec),S.inputLevel)g.sendVolumeLevel=Math.round(32767*S.inputLevel);else{const T=r.getLocalAudioVolume();T&&(g.sendVolumeLevel=Math.round(32767*T))}g.sendBytes=S.bytes,g.sendPackets=S.packets,g.sendPacketsLost=S.packetsLost,g.sendJitterMs=S.jitterMs,g.sendRttMs=S.rttMs,g.sendBitrate=m?8*Math.max(0,g.sendBytes-m.sendBytes):0}}this.trafficStats&&(g.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(Re.LocalAudioTrack,g),g&&x&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,x.track,g);break}}})}updateRemoteStats(r){Array.from(this.remoteStats.entries()).forEach(i=>{var a,l;let[u,{videoStats:p,audioStats:m,videoPcStats:g}]=i;const y=m,x=p,S=g,T=ah({},i6),C=ah({},s6),V=ah({},S0e),{audioTrack:j,videoTrack:L,audioSSRC:H,videoSSRC:Y}=r.getRemoteMedia(u);let te;te=this.store.useP2P?r.getStats(!0):r.getStats();const se=(a=te)===null||a===void 0?void 0:a.audioRecv.find(be=>be.ssrc===H),oe=(l=te)===null||l===void 0?void 0:l.videoRecv.find(be=>be.ssrc===Y),ne=this.trafficStats&&this.trafficStats.peer_delay.find(be=>be.peer_uid===u);if(se&&(se.codec!=="opus"&&se.codec!=="aac"&&se.codec!=="PCMU"&&se.codec!=="PCMA"&&se.codec!=="G722"||(T.codecType=se.codec),se.outputLevel?T.receiveLevel=Math.round(32767*se.outputLevel):j&&(T.receiveLevel=Math.round(32767*j.getVolumeLevel())),T.receiveBytes=se.bytes,T.receivePackets=se.packets,T.receivePacketsLost=se.packetsLost,T.receivePacketsDiscarded=se.packetsDiscarded,T.packetLossRate=T.receivePacketsLost/(T.receivePackets+T.receivePacketsLost),T.receiveBitrate=y?8*Math.max(0,T.receiveBytes-y.receiveBytes):0,T.totalDuration=y?y.totalDuration+1:1,T.totalFreezeTime=y?y.totalFreezeTime:0,T.freezeRate=T.totalFreezeTime/T.totalDuration,T.receiveDelay=se.jitterBufferMs,T.totalDuration>10&&L0.isRemoteAudioFreeze(j)&&(T.totalFreezeTime+=1)),oe){var de;oe.codec!=="H264"&&oe.codec!=="H265"&&oe.codec!=="VP8"&&oe.codec!=="VP9"&&oe.codec!=="AV1X"&&oe.codec!=="AV1"||(C.codecType=oe.codec),C.receiveBytes=oe.bytes,C.receiveBitrate=x?8*Math.max(0,C.receiveBytes-x.receiveBytes):0,C.decodeFrameRate=oe.decodeFrameRate<0?0:oe.decodeFrameRate,C.renderFrameRate=oe.decodeFrameRate<0?0:oe.decodeFrameRate,oe.outputFrame&&(C.renderFrameRate=oe.outputFrame.frameRate),oe.receivedFrame?(C.receiveFrameRate=oe.receivedFrame.frameRate,C.receiveResolutionHeight=oe.receivedFrame.height,C.receiveResolutionWidth=oe.receivedFrame.width):L&&(C.receiveResolutionHeight=L._videoHeight||0,C.receiveResolutionWidth=L._videoWidth||0),oe.framesRateFirefox!==void 0&&(C.receiveFrameRate=Math.round(oe.framesRateFirefox)),C.receivePackets=oe.packets,C.receivePacketsLost=oe.packetsLost,C.packetLossRate=C.receivePacketsLost/(C.receivePackets+C.receivePacketsLost);const be=x?x.totalFreezeTime:0,Se=x?x.totalDuration:0;C.totalDuration=x?x.totalDuration+1:1,C.totalFreezeTime=(de=oe.totalFreezesDuration)!==null&&de!==void 0?de:be||0,C.receiveDelay=oe.jitterBufferMs||0;const Be=!!Y&&r.getRemoteVideoIsReady(Y);oe.totalFreezesDuration===void 0&&L&&Be&&L0.isRemoteVideoFreeze(L,oe,S)&&(C.totalFreezeTime+=1),C.freezeRate=Math.max(0,Math.min((C.totalFreezeTime-be)/(C.totalDuration-Se),1))}ne&&(T.end2EndDelay=ne.B_ad,C.end2EndDelay=ne.B_vd,T.transportDelay=ne.B_ed,C.transportDelay=ne.B_ed,T.currentPacketLossRate=ne.B_ealr4/100,C.currentPacketLossRate=ne.B_evlr4/100,V.uplinkNetworkQuality=ne.B_punq?ne.B_punq:0,V.downlinkNetworkQuality=ne.B_pdnq?ne.B_pdnq:0),this.remoteStats.set(u,{audioStats:T,videoStats:C,videoPcStats:oe,networkStats:V}),j&&this.exceptionMonitor.setRemoteAudioStats(j,T),L&&this.exceptionMonitor.setRemoteVideoStats(L,C)})}}class pG{constructor(){F(this,"destChannelMediaInfos",new Map),F(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(r){w8(r),this.srcChannelMediaInfo=r}addDestChannelInfo(r){w8(r),this.destChannelMediaInfos.set(r.channelName,r)}removeDestChannelInfo(r){__(r),this.destChannelMediaInfos.delete(r)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function mG(t){if(!(t instanceof pG))return new pe(K.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const r=t.getSrcChannelMediaInfo(),i=t.getDestChannelMediaInfo();if(!r)return new pe(K.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(i.size===0)return new pe(K.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class wd{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(r,i){F(this,"uid",void 0),F(this,"_uintid",void 0),F(this,"_trust_in_room_",!0),F(this,"_trust_audio_enabled_state_",!0),F(this,"_trust_video_enabled_state_",!0),F(this,"_trust_audio_mute_state_",!0),F(this,"_trust_video_mute_state_",!0),F(this,"_audio_muted_",!1),F(this,"_video_muted_",!1),F(this,"_audio_enabled_",!0),F(this,"_video_enabled_",!0),F(this,"_audio_added_",!1),F(this,"_video_added_",!1),F(this,"_is_pre_created",!1),F(this,"_video_pre_subscribed",!1),F(this,"_audio_pre_subscribed",!1),F(this,"_trust_video_stream_added_state_",!0),F(this,"_trust_audio_stream_added_state_",!0),F(this,"_audioTrack",void 0),F(this,"_videoTrack",void 0),F(this,"_dataChannels",[]),F(this,"_audioSSRC",void 0),F(this,"_videoSSRC",void 0),F(this,"_audioOrtc",void 0),F(this,"_videoOrtc",void 0),F(this,"_cname",void 0),F(this,"_rtxSsrcId",void 0),F(this,"_videoMid",void 0),F(this,"_audioMid",void 0),this.uid=r,this._uintid=i}}function fG(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function B1(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?fG(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):fG(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}const Vve=t=>`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1 2
a=msid-semantic: WMS
a=ice-lite`.concat(t?`
a=extmap-allow-mixed`:"",`
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
m=application 9 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 127.0.0.1
a=mid:2
`),U_="9",G1=2e4,F_=4e4;let gG=class{get localCapabilities(){return Sn(this._localCapabilities)}get rtpCapabilities(){return Sn(this._rtpCapabilities)}get candidates(){return Sn(this._candidates)}get iceParameters(){return Sn(this._iceParameters)}get dtlsParameters(){return Sn(this._dtlsParameters)}constructor(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=arguments.length>2&&arguments[2]!==void 0&&arguments[2],a=arguments.length>3&&arguments[3]!==void 0&&arguments[3];F(this,"sessionDesc",void 0),F(this,"_localCapabilities",void 0),F(this,"_rtpCapabilities",void 0),F(this,"_candidates",void 0),F(this,"_originCandidates",void 0),F(this,"_iceParameters",void 0),F(this,"_isUseExtmapAllowMixed",void 0),F(this,"_isUseLocalCodecs",void 0),F(this,"_isUseDataChannel",void 0),F(this,"_dtlsParameters",void 0),F(this,"setup",void 0),F(this,"currentMidIndex",void 0),F(this,"cname",void 0),F(this,"useLocalCodecsMids",[]),F(this,"preloadSsrcs",[]),F(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=r,this._isUseLocalCodecs=i,this._isUseDataChannel=a,t=Sn(t);const{iceParameters:l,dtlsParameters:u,candidates:p,rtpCapabilities:m,setup:g,localCapabilities:y,cname:x}=t;this._rtpCapabilities=m,this._candidates=p,this._originCandidates=Sn(p),this._iceParameters=l,this._dtlsParameters=u,this._localCapabilities=y,this.setup=g,this.cname=x,[this.sessionDesc]=this.updateRemoteRTPCapabilities(m),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}checkPreloadSsrcs(t){return t.length===this.preloadSsrcs.length&&t.every(r=>{var i;return Ce(i=this.preloadSsrcs).call(i,r)})}preloadRemoteMedia(t){let r=0;const i=[],a=[];for(;t>0;){const l=[B1({ssrcId:F_+r},W("USE_SUB_RTX")?{rtx:F_+r+1}:{})],u="".concat(F_+r,"_").concat(G1+r),{ssrcs:p,ssrcGroups:m}=O0(l,this.cname,W("SYNC_GROUP")?u:void 0),g=this.preCreateOrRecycleSendMedia("video",p,m,void 0),y=[{ssrcId:G1+r}],x="".concat(F_+r,"_").concat(G1+r),{ssrcs:S,ssrcGroups:T}=O0(y,this.cname,W("SYNC_GROUP")?x:void 0),C=this.preCreateOrRecycleSendMedia("audio",S,T,void 0);t--,r+=2,i.push(g,C),a.push(p[0].ssrcId,S[0].ssrcId)}return this.useLocalCodecsMids.push(...i),this.preloadSsrcs=a,{mids:i,preSSRCs:a,isAvailable:!0}}preCreateOrRecycleSendMedia(t,r,i,a){const l=this.rtpCapabilities.send.videoCodecs,u=this._isUseLocalCodecs||l.length===0?this.localCapabilities.recv:this.rtpCapabilities.send;A.debug("create or recycle send media without remote rtp capabilities, ssrcs ",r[0].ssrcId);const p=t===ze.VIDEO?u.videoCodecs:u.audioCodecs,m=t===ze.VIDEO?u.videoExtensions:u.audioExtensions;this.currentMidIndex+=1;const g="".concat(this.currentMidIndex);let y={media:{mediaType:t,port:U_,protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(x=>x.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:m,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:i,rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(g)}};return y=this.mungSendMediaDesc(y,a),this.sessionDesc.mediaDescriptions.push(y),this.updateBundleMids(),g}toString(){return pl(this.sessionDesc)}send(t,r,i,a){const{ssrcs:l,ssrcGroups:u}=O0(r,this.cname,W("SYNC_GROUP")?i:void 0),p=this.findPreloadMediaDesc(l);if(p){if(wn()&&this.firefoxSsrcMidMap.set(l[0].ssrcId,p.attributes.mid),a&&(a.twcc||a.remb)){const m=this.sessionDesc.mediaDescriptions.indexOf(p);return this.sessionDesc.mediaDescriptions[m]=this.mungSendMediaDesc(p,a),{mid:p.attributes.mid,needExchangeSDP:!0}}return{mid:p.attributes.mid,needExchangeSDP:!1}}{const m=this.findAvailableMediaIndex(t,l);let g;return m===-1||m===1&&(Pr()||function(){const y=Ht();return!(y.name!==Yt.CHROME||!y.osVersion)&&Number(y.version)<=90}()||Mo(143)||md(143)||W("RESERVE_MID_1_MLINE")||W("ENABLE_ENCODED_TRANSFORM")&&ul())||m===0&&!function(y){const x=Ht();return!(x.name!==Yt.FIREFOX||!x.osVersion)&&Number(x.version)===y}(138)&&W("USE_SUB_RTX")||uV()?(g=this.createOrRecycleSendMedia(t,l,u,"sendonly",a),this.updateBundleMids()):(g=Sn(this.sessionDesc.mediaDescriptions[m]),g.attributes.direction="sendonly",g.attributes.ssrcs=l,g.attributes.ssrcGroups=u,this.sessionDesc.mediaDescriptions[m]=this.mungSendMediaDesc(g,a)),wn()&&this.firefoxSsrcMidMap.set(l[0].ssrcId,g.attributes.mid),{mid:g.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:t,needExchangeSDP:r}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:t.attributes.mid,needExchangeSDP:r}}batchSend(t){const r=t.map(l=>{let{kind:u,ssrcMsg:p,mslabel:m}=l;return this.send(u,p,m)}),i=[];let a=!1;return r.forEach(l=>{let{mid:u,needExchangeSDP:p}=l;p&&(a=!0),i.push(u)}),{mids:i,needExchangeSDP:a}}stopSending(t){const r=this.sessionDesc.mediaDescriptions.filter(i=>i.attributes.mid&&t.indexOf(i.attributes.mid)!==-1);if(r.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");r.forEach(i=>{i.attributes.mid==="0"||wn()||uV()?i.attributes.ssrcs=[]:(i.attributes.ssrcs=[],i.attributes.direction="inactive",i.media.port="0")}),this.updateBundleMids()}mute(t){const r=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===t);if(!r)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.mute."));r.attributes.direction="inactive"}unmute(t){const r=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===t);if(!r)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.unmute."));r.attributes.direction="sendonly"}muteRemote(t){const r=this.sessionDesc.mediaDescriptions.filter(i=>Ce(t).call(t,i.attributes.mid||""));if(r.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(i=>{i.attributes.direction="inactive"})}unmuteRemote(t){const r=this.sessionDesc.mediaDescriptions.filter(i=>Ce(t).call(t,i.attributes.mid||""));if(r.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(i=>{i.attributes.direction="recvonly"})}receive(t,r,i,a){t.forEach((l,u)=>{this.createOrRecycleRecvMedia(l,[],"recvonly",r,i,a[u])}),this.updateBundleMids()}stopReceiving(t){const r=this.sessionDesc.mediaDescriptions.filter(i=>t.indexOf(i.attributes.mid)!==-1);if(r.length!==t.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");r.forEach(i=>{i.media.port="0",i.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(t){const r=this.sessionDesc||ki((i=this._isUseExtmapAllowMixed,this._isUseDataChannel?Vve(i):`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite`.concat(i?`
a=extmap-allow-mixed`:"",`
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`)));var i;this._rtpCapabilities=t;let a=!1;const l=this.rtpCapabilities.send,u=this.localCapabilities.send,p=this.localCapabilities.recv,m=p.videoCodecs,g=p.audioCodecs,y=p.videoExtensions,x=p.audioExtensions;for(const V of r.mediaDescriptions){var S;if(V.attributes.direction!=="sendonly"||typeof V.attributes.mid!="string"||!Ce(S=this.useLocalCodecsMids).call(S,V.attributes.mid)){if(a=!0,V.attributes.iceUfrag=this._iceParameters.iceUfrag,V.attributes.icePwd=this._iceParameters.icePwd,V.attributes.fingerprints=this._dtlsParameters.fingerprints,V.attributes.candidates=this._candidates,V.attributes.setup=this.setup,V.media.mediaType==="application"&&(V.attributes.sctpPort="5000"),V.media.mediaType==="video")if(this._isUseLocalCodecs&&V.attributes.direction==="sendonly"){var T;V.media.fmts=m.map(L=>L.payloadType.toString(10)),V.attributes.payloads=m,V.attributes.extmaps=y;const j=V.attributes.mid;typeof j!="string"||Ce(T=this.useLocalCodecsMids).call(T,j)||this.useLocalCodecsMids.push(j)}else if(l.videoCodecs.length===0){const j=u.videoCodecs.filter(L=>{var H,Y;return(H=L.rtpMap)===null||H===void 0?void 0:Ce(Y=H.encodingName.toLowerCase()).call(Y,"vp8")});j.length===0&&j.push(u.videoCodecs[0]),V.media.fmts=j.map(L=>L.payloadType.toString(10)),V.attributes.payloads=j,V.attributes.extmaps=[]}else V.media.fmts=l.videoCodecs.map(j=>j.payloadType.toString(10)),V.attributes.payloads=l.videoCodecs,V.attributes.extmaps=l.videoExtensions;if(V.media.mediaType==="audio")if(this._isUseLocalCodecs&&V.attributes.direction==="sendonly"){var C;V.media.fmts=g.map(L=>L.payloadType.toString(10)),V.attributes.payloads=g,V.attributes.extmaps=x;const j=V.attributes.mid;typeof j!="string"||Ce(C=this.useLocalCodecsMids).call(C,j)||this.useLocalCodecsMids.push(j)}else if(l.audioCodecs.length===0){const j=u.audioCodecs.filter(L=>{var H,Y;return(H=L.rtpMap)===null||H===void 0?void 0:Ce(Y=H.encodingName.toLowerCase()).call(Y,"opus")})||[u.audioCodecs[0]];V.media.fmts=j.map(L=>L.payloadType.toString(10)),V.attributes.payloads=j,V.attributes.extmaps=[]}else V.media.fmts=l.audioCodecs.map(j=>j.payloadType.toString(10)),V.attributes.payloads=l.audioCodecs,V.attributes.extmaps=l.audioExtensions,_m(V)}}return this.sessionDesc=r,this.currentMidIndex=r.mediaDescriptions.length-1,[this.sessionDesc,a]}updateCandidates(t){const r=this._originCandidates.filter(a=>a.transport==="udp"),i=[];if(r.forEach(a=>{i.push(B1(B1({},a),{},{foundation:"tcpcandidate",priority:Number(a.priority)-1+"",transport:"tcp",port:Number(a.port)+90+""}))}),r.length!==0){switch(t){case jr.TCP_RELAY:this._candidates=i;break;case jr.UDP_TCP_RELAY:case jr.RELAY:this._candidates=[...r,...i];break;default:this._candidates=r}for(const a of this.sessionDesc.mediaDescriptions)a.attributes.candidates=this.candidates}}restartICE(t){t=Sn(t),this._iceParameters=t,this.sessionDesc.mediaDescriptions.forEach(r=>{r.attributes.iceUfrag=t.iceUfrag,r.attributes.icePwd=t.icePwd})}predictReceivingMids(t){const r=[];for(let i=0;i<t;i++)r.push((this.currentMidIndex+i+1).toString(10));return r}findAvailableMediaIndex(t,r){return this.sessionDesc.mediaDescriptions.findIndex(i=>{const a=i.media.mediaType===t&&i.media.port!=="0"&&(i.attributes.direction==="sendonly"||i.attributes.direction==="sendrecv")&&i.attributes.ssrcs.length===0;if(wn()){if(a){const l=this.firefoxSsrcMidMap.get(r[0].ssrcId);return!(l||i.attributes.mid!=="0"&&i.attributes.mid!=="1")||!(!l||l!==i.attributes.mid)}return!1}return a})}createOrRecycleDataChannel(){for(const i of this.sessionDesc.mediaDescriptions)if(i.media.mediaType==="application")return{mediaDesc:i,needExchangeSDP:!1};this.currentMidIndex+=1;const t="".concat(this.currentMidIndex),r={media:{mediaType:"application",port:U_,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(t),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(r),{mediaDesc:r,needExchangeSDP:!0}}createOrRecycleRecvMedia(t,r,i,a,l,u){const p=t._mediaStreamTrack.kind,m=this.rtpCapabilities.recv,g=k0(p,m,this.localCapabilities.send,p===ze.VIDEO?a:l),y=p===ze.VIDEO?m.videoExtensions:m.audioExtensions;this.currentMidIndex+=1;const x="".concat(this.currentMidIndex);let S={media:{mediaType:p,port:U_,protos:["UDP","TLS","RTP","SAVPF"],fmts:g.map(C=>C.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:y,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:g,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(x)}};S=this.mungRecvMediaDsec(S,t,u);const T=this.findFirstClosedMedia(p);if(T){const C=this.sessionDesc.mediaDescriptions.indexOf(T);this.sessionDesc.mediaDescriptions[C]=S}else this.sessionDesc.mediaDescriptions.push(S);return S}updateRemoteDtlsParameters(t){const r=new Set(this._dtlsParameters.fingerprints.map(l=>l.fingerprint)),i=new Set(t.map(l=>l.fingerprint));let a=!1;r.size!==i.size&&(a=!0);for(const l of r)i.has(l)||(a=!0);return a}updateRemoteCodec(t,r,i){const a=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(S=>S.rtpMap&&S.rtpMap.encodingName.toLowerCase()||"").filter(S=>{var T;return Ce(T=Object.keys(Yu)).call(T,S)}))],l=new Set(r);if(a.every(S=>l.has(S)))return A.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(r)),!1;const u=this._rtpCapabilities.recv.videoCodecs.filter(S=>r.some(T=>{var C;return Ce(C=S.rtpMap&&S.rtpMap.encodingName.toLowerCase()||"").call(C,T)}));if(u.length===0)return A.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(a," codecs: ").concat(r)),!1;const p=[...new Set(u.map(S=>S.rtpMap&&S.rtpMap.encodingName.toLowerCase()||""))];let m;if(A.debug("updateRemoteCodec, from ".concat(a," to ").concat(p)),t.length===0)m=this.sessionDesc.mediaDescriptions.filter(S=>S.media.mediaType==="video"&&S.attributes.direction==="recvonly");else if(m=this.sessionDesc.mediaDescriptions.filter(S=>S.attributes.mid&&S.media.mediaType==="video"&&Ce(t).call(t,S.attributes.mid)&&S.attributes.direction==="recvonly"),m.length!==t.length)return A.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(t,", codecs: ").concat(r)),!1;if(W("USE_PUB_RTX")||W("USE_SUB_RTX")){const S=Ed(u,this.rtpCapabilities.recv.videoCodecs);u.push(...S)}this._rtpCapabilities.recv.videoCodecs=u;const g=this.localCapabilities.send,y=this.rtpCapabilities.recv,x=k0(ze.VIDEO,y,g,i);return m.forEach(S=>{const T=x.map(C=>C.payloadType.toString(10));A.debug("updateRemoteCodec mid: ".concat(S.attributes.mid,", from"),S.attributes.payloads,"to",x),S.attributes.payloads=x,S.media.fmts=T}),A.debug("updateRemoteCodec success, mids: ".concat(t,", codecs: ").concat(r,", remote recv: ").concat(this._rtpCapabilities.recv.videoCodecs.length,", remote send: ").concat(this._rtpCapabilities.send.videoCodecs.length)),!0}createOrRecycleSendMedia(t,r,i,a,l){const u=this.rtpCapabilities.send.videoCodecs,p=this._isUseLocalCodecs||u.length===0?this.localCapabilities.recv:this.rtpCapabilities.send,m=t===ze.VIDEO?p.videoCodecs:p.audioCodecs,g=t===ze.VIDEO?p.videoExtensions:p.audioExtensions;this.currentMidIndex+=1;const y="".concat(this.currentMidIndex);let x={media:{mediaType:t,port:U_,protos:["UDP","TLS","RTP","SAVPF"],fmts:m.map(T=>T.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:g,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:i,rtcpFeedbackWildcards:[],payloads:m,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:a,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(y)}};x=this.mungSendMediaDesc(x,l);const S=this.findFirstClosedMedia(t);if(S){const T=this.sessionDesc.mediaDescriptions.indexOf(S);this.sessionDesc.mediaDescriptions[T]=x}else this.sessionDesc.mediaDescriptions.push(x);return x}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(t=>t.media.port!=="0").map(t=>t.attributes.mid)}mungRecvMediaDsec(t,r,i){const a=Sn(t);return N1(a),sh(a,r),C1(a,r),$8(a),O_(a,i,this.localCapabilities.send),a}mungSendMediaDesc(t,r){const i=Sn(t);return i.attributes&&i.attributes.payloads&&Array.isArray(i.attributes.payloads)&&i.attributes.payloads.length>0&&i.attributes.payloads.forEach(a=>{a.rtpMap&&a.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&W("ENABLE_DOWN_SPS_PPS")&&(a.fmtp&&a.fmtp.parameters||(a.fmtp={parameters:{}}),a.fmtp.parameters["sps-pps-idr-in-keyframe"]="1")}),O_(i,r,this.localCapabilities.recv),_m(i),i}updateRecvMedia(t,r){const i=this.sessionDesc.mediaDescriptions.findIndex(a=>a.attributes.mid===t);if(i!==-1){const a=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],r);this.sessionDesc.mediaDescriptions[i]=a}}bumpMid(t){this.currentMidIndex+=t}findFirstClosedMedia(t){return this.sessionDesc.mediaDescriptions.find(r=>wn()?r.media.port==="0"&&r.media.mediaType===t:r.media.port==="0")}findPreloadMediaDesc(t){return this.sessionDesc.mediaDescriptions.find(r=>{var i;return((i=r.attributes)===null||i===void 0||(i=i.ssrcs[0])===null||i===void 0?void 0:i.ssrcId)===t[0].ssrcId})}getSSRC(t){var r;return(r=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===t))===null||r===void 0?void 0:r.attributes.ssrcs}};function vG(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function vl(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?vG(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):vG(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}var Sm=function(t){return t[t.DOWN=0]="DOWN",t[t.UP=1]="UP",t}(Sm||{});const V_=new Map;function yG(t,r,i,a){let{scale:l}=t;if(l===0&&a===Sm.UP||l>=r.length-1&&a===Sm.DOWN)return t;let u=vl(vl({},t),{},{scale:a===Sm.DOWN?++l:--l});switch(i){case"maintain-framerate":u=vl(vl({},u),r[l].motion);break;case"maintain-resolution":u=vl(vl({},u),r[l].detail);break;case"balanced":u=vl(vl({},u),r[l].balanced)}return u}function bG(t,r){if(r){const i={overUse:0,underUse:0,adaptationList:xG(r)};V_.set(t,i)}else V_.delete(t)}function xG(t){const r=vl({},t),{bitrateMax:i,frameRate:a,scaleResolutionDownBy:l,bitrateMin:u}=r,{MIN_FRAME_RATE:p,MAX_THRESHOLD_FRAMERATE:m,MAX_SCALE:g,BITRATE_MIN_THRESHOLD:y,BITRATE_MAX_THRESHOLD:x,BWE_SCALE_UP_THRESHOLD:S,BWE_SCALE_DOWN_THRESHOLD:T,PERF_SCALE_DOWN_THRESHOLD:C,PERF_SCALE_UP_THRESHOLD:V,BALANCE_BITRATE_FACTOR:j,BALANCE_FRAMERATE_FACTOR:L,BALANCE_RESOLUTION_FACTOR:H,MOTION_RESOLUTION_FACTOR:Y,MOTION_BITRATE_FACTOR:te,DETAIL_FRAMERATE_FACTOR:se,DETAIL_BITRATE_FACTOR:oe}=DA,ne=Math.min(r.frameRate,m),de=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(T,1)*i),bwe_up:i,fps_down:Math.round(Math.pow(C,1)*ne),fps_up:a},balanced:{scaleResolutionDownBy:1,frameRate:a,bitrateMax:i,bitrateMin:u},motion:{scaleResolutionDownBy:1,frameRate:a,bitrateMax:i,bitrateMin:u},detail:{scaleResolutionDownBy:1,frameRate:a,bitrateMax:i,bitrateMin:u}}];for(let be=1;be<=g;be++){const Se={bwe_up:Math.round(Math.pow(S,be)*i),bwe_down:Math.round(Math.pow(T,be+1)*i),fps_up:Math.round(Math.pow(V,be)*ne),fps_down:Math.round(Math.pow(C,be+1)*ne)},Be={scaleResolutionDownBy:l/Math.pow(H,be),frameRate:Math.max(Math.round(Math.pow(L,be)*a),p),bitrateMax:Math.max(Math.round(Math.pow(j,be)*i),x),bitrateMin:Math.max(Math.round(Math.pow(j,be)*u),y)},mt={scaleResolutionDownBy:l/Math.pow(Y,be),frameRate:a,bitrateMax:Math.max(Math.round(Math.pow(te,be)*i),x),bitrateMin:Math.max(Math.round(Math.pow(te,be)*u),y)},ut={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(se,be)*a),p),bitrateMax:Math.max(Math.round(Math.pow(oe,be)*i),x),bitrateMin:Math.max(Math.round(Math.pow(oe,be)*u),y)};de.push({scale:be,threshold:Se,balanced:Be,motion:mt,detail:ut})}return de}function Bve(t,r,i,a,l,u){const p=V_.get(t)||{overUse:0,underUse:0,adaptationList:xG(l)},{adaptationList:m}=p;V_.set(t,p);const{OVERUSE_TIMES_THRESHOLD:g,UNDERUSE_TIMES_THRESHOLD:y}=DA,{scale:x}=a;let S,T;return typeof r=="number"&&r>0&&function(C,V,j,L){if(V>=j.length)return!1;let{threshold:{fps_down:H}}=j[V];return W("FORCE_AG_HIGH_FRAMERATE")&&L==="maintain-framerate"&&(H=j[0].threshold.fps_down),C<H}(r,x,m,u)&&(p.overUse++,T=nm.CPU,p.overUse>g)||typeof i=="number"&&i>0&&function(C,V,j){if(V>=j.length)return!1;const{threshold:{bwe_down:L}}=j[V];return C<L}(i,x,m)&&(p.overUse++,T=nm.BANDWIDTH,p.overUse>g)?(p.overUse=0,p.underUse=0,S=yG(a,m,u,Sm.DOWN),[S,T]):(typeof r=="number"&&r>0&&typeof i=="number"&&i>0&&function(C,V,j,L){if(V===0)return;let{threshold:{fps_up:H}}=j[V];return W("FORCE_AG_HIGH_FRAMERATE")&&L==="maintain-framerate"&&(H=j[1].threshold.fps_up),C>H}(r,x,m,u)&&function(C,V,j){if(V===0)return;const{threshold:{bwe_up:L}}=j[V];return C>L}(i,x,m)&&(p.underUse++,p.underUse>y&&(p.overUse=0,p.underUse=0,S=yG(a,m,u,Sm.UP),S.scale===0&&(T=nm.NONE))),[S,T])}function _G(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function W1(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?_G(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):_G(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}function EG(t){var r;return!!W("ENABLE_AG_ADAPTATION")&&!!(t instanceof d_||Ce(r=t._hints).call(r,Zt.CUSTOM_TRACK))&&(!!W("FORCE_SUPPORT_AG_ADAPTATION")||!!(lV(14,0,!1)&&dV(17,4,!0)||cV(14)&&fA(17,4,!0)))}const B_=new Map;function wG(t,r,i,a,l,u){if(Tm(t,i),l(r),a!=="balanced"&&a!=="maintain-framerate"&&a!=="maintain-resolution")return;let p=-1;bG(t,r);const m=window.setInterval(()=>{const y=B_.get(t);if(!W("ENABLE_AG_ADAPTATION")||!y)return Tm(t,i),void l(r);const x=u();if(x.sendPackets>0&&x.OutgoingAvailableBandwidth>0){if(p===-1)return void(p=Date.now());if(Date.now()-p<1e3)return;const S=x.sendFrameRate,T=x.OutgoingAvailableBandwidth,[C,V]=Bve(t,S,T,y.adaptationConfig,r,a);V&&(i.qualityLimitationReason=V),C&&y.adaptationConfig.scale!==C.scale&&(A.debug("[".concat(t,"] applyAdaptation: ").concat(i.qualityLimitationReason,`
           sendFps `).concat(S,", bwe ").concat(T,", switch from ").concat(y.adaptationConfig.scale," to ").concat(C.scale," ")),y.adaptationConfig=W1(W1({},y.adaptationConfig),C),l(C))}},W("CHECK_LOCAL_STATS_INTERVAL")),g=W1({},r);B_.set(t,{timer:m,adaptationConfig:g,originConfig:r,adaptationFunc:l}),A.debug("[".concat(t,"] start adaptation, originConfig: ").concat(JSON.stringify(r),", degradationPreference: ").concat(a))}function Tm(t,r){const i=B_.get(t);if(i){const{timer:a}=i;window.clearTimeout(a),B_.delete(t)}r.qualityLimitationReason=nm.NONE,bG(t)}function Gve(t,r){var i;let a;switch(r){case Re.LocalAudioTrack:a=rn.Audio;break;case Re.LocalVideoTrack:a=Ce(i=t._hints).call(i,Zt.SCREEN_TRACK)?rn.Screen:rn.High;break;case Re.LocalVideoLowTrack:a=rn.Low}return a}function $1(t){const r=jt();if(t.some(i=>i._bypassWebAudio))throw new ge(K.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!r.webAudioMediaStreamDest)throw new ge(K.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function z1(t,r){$1(t);const i=new pr;return t.forEach(a=>i.addAudioTrack(a)),i}const Wve=!jt().supportUnifiedPlan||W("CHROME_FORCE_PLAN_B")&&Sc();function M0(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.useDcSignal)return i={spec:r,store:t},Wo("DataChannelConnection").create(i);var i;return Wve?function(l){return Wo("PlanBConnection").create(l)}({spec:r,store:t}):new Js(r,t)}function H1(t){return t&&(t.iceConnectionState==="disconnected"||t.iceConnectionState==="checking"||t.iceConnectionState==="failed")}function K1(t){try{if(t.iceServers)return!1;if(t.turnServer&&t.turnServer.mode!=="off"){if(Bu(t.turnServer.servers))return!1;if(W("FORCE_TURN_TCP")||t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).some(r=>r.forceturn))return!0}return!1}catch{return!1}}var Gt;function SG(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function zo(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?SG(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):SG(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}let Js=(Gt=class Rh extends T_{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var r,i;return(r=(i=this.peerConnection.getReceivers()[0])===null||i===void 0||(i=i.transport)===null||i===void 0?void 0:i.state)!==null&&r!==void 0?r:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(r=>r.rtpMap&&r.rtpMap.encodingName.toLowerCase()||"").filter(r=>{var i;return Ce(i=Object.keys(Yu)).call(i,r)}))]}constructor(r,i){super(r,i),F(this,"id",tn(5,"connection-")),F(this,"store",void 0),F(this,"peerConnection",void 0),F(this,"forceTurn",!1),F(this,"remoteSDP",void 0),F(this,"initialOffer",void 0),F(this,"transportEventReceiver",void 0),F(this,"statsFilter",void 0),F(this,"extension",{useXR:W("USE_XR")}),F(this,"localCapabilities",void 0),F(this,"remoteCodecs",void 0),F(this,"localCandidateCount",0),F(this,"allCandidatesReceived",!1),F(this,"isPreallocation",!1),F(this,"isPreRender",!1),F(this,"preMediaMap",new Map),F(this,"dataStreamChannelMap",new Map),F(this,"establishPromise",void 0),F(this,"recoveredDataChannelIds",[]),F(this,"currentDataChannelId",1),F(this,"supportAV1RtpSpec",!1),F(this,"mutex",void 0),F(this,"qualityLimitationReason",nm.NONE),F(this,"isFirstConnected",!1),this.store=i,this.forceTurn=K1(r),this.mutex=new kr("P2PConnection-mutex",i.clientId),this.peerConnection=new RTCPeerConnection(Rh.resolvePCConfiguration(r),{optional:[{googDscp:!0}]}),this.isFirstConnected=!1,this.statsFilter=Zx(this.peerConnection,W("STATS_UPDATE_INTERVAL"),void 0,wn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,r.isPreallocation&&(this.isPreallocation=!0),this.establishPromise=this.establish()}getPreMedia(r){return this.preMediaMap.get(r)}isPreSub(){return this.preMediaMap.size>0}async updateRemoteRTPCapabilities(r,i){if(this.remoteCodecs=i,!this.remoteSDP)return void A.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(i));if(this.remoteSDP.updateRemoteCodec(r,i,this.store.codec)){const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}else A.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const i=await this.peerConnection.createOffer();if(!i.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const a=Ic(i.sdp),l=await A1({filterRTX:!W("USE_PUB_RTX")&&!W("USE_SUB_RTX"),filterVideoFec:W("FILTER_VIDEO_FEC"),filterAudioFec:W("FILTER_AUDIO_FEC"),filterVideoCodec:W("FILTER_VIDEO_CODEC"),unsupportedVideoUplinkCodec:W("UNSUPPORTED_VIDEO_UPLINK_CODEC"),unsupportedVideoDownlinkCodec:W("UNSUPPORTED_VIDEO_DOWNLINK_CODEC")},this.extension);if(this.localCapabilities=P0(l),this.initialOffer=i,W("ENABLE_SVC")&&this.store.codec=="av1"){const p=await z8();var r;p&&(this.supportAV1RtpSpec=!0,(r=l.send)===null||r===void 0||r.videoExtensions.push(p))}let u;return i.sdp&&P_(i.sdp)&&(u=Sn(l),M8(u)),zo(zo({},a),{},{rtpCapabilities:u||l,offerSDP:i.sdp})}catch(i){throw new ge(K.GET_LOCAL_CONNECTION_PARAMS_FAILED,i.toString())}}async connect(r){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&P_(this.initialOffer.sdp)&&U8(r.rtpCapabilities,this.localCapabilities),this.remoteSDP=new gG(zo(zo({},r),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec,!(!W("ENABLE_PRE_SUB_WITH_PRE_PC")||!W("PRE_USE_LOCAL_CODECS"))&&w0(this.store)),r.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const i=this.remoteSDP.toString(),a=I1(this.initialOffer.sdp,this.extension),l=this.logSDPExchange(a||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:a}),l==null||l(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i});const u=this.peerConnection.getTransceivers()[0];if(u!=null&&u.receiver&&this.tryBindTransportEvents(u.receiver),w0(this.store))if(r.preallocation&&W("ENABLE_PRE_SUB_WITH_PRE_PC")){const p=W("PRE_SUB_NUM"),{mids:m,preSSRCs:g}=this.remoteSDP.preloadRemoteMedia(p);await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[".concat(this.store.clientId,"] [P2PConnection] preload media, in pre pc,add preload ssrcs ").concat(g)),this.presetMedia(m,g)}else{const{preSSRCs:p=[]}=r,m=p.map(y=>y.ssrcMsg[0].ssrcId);if(p.length===0)return;const{mids:g}=this.remoteSDP.batchSend(p.map(y=>Object.assign({},y)));await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[P2PConnection.connect] preload media, after join, add preload ssrcs ".concat(m)),this.presetMedia(g,m)}}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(i.toString()))}}presetMedia(r,i){r.forEach((a,l)=>{this.peerConnection.getTransceivers().forEach(u=>{if(u.mid!=null&&a===u.mid&&u.receiver.track){const p=u.receiver.track;let m;p.kind==="video"&&W("ENABLE_PRE_RENDER")&&(m=new l_({trackId:"track-".concat(p.kind,"-unknown-").concat(this.store.clientId,"_").concat(tn(5,""))},!0),m.updateVideoTrack(p),m.onFirstVideoFrameRender=()=>{var g;const y=this.preMediaMap.get(i[l]);y&&(y.firstVideoRender=Date.now()),(g=this.onFirstVideoRender)===null||g===void 0||g.call(this,i[l])},m.onVideoBufferReady=()=>{var g;(g=this.onFirstVideoBufferReady)===null||g===void 0||g.call(this,i[l])},m.play(this.store.sessionId||void 0),this.isPreRender=!0),this.preMediaMap.set(i[l],{mid:a,track:p,player:m,transceiver:u})}}),this.store.peerReceiver()})}checkDtlsParameters(r){return!!this.remoteSDP&&r.length>0&&this.remoteSDP.updateRemoteDtlsParameters(r)}async updateRemoteConnect(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");let i=!1;const{rtpCapabilities:a}=r;if([,i]=this.remoteSDP.updateRemoteRTPCapabilities(a),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0){const p=this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);i=i||p}const{preSSRCs:l=[]}=r,u=l.map(p=>p.ssrcMsg[0].ssrcId);if(!this.remoteSDP.checkPreloadSsrcs(u)){const p=[],m=[];if(Array.from(this.preMediaMap.entries()).every(g=>{let[y,{mid:x,player:S,track:T}]=g;return p.push(x),m.push(y),this.preMediaMap.delete(y),S&&S.destroy(),!0}),p.length>0&&(this.remoteSDP.stopSending(p),await ds(this.peerConnection,this.remoteSDP,this.extension),A.warn("[P2PConnection.updateRemoteConnect] preload media, failed, del preload ssrcs ".concat(m)),Ye.reportApiInvoke(this.store.sessionId,{name:Cn.PRELOAD_MEDIA_FAILED,options:[l,m],tag:hn.TRACER}).onSuccess()),l.length>0){const{mids:g}=this.remoteSDP.batchSend(l.map(y=>Object.assign({},y)));await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[P2PConnection.updateRemoteConnect] preload media, after join, add preload ssrcs ".concat(u)),this.presetMedia(g,u)}}i?(await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[P2PConnection] updateRemoteConnect by exchanging SDP.")):A.debug("[P2PConnection] updateRemoteConnect no need to exchange SDP, because no need to update remote codecs (use local codecs)")}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(i.toString()))}}send(r,i,a){var l=this;return $i(function*(){const u=yield Nt(l.mutex.lock("From P2PConnection.send"));try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const p=[],m=A0();r.forEach(L=>{const H=l.peerConnection.addTransceiver(L._mediaStreamTrack,zo({direction:"sendonly"},L.trackMediaType==="video"&&l.supportAV1RtpSpec&&m?{sendEncodings:[{scalabilityMode:m}]}:{}));p.push(H),L._updateRtpTransceiver(H)}),wn()&&W("SIMULCAST")===!0&&(yield Nt(l.applySimulcastForFirefox(p,r)));const g=yield Nt(l.peerConnection.createOffer()),y=l.remoteSDP.predictReceivingMids(r.length),x=l.mungSendOfferSDP(g.sdp,r,y),S=ki(x),T=y.map(L=>{const H=S.mediaDescriptions.find(Y=>Y.attributes.mid===L);if(!H)throw new Error("Cannot extract ssrc from mediaDescription.");return T1(H,W("USE_PUB_RTX"))});let C;try{C=yield T}catch(L){C=[],l.remoteSDP.receive(r,i,a,C);const H=l.remoteSDP.toString();throw yield Nt(l.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield Nt(l.peerConnection.setRemoteDescription({type:"answer",sdp:H})),yield Nt(l.stopSending(y,!0)),L}l.remoteSDP.receive(r,i,a,C);const V=l.remoteSDP.toString(),j=l.logSDPExchange(x,"offer","local","send");return yield Nt(l.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield Nt(l.applySimulcastEncodings(p,r)),yield Nt(l.applySendEncodings(p,r)),j==null||j(V),yield Nt(l.peerConnection.setRemoteDescription({type:"answer",sdp:V})),p.map((L,H)=>{const Y=y[H];return{localSSRC:T[H],id:Y,transceiver:L}})}catch(p){throw p instanceof ge?p:new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(p.toString()))}finally{u()}})()}async createDataChannels(r,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let a=this.dataStreamChannelMap.get(r);if(a&&a.readyState==="open")A.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const u=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof u!="number")throw new Error("create DataChannel error, because cannot get dc id");a=this.peerConnection.createDataChannel("datastream-channel",{id:u,negotiated:!0,ordered:!1,maxRetransmits:W("DATASTREAM_MAX_RETRANSMITS")}),a.binaryType="arraybuffer",this.dataStreamChannelMap.set(r,a)}i.forEach(u=>{u._updateOriginDataChannel(a)});const{needExchangeSDP:l}=this.remoteSDP.sendDataChannel();if(l){const u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:u});const p=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(p),A.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else A.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(a){throw a instanceof ge?a:new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(a.toString()))}}async stopDataChannels(r){try{const i=this.dataStreamChannelMap.get(r);return i&&(i.id&&this.recoveredDataChannelIds.push(i.id),i.close()),void this.dataStreamChannelMap.delete(r)}catch(i){throw i instanceof ge?i:new ge(K.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(i.toString()))}}async stopSending(r,i){const a=i?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const l=this.peerConnection.getTransceivers().filter(g=>r.indexOf(g.mid)!==-1);if(l.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");l.map(g=>{var y;Tm(this.id+g.mid,this),g.direction="inactive",(y=g.stop)===null||y===void 0||y.call(g)});const u=await this.peerConnection.createOffer(),p=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(r);const m=this.remoteSDP.toString();p==null||p(m),await this.peerConnection.setRemoteDescription({type:"answer",sdp:m})}catch(l){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(l.toString()))}finally{a&&a()}}async receive(r,i,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(r," before remoteSDP created."));const{mid:u,needExchangeSDP:p}=this.remoteSDP.send(r,i,a,l);p&&(await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(r," by exchanging SDP.")));const m=this.peerConnection.getTransceivers().find(g=>g.mid===u);if(!m)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:m.receiver.track,id:u,transceiver:m}}catch(u){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async batchReceive(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:i,needExchangeSDP:a}=this.remoteSDP.batchSend(r);return a&&(await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),i.map(l=>{const u=this.peerConnection.getTransceivers().find(p=>p.mid===l);if(!u)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:u.receiver.track,id:l,transceiver:u}})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(i.toString()))}}async stopReceiving(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");r.forEach(u=>{Array.from(this.preMediaMap.entries()).some(p=>{let[m,{mid:g,player:y}]=p;if(g===u)return this.preMediaMap.delete(m),y&&y.destroy(),!0})}),this.remoteSDP.stopSending(r);const i=this.remoteSDP.toString(),a=this.logSDPExchange(i,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}}async muteRemote(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(r," before remote SDP created."));this.remoteSDP.mute(r);const i=this.remoteSDP.toString(),a=this.logSDPExchange(i,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(i.toString()))}}async unmuteRemote(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(r," before remote SDP created."));this.remoteSDP.unmute(r);const i=this.remoteSDP.toString(),a=this.logSDPExchange(i,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(i.toString()))}}async muteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const i=this.peerConnection.getTransceivers().filter(p=>p.mid&&r.indexOf(p.mid)!==-1);if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(p=>{p.direction="inactive"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.muteRemote(r);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(i.toString()))}}async unmuteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const i=this.peerConnection.getTransceivers().filter(p=>p.mid&&r.indexOf(p.mid)!==-1);if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(async(p,m)=>{p.direction="sendonly"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.unmuteRemote(r),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(r,this.remoteCodecs,this.store.codec);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(i.toString()))}}restartICE(r){var i=this;return $i(function*(){const a=yield Nt(i.mutex.lock("From P2PConnection.restartICE"));try{if(!i.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const l=jt().supportPCSetConfiguration,u=W("FORCE_TURN_TCP")||i.forceTurn;if(r===jr.RELAY&&!l)return;if(l&&!u){const S=r===jr.RELAY?"relay":"all",T=i.peerConnection.getConfiguration();T.iceTransportPolicy!==S&&(A.debug("[".concat(i.store.clientId,"] restartICE change iceTransportPolicy from [").concat(T.iceTransportPolicy,"] to [").concat(S,"]")),T.iceTransportPolicy=S,i.peerConnection.setConfiguration(T))}i.remoteSDP.updateCandidates(r);const p=yield Nt(i.peerConnection.createOffer({iceRestart:!0}));if(!p.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const m=Ic(p.sdp),{remoteIceParameters:g}=yield m.iceParameters;i.remoteSDP.restartICE(g);const y=i.remoteSDP.toString(),x=i.logSDPExchange(p.sdp||"","offer","local","restartICE");i.store.descriptionStart(),yield Nt(i.peerConnection.setLocalDescription(p)),x==null||x(y),yield Nt(i.peerConnection.setRemoteDescription({type:"answer",sdp:y}))}catch(l){A.warning("[".concat(i.store.clientId,"] restart ICE failed, abort operation"),l)}finally{a()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;const r=await this.mutex.lock("From P2PConnection.extendCandidate");try{this.remoteSDP.updateCandidates(jr.TCP_RELAY),await ds(this.peerConnection,this.remoteSDP,this.extension)}catch(i){A.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),i)}finally{r()}}close(){var r;this.peerConnection.getTransceivers().forEach(i=>{Tm(this.id+i.mid,this)}),this.preMediaMap.forEach(i=>{let{player:a}=i;a&&a.destroy()}),this.preMediaMap.clear(),this.peerConnection.close(),(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return zo(zo({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(r){return this.statsFilter.getVideoIsReady(r)}async updateEncoderConfig(r,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[i],[r]);this.remoteSDP.updateRecvMedia(r,i);const u=this.remoteSDP.toString(),p=this.logSDPExchange(l,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),p==null||p(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new ge(K.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(r,i){const a=this.peerConnection.getTransceivers().filter(l=>l.mid===r);a.length===1&&(this.isVP8Simulcast(i)?wn()||await this.applySimulcastEncodings(a,[i]):await this.applySendEncodings(a,[i]))}setStatsRemoteVideoIsReady(r,i){this.statsFilter.setVideoIsReady2(r,i)}async replaceTrack(r,i){const a=this.peerConnection.getTransceivers().find(l=>l.mid===i);a&&await a.sender.replaceTrack(r._mediaStreamTrack)}async getSelectedCandidatePair(){const r=this.peerConnection.getReceivers();if(r.length>0&&r[0].transport&&r[0].transport.iceTransport&&r[0].transport.iceTransport.getSelectedCandidatePair&&r[0].transport.iceTransport.getSelectedCandidatePair()){const i=r[0].transport.iceTransport,{local:a,remote:l}=i.getSelectedCandidatePair();return{local:zo(zo({},Ja),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port}),remote:zo(zo({},Ja),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var r;(r=this.onICEConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var r;this.peerConnection.connectionState==="connected"&&(this.isFirstConnected=!0),(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=r=>{if(r&&(r.errorCode||r.errorText)){var i;const a="code: ".concat(r.errorCode,", message: ").concat(r.errorText),l=r.port?"local: ".concat(r.port):"",u=Ac(r.url||"");A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(a,"), url: ").concat(u||"",", host_candidate:").concat(l)),(i=this.onICECandidateError)===null||i===void 0||i.call(this,a)}},this.peerConnection.onicegatheringstatechange=r=>{r&&r.target&&"iceGatheringState"in r.target&&A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(r.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=r=>{r.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},W("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(r){const i={iceServers:[]},a=r.cloudProxyServer||"disabled";return r.iceServers?i.iceServers=r.iceServers:r.turnServer&&(Bu(r.turnServer.servers)?i.iceServers=r.turnServer.servers:W("NEW_TURN_MODE")&&i.iceServers&&a==="disabled"?(W("USE_TURN_SERVER_OF_GATEWAY")?r.turnServer.serversFromGateway&&i.iceServers.push(...Rh.newTurnServerConfigToIceServers(r.turnServer.serversFromGateway)):i.iceServers.push(...Rh.newTurnServerConfigToIceServers(r.turnServer.servers)),W("NEW_FORCE_TURN")&&(i.iceTransportPolicy="relay")):r.turnServer.mode!=="off"&&(i.iceServers&&i.iceServers.push(...Rh.turnServerConfigToIceServers(r.turnServer.servers)),W("USE_TURN_SERVER_OF_GATEWAY")&&i.iceServers&&r.turnServer.serversFromGateway&&i.iceServers.push(...Rh.turnServerConfigToIceServers(r.turnServer.serversFromGateway)),W("FORCE_TURN_TCP")?i.iceTransportPolicy="relay":r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).forEach(l=>{l.forceturn&&(i.iceTransportPolicy="relay")}))),W("ENABLE_ENCODED_TRANSFORM")&&jt().supportWebRTCEncodedTransform&&(i.encodedInsertableStreams=!0),i}static turnServerConfigToIceServers(r){const i=[];return r.forEach(a=>{a.security?a.tcpport&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(no(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!W("FORCE_TURN_TCP")&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),i}static newTurnServerConfigToIceServers(r){const i=[];return r.forEach(a=>{const l=W("NEW_TURN_MODE");l===1?i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":3478?transport=udp")}):l===2?i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":3478?transport=tcp")}):l===3?i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(no(a.turnServerURL),":443?transport=tcp")}):l===4&&(i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":3478?transport=udp")}),i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":3478?transport=tcp")}),i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(no(a.turnServerURL),":443?transport=tcp")}))}),i}tryBindTransportEvents(r){const i=r.transport;if(i){this.transportEventReceiver=r,i.onstatechange=()=>{var l;i!=null&&i.state&&((l=this.onDTLSTransportStateChange)===null||l===void 0||l.call(this,i.state))},i.onerror=l=>{var u;(u=this.onDTLSTransportError)===null||u===void 0||u.call(this,"error"in l?l.error:l)};const a=i.iceTransport;a&&(a.onstatechange=()=>{const l=i==null?void 0:i.iceTransport.state;var u;l&&((u=this.onICETransportStateChange)===null||u===void 0||u.call(this,l))},a.getSelectedCandidatePair&&(a.onselectedcandidatepairchange=()=>{if(a.getSelectedCandidatePair()){const{local:l,remote:u}=a.getSelectedCandidatePair()||{};if(l&&u){const p=l.address+":"+l.port,m=u.address+":"+u.port;A.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify(Ac(p)),", remote ").concat(JSON.stringify(Ac(m))))}}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(r,i){var a,l;if(i||(i=this.peerConnection.getSenders().find(L=>L.track===r._mediaStreamTrack)),!i)return A.warn("[".concat(r.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(r))return A.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!jt().supportSetRtpSenderParameters)return A.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const u={},p={};switch(r._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;case"balanced":u.degradationPreference="balanced"}const m=D8(this.peerConnection,r._mediaStreamTrack),g=S6(r);if(EG(r)&&m&&i&&g&&this.getLocalVideoStats&&Ce(a=["vp8","vp9"]).call(a,this.store.codec)){var y;const j=u.degradationPreference||(Ce(y=r._hints).call(y,Zt.CUSTOM_TRACK)?W("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");wG(this.id+m.mid,g,this,j,L=>{i&&this.updateAdaptation(i,L)},this.getLocalVideoStats.bind(this))}if(r._encoderConfig){var x;const{bitrateMax:j,frameRate:L,scaleResolutionDownBy:H}=r._encoderConfig;j&&(p.maxBitrate=1e3*j),(Ce(x=r._hints).call(x,Zt.LOW_STREAM)||r.isUseScaleResolutionDownBy)&&(L&&(p.maxFramerate=qi(L)),H&&H>=1&&(p.scaleResolutionDownBy=H))}const{maxFramerate:S}=W("ENCODER_CONFIG_LIMIT");if(S&&typeof S=="number"&&(p.maxFramerate=p.maxFramerate?Math.min(p.maxFramerate,S):S),W("DSCP_TYPE")&&Sc()){var T;const j=W("DSCP_TYPE");Ce(T=["very-low","low","medium","high"]).call(T,j)&&(p.networkPriority=j)}const C=i.getParameters(),V=(l=C.encodings)===null||l===void 0?void 0:l[0];wn()&&!V&&(u.encodings=[p]),V&&Object.assign(V,p),Object.assign(C,u),A.debug("[".concat(r.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(C.encodings))),await i.setParameters(C),await Y8(this.store.codec,i,W("SVC_MODE"))}async updateAdaptation(r,i){var a,l;if(!r)return A.debug("[updateAdaptation] no rtpSender found");if(!jt().supportSetRtpSenderParameters)return A.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const u={},{bitrateMax:p,frameRate:m,scaleResolutionDownBy:g}=i;p&&(u.maxBitrate=1e3*p),m&&(u.maxFramerate=qi(m)),g&&g>=1&&Ce(a=["vp8","vp9"]).call(a,this.store.codec)&&(u.scaleResolutionDownBy=g);const y=r.getParameters(),x=(l=y.encodings)===null||l===void 0?void 0:l[0];x&&Object.assign(x,u),Object.assign(y,{});try{await r.setParameters(y),A.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(y.encodings)))}catch(S){!("transport"in r)||r.transport&&r.transport.state==="connected"?this.peerConnectionState!=="connected"?A.debug("[updateAdaptation] peerConnection not connected}"):A.debug("[updateAdaptation] updateRtpSenderEncodings failed",S):A.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(r,i){try{if(!jt().supportSetRtpSenderParameters||r.length!==i.length)return;for(let a=0;a<r.length;a++){const l=r[a],u=i[a];u instanceof pn&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,l.sender)}}catch{A.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(r,i,a){if(W("FORBID_MODIFY_LOCAL_OFFER_SDP"))return r;const l=ki(r);return i.forEach((u,p)=>{const m=a[p],g=l.mediaDescriptions.find(y=>y.attributes.mid===m);g&&(sh(g,u),R1(g,u,this.store.codec))}),pl(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=r=>{var i;(i=this.onFirstAudioReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoReceived=r=>{var i;(i=this.onFirstVideoReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstAudioDecoded=r=>{var i;(i=this.onFirstAudioDecoded)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoDecoded=(r,i,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,r,i,a)},this.statsFilter.onSelectedLocalCandidateChanged=(r,i)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,r,i)},this.statsFilter.onSelectedRemoteCandidateChanged=(r,i)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,r,i)},this.statsFilter.onFirstVideoDecodedTimeout=r=>{var i;(i=this.onFirstVideoDecodedTimeout)===null||i===void 0||i.call(this,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(r,i){if(r.length===i.length)for(let g=0;g<r.length;g++){var a,l,u,p,m;const y=r[g],x=i[g];if(x instanceof pn&&!Ce(a=x._hints).call(a,Zt.LOW_STREAM)&&(l=x._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((u=x._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(p=x._scalabilityMode)!==null&&p!==void 0&&p.numSpatialLayers&&((m=x._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1&&this.store.codec==="vp8"){const S={},T={high:1e3*(x._encoderConfig.bitrateMax-50),medium:5e4};S.encodings=[{rid:"m",active:!0,maxBitrate:T.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:T.high}];const C=y.sender.getParameters();await y.sender.setParameters(Object.assign(C,S))}}}async applySimulcastEncodings(r,i){if(!wn()&&r.length===i.length)for(let a=0;a<r.length;a++){const l=i[a];if(l instanceof pn&&this.isVP8Simulcast(l)){const u=r[a],p={},m={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};p.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:m.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:m.medium,scaleResolutionDownBy:4}];const g=u.sender.getParameters();await u.sender.setParameters(Object.assign(g,p))}}}isVP8Simulcast(r){var i,a,l,u,p;return!!(r instanceof pn&&W("SIMULCAST")&&this.store.codec==="vp8"&&!Ce(i=r._hints).call(i,Zt.LOW_STREAM)&&(a=r._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=r._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=r._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((p=r._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1)}logSDPExchange(r,i,a,l){if(W("SDP_LOGGING"))return A.upload("[".concat(this.store.clientId,"] exchanging ").concat(a," ").concat(i," SDP during P2PConnection.").concat(l,`
`),r),i==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}async getRemoteSSRC(r){if(!this.remoteSDP)return;const i=this.remoteSDP.getSSRC(r);return i&&i.length!==0?i[0].ssrcId:void 0}setConfiguration(r){if(jt().supportPCSetConfiguration){const i=Rh.resolvePCConfiguration(r);this.peerConnection.setConfiguration(i)}r.isPreallocation&&(this.isPreallocation=!0)}},Le(Gt.prototype,"updateRemoteRTPCapabilities",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"updateRemoteRTPCapabilities"),Gt.prototype),Le(Gt.prototype,"connect",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"connect"),Gt.prototype),Le(Gt.prototype,"updateRemoteConnect",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"updateRemoteConnect"),Gt.prototype),Le(Gt.prototype,"createDataChannels",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"createDataChannels"),Gt.prototype),Le(Gt.prototype,"receive",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"receive"),Gt.prototype),Le(Gt.prototype,"batchReceive",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"batchReceive"),Gt.prototype),Le(Gt.prototype,"stopReceiving",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"stopReceiving"),Gt.prototype),Le(Gt.prototype,"muteRemote",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"muteRemote"),Gt.prototype),Le(Gt.prototype,"unmuteRemote",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"unmuteRemote"),Gt.prototype),Le(Gt.prototype,"muteLocal",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"muteLocal"),Gt.prototype),Le(Gt.prototype,"unmuteLocal",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"unmuteLocal"),Gt.prototype),Le(Gt.prototype,"close",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"close"),Gt.prototype),Le(Gt.prototype,"updateEncoderConfig",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"updateEncoderConfig"),Gt.prototype),Le(Gt.prototype,"updateSendParameters",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"updateSendParameters"),Gt.prototype),Le(Gt.prototype,"replaceTrack",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"replaceTrack"),Gt.prototype),Le(Gt.prototype,"updateAdaptation",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"updateAdaptation"),Gt.prototype),Le(Gt.prototype,"getRemoteSSRC",[Xi],Object.getOwnPropertyDescriptor(Gt.prototype,"getRemoteSSRC"),Gt.prototype),Gt);function Xi(t,r,i){const a=t[r];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){const l=this.mutex,u=await l.lock("From P2PConnection.".concat(r));try{for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];return await a.apply(this,m)}finally{u()}},i}function Y1(t,r){let i=document.createElement("video"),a=document.createElement("canvas");i.setAttribute("style","display:none"),a.setAttribute("style","display:none"),i.setAttribute("muted",""),i.muted=!0,i.setAttribute("autoplay",""),i.autoplay=!0,i.setAttribute("playsinline",""),a.width=qi(r.width),a.height=qi(r.height);const l=qi(r.framerate||15);document.body.append(i),document.body.append(a);let u=t._mediaStreamTrack;i.srcObject=new MediaStream([u]),i.play().catch(b0);const p=a.getContext("2d");if(!p)throw new pe(K.UNEXPECTED_ERROR,"can not get canvas context");const m=jt(),g=a.captureStream(m.supportRequestFrame?0:l).getVideoTracks()[0];g.canvas||(g.canvas=a),a.startCapture=()=>{if(!i)return a.stopCapture&&a.stopCapture();if(i.paused&&i.play(),i.videoHeight>2&&i.videoWidth>2){const x=i.videoWidth,S=i.videoHeight/x,T=a.width*S;Math.abs(T-a.height)>=2&&(A.debug("adjust low stream resolution","".concat(a.width,"x").concat(a.height," -> ").concat(a.width,"x").concat(T)),a.height=T)}p.drawImage(i,0,0,a.width,a.height),g.requestFrame&&g.requestFrame(),u!==t._mediaStreamTrack&&(u=t._mediaStreamTrack,i.srcObject=new MediaStream([u]))},a.stopCapture=YA(()=>a.startCapture&&a.startCapture(),l);const y=g.stop;return g.stop=()=>{y.call(g),i&&(i.remove(),i.srcObject=null,i=null),a&&(a.width=0,a.remove(),a.stopCapture&&a.stopCapture(),a.startCapture=void 0,a.stopCapture=void 0,a=null),A.debug("clean low stream renderer")},g}var TG=function(t){return t[t.Video_Send_Type=190]="Video_Send_Type",t}(TG||{}),Ho=function(t){return t[t.Video_Send_Qp_Sum=2143]="Video_Send_Qp_Sum",t[t.Video_Send_Freeze=2082]="Video_Send_Freeze",t[t.Video_Recv_Qp_Sum=2144]="Video_Recv_Qp_Sum",t[t.Video_Recv_Freeze=2084]="Video_Recv_Freeze",t[t.Video_Render_Freeze_Time=2109]="Video_Render_Freeze_Time",t[t.Video_Render_Freeze_Time_Render=2147]="Video_Render_Freeze_Time_Render",t[t.Video_Render_Freeze_Time_Render2=2223]="Video_Render_Freeze_Time_Render2",t[t.Audio_Recv_Freeze=2083]="Audio_Recv_Freeze",t}(Ho||{}),_t=function(t){return t[t.Video_Send_Retransmit=2062]="Video_Send_Retransmit",t[t.Video_Send_Target_Encoded=2064]="Video_Send_Target_Encoded",t[t.Video_Send_Actual_Encoded=2060]="Video_Send_Actual_Encoded",t[t.Video_Send_Transmit=2066]="Video_Send_Transmit",t[t.Video_Send_Bandwidth=2061]="Video_Send_Bandwidth",t[t.Video_Capture_Height=2033]="Video_Capture_Height",t[t.Video_Capture_Width=2035]="Video_Capture_Width",t[t.Video_Capture_Frame_Rate=2034]="Video_Capture_Frame_Rate",t[t.Video_Send_Low_Height=2073]="Video_Send_Low_Height",t[t.Video_Send_Low_Frame_Rate=2075]="Video_Send_Low_Frame_Rate",t[t.Video_Send_Low_Width=2077]="Video_Send_Low_Width",t[t.Video_Send_Low_Bitrate=2069]="Video_Send_Low_Bitrate",t[t.Video_Send_Low_Package_Lost=2070]="Video_Send_Low_Package_Lost",t[t.Video_Send_Low_Package_Rate=2071]="Video_Send_Low_Package_Rate",t[t.Video_Send_Frame_Rate=2002]="Video_Send_Frame_Rate",t[t.Video_Send_Width=2003]="Video_Send_Width",t[t.Video_Send_Height=2004]="Video_Send_Height",t[t.Video_Send_Disabled=2095]="Video_Send_Disabled",t[t.Video_Send_Adaptation=2032]="Video_Send_Adaptation",t[t.Video_Send_Player_Status=2128]="Video_Send_Player_Status",t[t.Video_Send_Nacks=2009]="Video_Send_Nacks",t[t.Video_Send_Plis=2010]="Video_Send_Plis",t[t.Video_Send_Firs=2011]="Video_Send_Firs",t[t.Video_Send_Avg_Encode=2007]="Video_Send_Avg_Encode",t[t.Video_Send_Huge_Frame_Sent=2174]="Video_Send_Huge_Frame_Sent",t[t.Video_Send_Bytes_Retransmit=2173]="Video_Send_Bytes_Retransmit",t[t.Video_Send_Packages_Retransmit=2172]="Video_Send_Packages_Retransmit",t[t.Video_Send_Key_Frames_Encoded=2207]="Video_Send_Key_Frames_Encoded",t[t.Video_Send_Bitrate=2012]="Video_Send_Bitrate",t[t.Video_Send_Package_Rate=2031]="Video_Send_Package_Rate",t[t.Video_Send_Package_Lost=2005]="Video_Send_Package_Lost",t[t.Audio_Capture_PCM_Level=2104]="Audio_Capture_PCM_Level",t[t.Audio_Send_Level=2038]="Audio_Send_Level",t[t.Audio_Send_Bitrate=2039]="Audio_Send_Bitrate",t[t.Audio_Send_Package_Rate=2040]="Audio_Send_Package_Rate",t[t.Audio_Send_AEC_Return_Loss=2041]="Audio_Send_AEC_Return_Loss",t[t.Audio_Send_AEC_Return_Loss_Enhancement=2042]="Audio_Send_AEC_Return_Loss_Enhancement",t[t.Audio_Send_Freeze=2081]="Audio_Send_Freeze",t[t.Audio_Send_Disabled=2096]="Audio_Send_Disabled",t[t.Audio_Send_Bytes_Retransmit=2179]="Audio_Send_Bytes_Retransmit",t[t.Audio_Send_Packages_Retransmit=2180]="Audio_Send_Packages_Retransmit",t[t.Video_Recv_Height=2019]="Video_Recv_Height",t[t.Video_Recv_Width=2018]="Video_Recv_Width",t[t.Video_Recv_Frame_Rate_Output=2155]="Video_Recv_Frame_Rate_Output",t[t.Video_Recv_Jitter_Buffer=2023]="Video_Recv_Jitter_Buffer",t[t.Video_Recv_Current_Delay=2024]="Video_Recv_Current_Delay",t[t.Video_Recv_Nacks=2026]="Video_Recv_Nacks",t[t.Video_Recv_Plis=2027]="Video_Recv_Plis",t[t.Video_Recv_Firs=2028]="Video_Recv_Firs",t[t.Video_Recv_Disabled=2101]="Video_Recv_Disabled",t[t.Video_Recv_Player_Status=2129]="Video_Recv_Player_Status",t[t.Video_Recv_I_Frame_Delay=2149]="Video_Recv_I_Frame_Delay",t[t.Video_Render_Frame_Rate_Render=2022]="Video_Render_Frame_Rate_Render",t[t.Video_Render_Freeze_Duration=2156]="Video_Render_Freeze_Duration",t[t.Audio_Render_Level=2043]="Audio_Render_Level",t[t.Audio_Render_Freeze_Time_80ms=2226]="Audio_Render_Freeze_Time_80ms",t[t.Audio_Render_Freeze_Time_200ms=2227]="Audio_Render_Freeze_Time_200ms",t[t.Audio_Render_Freeze_Samples_80ms=2228]="Audio_Render_Freeze_Samples_80ms",t[t.Audio_Render_Freeze_Samples_200ms=2229]="Audio_Render_Freeze_Samples_200ms",t[t.Audio_Recv_PCM_Level=2105]="Audio_Recv_PCM_Level",t[t.Audio_Recv_Disabled=2102]="Audio_Recv_Disabled",t[t.Audio_Recv_Jitter_Buffer=2054]="Audio_Recv_Jitter_Buffer",t[t.Audio_Recv_Current_Delay=2047]="Audio_Recv_Current_Delay",t[t.Audio_Recv_Player_Status=2130]="Audio_Recv_Player_Status",t[t.Audio_Recv_Bitrate=2044]="Audio_Recv_Bitrate",t[t.Audio_Recv_Concealed_Samples=2148]="Audio_Recv_Concealed_Samples",t[t.Audio_Recv_Total_Samples_Received=2224]="Audio_Recv_Total_Samples_Received",t}(_t||{}),Tr=function(t){return t[t.Video_Render_Frame_Rate_Decode=2021]="Video_Render_Frame_Rate_Decode",t[t.Video_Recv_Frame_Rate=2020]="Video_Recv_Frame_Rate",t[t.Video_Recv_Frame_Dropped=2181]="Video_Recv_Frame_Dropped",t[t.Video_Recv_Bytes_Retransmit=2175]="Video_Recv_Bytes_Retransmit",t[t.Video_Recv_Packages_Retransmit=2176]="Video_Recv_Packages_Retransmit",t[t.Video_Recv_Packages_Discarded=2198]="Video_Recv_Packages_Discarded",t[t.Video_Recv_Avg_Decode=2200]="Video_Recv_Avg_Decode",t[t.Video_Recv_Avg_Processing_Delay=2202]="Video_Recv_Avg_Processing_Delay",t[t.Video_Recv_Avg_Assembly_Time=2203]="Video_Recv_Avg_Assembly_Time",t[t.Video_Recv_Avg_Inter_Frame_Delay=2204]="Video_Recv_Avg_Inter_Frame_Delay",t[t.Video_Recv_Key_Frames_Decoded=2206]="Video_Recv_Key_Frames_Decoded",t[t.Video_Recv_Package_Lost=2014]="Video_Recv_Package_Lost",t[t.Video_Recv_Bitrate=2029]="Video_Recv_Bitrate",t[t.Video_Recv_Package_Rate=2078]="Video_Recv_Package_Rate",t[t.Audio_Recv_Jitter=2055]="Audio_Recv_Jitter",t[t.Audio_Recv_Bytes_Retransmit=2178]="Audio_Recv_Bytes_Retransmit",t[t.Audio_Recv_Packages_Retransmit=2177]="Audio_Recv_Packages_Retransmit",t[t.Audio_Recv_Packages_Discarded=2199]="Audio_Recv_Packages_Discarded",t[t.Audio_Recv_Avg_Processing_Delay=2201]="Audio_Recv_Avg_Processing_Delay",t[t.Audio_Recv_Package_Rate=2046]="Audio_Recv_Package_Rate",t[t.Audio_Recv_Package_Lost=2045]="Audio_Recv_Package_Lost",t[t.Audio_Recv_AV_Sync_TIME=2237]="Audio_Recv_AV_Sync_TIME",t}(Tr||{}),zr=function(t){return t[t.RTT=2006]="RTT",t[t.CONN_TYPE=801]="CONN_TYPE",t[t.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",t}(zr||{}),Nm=function(t){return t[t.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",t[t.PAGE_VISIBILITY=2233]="PAGE_VISIBILITY",t}(Nm||{}),q1=function(t){return t[t.Transport_Send_Bitrate=2234]="Transport_Send_Bitrate",t[t.Transport_Recv_Bitrate=2235]="Transport_Recv_Bitrate",t}(q1||{});const oh=1e3,G_=6,U0=3,$ve=Math.max(G_,U0,60);function dt(t,r,i){i!=null&&Number.isFinite(i)&&(t[r]=Math.round(Math.max(0,i)))}function NG(t){const r={[zr.CONN_TYPE]:0,[zr.RTT]:t.rtt,[zr.STATS_UPDATE_INTERVAL]:t.updateInterval?Math.round(Math.max(0,t.updateInterval)):void 0};switch(t.selectedCandidatePair.localCandidate.candidateType){case"relay":{const i=t.selectedCandidatePair.localCandidate.relayProtocol;i==="udp"&&(r[zr.CONN_TYPE]=1),i==="tcp"&&(r[zr.CONN_TYPE]=3),i==="tls"&&(r[zr.CONN_TYPE]=4);break}case"srflx":r[zr.CONN_TYPE]=2;break;case"unknown":r[zr.CONN_TYPE]=5;break;default:r[zr.CONN_TYPE]=0}return r}function CG(t){let r=0;switch(t){case"none":r=0;break;case"cpu":r=1;break;case"bandwidth":r=2;break;case"other":r=3}return r}class RG extends Pn{constructor(r){super(),F(this,"store",void 0),F(this,"uploadWRTCStatsTimer",void 0),F(this,"uploadOutboundDenoiserStatsTimer",void 0),F(this,"uploadExtStatsTimer",void 0),F(this,"uploadExtUsageStatsTimer",void 0),F(this,"uploadInboundExtStatsTimer",void 0),F(this,"requestStats",void 0),F(this,"requestTransportStats",void 0),F(this,"requestLocalMedia",void 0),F(this,"requestRemoteMedia",void 0),F(this,"requestAllTracks",void 0),F(this,"requestVideoIsReady",void 0),F(this,"requestUploadStats",void 0),F(this,"requestUpload",void 0),F(this,"uploadOutboundStarted",!1),F(this,"uploadInboundStarted",!1),F(this,"uploadTransportStarted",!1),F(this,"uploadBaseStatsStarted",!1),F(this,"uploadExtensionUsageStarted",!1),F(this,"lastRecvStats",void 0),F(this,"lastSendStats",void 0),F(this,"lastRefRecvStats",void 0),F(this,"lastRefSendStats",void 0),F(this,"lastNormalRecvStats",void 0),F(this,"lastNormalSendStats",void 0),F(this,"lastExtendStats",{}),F(this,"needUploadStats",{}),F(this,"needUploadRenderFreezeTime",!0),F(this,"lastUploadCompensateTime",-1),F(this,"uploadCompensateDeltaTime",0),this.store=r}uploadWRTCStats(r){if(!this.requestStats||!this.requestUploadStats)return;const i=r%U0==0,a=r%G_==0,l=r%60==0;let u,p;if(this.uploadTransportStarted&&(u=this.requestStats(),this.store.useP2P&&(p=this.requestStats(!0))),!u&&this.uploadOutboundStarted&&(u=this.requestStats()),!p&&this.uploadInboundStarted&&(p=this.requestStats(!0)),u||p){var m;const g={};if(this.uploadTransportStarted&&u){const x=this.getTransportStats(u,i?this.lastRefSendStats:void 0,p,i);x&&(g.misc=[x])}if(this.uploadOutboundStarted&&u){const x=this.getOutboundStats(u,a?this.lastNormalSendStats:void 0,i?this.lastRefSendStats:void 0,this.lastSendStats,l);x&&(g.outbound=[x])}if(this.uploadInboundStarted&&p){this.uploadCompensateStats(r);const x=this.getInboundStats(p,a?this.lastNormalRecvStats:void 0,i?this.lastRefRecvStats:void 0,this.lastRecvStats);x&&(g.inbound=x)}const y=(m=this.requestTransportStats)===null||m===void 0?void 0:m.call(this).connectState;if(y&&(Array.isArray(g.misc)?g.misc[0]&&g.misc[0].addition&&(g.misc[0].addition[Nm.RTC_PEER_CONNECTION_STATE]=PA[y]):g.misc=[{addition:{[Nm.RTC_PEER_CONNECTION_STATE]:PA[y]}}]),Is.needUploadStats.length>0||a){const x=Is.needUploadStats.shift()||(Is.visibility==="visible"?1:0);Array.isArray(g.misc)?g.misc[0]&&g.misc[0].addition&&(g.misc[0].addition[Nm.PAGE_VISIBILITY]=x):g.misc=[{addition:{[Nm.PAGE_VISIBILITY]:x}}]}this.needUploadStats.sendType&&(Array.isArray(g.outbound)&&g.outbound[0]&&g.outbound[0].high&&(g.outbound[0].high[TG.Video_Send_Type]=this.needUploadStats.sendType),this.needUploadStats.sendType=void 0),this.requestUploadStats(g)}this.lastRecvStats=p,this.lastSendStats=u,a&&(this.lastNormalRecvStats=p,this.lastNormalSendStats=u),i&&(this.lastRefRecvStats=p,this.lastRefSendStats=u)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0,Is.startCollectStats();let r=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var i,a;const l=(i=this.requestTransportStats)===null||i===void 0?void 0:i.call(this);return void(l&&((a=this.requestUploadStats)===null||a===void 0||a.call(this,{misc:[{addition:{[Nm.RTC_PEER_CONNECTION_STATE]:PA[l.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(r),++r===$ve+1&&(r=1)},oh)}uploadCompensateStats(r){if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const i=r%U0==0&&this.needUploadRenderFreezeTime;if(!this.uploadInboundStarted||!i)return;if(this.lastUploadCompensateTime===-1)return void(this.lastUploadCompensateTime=Date.now());const a=Math.max(-6e3,Date.now()-this.lastUploadCompensateTime-6e3);if(this.uploadCompensateDeltaTime+=a,this.lastUploadCompensateTime=Date.now(),this.uploadCompensateDeltaTime<6e3)return;const l=Math.min(Math.floor(this.uploadCompensateDeltaTime/6e3),10);this.uploadCompensateDeltaTime-=6e3*l;const u=this.requestStats(!0);new Array(l).fill(0).forEach(()=>{if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const p={};if(this.uploadInboundStarted&&u){const m=this.requestRemoteMedia()||[],g=[];m.forEach(y=>{let[x,S]=y;const T={peer:x.uid};if(x._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(x._videoSSRC)&&S.has(ze.VIDEO)&&x.videoTrack){const C=function(V,j,L){if(!j.videoRecv.find(Y=>Y.ssrc===V))return;const H={};if(L&&L._player){const Y=L._player,{renderFreezeAccTime2:te,videoElementStatus:se}=Y;if(Is.visibility==="visible"&&se===ii.PLAYING&&jt().supportRequestVideoFrameCallback){const oe=Math.min(6e3,te);Y.renderFreezeAccTime2=Math.max(0,te-oe),dt(H,Ho.Video_Render_Freeze_Time_Render2,oe),W("USE_NEW_RENDER_FREEZE_TIME")&&dt(H,Ho.Video_Render_Freeze_Time_Render,oe)}}return H}(x._videoSSRC,u,x.videoTrack);C&&(T.video=C)}T.video&&g.push(T)}),g.length>0&&(p.inbound=g,this.requestUploadStats(p))}})}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastExtendStats={},this.needUploadStats={},this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0}getTransportStats(r,i,a,l){if(!this.requestStats)return;if(!l)return r.rtt==null?void 0:{addition:{[zr.RTT]:r.rtt,[zr.CONN_TYPE]:void 0,[zr.STATS_UPDATE_INTERVAL]:r.updateInterval||void 0}};const u=NG(r);if(this.store.useP2P){if(a){const p=NG(a);u[zr.CONN_TYPE]&&p[zr.CONN_TYPE]&&(u[zr.CONN_TYPE]+=p[zr.CONN_TYPE]<<3)}u[zr.CONN_TYPE]?u[zr.CONN_TYPE]+=110:u[zr.CONN_TYPE]=110}else{u[zr.CONN_TYPE]?u[zr.CONN_TYPE]+=100:u[zr.CONN_TYPE]=100;const p=function(m,g){return g?[Math.ceil(8*(m.transport.bytesSent-g.transport.bytesSent)/(m.timestamp-g.timestamp)),Math.ceil(8*(m.transport.bytesReceived-g.transport.bytesReceived)/(m.timestamp-g.timestamp))]:[0,0]}(r,i);u[q1.Transport_Send_Bitrate]=p[0],u[q1.Transport_Recv_Bitrate]=p[1]}return{addition:u}}getOutboundStats(r,i,a,l,u){if(!this.requestUploadStats||!this.requestLocalMedia)return;const p=this.requestLocalMedia();if(!p||p.length===0)return;let m,g,y;return p.forEach(x=>{let[S,{track:T,ssrcs:C}]=x;switch(S){case Re.LocalVideoLowTrack:case Re.LocalVideoTrack:if(S===Re.LocalVideoTrack){var V;const j=function(te,se,oe,ne,de,be){const Se=se.videoSend.find(Tt=>Tt.ssrc===te);if(!Se)return;const Be={},{sentFrame:mt,inputFrame:ut}=Se;if(ne&&(dt(Be,Ho.Video_Send_Qp_Sum,Se.qpSumPerFrame),ut&&mt)){const Tt=ut.frameRate,Et=mt.frameRate;Be[Ho.Video_Send_Freeze]=function(Xt,An){let _e=!0;return _e=!(Xt<=5)&&(Xt<=10?An<3:Xt<=20?An<4:An<5),_e}(Tt,Et)?1:0}if(de){switch(mt&&(dt(Be,_t.Video_Send_Height,mt.height),dt(Be,_t.Video_Send_Width,mt.width),dt(Be,_t.Video_Send_Frame_Rate,mt.frameRate)),Be[_t.Video_Send_Disabled]=oe._originMediaStreamTrack&&!oe._originMediaStreamTrack.enabled||oe._mediaStreamTrack&&!oe._mediaStreamTrack.enabled?1:0,Se.adaptionChangeReason){case"none":Be[_t.Video_Send_Adaptation]=0;break;case"cpu":Be[_t.Video_Send_Adaptation]=1;break;case"bandwidth":Be[_t.Video_Send_Adaptation]=2;break;case"other":Be[_t.Video_Send_Adaptation]=3}let Tt=0;Se.adaptionChangeReason&&(Tt+=CG(Se.adaptionChangeReason)),se.qualityLimitationReason&&(Tt+=CG(se.qualityLimitationReason)<<3),Be[_t.Video_Send_Adaptation]=Tt,Be[_t.Video_Send_Player_Status]=zA[oe._player?oe._player.videoElementStatus:"uninit"],dt(Be,_t.Video_Send_Nacks,Se.nacksCount),dt(Be,_t.Video_Send_Plis,Se.plisCount),dt(Be,_t.Video_Send_Firs,Se.firsCount),dt(Be,_t.Video_Send_Avg_Encode,Se.avgEncodeMs),dt(Be,_t.Video_Send_Huge_Frame_Sent,Se.hugeFramesSent),dt(Be,_t.Video_Send_Bytes_Retransmit,Se.retransmittedBytesSent),dt(Be,_t.Video_Send_Packages_Retransmit,Se.retransmittedPacketsSent),dt(Be,_t.Video_Send_Key_Frames_Encoded,Se.keyFramesEncoded);const Et=de.videoSend.find(Xt=>Xt.ssrc===te);if(Et){let Xt=oh*U0;Et.timestamp&&Se.timestamp&&(Xt=Se.timestamp-Et.timestamp),Et.packets!=null&&Se.packets!=null&&dt(Be,_t.Video_Send_Package_Rate,1e3*(Se.packets-Et.packets)/Xt),Se.packetsLost!=null&&Et.packetsLost!=null&&dt(Be,_t.Video_Send_Package_Lost,Se.packetsLost-Et.packetsLost),Et.bytes!=null&&Se.bytes!=null&&dt(Be,_t.Video_Send_Bitrate,8*(Se.bytes-Et.bytes)/Xt)}}return Be}(C[0].ssrcId,r,T,i,a),L=T.__className__==="CameraVideoTrack"?3:Ce(V=T._hints).call(V,Zt.SCREEN_TRACK)?7:10;(this.lastExtendStats.sendType!==L||u)&&(this.needUploadStats={sendType:L},this.lastExtendStats.sendType=L);const H=T&&function(te,se,oe,ne){const de=se.videoSend.find(Se=>Se.ssrc===te);if(!de)return null;const be={};if(ne){const Se=de.inputFrame,Be=Se&&Se.height||oe.videoHeight||0,mt=Se&&Se.width||oe.videoWidth||0,ut=Se&&Se.frameRate||0;dt(be,_t.Video_Capture_Height,Be),dt(be,_t.Video_Capture_Width,mt),dt(be,_t.Video_Capture_Frame_Rate,ut)}return be}(C[0].ssrcId,r,T,!!a),Y=function(te,se){const oe={};return se&&(dt(oe,_t.Video_Send_Retransmit,te.bitrate.retransmit),dt(oe,_t.Video_Send_Target_Encoded,te.bitrate.targetEncoded),dt(oe,_t.Video_Send_Actual_Encoded,te.bitrate.actualEncoded),dt(oe,_t.Video_Send_Transmit,te.bitrate.transmit),dt(oe,_t.Video_Send_Bandwidth,te.sendBandwidth)),oe}(r,!!a);g=Object.assign({},j,H,Y)}else y=function(j,L,H,Y,te){const se=L.videoSend.find(ne=>ne.ssrc===j);if(!se)return;const oe={};if(Y){const ne=se.sentFrame;ne&&(dt(oe,_t.Video_Send_Low_Height,ne.height),dt(oe,_t.Video_Send_Low_Width,ne.width),dt(oe,_t.Video_Send_Low_Frame_Rate,ne.frameRate));const de=Y.videoSend.find(be=>be.ssrc===j);if(de){let be=oh*G_;de.timestamp&&se.timestamp&&(be=se.timestamp-de.timestamp),de.packets!=null&&se.packets!=null&&dt(oe,_t.Video_Send_Low_Package_Rate,1e3*(se.packets-de.packets)/be),se.packetsLost!=null&&de.packetsLost!=null&&dt(oe,_t.Video_Send_Low_Package_Lost,se.packetsLost-de.packetsLost),de.bytes!=null&&se.bytes!=null&&dt(oe,_t.Video_Send_Low_Bitrate,8*(se.bytes-de.bytes)/be)}}return oe}(C[0].ssrcId,r,0,a);break;case Re.LocalAudioTrack:m=T&&function(j,L,H,Y,te,se){const oe=L.audioSend.find(de=>de.ssrc===j);if(!oe)return;const ne={};if(te){ne[_t.Audio_Send_Disabled]=H._originMediaStreamTrack&&!H._originMediaStreamTrack.enabled||H._mediaStreamTrack&&!H._mediaStreamTrack.enabled?1:0;const de=100*H._source.getAccurateVolumeLevel(),be=oe.inputLevel;if(be!=null){const Be=Math.ceil(50*Math.log10(100*be+1));dt(ne,_t.Audio_Send_Level,Be)}dt(ne,_t.Audio_Capture_PCM_Level,de),dt(ne,_t.Audio_Send_AEC_Return_Loss,oe.aecReturnLoss),dt(ne,_t.Audio_Send_AEC_Return_Loss_Enhancement,oe.aecReturnLossEnhancement),dt(ne,_t.Audio_Send_Bytes_Retransmit,oe.retransmittedBytesSent),dt(ne,_t.Audio_Send_Packages_Retransmit,oe.retransmittedPacketsSent),ne[_t.Audio_Send_Freeze]=0;const Se=te.audioSend.find(Be=>Be.ssrc===j);if(Se){let Be=oh*G_;Se.timestamp&&oe.timestamp&&(Be=oe.timestamp-Se.timestamp),Se.bytes!=null&&oe.bytes!=null&&dt(ne,_t.Audio_Send_Bitrate,8*(oe.bytes-Se.bytes)/Be),Se.packets!=null&&oe.packets!=null&&dt(ne,_t.Audio_Send_Package_Rate,1e3*(oe.packets-Se.packets)/Be)}}return ne}(C[0].ssrcId,r,T,0,a)}}),{high:g,low:y,audio:m}}getInboundStats(r,i,a,l){if(!this.requestRemoteMedia)return;const u=this.requestRemoteMedia()||[],p=[];return u.forEach(m=>{let[g,y]=m;const x={peer:g.uid};let S;if(y.has(ze.VIDEO)&&g.videoTrack){const T=g._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(g._videoSSRC)||!1,C=g.videoTrack?function(V,j,L,H,Y,te,se,oe){const ne=j.videoRecv.find(Et=>Et.ssrc===V);if(!ne)return;const de={},{receivedFrame:be,outputFrame:Se,decodeFrameRate:Be}=ne;dt(de,Tr.Video_Render_Frame_Rate_Decode,Be),ne.framesRateFirefox&&dt(de,Tr.Video_Recv_Frame_Rate,ne.framesRateFirefox),be&&dt(de,Tr.Video_Recv_Frame_Rate,be.frameRate),dt(de,Tr.Video_Recv_Frame_Dropped,ne.framesDroppedCount),dt(de,Tr.Video_Recv_Bytes_Retransmit,ne.retransmittedBytesReceived),dt(de,Tr.Video_Recv_Packages_Retransmit,ne.retransmittedPacketsReceived),dt(de,Tr.Video_Recv_Packages_Discarded,ne.packetsDiscarded),dt(de,Tr.Video_Recv_Avg_Decode,ne.avgDecodeMs),dt(de,Tr.Video_Recv_Avg_Processing_Delay,ne.avgProcessingDelayMs),dt(de,Tr.Video_Recv_Avg_Assembly_Time,ne.avgFramesAssembledFromMultiplePacketsMs),dt(de,Tr.Video_Recv_Avg_Inter_Frame_Delay,ne.avgInterFrameDelayMs),dt(de,Tr.Video_Recv_Key_Frames_Decoded,ne.keyFramesDecoded);const mt=oe&&oe.videoRecv.find(Et=>Et.ssrc===V);if(mt){const Et=j.timestamp-oe.timestamp||oh;ne.packetsLost!=null&&mt.packetsLost!=null&&dt(de,Tr.Video_Recv_Package_Lost,ne.packetsLost-mt.packetsLost),mt.bytes!=null&&ne.bytes!=null&&dt(de,Tr.Video_Recv_Bitrate,8*(ne.bytes-mt.bytes)/Et),mt.packets!=null&&ne.packets!=null&&dt(de,Tr.Video_Recv_Package_Rate,1e3*(ne.packets-mt.packets)/Et)}const ut=te&&te.videoRecv.find(Et=>Et.ssrc===V);if(ut&&(dt(de,Ho.Video_Recv_Qp_Sum,ne.qpSumPerFrame),de[Ho.Video_Recv_Freeze]=H&&L0.isRemoteVideoFreeze(L,ne,ut)?1:0),se){var Tt;const Et=se.videoRecv.find(An=>An.ssrc===V);be?(dt(de,_t.Video_Recv_Height,be.height),dt(de,_t.Video_Recv_Width,be.width)):L&&(dt(de,_t.Video_Recv_Height,L._videoHeight||0),dt(de,_t.Video_Recv_Width,L._videoWidth||0)),Se&&dt(de,_t.Video_Recv_Frame_Rate_Output,Se.frameRate);const Xt=(Tt=L._player)===null||Tt===void 0?void 0:Tt.rendFrameRate.toFixed(0);if(Xt&&dt(de,_t.Video_Render_Frame_Rate_Render,+Xt),dt(de,_t.Video_Recv_Jitter_Buffer,ne.jitterBufferMs),dt(de,_t.Video_Recv_Current_Delay,ne.currentDelayMs),dt(de,_t.Video_Recv_Firs,ne.firsCount),dt(de,_t.Video_Recv_Nacks,ne.nacksCount),dt(de,_t.Video_Recv_Plis,ne.plisCount),L){de[_t.Video_Recv_Disabled]=L._originMediaStreamTrack.enabled&&L._mediaStreamTrack.enabled?0:1;const An=L._player;if(An){const{freezeTimeCounterList:_e,renderFreezeAccTime:Oe,renderFreezeAccTime2:He,videoElementStatus:we}=An;if(_e&&_e.length>0&&dt(de,Ho.Video_Render_Freeze_Time,_e.splice(0,1)[0]),Y&&Is.visibility==="visible"&&we===ii.PLAYING&&jt().supportRequestVideoFrameCallback){const k=Math.min(6e3,He);An.renderFreezeAccTime2=Math.max(0,He-k),dt(de,Ho.Video_Render_Freeze_Time_Render2,k);const Z=Math.min(6e3,Oe);An.renderFreezeAccTime=Math.max(0,Oe-Z),dt(de,Ho.Video_Render_Freeze_Time_Render,W("USE_NEW_RENDER_FREEZE_TIME")?k:Z)}if(typeof ne.totalFreezesDuration=="number"){const k=Et&&Et.totalFreezesDuration?ne.totalFreezesDuration-Et.totalFreezesDuration:ne.totalFreezesDuration;dt(de,_t.Video_Render_Freeze_Duration,1e3*k)}}}if(de[_t.Video_Recv_Player_Status]=zA[L._player?L._player.videoElementStatus:"uninit"],Et&&ne.totalInterFrameDelay!==void 0&&ne.totalSquaredInterFrameDelay!==void 0&&Et.totalInterFrameDelay!==void 0&&Et.totalSquaredInterFrameDelay!==void 0){const An=ne.totalInterFrameDelay-Et.totalInterFrameDelay,_e=ne.totalSquaredInterFrameDelay-Et.totalSquaredInterFrameDelay,Oe=ne.framesDecodeCount-Et.framesDecodeCount,He=An/Oe*1e3,we=Math.round(1e3*Math.sqrt((_e-Math.pow(An,2)/Oe)/Oe));!isNaN(we)&&He+we>Math.max(3*He,He+150)&&(de[_t.Video_Recv_I_Frame_Delay]=we)}}return de}(g._videoSSRC,r,g.videoTrack,T===!0,this.needUploadRenderFreezeTime,i,a,l):void 0;if(C&&(x.video=C),g.videoTrack){const V=r.videoRecv.find(j=>j.ssrc===g._videoSSRC);V&&V.estimatedPlayoutTimestamp&&(S=V.estimatedPlayoutTimestamp)}}if(y.has(ze.AUDIO)&&g.audioTrack){const T=g.audioTrack?function(C,V,j,L,H,Y){const te=V.audioRecv.find(de=>de.ssrc===C);if(!te)return;const se={};dt(se,Tr.Audio_Recv_Jitter,te.jitterMs),dt(se,Tr.Audio_Recv_Bytes_Retransmit,te.retransmittedBytesReceived),dt(se,Tr.Audio_Recv_Packages_Retransmit,te.retransmittedPacketsReceived),dt(se,Tr.Audio_Recv_Packages_Discarded,te.packetsDiscarded),dt(se,Tr.Audio_Recv_Avg_Processing_Delay,te.avgProcessingDelayMs);const oe=Y&&Y.audioRecv.find(de=>de.ssrc===C);if(oe){const de=oh;te.packets!=null&&oe.packets!=null&&dt(se,Tr.Audio_Recv_Package_Rate,1e3*(te.packets-oe.packets)/de),te.packetsLost!=null&&oe.packetsLost!=null&&dt(se,Tr.Audio_Recv_Package_Lost,te.packetsLost-oe.packetsLost)}if(L){const{receivedFrames:de,droppedFrames:be}=te;de!=null&&be!=null&&(se[Ho.Audio_Recv_Freeze]=(ne=de)===0||100*be/ne>20?1:0)}var ne;if(H){const de=100*j._source.getAccurateVolumeLevel(),be=te.outputLevel;if(be!=null){const Be=Math.ceil(50*Math.log10(100*be+1));dt(se,_t.Audio_Render_Level,Be)}dt(se,_t.Audio_Recv_PCM_Level,de),j&&(se[_t.Audio_Recv_Disabled]=j._originMediaStreamTrack.enabled&&j._mediaStreamTrack.enabled?0:1),dt(se,_t.Audio_Recv_Jitter_Buffer,te.jitterBufferMs),dt(se,_t.Audio_Recv_Current_Delay,te.jitterBufferMs),se[_t.Audio_Recv_Player_Status]=zA[yi.getPlayerState(j.getTrackId())];const Se=H.audioRecv.find(Be=>Be.ssrc===C);if(Se){Se.bytes!=null&&te.bytes!=null&&dt(se,_t.Audio_Recv_Bitrate,8*(te.bytes-Se.bytes)/(oh*U0));const Be=te.concealedSamples-Se.concealedSamples;Be>0&&dt(se,_t.Audio_Recv_Concealed_Samples,Be);const mt=te.totalSamplesReceived-Se.totalSamplesReceived;mt>0&&dt(se,_t.Audio_Recv_Total_Samples_Received,mt);const ut=te.freezeSamples80-Se.freezeSamples80;ut>0&&dt(se,_t.Audio_Render_Freeze_Samples_80ms,ut);const Tt=te.freezeSamples200-Se.freezeSamples200;Tt>0&&dt(se,_t.Audio_Render_Freeze_Samples_200ms,Tt);const Et=te.freezeMs80-Se.freezeMs80;dt(se,_t.Audio_Render_Freeze_Time_80ms,Et<0?0:Et);const Xt=te.freezeMs200-Se.freezeMs200;dt(se,_t.Audio_Render_Freeze_Time_200ms,Xt<0?0:Xt)}}return se}(g._audioSSRC,r,g.audioTrack,i,a,l):void 0;if(T&&(x.audio=T),g.audioTrack&&S){const C=r.audioRecv.find(V=>V.ssrc===g._audioSSRC);if(C&&C.estimatedPlayoutTimestamp){const V=C.estimatedPlayoutTimestamp-S;x.audio?x.audio[Tr.Audio_Recv_AV_Sync_TIME]=V:x.audio={[Tr.Audio_Recv_AV_Sync_TIME]:V}}}}(x.video||x.audio)&&p.push(x)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,p}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const r=(this.requestAllTracks()||[]).find(i=>i instanceof T0);if(r&&r._external.getDenoiserStats){const i=r._external.getDenoiserStats();i&&this.requestUpload(rh.DENOISER_STATS,i)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(r=>{r.getProcessorStats().forEach(i=>{this.requestUpload&&this.requestUpload(i.type,i.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastExtendStats={},this.needUploadStats={},this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0,this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(r=>{let[i,a]=r;a.has(ze.VIDEO)&&i.videoTrack&&i.videoTrack.getProcessorStats().forEach(l=>{this.requestUpload&&this.requestUpload(l.type,l.stats)}),a.has(ze.AUDIO)&&i.audioTrack&&i.audioTrack.getProcessorStats().forEach(l=>{this.requestUpload&&this.requestUpload(l.type,l.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0,this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=void 0)}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const r=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const i=Date.now(),a={connectionInterval:W("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:i};let l=[];const u=this.requestAllTracks&&this.requestAllTracks()||[];for(const y of u)!y.muted&&y.enabled&&(l=l.concat(await y.getProcessorUsage()));const p=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[y,x]of p)x.has(ze.VIDEO)&&y.videoTrack&&(l=l.concat(await y.videoTrack.getProcessorUsage())),x.has(ze.AUDIO)&&y.audioTrack&&(l=l.concat(await y.audioTrack.getProcessorUsage()));if(l.length===0)return;a.details=function(y,x){const S={};for(const{id:j,value:L,level:H,direction:Y}of y){var T;const te=(T=x.get(j))!==null&&T!==void 0?T:0,se=L===2?te+W("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:te;var C,V;x.set(j,se),S[j]?(L===2&&(S[j].value=L),H>S[j].level&&(S[j].level=H),Y==="remote"&&(S[j].remoteUidCount+=1),S[j].totalTs=(C=x.get(j))!==null&&C!==void 0?C:0):S[j]={value:L,level:H,remoteUidCount:Y==="local"?0:1,totalTs:(V=x.get(j))!==null&&V!==void 0?V:0}}return Object.keys(S).map(j=>{const{level:L,value:H,totalTs:Y}=S[j];return{id:j,level:L,value:H,totalTs:Y}})}(l,r);const m=Date.now(),g=m>i?m:i+1;this.requestUpload&&this.requestUpload(rh.EXTENSION_USAGE_STATS,{usageStats:a,sendTs:g})},W("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1,Is.stopCollectStats()}}const zve=W("ICE_RESTART_INTERVAL");let W_=new Map,Cm=new Map,Sd=[jr.UDP_TCP_RELAY,jr.TCP_RELAY,jr.RELAY],X1=W("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&jt().supportPCSetConfiguration;function AG(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=W_.get(t.id);i&&(window.clearTimeout(i),W_.delete(t.id));const a=Cm.get(t.id);r&&a&&a.index===Sd.length-1&&(A.debug("[".concat(t.id,"] reset ICE restart policy")),Cm.delete(t.id))}function IG(t,r,i){if(W_.size===0&&Cm.size===0&&(Array.isArray(W("RESTART_SEQUENCE"))&&W("RESTART_SEQUENCE").length>0&&!function(m,g){if(m.length!==g.length)return!1;for(let y=0;y<m.length;y+=1){const x=m[y];if(m.filter(S=>S===x).length!==g.filter(S=>S===x).length)return!1}return!0}(Sd,W("RESTART_SEQUENCE"))&&(Sd=W("RESTART_SEQUENCE").filter(m=>{var g;if(Ce(g=Object.values(jr)).call(g,m))return!0}),A.debug("use reconnection policy from config distribution, queues: ".concat(Sd.join(" => ")))),X1=W("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&jt().supportPCSetConfiguration),Sd.length===0)return void i();let a,{index:l=0,type:u}=Cm.get(t.id)||{};if(X1&&u===jr.RELAY)return void i();let p=u&&l>=Sd.length-1;if(X1)u=jr.RELAY;else{if(p)return void i();u?(l++,u=Sd[l]):(u=Sd[0],l=0)}A.debug("[".concat(t.id,"] choose ICE restart policy: ").concat(u,", index: ").concat(l)),r(u),Cm.set(t.id,{index:l,type:u}),a=window.setTimeout(()=>IG(t,r,i),zve),W_.set(t.id,a)}var Lt;function OG(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function kc(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?OG(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):OG(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}function PG(t){var r,i,a,l=2;for(typeof Symbol<"u"&&(i=Lx,a=Symbol.iterator);l--;){if(i&&(r=t[i])!=null)return r.call(t);if(a&&(r=t[a])!=null)return new $_(r.call(t));i="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function $_(t){function r(i){if(Object(i)!==i)return je.reject(new TypeError(i+" is not an object."));var a=i.done;return je.resolve(i.value).then(function(l){return{value:l,done:a}})}return $_=function(i){this.s=i,this.n=i.next},$_.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(i){var a=this.s.return;return a===void 0?je.resolve({value:i,done:!0}):r(a.apply(this.s,arguments))},throw:function(i){var a=this.s.return;return a===void 0?je.reject(i):r(a.apply(this.s,arguments))}},new $_(t)}let ch=(Lt=class extends Pn{get state(){return this._state}set state(t){const r=this._state;this._state=t,this.emit(rt.StateChange,r,this._state)}constructor(t,r){super(),F(this,"isPlanB",void 0),F(this,"store",void 0),F(this,"statsUploader",void 0),F(this,"connection",void 0),F(this,"localTrackMap",new Map),F(this,"remoteUserMap",new Map),F(this,"localDataChannels",[]),F(this,"remoteDataChannelMap",new Map),F(this,"pendingLocalTracks",[]),F(this,"pendingRemoteTracks",[]),F(this,"pendingLocalDataChannels",[]),F(this,"pendingRemoteDataChannels",[]),F(this,"statsCollector",void 0),F(this,"shouldForwardP2PCreation",void 0),F(this,"iceFailedCount",0),F(this,"dtlsFailedCount",0),F(this,"mutex",void 0),F(this,"_state",Qt.Disconnected),F(this,"_pcStatsUploadType",W("NEW_ICE_RESTART")?gl.FIRST_CONNECTION:gl.OLD_FIRST_CONNECTION),F(this,"_isStartRestartIce",!1),F(this,"_restartTimer",void 0),F(this,"_isTryConnecting",!1),F(this,"_iceError",null),F(this,"_forceTurn",!1),F(this,"_isWaitPcToRePub",!1),F(this,"handleMuteLocalTrack",async(i,a,l)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==Qt.Connected)return void l(new ge(K.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const p=this.filterTobeMutedTracks(i);if(p.length===0)return void a();const m=p.find(y=>y[0]==="videoLowTrack");if(m){const y=m[1];this.store.enableInstantMuteRestore?(y.track._originMediaStreamTrack.enabled=!1,A.info("[".concat(this.store.clientId,"] P2PChannel muteLocalLowTrack without close sender because enableInstantMuteRestore is true"))):y.track._originMediaStreamTrack.stop()}this.store.enableInstantMuteRestore?A.info("[".concat(this.store.clientId,"] P2PChannel muteLocalTrack without close sender because enableInstantMuteRestore is true")):await this.connection.muteLocal(p.map(y=>{let[,{id:x}]=y;return x}));const g=this.createMuteMessage(p);await gn(this,rt.RequestMuteLocal,g),a()}catch(p){l(p)}finally{u()}}),F(this,"handleUnmuteLocalTrack",async(i,a,l)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==Qt.Connected)return void l(new ge(K.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const p=this.filterTobeUnmutedTracks(i);if(p.length===0)return void a();const m=p.find(y=>y[0]==="videoLowTrack");if(m){const y=m[1];if(this.store.enableInstantMuteRestore)y.track._originMediaStreamTrack.enabled=!0,A.info("[".concat(this.store.clientId,"] P2PChannel unmuteLocalLowTrack without close sender because enableInstantMuteRestore is true"));else{if(y.track._originMediaStreamTrack.stop(),!W("DISABLE_DUAL_STREAM_USE_ENCODING")&&jt().supportDualStreamEncoding){const x=i._mediaStreamTrack.clone();y.track._mediaStreamTrack=x,y.track._originMediaStreamTrack=x}else{const x=Y1(i,Wu(this,rt.RequestLowStreamParameter));y.track._mediaStreamTrack=x,y.track._originMediaStreamTrack=x}await new je((x,S)=>{this.handleReplaceTrack(y.track,x,S,!0)})}}this.store.enableInstantMuteRestore?A.info("[".concat(this.store.clientId,"] P2PChannel unmuteLocalTrack without close sender because enableInstantMuteRestore is true")):await this.connection.unmuteLocal(p.map(y=>{let[,{id:x}]=y;return x}));const g=this.createUnmuteMessage(p);await gn(this,rt.RequestUnmuteLocal,g),a()}catch(p){l(p)}finally{u()}}),F(this,"handleUpdateVideoEncoder",async(i,a,l,u)=>{let p;u||(p=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{const g=this.localTrackMap.get(Re.LocalVideoTrack);if(!this.connection||!g||g.track!==i||this.state!==Qt.Connected)return void a();const{id:y,track:x}=g;await this.connection.updateSendParameters(y,x),await this.connection.updateEncoderConfig(y,x),this.emit(rt.UpdateVideoEncoder,x),a()}catch(g){l(g)}finally{var m;(m=p)===null||m===void 0||m()}}),F(this,"handleUpdateVideoSendParameters",async(i,a,l)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const p=this.localTrackMap.get(Re.LocalVideoTrack);if(!this.connection||!p||p.track!==i||this.state!==Qt.Connected)return void a();const{id:m,track:g}=p;await this.connection.updateSendParameters(m,g),a()}catch(p){l(p)}finally{u()}}),F(this,"handleReplaceMixingTrack",async(i,a,l,u)=>{if(!this.connection||this.state!==Qt.Connected)return void a();const p=z1([i]);let m;A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(p.getTrackId(),"]")),typeof u=="boolean"&&u||(m=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(i,p),a()}catch(y){l(y)}finally{var g;(g=m)===null||g===void 0||g()}}),F(this,"handleReplaceTrack",async(i,a,l,u)=>{let p;A.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(i.getTrackId(),"]")),typeof u=="boolean"&&u||(p=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var m;const y=Array.from(this.localTrackMap.entries()).find(x=>{let[,{track:S}]=x;return i===S});if(!this.connection||!y||this.state!==Qt.Connected)return void a();if(await((m=this.connection)===null||m===void 0?void 0:m.replaceTrack(i,y[1].id)),this.isPlanB){const x=y[1];x.id=i._mediaStreamTrack.id,this.localTrackMap.set(y[0],x)}if(y[0]===Re.LocalVideoTrack&&!W("DISABLE_DUAL_STREAM_USE_ENCODING")&&jt().supportDualStreamEncoding){const x=this.localTrackMap.get(Re.LocalVideoLowTrack);if(x){const S=i._mediaStreamTrack.clone();x.track._originMediaStreamTrack.stop(),x.track._mediaStreamTrack=S,x.track._originMediaStreamTrack=S,await new je((T,C)=>{this.handleReplaceTrack(x.track,T,C,!0)})}}a()}catch(y){l(y)}finally{var g;(g=p)===null||g===void 0||g()}}),F(this,"handleGetRTCStats",i=>{i(this.statsCollector.getRTCStats())}),F(this,"handleGetLocalVideoStats",i=>{i(this.statsCollector.getLocalVideoTrackStats())}),F(this,"handleGetLocalAudioStats",i=>{i(this.statsCollector.getLocalAudioTrackStats())}),F(this,"handleGetRemoteVideoStats",i=>this.statsCollector.getRemoteVideoTrackStats(i.uid)[i.uid]),F(this,"handleGetRemoteAudioStats",i=>this.statsCollector.getRemoteAudioTrackStats(i.uid)[i.uid]),this.store=t,this.statsCollector=r,this.statsCollector.addP2PChannel(this),this.statsUploader=new RG(this.store),this.bindStatsUploaderEvents(),this.mutex=new kr("P2PChannel-mutex",this.store.clientId),this.isPlanB=!jt().supportUnifiedPlan||W("CHROME_FORCE_PLAN_B")&&Sc(),this.shouldForwardP2PCreation=W("FORWARD_P2P_CREATION")&&jt().supportPCSetConfiguration&&fV(),this.shouldForwardP2PCreation&&(this.connection=M0(this.store),this.emit(rt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(t,r){var i;this.state=Qt.New,this._forceTurn=K1(t),A.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));const a=this.shouldForwardP2PCreation&&((i=this.connection)===null||i===void 0?void 0:i.peerConnectionState)==="closed";if((!this.shouldForwardP2PCreation||a||r)&&((a||r)&&this.connection&&(A.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=M0(this.store,t),this.emit(rt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new ge(K.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=W("NEW_ICE_RESTART")?gl.FIRST_CONNECTION:gl.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(t),this.connection.establishPromise}async connect(t){if(!this.connection)throw new ge(K.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");if(!this.isPreallocation()||this.state!==Qt.Connected){this.store.peerConnectionStart();const r=await this.connection.connect(t);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=Qt.Connected,r}if(this.connection instanceof Js&&this.connection.checkDtlsParameters(t.dtlsParameters.fingerprints))return A.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] dtls parameters mismatch, try next.")),Ye.reportApiInvoke(this.store.sessionId,{name:Cn.MISMATCH_DTLS_PARAMETERS,options:[t.dtlsParameters.fingerprints],tag:hn.TRACER}).onSuccess(),void setTimeout(()=>{this.emit(rt.RequestReconnect)});await this.connection.updateRemoteConnect(t)}updateRemoteRTPCapabilities(t){const r=Array.from(this.localTrackMap.entries()).filter(l=>{var u;let[p]=l;return Ce(u=[Re.LocalVideoLowTrack,Re.LocalVideoTrack]).call(u,p)}),i=r.map(l=>{let[,{id:u}]=l;return u}),a=r.map(l=>{let[u]=l;return u});if(this.connection instanceof Js||this.connection&&"name"in this.connection&&this.connection.name==="DataChannelConnection"){if(Ye.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(a),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(t)}),!Ce(t).call(t,this.store.codec)){const l=["vp9","vp8","h264"].find(u=>Ce(t).call(t,u));l&&(this.store.codec=l,A.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(l,".")))}this.connection.updateRemoteRTPCapabilities(i,t)}}async getEstablishParams(){var t;return this.connection&&"name"in this.connection&&this.connection.name==="DataChannelConnection"&&this.connection.peerConnectionState!=="closed"||this.connection instanceof Js&&this.connection.peerConnectionState!=="closed"&&Ce(t=[Qt.New,Qt.Connected]).call(t,this.state)?this.connection.establishPromise:void 0}async publishDataChannel(t){if(!this.connection||this.state!==Qt.Connected){if(this.state===Qt.Disconnected)throw new ge(K.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return t.forEach(i=>{var a;Ce(a=this.pendingLocalDataChannels).call(a,i)||this.pendingLocalDataChannels.push(i)}),[]}const r=this.filterTobePublishedDataChannels(t);return r.length===0?[]:(r.forEach(i=>{const a=Date.now();this.store.publish(i.id.toString(),"datachannel",a)}),await this.connection.createDataChannels(this.store.uid,r),r.forEach(i=>{this.localDataChannels.push(i);const a=Date.now();this.store.publish(i.id+"","datachannel",void 0,a)}),t.map(i=>({streamId:i.id,ordered:i.ordered,maxRetransmits:i.maxRetransmits,metadata:i.metadata,channelId:i._originDataChannelId})))}publish(t,r,i){var a=this;return $i(function*(){const l=yield Nt(a.mutex.lock("From P2PChannel.publish"));try{var u;const p=a.connection&&Ce(u=["disconnected","failed"]).call(u,a.connection.peerConnectionState);if(!a.connection||a.state!==Qt.Connected||p){if(a.state===Qt.Disconnected)throw new ge(K.UNEXPECTED_ERROR,"PeerConnection already disconnected.");a.throwIfTrackTypeNotMatch(t);const g=t.filter(y=>a.pendingLocalTracks.indexOf(y)===-1);return a.pendingLocalTracks=a.pendingLocalTracks.concat(g),void(p&&(a._isWaitPcToRePub=!0))}a.store.pubId=a.store.pubId+1,ai.markPublishStart(a.store.clientId,a.store.pubId);const m=a.filterTobePublishedTracks(t,r,i);if(m.length===0)return void(yield Nt(a.tryToUnmuteAudio(t)));yield*Xp(PG(a.doPublish(a.connection,m)))}finally{l()}})()}doPublish(t,r){var i=this;return $i(function*(){r.forEach(T=>{let{track:C,type:V}=T;const j=Date.now();i.store.publish(C.getTrackId(),V===Re.LocalAudioTrack?"audio":"video",j)}),i.bindLocalTrackEvents(r);const a=r.map(T=>{let{track:C}=T;return C}),l=yield Nt(t.send(a,i.store.codec,i.store.audioCodec)),u=(yield Nt(l.next())).value,p=i.createGatewayPublishMessage(r,u);let m;try{m=yield p}catch(T){throw l.throw(T),(T==null?void 0:T.code)===K.WS_ABORT&&r.forEach(C=>{let{track:V}=C;i.pendingLocalTracks.indexOf(V)===-1&&i.pendingLocalTracks.push(V)}),i.unbindLocalTrackEvents(r),T}const g=i.mapPubResToRemoteConfig(p,m,a),y=(yield Nt(l.next(g))).value;if(i.state===Qt.Disconnected)throw new ge(K.UNEXPECTED_ERROR,"PeerConnection already disconnected.");W("ENABLE_VIDEO_SEI");const x=W("ENABLE_ENCODED_TRANSFORM"),S=W("ENABLE_AUDIO_METADATA");a.forEach(async T=>{const C=T.getRTCRtpTransceiver();if(!C||!x)return;const{interceptLocalVideoFrame:V,interceptLocalAudioFrame:j}=k_();T.trackMediaType===ze.VIDEO?await V(C.sender,T):T.trackMediaType===ze.AUDIO&&await j(C.sender,{metadata:S?()=>{const L=T.metadata.shift();return L&&L.value}:void 0})}),r.forEach(T=>{let{type:C}=T;i.statsCollector.addLocalStats(C)}),i.assignLocalTracks(r,y),i.statsUploader.startUploadOutboundStats(),r.forEach(T=>{let{track:C,type:V}=T;const j=Date.now();i.store.publish(C.getTrackId(),V===Re.LocalAudioTrack?"audio":"video",void 0,j)})})()}async updateVideoStreamParameter(t,r){const i=this.localTrackMap.get(r);if(!i||!this.connection)return;if(!(i.track instanceof pn))return A.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");const{track:a}=i,l=function(u,p){const m={};return u.height&&u.width&&(m.scaleResolutionDownBy=S1(u,p)),m.maxFramerate=u.framerate?qi(u.framerate):void 0,m.maxBitrate=u.bitrate?1e3*u.bitrate:void 0,m}(t,a);if(a._encoderConfig||(a._encoderConfig={}),r!==Re.LocalVideoLowTrack||!W("DISABLE_DUAL_STREAM_USE_ENCODING")&&jt().supportDualStreamEncoding)l.scaleResolutionDownBy!=null&&(a._encoderConfig.scaleResolutionDownBy=l.scaleResolutionDownBy);else{const u=a._originMediaStreamTrack;if(!u.canvas)return A.warn("[".concat(a.getTrackId(),"] no canvas on track"));(function(p,m){const g=p.canvas;m.width&&(g.width=qi(m.width)),m.height&&(g.height=qi(m.height)),m.framerate&&(g.stopCapture&&g.stopCapture(),g.stopCapture=YA(()=>{!g.startCapture&&g.stopCapture&&g.stopCapture(),g.startCapture&&g.startCapture()},qi(m.framerate)))})(u,t)}l.maxBitrate!=null&&(a._encoderConfig.bitrateMax=l.maxBitrate/1e3),l.maxFramerate!=null&&(a._encoderConfig.frameRate&&typeof a._encoderConfig.frameRate=="object"?a._encoderConfig.frameRate.max=l.maxFramerate:a._encoderConfig.frameRate={max:l.maxFramerate}),A.debug("[".concat(a.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(a._encoderConfig))),await this.connection.updateRtpSenderEncodings(a)}publishLowStream(t){var r=this;return $i(function*(){if(!r.connection||r.state!==Qt.Connected)return;const i=yield Nt(r.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const l=r.localTrackMap.get(Re.LocalVideoTrack);if(!l)throw new ge(K.UNEXPECTED_ERROR,"Could not find high stream");if(r.localTrackMap.has(Re.LocalVideoLowTrack))throw new ge(K.UNEXPECTED_ERROR,"[".concat(r.store.clientId,"] Can't publish low stream when stream already publish"));const u=[{track:r.getLowVideoTrack(l.track,t),type:Re.LocalVideoLowTrack}];if(yield*Xp(PG(r.doPublish(r.connection,u))),l.track.muted||!l.track.enabled){var a;const p=(a=r.localTrackMap.get(Re.LocalVideoLowTrack))===null||a===void 0?void 0:a.id;p!==void 0&&(yield Nt(r.connection.muteLocal([p])))}}finally{i()}})()}async republish(){this.pendingLocalTracks.length>0&&(A.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await or(this,rt.RequestRePublish,this.pendingLocalTracks),this.emit(rt.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(A.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await or(this,rt.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(t){for(let r=this.pendingRemoteTracks.length-1;r>=0;r--){const{user:i,kind:a}=this.pendingRemoteTracks[r];(a!==ze.AUDIO||i._audio_added_&&i._audioSSRC)&&(a!==ze.VIDEO||i._video_added_&&i._videoSSRC)||this.pendingRemoteTracks.splice(r,1)}if(t)await or(this,rt.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:r,kind:i}of this.pendingRemoteTracks)await this.subscribe(r,i,i===ze.VIDEO?r._videoSSRC:r._audioSSRC);this.pendingRemoteTracks.forEach(r=>{let{user:i}=r;this.emit(rt.MediaReconnectEnd,i.uid)}),this.pendingRemoteTracks=[]}async unpublish(t){if(!this.connection||this.state!==Qt.Connected)return void t.forEach(a=>{const l=this.pendingLocalTracks.indexOf(a);l!==-1&&this.pendingLocalTracks.splice(l,1)});const r=this.filterTobeUnpublishedTracks(t);if(r.length===0)return;const i=r.find(a=>a[0]==="videoLowTrack");return i&&i[1].track.close(),this.doUnpublish(this.connection,r)}async unpublishDataChannel(t){if(!this.connection||this.state!==Qt.Connected)return void t.forEach(i=>{const a=this.pendingLocalDataChannels.indexOf(i);a!==-1&&this.pendingLocalDataChannels.splice(a,1)});const r=this.filterTobeUnpublishedDataChannels(t);return r.length!==0?(r.forEach(i=>{const a=this.localDataChannels.indexOf(i);a!==-1&&this.localDataChannels.splice(a,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),r.map(i=>i.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==Qt.Connected)return;const t=this.localTrackMap.get(Re.LocalVideoLowTrack);if(!t)return;t.track.close();const r=[[Re.LocalVideoLowTrack,t]];return this.doUnpublish(this.connection,r)}async doUnpublish(t,r){const i=this.createGatewayUnpublishMessage(r);return await t.stopSending(r.map(a=>{let[,{id:l}]=a;return l})),this.withdrawLocalTracks(r),this.unbindLocalTrackEvents(r.map(a=>{let[l,{track:u}]=a;return{type:l,track:u}})),r.forEach(a=>{let[l]=a;this.statsCollector.removeLocalStats(l)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),i}async subscribeDataChannel(t,r){if(!this.connection||this.state!==Qt.Connected)throw new ge(K.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const i=r.filter(a=>{var l;return!((l=this.remoteDataChannelMap.get(t))!==null&&l!==void 0&&l.get(a.id))});if(i.length!==0)return await this.connection.createDataChannels(t.uid,i),i.forEach(a=>{var l;this.remoteDataChannelMap.has(t)?(l=this.remoteDataChannelMap.get(t))===null||l===void 0||l.set(a.id,a):this.remoteDataChannelMap.set(t,new Map([[a.id,a]]));const u=this.pendingRemoteDataChannels.findIndex(p=>{let{user:m,id:g}=p;return m.uid===t.uid&&g===a.id});u!==-1&&this.pendingRemoteDataChannels.splice(u,1)}),i.map(a=>a.id)}async subscribe(t,r,i,a,l){var u;if(!this.connection||this.state!==Qt.Connected)throw new ge(K.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((u=this.remoteUserMap.get(t))!==null&&u!==void 0&&u.has(r))return;let p,m,g,y;const x=this.connection.getPreMedia(i);if(x)A.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(i,", no need to send sub to gateway.")),g=x.transceiver,p=x.track,m=x.mid,y=x.player,x.firstVideoRender&&this.store.firstVideoFrameDecoded(t.uid,{firstPreRender:x.firstVideoRender});else if(l){const C=l.find(j=>{let{stream_type:L}=j;return L===r});if(!C)throw new ge(K.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(r," for user: ").concat(t.uid," because subscribe answer from gateway does not contain stream_type: ").concat(r,"."));const V=await this.connection.receive(r,C.ssrcs,String(t._uintid),C.attributes);(this.connection instanceof Js||"name"in this.connection&&this.connection.name==="DataChannelConnection")&&(g=V.transceiver),p=V.track,m=V.id}else{const C=await this.connection.receive(r,[{ssrcId:i,rtx:a}],String(t._uintid),void 0);(this.connection instanceof Js||"name"in this.connection&&this.connection.name==="DataChannelConnection")&&(g=C.transceiver),p=C.track,m=C.id}if(r===ze.AUDIO?(t._audioTrack?t._audioTrack._updateOriginMediaStreamTrack(p):(t._audioTrack=new pm(p,t.uid,t._uintid,this.store),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(t._audioTrack.getTrackId()))),g&&t._audioTrack._updateRtpTransceiver(g),this.bindRemoteTrackEvents(t,t._audioTrack)):(t._videoTrack?t._videoTrack._updateOriginMediaStreamTrack(p):(t._videoTrack=new hm(p,t.uid,t._uintid,this.store,y),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(t._videoTrack.getTrackId())),t._videoTrack.once(va.PLAY_START,()=>{this.store.firstVideoFrameDecoded(t.uid,{playStart:Date.now()})}),t._videoTrack.once(va.PLAY_END,()=>{this.store.firstVideoFrameDecoded(t.uid,{playEnd:Date.now()}),this.reportVideoFirstFrameRender(t)}),y?t._videoTrack.once(va.FIRST_FRAME_RENDER,()=>{this.store.firstVideoFrameDecoded(t.uid,{firstRender:Date.now()}),this.reportVideoFirstFrameRender(t)}):t._videoTrack.once(va.FIRST_FRAME_DECODED,()=>{this.store.firstVideoFrameDecoded(t.uid,{firstRender:Date.now()}),this.reportVideoFirstFrameRender(t)})),g&&t._videoTrack._updateRtpTransceiver(g),this.bindRemoteTrackEvents(t,t._videoTrack)),g&&W("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:C,interceptRemoteAudioFrame:V}=k_();r==ze.VIDEO?await C(g.receiver,{onSei:W("ENABLE_VIDEO_SEI")&&(j=>{var L;return(L=t._videoTrack)===null||L===void 0?void 0:L._onSei(j)}),onFirstFrame:j=>{var L;const H=Array.from(mi(L=this.remoteUserMap).call(L)).find(Y=>Y._videoSSRC===j.ssrc);H&&this.store.firstVideoFrameDecoded(H.uid,{firstReceivedEncodedFrame:Date.now(),frameType:j.type,rtpTimestamp:j.rtpTimestamp,framePayloadType:j.payloadType,frameDataLength:j.length,mimeType:j.mimeType})}}):r==ze.AUDIO&&await V(g.receiver,{enableTopn:!!W("ENABLE_AUDIO_TOPN"),enableMetadata:!!W("ENABLE_AUDIO_METADATA"),enablePts:!!W("ENABLE_AUDIO_PTS"),onMetadata:j=>{this.safeEmit(rt.AudioMetadata,j)},onPts:j=>{this.safeEmit(rt.AudioPts,j)}})}const S=this.remoteUserMap.get(t);S?S.set(r,m):this.remoteUserMap.set(t,new Map([[r,m]])),this.statsCollector.addRemoteStats(t.uid),this.statsUploader.startUploadInboundStats();const T=this.pendingRemoteTracks.findIndex(C=>{let{user:V,kind:j}=C;return V.uid===t.uid&&r===j});T!==-1&&(this.pendingRemoteTracks.splice(T,1),this.emit(rt.MediaReconnectEnd,t.uid))}async massSubscribe(t){return this.massSubscribeNoLock(t)}async massSubscribeNoLock(t){if(!this.connection||this.state!==Qt.Connected)throw new ge(K.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");t=t.filter(l=>{var u;let{user:p,mediaType:m}=l;return!((u=this.remoteUserMap.get(p))!==null&&u!==void 0&&u.has(m))});const r=[],i=new Map;t.forEach(l=>{if(!this.connection)return;const u=this.connection.getPreMedia(l.ssrcId);if(u){const{track:p,mid:m,transceiver:g,player:y}=u;i.set(l.ssrcId,{track:p,id:m,transceiver:g,player:y})}else r.push(l)});const a=await this.connection.batchReceive(r.map(l=>{let{user:u,mediaType:p,ssrcId:m,rtxSsrcId:g}=l;return{kind:p,ssrcMsg:[{ssrcId:m,rtx:g}],mslabel:String(u._uintid)}}));r.forEach((l,u)=>{i.set(l.ssrcId,a[u])});for(const{user:l,mediaType:u,ssrcId:p}of t){const m=i.get(p);if(!m)return void A.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(l.uid," subscribe data,").concat(u,", ").concat(p));const{track:g,id:y,transceiver:x,player:S}=m;if(x&&W("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:V,interceptRemoteAudioFrame:j}=k_();u==ze.VIDEO?await V(x.receiver,{onSei:W("ENABLE_VIDEO_SEI")&&(L=>{var H;return(H=l._videoTrack)===null||H===void 0?void 0:H._onSei(L)}),onFirstFrame:L=>{var H;const Y=Array.from(mi(H=this.remoteUserMap).call(H)).find(te=>te._videoSSRC===L.ssrc);Y&&this.store.firstVideoFrameDecoded(Y.uid,{firstReceivedEncodedFrame:Date.now(),frameType:L.type,rtpTimestamp:L.rtpTimestamp,framePayloadType:L.payloadType,frameDataLength:L.length,mimeType:L.mimeType})}}):u==ze.AUDIO&&await j(x.receiver,{enableTopn:!!W("ENABLE_AUDIO_TOPN"),enableMetadata:!!W("ENABLE_AUDIO_METADATA"),enablePts:!!W("ENABLE_AUDIO_PTS"),onMetadata:L=>{this.safeEmit(rt.AudioMetadata,L)},onPts:L=>{this.safeEmit(rt.AudioPts,L)}})}if(u===ze.AUDIO?(l._audioTrack?l._audioTrack._updateOriginMediaStreamTrack(g):(l._audioTrack=new pm(g,l.uid,l._uintid,this.store),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(l._audioTrack.getTrackId()))),x&&l._audioTrack._updateRtpTransceiver(x),this.bindRemoteTrackEvents(l,l._audioTrack)):(l._videoTrack?l._videoTrack._updateOriginMediaStreamTrack(g):(l._videoTrack=new hm(g,l.uid,l._uintid,this.store,S),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(l._videoTrack.getTrackId()))),x&&l._videoTrack._updateRtpTransceiver(x),this.bindRemoteTrackEvents(l,l._videoTrack)),W("ENABLE_VIDEO_SEI")&&x){const{interceptRemoteVideoFrame:V,interceptRemoteAudioFrame:j}=k_();u==ze.VIDEO?await V(x.receiver,{onSei:L=>{var H;(H=l._videoTrack)===null||H===void 0||H._onSei(L)},onFirstFrame:L=>{var H;const Y=Array.from(mi(H=this.remoteUserMap).call(H)).find(te=>te._videoSSRC===L.ssrc);Y&&this.store.firstVideoFrameDecoded(Y.uid,{firstReceivedEncodedFrame:Date.now(),frameType:L.type,rtpTimestamp:L.rtpTimestamp,framePayloadType:L.payloadType,frameDataLength:L.length,mimeType:L.mimeType})}}):u==ze.AUDIO&&await j(x.receiver)}const T=this.remoteUserMap.get(l);T?T.set(u,y):this.remoteUserMap.set(l,new Map([[u,y]])),this.statsCollector.addRemoteStats(l.uid),this.statsUploader.startUploadInboundStats();const C=this.pendingRemoteTracks.findIndex(V=>{let{user:j,kind:L}=V;return j.uid===l.uid&&u===L});C!==-1&&(this.pendingRemoteTracks.splice(C,1),this.emit(rt.MediaReconnectEnd,l.uid))}}async unsubscribe(t,r,i){const a=this.pendingRemoteTracks.filter(p=>{let{user:m,kind:g}=p;return r!==void 0?m.uid===t.uid&&r===g:m.uid===t.uid});if(a.forEach(p=>{const m=this.pendingRemoteTracks.indexOf(p);this.pendingRemoteTracks.splice(m,1)}),this.connection&&this.state===Qt.Connected||i||a.forEach(p=>{let{kind:m}=p;var g;if(m===ze.AUDIO)(g=t._audioTrack)===null||g===void 0||g._destroy(),t._audioTrack=void 0;else if(m===ze.VIDEO){var y;(y=t._videoTrack)===null||y===void 0||y._destroy(),t._videoTrack=void 0}}),!this.connection||this.state!==Qt.Connected)return;const l=this.filterTobeUnSubscribedTracks(t,r);if(l.length===0)return;await this.connection.stopReceiving(l.map(p=>{let[,{id:m}]=p;return m}));const u=this.createUnsubscribeMessage(l);return this.withdrawRemoteTracks(l),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),l.forEach(p=>{let[m,{kind:g}]=p;var y,x;if(g===ze.VIDEO&&m._videoSSRC&&((y=this.connection)===null||y===void 0||y.setStatsRemoteVideoIsReady(m._videoSSRC,!1)),g===ze.VIDEO)this.unbindRemoteTrackEvents(m._videoTrack),i||((x=m._videoTrack)===null||x===void 0||x._destroy(),m._videoTrack=void 0);else if(g===ze.AUDIO){var S;this.unbindRemoteTrackEvents(m._audioTrack),!i&&((S=m._audioTrack)===null||S===void 0||S._destroy(),m._audioTrack=void 0)}}),u}async unsubscribeDataChannel(t,r){if(r.forEach(l=>{const u=this.pendingRemoteDataChannels.findIndex(p=>p.id===l.id);u!==-1&&this.pendingRemoteDataChannels.splice(u,1)}),!this.connection)return;const i=this.filterTobeUnSubscribedDataChannels(t,r);if(i.length===0)return;r.forEach(l=>{l._close()});const a=this.remoteDataChannelMap.get(t);return i.forEach(l=>{a&&a.delete(l.id)}),a&&a.size===0&&(this.remoteDataChannelMap.delete(t),await this.connection.stopDataChannels(t.uid)),i.map(l=>l.id)}async massUnsubscribe(t){return this.massUnsubscribeNoLock(t)}async massUnsubscribeNoLock(t){let r=[];for(const{user:l,mediaType:u}of t){const p=this.pendingRemoteTracks.filter(m=>{let{user:g,kind:y}=m;return u!==void 0?g.uid===l.uid&&u===y:g.uid===l.uid});p.forEach(m=>{const g=this.pendingRemoteTracks.indexOf(m);this.pendingRemoteTracks.splice(g,1)}),r=r.concat(p)}if(!this.connection||this.state!==Qt.Connected)return void r.forEach(l=>{let{user:u,kind:p}=l;var m;if(p===ze.AUDIO)(m=u._audioTrack)===null||m===void 0||m._destroy(),u._audioTrack=void 0;else if(p===ze.VIDEO){var g;(g=u._videoTrack)===null||g===void 0||g._destroy(),u._videoTrack=void 0}});const i=pa(t).call(t,(l,u)=>{let{user:p,mediaType:m}=u;const g=this.filterTobeUnSubscribedTracks(p,m);return l.concat(g)},[]);if(i.length===0)return;await this.connection.stopReceiving(i.map(l=>{let[,{id:u}]=l;return u}));const a=this.createUnsubscribeAllMessage(i);return this.withdrawRemoteTracks(i),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),i.forEach(l=>{let[u,{kind:p}]=l;var m,g;if(p===ze.VIDEO&&u._videoSSRC&&((m=this.connection)===null||m===void 0||m.setStatsRemoteVideoIsReady(u._videoSSRC,!1)),p===ze.VIDEO)this.unbindRemoteTrackEvents(u._videoTrack),(g=u._videoTrack)===null||g===void 0||g._destroy(),u._videoTrack=void 0;else if(p===ze.AUDIO){var y;this.unbindRemoteTrackEvents(u._audioTrack),(y=u._audioTrack)===null||y===void 0||y._destroy(),u._audioTrack=void 0}}),a}isPreSubScribe(t){return!this.connection||this.state!==Qt.Connected?!1:!!this.connection.getPreMedia(t)}async muteRemote(t,r){if(!this.connection)return;const i=this.remoteUserMap.get(t);if(!i)return void A.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(t.uid,"."));if(!i.get(r))return void A.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(t.uid," media type ").concat(r,"."));const a=r===ze.VIDEO?t._videoSSRC:t._audioSSRC;a!==void 0&&this.connection.setStatsRemoteVideoIsReady(a,!1)}async unmuteRemote(t,r){return this.unmuteRemoteNoLock(t,r)}async unmuteRemoteNoLock(t,r){if(!this.connection)return;const i=this.remoteUserMap.get(t);if(!i)return void A.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(t.uid,"."));i.get(r)||A.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(t.uid," media type ").concat(r,"."))}addAudioMetadata(t){const r=this.localTrackMap.get(Re.LocalAudioTrack),i=r&&r.track;i&&i.metadata.push(t)}getAllTracks(t){const r=this.localTrackMap.get(Re.LocalAudioTrack);if((r==null?void 0:r.track)instanceof pr){const i=r.track;return Array.from(this.localTrackMap.entries()).filter(a=>{let[l]=a;return l!==Re.LocalAudioTrack}).filter(a=>{let[l]=a;return!(t&&l===Re.LocalVideoLowTrack)}).map(a=>{let[,{track:l}]=a;return l}).concat(i.trackList)}return Array.from(this.localTrackMap.entries()).filter(i=>{let[a]=i;return!(t&&a===Re.LocalVideoLowTrack)}).map(i=>{let[,{track:a}]=i;return a})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(t,r,i,a,l){if(t){const p=this.localTrackMap.get(Re.LocalAudioTrack),m=a?this.localTrackMap.get(Re.LocalVideoLowTrack):this.localTrackMap.get(Re.LocalVideoTrack);Ye.publish(this.store.sessionId,{eventElapse:ai.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:r,audioName:p==null?void 0:p.track.getTrackLabel(),videoName:m==null?void 0:m.track.getTrackLabel(),screenshare:(m==null?void 0:m.track._hints.indexOf(Zt.SCREEN_TRACK))!==-1,audio:!!p,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}else{var u;i||(i=[]);const p=i.find(g=>g instanceof $n),m=a?(u=this.localTrackMap.get(Re.LocalVideoTrack))===null||u===void 0?void 0:u.track:i.find(g=>g instanceof pn);Ye.publish(this.store.sessionId,{eventElapse:ai.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:r,audioName:p==null?void 0:p.getTrackLabel(),videoName:m==null?void 0:m.getTrackLabel(),screenshare:(m==null?void 0:m._hints.indexOf(Zt.SCREEN_TRACK))!==-1,audio:!!p,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}}reportSubscribeEvent(t,r,i,a){const l=a===ze.VIDEO?i._videoSSRC:i._audioSSRC;l&&Ye.subscribe(this.store.sessionId,{succ:t,ec:r,video:a===ze.VIDEO,audio:a===ze.AUDIO,peerid:i.uid,subscribeRequestid:l,p2pid:this.store.p2pId,eventElapse:ai.measureFromSubscribeStart(this.store.clientId,l),preSsrc:this.isPreSubScribe(l)})}reset(){A.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new kr("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=M0(this.store),this.emit(rt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const t=this.localTrackMap.get(Re.LocalAudioTrack);if((t==null?void 0:t.track)instanceof pr){if(t.track.trackList.length>0){const r=t.track;t.track.trackList.forEach(i=>{r.removeAudioTrack(i)})}t.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=Qt.Disconnected}getStats(){var t;return(t=this.connection)===null||t===void 0?void 0:t.getStats()}getRemoteVideoIsReady(t){var r;return((r=this.connection)===null||r===void 0?void 0:r.getRemoteVideoIsReady(t))||!1}getLocalAudioVolume(){const t=this.localTrackMap.get(Re.LocalAudioTrack);if(t)return t.track.getVolumeLevel()}getLocalVideoSize(){const t=this.localTrackMap.get(Re.LocalVideoTrack);if(t)return{width:t.track.videoWidth||0,height:t.track.videoHeight||0}}getEncoderConfig(t){const r=this.localTrackMap.get(t);return r&&r.track instanceof pn||r&&r.track instanceof $n?r.track._encoderConfig:void 0}getLocalMedia(t){return this.localTrackMap.get(t)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(t,r){if(!t)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(t);return!!i&&(!r||i.has(r))}async hasRemoteMediaWithLock(t,r){if(!t)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(t);return!!i&&(!r||i.has(r))}getRemoteMedia(t){var r;const i=Array.from(mi(r=this.remoteUserMap).call(r)).find(a=>a.uid===t);return i?{audioTrack:i.audioTrack,audioSSRC:i._audioSSRC,videoTrack:i.videoTrack,videoSSRC:i._videoSSRC}:{}}getAudioLevels(){let t=Array.from(this.remoteUserMap.entries()).map(i=>{let[a]=i;return{uid:a.uid,level:a.audioTrack?100*a.audioTrack._source.getAccurateVolumeLevel():0}});const r=this.localTrackMap.get(Re.LocalAudioTrack);return r&&t.push({level:100*r.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),t=Ou(t).call(t,(i,a)=>i.level-a.level),t}async disconnectForReconnect(){this.connection&&(A.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=Qt.Reconnecting,W("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r]=t;var i;r._videoTrack&&r._videoTrack._player&&((i=r._videoTrack._player.getVideoElement())===null||i===void 0||i.pause(),r._videoTrack._player.isKeepLastFrame=!0,r._videoTrack._originMediaStreamTrack.stop())}),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=M0(this.store),this.emit(rt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(t=>{var r;let[i,{track:a}]=t;switch(i){case Re.LocalVideoTrack:Ce(r=a._hints).call(r,Zt.LOW_STREAM)?a.close():this.pendingLocalTracks.push(a);break;case Re.LocalAudioTrack:a instanceof pr?this.pendingLocalTracks=this.pendingLocalTracks.concat(a.trackList):this.pendingLocalTracks.push(a);case Re.LocalVideoLowTrack:}}),this.emit(rt.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r,i]=t;Array.from(mi(i).call(i)).forEach(a=>{this.setPendingRemoteMedia(r,a)}),this.emit(rt.MediaReconnectStart,r.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(t=>{this.pendingLocalDataChannels.push(t)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(t=>{let[r,i]=t;Array.from(mi(i).call(i)).forEach(a=>{this.setPendingRemoteDataChannel(r,a)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),A.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(t,r){for(const i of this.pendingRemoteDataChannels){const{user:a,id:l}=i;if((t instanceof wd?t.uid:t)===a.uid&&l===r)return!0}return!1}setPendingRemoteDataChannel(t,r){this.hasPendingRemoteDataChannel(t,r)||this.pendingRemoteDataChannels.push({user:t,id:r})}hasPendingRemoteMedia(t,r){for(const i of this.pendingRemoteTracks){const{user:a,kind:l}=i;if((t instanceof wd?t.uid:t)===a.uid&&r===l)return!0}return!1}setPendingRemoteMedia(t,r){this.hasPendingRemoteMedia(t,r)||this.pendingRemoteTracks.push({user:t,kind:r})}restartICE(t){var r=this;return $i(function*(){if(!r.connection||r.state!==Qt.Connected)return;const i=yield Nt(r.mutex.lock("From P2PChannel.restartICE"));let a;try{a=yield Nt(r.connection.restartICE(t));const u=yield Nt(a.next());if(u.done)return;const p=u.value,m=yield p;switch(H1(r.connection)&&r.reportPCStats(Date.now(),!1,r._pcStatsUploadType),t){case jr.UDP_TCP_RELAY:r._pcStatsUploadType=gl.UDP_TCP_RESTART;break;case jr.TCP_RELAY:r._pcStatsUploadType=gl.TCP_RESTART;break;case jr.RELAY:r._pcStatsUploadType=gl.RELAY_RESTART;break;default:r._pcStatsUploadType=gl.OLD_RESTART}r._isTryConnecting=!0,a.next(m)}catch(u){var l;(l=a)===null||l===void 0||l.throw(u)}finally{i()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const t=this.connection.getStats(),r=this.localTrackMap.get(Re.LocalVideoTrack),i=this.localTrackMap.get(Re.LocalAudioTrack),a=t.videoSend.find(C=>C.ssrc===(r==null?void 0:r.ssrcs[0].ssrcId)),l=t.audioSend.find(C=>C.ssrc===(i==null?void 0:i.ssrcs[0].ssrcId));if(!a||!l)return 1;const u=As(this,rt.NeedSignalRTT),p=a?a.rttMs:void 0,m=l?l.rttMs:void 0,g=p&&m?(p+m)/2:p||m,y=(g&&u?(g+u)/2:g||u)||0,x=100*t.sendPacketLossRate*.7/50+.3*y/1500,S=x<.17?1:x<.36?2:x<.59?3:x<.1?4:5,T=r==null?void 0:r.track;if(T&&T._encoderConfig&&T._hints.indexOf(Zt.SCREEN_TRACK)===-1){const C=T._encoderConfig.bitrateMax,V=t.bitrate.actualEncoded;if(C&&V){const j=(1e3*C-V)/(1e3*C);return y8[j<.15?0:j<.3?1:j<.45?2:j<.6?3:4][S]}}return S}getDownlinkNetworkQuality(){if(!this.connection)return 0;const t=this.connection.getStats();let r=0;return Array.from(this.remoteUserMap.entries()).forEach(i=>{let[a]=i;const l=a._audioSSRC,u=a._videoSSRC,p=t.audioRecv.find(V=>V.ssrc===l),m=t.videoRecv.find(V=>V.ssrc===u);if(!p&&!m)return void(r+=1);const g=As(this,rt.NeedSignalRTT),y=t.rtt,x=(y&&g?(y+g)/2:y||g)||0,S=p?p.jitterMs:void 0,T=t.recvPacketLossRate;let C=.7*T*100/50+.3*x/1500;S&&(C=.6*T*100/50+.2*x/1500+.2*S/400),r+=C<.1?1:C<.17?2:C<.36?3:C<.59?4:5}),this.remoteUserMap.size>0?Math.round(r/this.remoteUserMap.size):r}async muteLocalTrack(t){return new je((r,i)=>{this.handleMuteLocalTrack(t,r,i)})}async replaceTrack(t,r){var i;if(A.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(t.getTrackId(),"] to [").concat(r.getTrackId(),"]")),!this.connection||this.state!==Qt.Connected)return;const a=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:p}]=u;return t===p});if(!a)return;const l=a[0];if(t!==r&&(this.unbindLocalTrackEvents([{track:t,type:l}]),this.bindLocalTrackEvents([{track:r,type:l}]),a[1].track=r),await((i=this.connection)===null||i===void 0?void 0:i.replaceTrack(r,a[1].id)),this.isPlanB){const u=a[1];u.id=r._mediaStreamTrack.id,this.localTrackMap.set(l,u)}if(l===Re.LocalVideoTrack&&!W("DISABLE_DUAL_STREAM_USE_ENCODING")&&jt().supportDualStreamEncoding){const u=this.localTrackMap.get(Re.LocalVideoLowTrack);if(u){const p=t._mediaStreamTrack.clone();u.track._originMediaStreamTrack.stop(),u.track._mediaStreamTrack=p,u.track._originMediaStreamTrack=p,await new je((m,g)=>{this.handleReplaceTrack(u.track,m,g,!0)})}}}filterTobePublishedTracks(t,r,i){const a=[],l=this.getAllTracks();t=Zp(t=t.filter(g=>l.indexOf(g)===-1));let u,p=!1;const m=this.localTrackMap.get(Re.LocalAudioTrack);for(const g of t){if(g instanceof pn&&(this.localTrackMap.has(Re.LocalVideoTrack)||p?new ge(K.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(a.push({track:g,type:Re.LocalVideoTrack}),p=!0),r)){const y=this.getLowVideoTrack(g,i);a.push({track:y,type:Re.LocalVideoLowTrack})}if(g instanceof $n)if(m){const y=m.track;if(y instanceof pr)$1([g]),y.addAudioTrack(g),this.bindLocalAudioTrackEvents(g,!0);else{const x=z1([y,g]);A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(x.getTrackId(),"]")),this.replaceTrack(y,x)}}else u instanceof pr?($1([g]),u.addAudioTrack(g)):u||!g._useAudioElement&&jt().webAudioMediaStreamDest&&!g._bypassWebAudio?u=z1(u?[g,u]:[g]):u=g}return u&&(A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(u.getTrackId(),"]")),a.push({track:u,type:Re.LocalAudioTrack})),a}filterTobeUnpublishedTracks(t){const r=[],i=this.getAllTracks();t=Zp(t=t.filter(a=>i.indexOf(a)!==-1));for(const a of t){if(a instanceof $n){const l=this.localTrackMap.get(Re.LocalAudioTrack);if(!l)continue;l.track instanceof pr?(l.track.removeAudioTrack(a),this.unbindLocalAudioTrackEvents(a),l.track.trackList.length===0&&(r.push([Re.LocalAudioTrack,l]),l.track.close())):r.push([Re.LocalAudioTrack,l])}if(a instanceof pn){const l=this.localTrackMap.get(Re.LocalVideoTrack);if(!l)continue;r.push([Re.LocalVideoTrack,l]);const u=this.localTrackMap.get(Re.LocalVideoLowTrack);u&&r.push([Re.LocalVideoLowTrack,u])}}return r}filterTobePublishedDataChannels(t){return t=(t=Zp(t)).filter(r=>this.localDataChannels.findIndex(i=>i.id===r.id)===-1)}filterTobeUnpublishedDataChannels(t){return t=(t=(t=Zp(t)).filter(r=>this.localDataChannels.indexOf(r)!==-1)).filter(r=>r._originDataChannel)}bindLocalTrackEvents(t){t.forEach(r=>{let{track:i,type:a}=r;switch(a){case Re.LocalVideoTrack:i.addListener(qe.GET_STATS,this.handleGetLocalVideoStats),i.addListener(qe.GET_RTC_STATS,this.handleGetRTCStats),i.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.addListener(qe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),i.addListener(qe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),i.addListener(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),i.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Re.LocalAudioTrack:this.bindLocalAudioTrackEvents(i);case Re.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(t,r){t instanceof pr?t.trackList.forEach(i=>{i.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.addListener(qe.GET_STATS,this.handleGetLocalAudioStats),i.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.addListener(qe.GET_STATS,this.handleGetLocalAudioStats),t.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),r||(t.addListener(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.addListener(qe.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(t){t||(t=Array.from(this.localTrackMap.entries()).map(r=>{let[i,{track:a}]=r;return{track:a,type:i}})),t.forEach(r=>{let{track:i,type:a}=r;switch(a){case Re.LocalVideoTrack:i.off(qe.GET_STATS,this.handleGetLocalVideoStats),i.off(qe.GET_RTC_STATS,this.handleGetRTCStats),i.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.off(qe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),i.off(qe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),i.off(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),i.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Re.LocalAudioTrack:this.unbindLocalAudioTrackEvents(i);case Re.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(t){t instanceof pr?t.trackList.forEach(r=>{r.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(qe.GET_STATS,this.handleGetLocalAudioStats),r.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.off(qe.GET_STATS,this.handleGetLocalAudioStats),t.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(qe.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),t.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(t,r){r instanceof hm&&r.addListener(qe.GET_STATS,i=>{i(this.handleGetRemoteVideoStats(t))}),r instanceof pm&&r.addListener(qe.GET_STATS,i=>{i(this.handleGetRemoteAudioStats(t))})}unbindRemoteTrackEvents(t){t&&t.removeAllListeners(qe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r,i]=t;i.has(ze.AUDIO)&&this.unbindRemoteTrackEvents(r._audioTrack),i.has(ze.VIDEO)&&this.unbindRemoteTrackEvents(r._videoTrack)})}createGatewayPublishMessage(t,r){return t.map((i,a)=>{var l;let u,p,{track:m,type:g}=i;switch(g){case Re.LocalAudioTrack:u=rn.Audio,p={dtx:m instanceof T0&&m._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Re.LocalVideoTrack:u=Ce(l=m._hints).call(l,Zt.SCREEN_TRACK)?rn.Screen:rn.High,p=kc(kc({},k8(m)),{},{codec:this.store.codec,svc_mode:A0()});break;case Re.LocalVideoLowTrack:u=rn.Low,p=kc(kc({},k8(m)),{},{codec:this.store.codec,svc_mode:A0()})}return{stream_type:u,attributes:p,ssrcs:r[a]}})}createGatewayUnpublishMessage(t){return t.map(r=>{var i;let a,[l,{track:u,ssrcs:p,id:m}]=r;switch(l){case Re.LocalVideoTrack:a=Ce(i=u._hints).call(i,Zt.SCREEN_TRACK)?rn.Screen:rn.High;break;case Re.LocalAudioTrack:a=rn.Audio;break;case Re.LocalVideoLowTrack:a=rn.Low}return{stream_type:a,ssrcs:p,mid:m}})}assignLocalTracks(t,r){t.forEach((i,a)=>{let{track:l,type:u}=i;this.localTrackMap.set(u,{track:l,id:r[a].id,ssrcs:r[a].localSSRC})})}withdrawLocalTracks(t){t.forEach(r=>{let[i]=r;this.localTrackMap.delete(i)})}bindConnectionEvents(t){t.onConnectionStateChange=async r=>{if(A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(r,")")),this.emit(rt.PeerConnectionStateChange,r),r==="connecting"&&t instanceof Js&&!wn()&&W("FIRST_TCP_CANDIDATE")&&window.setTimeout(()=>{r==="connecting"&&t.extendCandidate()},W("FIRST_TCP_CANDIDATE_INTERVAL")),r!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),r==="connected"&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),t instanceof Js&&AG(t,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=gl.DISCONNECTED_OR_FAILED,As(this,rt.QueryClientConnectionState)==="CONNECTED"&&this._isWaitPcToRePub)){const i=this.pendingLocalTracks.map(l=>l.getTrackId()),a=this.pendingLocalDataChannels.map(l=>"dc_".concat(l.id));Ye.reportApiInvoke(this.store.sessionId,{name:Cn.REPUB_AFTER_PC_CONNECTED,options:i.concat(a),tag:hn.TRACER}).onSuccess(),this.republish()}if(W("NEW_ICE_RESTART")&&t instanceof Js&&!wn()&&!this._forceTurn&&!this.store.useDcSignal){if(Ce(C8).call(C8,r)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const i=l=>{H1(t)&&(A.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(l)),As(this,rt.QueryClientConnectionState)==="CONNECTED"&&this.emit(rt.RequestRestartICE,l))},a=()=>{H1(t)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),A.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(rt.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout(()=>{IG(t,i,a)},800))}}else{if(r==="disconnected"&&t.iceConnectionState==="disconnected")return setTimeout(()=>{t.iceConnectionState==="disconnected"&&W("ICE_RESTART")&&As(this,rt.QueryClientConnectionState)==="CONNECTED"&&this.emit(rt.RequestRestartICE)},800),void setTimeout(()=>{t.peerConnectionState==="disconnected"&&(A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout(()=>this.emit(rt.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);r==="failed"&&(A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout(()=>this.emit(rt.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},t.onICEConnectionStateChange=r=>{r!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(r,")")),Ye.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:r,tag:hn.TRACER}).onSuccess(),this.emit(rt.IceConnectionStateChange,r)},t.onICETransportStateChange=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(r,")"))},t.onDTLSTransportStateChange=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(r,")"))},t.onDTLSTransportError=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(r,")"))},t.onFirstAudioDecoded=r=>{var i;const a=Array.from(mi(i=this.remoteUserMap).call(i)).find(u=>u._audioSSRC===r);var l;a&&(this.store.subscribe(a.uid,"audio",void 0,void 0,void 0,Date.now()),(l=a.audioTrack)===null||l===void 0||l.emit(va.FIRST_FRAME_DECODED),Ye.firstRemoteFrame(this.store.sessionId,hr.FIRST_AUDIO_DECODE,Rn.FIRST_AUDIO_DECODE,{peer:a._uintid,subscribeElapse:ai.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId}))},t.onFirstAudioReceived=r=>{var i;const a=Array.from(mi(i=this.remoteUserMap).call(i)).find(l=>l._audioSSRC===r);a&&Ye.firstRemoteFrame(this.store.sessionId,hr.FIRST_AUDIO_RECEIVED,Rn.FIRST_AUDIO_RECEIVED,{peer:a._uintid,subscribeElapse:ai.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},t.onFirstVideoDecoded=(r,i,a)=>{var l;const u=Array.from(mi(l=this.remoteUserMap).call(l)).find(p=>p._videoSSRC===r);u&&this.store.firstVideoFrameDecoded(u.uid,{firstDecoded:Date.now()}),this.reportVideoFirstFrameDecoded(r,i,a)},t.onFirstVideoRender=r=>{var i;const a=Array.from(mi(i=this.remoteUserMap).call(i)).find(l=>l._videoSSRC===r);a&&(this.store.firstVideoFrameDecoded(a.uid,{firstPreRender:Date.now()}),this.reportVideoFirstFrameRender(a),this.emit(rt.FirstVideoPreRender,a.uid,r))},t.onFirstVideoReceived=r=>{var i;const a=Array.from(mi(i=this.remoteUserMap).call(i)).find(l=>l._videoSSRC===r);a&&(this.store.firstVideoFrameDecoded(a.uid,{firstReceived:Date.now()}),Ye.firstRemoteFrame(this.store.sessionId,hr.FIRST_VIDEO_RECEIVED,Rn.FIRST_VIDEO_RECEIVED,{peer:a._uintid,subscribeElapse:ai.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId}))},t.onFirstVideoBufferReady=r=>{var i;const a=Array.from(mi(i=this.remoteUserMap).call(i)).find(l=>l._videoSSRC===r);a&&this.emit(rt.FirstVideoBufferReady,a.uid,r)},t.onSelectedLocalCandidateChanged=(r,i)=>{const a=r.candidateType==="relay",l=i.candidateType==="relay";i.candidateType!=="unknown"&&a===l||this.emit(rt.ConnectionTypeChange,a),A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(_d(i))," -> ").concat(JSON.stringify(_d(r)),")"))},t.onSelectedRemoteCandidateChanged=(r,i)=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(_d(i))," -> ").concat(JSON.stringify(_d(r)),")"))},t.onFirstVideoDecodedTimeout=r=>{this.reportVideoFirstFrameDecoded(r,void 0,void 0,!0)},t.getLocalVideoStats=()=>{const r=this.statsCollector.getLocalVideoTrackStats(),i=this.statsCollector.getRTCStats();return kc(kc({},r),i)},t.onICECandidateError=r=>{this._iceError=r}}fallbackConnection(){A.debug("[".concat(this.store.clientId,"] [P2PChannel] try to fallback connection")),this.state===Qt.Connected?(A.debug("[".concat(this.store.clientId,"] [P2PChannel] fallback to websocket but P2PChannel state still connected, disconnect first")),this.disconnectForReconnect()):(this.connection&&this.resetConnection(this.connection),this.shouldForwardP2PCreation&&(this.connection=M0(this.store),this.emit(rt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)))}resetConnection(t){t instanceof Js&&function(r){Cm.delete(r.id),AG(r)}(t),t.close(),this.emit(rt.PeerConnectionStateChange,"closed"),function(r){r.onConnectionStateChange=void 0,r.onICEConnectionStateChange=void 0,r.onICETransportStateChange=void 0,r.onDTLSTransportStateChange=void 0,r.onDTLSTransportError=void 0,r.onFirstAudioDecoded=void 0,r.onFirstAudioReceived=void 0,r.onFirstVideoDecoded=void 0,r.onFirstVideoReceived=void 0,r.onSelectedLocalCandidateChanged=void 0,r.onSelectedRemoteCandidateChanged=void 0,r.onFirstVideoDecodedTimeout=void 0,r.getLocalVideoStats=void 0}(t),this._isWaitPcToRePub=!1}filterTobeMutedTracks(t){const r=[];if(this.getAllTracks().indexOf(t)===-1)return r;const i=this.localTrackMap.get(Re.LocalAudioTrack);if(t instanceof $n&&(i==null?void 0:i.track)instanceof pr)return i.track.isActive||r.push([Re.LocalAudioTrack,i]),r;const a=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:u}]=l;return t===u});if(a&&(r.push(a),a[0]===Re.LocalVideoTrack)){const l=this.localTrackMap.get(Re.LocalVideoLowTrack);l&&r.push([Re.LocalVideoLowTrack,l])}return r}filterTobeUnmutedTracks(t){const r=[],i=this.localTrackMap.get(Re.LocalAudioTrack);if(t instanceof $n&&(i==null?void 0:i.track)instanceof pr)return i.track.isActive&&r.push([Re.LocalAudioTrack,i]),r;const a=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:u}]=l;return t===u});if(a)if(a[0]===Re.LocalVideoTrack){r.push(a);const l=this.localTrackMap.get(Re.LocalVideoLowTrack);l&&r.push([Re.LocalVideoLowTrack,l])}else r.push(a);return r}createMuteMessage(t){return t.map(r=>{var i;let a,[l,{track:u,ssrcs:p,id:m}]=r;switch(l){case Re.LocalAudioTrack:a=rn.Audio;break;case Re.LocalVideoTrack:a=Ce(i=u._hints).call(i,Zt.SCREEN_TRACK)?rn.Screen:rn.High;break;case Re.LocalVideoLowTrack:a=rn.Low}return{stream_type:a,ssrcs:p,mid:m}})}createUnmuteMessage(t){return t.map(r=>{var i;let a,[l,{track:u,ssrcs:p,id:m}]=r;switch(l){case Re.LocalAudioTrack:a=rn.Audio;break;case Re.LocalVideoTrack:a=Ce(i=u._hints).call(i,Zt.SCREEN_TRACK)?rn.Screen:rn.High;break;case Re.LocalVideoLowTrack:a=rn.Low}return{stream_type:a,ssrcs:p,mid:m}})}filterTobeUnSubscribedTracks(t,r){const i=[],a=this.remoteUserMap.get(t);if(!a)return i;if(r){const l=a.get(r);if(!l)return i;i.push([t,{kind:r,id:l}])}else Array.from(a.entries()).forEach(l=>{let[u,p]=l;i.push([t,{kind:u,id:p}])});return i}filterTobeUnSubscribedDataChannels(t,r){const i=[];return r.forEach(a=>{var l;(l=this.remoteDataChannelMap.get(t))!==null&&l!==void 0&&l.has(a.id)&&i.push(a)}),i}createUnsubscribeMessage(t){const r=[];return t.forEach(i=>{let[a,{kind:l,id:u}]=i;switch(l){case ze.VIDEO:return void(a._videoSSRC&&r.push({stream_type:ze.VIDEO,ssrcId:a._videoSSRC}));case ze.AUDIO:return void(a._audioSSRC&&r.push({stream_type:ze.AUDIO,ssrcId:a._audioSSRC}))}}),r}createUnsubscribeAllMessage(t){const r=new Map;return t.forEach(i=>{let[a,{kind:l}]=i;if(r.has(a)){let u=r.get(a);l===ze.VIDEO?u|=Sr.Video:u|=Sr.Audio,r.set(a,u)}else l===ze.VIDEO?r.set(a,Sr.Video):r.set(a,Sr.Audio)}),{users:Array.from(r.entries()).map(i=>{let[a,l]=i;return{stream_id:a.uid,stream_type:l}})}}withdrawRemoteTracks(t){t.forEach(r=>{let[i,{kind:a}]=r;const l=this.remoteUserMap.get(i);l&&(l.delete(a),Array.from(l.entries()).length===0&&this.remoteUserMap.delete(i))})}async updateBitrateLimit(t){const r=this.localTrackMap.get(Re.LocalVideoTrack),i=this.localTrackMap.get(Re.LocalVideoLowTrack);r&&(await r.track.setBitrateLimit(t.uplink),await new je((a,l)=>{this.handleUpdateVideoEncoder(r.track,a,l,!0)})),i&&t.low_stream_uplink&&(await i.track.setBitrateLimit({max_bitrate:t.low_stream_uplink.bitrate,min_bitrate:t.low_stream_uplink.bitrate||0}),await new je((a,l)=>{this.handleUpdateVideoEncoder(i.track,a,l,!0)}))}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}isPreallocation(){return!(!this.connection||!("name"in this.connection)||this.connection.name!=="DataChannelConnection"||this.connection.peerConnectionState==="closed")||this.connection instanceof Js&&this.connection.isPreallocation}isPreSub(){return(this.connection&&"name"in this.connection&&this.connection.name==="DataChannelConnection"&&this.connection.peerConnectionState!=="closed"||this.connection instanceof Js)&&this.connection.isPreSub()}isPreRender(){return this.connection instanceof Js&&this.connection.isPreRender}mapPubResToRemoteConfig(t,r,i){return t.map((a,l)=>{var u;let{stream_type:p}=a;const m=(u=r.find(g=>{let{stream_type:y}=g;return p===y}))===null||u===void 0?void 0:u.attributes;if(m&&W("DISABLE_SCREEN_SHARE_REMB")){const g=i[l]._hints;(Ce(g).call(g,Zt.SCREEN_TRACK)||Ce(g).call(g,Zt.SCREEN_LOW_TRACK))&&(m.remb=!1,A.debug("disable remb for screen share, hints:",g))}return m})}async tryToUnmuteAudio(t){for(let i=0;i<t.length;i++)if(t[i]instanceof $n){var r;const a=this.filterTobeUnmutedTracks(t[i]);if(a.length===0)continue;await((r=this.connection)===null||r===void 0?void 0:r.unmuteLocal(a.map(u=>{let[,{id:p}]=u;return p})));const l=this.createUnmuteMessage(a);return void await gn(this,rt.RequestUnmuteLocal,l)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=t=>{var r;return!((r=this.connection)===null||r===void 0||!r.getRemoteVideoIsReady(t))},this.statsUploader.requestUpload=(t,r)=>this.emit(rt.RequestUpload,t,r),this.statsUploader.requestUploadStats=t=>this.emit(rt.RequestUploadStats,t),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var t;return{connectState:((t=this.connection)===null||t===void 0?void 0:t.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Er(qx(this.dtlsFailedCount,er)),this.emit(rt.RequestReconnect)}async reconnectP2P(){const t=Array.from(this.localTrackMap.entries()),r=this.createGatewayUnpublishMessage(t);Array.from(this.remoteUserMap.entries()),r.length>0&&await or(this,rt.RequestUnpublishForReconnectPC,r),this.disconnectForReconnect(),this.emit(rt.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(Re.LocalVideoTrack)||this.pendingLocalTracks.some(t=>t instanceof pn)}throwIfTrackTypeNotMatch(t){if(t.filter(r=>r instanceof pn).length>1)throw new ge(K.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t.filter(r=>r instanceof $n).length>1&&(t.some(r=>r instanceof $n&&r._bypassWebAudio)||!jt().webAudioMediaStreamDest))throw new ge(K.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const r of t){if(r instanceof pn&&this.pendingLocalTracks.some(i=>i instanceof pn))throw new ge(K.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r instanceof $n&&this.pendingLocalTracks.some(i=>i instanceof $n)&&(!jt().webAudioMediaStreamDest||r._bypassWebAudio||this.pendingLocalTracks.some(i=>i instanceof $n&&i._bypassWebAudio)))throw new ge(K.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(t,r){var i;const a=!W("DISABLE_DUAL_STREAM_USE_ENCODING")&&jt().supportDualStreamEncoding,l=kc(kc({},{width:160,height:120,framerate:15,bitrate:50}),r);let u;u=a?t._mediaStreamTrack.clone():Y1(t,l);const p=tn(8,"track-low-"),m=new pn(u,kc(kc({},a&&{scaleResolutionDownBy:S1(l,t)}),{},{frameRate:l.framerate,bitrateMax:l.bitrate,bitrateMin:l.bitrate}),void 0,void 0,p);return m.on(Xu.TRANSCEIVER_UPDATED,g=>{t._updateRtpTransceiver(g,am.LOW_STREAM)}),m._hints.push(Zt.LOW_STREAM),Ce(i=t._hints).call(i,Zt.SCREEN_TRACK)&&m._hints.push(Zt.SCREEN_LOW_TRACK),t.on("sei-to-send",g=>{m.emit("sei-to-send",g)}),t.addListener(qe.NEED_CLOSE,()=>{m.close()}),m}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(t,r,i){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof Js){var l,u,p,m;const g=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:y,dtlsTransportState:x,peerConnectionState:S}=this.connection,{local:T,remote:C}=await this.connection.getSelectedCandidatePair();Ye.pcStats(this.store.sessionId,{startTime:g,eventElapse:t-g||0,iceconnectionsate:y,dtlsstate:x,connectionstate:S,intSucc:r?1:2,error:this._iceError||a||"",selectedLocalCandidateProtocol:(l=T==null?void 0:T.protocol)!==null&&l!==void 0?l:"",selectedLocalCandidateType:(u=T.candidateType)!==null&&u!==void 0?u:"",selectedLocalCandidateAddress:"".concat(T.address,":").concat(T.port),selectedRemoteCandidateProtocol:(p=C.protocol)!==null&&p!==void 0?p:"",selectedRemoteCandidateType:(m=C.candidateType)!==null&&m!==void 0?m:"",selectedRemoteCandidateAddress:"".concat(C.address,":").concat(C.port),restartCnt:i,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameRender(t){const r=this.store.keyMetrics,i=r.firstVideoFrameDecoded.find(x=>x.userId===t.uid);if(!i)return;const{isInternalUpload:a,isExternalUpload:l}=i;if(a&&l)return;const{subscribeEnd:u,firstPreRender:p,peerPublishDuration:m,peerPubStatusMs:g}=i;let{firstRender:y=0}=i;if(u&&(y||p)&&m&&g){i.isInternalUpload=!0;const{playEnd:x}=i;x&&(i.isExternalUpload=!0);const{firstPreRender:S=0}=i;y=S||y;const T=t.videoTrack,C={peer:t._uintid,width:(T==null?void 0:T._videoWidth)||0,height:(T==null?void 0:T._videoHeight)||0,ssrc:t._videoSSRC||0,p2pid:this.store.p2pId,peerPublishDuration:m,peerPubStatusMs:g,joinChannelStart:r.joinStart||0,preloadStart:r.preloadStart||0,preloadEnd:r.preloadEnd||0,apStart:r.requestAPStart||0,apEnd:r.requestAPEnd||0,suaEnd:r.requestSUAEnd||0,beforeConnect:r.beforeConnect||0,peerReceiver:r.peerReceiver||0,ice:r.iceConnectionEnd||0,pc:r.peerConnectionEnd||0,signalConnected:r.signalConnected||0,joinReq:r.joinReq||0,joinRes:r.joinRep||0,userJoinNotify:i.userJoinNotify||0,videoAddNotify:i.videoAddNotify||0,subscribeStart:i.subscribeStart||0,subscribeEnd:i.subscribeEnd||0,firstReceived:i.firstReceived||0,firstDecoded:i.firstDecoded||0,firstPreRender:S||0,firstRender:x?Math.max(y,x):Math.max(y,u),playStart:i.playStart||0,playEnd:i.playEnd||0,isPreSub:!(!t._videoSSRC||!this.isPreSubScribe(t._videoSSRC)),isPrePc:this.isPreallocation(),isPreInstantVideo:ZV(this.store),firstReceivedEncodedFrame:i.firstReceivedEncodedFrame||0,frameType:i.frameType||"",rtpTimestamp:i.rtpTimestamp||0,framePayloadType:i.framePayloadType||0,frameDataLength:i.frameDataLength||0,mimeType:i.mimeType||""};Ye.firstXLAPeerFirstVideoFrame(this.store.sessionId,C)}}reportVideoFirstFrameDecoded(t,r,i,a){var l;const u=Array.from(mi(l=this.remoteUserMap).call(l)).find(p=>p._videoSSRC===t);if(u){a||this.store.subscribe(u.uid,"video",void 0,void 0,void 0,void 0,Date.now());const p=this.store.keyMetrics,m=p.subscribe.find(g=>g.userId===u.uid&&g.type==="video");Ye.firstRemoteVideoDecode(this.store.sessionId,hr.FIRST_VIDEO_DECODE,Rn.FIRST_VIDEO_DECODE,{peer:u._uintid,videowidth:r,videoheight:i,subscribeElapse:ai.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId,apEnd:p.requestAPEnd||0,apStart:p.requestAPStart||0,joinGwEnd:p.joinGatewayEnd||0,joinGwStart:p.joinGatewayStart||0,pcEnd:p.peerConnectionEnd||0,pcStart:p.peerConnectionStart||0,subscriberEnd:(m==null?void 0:m.subscribeEnd)||0,subscriberStart:(m==null?void 0:m.subscribeStart)||0,videoAddNotify:(m==null?void 0:m.streamAdded)||0,state:a?1:0,firstFrame:(m==null?void 0:m.firstFrame)||0})}}async remoteMediaSsrcChanged(t,r,i){if(!this.connection)return!1;const a=this.remoteUserMap.get(t);if(!a)return!1;const l=a.get(r);if(!l)return!1;const u=await this.connection.getRemoteSSRC(l);return u!==void 0&&u!==i}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(t=>{let[r,{track:i}]=t;r===Re.LocalVideoLowTrack?i._updateRtpTransceiver(void 0,am.LOW_STREAM):i._updateRtpTransceiver(void 0)})}},Le(Lt.prototype,"startP2PConnection",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"startP2PConnection"),Lt.prototype),Le(Lt.prototype,"connect",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"connect"),Lt.prototype),Le(Lt.prototype,"updateRemoteRTPCapabilities",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"updateRemoteRTPCapabilities"),Lt.prototype),Le(Lt.prototype,"publishDataChannel",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"publishDataChannel"),Lt.prototype),Le(Lt.prototype,"unpublish",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"unpublish"),Lt.prototype),Le(Lt.prototype,"unpublishDataChannel",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"unpublishDataChannel"),Lt.prototype),Le(Lt.prototype,"unpublishLowStream",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"unpublishLowStream"),Lt.prototype),Le(Lt.prototype,"subscribeDataChannel",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"subscribeDataChannel"),Lt.prototype),Le(Lt.prototype,"subscribe",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"subscribe"),Lt.prototype),Le(Lt.prototype,"massSubscribe",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"massSubscribe"),Lt.prototype),Le(Lt.prototype,"unsubscribe",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"unsubscribe"),Lt.prototype),Le(Lt.prototype,"unsubscribeDataChannel",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"unsubscribeDataChannel"),Lt.prototype),Le(Lt.prototype,"massUnsubscribe",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"massUnsubscribe"),Lt.prototype),Le(Lt.prototype,"muteRemote",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"muteRemote"),Lt.prototype),Le(Lt.prototype,"unmuteRemote",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"unmuteRemote"),Lt.prototype),Le(Lt.prototype,"hasRemoteMediaWithLock",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"hasRemoteMediaWithLock"),Lt.prototype),Le(Lt.prototype,"disconnectForReconnect",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"disconnectForReconnect"),Lt.prototype),Le(Lt.prototype,"updateBitrateLimit",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"updateBitrateLimit"),Lt.prototype),Le(Lt.prototype,"remoteMediaSsrcChanged",[bi],Object.getOwnPropertyDescriptor(Lt.prototype,"remoteMediaSsrcChanged"),Lt.prototype),Lt);function bi(t,r,i){const a=t[r];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){const l=this.mutex,u=await l.lock("From P2PChannel.".concat(r));try{for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];return await a.apply(this,m)}finally{u()}},i}function kG(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function jG(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?kG(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):kG(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}const Hve=Date.now(),Kve=20,J1=new Map,z_=new Map;async function DG(t){const r=J1.get(t),i=Array.isArray(r)&&r[r.length-1],a=z_.get(t);if(!i)return void(a.isSyncing=!1);const l={uid:i.uid,payload:i.payload};a.firstRecvTs===0&&(a.firstRecvTs=i.recvTs,a.firstSendTs=i.sendTs);const u=i.sendTs-a.firstSendTs,p=u-(Date.now()-a.firstRecvTs);p>0&&(a.firstRecvTs=Date.now()-u);let m=i.mediaDelay+p;m<=0?(r.pop(),LG(i.context,l),m=0):m=Math.min(m,Kve),setTimeout(()=>r.length&&DG(t),m)}function LG(t,r){t.safeEmit(Ot.STREAM_MESSAGE,r.uid,r.payload),t.onStreamMessage&&t.onStreamMessage(r)}function Yve(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(!t.syncWithAudio)return LG(i,{uid:t.uid,payload:t.payload});const a="".concat(i.id,"-").concat(t.uid),l=J1.get(a)||[],u=l.findIndex(y=>t.sendTs>=y.sendTs),p=jG(jG({},t),{},{context:i,mediaDelay:r,recvTs:Date.now()});u===-1?l.push(p):l.splice(u,0,p),J1.set(a,l);let m=!1;var g;z_.has(a)?m=!((g=z_.get(a))===null||g===void 0||!g.isSyncing):z_.set(a,{isSyncing:m,firstRecvTs:0,firstSendTs:0}),m||DG(a)}const qve=Ht().name;function MG(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function UG(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?MG(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):MG(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}const Rm="websdk_ng_cache_parameter",Xve=W("MAX_PRELOAD_ASYNC_LENGTH"),Jve=1e4,lh=new Map,dh=[];let Q1=null,Z1=0,eI=0;const H_=new Map,FG=new Uint8Array([241,141,127,212,103,139,200,225,251,157,127,139,143,2,22,163]),Qve=function(t,r){const i=[];let a=0;const l=async()=>{const u=i.shift();u&&await u(),i.length>0&&a<r?l():a--};return async function(){for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return new je(async(g,y)=>{i.push(async()=>{try{const x=await t(...p);g(x)}catch(x){y(x)}}),a<r&&(a++,l())})}}(nI,Xve),tI=zi.CancelToken.source();class Zve{constructor(){F(this,"_audioContext",null)}createMuteAudioTrack(){this._audioContext=new AudioContext;const r=this._audioContext.sampleRate,i=10*r,a=this._audioContext.createBuffer(2,i,r),l=this._audioContext.createBufferSource();l.buffer=a;const u=this._audioContext.createMediaStreamDestination();return l.connect(u),l.start(),u.stream.getAudioTracks()[0]}close(){this._audioContext&&(this._audioContext.close(),this._audioContext=null)}}async function nI(t,r,i,a,l,u,p){try{if(!W("ENABLE_PRELOAD"))return;if(!jt().supportWebCrypto)return void fd(()=>{A.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!i&&i!==null)throw new ge(K.INVALID_PARAMS,"Invalid token: ".concat(i,". If you don not use token, set it to null"));i&&Wr(i,"token",1,2047),Wr(t,"appid",1,2047),__(r),a&&E_(a);const m=Hu();A.debug("preload channel ".concat(r,", uid is ").concat(a));const g={appId:t,cname:r,token:i||t,uid:typeof a!="string"?a:null,sid:m,proxyServer:l,role:p};let y,x;typeof a=="string"?(g.stringUid=a,[x,y]=await je.all([jve(a,{sid:m,appId:t},tI.token),lG(UG(UG({},g),{},{token:i||t,uid:0}),tI.token)]),g.uid=x.uid,y.gatewayInfo.uid=g.uid,y.gatewayInfo.res.uid=g.uid):(u&&(g.stringUid=u),y=await lG(g,tI.token));const S={sid:m,appId:t,cname:r,token:i||t,uid:g.stringUid||a,intUid:g.uid||y.gatewayInfo.uid,stringUid:g.stringUid,ts:Date.now(),sua:x,ap:y};await iI(S),Z1++}catch(m){throw eI++,function(g){Q1||(Q1=window.setTimeout(()=>{let x="";H_.forEach((S,T)=>{x+="".concat(T,": ").concat(S," ;")}),Ye.reportApiInvoke(null,{name:Cn.PRELOAD,options:{success:Z1,failed:eI,err:x}}).onError(g),Z1=0,eI=0,H_.clear(),Q1=null},Jve));const y=H_.get(g.code)||0;H_.set(g.code,y+1)}(m),m}}async function rI(t){try{if(W("AP_REQUEST_DETAIL")||W("ENABLE_ROLE_SELECT_EDGE"))return;const r=VG(t);if(!r||t.cloudProxyServer!=="disabled")return;const i=await async function(a,l){try{const u=await window.crypto.subtle.importKey("raw",CV(l),"AES-GCM",!1,["decrypt"]),p=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:FG},u,zu(a));return JSON.parse(window.atob(gd(new Uint8Array(p))))}catch{return}}(r,t.token||t.appId);if(!i||!function(a,l){return a.cname===l.cname&&a.appId===l.appId&&a.token===l.token?l.stringUid?a.stringUid===l.stringUid:typeof l.uid=="number"?a.uid===l.uid:a.uid==l.uid:!1}(i,t))return;if(i&&Date.now()-i.ts<W("AP_CACHE_LIFETIME"))return i}catch(r){A.warn("Error get preloadInfo",r.message)}}function VG(t){let r;try{if(r=WG(Rm),!r)return;const i=JSON.parse(r),a=$G(t),l=function(p,m){for(let g=p.length-1;g>=0;g--)if(m(p[g]))return g;return-1}(i,p=>a in p);if(l===-1)return;const u=i.splice(l,1)[0];return K_(Rm,JSON.stringify(i)),u[a]}catch(i){A.warn("Error delete preload info: ".concat(r),i.message),K_(Rm,"")}}async function iI(t){let r;try{t.uid&&VG({appId:t.appId,cname:t.cname,token:t.token,uid:t.uid,stringUid:t.stringUid});const i=$G(t),a=await async function(u,p){try{const m=await window.crypto.subtle.importKey("raw",CV(p),"AES-GCM",!1,["encrypt"]),g=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:FG},m,zu(window.btoa(JSON.stringify(u))));return gd(new Uint8Array(g))}catch{return}}(t,t.token||t.appId);if(!a)return;r=WG(Rm);const l=r?JSON.parse(r):[];l.push({[i]:a}),l.length>W("AP_CACHE_NUM")&&l.shift(),K_(Rm,JSON.stringify(l))}catch(i){A.warn("Error caching server parameters:",i.message),K_(Rm,"")}}function sI(t){if(t){let r=lh.get(t);r&&(window.clearTimeout(r),r=null,lh.delete(t)),Ce(dh).call(dh,t)||t.cloudProxyServer!=="disabled"||dh.push(t)}if(lh.size<W("AP_CACHE_NUM")&&dh.length>0){const r=dh.shift();lh.set(r,window.setTimeout(async()=>{const{appId:i,cname:a,token:l,stringUid:u,uid:p,proxyServer:m,role:g}=r;try{await Qve(i,a,l,p,m,u,g),lh.has(r)&&sI(r)}catch(y){A.warn("update preload failed",y.message),BG(r)}},W("AP_UPDATE_INTERVAL")))}}function BG(t){const r=dh.indexOf(t);r!==-1&&dh.splice(r,1);let i=lh.get(t);i&&(window.clearTimeout(i),i=null,lh.delete(t),sI())}function GG(t,r){const i=t.sua,a=t.ap;r&&i&&Ye.reqUserAccount(t.sid,{lts:i.requestTime,elapse:i.elapse,success:!0,serverAddr:i.url,stringUid:r,uid:t.intUid,errorCode:null,extend:i.req}),Ye.reportResourceTiming(t.ap.url,t.sid),Ye.joinWebProxyAP(t.sid,{lts:a.requestTime,elapse:a.elapse,sucess:1,apServerAddr:a.url,turnServerAddrList:a.proxyInfo.addresses.map(l=>l.ip).join(","),eventType:"disabled",unilbsServerIds:[tr.CHOOSE_SERVER,tr.CLOUD_PROXY_FALLBACK].toString()}),Ye.joinChooseServer(t.sid,{lts:a.requestTime,elapse:a.elapse,succ:!0,csAddr:a.url,opid:a.opid,serverList:a.gatewayInfo.gatewayAddrs.map(l=>l.address),ec:null,cid:a.gatewayInfo.cid.toString(),uid:a.gatewayInfo.uid.toString(),csIp:a.gatewayInfo.csIp,unilbsServerIds:[tr.CHOOSE_SERVER].toString(),isHttp3:a.isHttp3})}function WG(t){return window.atob(window.localStorage.getItem(t)||"")}function K_(t,r){window.localStorage.setItem(t,window.btoa(r))}function $G(t){let r="".concat(t.appId,"_").concat(t.cname);return typeof t.uid=="string"&&(r+="_s_".concat(t.uid)),typeof t.uid=="number"&&(r+="_".concat(t.uid)),t.token&&(r+="_".concat(t.token)),jV(r)}function eye(t){let r=function(){const i=rye.pop();return i?(i.offset=i.limit=0,i):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(i,a){let l=i.appId;l!==void 0&&(nr(a,10),Td(a,l));let u=i.cid;u!==void 0&&(nr(a,16),nr(a,u));let p=i.cname;p!==void 0&&(nr(a,26),Td(a,p));let m=i.deviceId;m!==void 0&&(nr(a,34),Td(a,m));let g=i.elapse;g!==void 0&&(nr(a,40),Nd(a,g));let y=i.fileSize;y!==void 0&&(nr(a,48),Nd(a,Am(y)));let x=i.height;x!==void 0&&(nr(a,56),Nd(a,Am(x)));let S=i.jpg;S!==void 0&&(nr(a,66),nr(a,S.length),HG(a,S));let T=i.networkType;T!==void 0&&(nr(a,72),Nd(a,Am(T)));let C=i.osType;C!==void 0&&(nr(a,80),Nd(a,Am(C)));let V=i.requestId;V!==void 0&&(nr(a,90),Td(a,V));let j=i.sdkVersion;j!==void 0&&(nr(a,98),Td(a,j));let L=i.sequence;L!==void 0&&(nr(a,104),Nd(a,Am(L)));let H=i.sid;H!==void 0&&(nr(a,114),Td(a,H));let Y=i.timestamp;Y!==void 0&&(nr(a,120),Nd(a,Y));let te=i.uid;te!==void 0&&(nr(a,128),nr(a,te));let se=i.vid;se!==void 0&&(nr(a,136),nr(a,se));let oe=i.width;oe!==void 0&&(nr(a,144),Nd(a,Am(oe)));let ne=i.service;ne!==void 0&&(nr(a,152),nr(a,ne));let de=i.callbackData;de!==void 0&&(nr(a,162),nr(a,de.length),HG(a,de));let be=i.ticket;be!==void 0&&(nr(a,170),Td(a,be));let Se=i.vendorConfigs;Se!==void 0&&(nr(a,178),Td(a,Se))}(t,r),function(i){let a=i.bytes,l=i.limit;return a.length===l?a:a.subarray(0,l)}(r)}function tye(t){return function(i){let a={};e:for(;!iye(i);){let l=F0(i);switch(l>>>3){case 0:break e;case 1:a.code=F0(i);break;case 2:a.msg=KG(i,F0(i));break;case 3:a.requestId=KG(i,F0(i));break;case 4:a.timestamp=sye(i,!1);break;default:nye(i,7&l)}}return a}({bytes:r=t,offset:0,limit:r.length});var r}function nye(t,r){switch(r){case 0:for(;128&io(t););break;case 2:aI(t,F0(t));break;case 5:aI(t,4);break;case 1:aI(t,8);break;default:throw new Error("Unimplemented type: "+r)}}function Am(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}let rye=[];function aI(t,r){if(t.offset+r>t.limit)throw new Error("Skip past limit");t.offset+=r}function iye(t){return t.offset>=t.limit}function Y_(t,r){let i=t.bytes,a=t.offset,l=t.limit,u=a+r;if(u>i.length){let p=new Uint8Array(2*u);p.set(i),t.bytes=p}return t.offset=u,u>l&&(t.limit=u),a}function zG(t,r){let i=t.offset;if(i+r>t.limit)throw new Error("Read past limit");return t.offset+=r,i}function HG(t,r){let i=Y_(t,r.length);t.bytes.set(r,i)}function KG(t,r){let i=zG(t,r),a=String.fromCharCode,l=t.bytes,u="",p="";for(let m=0;m<r;m++){let g,y,x,S,T=l[m+i];128&T?(224&T)==192?m+1>=r?p+=u:(g=l[m+i+1],(192&g)!=128?p+=u:(S=(31&T)<<6|63&g,S<128?p+=u:(p+=a(S),m++))):(240&T)==224?m+2>=r?p+=u:(g=l[m+i+1],y=l[m+i+2],(49344&(g|y<<8))!=32896?p+=u:(S=(15&T)<<12|(63&g)<<6|63&y,S<2048||S>=55296&&S<=57343?p+=u:(p+=a(S),m+=2))):(248&T)==240?m+3>=r?p+=u:(g=l[m+i+1],y=l[m+i+2],x=l[m+i+3],(12632256&(g|y<<8|x<<16))!=8421504?p+=u:(S=(7&T)<<18|(63&g)<<12|(63&y)<<6|63&x,S<65536||S>1114111?p+=u:(S-=65536,p+=a(55296+(S>>10),56320+(1023&S)),m+=3))):p+=u:p+=a(T)}return p}function Td(t,r){let i=r.length,a=0;for(let p=0;p<i;p++){let m=r.charCodeAt(p);m>=55296&&m<=56319&&p+1<i&&(m=(m<<10)+r.charCodeAt(++p)-56613888),a+=m<128?1:m<2048?2:m<65536?3:4}nr(t,a);let l=Y_(t,a),u=t.bytes;for(let p=0;p<i;p++){let m=r.charCodeAt(p);m>=55296&&m<=56319&&p+1<i&&(m=(m<<10)+r.charCodeAt(++p)-56613888),m<128?u[l++]=m:(m<2048?u[l++]=m>>6&31|192:(m<65536?u[l++]=m>>12&15|224:(u[l++]=m>>18&7|240,u[l++]=m>>12&63|128),u[l++]=m>>6&63|128),u[l++]=63&m|128)}}function io(t){return t.bytes[zG(t,1)]}function YG(t,r){let i=Y_(t,1);t.bytes[i]=r}function F0(t){let r,i=0,a=0;do r=io(t),i<32&&(a|=(127&r)<<i),i+=7;while(128&r);return a}function nr(t,r){for(r>>>=0;r>=128;)YG(t,127&r|128),r>>>=7;YG(t,r)}function sye(t,r){let i,a=0,l=0,u=0;return i=io(t),a=127&i,128&i&&(i=io(t),a|=(127&i)<<7,128&i&&(i=io(t),a|=(127&i)<<14,128&i&&(i=io(t),a|=(127&i)<<21,128&i&&(i=io(t),l=127&i,128&i&&(i=io(t),l|=(127&i)<<7,128&i&&(i=io(t),l|=(127&i)<<14,128&i&&(i=io(t),l|=(127&i)<<21,128&i&&(i=io(t),u=127&i,128&i&&(i=io(t),u|=(127&i)<<7))))))))),{low:a|l<<28,high:l>>>4|u<<24,unsigned:r}}function Nd(t,r){let i=r.low>>>0,a=(r.low>>>28|r.high<<4)>>>0,l=r.high>>>24,u=l===0?a===0?i<16384?i<128?1:2:i<1<<21?3:4:a<16384?a<128?5:6:a<1<<21?7:8:l<128?9:10,p=Y_(t,u),m=t.bytes;switch(u){case 10:m[p+9]=l>>>7&1;case 9:m[p+8]=u!==9?128|l:127&l;case 8:m[p+7]=u!==8?a>>>21|128:a>>>21&127;case 7:m[p+6]=u!==7?a>>>14|128:a>>>14&127;case 6:m[p+5]=u!==6?a>>>7|128:a>>>7&127;case 5:m[p+4]=u!==5?128|a:127&a;case 4:m[p+3]=u!==4?i>>>21|128:i>>>21&127;case 3:m[p+2]=u!==3?i>>>14|128:i>>>14&127;case 2:m[p+1]=u!==2?i>>>7|128:i>>>7&127;case 1:m[p]=u!==1?128|i:127&i}}const qG={},XG={},q_=4294967296,aye=q_*q_,JG=aye/2;ZG(0,!0);const QG=ZG(0),oye=V0(0,-2147483648,!1),cye=V0(-1,2147483647,!1);function ZG(t,r){let i,a,l;return r?(l=0<=(t>>>=0)&&t<256)&&(a=XG[t],a)?a:(i=V0(t,0,!0),l&&(XG[t]=i),i):(l=-128<=(t|=0)&&t<128)&&(a=qG[t],a)?a:(i=V0(t,t<0?-1:0,!1),l&&(qG[t]=i),i)}function V0(t,r,i){return{low:0|t,high:0|r,unsigned:!!i}}function eW(t,r){if(isNaN(t))return QG;{if(t<=-JG)return oye;if(t+1>=JG)return cye}return t<0?QG:V0(t%q_|0,t/q_|0,r)}function tW(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}class oI extends Pn{get connectionState(){return this._connectionState}set connectionState(r){if(this._connectionState===r)return;const i=this._connectionState;this._connectionState=r,this.emit(Go.CONNECTION_STATE_CHANGE,r,i)}get quality(){return this._quality}set quality(r){this._quality=r>1?1:r<.1?.1:r,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(r){var i;super(),F(this,"name","AgoraRTCImageModeration"),F(this,"_connectionState",xa.CONNECTING),F(this,"_sequence",0),F(this,"_moderationStartTime",void 0),F(this,"_workerConnection",void 0),F(this,"_workerMessageLengthLimit",void 0),F(this,"_qualityRatio",void 0),F(this,"_connectInfo",void 0),F(this,"_cancelTokenSource",zi.CancelToken.source()),F(this,"_retryConfig",void 0),F(this,"_moderationInterval",void 0),F(this,"_moderationTimer",null),F(this,"_moderationMode",1),F(this,"_quality",1),F(this,"_qualityTimer",null),F(this,"_ticket",void 0),F(this,"_moderationIntervalMinimum",void 0),F(this,"_uploadFailedNum",0),F(this,"_uploadNum",0),F(this,"_uploadTimer",null),F(this,"_extraInfo",void 0),F(this,"_vendor",""),F(this,"_encoder",new TextEncoder),F(this,"_moderationId",void 0),F(this,"inspectImage",()=>{if(this.connectionState!==xa.CONNECTED)throw new pe(K.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===xa.CONNECTED?this.requestToInspectImage():A.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=tn(5,"image-moderation-"),this._workerMessageLengthLimit=W("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=W("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(i=r.interval)!==null&&i!==void 0?i:1e3,r.extraInfo&&(this._extraInfo=this._encoder.encode(r.extraInfo)),r.vendor&&(this._vendor=r.vendor),this._qualityRatio=W("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new C0("worker-"+this._moderationId,er),this.on(Go.STATE_CHANGE,(a,l)=>{A.debug("[".concat(this._moderationId,"] Moderation operation :").concat(vm[a]," ").concat(l||""))}),this.handleWorkerEvents()}async init(r,i){this.emit(Go.STATE_CHANGE,vm.CONNECT_AP),this._connectInfo=r;const a=this._cancelTokenSource.token;return this._retryConfig=i,new je((l,u)=>{this.on(Go.CONNECTION_STATE_CHANGE,(p,m)=>{p===xa.CONNECTED&&l()}),this.requestAP(r,a,i).then(p=>{this.connectWorker(p)}).catch(p=>{u(p)})})}updateConfig(r){var i;this._moderationInterval=(i=r.interval)!==null&&i!==void 0?i:1e3,r.extraInfo&&(this._extraInfo=this._encoder.encode(r.extraInfo)),r.vendor&&(this._vendor=r.vendor),A.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(r))),this.connectionState===xa.CONNECTED&&this.inspectImage()}async requestAP(r,i,a){const l=W("WEBCS_DOMAIN").map(g=>"https://".concat(g,"/api/v1")),u=await function(g,y,x,S){let{appId:T,areaCode:C,cname:V,sid:j,token:L,uid:H}=y;Em++;const Y="moderation_plugin",te={service_name:Y,json_body:JSON.stringify({appId:T,areaCode:C,cname:V,command:"allocateEdge",requestId:Em,seq:Em,sid:j,appToken:L,ts:Date.now(),uid:H+""})};let se,oe,ne=g[0];return Uo(async()=>{se=Date.now();const de=await $o(ne,{data:te,cancelToken:x,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(oe=Date.now()-se,de.code!==0){const ut=new pe(K.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+de.code,{retry:!0,responseTime:oe});throw A.error(ut.toString()),ut}const be=JSON.parse(de.json_body);if(be.code!==200){const ut=new pe(K.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(be.code,", reason: ").concat(be.reason),{code:be.code,responseTime:oe});throw A.error(ut.toString()),ut}if(!be.servers||!Array.isArray(be.servers)||be.servers.length===0){const ut=new pe(K.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:be.code,responseTime:oe});throw A.error(ut.toString()),ut}if(!be.servers.some(ut=>!!ut.wss)){const ut=new pe(K.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:be.code,responseTime:oe});throw A.error(ut.toString()),ut}const Se=W("IMAGE_MODERATION_WORKER_WSS");if(Se)return{addressList:[Se],workerToken:be.workerToken,vid:be.vid,responseTime:oe};const Be=W("IMAGE_MODERATION_WORKER_HOST");return{addressList:be.servers.map(ut=>{let{address:Tt,wss:Et}=ut;if(Tt&&Et)return"wss://".concat(Tt.replace(/\./g,"-"),".").concat(Be,":").concat(Et,"/moderation")}).filter(ut=>!!ut),workerToken:be.workerToken,vid:be.vid,ticket:be.appTicket,responseTime:oe}},(de,be)=>(Ye.apworkerEvent(j,{success:!0,sc:200,serviceName:Y,responseDetail:JSON.stringify(de.addressList),firstSuccess:be===0,responseTime:oe,serverIp:g[be%g.length]}),!1),(de,be)=>(Ye.apworkerEvent(j,{success:!1,sc:de.data&&de.data.code||200,serviceName:Y,responseTime:oe,serverIp:g[be%g.length]}),!!(de.code!==K.OPERATION_ABORTED&&de.code!==K.UNEXPECTED_RESPONSE||de.data&&de.data.retry)&&(ne=g[(be+1)%g.length],!0)),S)}(l,r,i,a);this.emit(Go.STATE_CHANGE,vm.AP_CONNECTED);const{addressList:p,ticket:m}=u;return this._ticket=m,p}async connectWorker(r){this.emit(Go.STATE_CHANGE,vm.CONNECT_WORKER),await this._workerConnection.init(r,1e4)}handleWorkerEvents(){this._workerConnection.on(wt.CONNECTED,async()=>{this.emit(Go.STATE_CHANGE,vm.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=xa.CONNECTED}),this._workerConnection.on(wt.CLOSED,()=>{this.connectionState=xa.CLOSED}),this._workerConnection.on(wt.FAILED,()=>{this.connectionState=xa.CLOSED}),this._workerConnection.on(wt.RECONNECTING,()=>{this.connectionState=this.connectionState===xa.CONNECTED?xa.RECONNECTING:xa.CONNECTING}),this._workerConnection.on(wt.ON_MESSAGE,async r=>{if(r.data instanceof ArrayBuffer){const i=tye(new Uint8Array(r.data));W("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&A.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(i)),this._uploadNum++,i.code===void 0||i.code===0||(this._uploadFailedNum++,A.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(i.code,", msg is ").concat(i.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{Ye.reportApiInvoke(this._connectInfo.sid||null,{name:Cn.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,i.code],tag:hn.TRACER}).onError(new pe(K.IMAGE_MODERATION_UPLOAD_FAILED,i.msg)),this._uploadTimer=null},W("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else A.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(wt.WILL_RECONNECT,(r,i,a)=>{r==="recover"&&a(r),a("tryNext")}),this._workerConnection.on(wt.REQUEST_NEW_URLS,(r,i)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(r).catch(i)})}static intToLong(r){return{low:r|=0,high:r>>31,unsigned:r>=0}}async requestToInspectImage(){const r=As(this,Go.CLIENT_LOCAL_VIDEO_TRACK),i={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(r){if(!r.isPlaying)return void(W("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&A.debug("Only the track being played can be inspected"));this._sequence++;const a=await this.generateRequestData(r,i);this._workerConnection.sendMessage(a,!0,!0)}else W("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&A.debug("Only the track being published can be inspected")}async generateRequestData(r,i){let{appId:a,cname:l,cid:u,vid:p,sid:m,uid:g}=i;const y=Date.now(),x=await r.getCurrentFrameImage("image/jpeg",this.quality),S=await T6(x,a,l),T=this._sequence+"-"+u+"-"+g+"-"+y+"-"+tn(12,""),C={appId:a,cid:u,cname:l,deviceId:"",elapse:oI.intToLong(Number(y-this._moderationStartTime)),fileSize:x.buffer.byteLength,height:x.height,width:x.width,jpg:S,networkType:6,osType:7,requestId:T,sdkVersion:"4.24.2",sequence:this._sequence,sid:m,timestamp:eW(y),uid:g,vid:p,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete C.callbackData;const V=eye(C);if(V.byteLength<this._workerMessageLengthLimit){if(W("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const j=function(L){for(var H=1;H<arguments.length;H++){var Y=arguments[H]!=null?arguments[H]:{};H%2?tW(Object(Y),!0).forEach(function(te){F(L,te,Y[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(L,Object.getOwnPropertyDescriptors(Y)):tW(Object(Y)).forEach(function(te){Object.defineProperty(L,te,Object.getOwnPropertyDescriptor(Y,te))})}return L}({},C);delete j.jpg,A.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(j))}return V}{const j=this.quality*this._qualityRatio;return this.quality=j,await this.generateRequestData(r,{appId:a,cname:l,cid:u,vid:p,sid:m,uid:g})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=zi.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=xa.CLOSED,this.emit(Go.STATE_CHANGE,vm.CLOSED)}}function nW(t){if(un(t.interval,"interval",1e3,1/0),t&&t.extraInfo&&t.extraInfo.length>1024)throw new pe(K.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(t&&t.vendor&&t.vendor.length>1024)throw new pe(K.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const lye={name:"ImageModeration",create:function(t){let{config:r}=t;return nW(r),new oI(r)}};var rW,iW,sW,aW,oW,cW,lW,dW,uW,hW,pW,mW,fW,gW,vW,yW,bW,xW,_W,EW,wW,SW,TW,NW,CW,RW,AW,IW,OW,PW,kW,jW,DW,LW,MW,UW,FW,VW,BW,GW,WW,$W,We;function zW(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function so(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?zW(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):zW(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}kr.setLogger(A);let dye=(rW=lt(),iW=lt({argsMap:(t,r)=>{if(!Array.isArray(r)){if(!(r instanceof lm))return[r];r=[r]}return r.map(i=>i?Object(i).toString():"null")}}),sW=lt({argsMap:(t,r)=>(r||(r=[]),Array.isArray(r)||r.trackMediaType!==cm.DATA?(Array.isArray(r)||(r=[r]),r.map(i=>i.getTrackId())):[r.getChannelId()])}),aW=lt({argsMap:(t,r,i,a)=>[typeof r=="object"?r.uid:r,i,a]}),oW=lt({argsMap:(t,r,i)=>[r,i]}),cW=lt({argsMap:(t,r)=>r.map(i=>{let{user:a,mediaType:l}=i;return[a==null?void 0:a.uid,l]})}),lW=lt({argsMap:(t,r,i,a)=>[typeof r=="object"?r.uid:r,i,a]}),dW=lt({argsMap:(t,r)=>r.map(i=>{let{user:a,mediaType:l}=i;return{uid:a==null?void 0:a.uid,mediaType:l}})}),uW=lt(),hW=lt(),pW=lt(),mW=lt(),fW=lt(),gW=lt(),vW=lt(),yW=lt(),bW=lt(),xW=lt(),_W=lt(),EW=lt(),wW=lt(),SW=lt(),TW=lt(),NW=lt(),CW=lt({argsMap:(t,r)=>[r]}),RW=lt(),AW=lt(),IW=lt(),OW=lt(),PW=lt(),kW=lt(),jW=lt(),DW=lt(),LW=lt({argsMap:(t,r)=>(Array.isArray(r)||(r=[r]),[JSON.stringify(r)])}),MW=lt(),UW=lt(),FW=lt(),VW=lt(),BW=lt(),GW=lt(),WW=lt({reportResult:!0}),$W=lt(),We=class extends Pn{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var t;return((t=this._config)===null||t===void 0?void 0:t.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(t,r){let i;if(super(),F(this,"store",void 0),F(this,"_uid",void 0),F(this,"_channelName",void 0),F(this,"_uintUid",void 0),F(this,"_users",[]),F(this,"_config",void 0),F(this,"_clientId",void 0),F(this,"_appId",void 0),F(this,"_sessionId",null),F(this,"_key",void 0),F(this,"_rtmConfig",{}),F(this,"_joinInfo",void 0),F(this,"_gateway",void 0),F(this,"_statsCollector",void 0),F(this,"_configDistribute",void 0),F(this,"_leaveMutex",void 0),F(this,"_publishMutex",void 0),F(this,"_renewTokenMutex",void 0),F(this,"_subscribeMutex",void 0),F(this,"_encryptionMode","none"),F(this,"_encryptionSecret",null),F(this,"_encryptionSalt",null),F(this,"_encryptDataStream",!1),F(this,"_encryptDataStreamKey",null),F(this,"_encryptDataStreamIv",null),F(this,"_proxyServer",void 0),F(this,"_turnServer",{servers:[],mode:"auto"}),F(this,"_cloudProxyServerMode","disabled"),F(this,"_isDualStreamEnabled",!1),F(this,"_defaultStreamFallbackType",void 0),F(this,"_lowStreamParameter",void 0),F(this,"_streamFallbackTypeCacheMap",new Map),F(this,"_remoteStreamTypeCacheMap",new Map),F(this,"_axiosCancelSource",zi.CancelToken.source()),F(this,"_audioVolumeIndicationInterval",void 0),F(this,"_networkQualityInterval",void 0),F(this,"_userOfflineTimeout",void 0),F(this,"_streamRemovedTimeout",void 0),F(this,"_rteDetailInterval",void 0),F(this,"_liveTranscodeStreamingClient",void 0),F(this,"_liveRawStreamingClient",void 0),F(this,"_channelMediaRelayClient",void 0),F(this,"_networkQualitySensitivity","normal"),F(this,"_p2pChannel",void 0),F(this,"_useLocalAccessPoint",!1),F(this,"_setLocalAPVersion",void 0),F(this,"_joinAndNotLeaveYet",!1),F(this,"_numberOfJoinCount",0),F(this,"_joinResponse",null),F(this,"_remoteDefaultVideoStreamType",void 0),F(this,"_inspect",void 0),F(this,"_moderation",void 0),F(this,"_license",void 0),F(this,"_pendingPublishedUsers",[]),F(this,"ntpAlignErrorCount",0),F(this,"remoteInboundOffset",0),F(this,"_peerConnectionState",void 0),F(this,"_pendingRtpCapabilityChange",void 0),F(this,"_fallbackServerInfo",void 0),F(this,"_dualStreamMode",void 0),F(this,"_handleLocalTrackEnable",(l,u,p)=>{this.publish(l,!1).then(u).catch(p)}),F(this,"_handleLocalTrackDisable",(l,u,p)=>{this.unpublish(l).then(u).catch(p)}),F(this,"_handleUserOnline",l=>{if(W("BLOCK_LOCAL_CLIENT")&&nh(l.uid,this.channelName))return void A.debug("[".concat(l.uid,"] will be ignored in local"));this.isStringUID&&typeof l.uid!="string"&&A.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const u=this._users.find(p=>p.uid===l.uid);if(u)u._trust_in_room_=!0,u._is_pre_created&&(u._is_pre_created=!1,this.safeEmit(Ot.USER_JOINED,u));else{const p=new wd(l.uid,l.uint_id||l.uid);this._users.push(p),A.debug("[".concat(this._clientId,"] user online"),l.uid),this.store.firstVideoFrameDecoded(p.uid,{userJoinNotify:Date.now()}),this.safeEmit(Ot.USER_JOINED,p)}}),F(this,"_handleUserOffline",l=>{if(W("BLOCK_LOCAL_CLIENT")&&nh(l.uid,this.channelName))return;const u=this._users.find(p=>p.uid===l.uid);u&&(this._handleRemoveStream(l),this._handleRemoveDataChannels(l),u._audio_pre_subscribed||u._video_pre_subscribed?u._is_pre_created=!0:Kx(this._users,u),this._remoteStreamTypeCacheMap.delete(u.uid),this._streamFallbackTypeCacheMap.delete(u.uid),A.debug("[".concat(this._clientId,"] user offline"),l.uid,"reason:",l.reason),this.safeEmit(Ot.USER_LEAVED,u,l.reason))}),F(this,"_handleAddAudioOrVideoStream",(l,u,p,m,g,y,x,S)=>{if(W("BLOCK_LOCAL_CLIENT")&&nh(u,this.channelName))return;const T=this._users.find(j=>j.uid===u);if(!T)return void A.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));A.debug("[".concat(this._clientId,"] stream added with uid ").concat(u,", type ").concat(l)),this.store.subscribe(T.uid,l,void 0,void 0,void 0,Date.now()),l==="video"&&this.store.firstVideoFrameDecoded(T.uid,{videoAddNotify:Date.now()});const C=l==="audio"?T.hasAudio:T.hasVideo;T._uintid||(T._uintid=y||u),l==="audio"?T._trust_audio_stream_added_state_=!0:T._trust_video_stream_added_state_=!0,l==="audio"?(T._audio_added_=!0,p!==void 0&&(T._audioSSRC=p),m!==void 0&&(T._cname=m),x&&(T._audioOrtc=x)):(T._video_added_=!0,p!==void 0&&(T._videoSSRC=p),m!==void 0&&(T._cname=m),S!==void 0&&(T._rtxSsrcId=S),x&&(T._videoOrtc=x)),(l==="audio"?T.hasAudio:T.hasVideo)&&!C&&(A.info("[".concat(this._clientId,"] remote user ").concat(T.uid," published ").concat(l)),this.safeEmit(Ot.USER_PUBLISHED,T,l)),l==="video"?Ye.onGatewayStream(this._sessionId,hr.ON_ADD_VIDEO_STREAM,Rn.ON_ADD_VIDEO_STREAM,{peer:y||u,ssrc:T._videoSSRC}):Ye.onGatewayStream(this._sessionId,hr.ON_ADD_AUDIO_STREAM,Rn.ON_ADD_AUDIO_STREAM,{peer:y||u,ssrc:T._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(T,l,p).then(j=>{if(j&&(A.debug("[".concat(this._clientId,"] resubscribe ").concat(l," for user ").concat(T.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof ch))return this._p2pChannel.unsubscribe(T,l,!0).then(()=>this._subscribe(T,l,!0).catch(L=>{A.error("[".concat(this._clientId,"] resubscribe error"),L.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(T,l)&&(A.debug("[".concat(this._clientId,"] resubscribe ").concat(l," for user ").concat(T.uid," after reconnect.")),this._subscribe(T,l,!0).catch(j=>{A.error("[".concat(this._clientId,"] resubscribe error"),j.toString())}));const V=this._getEncodingName(g);l==="video"&&(V==="unknown"?this.safeEmit(Ot.AV1_DECODABLE_RESULT,!1):Pr()||pi()||(V==null?void 0:V.toLocaleLowerCase())!==Yu.av1||kve().then(j=>{W("FLS_ENABLE_AV1_DECODE_DETECT")&&this.safeEmit(Ot.AV1_DECODABLE_RESULT,j),j||this._gateway.downgradeCodec(V)}))}),F(this,"_handleRemoveStream",l=>{if(W("BLOCK_LOCAL_CLIENT")&&nh(l.uid,this.channelName))return;const u=this._users.find(m=>m.uid===l.uid);if(!u)return void A.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));A.debug("[".concat(this._clientId,"] stream removed with uid ").concat(l.uid));let p=()=>{};u.hasAudio&&u.hasVideo?p=()=>{A.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished audio track")),this.safeEmit(Ot.USER_UNPUBLISHED,u,"audio"),A.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished video track")),this.safeEmit(Ot.USER_UNPUBLISHED,u,"video")}:u.hasVideo?p=()=>{A.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished video track")),this.safeEmit(Ot.USER_UNPUBLISHED,u,"video")}:u.hasAudio&&(p=()=>{A.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished audio track")),this.safeEmit(Ot.USER_UNPUBLISHED,u,"audio")}),u._video_pre_subscribed||u._audio_pre_subscribed||(u._trust_audio_stream_added_state_=!0,u._trust_video_stream_added_state_=!0,u._audio_added_=!1,u._video_added_=!1,this._p2pChannel instanceof ch&&this._p2pChannel.unsubscribe(u).then(m=>{if(m)return this._gateway.unsubscribe(m,u.uid)}),u._audioSSRC=void 0,u._videoSSRC=void 0,u._audioOrtc=void 0,u._videoOrtc=void 0,u._rtxSsrcId=void 0),Ye.onGatewayStream(this._sessionId,hr.ON_REMOVE_STREAM,Rn.ON_REMOVE_STREAM,{peer:l.uint_id||l.uid}),p()}),F(this,"_handleSetStreamLocalEnable",(l,u,p)=>{if(W("BLOCK_LOCAL_CLIENT")&&nh(u,this.channelName))return;const m=this._users.find(x=>x.uid===u);if(!m)return void A.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));A.debug("[".concat(this._clientId,"] local ").concat(l," ").concat(p?"enabled":"disabled"," with uid ").concat(u));const g=l==="audio"?m.hasAudio:m.hasVideo;if(l==="audio"){m._trust_audio_enabled_state_=!0;const x=m._audio_enabled_;if(m._audio_enabled_=p,m._audio_enabled_===x)return;{const S=m._audio_enabled_?"enable-local-audio":"disable-local-audio";A.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(u,", msg: ").concat(S)),this.safeEmit(Ot.USER_INFO_UPDATED,u,S)}}else{m._trust_video_enabled_state_=!0;const x=m._video_enabled_;if(m._video_enabled_=p,m._video_enabled_===x)return;{const S=m._video_enabled_?"enable-local-video":"disable-local-video";A.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(u,", msg: ").concat(S)),this.safeEmit(Ot.USER_INFO_UPDATED,u,S)}}const y=l==="audio"?m.hasAudio:m.hasVideo;return g!==y?!g&&y?(A.info("[".concat(this._clientId,"] remote user ").concat(u," published ").concat(l)),void this.safeEmit(Ot.USER_PUBLISHED,m,l)):(l==="video"&&m._videoTrack&&m._videoTrack._destroy(),l==="audio"&&m._audioTrack,this._p2pChannel.muteRemote(m,l),A.info("[".concat(this._clientId,"] remote user ").concat(u," unpublished ").concat(l)),void this.safeEmit(Ot.USER_UNPUBLISHED,m,l)):void 0}),F(this,"_handleMuteStream",(l,u,p)=>{if(W("BLOCK_LOCAL_CLIENT")&&nh(l,this.channelName))return;A.debug("[".concat(this._clientId,"] receive mute message"),l,u,p);const m=this._users.find(x=>x.uid===l);if(!m)return void A.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(l));const g=u==="audio"?m.hasAudio:m.hasVideo;if(u==="audio"){m._trust_audio_mute_state_=!0;const x=m._audio_muted_;if(m._audio_muted_=p,m._audio_muted_===x)return;{const S=m._audio_muted_?"mute-audio":"unmute-audio";A.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(l,", msg: ").concat(S)),this.safeEmit(Ot.USER_INFO_UPDATED,l,S)}}else{m._trust_video_mute_state_=!0;const x=m._video_muted_;if(m._video_muted_=p,m._video_muted_===x)return;{const S=m._video_muted_?"mute-video":"unmute-video";A.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(l,", msg: ").concat(S)),this.safeEmit(Ot.USER_INFO_UPDATED,l,S)}}const y=u==="audio"?m.hasAudio:m.hasVideo;if(g!==y){if(!g&&y)return(u==="audio"?m._audioSSRC:m._videoSSRC)?(A.info("[".concat(this._clientId,"] remote user ").concat(l," published ").concat(u)),void this.safeEmit(Ot.USER_PUBLISHED,m,u)):void A.warning("[".concat(this._clientId,"] remote user ").concat(l," receive ").concat(u," unmute message  before add stream message, ").concat(u," SSRC doesn't exist yet."));u==="video"&&m._videoTrack&&!m._video_pre_subscribed&&m._videoTrack._destroy(),u==="audio"&&m._audioTrack,this._p2pChannel.muteRemote(m,u),A.info("[".concat(this._clientId,"] remote user ").concat(l," unpublished ").concat(u)),this.safeEmit(Ot.USER_UNPUBLISHED,m,u)}}),F(this,"_handleP2PLost",async l=>{A.debug("[".concat(this._clientId,"] receive p2p lost"),l),parseInt(l.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():A.warning("[".concat(this._clientId,"] P2PLost stream not found"),l)}),F(this,"_handleTokenWillExpire",()=>{A.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Ot.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),F(this,"_handleBeforeUnload",l=>{l.type==="beforeunload"&&l.returnValue!==void 0&&l.returnValue!==""||(this.leave(),A.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),F(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(Ot.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const l={downlinkNetworkQuality:0,uplinkNetworkQuality:0};l.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),l.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Ot.NETWORK_QUALITY,l)}),F(this,"_handleP2PAddAudioOrVideoStream",(l,u,p,m)=>{const g=this._users.find(x=>x.uid===u);if(!g)return void A.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));A.debug("[".concat(this._clientId,"] stream added with uid ").concat(u,", type ").concat(l)),this.store.subscribe(g.uid,l,void 0,void 0,void 0,Date.now());const y=l==="audio"?g.hasAudio:g.hasVideo;l==="audio"?g._trust_audio_stream_added_state_=!0:g._trust_video_stream_added_state_=!0,l==="audio"?(g._audio_added_=!0,p!==void 0&&(g._audioSSRC=p),m!==void 0&&(g._audioMid=m)):(g._video_added_=!0,p!==void 0&&(g._videoSSRC=p),m!==void 0&&(g._videoMid=m)),(l==="audio"?g.hasAudio:g.hasVideo)&&!y&&(A.info("[".concat(this._clientId,"] remote user ").concat(g.uid," published ").concat(l)),this.safeEmit(Ot.USER_PUBLISHED,g,l)),this._p2pChannel.hasPendingRemoteMedia(g,l)&&(A.debug("[".concat(this._clientId,"] resubscribe ").concat(l," for user ").concat(g.uid," after reconnect.")),this._subscribe(g,l,!0).catch(x=>{A.error("[".concat(this._clientId,"] resubscribe error"),x.toString())}))}),this._config=t,this._clientId=r||tn(5,"client-"),this.store=new class{constructor(l,u,p,m,g){xt(this,"state",void 0),this.state={codec:l,audioCodec:u,mode:p,clientId:m,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,keyMetrics:{publish:[],subscribe:[],firstVideoFrameDecoded:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:Ku.Default,hasStartJoinChannel:!1,isABTestSuccess:!1,rteUrl:void 0,rteSid:void 0,autoSubscribe:!1,enableInstantMuteRestore:!1,networkQualityProbe:!1,useDcSignal:!!g}}dispatch(l){this.state=function(u,p){switch(p.type){case gt.SET_SESSION_ID:return Ie(Ie({},u),{},{sessionId:p.sessionId});case gt.SET_P2P_ID:return Ie(Ie({},u),{},{p2pId:p.p2pId});case gt.SET_UID:return Ie(Ie({},u),{},{uid:p.uid});case gt.SET_INT_UID:return Ie(Ie({},u),{},{intUid:p.intUid});case gt.SET_PUB_ID:return Ie(Ie({},u),{},{pubId:p.pubId});case gt.KEY_METRIC_CLIENT_CREATED:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{clientCreated:p.metric})});case gt.KEY_METRIC_JOIN_START:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{joinStart:p.metric})});case gt.KEY_METRIC_PRELOAD_START:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{preloadStart:p.metric})});case gt.KEY_METRIC_PRELOAD_END:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{preloadEnd:p.metric})});case gt.KEY_METRIC_JOIN_END:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{joinEnd:p.metric})});case gt.KEY_METRIC_REQUEST_AP_START:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{requestAPStart:p.metric})});case gt.KEY_METRIC_REQUEST_AP_END:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{requestAPEnd:p.metric})});case gt.KEY_METRIC_REQUEST_SUA_END:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{requestSUAEnd:p.metric})});case gt.KEY_METRIC_BEFORE_CONNECT:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{beforeConnect:p.metric})});case gt.KEY_METRIC_PEER_RECEIVER:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{peerReceiver:p.metric})});case gt.KEY_METRIC_SIGNAL_CONNECTED:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{signalConnected:p.metric})});case gt.KEY_METRIC_JOIN_REQ:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{joinReq:p.metric})});case gt.KEY_METRIC_JOIN_REP:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{joinRep:p.metric})});case gt.KEY_METRIC_JOIN_GATEWAY_START:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{joinGatewayStart:p.metric})});case gt.KEY_METRIC_JOIN_GATEWAY_END:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{joinGatewayEnd:p.metric})});case gt.KEY_METRIC_PEER_CONNECTION_START:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{peerConnectionStart:p.metric})});case gt.KEY_METRIC_PEER_CONNECTION_END:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{peerConnectionEnd:p.metric})});case gt.KEY_METRIC_DESCRIPTION_START:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{descriptionStart:p.metric})});case gt.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{signalChannelOpen:p.metric})});case gt.KEY_METRIC_ICE_CONNECTION_END:return Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{iceConnectionEnd:p.metric})});case gt.KEY_METRIC_PUBLISH:{const m=u.keyMetrics.publish,g=m.findIndex(y=>y.trackId===p.metric.trackId);return g!==-1?(m[g]=Ie(Ie({},m[g]),p.metric),Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{publish:[...m]})})):Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{publish:[...u.keyMetrics.publish,p.metric]})})}case gt.KEY_METRIC_SUBSCRIBE:{const m=u.keyMetrics.subscribe,g=m.findIndex(y=>y.userId===p.metric.userId&&y.type===p.metric.type);return g!==-1?(m[g]=Ie(Ie({},m[g]),p.metric),Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{subscribe:[...m]})})):Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{subscribe:[...u.keyMetrics.subscribe,p.metric]})})}case gt.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED:{const m=u.keyMetrics.firstVideoFrameDecoded,g=m.findIndex(y=>y.userId===p.metric.userId);return g!==-1?(m[g]=Ie(Ie({},m[g]),p.metric),Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{firstVideoFrameDecoded:[...m]})})):Ie(Ie({},u),{},{keyMetrics:Ie(Ie({},u.keyMetrics),{},{firstVideoFrameDecoded:[...u.keyMetrics.firstVideoFrameDecoded,p.metric]})})}case gt.RESET_FIRST_VIDEO_FRAME_DECODED:return u.keyMetrics.firstVideoFrameDecoded=[],u;case gt.SET_CLOUD_PROXY_SERVER_MODE:return u.cloudProxyServerMode=p.mode,u;case gt.RECORD_JOIN_CHANNEL_SERVICE:return typeof p.index!="number"?u.joinChannelServiceRecords=[...u.joinChannelServiceRecords,p.record]:(u.joinChannelServiceRecords[p.index]=Ie(Ie({},u.joinChannelServiceRecords[p.index]),p.record),u.joinChannelServiceRecords=[...u.joinChannelServiceRecords]),u;case gt.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return u.joinChannelServiceRecords=[],u;case gt.RESET_KEY_METRICS:return u.keyMetrics={publish:[],subscribe:[],firstVideoFrameDecoded:[]},u;case gt.SET_USE_P2P:return Ie(Ie({},u),{},{useP2P:p.val});case gt.SET_TRANSPORT_TYPE:return Ie(Ie({},u),{},{p2pTransport:p.val});case gt.SET_RTE_URL:return Ie(Ie({},u),{},{rteUrl:p.rteUrl});case gt.SET_RTE_SID:return Ie(Ie({},u),{},{rteSid:p.rteSid});default:return u}}(this.state,l)}get useDcSignal(){return this.state.useDcSignal}set useDcSignal(l){this.state.useDcSignal=l}set autoSubscribe(l){this.state.autoSubscribe=l}get autoSubscribe(){return this.state.autoSubscribe}set enableInstantMuteRestore(l){this.state.enableInstantMuteRestore=l}get enableInstantMuteRestore(){return this.state.enableInstantMuteRestore}set networkQualityProbe(l){this.state.networkQualityProbe=l}get networkQualityProbe(){return this.state.networkQualityProbe}set sessionId(l){this.dispatch({type:gt.SET_SESSION_ID,sessionId:l})}get sessionId(){return this.state.sessionId}set rteUrl(l){this.dispatch({type:gt.SET_RTE_URL,rteUrl:l})}get rteUrl(){return this.state.rteUrl}set rteSid(l){this.dispatch({type:gt.SET_RTE_SID,rteSid:l})}get rteSid(){return this.state.rteSid}set cid(l){this.state.cid=l}get cid(){return this.state.cid}set codec(l){this.state.codec=l}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(l){this.dispatch({type:gt.SET_P2P_ID,p2pId:l})}get p2pId(){return this.state.p2pId}set dcId(l){this.dispatch({type:gt.SET_DC_ID,dcId:l})}get dcId(){return this.state.dcId}set uid(l){this.dispatch({type:gt.SET_UID,uid:l})}get uid(){return this.state.uid}set intUid(l){this.dispatch({type:gt.SET_INT_UID,intUid:l})}get intUid(){return this.state.intUid}set pubId(l){this.dispatch({type:gt.SET_PUB_ID,pubId:l})}get pubId(){return this.state.pubId}set cloudProxyServerMode(l){this.dispatch({type:gt.SET_CLOUD_PROXY_SERVER_MODE,mode:l})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(l){this.dispatch({type:gt.SET_USE_P2P,val:l})}get useP2P(){return this.state.useP2P}set p2pTransport(l){this.dispatch({type:gt.SET_TRANSPORT_TYPE,val:l})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(l){this.state.hasStartJoinChannel=l}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(l){this.state.isABTestSuccess=l}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:gt.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:gt.KEY_METRIC_JOIN_START,metric:Date.now()})}preloadStart(){this.dispatch({type:gt.KEY_METRIC_PRELOAD_START,metric:Date.now()})}preloadEnd(){this.dispatch({type:gt.KEY_METRIC_PRELOAD_END,metric:Date.now()})}joinEnd(){this.dispatch({type:gt.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:gt.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:gt.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}requestSUAEnd(){this.dispatch({type:gt.KEY_METRIC_REQUEST_SUA_END,metric:Date.now()})}beforeConnect(){this.dispatch({type:gt.KEY_METRIC_BEFORE_CONNECT,metric:Date.now()})}peerReceiver(){this.dispatch({type:gt.KEY_METRIC_PEER_RECEIVER,metric:Date.now()})}signalConnected(){this.dispatch({type:gt.KEY_METRIC_SIGNAL_CONNECTED,metric:Date.now()})}joinReq(){this.dispatch({type:gt.KEY_METRIC_JOIN_REQ,metric:Date.now()})}joinRep(){this.dispatch({type:gt.KEY_METRIC_JOIN_REP,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:gt.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:gt.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:gt.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:gt.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}firstVideoFrameDecoded(l,u){this.dispatch({type:gt.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED,metric:Ie({userId:l},u)})}descriptionStart(){this.dispatch({type:gt.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:gt.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:gt.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(l,u,p,m){this.dispatch({type:gt.KEY_METRIC_PUBLISH,metric:Ie(Ie({trackId:l,type:u},p&&{publishStart:p}),m&&{publishEnd:m})})}subscribe(l,u,p,m,g,y,x){this.dispatch({type:gt.KEY_METRIC_SUBSCRIBE,metric:Ie(Ie(Ie(Ie(Ie({userId:l,type:u},p&&{subscribeStart:p}),m&&{subscribeEnd:m}),g&&{firstFrame:g}),y&&{streamAdded:y}),x&&{firstDecoded:x})})}massSubscribe(l,u,p,m){l.forEach(g=>{this.dispatch({type:gt.KEY_METRIC_SUBSCRIBE,metric:Ie(Ie(Ie({userId:g.userId,type:g.type},u&&{subscribeStart:u}),p&&{subscribeEnd:p}),m&&{firstFrame:m})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(l,u){l.service==="gateway"&&Array.isArray(l.urls)&&(l.urls=l.urls.map(p=>p.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof u!="number"?(this.dispatch({type:gt.RECORD_JOIN_CHANNEL_SERVICE,record:Ie(Ie({},l),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(u<0||u>=this.state.joinChannelServiceRecords.length||this.dispatch({type:gt.RECORD_JOIN_CHANNEL_SERVICE,record:l,index:u}),u)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:gt.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:gt.RESET_KEY_METRICS})}resetFirstVideoFrameDecoded(){this.dispatch({type:gt.RESET_FIRST_VIDEO_FRAME_DECODED})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}}(t.codec,t.audioCodec,t.mode,this._clientId,W("SIGNAL_CHANNEL")===1),this._leaveMutex=new kr("client-leave",this._clientId),this._publishMutex=new kr("client-publish",this._clientId),this._renewTokenMutex=new kr("client-renewtoken",this._clientId),this._subscribeMutex=new kr("client-subscribe",this._clientId),this.store.clientCreated(),t.proxyServer&&this.setProxyServer(t.proxyServer,!0),t.turnServer&&this.setTurnServer(t.turnServer,!0),A.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(fa," build: ").concat(LA,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),t.clientRoleOptions)try{_A(t.clientRoleOptions),i=Object.assign({},t.clientRoleOptions)}catch(l){A.warning("[".concat(this._clientId,"] ").concat(l.toString()))}var a;this._statsCollector=new L0(this.store),this._statsCollector.onStatsException=(l,u,p)=>{A.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(l,", msg: ").concat(u,", uid: ").concat(p)),l===V1.VIDEO_ENCODE_FAILED&&this.localTracks.forEach(m=>{m instanceof d_&&W("ENABLE_ENCODE_EXCEPTION")&&m.findClosestProfile()}),this.safeEmit(Ot.EXCEPTION,{code:l,msg:u,uid:p})},this._statsCollector.onUploadPublishDuration=(l,u,p,m)=>{const g=this._users.find(y=>y.uid===l);g&&(this.store.keyMetrics&&(this.store.firstVideoFrameDecoded(g.uid,{peerPublishDuration:p,peerPubStatusMs:Date.now()}),this._p2pChannel.reportVideoFirstFrameRender(g)),Ye.peerPublishStatus(this._sessionId,{subscribeElapse:m,audioPublishDuration:u,videoPublishDuration:p,peer:g._uintid}))},this._statsCollector.onVideoCodecChanged=l=>{if(W("VIDEO_STANDARD_BITRATE_VERSION")&&(l==="av1"||l==="h265"||l==="h264")){const u=this.localTracks.find(p=>p instanceof pn);u&&u._saveEncodeBitrateRatio!==1&&u.setSaveEncodeBitrateRatio(l==="h264"?W("BASELINE_MORE_H264_BITRATE_RATIO"):void 0)}},this.store.useP2P=t.mode==="p2p",this._gateway=new Cve(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:t.websocketRetryConfig||er,httpRetryConfig:t.httpRetryConfig||er,forceWaitGatewayResponse:t.forceWaitGatewayResponse===void 0||t.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:t.role,clientRoleOptions:i}),this._configDistribute=new Uve(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(a={store:this.store,statsCollector:this._statsCollector},Wo("P2PChannel").create(a)),this._handleP2PEvents()):this._p2pChannel=new ch(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(t,r,i,a,l){let u=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],p=arguments.length>6&&arguments[6]!==void 0&&arguments[6];cn("JOIN_GATEWAY_USE_443PORT_ONLY",u),cn("JOIN_GATEWAY_USE_DUAL_DOMAIN",p);const m=this._gateway.signal.websocket;return m instanceof _1&&(m.use443PortOnly=u,m.tryDoubleDomain=p),async function(g,y,x){Wx.get(g)||Wx.set(g,[]),$x.get(g)||$x.set(g,y),wc.get(g)||wc.set(g,0);const S=Wx.get(g),T=$x.get(g);if(!S||!T)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(wc.get(g)===T){const H=m0();S.push(H),await H.promise}wc.set(g,wc.get(g)+1);for(var C=arguments.length,V=new Array(C>3?C-3:0),j=3;j<C;j++)V[j-3]=arguments[j];const L=await x(...V);return wc.set(g,wc.get(g)-1),wc.get(g)===T-1&&S.length>0&&(S[0].resolve(),S.shift()),wc.get(g)===0&&(Wx.set(g,[]),$x.set(g,0),wc.set(g,0)),L}("client.join",W("JOIN_MAX_CONCURRENCY"),this.join.bind(this),t,r,i,a,l)}async join(t,r,i,a,l){const u=++this._numberOfJoinCount;this.store.joinStart(),a&&(this.store.uid=a);const p=(Xx||Xx||(Xx=(window.location.protocol.split(":")[0]||"").toUpperCase(),Xx))==="HTTPS",m=LV()?window.isSecureContext:"Browser Not Support";(!LV()&&!p||!window.isSecureContext)&&A.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser");let g;Ye.setAppId(t);try{if(!i&&i!==null)throw new pe(K.INVALID_PARAMS,"Invalid token: ".concat(i,". If you don not use token, set it to null"));if(i&&Wr(i,"token",1,2047),Wr(t,"appid",1,2047),__(r),a&&E_(a),l)if(typeof l=="string")Wr(l,"optionalInfo",1,256),g=l;else{if(typeof l!="object")throw new pe(K.INVALID_PARAMS,"Invalid options: options is not a string or object");{const{autoSubscribe:L,enableInstantMuteRestore:H,networkQualityProbe:Y}=l;L&&(qa(L,"autoSubscribe"),A.info("[".concat(this._clientId,"] join: autoSubscribe: ").concat(L)),this.store.autoSubscribe=L),H&&(qa(H,"enableInstantMuteRestore"),A.info("[".concat(this._clientId,"] join: enableInstantMuteRestore: ").concat(H)),this.store.enableInstantMuteRestore=H),Y&&(qa(Y,"networkQualityProbe"),A.info("[".concat(this._clientId,"] join: networkQualityProbe: ").concat(Y)),this.store.networkQualityProbe=Y)}}}catch(L){throw Ye.reportApiInvoke(Hu(),{name:Cn.JOIN,options:[t,r,i,a],states:{isHttps:p,isSecureContext:m},tag:hn.TRACER}).onError(L),L}if(this._leaveMutex.isLocked&&(A.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),A.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const L=new pe(K.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw Ye.reportApiInvoke(Hu(),{name:Cn.JOIN,options:[t,r,i,a],states:{isHttps:p,isSecureContext:m},tag:hn.TRACER}).onError(L),L}this._gateway.state="CONNECTING",this.store.preloadStart();const y=await rI({appId:t,cname:r,uid:a,stringUid:typeof a=="string"?a:void 0,token:i||t,cloudProxyServer:this._cloudProxyServerMode});if(this.store.preloadEnd(),!this._joinAndNotLeaveYet)throw new pe(K.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const x=(y==null?void 0:y.sid)||Hu();A.info("[".concat(this._clientId,"] start join channel ").concat(r,", join number: ").concat(u)),this._sessionId||(this._sessionId=x,this.store.sessionId=this._sessionId);const S=Ye.reportApiInvoke(this._sessionId,{id:this._clientId,name:Cn.JOIN,options:[t,r,i,a],states:{isHttps:p,isSecureContext:m},tag:hn.TRACER}),T=so(so(so({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:t,sid:this._sessionId,cname:r,uid:typeof a!="string"?a:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:i||t,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:g,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!y},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:W("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(T.setLocalAPVersion=this._setLocalAPVersion),typeof a=="string"&&(T.stringUid=a,this._uintUid?(T.uid=this._uintUid,this._uintUid=void 0):T.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(T.aesmode=this._encryptionMode,T.aespassword=await(async L=>{const H=function(oe){const ne=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),de=new Uint8Array(new ArrayBuffer(ne.length));for(let be=0;be<ne.length;be+=1)de[be]=ne.charCodeAt(be);return de}(),Y=await window.crypto.subtle.importKey("spki",H,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),te=bA(L),se=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},Y,te);return function(oe){let ne="";for(let de=0;de<oe.length;de+=1)ne+=String.fromCharCode(oe[de]);return window.btoa(ne)}(new Uint8Array(se))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new pe(K.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(T.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const L=new TextEncoder,H=W("USE_PURE_ENCRYPTION_MASTER_KEY")?L.encode(T.appId+this._encryptionSecret+this._encryptionSecret):L.encode(T.appId+T.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(Y,te,se){const oe=await window.crypto.subtle.importKey("raw",te,"PBKDF2",!1,["deriveBits","deriveKey"]),ne=Y==="aes-128-gcm2"?128:256,de=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:HV,hash:"SHA-256",salt:se},oe,ne+s0e);return new Uint8Array(de).subarray(ne/8)}(this._encryptionMode,H,zu(this._encryptionSalt)),this._encryptDataStreamKey=await async function(Y,te,se){const oe=await window.crypto.subtle.importKey("raw",te,"PBKDF2",!1,["deriveBits","deriveKey"]),ne=Y==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:HV,hash:"SHA-256",salt:se},oe,{name:"AES-GCM",length:ne},!0,["encrypt","decrypt"])}(this._encryptionMode,H,zu(this._encryptionSalt))}else m?A.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):A.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,A.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:r,appId:t,stringUid:T.stringUid});const C=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&C===this._sessionId&&Ye.joinChannelTimeout(this._sessionId,5)},5e3);try{var V;let L;const H=T.cloudProxyServer;if(Ce(V=["proxy3","proxy4","proxy5"]).call(V,H)){const ne=W("PROXY_SERVER_TYPE3");Array.isArray(ne)?T.proxyServer=ne[0]:T.proxyServer=ne}if(Ye.setProxyServer(T.proxyServer),A.setProxyServer(T.proxyServer),this.store.requestAPStart(),y){if(A.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(T.stringUid?", ".concat(T.stringUid," => ").concat(y.intUid):""," ")),T.stringUid&&!T.uid&&(T.uid=y.intUid),L={gatewayInfo:y.ap.gatewayInfo},W("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&T.turnServer.mode==="auto")if(y.ap.proxyInfo.addresses.length===0)A.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const ne=(await j8(y.ap.proxyInfo,y.ap.gatewayInfo.uid)).map(de=>({turnServerURL:de.address,tcpport:de.tcpport||Zr.tcpport,udpport:de.udpport||Zr.udpport,username:de.username||Zr.username,password:de.password||Zr.password,forceturn:!1,security:!0}));T.turnServer={mode:"manual",servers:ne}}GG(y,T.stringUid)}else{if(T.stringUid&&!T.uid){let ne;[ne,L]=await je.all([cG(T.stringUid,T,this._axiosCancelSource.token,this._config.httpRetryConfig||er,this.store).finally(()=>{this.store.requestSUAEnd()}),oG(T,this._axiosCancelSource.token,this._config.httpRetryConfig||er,!0,this.store).finally(()=>{this.store.requestAPEnd()})]),A.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(T.stringUid," => ").concat(ne)),T.uid=ne,L.gatewayInfo.uid=ne,L.gatewayInfo.res.uid=ne}else L=await oG(T,this._axiosCancelSource.token,this._config.httpRetryConfig||er,!0,this.store);if(!this._joinAndNotLeaveYet)throw new pe(K.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(T,this._axiosCancelSource.token),this._configDistribute.on(Bo.UPDATE_BITRATE_LIMIT,ne=>{this._p2pChannel.updateBitrateLimit(ne)}),this._configDistribute.on(Bo.UPDATE_CLIENT_ROLE_OPTIONS,ne=>{this._setClientRoleOptions(ne)}),this._configDistribute.on(Bo.UPDATE_REMOTE_VIDEO_STREAM_TYPE,ne=>{var de;Ce(de=[0,1,4,5,6,7,8,9]).call(de,ne)&&(this.remoteUsers.forEach(be=>{this._remoteStreamTypeCacheMap.get(be.uid)!==ne&&this.setRemoteVideoStreamType(be.uid,ne)}),this.setRemoteDefaultVideoStreamType(ne))}),this._configDistribute.on(Bo.FALLBACK_TO_HLS,ne=>{ne&&this.safeEmit(Ot.FALLBACK_TO_HLS,EA.CONFIG)}),this._configDistribute.on(Bo.UPDATE_VOS_CONFIGURE,ne=>{this._gateway.setConfigure(ne).catch(de=>{A.debug("[".concat(this._clientId,"] auto set vos config failed"),de)})})},0),this._key=i||t;const Y=L.gatewayInfo,te=T.uid?T.uid:Y.uid;this._joinInfo=so(so({},T),{},{cid:Y.cid,uid:te,vid:Y.vid,apResponse:Y.res,apGatewayAddress:Y.apGatewayAddress,uni_lbs_ip:Y.uni_lbs_ip,gatewayAddrs:Y.gatewayAddrs}),this.store.intUid=te,this.store.cid=Y.cid;const se=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new pe(K.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));S.onSuccess(se),this._appId=t,this._channelName=T.cname,this._uid=se,this.store.uid=se,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),!Pr()&&this.store.useDcSignal?(window.addEventListener("beforeunload",this._handleBeforeUnload),window.addEventListener("pagehide",this._handleBeforeUnload)):window.addEventListener(Pr()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);const oe=T.stringUid?"string uid: ".concat(T.stringUid,",uid: ").concat(T.uid):"uid: ".concat(this._uid);return A.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(r,",").concat(oe)),setTimeout(()=>{A.startUpload()},5e3),this.store.joinEnd(),j=this,Ce(th).call(th,j)||th.push(j),this._cloudProxyServerMode==="disabled"&&jt().supportWebCrypto&&W("ENABLE_PRELOAD")&&sI(this._joinInfo),this._rteDetailInterval&&(window.clearInterval(this._rteDetailInterval),this._rteDetailInterval=void 0),this._sessionId&&Ye.reportRteDetail(this._sessionId),this._rteDetailInterval=window.setInterval(()=>{this._sessionId&&Ye.reportRteDetail(this._sessionId)},W("RTE_DETAIL_REPORT_INTERVAL")||6e4),se}catch(L){const H=Array.isArray(L)?L[0]:L;throw H&&H.code===K.OPERATION_ABORTED?A.warning("[".concat(this._clientId,"] join number: ").concat(u,", Joining channel failed, rollback"),H):A.error("[".concat(this._clientId,"] join number: ").concat(u,", Joining channel failed, rollback"),H),H.code!==K.OPERATION_ABORTED&&this._numberOfJoinCount===u&&(this._gateway.state="DISCONNECTED",this._reset()),S.onError(H),H}var j}async _joinGateway(){if(!this._joinInfo||!this._key)throw new pe(K.INVALID_OPERATION);try{return await this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!W("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}catch(t){if(t.code===K.INIT_DATACHANNEL_TIMEOUT){if(this._gateway.leave(!0,Ut.FALLBACK),A.debug("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new pe(K.INVALID_OPERATION);return Ye.reportApiInvoke(this._sessionId,{name:Cn.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:hn.TRACER}).onSuccess(),await this._joinGateway()}throw t}}async leave(){A.info("[".concat(this._clientId,"] Leaving channel"));const t=()=>{!Pr()&&this.store.useDcSignal?(window.addEventListener("beforeunload",this._handleBeforeUnload),window.addEventListener("pagehide",this._handleBeforeUnload)):window.addEventListener(Pr()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(i){const a=th.indexOf(i);a!==-1&&th.splice(a,1)}(this),this._statsCollector.stopUpdateStats()};this.store.useDcSignal||t();const r=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return A.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void r();await this._gateway.leave(this.connectionState!=="CONNECTED",Ut.LEAVE),A.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),r(),this.store.useDcSignal&&t()}async publish(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(t)){if(!(t instanceof lm))return this._publishDataChannel(t);t=[t]}if(t.length===0)throw new pe(K.INVALID_PARAMS,"param list is empty");const i=t;if(this._gateway.role==="audience")throw new pe(K.INVALID_OPERATION,"audience can not publish stream");for(const l of i){if(!(l instanceof lm))throw new pe(K.INVALID_PARAMS,"parameter is not local track");if(!l._enabled&&r)throw new pe(K.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(l.getTrackId()))}A.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(i.map(l=>"".concat(l.getTrackId()," "))));const a=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),r&&i.forEach(l=>{const u=this._configDistribute.getBitrateLimit();l instanceof pn&&u&&l.setBitrateLimit(u.uplink)});try{await this._publishHighStream(i),A.info("[".concat(this._clientId,"] Publish success, id ").concat(i.map(l=>"".concat(l.getTrackId()," "))))}catch(l){throw A.error("[".concat(this._clientId,"] publish error"),l.toString()),l}finally{a()}}async _publishDataChannel(t){if(t==null)throw new pe(K.INVALID_PARAMS,"parameter is not local track or datachannel config, config is ".concat(JSON.stringify(t)));un(t.id,"id",0,65535,!0),qa(t.ordered,"ordered"),Wr(t.metadata,"metadata",0,512),A.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(t.id));const r=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(l=>l.id===t.id)!==-1)throw new pe(K.INVALID_PARAMS,"Invalid id: ".concat(t.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new pe(K.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&W("FORCE_TURN")&&!W("TURN_ENABLE_TCP")&&!W("TURN_ENABLE_UDP"))throw new pe(K.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const i=function(l){return Q8(l,!1)}(t),a=await this._p2pChannel.publishDataChannel([i]);if(a.length>0){if(typeof i._originDataChannelId!="number")throw A.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new pe(K.CREATE_DATACHANNEL_ERROR);try{await je.all(a.map(l=>this._uid&&this._gateway.publishDataChannel(this._uid,l,!0))),await i._waitTillOpen()}catch(l){if(l.code!==K.DISCONNECT_P2P)throw l}}return A.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(i.id)),i}catch(i){throw A.error("[".concat(this._clientId,"] publish datachannels error"),i.toString()),i}finally{r()}}async unpublish(t){if(!this._joinInfo||this._uid===void 0)throw new pe(K.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let r=[];if(t)if(Array.isArray(t))r=t;else{if(!(t instanceof lm))return this._unpublishDataChannel([t]);r=[t]}else this.store.useP2P||await this._unpublishDataChannel(),r=this._p2pChannel.getAllTracks(!0);A.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(r.map(a=>"".concat(a.getTrackId()," "))," "));const i=await this._publishMutex.lock();try{if(this.store.useP2P){const a=await this._p2pChannel.unpublish(r);a&&await this._gateway.sendExtensionMessage(Xn.UNPUBLISH,{unpubMsg:a},!0)}else{const a=await this._p2pChannel.unpublish(r);a&&await this._gateway.unpublish(a,this._uid),A.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(r.map(l=>"".concat(l.getTrackId()))))}}catch(a){throw A.error("[".concat(this._clientId,"] unpublish error"),a.toString()),a}finally{i&&i()}}async _unpublishDataChannel(t){t!==void 0&&t.length!==0||(t=this._p2pChannel.getAllDataChannels()),A.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(t.map(i=>"".concat(i.id," "))," "));const r=await this._publishMutex.lock();try{const i=await this._p2pChannel.unpublishDataChannel(t);i&&await this._gateway.unpublishDataChannel(i),A.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(t.map(a=>"".concat(a.id))))}catch(i){throw A.error("[".concat(this._clientId,"] unpublish dataChannel error"),i.toString()),i}finally{r&&r()}}async subscribe(t,r,i){if(!(t instanceof wd)){const a=this.remoteUsers.find(l=>l.uid===t);if(!a)throw new pe(K.INVALID_REMOTE_USER,"user is not in the channel");t=a}return r==="datachannel"?this._subscribeDataChannel(t,i):this._subscribe(t,r)}async presubscribe(t,r){if(Zn(r,"mediaType",["audio","video"]),this.store.useP2P)throw new pe(K.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new pe(K.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const i=r===ze.AUDIO,a=r===ze.VIDEO,l=await this._subscribeMutex.lock();try{const{ssrcId:u,ortc:p,rtxSsrcId:m,cname:g,uint_id:y}=await this._gateway.presubscribe(t,r,!0);if(u==null)throw new pe(K.UNEXPECTED_RESPONSE,"no ssrc id");let x=this._users.find(T=>T.uid===t);x||(x=new wd(t,y||t),x._is_pre_created=!0,this._users.push(x)),g&&(x._cname=g),x._uintid||(x._uintid=y||t),i&&(x._audioSSRC=u,x._audio_pre_subscribed=!0,p&&(x._audioOrtc=p)),a&&(x._videoSSRC=u,x._video_pre_subscribed=!0,p&&(x._videoOrtc=p),m!=null&&(x._rtxSsrcId=m)),A.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(u)),await this._p2pChannel.subscribe(x,r,u,m,p);const S=i?x._audioTrack:x._videoTrack;if(!S)throw new pe(K.UNEXPECTED_ERROR,"can not find remote track in user");return i&&(x._trust_audio_stream_added_state_=!0,x._audio_added_=!0),a&&(x._trust_video_stream_added_state_=!0,x._video_added_=!0),S}catch(u){throw A.error("[".concat(this._clientId,"] presub user ").concat(t," error"),u),u}finally{l()}}async _subscribeDataChannel(t,r){var i;if(un(r,"channelId",0,65535,!0),!this._joinInfo)throw new pe(K.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(m=>m===t))throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", this user is not in the channel")),new pe(K.INVALID_REMOTE_USER,"user is not in the channel");if(!t.hasAudio&&!t.hasVideo&&t._dataChannels.length===0)throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", user is not published")),new pe(K.INVALID_REMOTE_USER,"user is not published");const l=(i=t._dataChannels)===null||i===void 0?void 0:i.find(m=>m.id===r);if(!l)throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType datachannel, remote datachannel is not published")),new pe(K.REMOTE_USER_IS_NOT_PUBLISHED);const u=await this._subscribeMutex.lock();A.info("[".concat(this._clientId,"] subscribe user ").concat(t.uid,", mediaType: datachannel"));try{const m=await this._p2pChannel.subscribeDataChannel(t,[l]);if(m&&Ce(m).call(m,l.id))try{var p;if(typeof l._originDataChannelId!="number")throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType datachannel, cannot get RTCDatachannel")),new pe(K.CREATE_DATACHANNEL_ERROR);const g={id:l.id,datachannelId:l._originDataChannelId,ordered:l.ordered,maxRetransmits:l.maxRetransmits,metadata:(p=l.metadata)!==null&&p!==void 0?p:""};await this._gateway.subscribeDataChannel(t.uid,g,!0),await l._waitTillOpen()}catch(g){if((g==null?void 0:g.code)!==K.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(t,[l]),g;await this._p2pChannel.unsubscribeDataChannel(t,[l]),this._p2pChannel.setPendingRemoteDataChannel(t,l.id)}return A.info("[".concat(this._clientId,"] subscribe success user ").concat(t.uid,", mediaType: datachannel")),l}finally{u()}}async _p2pSubscribe(t,r,i){if(Zn(r,"mediaType",["audio","video"]),!this._joinInfo)throw new pe(K.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(u=>u===t)){const u=new pe(K.INVALID_REMOTE_USER,"user is not in the channel");throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", this user is not in the channel")),u}if(!t.hasAudio&&!t.hasVideo){const u=new pe(K.INVALID_REMOTE_USER,"user is not published");throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", user is not published")),u}if(!i&&(r==="audio"&&!t.hasAudio||r==="video"&&!t.hasVideo)){const u=new pe(K.REMOTE_USER_IS_NOT_PUBLISHED);throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType ").concat(r,", remote track is not published")),u}const l=await this._subscribeMutex.lock();A.info("[".concat(this._clientId,"] subscribe user ").concat(t.uid,", mediaType: ").concat(r));try{if(await this._p2pChannel.hasRemoteMediaWithLock(t,r))await this._p2pChannel.unmuteRemote(t,r);else try{const p=r==="audio"?t._audioSSRC:t._videoSSRC,m=r==="audio"?t._audioMid:t._videoMid;this.store.subscribe(t.uid,r,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(t,r,p,m)}catch(p){throw p}A.info("[".concat(this._clientId,"] subscribe success user ").concat(t.uid,", mediaType: ").concat(r)),this._defaultStreamFallbackType!==void 0&&this.setStreamFallbackOption(t.uid,this._defaultStreamFallbackType).catch(p=>{A.warning("[".concat(this._clientId,"] auto set fallback failed"),p)});const u=r==="audio"?t._audioTrack:t._videoTrack;if(!u)throw new pe(K.UNEXPECTED_ERROR,"can not find remote track in user object");return u}catch(u){throw A.error("[".concat(this._clientId,"] subscribe user ").concat(t.uid," error"),u),u}finally{l()}}async _subscribe(t,r,i){if(this.store.useP2P)return this._p2pSubscribe(t,r);if(Zn(r,"mediaType",["audio","video"]),!this._joinInfo)throw new pe(K.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(y=>y===t)){const y=new pe(K.INVALID_REMOTE_USER,"user is not in the channel");throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", this user is not in the channel")),y}if(!t.hasAudio&&!t.hasVideo){const y=new pe(K.INVALID_REMOTE_USER,"user is not published");throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", user is not published")),y}if(!(i||(r!=="audio"||t.hasAudio&&t._audioSSRC!==void 0)&&(r!=="video"||t.hasVideo&&t._videoSSRC!==void 0))){const y=new pe(K.REMOTE_USER_IS_NOT_PUBLISHED);throw A.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType ").concat(r,", remote track is not published")),y}let l=r==="audio"?t._audioSSRC:t._videoSSRC,u=r==="audio"?t._audioOrtc:t._videoOrtc,p=r==="video"?t._rtxSsrcId:void 0,m={stream_type:r==="audio"?ze.AUDIO:ze.VIDEO,ssrcId:l};r==="video"&&this.store.firstVideoFrameDecoded(t.uid,{subscribeStart:Date.now()});const g=await this._subscribeMutex.lock();A.info("[".concat(this._clientId,"] subscribe user ").concat(t.uid,", mediaType: ").concat(r));try{if(await this._p2pChannel.hasRemoteMediaWithLock(t,r))await this._p2pChannel.unmuteRemote(t,r);else try{const x=r==="audio"?t._audioSSRC:t._videoSSRC;x!==void 0&&x!==l&&(l=x,u=r==="audio"?t._audioOrtc:t._videoOrtc,p=r==="video"?t._rtxSsrcId:void 0,m={stream_type:r==="audio"?ze.AUDIO:ze.VIDEO,ssrcId:l}),ai.markSubscribeStart(this.store.clientId,l),this.store.subscribe(t.uid,r,Date.now()),await this._p2pChannel.subscribe(t,r,l,p,u);try{this._p2pChannel.isPreSubScribe(l)||await this._gateway.subscribe(t.uid,m,!0)}catch(S){if((S==null?void 0:S.code)!==K.WS_ABORT)throw await this._p2pChannel.unsubscribe(t,r),S;await this._p2pChannel.unsubscribe(t,r,!0),this._p2pChannel.setPendingRemoteMedia(t,r)}this.store.subscribe(t.uid,r,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,t,r)}catch(x){throw this._p2pChannel.reportSubscribeEvent(!1,x==null?void 0:x.code,t,r),x}A.info("[".concat(this._clientId,"] subscribe success user ").concat(t.uid,", mediaType: ").concat(r)),this._defaultStreamFallbackType!==void 0&&this.setStreamFallbackOption(t.uid,this._defaultStreamFallbackType).catch(x=>{A.warning("[".concat(this._clientId,"] auto set fallback failed"),x)});const y=r==="audio"?t._audioTrack:t._videoTrack;if(!y)throw new pe(K.UNEXPECTED_ERROR,"can not find remote track in user object");return r==="video"&&(this.store.firstVideoFrameDecoded(t.uid,{subscribeEnd:Date.now()}),this._p2pChannel.reportVideoFirstFrameRender(t)),y}catch(y){throw A.error("[".concat(this._clientId,"] subscribe user ").concat(t.uid," error"),y),y}finally{g()}}async massSubscribe(t){if(hl(t,"subscribeList"),!this._joinInfo)throw new pe(K.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const r=Date.now(),i=new Map,a=await this._subscribeMutex.lock();A.info("[".concat(this._clientId,"]start massSubscribe user ").concat(t.map(m=>{let{user:g,mediaType:y}=m;return"user: ".concat(g==null?void 0:g.uid,", mediaType: ").concat(y)}).join("; ")));const l=(t=[...t]).map(m=>{let{user:g,mediaType:y}=m;return{user:g,mediaType:y}}),u=await this._p2pChannel.globalLock();try{var p;for(let g=t.length-1;g>=0;g--){const y=t[g],{user:x,mediaType:S}=y;if(Zn(S,"mediaType",["audio","video"]),!x){const j=new pe(K.INVALID_PARAMS,"user property does not exist in subscribeList item");throw A.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),j}if(!this._users.find(j=>j===x)){const j=new pe(K.INVALID_REMOTE_USER,"user is not in the channel");A.error("[".concat(this._clientId,"] can not massSubscribe ").concat(x.uid,", this user is not in the channel")),l[g].error=j,t.splice(g,1);continue}if(S==="audio"&&(!x.hasAudio||x._audioSSRC===void 0)||S==="video"&&(!x.hasVideo||x._videoSSRC===void 0)){const j=new pe(K.REMOTE_USER_IS_NOT_PUBLISHED);A.error("[".concat(this._clientId,"] can not subscribe ").concat(x.uid," with mediaType ").concat(S,", remote user is not published")),l[g].error=j,t.splice(g,1);continue}const C=Sr.Video|Sr.LwoVideo,V=i.get(x);if(V){if(S==="video"?V&C:V&Sr.Audio){t.splice(g,1),A.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(x.uid,", mediaType:").concat(S," twice"));continue}i.set(x,V|(S==="video"?C:Sr.Audio))}else i.set(x,S==="video"?C:Sr.Audio)}for(let g=t.length-1;g>=0;g--){const y=t[g],{user:x,mediaType:S}=y,T=Sr.Video|Sr.LwoVideo;if(this._p2pChannel.hasRemoteMedia(x,S)){await this._p2pChannel.unmuteRemoteNoLock(x,S);const C=i.get(x);i.set(x,S==="video"?C^T:C^Sr.Audio),t.splice(g,1)}}this.store.massSubscribe(t.map(g=>({userId:g.user.uid,type:g.mediaType})),r);let m=pa(p=Array.from(i.entries())).call(p,(g,y)=>{let[x,S]=y;if(S===0)return g;const T={stream_id:x.uid,stream_type:S};return S&Sr.Audio&&(T.audio_ssrc=x._audioSSRC),S&Sr.Video&&(T.video_ssrc=x._videoSSRC),g.push(T),g},[]);try{t.length>0&&await this._p2pChannel.massSubscribeNoLock(t.map(y=>{let{user:x,mediaType:S}=y;return{user:x,mediaType:S,ssrcId:S===ze.VIDEO?x._videoSSRC:x._audioSSRC,rtxSsrcId:S===ze.VIDEO?x._rtxSsrcId:void 0}}));const g=new Map;if(m=m.filter(y=>y.video_ssrc&&!this._p2pChannel.isPreSubScribe(y.video_ssrc)||y.audio_ssrc&&!this._p2pChannel.isPreSubScribe(y.audio_ssrc)||!y.video_ssrc&&!y.audio_ssrc),m.length>0){const y=await this._gateway.subscribeAll(m,!0);((y==null?void 0:y.users)||[]).forEach(x=>{let{stream_id:S,video_error_code:T,audio_error_code:C,error_code:V}=x;(T||C||V)&&g.set(S,{video_error_code:T,audio_error_code:C,error_code:V})})}if(Array.from(g.entries()).length>0){const y=[];Array.from(g.entries()).forEach(x=>{let[S,T]=x;const C=this.remoteUsers.find(V=>V.uid===S);if(C){let V;T.error_code||T.video_error_code&&T.audio_error_code?V=void 0:T.video_error_code?V=ze.VIDEO:T.audio_error_code&&(V=ze.AUDIO),y.push({user:C,mediaType:V})}}),y.length>0&&await this._p2pChannel.massUnsubscribeNoLock(y)}for(const y of l){const x=g.get(y.user.uid);if(x){const S=x.error_code||y.mediaType==="audio"&&x.audio_error_code||y.mediaType==="video"&&x.video_error_code;if(S){const T=ih(S);A.error("user:".concat(y.user.uid," mediaType:").concat(y.mediaType," has massSubscribe error ").concat(T.desc)),y.error=new pe(K.SUBSCRIBE_FAILED,"code ".concat(S,": ").concat(T.desc))}}y.error||(y.mediaType==="video"?y.track=y.user.videoTrack:y.track=y.user.audioTrack)}return this.store.massSubscribe(l.filter(y=>!y.error).map(y=>({userId:y.user.uid,type:y.mediaType})),void 0,Date.now()),l.forEach(y=>{var x;Ye.subscribe(this.store.sessionId,{succ:!!y.error,ec:((x=y.error)===null||x===void 0?void 0:x.code)||null,video:y.mediaType===ze.VIDEO,audio:y.mediaType===ze.AUDIO,peerid:y.user.uid,subscribeRequestid:y.mediaType===ze.VIDEO?y.user._videoSSRC:y.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-r),preSsrc:this._p2pChannel.isPreSubScribe(y.user._videoSSRC)},!0)}),A.info("[".concat(this._clientId,"] massSubscribe success ").concat(t.map(y=>{let{user:x,mediaType:S}=y;return"user: ".concat(x==null?void 0:x.uid,", mediaType: ").concat(S)}).join("; "))),l}catch(g){throw await this._p2pChannel.massUnsubscribeNoLock(t),g}}finally{u(),a()}}async unsubscribe(t,r,i){if(!(t instanceof wd)){const u=this.remoteUsers.find(p=>p.uid===t);if(!u)throw new pe(K.INVALID_REMOTE_USER,"user is not in the channel");t=u}if(r||this.store.useP2P){if(r==="datachannel")return this._unsubscribeDataChannel(t,i)}else await this._unsubscribeDataChannel(t,i);if(r&&Zn(r,"mediaType",["audio","video"]),!this._joinInfo)throw new pe(K.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(u=>u===t)){const u=new pe(K.INVALID_REMOTE_USER,"user is not in the channel");throw A.error("[".concat(this._clientId,"] can not unsubscribe ").concat(t.uid,", user is not in the channel")),u}A.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(t.uid,", mediaType: ").concat(r));const l=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(t,r);else{const u=await this._p2pChannel.unsubscribe(t,r);u&&await this._gateway.unsubscribe(u,t.uid),r&&r!=="audio"||(t._audio_pre_subscribed=!1),r&&r!=="video"||(t._video_pre_subscribed=!1),t._is_pre_created&&Kx(this._users,t),A.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(t.uid,", mediaType: ").concat(r))}}catch(u){if(u.code===K.DISCONNECT_P2P)return void A.warning("disconnecting p2p, abort unsubscribe request.");throw A.error("[".concat(this._clientId,"] unsubscribe user ").concat(t.uid," error"),u.toString()),u}finally{l()}}async _unsubscribeDataChannel(t,r){if(r&&un(r,"id",0,65535,!0),!this._joinInfo)throw new pe(K.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(l=>l===t)){const l=new pe(K.INVALID_REMOTE_USER,"user is not in the channel");throw A.error("[".concat(this._clientId,"] can not unsubscribe ").concat(t.uid,", user is not in the channel")),l}let a;if(typeof r=="number"){const l=t._dataChannels.find(u=>u.id===r);l&&(a=[l])}else a=t._dataChannels;if(a===void 0){const l=new pe(K.REMOTE_USER_IS_NOT_PUBLISHED);throw A.error("[".concat(this._clientId,"] can not unsubscribe ").concat(t.uid," with channelId ").concat(r,", remote datachannel is not published")),l}A.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(t.uid,", mediaType: datachannel, ids: ").concat(a.map(l=>l.id)));try{const l=await this._p2pChannel.unsubscribeDataChannel(t,a);l&&await this._gateway.unsubscribeDataChannel(l,t.uid),A.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(t.uid,", mediaType: datachannel, ids: ").concat(l))}catch(l){if(l.code===K.DISCONNECT_P2P)return void A.warning("disconnecting p2p, abort unsubscribe request.");throw A.error("[".concat(this._clientId,"] unsubscribe user ").concat(t.uid," error"),l.toString()),l}}async massUnsubscribe(t){if(hl(t,"unsubscribeList"),!this._joinInfo)throw new pe(K.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");A.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(t.map(i=>{let{user:a,mediaType:l}=i;return"user: ".concat(a==null?void 0:a.uid,", mediaType: ").concat(l,";")}).join())),t=[...t];const r=new Map;for(let i=t.length-1;i>=0;i--){const{user:a,mediaType:l}=t[i];if(!a){const m=new pe(K.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw A.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),m}if(Zn(l,"mediaType",["video","audio",void 0]),!this._users.find(m=>m===a)){A.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(a.uid,", user is not in the channel")),t.splice(i,1);continue}const p=Sr.Video|Sr.LwoVideo;if(r.has(a)){const m=r.get(a);let g;switch(l){case"video":g=m&p;break;case"audio":g=m&Sr.Audio;break;default:g=m&(Sr.Audio|p)}if(g){A.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(a.uid,",mediaType:").concat(l," twice.")),t.splice(i,1);continue}l?l==="audio"?r.set(a,m|Sr.Audio):l==="video"&&r.set(a,m|p):r.set(a,m|Sr.Audio|p)}else l?l==="audio"?r.set(a,Sr.Audio):l==="video"&&r.set(a,p):r.set(a,Sr.Audio|p)}try{const i=await this._p2pChannel.massUnsubscribe(t);i&&await this._gateway.massUnsubscribe(i),A.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(t.map(a=>{let{user:l,mediaType:u}=a;return"user: ".concat(l==null?void 0:l.uid,", mediaType: ").concat(u,";")}).join()))}catch(i){if(i.code===K.DISCONNECT_P2P)return void A.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw A.error("[".concat(this._clientId,"] massUnsubscribe error"),i.toString()),i}}async setLowStreamParameter(t){(function(i){if(!i)throw new ge(K.INVALID_PARAMS);Mn(i.width)||vA(i.width,"streamParameter.width"),Mn(i.height)||vA(i.height,"streamParameter.height"),Mn(i.framerate)||vA(i.framerate,"streamParameter.framerate"),Mn(i.bitrate)||un(i.bitrate,"streamParameter.bitrate")})(t),(!t.width&&t.height||t.width&&!t.height)&&A.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),A.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(t));const r=this._configDistribute.getLowStreamConfigDistribute();if(r&&r.bitrate&&t.bitrate&&r.bitrate<t.bitrate&&(t.bitrate=r.bitrate),this._lowStreamParameter=t,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(t,Re.LocalVideoLowTrack)}async setDualStreamMode(t,r){Zn(t,"mode",[0,1,-1]);try{switch(r&&await this.setLowStreamParameter(r),this._dualStreamMode=t,this._joinInfo?this._gateway.setDualStreamMode(t).catch(i=>{A.warning("[".concat(this._clientId,"] set dual stream mode failed"),i.toString())}):A.debug("[".concat(this._clientId,"] haven't joined yet, cache dual stream mode ").concat(t)),t){case Qp.AUTO_SIMULCAST_STREAM:A.info("[".concat(this._clientId,"] set dual stream mode to ").concat(t));break;case Qp.DISABLE_SIMULCAST_STREM:return this.disableDualStream();case Qp.ENABLE_SIMULCAST_STREAM:return this.enableDualStream()}}catch(i){throw A.error("[".concat(this._clientId,"] set dual stream mode error"),i.toString()),i}}async enableDualStream(){if(!jt().supportDualStream)throw Ye.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new pe(K.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new pe(K.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(t){throw Ye.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),t}this._isDualStreamEnabled=!0,this._dualStreamMode=Qp.ENABLE_SIMULCAST_STREAM,this._joinInfo&&this._gateway.setDualStreamMode(this._dualStreamMode,!0,!0).catch(t=>{A.debug("[".concat(this._clientId,"] try to inform gateway to set dual stream mode to ").concat(this._dualStreamMode," ,but failed"),t.toString())}),Ye.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),A.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)return this._isDualStreamEnabled=!1,void A.info("[".concat(this._clientId,"] disable dual stream before join"));if(this._p2pChannel.getLocalMedia(Re.LocalVideoLowTrack))try{const t=await this._p2pChannel.unpublishLowStream();t&&await this._gateway.unpublish(t,this._joinInfo.stringUid||this._joinInfo.uid)}catch(t){throw Ye.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),t}this._isDualStreamEnabled=!1,this._dualStreamMode=Qp.DISABLE_SIMULCAST_STREM,this._joinInfo&&this._gateway.setDualStreamMode(this._dualStreamMode,!0,!0).catch(t=>{A.debug("[".concat(this._clientId,"] try to inform gateway to set dual stream mode to ").concat(this._dualStreamMode," ,but failed"),t.toString())}),Ye.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),A.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(t,r){if(function(a){Zn(a,"role",["audience","host"])}(t),r&&_A(r),this.mode==="rtc"||this.mode==="p2p")throw A.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new pe(K.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(r&&r.level&&t==="host")throw new pe(K.INVALID_OPERATION,"host mode can not set audience latency level");if(t==="audience"&&this._p2pChannel.hasLocalMedia())throw new pe(K.INVALID_OPERATION,"can not set client role to audience when publishing stream");const i=this._config.role;if(this._joinInfo&&(this._joinInfo.role=t),t!==i&&W("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(t,r),this._config.role=t,this._gateway.reconnect("recover",Qr.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(t,r),this._config.role=t),A.info("[".concat(this._clientId,"] set client role to ").concat(t,", level: ").concat(r&&r.level)),i==="audience"&&t!=="audience"&&this._pendingRtpCapabilityChange&&this._p2pChannel instanceof ch){const{video_codec:a}=this._pendingRtpCapabilityChange;this._p2pChannel.updateRemoteRTPCapabilities(a.map(l=>l.toLowerCase()).filter(l=>{var u;return Ce(u=Object.keys(Yu)).call(u,l)}))}}async _setClientRoleOptions(t){if(this.mode==="rtc"||this.mode==="p2p"||this._config.role!=="audience"||this._p2pChannel.hasLocalMedia())return;let r=!1;try{t&&_A(t),await this._gateway.setClientRole(this._config.role,t),r=!0}catch{}finally{A.info("[".concat(this._clientId,"] set client role options ").concat(r?"succeed":"failed",", options is ").concat(t))}}getRemoteInboundOffset(){var t;const r=(t=this._p2pChannel.getStats())===null||t===void 0?void 0:t.audioSend[0];if(!r||!r.timestamp)return 0;const i=r.timestamp-Date.now();return Math.abs(i)>1e3+r.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?i:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(t,r){if(Wr(t,"proxyServer"),!r){if(this.connectionState!=="DISCONNECTED")throw new pe(K.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new pe(K.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=t,Ye.setProxyServer(this._proxyServer),A.setProxyServer(this._proxyServer),A.info("[".concat(this._clientId,"] Set proxy server ").concat(r?"by initialize call":""," success."))}setTurnServer(t,r){if(Array.isArray(t)||(t=[t]),!r){if(this.connectionState!=="DISCONNECTED")throw new pe(K.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new pe(K.INVALID_OPERATION,"You have already set the proxy")}if(Bu(t))return this._turnServer={servers:t,mode:"original-manual"},void A.info("[".concat(this._clientId,"] Set original turnserver ").concat(r?"by initialize call":""," success: ").concat(t.map(i=>i.urls).join(","),"."));t.forEach(i=>SV(i)),this._turnServer={servers:t,mode:"manual"},A.info("[".concat(this._clientId,"] Set turnserver ").concat(r?"by initialize call":""," success."))}setLicense(t){if(this.connectionState!=="DISCONNECTED")throw new pe(K.INVALID_OPERATION,"you should set license before join channel");if(Wr(t,"license",32,32),!/^[A-Za-z\d]+$/.test(t))throw new pe(K.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=t,A.info("[".concat(this._clientId,"] set license success"),t)}startProxyServer(t){if(this.connectionState!=="DISCONNECTED")throw new pe(K.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new pe(K.INVALID_OPERATION,"You have already set the proxy");const r=[3,4,5];let i;switch(t===void 0&&(t=3),t){case 1:case 2:throw new pe(K.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:i="proxy3";break;case 4:i="proxy4";break;case 5:i="proxy5";break;default:throw new pe(K.INVALID_PARAMS,"proxy server mode must be ".concat(r.join("|")))}this._cloudProxyServerMode=i,this.store.cloudProxyServerMode=i,A.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new pe(K.INVALID_OPERATION,"Stop proxy server after leave channel");Ye.setProxyServer(),A.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",A.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(t){if(!t.accessPoints)throw new pe(K.INVALID_PARAMS,"accessPoints is required.");hl(t.accessPoints.serverList,"accessPoints.serverList"),Wr(t.accessPoints.domain,"accessPoints.domain");const r=(T,C)=>{un(T,C,0,65535,!0)};let i=443;if(t.accessPoints.port&&(r(t.accessPoints.port,"accessPoints.port"),i=t.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new pe(K.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");W("CLOSE_AFB_FOR_LOCAL_AP")&&(cn("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),cn("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const a=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,l=t.accessPoints.domain,u=t.accessPoints.serverList.map(T=>a.test(T)?"".concat(T.replace(/\./g,"-"),".").concat(l):T),p=u.map(T=>"".concat(T,":").concat(i));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,cn("WEBCS_DOMAIN",p),cn("WEBCS_DOMAIN_BACKUP_LIST",p),cn("GATEWAY_DOMAINS",[l]),t.report&&t.report.hostname&&Array.isArray(t.report.hostname)&&t.report.hostname.length?(hl(t.report.hostname,"report.hostname"),cn("EVENT_REPORT_DOMAIN",t.report.hostname[0]),cn("EVENT_REPORT_BACKUP_DOMAIN",t.report.hostname[1]||t.report.hostname[0])):(cn("EVENT_REPORT_DOMAIN",u[0]),cn("EVENT_REPORT_BACKUP_DOMAIN",u[1]||u[0]));let m=6443;t.report&&t.report.port&&(r(t.report.port,"report.port"),m=t.report.port),cn("STATS_COLLECTOR_PORT",m),t.report?cn("ENABLE_EVENT_REPORT",!0):cn("ENABLE_EVENT_REPORT",!1);let g="";t.log&&t.log.hostname&&Array.isArray(t.log.hostname)&&t.log.hostname.length?(hl(t.log.hostname,"log.hostname"),g=t.log.hostname[0]):g=u[0];let y=6444;t.log&&t.log.port&&(r(t.log.port,"log.port"),y=t.log.port),cn("LOG_UPLOAD_SERVER","".concat(g,":").concat(y));let x=[];t.cds&&t.cds.hostname&&Array.isArray(t.cds.hostname)&&t.cds.hostname.length?(hl(t.cds.hostname,"cds.hostname"),x=t.cds.hostname):x=u;let S=443;t.cds&&t.cds.port&&(r(t.cds.port,"cds.port"),S=t.cds.port),cn("CDS_AP",x.map(T=>"".concat(T,":").concat(S))),t.cds?cn("ENABLE_CONFIG_DISTRIBUTE",!0):cn("ENABLE_CONFIG_DISTRIBUTE",!1),A.info("set local access point v2 success")}setLocalAccessPoints(t,r){if(hl(t,"serverList"),Wr(r,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new pe(K.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const i=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;t=t.map(a=>i.test(a)?"".concat(a.replace(/\./g,"-"),".").concat(r):a),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,cn("WEBCS_DOMAIN",t),cn("WEBCS_DOMAIN_BACKUP_LIST",t),cn("GATEWAY_DOMAINS",[r]),cn("EVENT_REPORT_DOMAIN",t[0]),cn("EVENT_REPORT_BACKUP_DOMAIN",t[1]||t[0]),cn("LOG_UPLOAD_SERVER","".concat(t[0],":6444")),A.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(t){if(Zn(t,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=t,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(t),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(r){throw A.error("[".concat(this._clientId,"] set default remote video stream type error"),r.toString()),r}else A.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(t))}async setRemoteVideoStreamType(t,r){Zn(r,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(t,r),setTimeout(()=>{const i=this._users.find(a=>a.uid===t);i&&i.videoTrack&&i.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(i){throw A.error("[".concat(this._clientId,"] set remote video stream type error"),i.toString()),i}A.info("[".concat(this._clientId,"] set remote ").concat(t," video stream type to ").concat(r)),this._remoteStreamTypeCacheMap.set(t,r)}async setStreamFallbackOption(t,r){Zn(r,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(t,r)}catch(i){throw A.error("[".concat(this._clientId,"] set stream fallback option"),i.toString()),i}A.info("[".concat(this._clientId,"] set remote ").concat(t," stream fallback type to ").concat(r)),this._streamFallbackTypeCacheMap.set(t,r)}setEncryptionConfig(t,r,i,a){(function(u){Zn(u,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(t),Wr(r,"secret");const l=["aes-128-gcm2","aes-256-gcm2"];if(Ce(l).call(l,t)){if(!i||!(i instanceof Uint8Array&&i.length===32))throw new pe(K.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(i)throw new pe(K.INVALID_PARAMS,"current encrypt mode does not need salt");if(a){if(qa(a,"encryptDataStream"),!Ce(l).call(l,t))throw new pe(K.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(r)||A.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=t,this._encryptionSecret=r,i&&(this._encryptionSalt=gd(i))}async renewToken(t){if(Wr(t,"token",1,2047),!this._key||!this._joinInfo)throw new pe(K.INVALID_OPERATION,"renewToken should not be called before user join");const r=this._key;this._key=t,this._joinInfo&&(this._joinInfo.token=t);const i=await this._renewTokenMutex.lock();try{if(W("USE_NEW_TOKEN")){A.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const a=await Mve(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||er);A.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:t,ticket:a})}else A.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:t});A.debug("[".concat(this._clientId,"] renewToken success"))}catch(a){throw this._key=r,this._joinInfo.token=r,A.error("[".concat(this._clientId,"] renewToken failed"),a.toString()),a}finally{i()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?A.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const t=this._p2pChannel.getAudioLevels();this.safeEmit(Ot.VOLUME_INDICATOR,t)},W("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const t=this._statsCollector.getRTCStats(),r=this._gateway.getInChannelInfo();return t.Duration=Math.round(r.duration/1e3),t}async startLiveStreaming(t,r){if(!r){if(this.codec!=="h264")throw new pe(K.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new pe(K.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(t)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(t))throw new pe(K.LIVE_STREAMING_TASK_CONFLICT);const i=r?ml.TRANSCODE:ml.RAW;return this._createLiveStreamingClient(i).startLiveStreamingTask(t,i)}setLiveTranscoding(t){return this._createLiveStreamingClient(ml.TRANSCODE).setTranscodingConfig(t)}async stopLiveStreaming(t){const r=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(i=>i&&i.hasUrl(t));if(!r.length)throw new pe(K.INVALID_PARAMS,"can not find live streaming url to stop");await je.all(r.map(i=>i&&i.stopLiveStreamingTask(t)))}async startChannelMediaRelay(t){mG(t),await this._createChannelMediaRelayClient().startChannelMediaRelay(t)}async updateChannelMediaRelay(t){mG(t),await this._createChannelMediaRelayClient().updateChannelMediaRelay(t)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(t){this._p2pChannel instanceof ch&&this._p2pChannel.addAudioMetadata(t)}async sendStreamMessage(t){var r;let i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new pe(K.INVALID_OPERATION,"can not send data stream, not joined");if((typeof t=="string"||t instanceof Uint8Array)&&(t={payload:t}),typeof t.payload=="string"){const l=new TextEncoder;t.payload=l.encode(t.payload)}let a=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Ce(r=["aes-128-gcm2","aes-256-gcm2"]).call(r,this._encryptionMode)&&(a=!0,t.payload=await async function(l,u,p){var m;const g=pa(m=Array.from(p)).call(m,(j,L)=>j+L,0),y={serverTs:0,seq:a0e++,length:p.length,checkSum:g},x=new Uint8Array(kV(g,2)),S=new ArrayBuffer(im),T=new DataView(S);T.setUint32(0,y.serverTs),T.setUint16(4,y.seq),T.setUint16(6,y.length),T.setUint16(8,y.checkSum);const C=16-p.length%16;p=RV(p,new Uint8Array(C));const V=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:l,tagLength:zV,additionalData:x},u,p);return RV(new Uint8Array(S),new Uint8Array(V))}(this._encryptDataStreamIv,this._encryptDataStreamKey,t.payload)),new Blob([t.payload]).size>1024)throw new pe(K.INVALID_PARAMS,a?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(nt.DATA_STREAM,{payload:gd(t.payload),syncWithAudio:t.syncWithAudio,sendTs:Date.now()-Hve},!i)}sendMetadata(t){if(!this._joinInfo)throw new pe(K.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([t]).size>1024)throw new pe(K.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(nt.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:gd(t)})}async sendCustomReportMessage(t){if(Array.isArray(t)||(t=[t]),t.forEach(f0e),!this._joinInfo)throw new pe(K.INVALID_OPERATION,"can not send custom report, not joined");await Ye.sendCustomReportMessage(this._joinInfo.sid,t)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){const t=this._statsCollector.getRemoteNetworkQualityStats();if(W("DELETE_NEQ_AFTER_USER_LEAVE")){const r=this._users.map(i=>i.uid+"");Object.keys(t).forEach(i=>{Ce(r).call(r,i)||delete t[i]})}return t}getNetworkQuality(){return this._statsCollector.getNetworkQuality()}async pickSVCLayer(t,r){Zn(r.spatialLayer,"spatialLayer",[0,1,2,3]),Zn(r.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(t,r)}catch(i){throw A.error("[".concat(this._clientId,"] pick SVC layer failed"),i.toString()),i}}async setRTMConfig(t){const{apRTM:r=!1,rtmFlag:i}=t;if(qa(r,"apRTM"),un(i,"rtmFlag",0),this._rtmConfig.apRTM=r,this._rtmConfig.rtmFlag=i,A.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(t)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=r,this._joinInfo.rtmFlag=i,this._gateway.setRTM2Flag(i)}_reset(){if(A.debug("[".concat(this._clientId,"] reset client")),function(t){const r=fm.indexOf(t);r!==-1&&fm.splice(r,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this.store.autoSubscribe=!1,this._pendingRtpCapabilityChange=void 0,this._axiosCancelSource.cancel(),this._axiosCancelSource=zi.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&BG(this._joinInfo),this._rteDetailInterval&&(window.clearInterval(this._rteDetailInterval),this._rteDetailInterval=void 0,this._sessionId&&Ye.reportRteDetail(this._sessionId)),this._fallbackServerInfo=void 0,this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&Ye.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this.store.resetFirstVideoFrameDecoded(),this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(t=>{t._audioTrack&&t._audioTrack._destroy(),t._videoTrack&&t._videoTrack._destroy(),t._dataChannels&&(t._dataChannels.forEach(r=>r._close()),t._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new kr("client-publish",this._clientId),this._subscribeMutex=new kr("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(t,r){var i;const a=t||Hu();t?A.debug("[".concat(this._clientId,"] new Session ").concat(a)):A.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(a));const l=t?"":this._sessionId||"";this._sessionId=a,this.store.sessionId=a,Ye.addSid(a);const u={lts:new Date().getTime(),mode:this.mode,buildFormat:1,stringUid:(r==null?void 0:r.stringUid)||((i=this._joinInfo)===null||i===void 0?void 0:i.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:l,clientRole:this.role==="audience"?2:1,rteUrl:this.store.rteUrl,rteSid:this.store.rteSid};Ye.sessionInit(this._sessionId,so({cname:r.channel,appid:r.appId},u)),this._joinInfo&&(this._joinInfo.sid=a),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=a)}async _publishHighStream(t){if(!this._joinInfo||this._uid===void 0)throw new pe(K.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&W("FORCE_TURN")&&!W("TURN_ENABLE_TCP")&&!W("TURN_ENABLE_UDP"))throw new pe(K.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");A.debug("[".concat(this._clientId,"] publish high stream"));try{const i=await this._p2pChannel.publish(t,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){const a=(await i.next()).value;if(a){try{await this._gateway.sendExtensionMessage(Xn.PUBLISH,a,!0)}catch(l){throw i.throw(l),l}await i.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const a=(await i.next()).value;if(a){var r;let l;try{l=await this._gateway.publish(this._uid,a,!0)}catch(u){if(u.code!==K.DISCONNECT_P2P)throw i.throw(u),u}await i.next(((r=l)===null||r===void 0?void 0:r.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const l of t)l instanceof pn&&l._encoderConfig&&this._gateway.setVideoProfile(l._encoderConfig).catch(u=>{A.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))}),!l.muted&&l.enabled||await this._p2pChannel.muteLocalTrack(l)}}catch(i){if(this._p2pChannel.reportPublishEvent(!1,i==null?void 0:i.code,t),(i==null?void 0:i.code)===K.WS_ABORT)return;throw i}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new pe(K.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(K.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));A.debug("[".concat(this._clientId,"] publish low stream"));const t=this._configDistribute.getLowStreamConfigDistribute();t&&t.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&t.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=t.bitrate));try{const i=await this._p2pChannel.publishLowStream(this._lowStreamParameter),a=(await i.next()).value;if(a){var r;let l;try{l=await this._gateway.publish(this._uid,a,!0)}catch(u){if(u.code!==K.DISCONNECT_P2P)throw i.throw(u),u}i.next(((r=l)===null||r===void 0?void 0:r.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(i){if(this._p2pChannel.reportPublishEvent(!1,i==null?void 0:i.code,void 0,!0),(i==null?void 0:i.code)===K.WS_ABORT)return;throw i}}_createLiveStreamingClient(t){const r=()=>{if(!this._joinInfo||!this._appId)return new pe(K.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const i=(a={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},Wo("LiveStreaming").create(a));var a;return i.onLiveStreamError=(l,u)=>{Ye.reportApiInvoke(this._sessionId,{name:Cn.ON_LIVE_STREAM_ERROR,options:[l,u],tag:hn.TRACER}).onSuccess(),this.safeEmit(Ot.LIVE_STREAMING_ERROR,l,u)},i.onLiveStreamWarning=(l,u)=>{Ye.reportApiInvoke(this._sessionId,{name:Cn.ON_LIVE_STREAM_WARNING,options:[l,u],tag:hn.TRACER}).onSuccess(),this.safeEmit(Ot.LIVE_STREAMING_WARNING,l,u)},i.on(y1.REQUEST_WORKER_MANAGER_LIST,(l,u,p)=>{if(!this._joinInfo)return p(new pe(K.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(m,g,y,x){const S=W("UAP_AP").slice(0,W("AJAX_REQUEST_CONCURRENT")).map(T=>g.proxyServer?"https://".concat(g.proxyServer,"/ap/?url=").concat(T+"/api/v1?action=uap"):"https://".concat(T,"/api/v1?action=uap"));return await Ive(S,m,g,y,x)})(l,this._joinInfo,this._axiosCancelSource.token,er).then(u).catch(p)}),i};return t===ml.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||r(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||r(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new pe(K.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:r,sendResolutionHeight:i}=this.getLocalVideoStats(),a=(t={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:r,height:i}},Wo("ChannelMediaRelay").create(t));a.on("state",l=>{l===ls.RELAY_STATE_FAILURE&&a&&a.dispose(),this.safeEmit(Ot.CHANNEL_MEDIA_RELAY_STATE,l)}),a.on("event",l=>{this.safeEmit(Ot.CHANNEL_MEDIA_RELAY_EVENT,l)}),this._channelMediaRelayClient=a,this._statsCollector.onStatsChanged=(l,u)=>{var p;l==="resolution"&&((p=this._channelMediaRelayClient)===null||p===void 0||p.setVideoProfile(u))}}var t;return this._channelMediaRelayClient}_handleUpdateDataChannel(t,r){const{added:i,deleted:a}=t,l=[];if(r){const u=[];this._users.forEach(p=>{p._dataChannels.forEach(m=>{i.every(g=>g.uid!==p._uintid||g.stream_id!==m.id)&&u.push({uid:p._uintid,stream_id:m.id,ordered:m.ordered,max_retrans_times:m.maxRetransmits,metadata:m.metadata})})}),u.length>0&&this._handleUpdateDataChannel({added:[],deleted:u})}Array.isArray(i)&&i.length>0&&i.forEach(u=>{const{uid:p,stream_id:m,ordered:g,max_retrans_times:y,metadata:x}=u,S=this._users.find(T=>T._uintid===p);if(!S)return void A.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(A.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(p)),Ce(l).call(l,S)||l.push(S),S._uintid||(S._uintid=p),S._dataChannels.findIndex(T=>T.id===u.stream_id)===-1){const T={id:m,ordered:!!g,maxRetransmits:y,metadata:x},C=function(V){return Q8(V,!0)}(T);S._dataChannels.push(C),A.info("[".concat(this._clientId,"] remote user ").concat(S.uid," published datachannel")),r||this.safeEmit(Ot.USER_PUBLISHED,S,"datachannel",T)}this._p2pChannel.hasPendingRemoteDataChannel(S,u.stream_id)&&(A.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(S.uid," after reconnect.")),this._subscribeDataChannel(S,u.stream_id).catch(T=>{A.error("[".concat(this._clientId,"] resubscribe datachannel error"),T.toString())}))}),r&&(this.safeEmit(Ot.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(a)&&a.length>0&&a.forEach(u=>{const{uid:p,stream_id:m}=u,g=this._users.find(x=>x._uintid===p);if(!g)return void A.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const y=g._dataChannels.find(x=>x.id===u.stream_id);y&&(A.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(p)),this._p2pChannel.unsubscribeDataChannel(g,[y]).then(x=>{if(g._dataChannels=g._dataChannels.filter(S=>S!==y),x)return this._gateway.unsubscribeDataChannel(x,g.uid)}),A.info("[".concat(this._clientId,"] remote user ").concat(p," unpublished datachannel ,id:").concat(y.id)),this.safeEmit(Ot.USER_UNPUBLISHED,g,"datachannel",y._config))})}_getEncodingName(t){var r,i;if(!this._joinResponse)return;const a=(r=this._joinResponse.ortc.rtpCapabilities.sendrecv)===null||r===void 0?void 0:r.videoCodecs;if(!a)return;for(const m of a){var l;if(m.payloadType===t)return m==null||(l=m.rtpMap)===null||l===void 0?void 0:l.encodingName}const u=(i=this._joinResponse.ortc.rtpCapabilities.recv)===null||i===void 0?void 0:i.videoCodecs;if(u)for(const m of u){var p;if(m.payloadType===t)return m==null||(p=m.rtpMap)===null||p===void 0?void 0:p.encodingName}return t===0?"unknown":void 0}_handleRemoveDataChannels(t){const r=this._users.find(i=>i.uid===t.uid);if(r){if(r._dataChannels!==void 0&&r._dataChannels.length>0){A.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(t.uid));const i=()=>{A.info("[".concat(this._clientId,"] remote user ").concat(r.uid," unpublished datachannel")),r._dataChannels.forEach(a=>{this.safeEmit(Ot.USER_UNPUBLISHED,r,"datachannel",a._config)})};this._p2pChannel.unsubscribeDataChannel(r,r._dataChannels).then(a=>{if(a)return this._gateway.unsubscribeDataChannel(a,r.uid)}),i()}}else A.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(qn.UPDATE_GATEWAY_CONFIG,()=>{(function(){let t;try{t=window.localStorage.getItem("websdk_ng_global_parameter")}catch(r){return void A.error("Error loading sdk config",r.message)}if(t)try{const r=JSON.parse(window.atob(t)),i=Date.now();Object.keys(r).forEach(a=>{const{value:l,type:u,expires:p}=r[a];p&&p<=i||u||u1()||!Object.prototype.hasOwnProperty.call(e_,a)||($s[a]=l,nn[a]=l,A.debug("Update gateway parameters from config distribute",a,l))})}catch(r){A.error("Error update config from local cache",r.message)}})()}),this._gateway.on(qn.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(qn.CONNECTION_STATE_CHANGE,(t,r,i)=>{var a;if(i===Ut.FALLBACK)return;const l=()=>{this.safeEmit(Ot.CONNECTION_STATE_CHANGE,t,r,i)};if(Ye.reportApiInvoke(this._sessionId||((a=this._gateway.joinInfo)===null||a===void 0?void 0:a.sid)||null,{name:Cn.CONNECTION_STATE_CHANGE,options:[t,r,i],tag:hn.TRACER}).onSuccess(JSON.stringify({cur:t,prev:r,reason:i})),A.info("[".concat(this._clientId,"] signal connection state change: ").concat(r," -> ").concat(t)),t==="DISCONNECTED")return this._reset(),void l();if(t==="RECONNECTING")this._users.forEach(p=>{p._trust_in_room_=!1,p._trust_audio_enabled_state_=!1,p._trust_video_enabled_state_=!1,p._trust_audio_mute_state_=!1,p._trust_video_mute_state_=!1,p._trust_audio_stream_added_state_=!1,p._trust_video_stream_added_state_=!1,p._is_pre_created||(p._audio_pre_subscribed||(p._audioSSRC=void 0,p._audioOrtc=void 0),p._video_pre_subscribed||(p._videoSSRC=void 0,p._videoOrtc=void 0,p._rtxSsrcId=void 0),p._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(t==="CONNECTED"){var u;this._streamFallbackTypeCacheMap.forEach((p,m)=>{this._gateway.setStreamFallbackOption(m,p).catch(g=>{A.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),g)})}),this._remoteStreamTypeCacheMap.forEach((p,m)=>{this._gateway.setRemoteVideoStreamType(m,p).catch(g=>{A.warning("[".concat(this._clientId,"] auto set remote stream type failed"),g)})}),W("VOS_CONFIGURE")&&Array.isArray(W("VOS_CONFIGURE"))&&W("VOS_CONFIGURE").length>0&&(this._gateway.setConfigure(W("VOS_CONFIGURE")).catch(p=>{A.debug("[".concat(this._clientId,"] auto set vos config failed"),p)}),A.debug("[".concat(this._clientId,"] ws connected auto set vos config"))),this._remoteDefaultVideoStreamType!==void 0&&((u=this._joinInfo)===null||u===void 0?void 0:u.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{A.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(p=>{A.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(p))}),this._dualStreamMode&&this._gateway.setDualStreamMode(this._dualStreamMode).catch(p=>{A.warning("[".concat(this._clientId,"] auto set dual stream mode failed"),p)}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(p=>!p._trust_in_room_).forEach(p=>{A.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(p.uid)),this._handleUserOffline({uid:p.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(p=>{p._trust_audio_mute_state_||(A.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(p.uid)),this._handleMuteStream(p.uid,ze.AUDIO,!1)),p._trust_video_mute_state_||(A.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(p.uid)),this._handleMuteStream(p.uid,ze.VIDEO,!1)),p._trust_audio_enabled_state_||(A.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(p.uid)),this._handleSetStreamLocalEnable("audio",p.uid,!0)),p._trust_video_enabled_state_||(A.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(p.uid)),this._handleSetStreamLocalEnable("video",p.uid,!0)),p._trust_video_stream_added_state_||(A.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(p.uid)),this._handleResetAddStream(p,"video")),p._trust_audio_stream_added_state_||(A.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(p.uid)),this._handleResetAddStream(p,"audio")),p._video_added_||p._audio_added_||(A.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(p.uid)),this._handleRemoveStream({uid:p.uid,uint_id:p._uintid}))}))},1e3))}l()}),this._gateway.on(qn.REQUEST_NEW_GATEWAY_LIST,async(t,r)=>{if(!this._joinInfo)return r(new pe(K.UNEXPECTED_ERROR,"can not recover, no join info"));try{let i;if(this._fallbackServerInfo)i=this._fallbackServerInfo,this._fallbackServerInfo=void 0,this._joinInfo.preload=!1,Ye.reportApiInvoke(this._sessionId,{name:Cn.VOS_FALLBACK_CN,options:{cur:i.gatewayInfo.gatewayAddrs,prev:this._joinInfo.gatewayAddrs,is_done:!0},tag:hn.TRACER}).onSuccess(),A.info("[".concat(this._clientId,"] use fallback cn server info"));else{const l=await rI(so(so({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));l?(i=l.ap,GG(l),this._joinInfo.preload=!0):(i=await M_(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||er,this.store),this._joinInfo.preload=!1)}this._joinInfo&&(this._joinInfo.apResponse=i.gatewayInfo.res,this._joinInfo.gatewayAddrs=i.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=i.gatewayInfo.uni_lbs_ip);const a=[];i.gatewayInfo.gatewayAddrs.forEach(l=>{let{address:u}=l;const[p,m]=u.split(":");this._joinInfo&&this._joinInfo.proxyServer?a.push({proxy:this._joinInfo.proxyServer,host:p,port:m}):a.push({host:p,port:m})}),t(a)}catch(i){r(i)}}),this._gateway.on(qn.NETWORK_QUALITY,t=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(Ot.NETWORK_QUALITY,t)}),this._gateway.on(qn.STREAM_TYPE_CHANGE,(t,r)=>{this.safeEmit(Ot.STREAM_TYPE_CHANGED,t,r),Ye.reportApiInvoke(this._sessionId,{name:Cn.STREAM_TYPE_CHANGE,options:[t,r],tag:hn.TRACER}).onSuccess(JSON.stringify({uid:t,streamType:r}))}),this._gateway.isPreSub=()=>"isPreSub"in this._p2pChannel&&this._p2pChannel.isPreSub(),this._gateway.isPreallocation=()=>"isPreallocation"in this._p2pChannel&&this._p2pChannel.isPreallocation(),this._gateway.on(qn.IS_P2P_DISCONNECTED,t=>{this._p2pChannel.isP2PDisconnected()?t(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?t(!1):t(!0)}),this._gateway.on(qn.REQUEST_P2P_CONNECTION_PARAMS,async(t,r,i)=>{try{let a=await this._p2pChannel.getEstablishParams();a&&"isPreallocation"in this._p2pChannel&&this._p2pChannel.isPreallocation()||(a=await this._p2pChannel.startP2PConnection(t)),r(a)}catch(a){i(a)}}),this._gateway.on(qn.JOIN_RESPONSE,(t,r)=>{if(this.store.useP2P)return;let i;this._joinResponse=t,t.attributes?i=t.attributes.userAttributes.preSubSsrcs:A.debug("no attributes in joinResponse");const a=G8(t.ortc,r,i);this._p2pChannel.connect(a)}),this._gateway.on(qn.PRE_CONNECT_PC,async(t,r,i)=>{const{candidates:a,fingerprint:l,turnServer:u}=t;if(this._joinInfo&&a.length>0&&!this._p2pChannel.isPlanB){const{cert:m,cid:g}=this._joinInfo.apResponse,y="".concat(g,"_").concat(m);if(y.length<4||y.length>256)return void A.debug("[".concat(this._clientId,"] ufrag length is not valid, length: ").concat(y.length));await this._p2pChannel.startP2PConnection({turnServer:u,cloudProxyServer:this._joinInfo.cloudProxyServer,isPreallocation:!0});try{var p;r(await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(g,"_").concat(m),icePwd:"".concat(g,"_").concat(m)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:(p=W("FINGERPRINT"))!==null&&p!==void 0?p:l}]},candidates:a,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0}))}catch(x){x.code&&x.code===K.EXCHANGE_SDP_FAILED&&await this._p2pChannel.startP2PConnection({turnServer:u,cloudProxyServer:this._joinInfo.cloudProxyServer},!0),i(x)}}}),this._gateway.on(qn.VOS_FALLBACK,t=>{t==="fallback_hls"&&this.safeEmit(Ot.FALLBACK_TO_HLS,EA.VOSERROR)}),this._gateway.on(qn.RESET_SIGNAL,()=>{this._p2pChannel instanceof ch&&this._p2pChannel.fallbackConnection(),this._handleGatewaySignalEvents()}),this._gateway.on(qn.DATACHANNEL_FAILBACK,()=>{Ye.reportApiInvoke(this._sessionId,{name:Cn.DATACHANNEL_FAILBACK,options:{},tag:hn.TRACER}).onSuccess(),this._joinGateway()})}_handleGatewaySignalEvents(){this._gateway.signal.on(vt.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(vt.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(vt.ON_ADD_AUDIO_STREAM,t=>this._handleAddAudioOrVideoStream("audio",t.uid,t.ssrcId,t.cname,t.pt,t.uint_id,t.ortc)),this._gateway.signal.on(vt.ON_ADD_VIDEO_STREAM,t=>this._handleAddAudioOrVideoStream("video",t.uid,t.ssrcId,t.cname,t.pt,t.uint_id,t.ortc,t.rtxSsrcId)),this._gateway.signal.on(vt.ON_REMOTE_DATASTREAM_UPDATE,t=>{this._handleUpdateDataChannel(t)}),this._gateway.signal.on(vt.ON_REMOTE_FULL_DATASTREAM_INFO,t=>{this._handleUpdateDataChannel({added:t.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(vt.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(vt.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(vt.MUTE_AUDIO,t=>this._handleMuteStream(t.uid,ze.AUDIO,!0)),this._gateway.signal.on(vt.UNMUTE_AUDIO,t=>this._handleMuteStream(t.uid,ze.AUDIO,!1)),this._gateway.signal.on(vt.MUTE_VIDEO,t=>this._handleMuteStream(t.uid,ze.VIDEO,!0)),this._gateway.signal.on(vt.UNMUTE_VIDEO,t=>this._handleMuteStream(t.uid,ze.VIDEO,!1)),this._gateway.signal.on(vt.RECEIVE_METADATA,t=>{const r=zu(t.metadata);this.safeEmit(Ot.RECEIVE_METADATA,t.uid,r)}),this._gateway.signal.on(vt.ON_DATA_STREAM,async t=>{var r;if(!t)return;let i=zu(t.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Ce(r=["aes-128-gcm2","aes-256-gcm2"]).call(r,this._encryptionMode)){if(t.payload.length<im)throw new pe(K.UNEXPECTED_RESPONSE,"payload length ".concat(t.payload.length," is less than header length ").concat(im));i=await async function(u,p,m){const g=m.subarray(0,im),y=g.slice(8,im),x=(y[0]<<8)+y[1],S=(g[6]<<8)+g[7],T=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:u,tagLength:zV,additionalData:new Uint8Array(kV(x,2))},p,m.subarray(im));return new Uint8Array(T).subarray(0,S)}(this._encryptDataStreamIv,this._encryptDataStreamKey,i)}let a=0;if(t.ordered||t.syncWithAudio){const l=this._p2pChannel.getStats(),u=this.remoteUsers.find(m=>m.uid===t.uid),p=l==null?void 0:l.audioRecv.find(m=>m.ssrc===(u==null?void 0:u._audioSSRC));a=p==null?void 0:p.jitterBufferMs}(a==null||Number.isNaN(a))&&(a=0),Yve(so(so({},t),{},{payload:i}),a,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(vt.ON_CRYPT_ERROR,()=>{fd(()=>{A.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Ot.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(vt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(vt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{A.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,Ut.TOKEN_EXPIRE),this.safeEmit(Ot.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(vt.ON_STREAM_FALLBACK_UPDATE,t=>{A.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(t.stream_id,", attr: ").concat(t.stream_type)),this.safeEmit(Ot.STREAM_FALLBACK,t.stream_id,t.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(vt.ENABLE_MULTI_STREAM,t=>{this._dualStreamMode===Qp.AUTO_SIMULCAST_STREAM&&this.enableDualStream().catch(r=>{A.debug("[".concat(this._clientId,"] set dual stream mode error"),r.toString())})}),this._gateway.signal.on(vt.ON_PUBLISH_STREAM,t=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:t.proxy})),A.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(t))))}),this._gateway.signal.on(vt.ENABLE_LOCAL_VIDEO,t=>{this._handleSetStreamLocalEnable("video",t.uid,!0)}),this._gateway.signal.on(vt.DISABLE_LOCAL_VIDEO,t=>{this._handleSetStreamLocalEnable("video",t.uid,!1)}),this._gateway.signal.on(Xe.REQUEST_TIMEOUT,(t,r)=>{if(this._joinInfo)switch(t){case nt.PUBLISH:{if(!r)return;const l=r.ortc;if(l){var i,a;const u=l.some(g=>{let{stream_type:y}=g;return y===rn.Audio}),p=l.some(g=>{let{stream_type:y}=g;return y!==rn.Audio}),m=l.some(g=>{let{stream_type:y}=g;return y===rn.Screen||y===rn.ScreenLow});r.state==="offer"&&Ye.publish(this._joinInfo.sid,{eventElapse:ai.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:K.TIMEOUT,audio:u,video:p,p2pid:r.p2p_id,publishRequestid:this.store.pubId,screenshare:m,audioName:u?(i=l.find(g=>{let{stream_type:y}=g;return y===rn.Audio}))===null||i===void 0||(i=i.ssrcs[0])===null||i===void 0?void 0:i.ssrcId.toString():void 0,videoName:p?(a=l.find(g=>{let{stream_type:y}=g;return y!==rn.Audio}))===null||a===void 0||(a=a.ssrcs[0])===null||a===void 0?void 0:a.ssrcId.toString():void 0})}break}case nt.SUBSCRIBE:r&&Ye.subscribe(this._joinInfo.sid,{succ:!1,ec:K.TIMEOUT,audio:r.stream_type===ze.AUDIO,video:r.stream_type===ze.VIDEO,peerid:r.stream_id,subscribeRequestid:r.ssrcId,p2pid:this.store.p2pId,eventElapse:ai.measureFromSubscribeStart(this.store.clientId,r.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(r.ssrcId)})}}),this._gateway.signal.on(vt.ON_P2P_OK,t=>{this.uid,this._uid}),this._gateway.signal.on(vt.ON_PUBLISHED_USER_LIST,t=>{if(t==null||!t.users)return;W("BLOCK_LOCAL_CLIENT")&&(t.users=t.users.filter(a=>!nh(a.string_id||a.stream_id,this.channelName)));const r=[],i=[];for(const a of t.users){let l=this._users.find(x=>x._uintid===a.stream_id);l?l._trust_in_room_=!0:(l=new wd(a.string_id||a.stream_id,a.stream_id),this._users.push(l),this.store.firstVideoFrameDecoded(l.uid,{userJoinNotify:Date.now()}),this.getListeners(Ot.PUBLISHED_USER_LIST).length===0&&(A.debug("[".concat(this._clientId,"] user online"),a.stream_id),this.safeEmit(Ot.USER_JOINED,l)));const u=Sr.Audio&a.stream_type,p=(Sr.Video|Sr.LwoVideo)&a.stream_type,m=(65280&a.stream_type)!=0,g=u&&l.hasAudio,y=p&&l.hasVideo;p&&(l._trust_video_stream_added_state_=!0,l._video_added_=!0,l._videoSSRC=a.video_ssrc,l._rtxSsrcId=a.video_rtx),u&&(l._trust_audio_stream_added_state_=!0,l._audio_added_=!0,l._audioSSRC=a.audio_ssrc),u&&!g&&this.getListeners(Ot.PUBLISHED_USER_LIST).length===0&&(A.info("[".concat(this._clientId,"] remote user ").concat(l.uid," published audio")),this.safeEmit(Ot.USER_PUBLISHED,l,"audio")),p&&!y&&this.getListeners(Ot.PUBLISHED_USER_LIST).length===0&&(A.info("[".concat(this._clientId,"] remote user ").concat(l.uid," published video")),this.safeEmit(Ot.USER_PUBLISHED,l,"video")),(u&&!g||p&&!y||m)&&r.push(l),p&&this._p2pChannel.hasPendingRemoteMedia(l,"video")&&i.push({user:l,mediaType:"video"}),u&&this._p2pChannel.hasPendingRemoteMedia(l,"audio")&&i.push({user:l,mediaType:"audio"})}i.length>0&&(A.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(i.map(a=>"user: ".concat(a.user.uid,", mediaType: ").concat(a.mediaType)).join("; ")," ")),this.massSubscribe(i).catch(a=>{A.error("[".concat(this._clientId,"] mass resubscribe error"),a.toString())})),this.getListeners(Ot.PUBLISHED_USER_LIST).length>0?W("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=r:(A.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(r.map(a=>a.uid).join(", "))),this.safeEmit(Ot.PUBLISHED_USER_LIST,r)):A.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(r.map(a=>a.uid).join(", ")))}),this._gateway.signal.on(vt.ON_RTP_CAPABILITY_CHANGE,t=>{const{video_codec:r}=t;if(this._p2pChannel instanceof ch){if(this.role==="audience"&&W("UPDATE_RTP_CAP_IN_HOST"))return this._pendingRtpCapabilityChange=t,void A.debug("[".concat(this._clientId,"] no need to change rtp capability because of audience, params: ").concat(JSON.stringify(t)));this._p2pChannel.updateRemoteRTPCapabilities(r.map(i=>i.toLowerCase()).filter(i=>{var a;return Ce(a=Object.keys(Yu)).call(a,i)}))}}),this._gateway.signal.on(Xe.VOS_FALLBACK_PROMISE,async(t,r,i)=>{if(t==="FALLBACKCN"&&W("ENABLE_QUALITY_FALLBACK")){if(!this._joinInfo)return i(new pe(K.UNEXPECTED_ERROR,"can not recover, no join info"));A.info("[".concat(this._clientId,"] try fallback to cn, start request new server info"));const l=this._joinInfo.apRequestDetail;try{this._joinInfo.apRequestDetail=t;const u=await M_(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||er,this.store);if(W("QUALITY_FALLBACK_REHEARSAL"))return Ye.reportApiInvoke(this._sessionId,{name:Cn.VOS_FALLBACK_CN,options:{cur:u.gatewayInfo.gatewayAddrs,prev:this._joinInfo.gatewayAddrs,is_done:!1},tag:hn.TRACER}).onSuccess(),this._joinInfo.apRequestDetail=l,void i();this._fallbackServerInfo=u,r()}catch(u){var a;const p=u==null||(a=u.data)===null||a===void 0?void 0:a.desc;W("QUALITY_FALLBACK_REHEARSAL")?(Ye.reportApiInvoke(this._sessionId,{name:Cn.VOS_FALLBACK_CN,options:{cur:"failed, errorReason: "+p||"unknown",prev:this._joinInfo.gatewayAddrs,is_done:!1},tag:hn.TRACER}).onSuccess(),this._joinInfo.apRequestDetail=l):Array.isArray(p)&&Ce(p).call(p,"request downgrade fallback")&&this.safeEmit(Ot.FALLBACK_TO_HLS,EA.AP_ERROR),i(u)}}else i()})}_handleP2PEvents(){this._gateway.signal.on(vt.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(Xn.PUBLISH,(t,r,i)=>{const{uid:a}=t;t.forEach(l=>{const{kind:u,ssrcs:p,mid:m,isMuted:g}=l;this._handleP2PAddAudioOrVideoStream(u,a,p[0].ssrcId,m);const y=this._users.find(x=>x.uid===a);return y&&this.store.useP2P?this._p2pChannel.mockSubscribe(y,u,p[0].ssrcId,m).then(()=>{r()}).catch(i):r(),this._handleMuteStream(a,u,!!g)})}),this._gateway.signal.on(Xn.CALL,async(t,r,i)=>{if(this.store.useP2P)try{var a;r(await this._p2pChannel.startP2P({turnServer:(a=this._joinInfo)===null||a===void 0?void 0:a.turnServer},t))}catch(l){i(l)}}),this._gateway.signal.on(Xe.P2P_CONNECTION,async t=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(t)}),this._gateway.signal.on(Xn.UNPUBLISH,async(t,r,i)=>{if(this.store.useP2P){const{unpubMsg:a,uid:l}=t,u=this._users.find(p=>p.uid===l);if(!u)return A.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(l)),void r();try{a.forEach(async p=>{let{stream_type:m}=p;const g=m===rn.Audio?ze.AUDIO:ze.VIDEO;await this._p2pChannel.unsubscribe(u,g),this._handleMuteStream(l,g,!0)}),r()}catch(p){i(p)}}}),this._gateway.signal.on(Xn.CONTROL,async(t,r)=>{const{action:i}=t;switch(i){case xd.MUTE_LOCAL_VIDEO:this._handleMuteStream(r,ze.VIDEO,!0);break;case xd.MUTE_LOCAL_AUDIO:this._handleMuteStream(r,ze.AUDIO,!0);break;case xd.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",r),this._handleMuteStream(r,ze.VIDEO,!1);break;case xd.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",r),this._handleMuteStream(r,ze.AUDIO,!1)}}),this._gateway.signal.on(Xn.RESTART_ICE,async(t,r,i)=>{if(this.store.useP2P)try{const{direction:a,iceParameter:l}=t;a!==Li.SEND_ONLY||l?r(await this._p2pChannel.restartICE(a,l)):(this._p2pChannel.handleDisconnect(a),r())}catch(a){i(a)}}),this._gateway.signal.on(Xn.CANDIDATE,t=>{if(this.store.useP2P){const{candidate:r,direction:i}=t;this._p2pChannel.addRemoteCandidate(r,i)}}),this._p2pChannel.on(rt.RequestP2PRestartICE,async(t,r,i)=>{try{const{direction:a}=t;r(await this._gateway.sendExtensionMessage(Xn.RESTART_ICE,t,a===Li.SEND_ONLY))}catch(a){i(a)}}),this._p2pChannel.on(rt.LocalCandidate,t=>{this._gateway.sendExtensionMessage(Xn.CANDIDATE,JSON.stringify(t),!0)}),this._p2pChannel.on(rt.RequestP2PMuteLocal,async(t,r,i)=>{try{await this._gateway.sendExtensionMessage(Xn.CONTROL,t,!0),r()}catch(a){i(a)}}),this._p2pChannel.on(rt.RequestP2PUnmuteRemote,async(t,r,i)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(t,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(a){a.code===K.DISCONNECT_P2P?r():i(a)}else r()}),this._p2pChannel.on(rt.RequestP2PMuteRemote,async(t,r,i)=>{if(this._joinInfo)try{await this._gateway.muteRemote(t,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(a){a.code===K.DISCONNECT_P2P?r():i(a)}else r()}),this._p2pChannel.on(rt.StateChange,(t,r)=>{r===Qt.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(rt.PeerConnectionStateChange,t=>{const r=this._peerConnectionState;t!==r&&(this.safeEmit(Ot.PEERCONNECTION_STATE_CHANGE,t,r),this._peerConnectionState=t)}),this._p2pChannel.on(rt.RequestMuteLocal,async(t,r,i)=>{if(this._joinInfo)try{await this._gateway.muteLocal(t,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(a){a.code===K.DISCONNECT_P2P?r():i(a)}else r()}),this._p2pChannel.on(rt.RequestUnmuteLocal,async(t,r,i)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(t,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(a){a.code===K.DISCONNECT_P2P?r():i(a)}else r()}),this._p2pChannel.on(rt.RequestRePublish,(t,r,i)=>{this.publish(t,!1).then(r).catch(i)}),this._p2pChannel.on(rt.RequestRePublishDataChannel,(t,r,i)=>{je.all(t.map(async a=>{const l=await this._p2pChannel.publishDataChannel([a]);try{l.forEach(u=>{this._uid&&this._gateway.publishDataChannel(this._uid,u,!0)})}catch(u){if(u.code!==K.DISCONNECT_P2P)throw u}})).then(r).catch(i)}),this._p2pChannel.on(rt.RequestReSubscribe,async(t,r,i)=>{try{for(const{user:a,kind:l}of t)l===ze.VIDEO?await this.subscribe(a,"video"):await this.subscribe(a,"audio");r()}catch(a){i(a)}}),this._p2pChannel.on(rt.RequestUpload,(t,r)=>{this._gateway.upload(t,r)}),this._p2pChannel.on(rt.RequestUploadStats,t=>{this._gateway.uploadWRTCStats(t)}),this._p2pChannel.on(rt.MediaReconnectStart,t=>{this.safeEmit(Ot.MEDIA_RECONNECT_START,t)}),this._p2pChannel.on(rt.MediaReconnectEnd,t=>{this.safeEmit(Ot.MEDIA_RECONNECT_END,t)}),this._p2pChannel.on(rt.NeedSignalRTT,t=>{t(this._gateway.getSignalRTT())}),this._p2pChannel.on(rt.RequestRestartICE,async t=>{if(this.store.useP2P)return;const r=await this._p2pChannel.restartICE(t),i=await r.next();if(i.done)return;const a=i.value;let l;try{l=await this._gateway.restartICE({iceParameters:a})}catch(p){return void r.throw(p)}const{iceParameters:u}=function(p){const m=p.iceParameters;return{iceParameters:{iceUfrag:m.iceUfrag,icePwd:m.icePwd}}}(l);await r.next({remoteIceParameters:u})}),this._p2pChannel.on(rt.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(rt.RequestReconnectPC,async()=>{var t;const{iceParameters:r,dtlsParameters:i,rtpCapabilities:a}=await this._p2pChannel.startP2PConnection({turnServer:(t=this._joinInfo)===null||t===void 0?void 0:t.turnServer}),{gatewayEstablishParams:l,gatewayAddress:u}=await this._gateway.reconnectPC({iceParameters:r,dtlsParameters:i,rtpCapabilities:a}),p=G8(l,u);await this._p2pChannel.connect(p),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(rt.RequestUnpublishForReconnectPC,async(t,r,i)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(t,this._uid),r()):i()}),this._p2pChannel.on(rt.P2PLost,()=>{this.safeEmit(Ot.P2P_LOST,this.store.uid)}),this._p2pChannel.on(rt.UpdateVideoEncoder,t=>{t._encoderConfig&&this._gateway.setVideoProfile(t._encoderConfig)}),this._p2pChannel.on(rt.ConnectionTypeChange,t=>{this.safeEmit(Ot.IS_USING_CLOUD_PROXY,t),this._gateway.setUsingProxy(t)}),this._p2pChannel.on(rt.FirstVideoBufferReady,(t,r)=>{this.safeEmit(Ot.FIRST_VIDEO_BUFFER_READY,t,r)}),this._p2pChannel.on(rt.FirstVideoPreRender,(t,r)=>{this.safeEmit(Ot.FIRST_VIDEO_PRE_RENDER,t,r)}),this._p2pChannel.on(rt.RequestLowStreamParameter,t=>{t(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(rt.QueryClientConnectionState,t=>{t(this.connectionState)}),this._p2pChannel.on(rt.AudioMetadata,t=>{this.safeEmit(Ot.AUDIO_METADATA,t)}),this._p2pChannel.on(rt.AudioPts,t=>{this.safeEmit(Ot.AUDIO_PTS,Number(t))})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(t){if(!this._joinInfo||this.connectionState!=="CONNECTED")throw new pe(K.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new pe(K.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const i=(r={config:t},Wo("ContentInspect").create(r));this._inspect=i,this.handleVideoInspectEvents(i);const{appId:a,cname:l,sid:u,token:p,uid:m,cid:g,vid:y}=this._joinInfo;await i.init({appId:a,areaCode:"",cname:l,sid:u,token:p,uid:m,cid:g,vid:y?Number(y):0},er)}catch(i){throw Array.isArray(i)?i[0]:i}var r}handleVideoInspectEvents(t){t.on(Dr.CONNECTION_STATE_CHANGE,(r,i)=>{if(this.safeEmit(Ot.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,r,i),i===eo.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(Ot.CONTENT_INSPECT_ERROR,new pe(K.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));t.inspectImage()}}),t.on(Dr.INSPECT_RESULT,(r,i)=>{var a;if((i==null?void 0:i.code)===K.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return A.debug("Stop inspect content because that has left channel"),this==null||(a=this._inspect)===null||a===void 0||a.close(),void(this._inspect=void 0);this.safeEmit(Ot.CONTENT_INSPECT_RESULT,r,i)}),t.on(Dr.CLIENT_LOCAL_VIDEO_TRACK,r=>{r(this.localTracks.filter(i=>i.trackMediaType==="video")[0])})}async disableContentInspect(){if(!this._inspect)throw new pe(K.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(t){throw Array.isArray(t)?t[0]:t}}async setImageModeration(t,r){if(qa(t,"enabled"),t){if(!r)throw new pe(K.INVALID_PARAMS,"config is required");if(nW(r),!this._joinInfo)throw new pe(K.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(r);else{const a=(i={config:r},Wo("ImageModeration").create(i));this._moderation=a,this.handleImageModerationEvents(a);const{appId:l,cname:u,sid:p,token:m,uid:g,cid:y,vid:x}=this._joinInfo;await a.init({appId:l,areaCode:"",cname:u,sid:p,token:m,uid:g,cid:y,vid:x?Number(x):0},er)}}catch(a){throw Array.isArray(a)?a[0]:a}}else{var i;if(!this._moderation)throw new pe(K.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(a){throw Array.isArray(a)?a[0]:a}}}handleImageModerationEvents(t){t.on(Go.CONNECTION_STATE_CHANGE,(r,i)=>{if(this.safeEmit(Ot.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,r,i),r===xa.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new pe(K.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");t.inspectImage()}}),t.on(Go.CLIENT_LOCAL_VIDEO_TRACK,r=>{r(this.localTracks.filter(i=>i.trackMediaType==="video")[0])})}setP2PTransport(t){if(function(r){Zn(r,"transport",["default","auto","relay","sd-rtn"])}(t),this.mode!=="p2p")throw new pe(K.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=t,A.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(t))}getJoinChannelServiceRecords(){return A.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(t){qa(t,"enabled"),cn("ENABLE_PUBLISH_AUDIO_FILTER",t),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(t)}_setRteInfo(t,r){this.store.rteUrl=t,this.store.rteSid=r}_isPreRender(){return"isPreRender"in this._p2pChannel&&this._p2pChannel.isPreRender()}_handleResetAddStream(t,r){switch(r){case"audio":t._audio_added_=!1,t._trust_audio_stream_added_state_=!0;break;case"video":t._video_added_=!1,t._trust_video_stream_added_state_=!0}}},Le(We.prototype,"leave",[rW],Object.getOwnPropertyDescriptor(We.prototype,"leave"),We.prototype),Le(We.prototype,"publish",[iW],Object.getOwnPropertyDescriptor(We.prototype,"publish"),We.prototype),Le(We.prototype,"unpublish",[sW],Object.getOwnPropertyDescriptor(We.prototype,"unpublish"),We.prototype),Le(We.prototype,"subscribe",[aW],Object.getOwnPropertyDescriptor(We.prototype,"subscribe"),We.prototype),Le(We.prototype,"presubscribe",[oW],Object.getOwnPropertyDescriptor(We.prototype,"presubscribe"),We.prototype),Le(We.prototype,"massSubscribe",[cW],Object.getOwnPropertyDescriptor(We.prototype,"massSubscribe"),We.prototype),Le(We.prototype,"unsubscribe",[lW],Object.getOwnPropertyDescriptor(We.prototype,"unsubscribe"),We.prototype),Le(We.prototype,"massUnsubscribe",[dW],Object.getOwnPropertyDescriptor(We.prototype,"massUnsubscribe"),We.prototype),Le(We.prototype,"setLowStreamParameter",[uW],Object.getOwnPropertyDescriptor(We.prototype,"setLowStreamParameter"),We.prototype),Le(We.prototype,"setDualStreamMode",[hW],Object.getOwnPropertyDescriptor(We.prototype,"setDualStreamMode"),We.prototype),Le(We.prototype,"enableDualStream",[pW],Object.getOwnPropertyDescriptor(We.prototype,"enableDualStream"),We.prototype),Le(We.prototype,"disableDualStream",[mW],Object.getOwnPropertyDescriptor(We.prototype,"disableDualStream"),We.prototype),Le(We.prototype,"setClientRole",[fW],Object.getOwnPropertyDescriptor(We.prototype,"setClientRole"),We.prototype),Le(We.prototype,"_setClientRoleOptions",[gW],Object.getOwnPropertyDescriptor(We.prototype,"_setClientRoleOptions"),We.prototype),Le(We.prototype,"setProxyServer",[vW],Object.getOwnPropertyDescriptor(We.prototype,"setProxyServer"),We.prototype),Le(We.prototype,"setTurnServer",[yW],Object.getOwnPropertyDescriptor(We.prototype,"setTurnServer"),We.prototype),Le(We.prototype,"setLicense",[bW],Object.getOwnPropertyDescriptor(We.prototype,"setLicense"),We.prototype),Le(We.prototype,"startProxyServer",[xW],Object.getOwnPropertyDescriptor(We.prototype,"startProxyServer"),We.prototype),Le(We.prototype,"stopProxyServer",[_W],Object.getOwnPropertyDescriptor(We.prototype,"stopProxyServer"),We.prototype),Le(We.prototype,"setLocalAccessPointsV2",[EW],Object.getOwnPropertyDescriptor(We.prototype,"setLocalAccessPointsV2"),We.prototype),Le(We.prototype,"setLocalAccessPoints",[wW],Object.getOwnPropertyDescriptor(We.prototype,"setLocalAccessPoints"),We.prototype),Le(We.prototype,"setRemoteDefaultVideoStreamType",[SW],Object.getOwnPropertyDescriptor(We.prototype,"setRemoteDefaultVideoStreamType"),We.prototype),Le(We.prototype,"setRemoteVideoStreamType",[TW],Object.getOwnPropertyDescriptor(We.prototype,"setRemoteVideoStreamType"),We.prototype),Le(We.prototype,"setStreamFallbackOption",[NW],Object.getOwnPropertyDescriptor(We.prototype,"setStreamFallbackOption"),We.prototype),Le(We.prototype,"setEncryptionConfig",[CW],Object.getOwnPropertyDescriptor(We.prototype,"setEncryptionConfig"),We.prototype),Le(We.prototype,"renewToken",[RW],Object.getOwnPropertyDescriptor(We.prototype,"renewToken"),We.prototype),Le(We.prototype,"enableAudioVolumeIndicator",[AW],Object.getOwnPropertyDescriptor(We.prototype,"enableAudioVolumeIndicator"),We.prototype),Le(We.prototype,"startLiveStreaming",[IW],Object.getOwnPropertyDescriptor(We.prototype,"startLiveStreaming"),We.prototype),Le(We.prototype,"setLiveTranscoding",[OW],Object.getOwnPropertyDescriptor(We.prototype,"setLiveTranscoding"),We.prototype),Le(We.prototype,"stopLiveStreaming",[PW],Object.getOwnPropertyDescriptor(We.prototype,"stopLiveStreaming"),We.prototype),Le(We.prototype,"startChannelMediaRelay",[kW],Object.getOwnPropertyDescriptor(We.prototype,"startChannelMediaRelay"),We.prototype),Le(We.prototype,"updateChannelMediaRelay",[jW],Object.getOwnPropertyDescriptor(We.prototype,"updateChannelMediaRelay"),We.prototype),Le(We.prototype,"stopChannelMediaRelay",[DW],Object.getOwnPropertyDescriptor(We.prototype,"stopChannelMediaRelay"),We.prototype),Le(We.prototype,"sendCustomReportMessage",[LW],Object.getOwnPropertyDescriptor(We.prototype,"sendCustomReportMessage"),We.prototype),Le(We.prototype,"pickSVCLayer",[MW],Object.getOwnPropertyDescriptor(We.prototype,"pickSVCLayer"),We.prototype),Le(We.prototype,"setRTMConfig",[UW],Object.getOwnPropertyDescriptor(We.prototype,"setRTMConfig"),We.prototype),Le(We.prototype,"enableContentInspect",[FW],Object.getOwnPropertyDescriptor(We.prototype,"enableContentInspect"),We.prototype),Le(We.prototype,"disableContentInspect",[VW],Object.getOwnPropertyDescriptor(We.prototype,"disableContentInspect"),We.prototype),Le(We.prototype,"setImageModeration",[BW],Object.getOwnPropertyDescriptor(We.prototype,"setImageModeration"),We.prototype),Le(We.prototype,"setP2PTransport",[GW],Object.getOwnPropertyDescriptor(We.prototype,"setP2PTransport"),We.prototype),Le(We.prototype,"getJoinChannelServiceRecords",[WW],Object.getOwnPropertyDescriptor(We.prototype,"getJoinChannelServiceRecords"),We.prototype),Le(We.prototype,"setPublishAudioFilterEnabled",[$W],Object.getOwnPropertyDescriptor(We.prototype,"setPublishAudioFilterEnabled"),We.prototype),We);function HW(){var t;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const i=tn(5,"client-"),a=Ye.reportApiInvoke(null,{id:i,name:Cn.CREATE_CLIENT,options:[r],tag:hn.TRACER});try{(function(l){Zn(l.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),Zn(l.mode,"config.mode",["rtc","live","p2p"]),l.audioCodec!==void 0&&Zn(l.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),l.proxyServer!==void 0&&Wr(l.proxyServer,"config.proxyServer",1,1e4),l.turnServer!==void 0&&SV(l.turnServer),l.httpRetryConfig!==void 0&&wV(l.httpRetryConfig),l.websocketRetryConfig!==void 0&&wV(l.websocketRetryConfig)})(r)}catch(l){throw a.onError(l),l}return(dV(16,0,!0)||fA(16,0,!0))&&(r.codec==="vp9"&&(r.codec="vp8",A.debug("browser not support vp9, force use vp8")),cn("UNSUPPORTED_VIDEO_CODEC",["vp9"])),r.audioCodec===void 0&&(r.audioCodec="opus"),a.onSuccess(),new dye(so(so({forceWaitGatewayResponse:!0},r),{},{role:Ce(t=["rtc","p2p"]).call(t,r.mode)?"host":r.role||"audience"}),i)}function uye(){let t=!1;const r=Ht();return(r.name===Yt.CHROME&&Number(r.version)>=58&&(Lo.engine.name!=="WebKit"||function(){const i=Ht();if(Hx()){if(i.os===_r.MAC_OS)return!0;if(i.os===_r.IOS){const a=Lo.os.version&&Lo.os.version.split(".");if(a&&Number(a[0])===14&&a[1]&&Number(a[1])>=3||a&&Number(a[0])>14)return!0}}return!1}())||r.name===Yt.FIREFOX&&Number(r.version)>=56||r.name===Yt.OPERA&&Number(r.version)>=45||r.name===Yt.SAFARI&&Number(r.version)>=11||r.name==="WebKit"&&(pi()||Ya())&&r.osVersion&&Number(r.osVersion.split(".")[0])>=11||pV()||Ht().name===Yt.QQ)&&(t=!0),t}class B0{constructor(r,i){F(this,"id",0),F(this,"element",void 0),F(this,"peerPair",void 0),F(this,"context",void 0),F(this,"audioPlayerElement",void 0),F(this,"audioTrack",void 0),B0.count+=1,this.id=B0.count,this.element=r,this.context=i}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=r=>{const i=document.createElement("audio");i.srcObject=new MediaStream([r.track]),i.play(),this.audioPlayerElement=i}}async switchSdp(){if(!this.peerPair)return;const r=async(a,l)=>{const u=l==="offer"?await a.createOffer():await a.createAnswer();return await a.setLocalDescription(u),a.iceGatheringState==="complete"?a.localDescription:new je(p=>{a.onicegatheringstatechange=()=>{a.iceGatheringState==="complete"&&p(a.localDescription)}})},i=async(a,l)=>await a.setRemoteDescription(l);try{const a=await r(this.peerPair[0],"offer");await i(this.peerPair[1],a);const l=await r(this.peerPair[1],"answer");await i(this.peerPair[0],l)}catch(a){throw new pe(K.LOCAL_AEC_ERROR,a.toString()).print()}}async getTracksFromMediaElement(r){if(this.audioTrack)return this.audioTrack;let i;try{r instanceof HTMLVideoElement&&(r.captureStream?r.captureStream():r.mozCaptureStream()),i=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(r).connect(i)}catch(l){throw new pe(K.LOCAL_AEC_ERROR,l.toString()).print()}if(!i)throw new pe(K.LOCAL_AEC_ERROR,"no dest node when local aec").print();const a=i.stream.getAudioTracks()[0];return this.audioTrack=a,a}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const r=this.element,i=await this.getTracksFromMediaElement(r);this.peerPair&&this.peerPair[0].addTrack(i),await this.switchSdp()}close(){A.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(r=>{r.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var KW,X_;F(B0,"count",0);const hye=window.AudioContext||window.webkitAudioContext,pye=new(KW=lt({report:Ye}),Le((X_=class{constructor(){F(this,"units",[]),F(this,"context",void 0)}processExternalMediaAEC(t){if(!this._doesEnvironmentNeedAEC())return A.debug("the system does not need to process local aec"),-1;this.context||(this.context=new hye);let r=this.units.find(i=>i&&i.getElement()===t);return r||(r=new B0(t,this.context),this.units.push(r)),r.startEchoCancellation(),A.debug("start processing local audio echo cancellation, id is",r.id),r.id}_doesEnvironmentNeedAEC(){return Ht().name!==Yt.SAFARI}}).prototype,"processExternalMediaAEC",[KW],Object.getOwnPropertyDescriptor(X_.prototype,"processExternalMediaAEC"),X_.prototype),X_);function YW(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function qW(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?YW(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):YW(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}const cI=window||document;function XW(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!cI)return;const i=cr._cspEventHandlerPointer;if(i&&r)return void console.error(i,r);const a=l=>{if(!(l&&l.blockedURI&&(cr.onSecurityPolicyViolation||cr.getListeners(Rc.SECURITY_POLICY_VIOLATION).length>0)))return;const u=l.blockedURI;W("CSP_DETECTED_HOSTNAME_LIST").some(p=>Ce(u).call(u,p))&&(cr.onSecurityPolicyViolation&&typeof cr.onSecurityPolicyViolation=="function"&&cr.onSecurityPolicyViolation(l),cr.getListeners(Rc.SECURITY_POLICY_VIOLATION).length>0&&cr.safeEmit(Rc.SECURITY_POLICY_VIOLATION,l))};i&&cI.removeEventListener("securitypolicyviolation",i),(r||t&&typeof t=="function"||cr.getListeners(Rc.SECURITY_POLICY_VIOLATION).length>0)&&cI.addEventListener("securitypolicyviolation",a),cr._cspEventHandlerPointer=a}var mye=N,fye=_R,JW=RegExp.prototype,gye=function(t){return t===JW||mye(JW,t)?fye(t):t.flags},xi=d(gye);function Im(t){let r=t.length;for(;--r>=0;)t[r]=0}const lI=256,QW=286,G0=30,W0=15,dI=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),J_=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),vye=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ZW=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yl=new Array(576);Im(yl);const $0=new Array(60);Im($0);const z0=new Array(512);Im(z0);const H0=new Array(256);Im(H0);const uI=new Array(29);Im(uI);const Q_=new Array(G0);function hI(t,r,i,a,l){this.static_tree=t,this.extra_bits=r,this.extra_base=i,this.elems=a,this.max_length=l,this.has_stree=t&&t.length}let e$,t$,n$;function pI(t,r){this.dyn_tree=t,this.max_code=0,this.stat_desc=r}Im(Q_);const r$=t=>t<256?z0[t]:z0[256+(t>>>7)],K0=(t,r)=>{t.pending_buf[t.pending++]=255&r,t.pending_buf[t.pending++]=r>>>8&255},Qs=(t,r,i)=>{t.bi_valid>16-i?(t.bi_buf|=r<<t.bi_valid&65535,K0(t,t.bi_buf),t.bi_buf=r>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=r<<t.bi_valid&65535,t.bi_valid+=i)},jc=(t,r,i)=>{Qs(t,i[2*r],i[2*r+1])},i$=(t,r)=>{let i=0;do i|=1&t,t>>>=1,i<<=1;while(--r>0);return i>>>1},s$=(t,r,i)=>{const a=new Array(16);let l,u,p=0;for(l=1;l<=W0;l++)p=p+i[l-1]<<1,a[l]=p;for(u=0;u<=r;u++){let m=t[2*u+1];m!==0&&(t[2*u]=i$(a[m]++,m))}},a$=t=>{let r;for(r=0;r<QW;r++)t.dyn_ltree[2*r]=0;for(r=0;r<G0;r++)t.dyn_dtree[2*r]=0;for(r=0;r<19;r++)t.bl_tree[2*r]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},o$=t=>{t.bi_valid>8?K0(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},c$=(t,r,i,a)=>{const l=2*r,u=2*i;return t[l]<t[u]||t[l]===t[u]&&a[r]<=a[i]},mI=(t,r,i)=>{const a=t.heap[i];let l=i<<1;for(;l<=t.heap_len&&(l<t.heap_len&&c$(r,t.heap[l+1],t.heap[l],t.depth)&&l++,!c$(r,a,t.heap[l],t.depth));)t.heap[i]=t.heap[l],i=l,l<<=1;t.heap[i]=a},l$=(t,r,i)=>{let a,l,u,p,m=0;if(t.sym_next!==0)do a=255&t.pending_buf[t.sym_buf+m++],a+=(255&t.pending_buf[t.sym_buf+m++])<<8,l=t.pending_buf[t.sym_buf+m++],a===0?jc(t,l,r):(u=H0[l],jc(t,u+lI+1,r),p=dI[u],p!==0&&(l-=uI[u],Qs(t,l,p)),a--,u=r$(a),jc(t,u,i),p=J_[u],p!==0&&(a-=Q_[u],Qs(t,a,p)));while(m<t.sym_next);jc(t,256,r)},fI=(t,r)=>{const i=r.dyn_tree,a=r.stat_desc.static_tree,l=r.stat_desc.has_stree,u=r.stat_desc.elems;let p,m,g,y=-1;for(t.heap_len=0,t.heap_max=573,p=0;p<u;p++)i[2*p]!==0?(t.heap[++t.heap_len]=y=p,t.depth[p]=0):i[2*p+1]=0;for(;t.heap_len<2;)g=t.heap[++t.heap_len]=y<2?++y:0,i[2*g]=1,t.depth[g]=0,t.opt_len--,l&&(t.static_len-=a[2*g+1]);for(r.max_code=y,p=t.heap_len>>1;p>=1;p--)mI(t,i,p);g=u;do p=t.heap[1],t.heap[1]=t.heap[t.heap_len--],mI(t,i,1),m=t.heap[1],t.heap[--t.heap_max]=p,t.heap[--t.heap_max]=m,i[2*g]=i[2*p]+i[2*m],t.depth[g]=(t.depth[p]>=t.depth[m]?t.depth[p]:t.depth[m])+1,i[2*p+1]=i[2*m+1]=g,t.heap[1]=g++,mI(t,i,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((x,S)=>{const T=S.dyn_tree,C=S.max_code,V=S.stat_desc.static_tree,j=S.stat_desc.has_stree,L=S.stat_desc.extra_bits,H=S.stat_desc.extra_base,Y=S.stat_desc.max_length;let te,se,oe,ne,de,be,Se=0;for(ne=0;ne<=W0;ne++)x.bl_count[ne]=0;for(T[2*x.heap[x.heap_max]+1]=0,te=x.heap_max+1;te<573;te++)se=x.heap[te],ne=T[2*T[2*se+1]+1]+1,ne>Y&&(ne=Y,Se++),T[2*se+1]=ne,se>C||(x.bl_count[ne]++,de=0,se>=H&&(de=L[se-H]),be=T[2*se],x.opt_len+=be*(ne+de),j&&(x.static_len+=be*(V[2*se+1]+de)));if(Se!==0){do{for(ne=Y-1;x.bl_count[ne]===0;)ne--;x.bl_count[ne]--,x.bl_count[ne+1]+=2,x.bl_count[Y]--,Se-=2}while(Se>0);for(ne=Y;ne!==0;ne--)for(se=x.bl_count[ne];se!==0;)oe=x.heap[--te],oe>C||(T[2*oe+1]!==ne&&(x.opt_len+=(ne-T[2*oe+1])*T[2*oe],T[2*oe+1]=ne),se--)}})(t,r),s$(i,y,t.bl_count)},d$=(t,r,i)=>{let a,l,u=-1,p=r[1],m=0,g=7,y=4;for(p===0&&(g=138,y=3),r[2*(i+1)+1]=65535,a=0;a<=i;a++)l=p,p=r[2*(a+1)+1],++m<g&&l===p||(m<y?t.bl_tree[2*l]+=m:l!==0?(l!==u&&t.bl_tree[2*l]++,t.bl_tree[32]++):m<=10?t.bl_tree[34]++:t.bl_tree[36]++,m=0,u=l,p===0?(g=138,y=3):l===p?(g=6,y=3):(g=7,y=4))},u$=(t,r,i)=>{let a,l,u=-1,p=r[1],m=0,g=7,y=4;for(p===0&&(g=138,y=3),a=0;a<=i;a++)if(l=p,p=r[2*(a+1)+1],!(++m<g&&l===p)){if(m<y)do jc(t,l,t.bl_tree);while(--m!=0);else l!==0?(l!==u&&(jc(t,l,t.bl_tree),m--),jc(t,16,t.bl_tree),Qs(t,m-3,2)):m<=10?(jc(t,17,t.bl_tree),Qs(t,m-3,3)):(jc(t,18,t.bl_tree),Qs(t,m-11,7));m=0,u=l,p===0?(g=138,y=3):l===p?(g=6,y=3):(g=7,y=4)}};let h$=!1;const p$=(t,r,i,a)=>{Qs(t,0+(a?1:0),3),o$(t),K0(t,i),K0(t,~i),i&&t.pending_buf.set(t.window.subarray(r,r+i),t.pending),t.pending+=i};var yye=t=>{h$||((()=>{let r,i,a,l,u;const p=new Array(16);for(a=0,l=0;l<28;l++)for(uI[l]=a,r=0;r<1<<dI[l];r++)H0[a++]=l;for(H0[a-1]=l,u=0,l=0;l<16;l++)for(Q_[l]=u,r=0;r<1<<J_[l];r++)z0[u++]=l;for(u>>=7;l<G0;l++)for(Q_[l]=u<<7,r=0;r<1<<J_[l]-7;r++)z0[256+u++]=l;for(i=0;i<=W0;i++)p[i]=0;for(r=0;r<=143;)yl[2*r+1]=8,r++,p[8]++;for(;r<=255;)yl[2*r+1]=9,r++,p[9]++;for(;r<=279;)yl[2*r+1]=7,r++,p[7]++;for(;r<=287;)yl[2*r+1]=8,r++,p[8]++;for(s$(yl,287,p),r=0;r<G0;r++)$0[2*r+1]=5,$0[2*r]=i$(r,5);e$=new hI(yl,dI,257,QW,W0),t$=new hI($0,J_,0,G0,W0),n$=new hI(new Array(0),vye,0,19,7)})(),h$=!0),t.l_desc=new pI(t.dyn_ltree,e$),t.d_desc=new pI(t.dyn_dtree,t$),t.bl_desc=new pI(t.bl_tree,n$),t.bi_buf=0,t.bi_valid=0,a$(t)},bye=(t,r,i,a)=>{let l,u,p=0;t.level>0?(t.strm.data_type===2&&(t.strm.data_type=(m=>{let g,y=4093624447;for(g=0;g<=31;g++,y>>>=1)if(1&y&&m.dyn_ltree[2*g]!==0)return 0;if(m.dyn_ltree[18]!==0||m.dyn_ltree[20]!==0||m.dyn_ltree[26]!==0)return 1;for(g=32;g<lI;g++)if(m.dyn_ltree[2*g]!==0)return 1;return 0})(t)),fI(t,t.l_desc),fI(t,t.d_desc),p=(m=>{let g;for(d$(m,m.dyn_ltree,m.l_desc.max_code),d$(m,m.dyn_dtree,m.d_desc.max_code),fI(m,m.bl_desc),g=18;g>=3&&m.bl_tree[2*ZW[g]+1]===0;g--);return m.opt_len+=3*(g+1)+5+5+4,g})(t),l=t.opt_len+3+7>>>3,u=t.static_len+3+7>>>3,u<=l&&(l=u)):l=u=i+5,i+4<=l&&r!==-1?p$(t,r,i,a):t.strategy===4||u===l?(Qs(t,2+(a?1:0),3),l$(t,yl,$0)):(Qs(t,4+(a?1:0),3),((m,g,y,x)=>{let S;for(Qs(m,g-257,5),Qs(m,y-1,5),Qs(m,x-4,4),S=0;S<x;S++)Qs(m,m.bl_tree[2*ZW[S]+1],3);u$(m,m.dyn_ltree,g-1),u$(m,m.dyn_dtree,y-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,p+1),l$(t,t.dyn_ltree,t.dyn_dtree)),a$(t),a&&o$(t)},xye=(t,r,i)=>(t.pending_buf[t.sym_buf+t.sym_next++]=r,t.pending_buf[t.sym_buf+t.sym_next++]=r>>8,t.pending_buf[t.sym_buf+t.sym_next++]=i,r===0?t.dyn_ltree[2*i]++:(t.matches++,r--,t.dyn_ltree[2*(H0[i]+lI+1)]++,t.dyn_dtree[2*r$(r)]++),t.sym_next===t.sym_end),_ye=t=>{Qs(t,2,3),jc(t,256,yl),(r=>{r.bi_valid===16?(K0(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=255&r.bi_buf,r.bi_buf>>=8,r.bi_valid-=8)})(t)},Eye={_tr_init:yye,_tr_stored_block:p$,_tr_flush_block:bye,_tr_tally:xye,_tr_align:_ye},Y0=(t,r,i,a)=>{let l=65535&t|0,u=t>>>16&65535|0,p=0;for(;i!==0;){p=i>2e3?2e3:i,i-=p;do l=l+r[a++]|0,u=u+l|0;while(--p);l%=65521,u%=65521}return l|u<<16|0};const wye=new Uint32Array((()=>{let t,r=[];for(var i=0;i<256;i++){t=i;for(var a=0;a<8;a++)t=1&t?3988292384^t>>>1:t>>>1;r[i]=t}return r})());var Mi=(t,r,i,a)=>{const l=wye,u=a+i;t^=-1;for(let p=a;p<u;p++)t=t>>>8^l[255&(t^r[p])];return-1^t},uh={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Z_={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Sye,_tr_stored_block:gI,_tr_flush_block:Tye,_tr_tally:Cd,_tr_align:Nye}=Eye,{Z_NO_FLUSH:Rd,Z_PARTIAL_FLUSH:Cye,Z_FULL_FLUSH:Rye,Z_FINISH:ao,Z_BLOCK:m$,Z_OK:Ji,Z_STREAM_END:f$,Z_STREAM_ERROR:Dc,Z_DATA_ERROR:Aye,Z_BUF_ERROR:vI,Z_DEFAULT_COMPRESSION:Iye,Z_FILTERED:Oye,Z_HUFFMAN_ONLY:eE,Z_RLE:Pye,Z_FIXED:kye,Z_DEFAULT_STRATEGY:jye,Z_UNKNOWN:Dye,Z_DEFLATED:tE}=Z_,yI=286,Lye=30,Mye=19,Uye=2*yI+1,Fye=15,hh=258,Lc=262,Om=42,ph=113,q0=666,mh=(t,r)=>(t.msg=uh[r],r),g$=t=>2*t-(t>4?9:0),Ad=t=>{let r=t.length;for(;--r>=0;)t[r]=0},Vye=t=>{let r,i,a,l=t.w_size;r=t.hash_size,a=r;do i=t.head[--a],t.head[a]=i>=l?i-l:0;while(--r);r=l,a=r;do i=t.prev[--a],t.prev[a]=i>=l?i-l:0;while(--r)};let Id=(t,r,i)=>(r<<t.hash_shift^i)&t.hash_mask;const _a=t=>{const r=t.state;let i=r.pending;i>t.avail_out&&(i=t.avail_out),i!==0&&(t.output.set(r.pending_buf.subarray(r.pending_out,r.pending_out+i),t.next_out),t.next_out+=i,r.pending_out+=i,t.total_out+=i,t.avail_out-=i,r.pending-=i,r.pending===0&&(r.pending_out=0))},Ea=(t,r)=>{Tye(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,r),t.block_start=t.strstart,_a(t.strm)},Kn=(t,r)=>{t.pending_buf[t.pending++]=r},X0=(t,r)=>{t.pending_buf[t.pending++]=r>>>8&255,t.pending_buf[t.pending++]=255&r},bI=(t,r,i,a)=>{let l=t.avail_in;return l>a&&(l=a),l===0?0:(t.avail_in-=l,r.set(t.input.subarray(t.next_in,t.next_in+l),i),t.state.wrap===1?t.adler=Y0(t.adler,r,l,i):t.state.wrap===2&&(t.adler=Mi(t.adler,r,l,i)),t.next_in+=l,t.total_in+=l,l)},v$=(t,r)=>{let i,a,l=t.max_chain_length,u=t.strstart,p=t.prev_length,m=t.nice_match;const g=t.strstart>t.w_size-Lc?t.strstart-(t.w_size-Lc):0,y=t.window,x=t.w_mask,S=t.prev,T=t.strstart+hh;let C=y[u+p-1],V=y[u+p];t.prev_length>=t.good_match&&(l>>=2),m>t.lookahead&&(m=t.lookahead);do if(i=r,y[i+p]===V&&y[i+p-1]===C&&y[i]===y[u]&&y[++i]===y[u+1]){u+=2,i++;do;while(y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&y[++u]===y[++i]&&u<T);if(a=hh-(T-u),u=T-hh,a>p){if(t.match_start=r,p=a,a>=m)break;C=y[u+p-1],V=y[u+p]}}while((r=S[r&x])>g&&--l!=0);return p<=t.lookahead?p:t.lookahead},Pm=t=>{const r=t.w_size;let i,a,l;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=r+(r-Lc)&&(t.window.set(t.window.subarray(r,r+r-a),0),t.match_start-=r,t.strstart-=r,t.block_start-=r,t.insert>t.strstart&&(t.insert=t.strstart),Vye(t),a+=r),t.strm.avail_in===0)break;if(i=bI(t.strm,t.window,t.strstart+t.lookahead,a),t.lookahead+=i,t.lookahead+t.insert>=3)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=Id(t,t.ins_h,t.window[l+1]);t.insert&&(t.ins_h=Id(t,t.ins_h,t.window[l+3-1]),t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Lc&&t.strm.avail_in!==0)},y$=(t,r)=>{let i,a,l,u=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,p=0,m=t.strm.avail_in;do{if(i=65535,l=t.bi_valid+42>>3,t.strm.avail_out<l||(l=t.strm.avail_out-l,a=t.strstart-t.block_start,i>a+t.strm.avail_in&&(i=a+t.strm.avail_in),i>l&&(i=l),i<u&&(i===0&&r!==ao||r===Rd||i!==a+t.strm.avail_in)))break;p=r===ao&&i===a+t.strm.avail_in?1:0,gI(t,0,0,p),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,_a(t.strm),a&&(a>i&&(a=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+a),t.strm.next_out),t.strm.next_out+=a,t.strm.avail_out-=a,t.strm.total_out+=a,t.block_start+=a,i-=a),i&&(bI(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(p===0);return m-=t.strm.avail_in,m&&(m>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=m&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-m,t.strm.next_in),t.strstart),t.strstart+=m,t.insert+=m>t.w_size-t.insert?t.w_size-t.insert:m),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),p?4:r!==Rd&&r!==ao&&t.strm.avail_in===0&&t.strstart===t.block_start?2:(l=t.window_size-t.strstart,t.strm.avail_in>l&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,l+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),l>t.strm.avail_in&&(l=t.strm.avail_in),l&&(bI(t.strm,t.window,t.strstart,l),t.strstart+=l,t.insert+=l>t.w_size-t.insert?t.w_size-t.insert:l),t.high_water<t.strstart&&(t.high_water=t.strstart),l=t.bi_valid+42>>3,l=t.pending_buf_size-l>65535?65535:t.pending_buf_size-l,u=l>t.w_size?t.w_size:l,a=t.strstart-t.block_start,(a>=u||(a||r===ao)&&r!==Rd&&t.strm.avail_in===0&&a<=l)&&(i=a>l?l:a,p=r===ao&&t.strm.avail_in===0&&i===a?1:0,gI(t,t.block_start,i,p),t.block_start+=i,_a(t.strm)),p?3:1)},xI=(t,r)=>{let i,a;for(;;){if(t.lookahead<Lc){if(Pm(t),t.lookahead<Lc&&r===Rd)return 1;if(t.lookahead===0)break}if(i=0,t.lookahead>=3&&(t.ins_h=Id(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),i!==0&&t.strstart-i<=t.w_size-Lc&&(t.match_length=v$(t,i)),t.match_length>=3)if(a=Cd(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do t.strstart++,t.ins_h=Id(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!=0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Id(t,t.ins_h,t.window[t.strstart+1]);else a=Cd(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(a&&(Ea(t,!1),t.strm.avail_out===0))return 1}return t.insert=t.strstart<2?t.strstart:2,r===ao?(Ea(t,!0),t.strm.avail_out===0?3:4):t.sym_next&&(Ea(t,!1),t.strm.avail_out===0)?1:2},km=(t,r)=>{let i,a,l;for(;;){if(t.lookahead<Lc){if(Pm(t),t.lookahead<Lc&&r===Rd)return 1;if(t.lookahead===0)break}if(i=0,t.lookahead>=3&&(t.ins_h=Id(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,i!==0&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-Lc&&(t.match_length=v$(t,i),t.match_length<=5&&(t.strategy===Oye||t.match_length===3&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){l=t.strstart+t.lookahead-3,a=Cd(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=l&&(t.ins_h=Id(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!=0);if(t.match_available=0,t.match_length=2,t.strstart++,a&&(Ea(t,!1),t.strm.avail_out===0))return 1}else if(t.match_available){if(a=Cd(t,0,t.window[t.strstart-1]),a&&Ea(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(a=Cd(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,r===ao?(Ea(t,!0),t.strm.avail_out===0?3:4):t.sym_next&&(Ea(t,!1),t.strm.avail_out===0)?1:2};function Mc(t,r,i,a,l){this.good_length=t,this.max_lazy=r,this.nice_length=i,this.max_chain=a,this.func=l}const J0=[new Mc(0,0,0,0,y$),new Mc(4,4,8,4,xI),new Mc(4,5,16,8,xI),new Mc(4,6,32,32,xI),new Mc(4,4,16,16,km),new Mc(8,16,32,32,km),new Mc(8,16,128,128,km),new Mc(8,32,128,256,km),new Mc(32,128,258,1024,km),new Mc(32,258,258,4096,km)];function Bye(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=tE,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Uye),this.dyn_dtree=new Uint16Array(2*(2*Lye+1)),this.bl_tree=new Uint16Array(2*(2*Mye+1)),Ad(this.dyn_ltree),Ad(this.dyn_dtree),Ad(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Fye+1),this.heap=new Uint16Array(2*yI+1),Ad(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*yI+1),Ad(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Q0=t=>{if(!t)return 1;const r=t.state;return!r||r.strm!==t||r.status!==Om&&r.status!==57&&r.status!==69&&r.status!==73&&r.status!==91&&r.status!==103&&r.status!==ph&&r.status!==q0?1:0},b$=t=>{if(Q0(t))return mh(t,Dc);t.total_in=t.total_out=0,t.data_type=Dye;const r=t.state;return r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap===2?57:r.wrap?Om:ph,t.adler=r.wrap===2?0:1,r.last_flush=-2,Sye(r),Ji},x$=t=>{const r=b$(t);return r===Ji&&(i=>{i.window_size=2*i.w_size,Ad(i.head),i.max_lazy_match=J0[i.level].max_lazy,i.good_match=J0[i.level].good_length,i.nice_match=J0[i.level].nice_length,i.max_chain_length=J0[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0})(t.state),r},_$=(t,r,i,a,l,u)=>{if(!t)return Dc;let p=1;if(r===Iye&&(r=6),a<0?(p=0,a=-a):a>15&&(p=2,a-=16),l<1||l>9||i!==tE||a<8||a>15||r<0||r>9||u<0||u>kye||a===8&&p!==1)return mh(t,Dc);a===8&&(a=9);const m=new Bye;return t.state=m,m.strm=t,m.status=Om,m.wrap=p,m.gzhead=null,m.w_bits=a,m.w_size=1<<m.w_bits,m.w_mask=m.w_size-1,m.hash_bits=l+7,m.hash_size=1<<m.hash_bits,m.hash_mask=m.hash_size-1,m.hash_shift=~~((m.hash_bits+3-1)/3),m.window=new Uint8Array(2*m.w_size),m.head=new Uint16Array(m.hash_size),m.prev=new Uint16Array(m.w_size),m.lit_bufsize=1<<l+6,m.pending_buf_size=4*m.lit_bufsize,m.pending_buf=new Uint8Array(m.pending_buf_size),m.sym_buf=m.lit_bufsize,m.sym_end=3*(m.lit_bufsize-1),m.level=r,m.strategy=u,m.method=i,x$(t)};var Gye=(t,r)=>{if(Q0(t)||r>m$||r<0)return t?mh(t,Dc):Dc;const i=t.state;if(!t.output||t.avail_in!==0&&!t.input||i.status===q0&&r!==ao)return mh(t,t.avail_out===0?vI:Dc);const a=i.last_flush;if(i.last_flush=r,i.pending!==0){if(_a(t),t.avail_out===0)return i.last_flush=-1,Ji}else if(t.avail_in===0&&g$(r)<=g$(a)&&r!==ao)return mh(t,vI);if(i.status===q0&&t.avail_in!==0)return mh(t,vI);if(i.status===Om&&i.wrap===0&&(i.status=ph),i.status===Om){let l=tE+(i.w_bits-8<<4)<<8,u=-1;if(u=i.strategy>=eE||i.level<2?0:i.level<6?1:i.level===6?2:3,l|=u<<6,i.strstart!==0&&(l|=32),l+=31-l%31,X0(i,l),i.strstart!==0&&(X0(i,t.adler>>>16),X0(i,65535&t.adler)),t.adler=1,i.status=ph,_a(t),i.pending!==0)return i.last_flush=-1,Ji}if(i.status===57){if(t.adler=0,Kn(i,31),Kn(i,139),Kn(i,8),i.gzhead)Kn(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Kn(i,255&i.gzhead.time),Kn(i,i.gzhead.time>>8&255),Kn(i,i.gzhead.time>>16&255),Kn(i,i.gzhead.time>>24&255),Kn(i,i.level===9?2:i.strategy>=eE||i.level<2?4:0),Kn(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(Kn(i,255&i.gzhead.extra.length),Kn(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=Mi(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(Kn(i,0),Kn(i,0),Kn(i,0),Kn(i,0),Kn(i,0),Kn(i,i.level===9?2:i.strategy>=eE||i.level<2?4:0),Kn(i,3),i.status=ph,_a(t),i.pending!==0)return i.last_flush=-1,Ji}if(i.status===69){if(i.gzhead.extra){let l=i.pending,u=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+u>i.pending_buf_size;){let m=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+m),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>l&&(t.adler=Mi(t.adler,i.pending_buf,i.pending-l,l)),i.gzindex+=m,_a(t),i.pending!==0)return i.last_flush=-1,Ji;l=0,u-=m}let p=new Uint8Array(i.gzhead.extra);i.pending_buf.set(p.subarray(i.gzindex,i.gzindex+u),i.pending),i.pending+=u,i.gzhead.hcrc&&i.pending>l&&(t.adler=Mi(t.adler,i.pending_buf,i.pending-l,l)),i.gzindex=0}i.status=73}if(i.status===73){if(i.gzhead.name){let l,u=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>u&&(t.adler=Mi(t.adler,i.pending_buf,i.pending-u,u)),_a(t),i.pending!==0)return i.last_flush=-1,Ji;u=0}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,Kn(i,l)}while(l!==0);i.gzhead.hcrc&&i.pending>u&&(t.adler=Mi(t.adler,i.pending_buf,i.pending-u,u)),i.gzindex=0}i.status=91}if(i.status===91){if(i.gzhead.comment){let l,u=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>u&&(t.adler=Mi(t.adler,i.pending_buf,i.pending-u,u)),_a(t),i.pending!==0)return i.last_flush=-1,Ji;u=0}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,Kn(i,l)}while(l!==0);i.gzhead.hcrc&&i.pending>u&&(t.adler=Mi(t.adler,i.pending_buf,i.pending-u,u))}i.status=103}if(i.status===103){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(_a(t),i.pending!==0))return i.last_flush=-1,Ji;Kn(i,255&t.adler),Kn(i,t.adler>>8&255),t.adler=0}if(i.status=ph,_a(t),i.pending!==0)return i.last_flush=-1,Ji}if(t.avail_in!==0||i.lookahead!==0||r!==Rd&&i.status!==q0){let l=i.level===0?y$(i,r):i.strategy===eE?((u,p)=>{let m;for(;;){if(u.lookahead===0&&(Pm(u),u.lookahead===0)){if(p===Rd)return 1;break}if(u.match_length=0,m=Cd(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++,m&&(Ea(u,!1),u.strm.avail_out===0))return 1}return u.insert=0,p===ao?(Ea(u,!0),u.strm.avail_out===0?3:4):u.sym_next&&(Ea(u,!1),u.strm.avail_out===0)?1:2})(i,r):i.strategy===Pye?((u,p)=>{let m,g,y,x;const S=u.window;for(;;){if(u.lookahead<=hh){if(Pm(u),u.lookahead<=hh&&p===Rd)return 1;if(u.lookahead===0)break}if(u.match_length=0,u.lookahead>=3&&u.strstart>0&&(y=u.strstart-1,g=S[y],g===S[++y]&&g===S[++y]&&g===S[++y])){x=u.strstart+hh;do;while(g===S[++y]&&g===S[++y]&&g===S[++y]&&g===S[++y]&&g===S[++y]&&g===S[++y]&&g===S[++y]&&g===S[++y]&&y<x);u.match_length=hh-(x-y),u.match_length>u.lookahead&&(u.match_length=u.lookahead)}if(u.match_length>=3?(m=Cd(u,1,u.match_length-3),u.lookahead-=u.match_length,u.strstart+=u.match_length,u.match_length=0):(m=Cd(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++),m&&(Ea(u,!1),u.strm.avail_out===0))return 1}return u.insert=0,p===ao?(Ea(u,!0),u.strm.avail_out===0?3:4):u.sym_next&&(Ea(u,!1),u.strm.avail_out===0)?1:2})(i,r):J0[i.level].func(i,r);if(l!==3&&l!==4||(i.status=q0),l===1||l===3)return t.avail_out===0&&(i.last_flush=-1),Ji;if(l===2&&(r===Cye?Nye(i):r!==m$&&(gI(i,0,0,!1),r===Rye&&(Ad(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),_a(t),t.avail_out===0))return i.last_flush=-1,Ji}return r!==ao?Ji:i.wrap<=0?f$:(i.wrap===2?(Kn(i,255&t.adler),Kn(i,t.adler>>8&255),Kn(i,t.adler>>16&255),Kn(i,t.adler>>24&255),Kn(i,255&t.total_in),Kn(i,t.total_in>>8&255),Kn(i,t.total_in>>16&255),Kn(i,t.total_in>>24&255)):(X0(i,t.adler>>>16),X0(i,65535&t.adler)),_a(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Ji:f$)},Wye=(t,r)=>{let i=r.length;if(Q0(t))return Dc;const a=t.state,l=a.wrap;if(l===2||l===1&&a.status!==Om||a.lookahead)return Dc;if(l===1&&(t.adler=Y0(t.adler,r,i,0)),a.wrap=0,i>=a.w_size){l===0&&(Ad(a.head),a.strstart=0,a.block_start=0,a.insert=0);let g=new Uint8Array(a.w_size);g.set(r.subarray(i-a.w_size,i),0),r=g,i=a.w_size}const u=t.avail_in,p=t.next_in,m=t.input;for(t.avail_in=i,t.next_in=0,t.input=r,Pm(a);a.lookahead>=3;){let g=a.strstart,y=a.lookahead-2;do a.ins_h=Id(a,a.ins_h,a.window[g+3-1]),a.prev[g&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=g,g++;while(--y);a.strstart=g,a.lookahead=2,Pm(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,t.next_in=p,t.input=m,t.avail_in=u,a.wrap=l,Ji},Z0={deflateInit:(t,r)=>_$(t,r,tE,15,8,jye),deflateInit2:_$,deflateReset:x$,deflateResetKeep:b$,deflateSetHeader:(t,r)=>Q0(t)||t.state.wrap!==2?Dc:(t.state.gzhead=r,Ji),deflate:Gye,deflateEnd:t=>{if(Q0(t))return Dc;const r=t.state.status;return t.state=null,r===ph?mh(t,Aye):Ji},deflateSetDictionary:Wye,deflateInfo:"pako deflate (from Nodeca project)"};const $ye=(t,r)=>Object.prototype.hasOwnProperty.call(t,r);var nE={assign:function(t){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const i=r.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(const a in i)$ye(i,a)&&(t[a]=i[a])}}return t},flattenChunks:t=>{let r=0;for(let a=0,l=t.length;a<l;a++)r+=t[a].length;const i=new Uint8Array(r);for(let a=0,l=0,u=t.length;a<u;a++){let p=t[a];i.set(p,l),l+=p.length}return i}};let E$=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{E$=!1}const ev=new Uint8Array(256);for(let t=0;t<256;t++)ev[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ev[254]=ev[254]=1;var tv={string2buf:t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let r,i,a,l,u,p=t.length,m=0;for(l=0;l<p;l++)i=t.charCodeAt(l),(64512&i)==55296&&l+1<p&&(a=t.charCodeAt(l+1),(64512&a)==56320&&(i=65536+(i-55296<<10)+(a-56320),l++)),m+=i<128?1:i<2048?2:i<65536?3:4;for(r=new Uint8Array(m),u=0,l=0;u<m;l++)i=t.charCodeAt(l),(64512&i)==55296&&l+1<p&&(a=t.charCodeAt(l+1),(64512&a)==56320&&(i=65536+(i-55296<<10)+(a-56320),l++)),i<128?r[u++]=i:i<2048?(r[u++]=192|i>>>6,r[u++]=128|63&i):i<65536?(r[u++]=224|i>>>12,r[u++]=128|i>>>6&63,r[u++]=128|63&i):(r[u++]=240|i>>>18,r[u++]=128|i>>>12&63,r[u++]=128|i>>>6&63,r[u++]=128|63&i);return r},buf2string:(t,r)=>{const i=r||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,r));let a,l;const u=new Array(2*i);for(l=0,a=0;a<i;){let p=t[a++];if(p<128){u[l++]=p;continue}let m=ev[p];if(m>4)u[l++]=65533,a+=m-1;else{for(p&=m===2?31:m===3?15:7;m>1&&a<i;)p=p<<6|63&t[a++],m--;m>1?u[l++]=65533:p<65536?u[l++]=p:(p-=65536,u[l++]=55296|p>>10&1023,u[l++]=56320|1023&p)}}return((p,m)=>{if(m<65534&&p.subarray&&E$)return String.fromCharCode.apply(null,p.length===m?p:p.subarray(0,m));let g="";for(let y=0;y<m;y++)g+=String.fromCharCode(p[y]);return g})(u,l)},utf8border:(t,r)=>{(r=r||t.length)>t.length&&(r=t.length);let i=r-1;for(;i>=0&&(192&t[i])==128;)i--;return i<0||i===0?r:i+ev[t[i]]>r?i:r}},w$=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const S$=Object.prototype.toString,{Z_NO_FLUSH:zye,Z_SYNC_FLUSH:Hye,Z_FULL_FLUSH:Kye,Z_FINISH:Yye,Z_OK:rE,Z_STREAM_END:qye,Z_DEFAULT_COMPRESSION:Xye,Z_DEFAULT_STRATEGY:Jye,Z_DEFLATED:Qye}=Z_;function iE(t){this.options=nE.assign({level:Xye,method:Qye,chunkSize:16384,windowBits:15,memLevel:8,strategy:Jye},t||{});let r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w$,this.strm.avail_out=0;let i=Z0.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(i!==rE)throw new Error(uh[i]);if(r.header&&Z0.deflateSetHeader(this.strm,r.header),r.dictionary){let a;if(a=typeof r.dictionary=="string"?tv.string2buf(r.dictionary):S$.call(r.dictionary)==="[object ArrayBuffer]"?new Uint8Array(r.dictionary):r.dictionary,i=Z0.deflateSetDictionary(this.strm,a),i!==rE)throw new Error(uh[i]);this._dict_set=!0}}function T$(t,r){const i=new iE(r);if(i.push(t,!0),i.err)throw i.msg||uh[i.err];return i.result}iE.prototype.push=function(t,r){const i=this.strm,a=this.options.chunkSize;let l,u;if(this.ended)return!1;for(u=r===~~r?r:r===!0?Yye:zye,typeof t=="string"?i.input=tv.string2buf(t):S$.call(t)==="[object ArrayBuffer]"?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(i.avail_out===0&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),(u===Hye||u===Kye)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(l=Z0.deflate(i,u),l===qye)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),l=Z0.deflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===rE;if(i.avail_out!==0){if(u>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(i.avail_in===0)break}else this.onData(i.output)}return!0},iE.prototype.onData=function(t){this.chunks.push(t)},iE.prototype.onEnd=function(t){t===rE&&(this.result=nE.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Zye={deflate:T$,deflateRaw:function(t,r){return(r=r||{}).raw=!0,T$(t,r)}};const sE=16209;var ebe=function(t,r){let i,a,l,u,p,m,g,y,x,S,T,C,V,j,L,H,Y,te,se,oe,ne,de,be,Se;const Be=t.state;i=t.next_in,be=t.input,a=i+(t.avail_in-5),l=t.next_out,Se=t.output,u=l-(r-t.avail_out),p=l+(t.avail_out-257),m=Be.dmax,g=Be.wsize,y=Be.whave,x=Be.wnext,S=Be.window,T=Be.hold,C=Be.bits,V=Be.lencode,j=Be.distcode,L=(1<<Be.lenbits)-1,H=(1<<Be.distbits)-1;e:do{C<15&&(T+=be[i++]<<C,C+=8,T+=be[i++]<<C,C+=8),Y=V[T&L];t:for(;;){if(te=Y>>>24,T>>>=te,C-=te,te=Y>>>16&255,te===0)Se[l++]=65535&Y;else{if(!(16&te)){if(!(64&te)){Y=V[(65535&Y)+(T&(1<<te)-1)];continue t}if(32&te){Be.mode=16191;break e}t.msg="invalid literal/length code",Be.mode=sE;break e}se=65535&Y,te&=15,te&&(C<te&&(T+=be[i++]<<C,C+=8),se+=T&(1<<te)-1,T>>>=te,C-=te),C<15&&(T+=be[i++]<<C,C+=8,T+=be[i++]<<C,C+=8),Y=j[T&H];n:for(;;){if(te=Y>>>24,T>>>=te,C-=te,te=Y>>>16&255,!(16&te)){if(!(64&te)){Y=j[(65535&Y)+(T&(1<<te)-1)];continue n}t.msg="invalid distance code",Be.mode=sE;break e}if(oe=65535&Y,te&=15,C<te&&(T+=be[i++]<<C,C+=8,C<te&&(T+=be[i++]<<C,C+=8)),oe+=T&(1<<te)-1,oe>m){t.msg="invalid distance too far back",Be.mode=sE;break e}if(T>>>=te,C-=te,te=l-u,oe>te){if(te=oe-te,te>y&&Be.sane){t.msg="invalid distance too far back",Be.mode=sE;break e}if(ne=0,de=S,x===0){if(ne+=g-te,te<se){se-=te;do Se[l++]=S[ne++];while(--te);ne=l-oe,de=Se}}else if(x<te){if(ne+=g+x-te,te-=x,te<se){se-=te;do Se[l++]=S[ne++];while(--te);if(ne=0,x<se){te=x,se-=te;do Se[l++]=S[ne++];while(--te);ne=l-oe,de=Se}}}else if(ne+=x-te,te<se){se-=te;do Se[l++]=S[ne++];while(--te);ne=l-oe,de=Se}for(;se>2;)Se[l++]=de[ne++],Se[l++]=de[ne++],Se[l++]=de[ne++],se-=3;se&&(Se[l++]=de[ne++],se>1&&(Se[l++]=de[ne++]))}else{ne=l-oe;do Se[l++]=Se[ne++],Se[l++]=Se[ne++],Se[l++]=Se[ne++],se-=3;while(se>2);se&&(Se[l++]=Se[ne++],se>1&&(Se[l++]=Se[ne++]))}break}}break}}while(i<a&&l<p);se=C>>3,i-=se,C-=se<<3,T&=(1<<C)-1,t.next_in=i,t.next_out=l,t.avail_in=i<a?a-i+5:5-(i-a),t.avail_out=l<p?p-l+257:257-(l-p),Be.hold=T,Be.bits=C};const aE=15,tbe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),nbe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),rbe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ibe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var nv=(t,r,i,a,l,u,p,m)=>{const g=m.bits;let y,x,S,T,C,V,j=0,L=0,H=0,Y=0,te=0,se=0,oe=0,ne=0,de=0,be=0,Se=null;const Be=new Uint16Array(16),mt=new Uint16Array(16);let ut,Tt,Et,Xt=null;for(j=0;j<=aE;j++)Be[j]=0;for(L=0;L<a;L++)Be[r[i+L]]++;for(te=g,Y=aE;Y>=1&&Be[Y]===0;Y--);if(te>Y&&(te=Y),Y===0)return l[u++]=20971520,l[u++]=20971520,m.bits=1,0;for(H=1;H<Y&&Be[H]===0;H++);for(te<H&&(te=H),ne=1,j=1;j<=aE;j++)if(ne<<=1,ne-=Be[j],ne<0)return-1;if(ne>0&&(t===0||Y!==1))return-1;for(mt[1]=0,j=1;j<aE;j++)mt[j+1]=mt[j]+Be[j];for(L=0;L<a;L++)r[i+L]!==0&&(p[mt[r[i+L]]++]=L);if(t===0?(Se=Xt=p,V=20):t===1?(Se=tbe,Xt=nbe,V=257):(Se=rbe,Xt=ibe,V=0),be=0,L=0,j=H,C=u,se=te,oe=0,S=-1,de=1<<te,T=de-1,t===1&&de>852||t===2&&de>592)return 1;for(;;){ut=j-oe,p[L]+1<V?(Tt=0,Et=p[L]):p[L]>=V?(Tt=Xt[p[L]-V],Et=Se[p[L]-V]):(Tt=96,Et=0),y=1<<j-oe,x=1<<se,H=x;do x-=y,l[C+(be>>oe)+x]=ut<<24|Tt<<16|Et|0;while(x!==0);for(y=1<<j-1;be&y;)y>>=1;if(y!==0?(be&=y-1,be+=y):be=0,L++,--Be[j]==0){if(j===Y)break;j=r[i+p[L]]}if(j>te&&(be&T)!==S){for(oe===0&&(oe=te),C+=H,se=j-oe,ne=1<<se;se+oe<Y&&(ne-=Be[se+oe],!(ne<=0));)se++,ne<<=1;if(de+=1<<se,t===1&&de>852||t===2&&de>592)return 1;S=be&T,l[S]=te<<24|se<<16|C-u|0}}return be!==0&&(l[C+be]=j-oe<<24|64<<16|0),m.bits=te,0};const{Z_FINISH:N$,Z_BLOCK:sbe,Z_TREES:oE,Z_OK:fh,Z_STREAM_END:abe,Z_NEED_DICT:obe,Z_STREAM_ERROR:oo,Z_DATA_ERROR:C$,Z_MEM_ERROR:R$,Z_BUF_ERROR:cbe,Z_DEFLATED:A$}=Z_,cE=16180,lE=16190,bl=16191,_I=16192,EI=16194,dE=16199,uE=16200,wI=16206,Mr=16209,I$=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function lbe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const gh=t=>{if(!t)return 1;const r=t.state;return!r||r.strm!==t||r.mode<cE||r.mode>16211?1:0},O$=t=>{if(gh(t))return oo;const r=t.state;return t.total_in=t.total_out=r.total=0,t.msg="",r.wrap&&(t.adler=1&r.wrap),r.mode=cE,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(852),r.distcode=r.distdyn=new Int32Array(592),r.sane=1,r.back=-1,fh},P$=t=>{if(gh(t))return oo;const r=t.state;return r.wsize=0,r.whave=0,r.wnext=0,O$(t)},k$=(t,r)=>{let i;if(gh(t))return oo;const a=t.state;return r<0?(i=0,r=-r):(i=5+(r>>4),r<48&&(r&=15)),r&&(r<8||r>15)?oo:(a.window!==null&&a.wbits!==r&&(a.window=null),a.wrap=i,a.wbits=r,P$(t))},j$=(t,r)=>{if(!t)return oo;const i=new lbe;t.state=i,i.strm=t,i.window=null,i.mode=cE;const a=k$(t,r);return a!==fh&&(t.state=null),a};let SI,TI,D$=!0;const dbe=t=>{if(D$){SI=new Int32Array(512),TI=new Int32Array(32);let r=0;for(;r<144;)t.lens[r++]=8;for(;r<256;)t.lens[r++]=9;for(;r<280;)t.lens[r++]=7;for(;r<288;)t.lens[r++]=8;for(nv(1,t.lens,0,288,SI,0,t.work,{bits:9}),r=0;r<32;)t.lens[r++]=5;nv(2,t.lens,0,32,TI,0,t.work,{bits:5}),D$=!1}t.lencode=SI,t.lenbits=9,t.distcode=TI,t.distbits=5},L$=(t,r,i,a)=>{let l;const u=t.state;return u.window===null&&(u.wsize=1<<u.wbits,u.wnext=0,u.whave=0,u.window=new Uint8Array(u.wsize)),a>=u.wsize?(u.window.set(r.subarray(i-u.wsize,i),0),u.wnext=0,u.whave=u.wsize):(l=u.wsize-u.wnext,l>a&&(l=a),u.window.set(r.subarray(i-a,i-a+l),u.wnext),(a-=l)?(u.window.set(r.subarray(i-a,i),0),u.wnext=a,u.whave=u.wsize):(u.wnext+=l,u.wnext===u.wsize&&(u.wnext=0),u.whave<u.wsize&&(u.whave+=l))),0};var ube=(t,r)=>{let i,a,l,u,p,m,g,y,x,S,T,C,V,j,L,H,Y,te,se,oe,ne,de,be=0;const Se=new Uint8Array(4);let Be,mt;const ut=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(gh(t)||!t.output||!t.input&&t.avail_in!==0)return oo;i=t.state,i.mode===bl&&(i.mode=_I),p=t.next_out,l=t.output,g=t.avail_out,u=t.next_in,a=t.input,m=t.avail_in,y=i.hold,x=i.bits,S=m,T=g,de=fh;e:for(;;)switch(i.mode){case cE:if(i.wrap===0){i.mode=_I;break}for(;x<16;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}if(2&i.wrap&&y===35615){i.wbits===0&&(i.wbits=15),i.check=0,Se[0]=255&y,Se[1]=y>>>8&255,i.check=Mi(i.check,Se,2,0),y=0,x=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&y)<<8)+(y>>8))%31){t.msg="incorrect header check",i.mode=Mr;break}if((15&y)!==A$){t.msg="unknown compression method",i.mode=Mr;break}if(y>>>=4,x-=4,ne=8+(15&y),i.wbits===0&&(i.wbits=ne),ne>15||ne>i.wbits){t.msg="invalid window size",i.mode=Mr;break}i.dmax=1<<i.wbits,i.flags=0,t.adler=i.check=1,i.mode=512&y?16189:bl,y=0,x=0;break;case 16181:for(;x<16;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}if(i.flags=y,(255&xi(i))!==A$){t.msg="unknown compression method",i.mode=Mr;break}if(57344&xi(i)){t.msg="unknown header flags set",i.mode=Mr;break}i.head&&(i.head.text=y>>8&1),512&xi(i)&&4&i.wrap&&(Se[0]=255&y,Se[1]=y>>>8&255,i.check=Mi(i.check,Se,2,0)),y=0,x=0,i.mode=16182;case 16182:for(;x<32;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}i.head&&(i.head.time=y),512&xi(i)&&4&i.wrap&&(Se[0]=255&y,Se[1]=y>>>8&255,Se[2]=y>>>16&255,Se[3]=y>>>24&255,i.check=Mi(i.check,Se,4,0)),y=0,x=0,i.mode=16183;case 16183:for(;x<16;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}i.head&&(i.head.xflags=255&y,i.head.os=y>>8),512&xi(i)&&4&i.wrap&&(Se[0]=255&y,Se[1]=y>>>8&255,i.check=Mi(i.check,Se,2,0)),y=0,x=0,i.mode=16184;case 16184:if(1024&xi(i)){for(;x<16;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}i.length=y,i.head&&(i.head.extra_len=y),512&xi(i)&&4&i.wrap&&(Se[0]=255&y,Se[1]=y>>>8&255,i.check=Mi(i.check,Se,2,0)),y=0,x=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&xi(i)&&(C=i.length,C>m&&(C=m),C&&(i.head&&(ne=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(a.subarray(u,u+C),ne)),512&xi(i)&&4&i.wrap&&(i.check=Mi(i.check,a,C,u)),m-=C,u+=C,i.length-=C),i.length))break e;i.length=0,i.mode=16186;case 16186:if(2048&xi(i)){if(m===0)break e;C=0;do ne=a[u+C++],i.head&&ne&&i.length<65536&&(i.head.name+=String.fromCharCode(ne));while(ne&&C<m);if(512&xi(i)&&4&i.wrap&&(i.check=Mi(i.check,a,C,u)),m-=C,u+=C,ne)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&xi(i)){if(m===0)break e;C=0;do ne=a[u+C++],i.head&&ne&&i.length<65536&&(i.head.comment+=String.fromCharCode(ne));while(ne&&C<m);if(512&xi(i)&&4&i.wrap&&(i.check=Mi(i.check,a,C,u)),m-=C,u+=C,ne)break e}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&xi(i)){for(;x<16;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}if(4&i.wrap&&y!==(65535&i.check)){t.msg="header crc mismatch",i.mode=Mr;break}y=0,x=0}i.head&&(i.head.hcrc=xi(i)>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=bl;break;case 16189:for(;x<32;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}t.adler=i.check=I$(y),y=0,x=0,i.mode=lE;case lE:if(i.havedict===0)return t.next_out=p,t.avail_out=g,t.next_in=u,t.avail_in=m,i.hold=y,i.bits=x,obe;t.adler=i.check=1,i.mode=bl;case bl:if(r===sbe||r===oE)break e;case _I:if(i.last){y>>>=7&x,x-=7&x,i.mode=wI;break}for(;x<3;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}switch(i.last=1&y,y>>>=1,x-=1,3&y){case 0:i.mode=16193;break;case 1:if(dbe(i),i.mode=dE,r===oE){y>>>=2,x-=2;break e}break;case 2:i.mode=16196;break;case 3:t.msg="invalid block type",i.mode=Mr}y>>>=2,x-=2;break;case 16193:for(y>>>=7&x,x-=7&x;x<32;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}if((65535&y)!=(y>>>16^65535)){t.msg="invalid stored block lengths",i.mode=Mr;break}if(i.length=65535&y,y=0,x=0,i.mode=EI,r===oE)break e;case EI:i.mode=16195;case 16195:if(C=i.length,C){if(C>m&&(C=m),C>g&&(C=g),C===0)break e;l.set(a.subarray(u,u+C),p),m-=C,u+=C,g-=C,p+=C,i.length-=C;break}i.mode=bl;break;case 16196:for(;x<14;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}if(i.nlen=257+(31&y),y>>>=5,x-=5,i.ndist=1+(31&y),y>>>=5,x-=5,i.ncode=4+(15&y),y>>>=4,x-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=Mr;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;x<3;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}i.lens[ut[i.have++]]=7&y,y>>>=3,x-=3}for(;i.have<19;)i.lens[ut[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,Be={bits:i.lenbits},de=nv(0,i.lens,0,19,i.lencode,0,i.work,Be),i.lenbits=Be.bits,de){t.msg="invalid code lengths set",i.mode=Mr;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;be=i.lencode[y&(1<<i.lenbits)-1],L=be>>>24,H=be>>>16&255,Y=65535&be,!(L<=x);){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}if(Y<16)y>>>=L,x-=L,i.lens[i.have++]=Y;else{if(Y===16){for(mt=L+2;x<mt;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}if(y>>>=L,x-=L,i.have===0){t.msg="invalid bit length repeat",i.mode=Mr;break}ne=i.lens[i.have-1],C=3+(3&y),y>>>=2,x-=2}else if(Y===17){for(mt=L+3;x<mt;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}y>>>=L,x-=L,ne=0,C=3+(7&y),y>>>=3,x-=3}else{for(mt=L+7;x<mt;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}y>>>=L,x-=L,ne=0,C=11+(127&y),y>>>=7,x-=7}if(i.have+C>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=Mr;break}for(;C--;)i.lens[i.have++]=ne}}if(i.mode===Mr)break;if(i.lens[256]===0){t.msg="invalid code -- missing end-of-block",i.mode=Mr;break}if(i.lenbits=9,Be={bits:i.lenbits},de=nv(1,i.lens,0,i.nlen,i.lencode,0,i.work,Be),i.lenbits=Be.bits,de){t.msg="invalid literal/lengths set",i.mode=Mr;break}if(i.distbits=6,i.distcode=i.distdyn,Be={bits:i.distbits},de=nv(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,Be),i.distbits=Be.bits,de){t.msg="invalid distances set",i.mode=Mr;break}if(i.mode=dE,r===oE)break e;case dE:i.mode=uE;case uE:if(m>=6&&g>=258){t.next_out=p,t.avail_out=g,t.next_in=u,t.avail_in=m,i.hold=y,i.bits=x,ebe(t,T),p=t.next_out,l=t.output,g=t.avail_out,u=t.next_in,a=t.input,m=t.avail_in,y=i.hold,x=i.bits,i.mode===bl&&(i.back=-1);break}for(i.back=0;be=i.lencode[y&(1<<i.lenbits)-1],L=be>>>24,H=be>>>16&255,Y=65535&be,!(L<=x);){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}if(H&&!(240&H)){for(te=L,se=H,oe=Y;be=i.lencode[oe+((y&(1<<te+se)-1)>>te)],L=be>>>24,H=be>>>16&255,Y=65535&be,!(te+L<=x);){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}y>>>=te,x-=te,i.back+=te}if(y>>>=L,x-=L,i.back+=L,i.length=Y,H===0){i.mode=16205;break}if(32&H){i.back=-1,i.mode=bl;break}if(64&H){t.msg="invalid literal/length code",i.mode=Mr;break}i.extra=15&H,i.mode=16201;case 16201:if(i.extra){for(mt=i.extra;x<mt;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}i.length+=y&(1<<i.extra)-1,y>>>=i.extra,x-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;be=i.distcode[y&(1<<i.distbits)-1],L=be>>>24,H=be>>>16&255,Y=65535&be,!(L<=x);){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}if(!(240&H)){for(te=L,se=H,oe=Y;be=i.distcode[oe+((y&(1<<te+se)-1)>>te)],L=be>>>24,H=be>>>16&255,Y=65535&be,!(te+L<=x);){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}y>>>=te,x-=te,i.back+=te}if(y>>>=L,x-=L,i.back+=L,64&H){t.msg="invalid distance code",i.mode=Mr;break}i.offset=Y,i.extra=15&H,i.mode=16203;case 16203:if(i.extra){for(mt=i.extra;x<mt;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}i.offset+=y&(1<<i.extra)-1,y>>>=i.extra,x-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=Mr;break}i.mode=16204;case 16204:if(g===0)break e;if(C=T-g,i.offset>C){if(C=i.offset-C,C>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=Mr;break}C>i.wnext?(C-=i.wnext,V=i.wsize-C):V=i.wnext-C,C>i.length&&(C=i.length),j=i.window}else j=l,V=p-i.offset,C=i.length;C>g&&(C=g),g-=C,i.length-=C;do l[p++]=j[V++];while(--C);i.length===0&&(i.mode=uE);break;case 16205:if(g===0)break e;l[p++]=i.length,g--,i.mode=uE;break;case wI:if(i.wrap){for(;x<32;){if(m===0)break e;m--,y|=a[u++]<<x,x+=8}if(T-=g,t.total_out+=T,i.total+=T,4&i.wrap&&T&&(t.adler=i.check=xi(i)?Mi(i.check,l,T,p-T):Y0(i.check,l,T,p-T)),T=g,4&i.wrap&&(xi(i)?y:I$(y))!==i.check){t.msg="incorrect data check",i.mode=Mr;break}y=0,x=0}i.mode=16207;case 16207:if(i.wrap&&xi(i)){for(;x<32;){if(m===0)break e;m--,y+=a[u++]<<x,x+=8}if(4&i.wrap&&y!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=Mr;break}y=0,x=0}i.mode=16208;case 16208:de=abe;break e;case Mr:de=C$;break e;case 16210:return R$;default:return oo}return t.next_out=p,t.avail_out=g,t.next_in=u,t.avail_in=m,i.hold=y,i.bits=x,(i.wsize||T!==t.avail_out&&i.mode<Mr&&(i.mode<wI||r!==N$))&&L$(t,t.output,t.next_out,T-t.avail_out),S-=t.avail_in,T-=t.avail_out,t.total_in+=S,t.total_out+=T,i.total+=T,4&i.wrap&&T&&(t.adler=i.check=xi(i)?Mi(i.check,l,T,t.next_out-T):Y0(i.check,l,T,t.next_out-T)),t.data_type=i.bits+(i.last?64:0)+(i.mode===bl?128:0)+(i.mode===dE||i.mode===EI?256:0),(S===0&&T===0||r===N$)&&de===fh&&(de=cbe),de},xl={inflateReset:P$,inflateReset2:k$,inflateResetKeep:O$,inflateInit:t=>j$(t,15),inflateInit2:j$,inflate:ube,inflateEnd:t=>{if(gh(t))return oo;let r=t.state;return r.window&&(r.window=null),t.state=null,fh},inflateGetHeader:(t,r)=>{if(gh(t))return oo;const i=t.state;return 2&i.wrap?(i.head=r,r.done=!1,fh):oo},inflateSetDictionary:(t,r)=>{const i=r.length;let a,l,u;return gh(t)?oo:(a=t.state,a.wrap!==0&&a.mode!==lE?oo:a.mode===lE&&(l=1,l=Y0(l,r,i,0),l!==a.check)?C$:(u=L$(t,r,i,i),u?(a.mode=16210,R$):(a.havedict=1,fh)))},inflateInfo:"pako inflate (from Nodeca project)"},hbe=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const M$=Object.prototype.toString,{Z_NO_FLUSH:pbe,Z_FINISH:mbe,Z_OK:rv,Z_STREAM_END:NI,Z_NEED_DICT:CI,Z_STREAM_ERROR:fbe,Z_DATA_ERROR:U$,Z_MEM_ERROR:gbe}=Z_;function hE(t){this.options=nE.assign({chunkSize:65536,windowBits:15,to:""},t||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),!(r.windowBits>=0&&r.windowBits<16)||t&&t.windowBits||(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&!(15&r.windowBits)&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w$,this.strm.avail_out=0;let i=xl.inflateInit2(this.strm,r.windowBits);if(i!==rv)throw new Error(uh[i]);if(this.header=new hbe,xl.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=tv.string2buf(r.dictionary):M$.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(i=xl.inflateSetDictionary(this.strm,r.dictionary),i!==rv)))throw new Error(uh[i])}function F$(t,r){const i=new hE(r);if(i.push(t),i.err)throw i.msg||uh[i.err];return i.result}hE.prototype.push=function(t,r){const i=this.strm,a=this.options.chunkSize,l=this.options.dictionary;let u,p,m;if(this.ended)return!1;for(p=r===~~r?r:r===!0?mbe:pbe,M$.call(t)==="[object ArrayBuffer]"?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(i.avail_out===0&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),u=xl.inflate(i,p),u===CI&&l&&(u=xl.inflateSetDictionary(i,l),u===rv?u=xl.inflate(i,p):u===U$&&(u=CI));i.avail_in>0&&u===NI&&i.state.wrap>0&&t[i.next_in]!==0;)xl.inflateReset(i),u=xl.inflate(i,p);switch(u){case fbe:case U$:case CI:case gbe:return this.onEnd(u),this.ended=!0,!1}if(m=i.avail_out,i.next_out&&(i.avail_out===0||u===NI))if(this.options.to==="string"){let g=tv.utf8border(i.output,i.next_out),y=i.next_out-g,x=tv.buf2string(i.output,g);i.next_out=y,i.avail_out=a-y,y&&i.output.set(i.output.subarray(g,g+y),0),this.onData(x)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(u!==rv||m!==0){if(u===NI)return u=xl.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,!0;if(i.avail_in===0)break}}return!0},hE.prototype.onData=function(t){this.chunks.push(t)},hE.prototype.onEnd=function(t){t===rv&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=nE.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var vbe={inflate:F$,inflateRaw:function(t,r){return(r=r||{}).raw=!0,F$(t,r)}};const{deflate:ybe,deflateRaw:bbe}=Zye,{inflate:xbe,inflateRaw:_be}=vbe;var Ebe=ybe,wbe=bbe,Sbe=xbe,Tbe=_be,V$=function(t){return t[t.ONE_BYTE=0]="ONE_BYTE",t[t.TWO_BYTE=1]="TWO_BYTE",t}(V$||{});class Nbe{constructor(){F(this,"_sequence",0),F(this,"_startTime",Date.now()),F(this,"isUseOneByte",!0)}get startTime(){const r=Date.now()-this._startTime;return r<Math.pow(2,16)?r:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(r){const i={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:r};if(r.byteLength>128){const m=new Uint8Array(4);m.set([1,0,0,0]);const g={id:0,length:4,data:m.buffer},y={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[g]};i.commonPacketHeader.extension=1,i.extension=y,i.payload=this.compress(r),i.commonPacketHeader.length=8+(i.extension.length+2)+i.payload.byteLength}else i.commonPacketHeader.length=8+i.payload.byteLength;W("SHOW_DATASTREAM2_LOG")&&A.debug("send data header: ".concat(JSON.stringify(i.commonPacketHeader)));const a=new ArrayBuffer(i.commonPacketHeader.length),l=new Uint8Array(a),u=new DataView(a);let p=0;if(u.setUint16(p,i.commonPacketHeader.extension<<15|i.commonPacketHeader.reserved<<14|i.commonPacketHeader.length,!0),p+=2,u.setUint32(p,i.commonPacketHeader.sequence,!0),p+=4,u.setUint16(p,i.commonStreamHeader,!0),p+=2,i.extension){const m=this.serializeExtension(i.extension);l.set(new Uint8Array(m),p),p+=m.byteLength}if(l.set(new Uint8Array(i.payload),p),p+=i.payload.byteLength,p!==i.commonPacketHeader.length)throw Error("serialize error!");return a}deserialize(r){if(r.byteLength<4)return new ArrayBuffer(0);const i=new DataView(r);let a=0;const l=i.getUint16(a,!0);a+=2;const u={length:16383&l,reserved:(16384&l)>>14,extension:(32768&l)>>15,sequence:i.getUint16(a+2,!0)<<16|i.getUint16(a,!0)};let p,m;if(a+=4,W("SHOW_DATASTREAM2_LOG")&&A.debug("receive data header: ".concat(JSON.stringify(u))),i.getUint16(a,!0),a+=2,u.extension){m=this.deserializeExtension(r.slice(a)),a+=2+m.length,p=r.slice(a);let g=!1;if(m.datas.length>0){const y=m.datas.find(x=>x.id===0);y&&(g=(1&new DataView(y.data).getUint32(0,!0))==1)}p=g?this.decompress(p):p}else p=r.slice(8);return p}serializeExtension(r){const{profile:i,length:a,datas:l}=r,u=new ArrayBuffer(a+2),p=new Uint8Array(u),m=new DataView(u);let g=0;if(m.setUint8(g++,i),m.setUint8(g++,a),l.forEach(y=>{i?(m.setUint8(g++,y.id),m.setUint8(g++,y.length),p.set(new Uint8Array(y.data),g),g+=y.data.byteLength):(m.setUint8(g++,y.id|y.length<<4),p.set(new Uint8Array(y.data),g),g+=y.data.byteLength)}),g!==a+2)throw Error("serialize extension error, is ".concat(g,"!==").concat(a+2));return u}deserializeExtension(r){const i=new DataView(r);let a=0;const l=i.getUint8(a);a++;const u=i.getUint8(a);a++;const p=l===V$.TWO_BYTE,m=[],g=new DataView(r,2);let y=0;for(;y<u;){let x=0,S=0,T=new ArrayBuffer(0);p?(x=g.getUint8(y),y++,S=g.getUint8(y),y++):(x=15&g.getUint8(y),S=g.getUint8(y)>>4,y++),S>0&&(T=g.buffer.slice(y+2,y+2+S),y+=T.byteLength),m.push({id:x,length:S,data:T})}if(y!==u)throw Error("parse error");return{profile:l,length:u,datas:m}}decompress(r){return Sbe(new Uint8Array(r))}compress(r){return Ebe(new Uint8Array(r))}}const Cbe={name:"DataStream",create:(t,r)=>{const i=r?new O0e(t):new P0e(t);return i.useDataStream(new Nbe),i}};class Rbe extends Pn{constructor(r,i,a){super(),F(this,"ws",void 0),F(this,"requestId",1),F(this,"heartBeatTimer",void 0),F(this,"joinInfo",void 0),F(this,"clientId",void 0),F(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),F(this,"onClose",l=>{this.emit("close"),this.dispose()}),F(this,"onMessage",l=>{const u=JSON.parse(l.data);if(!u||u.command!=="serverResponse"||!u.requestId)return u&&u.command==="serverStatus"&&u.serverStatus&&u.serverStatus.command?(this.emit("status",u.serverStatus),void this.emit(u.serverStatus.command,u.serverStatus)):void 0;this.emit("req_".concat(u.requestId),u)}),this.joinInfo=r,this.clientId=i,this.ws=new C0("cross-channel-".concat(this.clientId),a),this.ws.on(wt.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(wt.CONNECTED,this.onOpen),this.ws.on(wt.ON_MESSAGE,this.onMessage),this.ws.on(wt.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(r){const i=this.requestId++;return r.requestId=i,r.seq=i,this.ws.sendMessage(r),i}waitStatus(r){return new je((i,a)=>{const l=window.setTimeout(()=>{a(new pe(K.TIMEOUT,"wait status timeout, status: ".concat(r)))},5e3);this.once(r,u=>{window.clearTimeout(l),u.state&&u.state!==0?a(new pe(K.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(r))):i(void 0)}),this.once("dispose",()=>{window.clearTimeout(l),a(new pe(K.WS_ABORT))})})}async request(r){if(this.ws.state==="closed")throw new pe(K.WS_DISCONNECT);const i=()=>new je((p,m)=>{this.ws.once(wt.CLOSED,()=>m(new pe(K.WS_ABORT))),this.ws.once(wt.CONNECTED,p)});this.ws.state!=="connected"&&await i();const a=this.sendMessage(r),l=new je((p,m)=>{const g=()=>{m(new pe(K.WS_ABORT))};this.ws.once(wt.RECONNECTING,g),this.ws.once(wt.CLOSED,g),this.once("req_".concat(a),p),Er(3e3).then(()=>{this.removeAllListeners("req_".concat(a)),this.ws.off(wt.RECONNECTING,g),this.ws.off(wt.CLOSED,g),m(new pe(K.TIMEOUT,"cross channel ws request timeout"))})}),u=await l;if(!u||u.code!==200)throw new pe(K.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(u)));return u}async connect(r){this.ws.removeAllListeners(wt.REQUEST_NEW_URLS),this.ws.on(wt.REQUEST_NEW_URLS,i=>{i(r)}),await this.ws.init(r)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(r){const i=this.requestId++;return r.requestId=i,this.ws.sendMessage(r),i}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class Abe extends Pn{set state(r){r!==this._state&&(r!==ls.RELAY_STATE_FAILURE&&(this.errorCode=gm.RELAY_OK),this.emit("state",r,this.errorCode),this._state=r)}get state(){return this._state}constructor(r,i,a,l,u){super(),F(this,"joinInfo",void 0),F(this,"sid",void 0),F(this,"clientId",void 0),F(this,"cancelToken",zi.CancelToken.source()),F(this,"workerToken",void 0),F(this,"requestId",0),F(this,"signal",void 0),F(this,"prevChannelMediaConfig",void 0),F(this,"httpRetryConfig",void 0),F(this,"_resolution",void 0),F(this,"_state",ls.RELAY_STATE_IDLE),F(this,"errorCode",gm.RELAY_OK),F(this,"onStatus",p=>{A.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(p))),p&&p.command&&(p.command==="onAudioPacketReceived"&&this.emit("event",fl.PACKET_RECEIVED_AUDIO_FROM_SRC),p.command==="onVideoPacketReceived"&&this.emit("event",fl.PACKET_RECEIVED_VIDEO_FROM_SRC),p.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=gm.SRC_TOKEN_EXPIRED,this.state=ls.RELAY_STATE_FAILURE),p.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=gm.DEST_TOKEN_EXPIRED,this.state=ls.RELAY_STATE_FAILURE))}),F(this,"onReconnect",async()=>{A.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",fl.NETWORK_DISCONNECTED),this.state=ls.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(p=>{this.state!==ls.RELAY_STATE_IDLE&&(A.error("auto restart channel media relay failed",p.toString()),this.errorCode=gm.SERVER_CONNECTION_LOST,this.state=ls.RELAY_STATE_FAILURE)})}),this.joinInfo=r,this.clientId=i,this.sid=Hu(),this.signal=new Rbe(this.joinInfo,this.clientId,a),this.httpRetryConfig=l,this._resolution=u}async startChannelMediaRelay(r){if(this.state!==ls.RELAY_STATE_IDLE)throw new pe(K.INVALID_OPERATION);this.state=ls.RELAY_STATE_CONNECTING,await this.connect(),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(r)}catch(i){throw i.data&&i.data.serverResponse&&i.data.serverResponse.command==="SetSourceChannel"?new pe(K.CROSS_CHANNEL_FAILED_JOIN_SRC):i.data&&i.data.serverResponse&&i.serverResponse.command==="SetDestChannelStatus"?new pe(K.CROSS_CHANNEL_FAILED_JOIN_DEST):i.data&&i.data.serverResponse&&i.serverResponse.command==="StartPacketTransfer"?new pe(K.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):i}this.prevChannelMediaConfig=r}async updateChannelMediaRelay(r){if(this.state!==ls.RELAY_STATE_RUNNING)throw new pe(K.INVALID_OPERATION);await this.sendUpdateMessage(r),this.prevChannelMediaConfig=r}async setVideoProfile(r){if(this._resolution=r,this.state!==ls.RELAY_STATE_RUNNING)throw new pe(K.INVALID_OPERATION);const i=this.genMessage(Yi.SetVideoProfile);await this.signal.request(i),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),A.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=ls.RELAY_STATE_IDLE,this.dispose()}dispose(){A.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=zi.CancelToken.source(),this.state=ls.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const r=await Lve(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=r.workerToken,await this.signal.connect(r.addressList),this.emit("event",fl.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(r){const i=this.genMessage(Yi.SetSdkProfile,r);await this.signal.request(i),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const a=this.genMessage(Yi.SetSourceChannel,r);await this.signal.request(a),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",fl.PACKET_JOINED_SRC_CHANNEL),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const l=this.genMessage(Yi.SetSourceUserId,r);await this.signal.request(l),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const u=this.genMessage(Yi.SetDestChannel,r);await this.signal.request(u),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",fl.PACKET_JOINED_DEST_CHANNEL),A.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const p=this.genMessage(Yi.StartPacketTransfer,r);await this.signal.request(p),this.emit("event",fl.PACKET_SENT_TO_DEST_CHANNEL),this.state=ls.RELAY_STATE_RUNNING,A.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(r){const i=this.genMessage(Yi.UpdateDestChannel,r);await this.signal.request(i),this.emit("event",fl.PACKET_UPDATE_DEST_CHANNEL),A.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const r=this.genMessage(Yi.StopPacketTransfer);await this.signal.request(r),A.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(r,i){const a=[],l=[],u=[];this.requestId+=1;const p={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:fa,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};p.sdkVersion==="4.24.2"&&(p.sdkVersion="0.0.1");let m=null,g=null;switch(r){case Yi.SetSdkProfile:return p.clientRequest={command:"SetSdkProfile",type:"multi_channel"},p;case Yi.SetSourceChannel:if(g=i&&i.getSrcChannelMediaInfo(),!g)throw new pe(K.UNEXPECTED_ERROR,"can not find source config");return p.clientRequest={command:"SetSourceChannel",uid:"0",channelName:g.channelName,token:g.token||this.joinInfo.appId},p;case Yi.SetSourceUserId:if(g=i&&i.getSrcChannelMediaInfo(),!g)throw new pe(K.UNEXPECTED_ERROR,"can not find source config");return p.clientRequest={command:"SetSourceUserId",uid:g.uid+""},p;case Yi.SetDestChannel:if(m=i&&i.getDestChannelMediaInfo(),!m)throw new pe(K.UNEXPECTED_ERROR,"can not find dest config");return m.forEach(y=>{a.push(y.channelName),l.push(y.uid+""),u.push(y.token||this.joinInfo.appId)}),p.clientRequest={command:"SetDestChannel",channelName:a,uid:l,token:u},p;case Yi.StartPacketTransfer:return p.clientRequest={command:"StartPacketTransfer"},p;case Yi.Reconnect:return p.clientRequest={command:"Reconnect"},p;case Yi.StopPacketTransfer:return p.clientRequest={command:"StopPacketTransfer"},p;case Yi.UpdateDestChannel:if(m=i&&i.getDestChannelMediaInfo(),!m)throw new pe(K.UNEXPECTED_ERROR,"can not find dest config");return m.forEach(y=>{a.push(y.channelName),l.push(y.uid+""),u.push(y.token||this.joinInfo.appId)}),p.clientRequest={command:"UpdateDestChannel",channelName:a,uid:l,token:u},p;case Yi.SetVideoProfile:p.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return p}}const Ibe={name:"ChannelMediaRelay",create:function(t){return new Abe(t.joinInfo,t.clientId,t.websocketRetryConfig||er,t.httpRetryConfig||er,t.resolution)}};function B$(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function iv(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?B$(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):B$(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}class Obe extends Pn{constructor(r,i,a,l){super(),F(this,"spec",void 0),F(this,"token",void 0),F(this,"websocket",void 0),F(this,"pingpongTimer",void 0),F(this,"reconnectMode","retry"),F(this,"serviceMode",void 0),F(this,"reqId",0),F(this,"commandReqId",0),F(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),F(this,"handleWebSocketMessage",u=>{if(!u.data)return;const p=JSON.parse(u.data);p.requestId?this.emit("@".concat(p.requestId,"-").concat(p.sid),p):(Ye.workerEvent(this.spec.sid,{actionType:"status",serverCode:p.code,workerType:this.serviceMode===ml.TRANSCODE?1:2}),this.emit(yd.PUBLISH_STREAM_STATUS,p))}),this.spec=i,this.token=r,this.serviceMode=l,this.websocket=new C0("live-streaming",a),this.websocket.on(wt.CONNECTED,this.handleWebSocketOpen),this.websocket.on(wt.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(wt.REQUEST_NEW_URLS,(u,p)=>{or(this,yd.REQUEST_NEW_ADDRESS).then(u).catch(p)}),this.websocket.on(wt.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(r){return this.websocket.init(r)}async request(r,i,a,l){this.reqId+=1,r==="request"&&(this.commandReqId+=1);const u=this.commandReqId,p=this.reqId;if(!p||!this.websocket)throw new pe(K.UNEXPECTED_ERROR);const m=iv({command:r,sdkVersion:fa==="4.24.2"?"0.0.1":fa,seq:p,requestId:p,allocate:a,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},i);if(this.websocket.state==="closed")throw new pe(K.WS_DISCONNECT);const g=()=>new je((T,C)=>{this.websocket.once(wt.CLOSED,()=>C(new pe(K.WS_ABORT))),this.websocket.once(wt.CONNECTED,T)});this.websocket.state!=="connected"&&await g(),m.clientRequest&&(m.clientRequest.workerToken=this.token);const y=new je((T,C)=>{const V=()=>{C(new pe(K.WS_ABORT))};this.websocket.once(wt.RECONNECTING,V),this.websocket.once(wt.CLOSED,V),this.once("@".concat(p,"-").concat(this.spec.sid),j=>{T(j)})});l&&Ye.workerEvent(this.spec.sid,iv(iv({},l),{},{requestId:u,actionType:"request",payload:JSON.stringify(i.clientRequest),serverCode:0,code:0}));const x=Date.now();this.websocket.sendMessage(m);let S=null;try{S=await y}catch(T){if(this.websocket.state==="closed")throw T;return await g(),await this.request(r,i,a)}return l&&Ye.workerEvent(this.spec.sid,iv(iv({},l),{},{requestId:u,actionType:"response",payload:JSON.stringify(S.serverResponse),serverCode:S.code,success:S.code===200,responseTime:Date.now()-x})),S.code!==200&&this.handleResponseError(S),S}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const r=fa==="4.24.2"?"0.0.1":fa;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:r,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(r){switch(r.code){case mr.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void A.warning("live stream response already exists stream");case mr.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case mr.LIVE_STREAM_RESPONSE_BAD_STREAM:case mr.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new pe(K.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:r.code}).throw();case mr.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(r.serverResponse.command==="UnpublishStream")return;throw new pe(K.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case mr.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new pe(K.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:r.code}).throw();case mr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const i=new pe(K.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(yd.WARNING,i,r.serverResponse.url)}case mr.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const i=new pe(K.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(yd.WARNING,i,r.serverResponse.url)}case mr.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new pe(K.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case mr.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new pe(K.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:r.code}).throw();case mr.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const i=new pe(K.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(yd.WARNING,i,r.serverResponse.url)}case mr.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new pe(K.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:r.code}).throw();case mr.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new pe(K.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case mr.LIVE_STREAM_RESPONSE_WORKER_LOST:case mr.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(r.serverResponse.command==="UnpublishStream")return;throw new pe(K.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case mr.ERROR_FAIL_SEND_MESSAGE:if(r.serverResponse.command==="UnpublishStream")return;if(r.serverResponse.command==="UpdateTranscoding"||r.serverResponse.command==="ControlStream")return new pe(K.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:r.code}).throw();throw new pe(K.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case mr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case mr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case mr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case mr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new pe(K.LIVE_STREAMING_CDN_ERROR,"",{code:r.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(b0)},6e3)}}function G$(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function us(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?G$(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):G$(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}class Pbe extends Pn{constructor(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:er,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:er;super(),F(this,"onLiveStreamWarning",void 0),F(this,"onLiveStreamError",void 0),F(this,"spec",void 0),F(this,"retryTimeout",1e4),F(this,"connection",void 0),F(this,"httpRetryConfig",void 0),F(this,"wsRetryConfig",void 0),F(this,"streamingTasks",new Map),F(this,"isStartingStreamingTask",!1),F(this,"taskMutex",new kr("live-streaming")),F(this,"cancelToken",zi.CancelToken.source()),F(this,"transcodingConfig",void 0),F(this,"uapResponse",void 0),F(this,"lastTaskId",1),F(this,"statusError",new Map),this.spec=r,this.httpRetryConfig=a,this.wsRetryConfig=i}async setTranscodingConfig(r){const i=us(us({},fve),r);i.videoCodecProfile!==66&&i.videoCodecProfile!==77&&i.videoCodecProfile!==100&&(A.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(i.videoCodecProfile," -> 100")),i.videoCodecProfile=100),i.transcodingUsers||(i.transcodingUsers=i.userConfigs),i.transcodingUsers&&(i.transcodingUsers=i.transcodingUsers.map(p=>us(us(us({},mve),p),{},{zOrder:p.zOrder?p.zOrder+1:1}))),function(p){Mn(p.width)||un(p.width,"config.width",0,1e4),Mn(p.height)||un(p.height,"config.height",0,1e4),Mn(p.videoBitrate)||un(p.videoBitrate,"config.videoBitrate",1,1e6),Mn(p.videoFrameRate)||un(p.videoFrameRate,"config.videoFrameRate"),Mn(p.lowLatency)||qa(p.lowLatency,"config.lowLatency"),Mn(p.audioSampleRate)||Zn(p.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),Mn(p.audioBitrate)||un(p.audioBitrate,"config.audioBitrate",1,128),Mn(p.audioChannels)||Zn(p.audioChannels,"config.audioChannels",[1,2,3,4,5]),Mn(p.videoGop)||un(p.videoGop,"config.videoGop"),Mn(p.videoCodecProfile)||Zn(p.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),Mn(p.userCount)||un(p.userCount,"config.userCount",0,17),Mn(p.backgroundColor)||un(p.backgroundColor,"config.backgroundColor",0,16777215),Mn(p.userConfigExtraInfo)||Wr(p.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),p.transcodingUsers&&!Mn(p.transcodingUsers)&&(hl(p.transcodingUsers,"config.transcodingUsers"),p.transcodingUsers.forEach((m,g)=>{E_(m.uid),Mn(m.x)||un(m.x,"transcodingUser[".concat(g,"].x"),0,1e4),Mn(m.y)||un(m.y,"transcodingUser[".concat(g,"].y"),0,1e4),Mn(m.width)||un(m.width,"transcodingUser[".concat(g,"].width"),0,1e4),Mn(m.height)||un(m.height,"transcodingUser[".concat(g,"].height"),0,1e4),Mn(m.zOrder)||un(m.zOrder-1,"transcodingUser[".concat(g,"].zOrder"),0,100),Mn(m.alpha)||un(m.alpha,"transcodingUser[".concat(g,"].alpha"),0,1,!1)})),Mn(p.watermark)||v1(p.watermark,"watermark"),Mn(p.backgroundImage)||v1(p.backgroundImage,"backgroundImage"),p.images&&!Mn(p.images)&&(hl(p.images,"config.images"),p.images.forEach((m,g)=>{v1(m,"images[".concat(g,"]"))}))}(i);const a=[];i.images&&a.push(...i.images.map(p=>us(us(us({},g1),p),{},{zOrder:255}))),i.backgroundImage&&(a.push(us(us(us({},g1),i.backgroundImage),{},{zOrder:0})),delete i.backgroundImage),i.watermark&&(a.push(us(us(us({},g1),i.watermark),{},{zOrder:255})),delete i.watermark),i.images=a,i.transcodingUsers&&(i.userConfigs=i.transcodingUsers.map(p=>us({},p)),i.userCount=i.transcodingUsers.length,delete i.transcodingUsers);const l=(i.userConfigs||[]).map(p=>typeof p.uid=="number"?je.resolve(p.uid):cG(p.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await je.all(l)).forEach((p,m)=>{i.userConfigs&&i.userConfigs[m]&&(i.userConfigs[m].uid=p)}),this.transcodingConfig=i,this.connection)try{var u;const p=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(Ns(u=this.streamingTasks).call(u)).map(m=>m.taskId).join("#")});A.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(p.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(p){if(!p.data||!p.data.retry)throw p;p.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(m=>{A.warning("[".concat(this.spec.clientId,"] live streaming receive error"),p.toString(),"try to republish",m.url),this.startLiveStreamingTask(m.url,m.mode,p).then(()=>{A.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(m.url," success"))}).catch(g=>{A.error("[".concat(this.spec.clientId,"] live streaming republish failed"),m.url,g.toString()),this.onLiveStreamError&&this.onLiveStreamError(m.url,g)})})}}async startLiveStreamingTask(r,i,a){if(!this.transcodingConfig&&i===ml.TRANSCODE)throw new pe(K.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const l={command:"PublishStream",ts:Date.now(),url:r,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};A.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(r,", mode: ").concat(i));const u=await this.taskMutex.lock();if(!this.connection&&a)return void u();if(this.streamingTasks.get(r)&&!a)return u(),new pe(K.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(i))}catch(m){throw u(),m}switch(i){case ml.TRANSCODE:l.transcodingConfig=us({},this.transcodingConfig)}this.uapResponse&&this.uapResponse.vid&&(l.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const p=this.lastTaskId++;try{const m=new je((y,x)=>{Er(this.retryTimeout).then(()=>{if(a)return x(a);const S=this.statusError.get(r);return S?(this.statusError.delete(r),x(S)):void 0})}),g=await je.race([this.connection.request("request",{clientRequest:l},!0,{url:r,command:"PublishStream",workerType:i===ml.TRANSCODE?1:2,requestByUser:!a,tid:p.toString()}),m]);this.isStartingStreamingTask=!1,A.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(g.code)),this.streamingTasks.set(r,{clientRequest:l,mode:i,url:r,taskId:p}),u()}catch(m){if(u(),this.isStartingStreamingTask=!1,!m.data||!m.data.retry||a)throw m;return m.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(r,i,m)):await this.startLiveStreamingTask(r,i,m)}}stopLiveStreamingTask(r){return new je((i,a)=>{const l=this.streamingTasks.get(r);if(!l||!this.connection)return new pe(K.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const u=l.mode;l.abortTask=()=>{A.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(r),i()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:l.url}},!1,{url:r,command:"UnPublishStream",workerType:u===ml.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(p=>{A.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(p.code)),this.streamingTasks.delete(r),this.streamingTasks.size===0&&(this.connection&&this.connection.close(),this.connection=void 0),i()}).catch(a)})}resetAllTask(){var r;const i=Array.from(Ns(r=this.streamingTasks).call(r));this.terminate();for(const a of i)this.startLiveStreamingTask(a.url,a.mode).catch(l=>{this.onLiveStreamError&&this.onLiveStreamError(a.url,l)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=zi.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(r){if(this.connection)throw new pe(K.UNEXPECTED_ERROR,"live streaming connection has already connected");const i=await or(this,y1.REQUEST_WORKER_MANAGER_LIST,r);return this.uapResponse=i,this.connection=new Obe(i.workerToken,this.spec,this.wsRetryConfig,r),this.connection.on(yd.WARNING,(a,l)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(l,a)),this.connection.on(yd.PUBLISH_STREAM_STATUS,a=>this.handlePublishStreamServer(a)),this.connection.on(yd.REQUEST_NEW_ADDRESS,(a,l)=>{if(!this.connection)return l(new pe(K.UNEXPECTED_ERROR,"can not get new live streaming address list"));or(this,y1.REQUEST_WORKER_MANAGER_LIST,r).then(u=>{this.uapResponse=u,a(u.addressList)}).catch(l)}),await this.connection.init(i.addressList),this.connection}handlePublishStreamServer(r){const i=r.serverStatus&&r.serverStatus.url||"empty_url",a=this.streamingTasks.get(i),l=r.reason;switch(r.code){case mr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case mr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case mr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case mr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const p=new pe(K.LIVE_STREAMING_CDN_ERROR,"",{code:r.code});if(a)return A.error(p.toString()),this.onLiveStreamError&&this.onLiveStreamError(i,p);if(!this.isStartingStreamingTask)return;this.statusError.set(i,p)}case mr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const p=new pe(K.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,l);return this.onLiveStreamWarning&&this.onLiveStreamWarning(i,p)}case mr.LIVE_STREAM_RESPONSE_WORKER_LOST:case mr.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var u;if(!this.connection)return;this.connection.tryNextAddress();const p=Array.from(Ns(u=this.streamingTasks).call(u));for(const m of p)m.abortTask?m.abortTask():(A.warning("[".concat(this.spec.clientId,"] publish stream status code"),r.code,"try to republish",m.url),this.startLiveStreamingTask(m.url,m.mode,new pe(K.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:r.code})).then(()=>{A.debug("[".concat(this.spec.clientId,"] republish live stream success"),m.url)}).catch(g=>{A.error(g.toString()),this.onLiveStreamError&&this.onLiveStreamError(m.url,g)}));return}}}hasUrl(r){return this.streamingTasks.has(r)}}const kbe={name:"LiveStreaming",create:function(t){return new Pbe(t.joinInfo,t.websocketRetryConfig||er,t.httpRetryConfig||er)}};function jbe(t){let r=z$();return function(i,a){let l=i.appId;l!==void 0&&(sn(a,10),Uc(a,l));let u=i.cid;u!==void 0&&(sn(a,16),sn(a,u));let p=i.cname;p!==void 0&&(sn(a,26),Uc(a,p));let m=i.deviceId;m!==void 0&&(sn(a,34),Uc(a,m));let g=i.elapse;g!==void 0&&(sn(a,40),Od(a,g));let y=i.fileSize;y!==void 0&&(sn(a,48),Od(a,jm(y)));let x=i.height;x!==void 0&&(sn(a,56),Od(a,jm(x)));let S=i.jpg;S!==void 0&&(sn(a,66),sn(a,S.length),function(An,_e){let Oe=Dm(An,_e.length);An.bytes.set(_e,Oe)}(a,S));let T=i.networkType;T!==void 0&&(sn(a,72),Od(a,jm(T)));let C=i.osType;C!==void 0&&(sn(a,80),Od(a,jm(C)));let V=i.requestId;V!==void 0&&(sn(a,90),Uc(a,V));let j=i.sdkVersion;j!==void 0&&(sn(a,98),Uc(a,j));let L=i.sequence;L!==void 0&&(sn(a,104),Od(a,jm(L)));let H=i.sid;H!==void 0&&(sn(a,114),Uc(a,H));let Y=i.timestamp;Y!==void 0&&(sn(a,120),Od(a,Y));let te=i.uid;te!==void 0&&(sn(a,128),sn(a,te));let se=i.vid;se!==void 0&&(sn(a,136),sn(a,se));let oe=i.width;oe!==void 0&&(sn(a,144),Od(a,jm(oe)));let ne=i.service;ne!==void 0&&(sn(a,152),sn(a,ne));let de=i.callbackData;de!==void 0&&(sn(a,162),Uc(a,de));let be=i.jpgEncryption;be!==void 0&&(sn(a,168),sn(a,be));let Se=i.requestType;Se!==void 0&&(sn(a,176),sn(a,Se));let Be=i.scorePorn;Be!==void 0&&(sn(a,185),PI(a,Be));let mt=i.scoreSexy;mt!==void 0&&(sn(a,193),PI(a,mt));let ut=i.scoreNeutral;ut!==void 0&&(sn(a,201),PI(a,ut));let Tt=i.scene;Tt!==void 0&&(sn(a,208),sn(a,Tt));let Et=i.ossFilePrefix;Et!==void 0&&(sn(a,218),Uc(a,Et));let Xt=i.serviceVendor;if(Xt!==void 0)for(let An of Xt){sn(a,226);let _e=z$();Mbe(An,_e),sn(a,_e.limit),Bbe(a,_e),Vbe(_e)}}(t,r),function(i){let a=i.bytes,l=i.limit;return a.length===l?a:a.subarray(0,l)}(r)}function Dbe(t){return function(i){let a={};e:for(;!H$(i);){let l=Fc(i);switch(l>>>3){case 0:break e;case 1:a.code=Fc(i);break;case 2:a.msg=K$(i,Fc(i));break;case 3:{let u=Ube(i);a.data=Lbe(i),i.limit=u;break}default:W$(i,7&l)}}return a}({bytes:r=t,offset:0,limit:r.length});var r}function Lbe(t){let r={};e:for(;!H$(t);){let i=Fc(t);switch(i>>>3){case 0:break e;case 1:r.requestId=K$(t,Fc(t));break;case 2:r.requestType=Fc(t)>>>0;break;case 3:r.scorePorn=OI(t);break;case 4:r.scoreSexy=OI(t);break;case 5:r.scoreNeutral=OI(t);break;case 6:r.requestScene=Fc(t)>>>0;break;case 7:r.scene=Fc(t)>>>0;break;default:W$(t,7&i)}}return r}function Mbe(t,r){let i=t.service;i!==void 0&&(sn(r,8),sn(r,i));let a=t.vendor;a!==void 0&&(sn(r,16),sn(r,a));let l=t.token;l!==void 0&&(sn(r,26),Uc(r,l));let u=t.callbackUrl;u!==void 0&&(sn(r,34),Uc(r,u))}function Ube(t){let r=Fc(t),i=t.limit;return t.limit=t.offset+r,i}function W$(t,r){switch(r){case 0:for(;128&Y$(t););break;case 2:AI(t,Fc(t));break;case 5:AI(t,4);break;case 1:AI(t,8);break;default:throw new Error("Unimplemented type: "+r)}}let Fbe=new Float32Array(1);new Uint8Array(Fbe.buffer);let RI=new Float64Array(1),hs=new Uint8Array(RI.buffer);function jm(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}let $$=[];function z$(){const t=$$.pop();return t?(t.offset=t.limit=0,t):{bytes:new Uint8Array(64),offset:0,limit:0}}function Vbe(t){$$.push(t)}function AI(t,r){if(t.offset+r>t.limit)throw new Error("Skip past limit");t.offset+=r}function H$(t){return t.offset>=t.limit}function Dm(t,r){let i=t.bytes,a=t.offset,l=t.limit,u=a+r;if(u>i.length){let p=new Uint8Array(2*u);p.set(i),t.bytes=p}return t.offset=u,u>l&&(t.limit=u),a}function II(t,r){let i=t.offset;if(i+r>t.limit)throw new Error("Read past limit");return t.offset+=r,i}function K$(t,r){let i=II(t,r),a=String.fromCharCode,l=t.bytes,u="",p="";for(let m=0;m<r;m++){let g,y,x,S,T=l[m+i];128&T?(224&T)==192?m+1>=r?p+=u:(g=l[m+i+1],(192&g)!=128?p+=u:(S=(31&T)<<6|63&g,S<128?p+=u:(p+=a(S),m++))):(240&T)==224?m+2>=r?p+=u:(g=l[m+i+1],y=l[m+i+2],(49344&(g|y<<8))!=32896?p+=u:(S=(15&T)<<12|(63&g)<<6|63&y,S<2048||S>=55296&&S<=57343?p+=u:(p+=a(S),m+=2))):(248&T)==240?m+3>=r?p+=u:(g=l[m+i+1],y=l[m+i+2],x=l[m+i+3],(12632256&(g|y<<8|x<<16))!=8421504?p+=u:(S=(7&T)<<18|(63&g)<<12|(63&y)<<6|63&x,S<65536||S>1114111?p+=u:(S-=65536,p+=a(55296+(S>>10),56320+(1023&S)),m+=3))):p+=u:p+=a(T)}return p}function Uc(t,r){let i=r.length,a=0;for(let p=0;p<i;p++){let m=r.charCodeAt(p);m>=55296&&m<=56319&&p+1<i&&(m=(m<<10)+r.charCodeAt(++p)-56613888),a+=m<128?1:m<2048?2:m<65536?3:4}sn(t,a);let l=Dm(t,a),u=t.bytes;for(let p=0;p<i;p++){let m=r.charCodeAt(p);m>=55296&&m<=56319&&p+1<i&&(m=(m<<10)+r.charCodeAt(++p)-56613888),m<128?u[l++]=m:(m<2048?u[l++]=m>>6&31|192:(m<65536?u[l++]=m>>12&15|224:(u[l++]=m>>18&7|240,u[l++]=m>>12&63|128),u[l++]=m>>6&63|128),u[l++]=63&m|128)}}function Bbe(t,r){let i=Dm(t,r.limit),a=t.bytes,l=r.bytes;for(let u=0,p=r.limit;u<p;u++)a[u+i]=l[u]}function Y$(t){return t.bytes[II(t,1)]}function q$(t,r){let i=Dm(t,1);t.bytes[i]=r}function OI(t){let r=II(t,8),i=t.bytes;return hs[0]=i[r++],hs[1]=i[r++],hs[2]=i[r++],hs[3]=i[r++],hs[4]=i[r++],hs[5]=i[r++],hs[6]=i[r++],hs[7]=i[r++],RI[0]}function PI(t,r){let i=Dm(t,8),a=t.bytes;RI[0]=r,a[i++]=hs[0],a[i++]=hs[1],a[i++]=hs[2],a[i++]=hs[3],a[i++]=hs[4],a[i++]=hs[5],a[i++]=hs[6],a[i++]=hs[7]}function Fc(t){let r,i=0,a=0;do r=Y$(t),i<32&&(a|=(127&r)<<i),i+=7;while(128&r);return a}function sn(t,r){for(r>>>=0;r>=128;)q$(t,127&r|128),r>>>=7;q$(t,r)}function Od(t,r){let i=r.low>>>0,a=(r.low>>>28|r.high<<4)>>>0,l=r.high>>>24,u=l===0?a===0?i<16384?i<128?1:2:i<1<<21?3:4:a<16384?a<128?5:6:a<1<<21?7:8:l<128?9:10,p=Dm(t,u),m=t.bytes;switch(u){case 10:m[p+9]=l>>>7&1;case 9:m[p+8]=u!==9?128|l:127&l;case 8:m[p+7]=u!==8?a>>>21|128:a>>>21&127;case 7:m[p+6]=u!==7?a>>>14|128:a>>>14&127;case 6:m[p+5]=u!==6?a>>>7|128:a>>>7&127;case 5:m[p+4]=u!==5?128|a:127&a;case 4:m[p+3]=u!==4?i>>>21|128:i>>>21&127;case 3:m[p+2]=u!==3?i>>>14|128:i>>>14&127;case 2:m[p+1]=u!==2?i>>>7|128:i>>>7&127;case 1:m[p]=u!==1?128|i:127&i}}function X$(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}const Gbe=new Map([["moderation",1],["supervise",2]]);class Wbe extends Pn{get connectionState(){return this._connectionState}set connectionState(r){if(this._connectionState===r)return;const i=this._connectionState;this._connectionState=r,this.emit(Dr.CONNECTION_STATE_CHANGE,i,r)}get inspectType(){return this._inspectType}set inspectType(r){var i;this._inspectMode=pa(i=r.map(a=>Gbe.get(a)||0)).call(i,(a,l)=>a+l),this._inspectType=r}get quality(){return this._quality}set quality(r){this._quality=r>1?1:r<.1?.1:r,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(r){super(),F(this,"name","AgoraRTCVideoContentInspect"),F(this,"_connectionState",eo.CONNECTING),F(this,"_innerConnectionState",void 0),F(this,"sequence",0),F(this,"inspectStartTime",void 0),F(this,"workerManagerConnection",void 0),F(this,"workerConnection",void 0),F(this,"workerMessageLengthLimit",void 0),F(this,"inspectIntervalMinimum",void 0),F(this,"qualityRatio",void 0),F(this,"_connectInfo",void 0),F(this,"_cancelTokenSource",zi.CancelToken.source()),F(this,"_retryConfig",void 0),F(this,"wmSequence",0),F(this,"inspectInterval",void 0),F(this,"inspectTimer",null),F(this,"ossFilePrefix",void 0),F(this,"extraInfo",void 0),F(this,"_inspectType",void 0),F(this,"_inspectMode",void 0),F(this,"_quality",1),F(this,"qualityTimer",null),F(this,"_inspectId",void 0),F(this,"_needWorkUrlOnly",!1),F(this,"inspectImage",()=>{if(this.connectionState!==eo.CONNECTED)throw new pe(K.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===eo.CONNECTED?this.requestToInspectImage():A.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=tn(5,"inspect-"),this.workerMessageLengthLimit=W("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=W("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=W("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=r.interval,this.ossFilePrefix=r.ossFilePrefix,this.extraInfo=r.extraInfo,this.inspectType=r.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new C0("worker-manager-"+this._inspectId,er),this.on(Dr.STATE_CHANGE,(i,a)=>{this._innerConnectionState=i,A.debug("[".concat(this._inspectId,"] Inspect operation :").concat(to[i]," ").concat(a||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new C0("worker-"+this._inspectId,er),this.handleWorkerEvents()}async init(r,i){this.emit(Dr.STATE_CHANGE,to.CONNECT_AP),this._connectInfo=r;const a=this._cancelTokenSource.token;return this._retryConfig=i,new je((l,u)=>{this.on(Dr.CONNECTION_STATE_CHANGE,(p,m)=>{m===eo.CONNECTED&&l()}),this.requestAP(r,a,i).then(p=>{this.connectWorkerManager(p)}).catch(p=>{u(p)})})}async requestAP(r,i,a){const l=W("WEBCS_DOMAIN").map(m=>"https://".concat(m,"/api/v1")),u=await function(m,g,y,x){let{appId:S,areaCode:T,cname:C,sid:V,token:j,uid:L}=g;Em++;const H="image_moderation_api",Y={service_name:H,json_body:JSON.stringify({appId:S,areaCode:T,cname:C,command:"allocateEdge",requestId:Em,seq:Em,sid:V,token:j,ts:Date.now(),uid:L+""})};let te,se,oe=m[0];return Uo(async()=>{te=Date.now();const ne=await $o(oe,{data:Y,cancelToken:y,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(se=Date.now()-te,ne.code!==0){const ut=new pe(K.UNEXPECTED_RESPONSE,"image inspect ap error, code"+ne.code,{retry:!0,responseTime:se});throw A.error(ut.toString()),ut}const de=JSON.parse(ne.json_body);if(de.code!==200){const ut=new pe(K.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(de.code,", reason: ").concat(de.reason),{code:de.code,responseTime:se});throw A.error(ut.toString()),ut}if(!de.servers||!Array.isArray(de.servers)||de.servers.length===0){const ut=new pe(K.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:de.code,responseTime:se});throw A.error(ut.toString()),ut}const be=W("VIDEO_INSPECT_WORKER_MANAGER_WSS");if(be)return{addressList:[be],workerToken:de.workerToken,vid:de.vid,responseTime:se};const Se=W("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Be=W("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:de.servers.map(ut=>{let{address:Tt,wss:Et}=ut;if(Tt&&Et)return"wss://".concat(Tt.replace(/\./g,"-"),".").concat(Se,":").concat(Be||Et)}).filter(ut=>!!ut),workerToken:de.workerToken,vid:de.vid,responseTime:se}},(ne,de)=>(Ye.apworkerEvent(V,{success:!0,sc:200,serviceName:H,responseDetail:JSON.stringify(ne.addressList),firstSuccess:de===0,responseTime:se,serverIp:m[de%m.length]}),!1),(ne,de)=>(Ye.apworkerEvent(V,{success:!1,sc:ne.data&&ne.data.code||200,serviceName:H,responseTime:se,serverIp:m[de%m.length]}),!!(ne.code!==K.OPERATION_ABORTED&&ne.code!==K.UNEXPECTED_RESPONSE||ne.data&&ne.data.retry)&&(oe=m[(de+1)%m.length],!0)),x)}(l,r,i,a);this.emit(Dr.STATE_CHANGE,to.AP_CONNECTED);const{addressList:p}=u;return this.wmSequence++,p}async connectWorkerManager(r){let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=i,this.emit(Dr.STATE_CHANGE,to.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(r,1e4)}async connectWorker(r){await this.workerConnection.init([r])}handleWorkerManagerEvents(){this.workerManagerConnection.on(wt.CONNECTED,async()=>{this.emit(Dr.STATE_CHANGE,to.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.24.2",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(wt.CLOSED,()=>{this._innerConnectionState<to.GET_WORKER_MANAGER_RESPONSE&&A.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(wt.FAILED,()=>{this._innerConnectionState<to.GET_WORKER_MANAGER_RESPONSE&&A.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(wt.RECONNECTING,()=>{this._innerConnectionState<to.GET_WORKER_MANAGER_RESPONSE&&A.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(wt.ON_MESSAGE,async r=>{this.emit(Dr.STATE_CHANGE,to.GET_WORKER_MANAGER_RESPONSE);const i=this.workerManagerConnection.url;this.workerManagerConnection.close();const a=JSON.parse(r.data);if(a.code!==200)throw A.error("[".concat(this._inspectId,"] Unexpected code ").concat(a.code," from worker manager")),new pe(K.UNEXPECTED_RESPONSE,"response code of worker is unexpected",a);if(!(a.serverResponse&&a.serverResponse.portWss&&i))throw A.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(a))),new pe(K.UNEXPECTED_RESPONSE,"response content of worker is unexpected",a);{const l=W("VIDEO_INSPECT_WORKER_PORT")||a.serverResponse.portWss,u=i.replace(/:\d+\/?$/,":".concat(l));this.emit(Dr.STATE_CHANGE,to.CONNECT_WORKER,u),this._needWorkUrlOnly?this.emit(Dr.REQUEST_NEW_WORKER_URL,u):await this.connectWorker(u)}}),this.workerManagerConnection.on(wt.WILL_RECONNECT,(r,i,a)=>{a(r)}),this.workerManagerConnection.on(wt.REQUEST_NEW_URLS,(r,i)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(r).catch(i)})}handleWorkerEvents(){this.workerConnection.on(wt.CONNECTED,async()=>{this.emit(Dr.STATE_CHANGE,to.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=eo.CONNECTED}),this.workerConnection.on(wt.ON_MESSAGE,async r=>{if(r.data instanceof ArrayBuffer){const a=Dbe(new Uint8Array(r.data));if(W("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&A.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(a)),a.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(Dr.INSPECT_RESULT,void 0,void 0);if(a.data&&a.data.scorePorn&&a.data.scoreSexy&&a.data.scoreNeutral){var i;const l={porn:a.data.scorePorn,sexy:a.data.scoreSexy,neutral:a.data.scoreNeutral},u=pa(i=Object.keys(l)).call(i,(m,g)=>l[m]>l[g]?m:g,"porn"),p=Object.keys(l).find(m=>m===u);this.emit(Dr.INSPECT_RESULT,p)}else this.emit(Dr.INSPECT_RESULT,void 0,new pe(K.UNEXPECTED_RESPONSE,a.code+"","There is an unexpected data on message"))}else this.emit(Dr.INSPECT_RESULT,void 0,new pe(K.UNEXPECTED_RESPONSE,a.code+"",a.msg))}else A.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(Dr.INSPECT_RESULT,void 0,new pe(K.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(wt.CLOSED,()=>{this.connectionState=eo.CLOSED}),this.workerConnection.on(wt.FAILED,()=>{this.connectionState=eo.CLOSED}),this.workerConnection.on(wt.RECONNECTING,()=>{this.connectionState=this.connectionState===eo.CONNECTED?eo.RECONNECTING:eo.CONNECTING}),this.workerConnection.on(wt.WILL_RECONNECT,(r,i,a)=>{r==="recover"&&a(r),a("tryNext")}),this.workerConnection.on(wt.REQUEST_NEW_URLS,(r,i)=>{this.workerManagerConnection.close(),this.once(Dr.REQUEST_NEW_WORKER_URL,a=>{r([a])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(a=>{this.connectWorkerManager(a,!0)}).catch(a=>{i(a)})})}async requestToInspectImage(){this.sequence++;const r=As(this,Dr.CLIENT_LOCAL_VIDEO_TRACK),i={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(r){if(!r.isPlaying)return void this.emit(Dr.INSPECT_RESULT,void 0,new pe(K.INVALID_OPERATION,"Only the track being played can be inspected"));const a=await this.generateRequestData(r,i);this.workerConnection.sendMessage(a,!0,!0)}else this.emit(Dr.INSPECT_RESULT,void 0,new pe(K.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(r,i){let{appId:a,cname:l,cid:u,vid:p,sid:m,uid:g}=i;const y=Date.now(),x=await r.getCurrentFrameImage("image/jpeg",this.quality),S=await T6(x,a,l),T=this.sequence+"-"+u+"-"+g+"-"+y+"-"+tn(12,""),C={appId:a,cid:u,cname:l,deviceId:"",elapse:(V=Number(y-this.inspectStartTime),{low:V|=0,high:V>>31,unsigned:V>=0}),fileSize:S.byteLength,jpgEncryption:2,height:x.height,width:x.width,jpg:S,networkType:6,osType:7,requestId:T,sdkVersion:"4.24.2",sequence:this.sequence,sid:m,timestamp:eW(y),uid:g,vid:p,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var V;this.extraInfo===void 0&&delete C.callbackData,this.ossFilePrefix===void 0&&delete C.ossFilePrefix;const j=jbe(C);if(j.byteLength<this.workerMessageLengthLimit){if(W("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const L=function(H){for(var Y=1;Y<arguments.length;Y++){var te=arguments[Y]!=null?arguments[Y]:{};Y%2?X$(Object(te),!0).forEach(function(se){F(H,se,te[se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(te)):X$(Object(te)).forEach(function(se){Object.defineProperty(H,se,Object.getOwnPropertyDescriptor(te,se))})}return H}({},C);delete L.jpg,A.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(L))}return j}{const L=this.quality*this.qualityRatio;return this.quality=L,await this.generateRequestData(r,{appId:a,cname:l,cid:u,vid:p,sid:m,uid:g})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=zi.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=eo.CLOSED,this.emit(Dr.STATE_CHANGE,to.CLOSED)}}const $be={name:"ContentInspect",create:function(t){let{config:r}=t;return function(i){if(!i)throw new pe(K.INVALID_PARAMS,"inspectConfig is necessary.");if(!i.inspectType||!Array.isArray(i.inspectType))throw new pe(K.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const a=[...new Set(i.inspectType)];a.forEach(l=>{var u;if(!Ce(u=["supervise","moderation"]).call(u,l))throw new pe(K.INVALID_PARAMS,"".concat(l," is not a valid inspect type."))}),i.inspectType=a}if(i&&i.extraInfo&&i.extraInfo.length>1024)throw new pe(K.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(r),new Wbe(r)}};var J$=d(yt.Object.getOwnPropertySymbols),zbe=en,Hbe=NN.indexOf,Kbe=Eb,kI=ce([].indexOf),Q$=!!kI&&1/kI([1],1,-0)<0;zbe({target:"Array",proto:!0,forced:Q$||!Kbe("indexOf")},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return Q$?kI(this,t,r)||0:Hbe(this,t,r)}});var Ybe=ha("Array","indexOf"),qbe=N,Xbe=Ybe,jI=Array.prototype,Jbe=function(t){var r=t.indexOf;return t===jI||qbe(jI,t)&&r===jI.indexOf?Xbe:r},Z$=d(Jbe);function Qbe(t,r){if(t==null)return{};var i,a,l=function(p,m){if(p==null)return{};var g={};for(var y in p)if({}.hasOwnProperty.call(p,y)){if(Z$(m).call(m,y)!==-1)continue;g[y]=p[y]}return g}(t,r);if(J$){var u=J$(t);for(a=0;a<u.length;a++)i=u[a],Z$(r).call(r,i)===-1&&{}.propertyIsEnumerable.call(t,i)&&(l[i]=t[i])}return l}let ez=class{get localCapabilities(){return Sn(this._localCapabilities)}get rtpCapabilities(){return Sn(this._rtpCapabilities)}get candidates(){return Sn(this._candidates)}get iceParameters(){return Sn(this._iceParameters)}get dtlsParameters(){return Sn(this._dtlsParameters)}constructor(t){F(this,"sessionDesc",void 0),F(this,"_localCapabilities",void 0),F(this,"_rtpCapabilities",void 0),F(this,"_candidates",void 0),F(this,"_iceParameters",void 0),F(this,"_dtlsParameters",void 0),F(this,"setup",void 0),F(this,"currentMidIndex",void 0),F(this,"cname","o/i14u9pJrxRKAsu"),F(this,"firefoxSsrcMidMap",new Map),t=Sn(t);const{remoteIceParameters:r,remoteDtlsParameters:i,candidates:a,remoteRTPCapabilities:l,localCapabilities:u,direction:p,setup:m,videoCodec:g,audioCodec:y}=t;let x;this.setup=m,x=p===Li.RECEIVE_ONLY?ki(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):ki(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=l,this._candidates=a,this._iceParameters=r,this._dtlsParameters=i,this._localCapabilities=u;const S=p===Li.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,T=p===Li.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,C=p===Li.RECEIVE_ONLY?l.send.videoCodecs:k0(ze.VIDEO,S,T,g),V=p===Li.RECEIVE_ONLY?l.send.audioCodecs:k0(ze.AUDIO,S,T,y);for(const j of x.mediaDescriptions)j.attributes.iceUfrag=r.iceUfrag,j.attributes.icePwd=r.icePwd,j.attributes.fingerprints=i.fingerprints,j.attributes.candidates=a,j.attributes.setup=this.setup,j.media.mediaType==="application"&&(j.attributes.sctpPort="5000"),j.media.mediaType==="video"&&(j.media.fmts=C.map(L=>L.payloadType.toString(10)),j.attributes.payloads=C,j.attributes.extmaps=S.videoExtensions),j.media.mediaType==="audio"&&(j.media.fmts=V.map(L=>L.payloadType.toString(10)),j.attributes.payloads=V,j.attributes.extmaps=S.audioExtensions,_m(j));this.sessionDesc=x,this.currentMidIndex=x.mediaDescriptions.length-1}toString(){return pl(this.sessionDesc)}hasMid(t){return Array.isArray(t)?t.every(r=>this.hasMid(r)):this.sessionDesc.mediaDescriptions.some(r=>r.attributes.mid===t)}send(t,r,i,a,l){i=i.replace(/ /g,"-");const{ssrcs:u,ssrcGroups:p}=O0(r,this.cname,W("SYNC_GROUP")?i:void 0),m=this.findPreloadMediaDesc(u);if(m){if(wn()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,m.attributes.mid),l&&(l.twcc||l.remb)){const g=this.sessionDesc.mediaDescriptions.indexOf(m);return this.sessionDesc.mediaDescriptions[g]=this.mungSendMediaDesc(m,l),{mid:m.attributes.mid,needExchangeSDP:!0}}return{mid:m.attributes.mid,needExchangeSDP:!1}}{const g=this.findAvailableMediaIndex(t,u,a);let y;return g===-1?(y=this.createOrRecycleSendMedia(t,u,p,"sendonly",a,l),this.updateBundleMids()):(y=Sn(this.sessionDesc.mediaDescriptions[g]),y.attributes.direction="sendonly",y.attributes.ssrcs=u,y.attributes.ssrcGroups=p,this.sessionDesc.mediaDescriptions[g]=this.mungSendMediaDesc(y,l)),wn()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,y.attributes.mid),{needExchangeSDP:!0,mid:y.attributes.mid}}}stopSending(t){const r=this.sessionDesc.mediaDescriptions.filter(i=>i.attributes.mid&&t.indexOf(i.attributes.mid)!==-1);if(r.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");r.forEach(i=>{i.attributes.ssrcs=[]}),this.updateBundleMids()}receive(t,r,i){const a=[];return t.forEach(l=>{const u=l._mediaStreamTrack.kind,p=this.findAvailableRecvMediaIndex(u);let m,g=!1;p===-1?(g=!0,m=this.createOrRecycleRecvMedia(l,[],"recvonly",r,i),this.updateBundleMids()):(m=Sn(this.sessionDesc.mediaDescriptions[p]),m.attributes.direction="recvonly"),a.push({mid:m.attributes.mid,needCreateTransceiver:g})}),a}stopReceiving(t){const r=this.sessionDesc.mediaDescriptions.filter(i=>t.indexOf(i.attributes.mid)!==-1);if(r.length!==t.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");r.forEach(i=>{i.media.port="0",i.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(t){const{foundation:r,protocol:i,address:a,port:l,type:u,relatedAddress:p,relatedPort:m,priority:g}=new RTCIceCandidate(t),y={foundation:r??"",componentId:"1",transport:i??"",priority:g?g+"":"",connectionAddress:a??"",port:l?l+"":"",type:u?u+"":"",relAddr:p??"",relPort:m?m+"":"",extension:{}};this.candidates.some(x=>x.priority===y.priority&&x.connectionAddress===y.connectionAddress&&x.port===y.port)||(this._candidates.push(y),this.sessionDesc.mediaDescriptions.forEach(x=>{x.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(t,r,i,a,l){const u=t._mediaStreamTrack.kind,p=this.rtpCapabilities.recv,m=k0(u,p,this.localCapabilities.send,u===ze.AUDIO?l:a),g=u===ze.VIDEO?p.videoExtensions:p.audioExtensions,y="".concat(++this.currentMidIndex);let x={media:{mediaType:u,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:m.map(T=>T.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:g,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:m,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(y)}};x=this.mungRecvMediaDsec(x,t);const S=this.findFirstClosedMedia(u);if(S){const T=this.sessionDesc.mediaDescriptions.indexOf(S);this.sessionDesc.mediaDescriptions[T]=x}else this.sessionDesc.mediaDescriptions.push(x);return x}muteRemote(t){const r=this.sessionDesc.mediaDescriptions.filter(i=>Ce(t).call(t,i.attributes.mid||""));if(r.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(i=>{i.attributes.direction="inactive"})}unmuteRemote(t){const r=this.sessionDesc.mediaDescriptions.filter(i=>Ce(t).call(t,i.attributes.mid||""));if(r.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(i=>{i.attributes.direction="recvonly"})}findAvailableMediaIndex(t,r,i){return this.sessionDesc.mediaDescriptions.findIndex(a=>{const l=a.media.mediaType===t&&a.media.port!=="0"&&(a.attributes.direction==="sendonly"||a.attributes.direction==="sendrecv")&&a.attributes.ssrcs.length===0;if(wn()){if(l){const u=this.firefoxSsrcMidMap.get(r[0].ssrcId);return!(u||a.attributes.mid!=="0"&&a.attributes.mid!=="1")||!(!u||u!==a.attributes.mid)}return!1}return l&&a.attributes.mid===i})}findAvailableRecvMediaIndex(t){return this.sessionDesc.mediaDescriptions.findIndex(r=>{const i=r.media.mediaType===t&&r.media.port!=="0"&&(r.attributes.direction==="recvonly"||r.attributes.direction==="sendrecv");return r.attributes.mid!=="0"&&r.attributes.mid!=="1"&&i})}predictReceivingMids(t){const r=[];for(let i=0;i<t;i++)r.push((this.currentMidIndex+i+1).toString(10));return r}restartICE(t){t=Sn(t),this._iceParameters=t,this.sessionDesc.mediaDescriptions.forEach(r=>{r.attributes.iceUfrag=t.iceUfrag,r.attributes.icePwd=t.icePwd})}createOrRecycleSendMedia(t,r,i,a,l,u){const p=this.rtpCapabilities.send,m=t===ze.VIDEO?p.videoCodecs:p.audioCodecs,g=t===ze.VIDEO?p.videoExtensions:p.audioExtensions;wn()&&(l="".concat(++this.currentMidIndex));let y={media:{mediaType:t,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:m.map(S=>S.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:g,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:i,rtcpFeedbackWildcards:[],payloads:m,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:a,rtcpMux:!0,rtcpRsize:!0,mid:l}};y=this.mungSendMediaDesc(y,u);const x=this.findFirstClosedMedia(t);if(x){const S=this.sessionDesc.mediaDescriptions.indexOf(x);this.sessionDesc.mediaDescriptions[S]=y}else this.sessionDesc.mediaDescriptions.push(y);return y}mungRecvMediaDsec(t,r,i){const a=Sn(t);return N1(a),sh(a,r),C1(a,r),$8(a),O_(a,i,this.localCapabilities.send),a}mungSendMediaDesc(t,r){const i=Sn(t);return O_(i,r,this.localCapabilities.recv),_m(i),i}updateRecvMedia(t,r){const i=this.sessionDesc.mediaDescriptions.findIndex(a=>a.attributes.mid===t);if(i!==-1){const a=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],r);this.sessionDesc.mediaDescriptions[i]=a}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(t=>t.media.port!=="0").map(t=>t.attributes.mid)}findPreloadMediaDesc(t){return this.sessionDesc.mediaDescriptions.find(r=>{var i;return((i=r.attributes)===null||i===void 0||(i=i.ssrcs[0])===null||i===void 0?void 0:i.ssrcId)===t[0].ssrcId})}findFirstClosedMedia(t){return this.sessionDesc.mediaDescriptions.find(r=>wn()?r.media.port==="0"&&r.media.mediaType===t:r.media.port==="0")}};const Zbe=["sdp"];var Tn;function tz(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function Pd(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?tz(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):tz(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}let nz=(Tn=class zm extends N8{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var r,i;return(r=(i=this.peerConnection.getReceivers()[0])===null||i===void 0||(i=i.transport)===null||i===void 0?void 0:i.state)!==null&&r!==void 0?r:null}get localCodecs(){return[]}set isInRestartIce(r){this._isInRestartIce=r}get isInRestartIce(){return this._isInRestartIce}constructor(r,i,a){super(r,i),F(this,"direction",void 0),F(this,"name",void 0),F(this,"store",void 0),F(this,"spec",void 0),F(this,"peerConnection",void 0),F(this,"initialOffer",void 0),F(this,"transport",void 0),F(this,"statsFilter",void 0),F(this,"localCandidateCount",0),F(this,"_isInRestartIce",!1),F(this,"mutex",void 0),F(this,"onLocalCandidate",void 0),F(this,"remoteSDP",void 0),F(this,"pendingCandidates",[]),F(this,"localCapabilities",void 0),F(this,"isReady",!1),F(this,"restartCnt",0),F(this,"curTurnServerIndex",0),this.store=i,this.spec=r,this.mutex=new kr("P2PConnection-mutex",i.clientId),this.peerConnection=new RTCPeerConnection(zm.resolvePCConfiguration(r,i.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=a??Li.SEND_ONLY,this.name=this.direction===Li.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=Zx(this.peerConnection,W("STATS_UPDATE_INTERVAL"),void 0,wn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(r){try{const i=await A1();if(this.localCapabilities=P0(i),r){const{sdp:a}=r,l=Qbe(r,Zbe),u=function(){const x={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},S=I0(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),T={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},C={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},V={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ro(S,x,"videoExtensions",T,C,V),ro(S,x,"videoCodecs",T,C,V),ro(S,x,"audioExtensions",T,C,V),ro(S,x,"audioCodecs",T,C,V),W("RAISE_H264_BASELINE_PRIORITY")){const j=V.videoCodecs.findIndex(L=>L.rtpMap&&L.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&L.fmtp&&L.fmtp.parameters["profile-level-id"]==="42001f");if(j!==-1){const L=V.videoCodecs.findIndex(H=>H.rtpMap&&H.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(L<j){A.debug("raising H264 baseline profile priority");const H=V.videoCodecs[j];V.videoCodecs.splice(j,1),V.videoCodecs.splice(L,0,H)}L!==-1&&W("FILTER_SEND_H264_BASELINE")&&(T.videoCodecs=T.videoCodecs.filter(H=>!(H.rtpMap&&H.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&H.fmtp&&H.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:T,recv:C,sendrecv:V}}({},{},a);this.remoteSDP=new ez({remoteIceParameters:l.iceParameters,remoteDtlsParameters:l.dtlsParameters,candidates:[],remoteRTPCapabilities:u,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const p=await this.peerConnection.createAnswer();if(!p.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const m=Ic(p.sdp);await this.peerConnection.setLocalDescription(p);const g=await H8({},{},p.sdp);this.localCapabilities=P0(g);const y=this.peerConnection.getTransceivers()[0];return y!=null&&y.receiver&&y.receiver.transport&&this.tryBindTransportEvents(y.receiver.transport),Pd(Pd({},m),{},{sdp:p.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const a=await this.peerConnection.createOffer();if(!a.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const l=Ic(a.sdp);return this.initialOffer=a,Pd(Pd({},l),{},{sdp:a.sdp})}}catch(i){throw new ge(K.GET_LOCAL_CONNECTION_PARAMS_FAILED,i.toString())}}async connect(r){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:i,iceParameters:a,dtlsParameters:l}=r,u=await H8({},{},i);this.remoteSDP=new ez({remoteIceParameters:a,remoteDtlsParameters:l,candidates:[],remoteRTPCapabilities:u,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const p=this.peerConnection.getTransceivers()[0];p!=null&&p.sender&&p.sender.transport&&this.tryBindTransportEvents(p.sender.transport)}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(i.toString()))}}async addRemoteCandidate(r){try{r&&this.pendingCandidates.push(r),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(i=>{this.peerConnection.addIceCandidate(i)}),this.pendingCandidates=[])}catch(i){throw new ge(K.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(i.toString()))}}send(r,i,a){var l=this;return $i(function*(){const u=yield Nt(l.mutex.lock("From P2PConnection.send"));try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const p=[],m=l.remoteSDP.receive(r,i,a);r.forEach((L,H)=>{if(m[H].needCreateTransceiver){const Y=l.peerConnection.addTransceiver(L._mediaStreamTrack,{direction:"sendonly"});p.push(Y),L._updateRtpTransceiver(Y)}else{const Y=l.peerConnection.getTransceivers().find(te=>te.mid===m[H].mid);if(!Y)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(m[H].mid));p.push(Y),L._updateRtpTransceiver(Y)}}),wn()&&W("SIMULCAST")===!0&&(yield Nt(l.applySimulcastForFirefox(p,r)));const g=m.map(L=>L.mid),y=yield Nt(l.peerConnection.createOffer()),x=l.mungSendOfferSDP(y.sdp,r,g),S=ki(x),T=g.map(L=>{const H=S.mediaDescriptions.find(Y=>Y.attributes.mid===L);if(!H)throw new Error("Cannot extract ssrc from mediaDescription.");return T1(H,W("USE_PUB_RTX"))}),C=p.map((L,H)=>{const Y=g[H];return{localSSRC:T[H],id:Y}});yield Nt(l.peerConnection.setLocalDescription({type:"offer",sdp:x}));try{yield C}catch(L){const H=l.remoteSDP.toString();throw yield Nt(l.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield Nt(l.peerConnection.setRemoteDescription({type:"answer",sdp:H})),yield Nt(l.stopSending(g,!0)),L}yield Nt(l.applySimulcastEncodings(p,r)),yield Nt(l.applySendEncodings(p,r));const V=l.remoteSDP.toString(),j=l.logSDPExchange(x,"offer","local","send");return j==null||j(V),yield Nt(l.setRemoteDescription({type:"answer",sdp:V})),p.map((L,H)=>{const Y=g[H];return{localSSRC:T[H],id:Y}})}catch(p){throw p instanceof ge?p:new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(p.toString()))}finally{u()}})()}async stopSending(r,i){const a=i?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const l=this.peerConnection.getTransceivers().filter(g=>r.indexOf(g.mid)!==-1);if(l.length!==r.length)throw new Error("Transceivers' length (".concat(l.length,") doesn't match mids' length (").concat(r.length,") when trying to call P2PConnection.stopSending."));l.map(g=>{var y;g.direction="inactive",(y=g.stop)===null||y===void 0||y.call(g)});const u=await this.peerConnection.createOffer(),p=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(r);const m=this.remoteSDP.toString();p==null||p(m),await this.setRemoteDescription({type:"answer",sdp:m})}catch(l){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(l.toString()))}finally{a&&a()}}async receive(r,i,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(r," before remoteSDP created."));const{mid:u,needExchangeSDP:p}=this.remoteSDP.send(r,i,a,l);if(p){const g=this.remoteSDP.toString(),y=this.logSDPExchange(g,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:g});const x=await this.peerConnection.createAnswer(),S=this.mungReceiveAnswerSDP(x.sdp,u,r);y==null||y(S||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:S}),A.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(r," by exchanging SDP."))}else A.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(r," no need to exchange SDP."));const m=this.peerConnection.getTransceivers().find(g=>g.mid===u);if(!m||m.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:m.receiver.track,mid:m.mid,transceiver:m}}catch(u){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async mockReceive(r,i,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(r," before remoteSDP created."));const{mid:u,needExchangeSDP:p}=this.remoteSDP.send(r,i,a,l);if(p){const m=this.remoteSDP.toString(),g=this.logSDPExchange(m,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:m});const y=await this.peerConnection.createAnswer(),x=this.mungReceiveAnswerSDP(y.sdp,u,r);g==null||g(x||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:x}),A.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(r," by exchanging SDP."))}else A.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(r," no need to exchange SDP."))}catch(u){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async stopReceiving(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(r);const i=this.remoteSDP.toString(),a=this.logSDPExchange(i,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:i});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}}async restartICE(r){try{if(this.store.p2pTransport===Ku.Auto&&(this.store.p2pTransport=Ku.SdRtn,jt().supportPCSetConfiguration&&this.peerConnection.setConfiguration(zm.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,jt().supportPCSetConfiguration&&this.peerConnection.setConfiguration(zm.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!r){this.restartCnt++,this.isReady=!1;const i=await this.peerConnection.createOffer({iceRestart:!0});if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:a}=Ic(i.sdp);return this.store.descriptionStart(),this.direction===Li.SEND_ONLY&&await this.peerConnection.setLocalDescription(i),a}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(r),this.store.descriptionStart(),this.direction===Li.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const i=await this.peerConnection.createAnswer();if(!i.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:a}=Ic(i.sdp);return await this.peerConnection.setLocalDescription(i),a}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}}close(){var r;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(r){return this.statsFilter.getVideoIsReady(r)}async updateEncoderConfig(r,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[i],[r]);this.remoteSDP.updateRecvMedia(r,i);const u=this.remoteSDP.toString(),p=this.logSDPExchange(l,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),p==null||p(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new ge(K.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(r,i){const a=this.peerConnection.getTransceivers().filter(l=>l.mid===r);a.length===1&&(this.isVP8Simulcast(i)?wn()||await this.applySimulcastEncodings(a,[i]):await this.applySendEncodings(a,[i]))}setStatsRemoteVideoIsReady(r,i){this.statsFilter.setVideoIsReady2(r,i)}async replaceTrack(r,i){const a=this.peerConnection.getTransceivers().find(l=>l.mid===i);a&&await a.sender.replaceTrack(r._mediaStreamTrack)}async getSelectedCandidatePair(){const r=this.peerConnection.getReceivers();if(r.length>0&&r[0].transport&&r[0].transport.iceTransport&&r[0].transport.iceTransport.getSelectedCandidatePair&&r[0].transport.iceTransport.getSelectedCandidatePair()){const i=r[0].transport.iceTransport,{local:a,remote:l}=i.getSelectedCandidatePair();return{local:Pd(Pd({},Ja),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port}),remote:Pd(Pd({},Ja),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var r,i;Ce(r=["connected","completed"]).call(r,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(i=this.onICEConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var r;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=r=>{if(r.candidate){var i;r.candidate.candidate&&((i=this.onLocalCandidate)===null||i===void 0||i.call(this,r.candidate.toJSON())),this.localCandidateCount+=1}else A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(r,i){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const l={iceServers:[]};var u;return r.iceServers?l.iceServers=r.iceServers:r.turnServer&&r.turnServer.mode!=="off"&&(Bu(r.turnServer.servers)?l.iceServers=r.turnServer.servers:(l.iceServers&&l.iceServers.push(...zm.turnServerConfigToIceServers(r.turnServer.servers,i,a)),W("USE_TURN_SERVER_OF_GATEWAY")&&l.iceServers&&r.turnServer.serversFromGateway&&l.iceServers.push(...zm.turnServerConfigToIceServers(r.turnServer.serversFromGateway,i,a)),Ce(u=[Ku.Relay,Ku.SdRtn]).call(u,i)&&(l.iceTransportPolicy="relay"),W("FORCE_TURN_TCP")?l.iceTransportPolicy="relay":r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).forEach(p=>{p.forceturn&&(l.iceTransportPolicy="relay")}))),W("ENABLE_ENCODED_TRANSFORM")&&jt().supportWebRTCEncodedTransform&&(l.encodedInsertableStreams=!0),A.debug("P2PConnection p2pTransport is ".concat(i)),l}static turnServerConfigToIceServers(r,i){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const l=[],u=r.filter(m=>m.tcpport);A.debug("P2PConnection turnServers is ".concat(u,", current index is ").concat(a));const p=u.length>a?u[a]:u[0];switch(i){case Ku.SdRtn:const m=r.filter(y=>{var x;return Ce(x=y.username).call(x,"glb:")&&y.turnServerURL==y.turnServerURL}),g=m.length>a?m[a]:m[0];g&&(l.push({username:g.username,credential:g.password,credentialType:"password",urls:"turn:".concat(no(g.turnServerURL),":").concat(g.tcpport,"?transport=udp")}),l.push({username:g.username,credential:g.password,credentialType:"password",urls:"turns:".concat(no(g.turnServerURL),":").concat(g.tcpport,"?transport=tcp")}));break;case Ku.Relay:p&&(l.push({username:p.username,credential:p.password,credentialType:"password",urls:"turn:".concat(p.turnServerURL,":").concat(p.tcpport,"?transport=udp")}),l.push({username:p.username,credential:p.password,credentialType:"password",urls:"turns:".concat(no(p.turnServerURL),":").concat(p.tcpport,"?transport=tcp")}));break;default:p&&(l.push({username:p.username,credential:p.password,credentialType:"password",urls:"turn:".concat(p.turnServerURL,":").concat(p.tcpport,"?transport=udp")}),l.push({username:p.username,credential:p.password,credentialType:"password",urls:"turns:".concat(no(p.turnServerURL),":").concat(p.tcpport,"?transport=tcp")}),l.push({username:p.username,credential:p.password,credentialType:"password",urls:"stun:".concat(p.turnServerURL,":").concat(p.tcpport)}))}return l}tryBindTransportEvents(r){if(r){this.transport=r,r.onstatechange=()=>{var a;r!=null&&r.state&&((a=this.onDTLSTransportStateChange)===null||a===void 0||a.call(this,r.state))},r.onerror=a=>{var l;(l=this.onDTLSTransportError)===null||l===void 0||l.call(this,"error"in a?a.error:a)};const i=r.iceTransport;i&&(i.onstatechange=()=>{const a=r==null?void 0:r.iceTransport.state;var l;a&&((l=this.onICETransportStateChange)===null||l===void 0||l.call(this,a))},i.getSelectedCandidatePair&&(i.onselectedcandidatepairchange=()=>{if(i.getSelectedCandidatePair()){const{local:a,remote:l}=i.getSelectedCandidatePair()||{};if(a&&l){const u=a.address+":"+a.port,p=l.address+":"+l.port;A.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify(Ac(u)),", remote ").concat(JSON.stringify(Ac(p))))}}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(r,i){var a;if(i||(i=this.peerConnection.getSenders().find(x=>x.track===r._mediaStreamTrack)),!i)return A.warn("[".concat(r.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(r))return A.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!jt().supportSetRtpSenderParameters)return A.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const l={},u={};switch(r._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;default:l.degradationPreference="balanced"}if(r._encoderConfig){var p;const{bitrateMax:x,frameRate:S,scaleResolutionDownBy:T}=r._encoderConfig;x&&(u.maxBitrate=1e3*x),Ce(p=r._hints).call(p,Zt.LOW_STREAM)&&(S&&(u.maxFramerate=qi(S)),T&&T>=1&&(u.scaleResolutionDownBy=T))}if(W("DSCP_TYPE")&&Sc()){var m;const x=W("DSCP_TYPE");Ce(m=["very-low","low","medium","high"]).call(m,x)&&(u.networkPriority=x)}const g=i.getParameters(),y=(a=g.encodings)===null||a===void 0?void 0:a[0];wn()&&!y&&(l.encodings=[u]),y&&Object.assign(y,u),Object.assign(g,l),A.debug("[".concat(r.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(g.encodings))),await i.setParameters(g)}async applySendEncodings(r,i){try{if(!jt().supportSetRtpSenderParameters||r.length!==i.length)return;for(let a=0;a<r.length;a++){const l=r[a],u=i[a];u instanceof pn&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,l.sender)}}catch{A.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(r,i,a){const l=ki(r);return i.forEach((u,p)=>{const m=a[p],g=l.mediaDescriptions.find(y=>y.attributes.mid===m);g&&(sh(g,u),R1(g,u,this.store.codec))}),pl(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=r=>{var i;(i=this.onFirstAudioReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoReceived=r=>{var i;(i=this.onFirstVideoReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstAudioDecoded=r=>{var i;(i=this.onFirstAudioDecoded)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoDecoded=(r,i,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,r,i,a)},this.statsFilter.onSelectedLocalCandidateChanged=(r,i)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,r,i)},this.statsFilter.onSelectedRemoteCandidateChanged=(r,i)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,r,i)},this.statsFilter.onFirstVideoDecodedTimeout=r=>{var i;(i=this.onFirstVideoDecodedTimeout)===null||i===void 0||i.call(this,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(r,i){if(r.length===i.length)for(let g=0;g<r.length;g++){var a,l,u,p,m;const y=r[g],x=i[g];if(x instanceof pn&&!Ce(a=x._hints).call(a,Zt.LOW_STREAM)&&(l=x._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((u=x._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(p=x._scalabilityMode)!==null&&p!==void 0&&p.numSpatialLayers&&((m=x._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1&&this.store.codec==="vp8"){const S={},T={high:1e3*(x._encoderConfig.bitrateMax-50),medium:5e4};S.encodings=[{rid:"m",active:!0,maxBitrate:T.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:T.high}];const C=y.sender.getParameters();await y.sender.setParameters(Object.assign(C,S))}}}async applySimulcastEncodings(r,i){if(!wn()&&r.length===i.length)for(let a=0;a<r.length;a++){const l=i[a];if(l instanceof pn&&this.isVP8Simulcast(l)){const u=r[a],p={},m={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};p.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:m.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:m.medium,scaleResolutionDownBy:4}];const g=u.sender.getParameters();await u.sender.setParameters(Object.assign(g,p))}}}isVP8Simulcast(r){var i,a,l,u,p;return!!(r instanceof pn&&W("SIMULCAST")&&this.store.codec==="vp8"&&!Ce(i=r._hints).call(i,Zt.LOW_STREAM)&&(a=r._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=r._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=r._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((p=r._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1)}logSDPExchange(r,i,a,l){if(W("SDP_LOGGING"))return A.upload("[".concat(this.store.clientId,"] exchanging ").concat(a," ").concat(i," SDP during P2PConnection.").concat(l,`
`),r),i==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}async muteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const i=this.peerConnection.getTransceivers().filter(p=>p.mid&&r.indexOf(p.mid)!==-1);if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(p=>{p.direction="inactive"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.muteRemote(r);const u=this.remoteSDP.toString();l==null||l(u),await this.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(i.toString()))}}async unmuteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const i=this.peerConnection.getTransceivers().filter(p=>p.mid&&r.indexOf(p.mid)!==-1);if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(async p=>{p.direction="sendonly"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.unmuteRemote(r);const u=this.remoteSDP.toString();l==null||l(u),await this.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(i.toString()))}}async getRemoteSSRC(r,i){var a;if(i=i??((a=this.currentRemoteDescription)===null||a===void 0?void 0:a.sdp)){var l;const u=(l=ki(i).mediaDescriptions.find(p=>p.attributes.mid===r))===null||l===void 0?void 0:l.attributes.ssrcs;return u==null?void 0:u[0].ssrcId}}async setRemoteDescription(r){var i;await this.peerConnection.setRemoteDescription(r),Ce(i=["connected","completed"]).call(i,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(r,i,a){const l=ki(r),u=l.mediaDescriptions.find(p=>p.attributes.mid===i);return u&&a===ze.AUDIO&&u.media.mediaType==="audio"&&_m(u),pl(l)}},Le(Tn.prototype,"establish",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"establish"),Tn.prototype),Le(Tn.prototype,"connect",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"connect"),Tn.prototype),Le(Tn.prototype,"receive",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"receive"),Tn.prototype),Le(Tn.prototype,"mockReceive",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"mockReceive"),Tn.prototype),Le(Tn.prototype,"stopReceiving",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"stopReceiving"),Tn.prototype),Le(Tn.prototype,"restartICE",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"restartICE"),Tn.prototype),Le(Tn.prototype,"close",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"close"),Tn.prototype),Le(Tn.prototype,"updateEncoderConfig",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"updateEncoderConfig"),Tn.prototype),Le(Tn.prototype,"updateSendParameters",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"updateSendParameters"),Tn.prototype),Le(Tn.prototype,"replaceTrack",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"replaceTrack"),Tn.prototype),Le(Tn.prototype,"muteLocal",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"muteLocal"),Tn.prototype),Le(Tn.prototype,"unmuteLocal",[co],Object.getOwnPropertyDescriptor(Tn.prototype,"unmuteLocal"),Tn.prototype),Tn);function co(t,r,i){const a=t[r];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){const l=this.mutex,u=await l.lock("From P2PConnection.".concat(r));try{for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];return await a.apply(this,m)}finally{u()}},i}let Ko=function(t){return t.SEND_ONLY="SEND_ONLY",t.RECEIVE_ONLY="RECEIVE_ONLY",t}({});var rz,iz,sz,az,oz,cz,lz,dz,uz,hz,pz,kn;function mz(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function pE(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?mz(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):mz(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}let exe=(rz=Yo(Ko.SEND_ONLY),iz=Yo(Ko.SEND_ONLY),sz=Yo(),az=Yo(Ko.RECEIVE_ONLY),oz=Yo(Ko.RECEIVE_ONLY),cz=Yo(Ko.RECEIVE_ONLY),lz=Yo(Ko.RECEIVE_ONLY),dz=Yo(Ko.RECEIVE_ONLY),uz=Yo(Ko.RECEIVE_ONLY),hz=Yo(),pz=Yo(Ko.RECEIVE_ONLY),kn=class extends Pn{get state(){return this._state}set state(t){const r=this._state;this._state=t,this.emit(rt.StateChange,r,this._state)}constructor(t,r){super(),F(this,"isPlanB",!1),F(this,"store",void 0),F(this,"statsUploader",void 0),F(this,"sendConnection",void 0),F(this,"recvConnection",void 0),F(this,"localTrackMap",new Map),F(this,"remoteUserMap",new Map),F(this,"localDataChannels",[]),F(this,"pendingLocalTracks",[]),F(this,"pendingRemoteTracks",[]),F(this,"statsCollector",void 0),F(this,"dtlsFailedCount",0),F(this,"sendMutex",void 0),F(this,"recvMutex",void 0),F(this,"_state",Qt.Disconnected),F(this,"_restartStates",["disconnected","failed"]),F(this,"reconnectInterval",void 0),F(this,"uploadUnplinkStarted",!1),F(this,"uploadDownlinkStarted",!1),F(this,"uplinkStateUploadInterval",void 0),F(this,"downlinkStatsUploadInterval",void 0),F(this,"handleMuteLocalTrack",async(i,a,l)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==Qt.Connected)return void l(new ge(K.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const g=this.filterTobeMutedTracks(i);if(g.length===0)return void a();const y=g.find(C=>C[0]==="videoLowTrack");y&&y[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(g.map(C=>{let[,{id:V}]=C;return V}));let x=!1;var p,m;i.trackMediaType==="video"?x=!((p=this.localTrackMap.get(Re.LocalAudioTrack))===null||p===void 0||!p.track._muted):x=((m=this.localTrackMap.get(Re.LocalVideoTrack))===null||m===void 0?void 0:m.id)===void 0;const S=this.createMuteMessage(g);await gn(this,rt.RequestMuteLocal,S);const T=i.trackMediaType==="video"?xd.MUTE_LOCAL_VIDEO:xd.MUTE_LOCAL_AUDIO;await gn(this,rt.RequestP2PMuteLocal,{action:T,message:S,isMuteAll:x}),a()}catch(g){l(g)}finally{u()}}),F(this,"handleUnmuteLocalTrack",async(i,a,l)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==Qt.Connected)return void l(new ge(K.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const p=this.filterTobeUnmutedTracks(i);if(p.length===0)return void a();await this.sendConnection.unmuteLocal(p.map(y=>{let[,{id:x}]=y;return x}));const m=this.createUnmuteMessage(p),g=i.trackMediaType==="video"?xd.UNMUTE_LOCAL_VIDEO:xd.UNMUTE_LOCAL_AUDIO;await gn(this,rt.RequestP2PMuteLocal,{action:g,message:m}),a()}catch(p){l(p)}finally{u()}}),F(this,"handleUpdateVideoEncoder",async(i,a,l,u)=>{let p;typeof u=="boolean"&&u||(p=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{const g=this.localTrackMap.get(Re.LocalVideoTrack);if(!this.sendConnection||!g||g.track!==i||this.state!==Qt.Connected)return void a();const{id:y,track:x}=g;y&&(await this.sendConnection.updateSendParameters(y,x),await this.sendConnection.updateEncoderConfig(y,x),this.emit(rt.UpdateVideoEncoder,x)),a()}catch(g){l(g)}finally{var m;(m=p)===null||m===void 0||m()}}),F(this,"handleUpdateVideoSendParameters",async(i,a,l)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const p=this.localTrackMap.get(Re.LocalVideoTrack);if(!this.sendConnection||!p||p.track!==i||this.state!==Qt.Connected)return void a();const{id:m,track:g}=p;m&&await this.sendConnection.updateSendParameters(m,g),a()}catch(p){l(p)}finally{u()}}),F(this,"handleReplaceTrack",async(i,a,l,u)=>{let p;A.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(i.getTrackId(),"]")),typeof u=="boolean"&&u||(p=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var m;const y=Array.from(this.localTrackMap.entries()).find(x=>{let[,{track:S}]=x;return i===S});if(!this.sendConnection||!y||y[1].id===void 0||this.state!==Qt.Connected)return void a();if(await((m=this.sendConnection)===null||m===void 0?void 0:m.replaceTrack(i,y[1].id)),y[0]===Re.LocalVideoTrack&&jt().supportDualStreamEncoding){const x=this.localTrackMap.get(Re.LocalVideoLowTrack);if(x){const S=i._mediaStreamTrack.clone();x.track._originMediaStreamTrack.stop(),x.track._mediaStreamTrack=S,x.track._originMediaStreamTrack=S,await new je((T,C)=>{this.handleReplaceTrack(x.track,T,C,!0)})}}a()}catch(y){l(y)}finally{var g;(g=p)===null||g===void 0||g()}}),F(this,"handleGetLocalVideoStats",i=>{i(this.statsCollector.getLocalVideoTrackStats())}),F(this,"handleGetLocalAudioStats",i=>{i(this.statsCollector.getLocalAudioTrackStats())}),F(this,"handleGetRemoteVideoStats",i=>this.statsCollector.getRemoteVideoTrackStats(i.uid)[i.uid]),F(this,"handleGetRemoteAudioStats",i=>this.statsCollector.getRemoteAudioTrackStats(i.uid)[i.uid]),this.store=t,this.statsCollector=r,this.statsCollector.addP2PChannel(this),this.statsUploader=new RG(t),this.bindStatsUploaderEvents(),this.sendMutex=new kr("P2PChannel2-send-mutex",t.clientId),this.recvMutex=new kr("P2PChannel2-recv-mutex",t.clientId),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(i=>{i&&(i.iceConnectionState!=="disconnected"&&i.iceConnectionState!=="failed"||this.handleDisconnect(i.direction))})},W("ICE_RESTART_INTERVAL"))}async startP2PConnection(t,r){throw new ge(K.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(t){throw new ge(K.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(t,r){let i;try{if(r){this.recvConnection&&(A.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),i=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new nz(t,this.store,Li.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const a=await this.recvConnection.establish(r);return{iceParameters:a.iceParameters,dtlsParameters:a.dtlsParameters,sdp:a.sdp}}{this.state=Qt.New,this.sendConnection&&(A.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),i=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new nz(t,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const a=await this.sendConnection.establish();return{iceParameters:a.iceParameters,dtlsParameters:a.dtlsParameters,sdp:a.sdp}}}finally{i&&i()}}async p2pConnect(t){if(!this.sendConnection)throw new ge(K.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(t),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=Qt.Connected}async addRemoteCandidate(t,r){if(r===Li.RECEIVE_ONLY){if(!this.sendConnection)throw new ge(K.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(t)}else{if(!this.recvConnection)throw new ge(K.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(t)}}publish(t,r,i){var a=this;return $i(function*(){const l=yield Nt(a.sendMutex.lock("From P2PChannel.publish"));try{if(!a.sendConnection||a.state!==Qt.Connected){a.throwIfTrackTypeNotMatch(t);const y=t.filter(x=>a.pendingLocalTracks.indexOf(x)===-1);return void(a.pendingLocalTracks=a.pendingLocalTracks.concat(y))}a.store.pubId=a.store.pubId+1,ai.markPublishStart(a.store.clientId,a.store.pubId);const u=a.filterTobePublishedTracks(t,r,i);if(u.length===0)return void(yield Nt(a.tryToUnmuteAudio(t)));u.forEach(y=>{let{track:x,type:S}=y;const T=Date.now();a.store.publish(x.getTrackId(),S===Re.LocalAudioTrack?"audio":"video",T)}),a.bindLocalTrackEvents(u);const p=yield Nt(a.sendConnection.send(u.map(y=>{let{track:x}=y;return x}),a.store.codec,a.store.audioCodec)),m=(yield Nt(p.next())).value,g=a.createGatewayPublishMessage(u,m);try{yield g}catch(y){throw p.throw(y),(y==null?void 0:y.code)===K.WS_ABORT&&u.forEach(x=>{let{track:S}=x;a.pendingLocalTracks.indexOf(S)===-1&&a.pendingLocalTracks.push(S)}),a.unbindLocalTrackEvents(u),y}yield Nt(p.next()),u.forEach(y=>{let{type:x}=y;a.statsCollector.addLocalStats(x)}),a.statsUploader.startUploadOutboundStats(),a.assignLocalTracks(u,m),u.forEach(y=>{let{track:x,type:S}=y;const T=Date.now();a.store.publish(x.getTrackId(),S===Re.LocalAudioTrack?"audio":"video",void 0,T)}),a.startUploadUplinkState()}finally{l()}})()}async unpublish(t){if(!this.sendConnection||this.state!==Qt.Connected)return void(t.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(l=>!Ce(t).call(t,l)));const r=this.filterTobeUnpublishedTracks(t);if(r.length===0)return;const i=r.find(l=>l[0]==="videoLowTrack");i&&i[1].track.close();const a=this.createGatewayUnpublishMessage(r);if(await this.sendConnection.stopSending(r.map(l=>{let[,{id:u}]=l;return u})),this.withdrawLocalTracks(r),this.unbindLocalTrackEvents(r.map(l=>{let[u,{track:p}]=l;return{type:u,track:p}})),r.forEach(l=>{let[u]=l;this.statsCollector.removeLocalStats(u)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===Qt.Connected)return i&&i[1].track.close(),a;t.forEach(l=>{const u=this.pendingLocalTracks.indexOf(l);u!==-1&&this.pendingLocalTracks.splice(u,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const t=()=>{const r=[],i=[];Array.from(this.localTrackMap.entries()).forEach(a=>{let[l,{track:u,ssrcs:p}]=a;const m={stream_type:Gve(u,l),ssrcs:p};u._muted||!u._enabled?r.push(m):i.push(m)}),r.length>0&&r.forEach(a=>{gn(this,rt.RequestMuteLocal,[a])}),i.length>0&&i.forEach(a=>{gn(this,rt.RequestUnmuteLocal,[a])})};t(),this.uplinkStateUploadInterval=window.setInterval(()=>{t()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(t){return $i(function*(){throw new ge(K.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(A.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await or(this,rt.RequestRePublish,this.pendingLocalTracks),this.emit(rt.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new ge(K.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(t,r,i,a){var l;if(!this.recvConnection)throw new ge(K.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((l=this.remoteUserMap.get(t))!==null&&l!==void 0&&l.has(r))return;const{track:u,mid:p,transceiver:m}=await this.recvConnection.receive(r,[{ssrcId:i}],String(t.uid),a);r===ze.AUDIO?(t._audioTrack?t._audioTrack._updateOriginMediaStreamTrack(u):(t._audioTrack=new pm(u,t.uid,t._uintid,this.store),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(t._audioTrack.getTrackId()))),m&&t._audioTrack._updateRtpTransceiver(m),this.bindRemoteTrackEvents(t,t._audioTrack)):(t._videoSSRC=i,t._videoTrack?t._videoTrack._updateOriginMediaStreamTrack(u):(t._videoTrack=new hm(u,t.uid,t._uintid,this.store),A.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(t._videoTrack.getTrackId()))),m&&t._videoTrack._updateRtpTransceiver(m),this.bindRemoteTrackEvents(t,t._videoTrack));const g=this.remoteUserMap.get(t);g?g.set(r,p):this.remoteUserMap.set(t,new Map([[r,p]])),this.statsCollector.addRemoteStats(t.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const y=this.pendingRemoteTracks.findIndex(x=>{let{user:S,kind:T}=x;return S.uid===t.uid&&r===T});y!==-1&&(this.pendingRemoteTracks.splice(y,1),this.emit(rt.MediaReconnectEnd,t.uid))}async mockSubscribe(t,r,i,a){if(!this.recvConnection)throw new ge(K.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(r,[{ssrcId:i}],String(t.uid),a)}async unsubscribe(t,r,i){const a=this.pendingRemoteTracks.filter(u=>{let{user:p,kind:m}=u;return r!==void 0?p.uid===t.uid&&r===m:p.uid===t.uid});if(a.forEach(u=>{const p=this.pendingRemoteTracks.indexOf(u);this.pendingRemoteTracks.splice(p,1)}),this.recvConnection||i||a.forEach(u=>{let{kind:p}=u;var m;if(p===ze.AUDIO)(m=t._audioTrack)===null||m===void 0||m._destroy(),t._audioTrack=void 0;else if(p===ze.VIDEO){var g;(g=t._videoTrack)===null||g===void 0||g._destroy(),t._videoTrack=void 0}}),!this.recvConnection)return;const l=this.filterTobeUnSubscribedTracks(t,r);l.length!==0&&(await this.recvConnection.stopReceiving(l.map(u=>{let[,{id:p}]=u;return p})),this.withdrawRemoteTracks(l),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),l.forEach(u=>{let[p,{kind:m}]=u;var g,y;if(m===ze.VIDEO&&p._videoSSRC&&((g=this.recvConnection)===null||g===void 0||g.setStatsRemoteVideoIsReady(p._videoSSRC,!1)),m===ze.VIDEO)this.unbindRemoteTrackEvents(p._videoTrack),i||((y=p._videoTrack)===null||y===void 0||y._destroy(),p._videoTrack=void 0);else if(m===ze.AUDIO){var x;this.unbindRemoteTrackEvents(p._audioTrack),!i&&((x=p._audioTrack)===null||x===void 0||x._destroy(),p._audioTrack=void 0)}}),l.forEach(u=>{let[,{kind:p}]=u;gn(this,rt.RequestP2PMuteRemote,p)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const t=()=>Array.from(this.remoteUserMap.entries()).forEach(r=>{let[,i]=r;[ze.VIDEO,ze.AUDIO].forEach(a=>{i.has(a)?gn(this,rt.RequestP2PUnmuteRemote,a):gn(this,rt.RequestP2PMuteRemote,a)})});t(),this.downlinkStatsUploadInterval=window.setInterval(()=>{t()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(t){throw new ge(K.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(t){throw new ge(K.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(t){throw new ge(K.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(t){throw new ge(K.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(t,r){if(!this.recvConnection)return;const i=this.remoteUserMap.get(t);if(!i)return void A.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(t.uid,"."));if(!i.get(r))return void A.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(t.uid," media type ").concat(r,"."));const a=r===ze.VIDEO?t._videoSSRC:t._audioSSRC;a!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(a,!1)}async unmuteRemote(t,r){return this.unmuteRemoteNoLock(t,r)}async unmuteRemoteNoLock(t,r){if(!this.recvConnection)return;const i=this.remoteUserMap.get(t);if(!i)return void A.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(t.uid,"."));i.get(r)||A.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(t.uid," media type ").concat(r,"."))}getAllTracks(t){const r=this.localTrackMap.get(Re.LocalAudioTrack);if((r==null?void 0:r.track)instanceof pr){const i=r.track;return Array.from(this.localTrackMap.entries()).filter(a=>{let[l]=a;return l!==Re.LocalAudioTrack}).filter(a=>{let[l]=a;return!(t&&l===Re.LocalVideoLowTrack)}).map(a=>{let[,{track:l}]=a;return l}).concat(i.trackList)}return Array.from(this.localTrackMap.entries()).filter(i=>{let[a]=i;return!(t&&a===Re.LocalVideoLowTrack)}).map(i=>{let[,{track:a}]=i;return a})}reportPublishEvent(t,r,i,a,l){if(t){const p=this.localTrackMap.get(Re.LocalAudioTrack),m=a?this.localTrackMap.get(Re.LocalVideoLowTrack):this.localTrackMap.get(Re.LocalVideoTrack);Ye.publish(this.store.sessionId,{eventElapse:ai.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:r,audioName:p==null?void 0:p.track.getTrackLabel(),videoName:m==null?void 0:m.track.getTrackLabel(),screenshare:(m==null?void 0:m.track._hints.indexOf(Zt.SCREEN_TRACK))!==-1,audio:!!p,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}else{var u;i||(i=[]);const p=i.find(g=>g instanceof $n),m=a?(u=this.localTrackMap.get(Re.LocalVideoTrack))===null||u===void 0?void 0:u.track:i.find(g=>g instanceof pn);Ye.publish(this.store.sessionId,{eventElapse:ai.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:r,audioName:p==null?void 0:p.getTrackLabel(),videoName:m==null?void 0:m.getTrackLabel(),screenshare:(m==null?void 0:m._hints.indexOf(Zt.SCREEN_TRACK))!==-1,audio:!!p,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}}reportSubscribeEvent(t,r,i,a){const l=a===ze.VIDEO?i._videoSSRC:i._audioSSRC;l&&Ye.subscribe(this.store.sessionId,{succ:t,ec:r,video:a===ze.VIDEO,audio:a===ze.AUDIO,peerid:i.uid,subscribeRequestid:a===ze.VIDEO?i._videoSSRC:i._audioSSRC,p2pid:this.store.p2pId,eventElapse:ai.measureFromSubscribeStart(this.store.clientId,l)})}reset(){A.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new kr("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new kr("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const t=this.localTrackMap.get(Re.LocalAudioTrack);if((t==null?void 0:t.track)instanceof pr){if(t.track.trackList.length>0){const r=t.track;t.track.trackList.forEach(i=>{r.removeAudioTrack(i)})}t.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=Qt.Disconnected}getStats(t){var r,i;return t?(i=this.recvConnection)===null||i===void 0?void 0:i.getStats():(r=this.sendConnection)===null||r===void 0?void 0:r.getStats()}getRemoteVideoIsReady(t){var r;return((r=this.recvConnection)===null||r===void 0?void 0:r.getRemoteVideoIsReady(t))||!1}getLocalAudioVolume(){const t=this.localTrackMap.get(Re.LocalAudioTrack);if(t)return t.track.getVolumeLevel()}getLocalVideoSize(){const t=this.localTrackMap.get(Re.LocalVideoTrack);if(t)return{width:t.track.videoWidth||0,height:t.track.videoHeight||0}}getEncoderConfig(t){const r=this.localTrackMap.get(t);return r&&r.track instanceof pn||r&&r.track instanceof $n?r.track._encoderConfig:void 0}getLocalMedia(t){return this.localTrackMap.get(t)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(t,r){if(!t)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(t);return!!i&&(!r||i.has(r))}async hasRemoteMediaWithLock(t,r){if(!t)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(t);return!!i&&(!r||i.has(r))}getRemoteMedia(t){var r;const i=Array.from(mi(r=this.remoteUserMap).call(r)).find(a=>a.uid===t);return i?{audioTrack:i.audioTrack,audioSSRC:i._audioSSRC,videoTrack:i.videoTrack,videoSSRC:i._videoSSRC}:{}}getAudioLevels(){let t=Array.from(this.remoteUserMap.entries()).map(i=>{let[a]=i;return{uid:a.uid,level:a.audioTrack?100*a.audioTrack._source.getAccurateVolumeLevel():0}});const r=this.localTrackMap.get(Re.LocalAudioTrack);return r&&t.push({level:100*r.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),t=Ou(t).call(t,(i,a)=>i.level-a.level),t}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(A.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=Qt.Reconnecting,W("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r]=t;var i;r._videoTrack&&r._videoTrack._player&&((i=r._videoTrack._player.getVideoElement())===null||i===void 0||i.pause(),r._videoTrack._player.isKeepLastFrame=!0,r._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(t=>{var r;let[i,{track:a}]=t;switch(i){case Re.LocalVideoTrack:Ce(r=a._hints).call(r,Zt.LOW_STREAM)?a.close():this.pendingLocalTracks.push(a);break;case Re.LocalAudioTrack:a instanceof pr?this.pendingLocalTracks=this.pendingLocalTracks.concat(a.trackList):this.pendingLocalTracks.push(a);case Re.LocalVideoLowTrack:}}),this.emit(rt.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r,i]=t;Array.from(mi(i).call(i)).forEach(a=>{this.setPendingRemoteMedia(r,a)}),this.emit(rt.MediaReconnectStart,r.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),A.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(t,r){for(const i of this.pendingRemoteTracks){const{user:a,kind:l}=i;if((t instanceof wd?t.uid:t)===a.uid&&r===l)return!0}return!1}setPendingRemoteMedia(t,r){this.hasPendingRemoteMedia(t,r)||this.pendingRemoteTracks.push({user:t,kind:r})}async restartICE(t,r){let i,a;if(t===Li.SEND_ONLY){if(!this.sendConnection)throw new ge(K.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");i=await this.sendMutex.lock("From P2PChannel.restartICE"),a=this.sendConnection}else{if(!this.recvConnection)throw new ge(K.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");i=await this.recvMutex.lock("From P2PChannel.restartICE"),a=this.recvConnection}try{if(r){const l=await a.restartICE(r);return a.isInRestartIce=!1,l}{const l=await a.restartICE();if(l){const u=await or(this,rt.RequestP2PRestartICE,{direction:Li.RECEIVE_ONLY,iceParameter:l});await a.restartICE(u),a.isInRestartIce=!1}}}finally{i()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const t=this.sendConnection.getStats(),r=this.localTrackMap.get(Re.LocalVideoTrack),i=this.localTrackMap.get(Re.LocalAudioTrack),a=t.videoSend.find(C=>{var V;return C.ssrc===(r==null||(V=r.ssrcs)===null||V===void 0?void 0:V[0].ssrcId)}),l=t.audioSend.find(C=>{var V;return C.ssrc===(i==null||(V=i.ssrcs)===null||V===void 0?void 0:V[0].ssrcId)});if(!a||!l)return 1;const u=As(this,rt.NeedSignalRTT),p=a?a.rttMs:void 0,m=l?l.rttMs:void 0,g=p&&m?(p+m)/2:p||m,y=(g&&u?(g+u)/2:g||u)||0,x=100*t.sendPacketLossRate*.7/50+.3*y/1500,S=x<.17?1:x<.36?2:x<.59?3:x<.1?4:5,T=r==null?void 0:r.track;if(T&&T._encoderConfig&&T._hints.indexOf(Zt.SCREEN_TRACK)===-1){const C=T._encoderConfig.bitrateMax,V=t.bitrate.actualEncoded;if(C&&V){const j=(1e3*C-V)/(1e3*C);return y8[j<.15?0:j<.3?1:j<.45?2:j<.6?3:4][S]}}return S}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const t=this.recvConnection.getStats();let r=0;return Array.from(this.remoteUserMap.entries()).forEach(i=>{let[a]=i;const l=a._audioSSRC,u=a._videoSSRC,p=t.audioRecv.find(V=>V.ssrc===l),m=t.videoRecv.find(V=>V.ssrc===u);if(!p&&!m)return void(r+=1);const g=As(this,rt.NeedSignalRTT),y=t.rtt,x=(y&&g?(y+g)/2:y||g)||0,S=p?p.jitterMs:void 0,T=t.recvPacketLossRate;let C=.7*T*100/50+.3*x/1500;S&&(C=.6*T*100/50+.2*x/1500+.2*S/400),r+=C<.1?1:C<.17?2:C<.36?3:C<.59?4:5}),this.remoteUserMap.size>0?Math.round(r/this.remoteUserMap.size):r}async muteLocalTrack(t){return new je((r,i)=>{this.handleMuteLocalTrack(t,r,i)})}filterTobePublishedTracks(t,r,i){const a=[],l=jt(),u=this.getAllTracks();t=Zp(t=t.filter(g=>u.indexOf(g)===-1));let p=!1,m=!1;for(const g of t){if(g instanceof pn&&(this.localTrackMap.has(Re.LocalVideoTrack)||p?new ge(K.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(a.push({track:g,type:Re.LocalVideoTrack}),p=!0),r)){const y=this.getLowVideoTrack(g,i);a.push({track:y,type:Re.LocalVideoLowTrack})}if(g instanceof $n){const y=this.localTrackMap.get(Re.LocalAudioTrack);if(y){if(!(y.track instanceof pr))throw new ge(K.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(g._bypassWebAudio)throw new ge(K.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");y.track.addAudioTrack(g),this.bindLocalAudioTrackEvents(g,!0)}else if(m){const x=a.find(S=>{let{type:T}=S;return T===Re.LocalAudioTrack});if(!(x.track instanceof pr))throw new ge(K.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(g._bypassWebAudio)throw new ge(K.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");x.track.addAudioTrack(g)}else{if(!l.webAudioMediaStreamDest||g instanceof pr||g._bypassWebAudio)a.push({track:g,type:Re.LocalAudioTrack});else{const x=new pr;x.addAudioTrack(g),a.push({track:x,type:Re.LocalAudioTrack})}m=!0}}}return a}filterTobeUnpublishedTracks(t){const r=[],i=this.getAllTracks();t=Zp(t=t.filter(a=>i.indexOf(a)!==-1));for(const a of t){if(a instanceof $n){const l=this.localTrackMap.get(Re.LocalAudioTrack);if(!l)continue;l.track instanceof pr?(l.track.removeAudioTrack(a),this.unbindLocalAudioTrackEvents(a),l.track.trackList.length===0&&(r.push([Re.LocalAudioTrack,l]),l.track.close())):r.push([Re.LocalAudioTrack,l])}if(a instanceof pn){const l=this.localTrackMap.get(Re.LocalVideoTrack);if(!l)continue;r.push([Re.LocalVideoTrack,l]);const u=this.localTrackMap.get(Re.LocalVideoLowTrack);u&&r.push([Re.LocalVideoLowTrack,u])}}return r}bindLocalTrackEvents(t){t.forEach(r=>{let{track:i,type:a}=r;switch(a){case Re.LocalVideoTrack:i.addListener(qe.GET_STATS,this.handleGetLocalVideoStats),i.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.addListener(qe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),i.addListener(qe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),i.addListener(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),i.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Re.LocalAudioTrack:this.bindLocalAudioTrackEvents(i);case Re.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(t,r){t instanceof pr?t.trackList.forEach(i=>{i.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.addListener(qe.GET_STATS,this.handleGetLocalAudioStats),i.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.addListener(qe.GET_STATS,this.handleGetLocalAudioStats),t.addListener(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),r||t.addListener(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(t){t||(t=Array.from(this.localTrackMap.entries()).map(r=>{let[i,{track:a}]=r;return{track:a,type:i}})),t.forEach(r=>{let{track:i,type:a}=r;switch(a){case Re.LocalVideoTrack:i.off(qe.GET_STATS,this.handleGetLocalVideoStats),i.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.off(qe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),i.off(qe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),i.off(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),i.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Re.LocalAudioTrack:this.unbindLocalAudioTrackEvents(i);case Re.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(t){t instanceof pr?t.trackList.forEach(r=>{r.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(qe.GET_STATS,this.handleGetLocalAudioStats),r.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.off(qe.GET_STATS,this.handleGetLocalAudioStats),t.off(qe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(qe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(qe.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(qe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(qe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(t,r){r instanceof hm&&r.addListener(qe.GET_STATS,i=>{i(this.handleGetRemoteVideoStats(t))}),r instanceof pm&&r.addListener(qe.GET_STATS,i=>{i(this.handleGetRemoteAudioStats(t))})}unbindRemoteTrackEvents(t){t&&t.removeAllListeners(qe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r,i]=t;i.has(ze.AUDIO)&&this.unbindRemoteTrackEvents(r._audioTrack),i.has(ze.VIDEO)&&this.unbindRemoteTrackEvents(r._videoTrack)})}createGatewayPublishMessage(t,r){return t.map((i,a)=>{var l;let u,{track:p,type:m}=i;switch(m){case Re.LocalAudioTrack:u=rn.Audio;break;case Re.LocalVideoTrack:u=Ce(l=p._hints).call(l,Zt.SCREEN_TRACK)?rn.Screen:rn.High;break;case Re.LocalVideoLowTrack:u=rn.Low}return{kind:m===Re.LocalAudioTrack?ze.AUDIO:ze.VIDEO,stream_type:u,mid:r[a].id,ssrcs:r[a].localSSRC,isMuted:p.muted||!p.enabled}})}createGatewayUnpublishMessage(t){return t.map(r=>{var i;let a,[l,{track:u,ssrcs:p,id:m}]=r;switch(l){case Re.LocalVideoTrack:a=Ce(i=u._hints).call(i,Zt.SCREEN_TRACK)?rn.Screen:rn.High;break;case Re.LocalAudioTrack:a=rn.Audio;break;case Re.LocalVideoLowTrack:a=rn.Low}return{stream_type:a,ssrcs:p,mid:m}})}assignLocalTracks(t,r){t.forEach((i,a)=>{let{track:l,type:u}=i;this.localTrackMap.set(u,{track:l,id:r[a].id,ssrcs:r[a].localSSRC})})}withdrawLocalTracks(t){t.forEach(r=>{let[i]=r;this.localTrackMap.delete(i)})}bindConnectionEvents(t){t.onConnectionStateChange=async r=>{var i;A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(t.name,".onConnectionStateChange(").concat(r,")")),this.emit(rt.PeerConnectionStateChange,r),r!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),r==="connected"&&(t.isInRestartIce=!1),Ce(i=this._restartStates).call(i,r)&&!t.isInRestartIce&&(r==="disconnected"&&await Er(800),t.iceConnectionState!=="disconnected"&&t.iceConnectionState!=="failed"||this.handleDisconnect(t.direction))},t.onICEConnectionStateChange=r=>{r!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(r,")")),Ye.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:r,tag:hn.TRACER}).onSuccess(),this.emit(rt.IceConnectionStateChange,r)},t.onICETransportStateChange=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(r,")"))},t.onDTLSTransportStateChange=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(r,")"))},t.onDTLSTransportError=r=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(r,")"))},t.onFirstAudioDecoded=r=>{var i;const a=Array.from(mi(i=this.remoteUserMap).call(i)).find(u=>u._audioSSRC===r);var l;a&&(this.store.subscribe(a.uid,"audio",void 0,void 0,void 0,Date.now()),(l=a.audioTrack)===null||l===void 0||l.emit(va.FIRST_FRAME_DECODED),Ye.firstRemoteFrame(this.store.sessionId,hr.FIRST_AUDIO_DECODE,Rn.FIRST_AUDIO_DECODE,{peer:a._uintid,subscribeElapse:ai.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId}))},t.onFirstAudioReceived=r=>{var i;const a=Array.from(mi(i=this.remoteUserMap).call(i)).find(l=>l._audioSSRC===r);a&&Ye.firstRemoteFrame(this.store.sessionId,hr.FIRST_AUDIO_RECEIVED,Rn.FIRST_AUDIO_RECEIVED,{peer:a._uintid,subscribeElapse:ai.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},t.onFirstVideoDecoded=(r,i,a)=>{this.reportVideoFirstFrameDecoded(r,i,a)},t.onFirstVideoReceived=r=>{var i;const a=Array.from(mi(i=this.remoteUserMap).call(i)).find(l=>l._videoSSRC===r);a&&Ye.firstRemoteFrame(this.store.sessionId,hr.FIRST_VIDEO_RECEIVED,Rn.FIRST_VIDEO_RECEIVED,{peer:a._uintid,subscribeElapse:ai.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},t.onSelectedLocalCandidateChanged=(r,i)=>{const a=r.candidateType==="relay",l=i.candidateType==="relay";i.candidateType!=="unknown"&&a===l||this.emit(rt.ConnectionTypeChange,a),A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(_d(i))," -> ").concat(JSON.stringify(_d(r)),")"))},t.onSelectedRemoteCandidateChanged=(r,i)=>{A.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(_d(i))," -> ").concat(JSON.stringify(_d(r)),")"))},t.onFirstVideoDecodedTimeout=r=>{this.reportVideoFirstFrameDecoded(r,void 0,void 0,!0)},t.onLocalCandidate=r=>{this.emit(rt.LocalCandidate,{candidate:r,direction:t.direction})}}unbindConnectionEvents(t){t.onConnectionStateChange=void 0,t.onICEConnectionStateChange=void 0,t.onICETransportStateChange=void 0,t.onDTLSTransportStateChange=void 0,t.onDTLSTransportError=void 0,t.onFirstAudioDecoded=void 0,t.onFirstAudioReceived=void 0,t.onFirstVideoDecoded=void 0,t.onFirstVideoReceived=void 0,t.onSelectedLocalCandidateChanged=void 0,t.onSelectedRemoteCandidateChanged=void 0,t.onFirstVideoDecodedTimeout=void 0,t.onLocalCandidate=void 0}async handleDisconnect(t){const r=t===Li.SEND_ONLY?this.sendConnection:this.recvConnection;r&&!r.isInRestartIce&&(r.isInRestartIce=!0,A.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(r.name,"] start use restartICE")),t===Li.SEND_ONLY?this.restartICE(t):or(this,rt.RequestP2PRestartICE,{direction:Li.SEND_ONLY}))}filterTobeMutedTracks(t){const r=[];if(this.getAllTracks().indexOf(t)===-1)return r;const i=this.localTrackMap.get(Re.LocalAudioTrack);if(t instanceof $n&&(i==null?void 0:i.track)instanceof pr)return i.track.isActive||r.push([Re.LocalAudioTrack,i]),r;const a=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:u}]=l;return t===u});if(a&&(r.push(a),a[0]===Re.LocalVideoTrack)){const l=this.localTrackMap.get(Re.LocalVideoLowTrack);l&&r.push([Re.LocalVideoLowTrack,l])}return r}filterTobeUnmutedTracks(t){const r=[],i=this.localTrackMap.get(Re.LocalAudioTrack);if(t instanceof $n&&(i==null?void 0:i.track)instanceof pr)return i.track.isActive&&r.push([Re.LocalAudioTrack,i]),r;const a=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:u}]=l;return t===u});if(a)if(a[0]===Re.LocalVideoTrack){r.push(a);const l=this.localTrackMap.get(Re.LocalVideoLowTrack);l&&r.push([Re.LocalVideoLowTrack,l])}else r.push(a);return r}createMuteMessage(t){return t.map(r=>{var i;let a,[l,{track:u,ssrcs:p,id:m}]=r;switch(l){case Re.LocalAudioTrack:a=rn.Audio;break;case Re.LocalVideoTrack:a=Ce(i=u._hints).call(i,Zt.SCREEN_TRACK)?rn.Screen:rn.High;break;case Re.LocalVideoLowTrack:a=rn.Low}return{stream_type:a,ssrcs:p,mid:m}})}createUnmuteMessage(t){return t.map(r=>{var i;let a,[l,{track:u,ssrcs:p,id:m}]=r;switch(l){case Re.LocalAudioTrack:a=rn.Audio;break;case Re.LocalVideoTrack:a=Ce(i=u._hints).call(i,Zt.SCREEN_TRACK)?rn.Screen:rn.High;break;case Re.LocalVideoLowTrack:a=rn.Low}return{stream_type:a,ssrcs:p,mid:m}})}filterTobeUnSubscribedTracks(t,r){const i=[],a=this.remoteUserMap.get(t);if(!a)return i;if(r){const l=a.get(r);if(!l)return i;i.push([t,{kind:r,id:l}])}else Array.from(a.entries()).forEach(l=>{let[u,p]=l;i.push([t,{kind:u,id:p}])});return i}createUnsubscribeMessage(t){const r=[];return t.forEach(i=>{let[a,{kind:l,id:u}]=i;switch(l){case ze.VIDEO:return void(a._videoSSRC&&r.push({stream_type:ze.VIDEO,ssrcId:a._videoSSRC}));case ze.AUDIO:return void(a._audioSSRC&&r.push({stream_type:ze.AUDIO,ssrcId:a._audioSSRC}))}}),r}withdrawRemoteTracks(t){t.forEach(r=>{let[i,{kind:a}]=r;const l=this.remoteUserMap.get(i);l&&(l.delete(a),Array.from(l.entries()).length===0&&this.remoteUserMap.delete(i))})}async updateBitrateLimit(t){const r=this.localTrackMap.get(Re.LocalVideoTrack),i=this.localTrackMap.get(Re.LocalVideoLowTrack);r&&(await r.track.setBitrateLimit(t.uplink),await new je((a,l)=>{this.handleUpdateVideoEncoder(r.track,a,l,!0)})),i&&t.low_stream_uplink&&(await i.track.setBitrateLimit({max_bitrate:t.low_stream_uplink.bitrate,min_bitrate:t.low_stream_uplink.bitrate||0}),await new je((a,l)=>{this.handleUpdateVideoEncoder(i.track,a,l,!0)}))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const t=this.sendConnection.peerConnectionState,r=this.recvConnection.peerConnectionState;return t!=="connected"&&r!=="connected"}return!0}async tryToUnmuteAudio(t){for(let r=0;r<t.length;r++)if(t[r]instanceof $n){const i=this.filterTobeUnmutedTracks(t[r]);if(i.length===0)continue;const a=this.createUnmuteMessage(i);return void await gn(this,rt.RequestUnmuteLocal,a)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=t=>this.getStats(t),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(t=>{let[,{ssrcs:r}]=t;return!!r}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=t=>{var r;return!((r=this.recvConnection)===null||r===void 0||!r.getRemoteVideoIsReady(t))},this.statsUploader.requestUpload=(t,r)=>this.emit(rt.RequestUpload,t,r),this.statsUploader.requestUploadStats=t=>this.emit(rt.RequestUploadStats,t),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Er(qx(this.dtlsFailedCount,er)),this.emit(rt.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(Re.LocalVideoTrack)||this.pendingLocalTracks.some(t=>t instanceof pn)}throwIfTrackTypeNotMatch(t){if(t.filter(r=>r instanceof pn).length>1)throw new ge(K.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t.filter(r=>r instanceof $n).length>1&&(t.some(r=>r instanceof $n&&r._bypassWebAudio)||!jt().webAudioMediaStreamDest))throw new ge(K.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const r of t){if(r instanceof pn&&this.pendingLocalTracks.some(i=>i instanceof pn))throw new ge(K.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r instanceof $n&&this.pendingLocalTracks.some(i=>i instanceof $n)&&(!jt().webAudioMediaStreamDest||r._bypassWebAudio||this.pendingLocalTracks.some(i=>i instanceof $n&&i._bypassWebAudio)))throw new ge(K.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(t,r){const i=!W("DISABLE_DUAL_STREAM_USE_ENCODING")&&jt().supportDualStreamEncoding,a=pE(pE({},{width:160,height:120,framerate:15,bitrate:50}),r);let l;l=i?t._mediaStreamTrack.clone():Y1(t,a);const u=tn(8,"track-low-"),p=new pn(l,pE(pE({},i&&{scaleResolutionDownBy:S1(a,t)}),{},{frameRate:a.framerate,bitrateMax:a.bitrate,bitrateMin:a.bitrate}),void 0,void 0,u);return p.on(Xu.TRANSCEIVER_UPDATED,m=>{t._updateRtpTransceiver(m,am.LOW_STREAM)}),p._hints.push(Zt.LOW_STREAM),t.addListener(qe.NEED_CLOSE,()=>{p.close()}),p}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(t,r,i,a){var l;const u=Array.from(mi(l=this.remoteUserMap).call(l)).find(p=>p._videoSSRC===t);if(u){a||this.store.subscribe(u.uid,"video",void 0,void 0,void 0,void 0,Date.now());const p=this.store.keyMetrics,m=p.subscribe.find(g=>g.userId===u.uid&&g.type==="video");Ye.firstRemoteVideoDecode(this.store.sessionId,hr.FIRST_VIDEO_DECODE,Rn.FIRST_VIDEO_DECODE,{peer:u._uintid,videowidth:r,videoheight:i,subscribeElapse:ai.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId,apEnd:p.requestAPEnd||0,apStart:p.requestAPStart||0,joinGwEnd:p.joinGatewayEnd||0,joinGwStart:p.joinGatewayStart||0,pcEnd:p.peerConnectionEnd||0,pcStart:p.peerConnectionStart||0,subscriberEnd:(m==null?void 0:m.subscribeEnd)||0,subscriberStart:(m==null?void 0:m.subscribeStart)||0,videoAddNotify:(m==null?void 0:m.streamAdded)||0,state:a?1:0})}}async remoteMediaSsrcChanged(t,r,i){if(!this.recvConnection)return!1;const a=this.remoteUserMap.get(t);if(!a)return!1;const l=a.get(r);if(!l)return!1;const u=await this.recvConnection.getRemoteSSRC(l);return u!==void 0&&u!==i}isPreSubScribe(t){return!1}async publishDataChannel(t){throw new ge(K.NOT_SUPPORTED)}async unpublishDataChannel(t){throw new ge(K.NOT_SUPPORTED)}async subscribeDataChannel(t,r){throw new ge(K.NOT_SUPPORTED)}async unsubscribeDataChannel(t,r){throw new ge(K.NOT_SUPPORTED)}hasPendingRemoteDataChannel(t,r){throw new ge(K.NOT_SUPPORTED)}setPendingRemoteDataChannel(t,r){throw new ge(K.NOT_SUPPORTED)}async preConnect(t){throw new ge(K.NOT_SUPPORTED)}getEstablishParams(){throw new ge(K.NOT_SUPPORTED)}async reSubscribe(t){throw new ge(K.NOT_SUPPORTED)}reportVideoFirstFrameRender(t){}async updateVideoStreamParameter(t,r){throw new ge(K.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(t=>{let[r,{track:i}]=t;r===Re.LocalVideoLowTrack?i._updateRtpTransceiver(void 0,am.LOW_STREAM):i._updateRtpTransceiver(void 0)})}},Le(kn.prototype,"p2pConnect",[rz],Object.getOwnPropertyDescriptor(kn.prototype,"p2pConnect"),kn.prototype),Le(kn.prototype,"unpublish",[iz],Object.getOwnPropertyDescriptor(kn.prototype,"unpublish"),kn.prototype),Le(kn.prototype,"unpublishLowStream",[sz],Object.getOwnPropertyDescriptor(kn.prototype,"unpublishLowStream"),kn.prototype),Le(kn.prototype,"subscribe",[az],Object.getOwnPropertyDescriptor(kn.prototype,"subscribe"),kn.prototype),Le(kn.prototype,"mockSubscribe",[oz],Object.getOwnPropertyDescriptor(kn.prototype,"mockSubscribe"),kn.prototype),Le(kn.prototype,"unsubscribe",[cz],Object.getOwnPropertyDescriptor(kn.prototype,"unsubscribe"),kn.prototype),Le(kn.prototype,"muteRemote",[lz],Object.getOwnPropertyDescriptor(kn.prototype,"muteRemote"),kn.prototype),Le(kn.prototype,"unmuteRemote",[dz],Object.getOwnPropertyDescriptor(kn.prototype,"unmuteRemote"),kn.prototype),Le(kn.prototype,"hasRemoteMediaWithLock",[uz],Object.getOwnPropertyDescriptor(kn.prototype,"hasRemoteMediaWithLock"),kn.prototype),Le(kn.prototype,"disconnectForReconnect",[hz],Object.getOwnPropertyDescriptor(kn.prototype,"disconnectForReconnect"),kn.prototype),Le(kn.prototype,"remoteMediaSsrcChanged",[pz],Object.getOwnPropertyDescriptor(kn.prototype,"remoteMediaSsrcChanged"),kn.prototype),kn);function Yo(t){return function(r,i,a){const l=r[i];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return a.value=async function(){for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];switch(t){case Ko.SEND_ONLY:{const g=await this.sendMutex.lock("From P2PChannel2.".concat(i));try{return await l.apply(this,p)}finally{g()}}case Ko.RECEIVE_ONLY:{const g=await this.recvMutex.lock("From P2PChannel2.".concat(i));try{return await l.apply(this,p)}finally{g()}}default:{const g=await this.sendMutex.lock("From P2PChannel2.".concat(i)),y=await this.recvMutex.lock("From P2PChannel2.".concat(i));try{return await l.apply(this,p)}finally{g(),y()}}}},a}}class vh extends Pn{constructor(r,i){super(),F(this,"signal",void 0),F(this,"token",void 0),F(this,"tokenTimeout",void 0),F(this,"tokenInterval",void 0),F(this,"_sequence",0),F(this,"userMap",new Map),F(this,"encoder",new TextEncoder),this.signal=r,this.token=i;const a=()=>{this.signal.connectionState===Ft.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(a,1e3):this.tokenInterval=window.setTimeout(a,3*W("P2P_TOKEN_INTERVAL"))};a()}async send(r,i,a,l,u){var p;if(this.userMap.size===0)return;const m=Array.from(Ns(p=this.userMap).call(p))[0].token;typeof i!="string"&&(i=JSON.stringify(i)),l=l??tn(6,""),u=u??this._sequence++;const g={_id:l,_type:r,_seq:u,_message:i,token:"".concat(this.token,"_").concat(m)};W("SHOW_P2P_LOG")&&A.debug("send message",g,"noNeedResponse : ".concat(a)),this.splitMessage(JSON.stringify(g)).forEach(x=>{this.signal.request(nt.DATA_STREAM,{payload:gd(this.encoder.encode(x))})});const y=new je((x,S)=>{const T=window.setTimeout(()=>{this.off("res-@".concat(l,"_ack"),C),this.off("res-@".concat(l),j),this.off(ym.ABORT,V),A.debug("[external-signal] request timeout, type: ".concat(r,", requestId: ").concat(l)),this.userMap.size===0?S(new ge(K.INVALID_REMOTE_USER)):S(new ge(K.TIMEOUT))},W("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),C=()=>{T&&window.clearTimeout(T),this.off(ym.ABORT,V),a&&x()},V=()=>{T&&window.clearTimeout(T),this.off("res-@".concat(l,"_ack"),C),this.off("res-@".concat(l),j),S(new ge(K.EXTERNAL_SIGNAL_ABORT,"type: ".concat(r,", requestId: ").concat(l)))};this.once(ym.ABORT,V),this.once("res-@".concat(l,"_ack"),C);const j=(H,Y)=>{L=!0,T&&window.clearTimeout(T),this.off("res-@".concat(l,"_ack"),C),this.off(ym.ABORT,V),H==="success"?x(Y):S(new ge(K.P2P_MESSAGE_FAILED,"request ".concat(r," failed, requestId: ").concat(l)))};let L=!1;a||(this.once("res-@".concat(l),j),Er(W("SIGNAL_REQUEST_TIMEOUT")).then(()=>{L||A.warning("external_signal request timeout, type: ".concat(r,", requestId: ").concat(l,", ").concat(g))}))});try{return await y}catch(x){if(x.code===K.TIMEOUT)return await this.send(r,i,a,l,u);throw x}}onMessage(r){var i;const{_uid:a}=r;let l,u=this.userMap.get(a);if(u)l=u.splitMessageMap;else{if(this.userMap.size>0||!("_type"in r)||r._type!==Xn.CHECK)return;const{token:y}=r;l=new Map,u={uid:a,isStart:!0,token:y,splitMessageMap:l,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(a,u),this.signal.emit(vt.ON_USER_ONLINE,{uid:a}),this.handleUserOnline()}if("id"in r&&"total"in r){var p;const{id:y,total:x}=r,S=(p=l.get(y))!==null&&p!==void 0?p:[];if(S.push(r),l.has(y)||l.set(y,S),S.length!==x)return;{const T=Ou(S).call(S,(C,V)=>C.index-V.index).map(C=>C.payload).join("");l.delete(y),(r=JSON.parse(T))._uid=a}}const{_type:m,token:g}=r;if(Ce(i=[Xn.ACK,Xn.CHECK]).call(i,m))return m===Xn.CHECK&&this.handleCheckToken(u,g),void this.receiveMessage(r);g==="".concat(u.token,"_").concat(this.token)?this.handleReceivedMessage(r):A.debug('Receive unexpected message", '.concat(g,", cur_token: ").concat(u.token,"_").concat(this.token),r)}check(){const r={_id:tn(6,""),token:this.token,_type:Xn.CHECK};W("SHOW_P2P_LOG")&&A.debug("send message",r),this.signal.request(nt.DATA_STREAM,{payload:gd(this.encoder.encode(JSON.stringify(r)))})}ack(r){const i={_id:r,_type:Xn.ACK,token:this.token};W("SHOW_P2P_LOG")&&A.debug("send message",i),this.signal.request(nt.DATA_STREAM,{payload:gd(this.encoder.encode(JSON.stringify(i)))})}response(r,i,a){this.send(Xn.RESPONSE,JSON.stringify({success:!a,message:i}),!0,r)}handleReceivedMessage(r){const i=()=>{this.userMap.forEach(y=>{const{receivedMessagesMap:x,nextExpectedSequenceNumber:S}=y;for(;x.has(S);){const T=x.get(S);x.delete(S),this.receiveMessage(T),y.nextExpectedSequenceNumber++}})};if(!r)return void i();const{_uid:a,_seq:l}=r,u=this.userMap.get(a),{receivedMessagesMap:p,isStart:m,nextExpectedSequenceNumber:g}=u;if(l<g)return this.ack(r._id),void A.debug("[external-signal] receive old message, seq: ".concat(l,", ").concat(r._message));p.set(l,r),m&&l===g&&(this.receiveMessage(r),p.delete(g),u.nextExpectedSequenceNumber++,i())}receiveMessage(r){const{_id:i,_type:a,_message:l,_uid:u}=r;if(W("SHOW_P2P_LOG")&&A.debug("receive message",r),i){let p;switch(r._type!==Xn.ACK&&(l&&(p=JSON.parse(l)),this.ack(r._id)),r._type){case Xn.CANDIDATE:case Xn.CONTROL:this.signal.emit(a,p,u);break;case Xn.PUBLISH:case Xn.UNPUBLISH:case Xn.RESTART_ICE:case Xn.CALL:p.uid=u,or(this.signal,a,p).then(m=>{this.response(r._id,m)}).catch(()=>{this.response(r._id,void 0,!0)});break;case Xn.ACK:this.getListeners("res-@".concat(i,"_ack")).length>0&&this.emit("res-@".concat(i,"_ack"));break;case Xn.RESPONSE:{const{success:m,message:g}=p;this.emit("res-@".concat(i),m?"success":"failed",g);break}}}}splitMessage(r){if(r.length<vh.MAX_MESSAGE_SIZE)return[r];const i=[],{remoteToken:a}=JSON.parse(r),l=tn(6,"");let u=0,p=800;const m=Math.ceil(r.length/p);for(;r.length>0;){u++;const g={id:l,index:u,total:m,payload:r.slice(0,p),token:"".concat(this.token,"_").concat(a)};JSON.stringify(g).length>vh.MAX_MESSAGE_SIZE?p-=50:(i.push(g),r=r.slice(p))}return i.map(g=>JSON.stringify(g))}handleCheckToken(r,i){return r.token!==i?(A.debug("token changed, from ".concat(r.token," to ").concat(i)),this.reset(r.uid,i),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{A.debug("token timeout, ".concat(i)),this.reset(r.uid)},W("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const r=await or(this.signal,Xn.CALL,void 0),i=await this.send(Xn.CALL,r);this.signal.emit(Xe.P2P_CONNECTION,i,!0)}async reset(r,i){const a=this.userMap.get(r);a&&(this.emit(ym.ABORT),this.signal.emit(vt.ON_USER_OFFLINE,{uid:a.uid,reason:gve.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),i||(A.debug("change local token from ".concat(i," to ").concat(i)),this.token=tn(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(ym.ABORT)}}F(vh,"MAX_SIZE",1),F(vh,"MAX_MESSAGE_SIZE",1024);class txe extends Pn{get connectionState(){return this._connectionState}set connectionState(r){r!==this._connectionState&&(this._connectionState=r,r===Ft.CONNECTED?this.emit(Xe.WS_CONNECTED):r===Ft.RECONNECTING?this.emit(Xe.WS_RECONNECTING,this._websocketReconnectReason):r===Ft.CLOSED&&this.emit(Xe.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(r,i){super(),F(this,"__name__","P2PSignal"),F(this,"_disconnectedReason",void 0),F(this,"_websocketReconnectReason",void 0),F(this,"_connectionState",Ft.CLOSED),F(this,"reconnectToken",void 0),F(this,"p2pToken",void 0),F(this,"websocket",void 0),F(this,"openConnectionTime",void 0),F(this,"clientId",void 0),F(this,"lastMsgTime",Date.now()),F(this,"uploadCache",[]),F(this,"uploadCacheInterval",void 0),F(this,"rttRolling",new CA(5)),F(this,"pingpongTimer",void 0),F(this,"pingpongTimeoutCount",0),F(this,"joinResponse",void 0),F(this,"multiIpOption",void 0),F(this,"initError",void 0),F(this,"spec",void 0),F(this,"store",void 0),F(this,"_external_signal",void 0),F(this,"onWebsocketMessage",a=>{if(a.data instanceof ArrayBuffer)return void this.emit(Xe.ON_BINARY_DATA,a.data);const l=JSON.parse(a.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const u="res-@".concat(l._id);this.emit(u,l._result,l._message)}else if(Object.prototype.hasOwnProperty.call(l,"_type")){switch(l._type){case vt.ON_DATA_STREAM:return void this.handleDataStream(l._message);case vt.MUTE_AUDIO:case vt.MUTE_VIDEO:case vt.ON_P2P_LOST:case vt.ON_USER_ONLINE:return;case vt.ON_USER_OFFLINE:const{uid:u}=l._message;return A.debug("[".concat(this.clientId,"] user-offline uid: ").concat(u)),void this._external_signal.reset(u)}if(this.emit(l._type,l._message),l._type===vt.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===vt.ON_USER_BANNED)switch(l._message.error_code){case 14:this.close(Ut.UID_BANNED);break;case 15:this.close(Ut.IP_BANNED);break;case 16:this.close(Ut.CHANNEL_BANNED)}if(l._type===vt.ON_USER_LICENSE_BANNED)switch(l._message.error_code){case at.ERR_LICENSE_MISSING:this.close(Ut.LICENSE_MISSING);break;case at.ERR_LICENSE_EXPIRED:this.close(Ut.LICENSE_EXPIRED);break;case at.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Ut.LICENSE_MINUTES_EXCEEDED);break;case at.ERR_LICENSE_PERIOD_INVALID:this.close(Ut.LICENSE_PERIOD_INVALID);break;case at.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Ut.LICENSE_MULTIPLE_SDK_SERVICE);break;case at.ERR_LICENSE_ILLEGAL:this.close(Ut.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=r.clientId,this.spec=r,this.store=i,this.websocket=new _1("gateway-".concat(this.clientId),this.spec.retryConfig,!0,W("JOIN_GATEWAY_USE_DUAL_DOMAIN"),W("JOIN_GATEWAY_USE_443PORT_ONLY"),i),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Ft.CONNECTED&&this.reconnect("retry",Qr.OFFLINE)}),this.p2pToken=tn(6,""),this._external_signal=new vh(this,this.p2pToken)}async request(r,i,a,l){const u=tn(6,""),p={_id:u,_type:r,_message:i},m=this.websocket.connectionID,g=()=>new je((V,j)=>{if(this.connectionState===Ft.CONNECTED)return V();const L=()=>{this.off(Xe.WS_CLOSED,H),V()},H=()=>{this.off(Xe.WS_CONNECTED,L),j(new ge(K.WS_ABORT))};this.once(Xe.WS_CONNECTED,L),this.once(Xe.WS_CLOSED,H)});if(this.connectionState!==Ft.CONNECTING&&this.connectionState!==Ft.RECONNECTING||r===nt.JOIN||r===nt.REJOIN||await g(),this.websocket.sendMessage(p,!0),l)return;const y=new je((V,j)=>{let L=!1;const H=(te,se)=>{L=!0,V({isSuccess:te==="success",message:se||{}}),this.off(Xe.WS_CLOSED,Y),this.off(Xe.WS_RECONNECTING,Y),this.emit(Xe.REQUEST_SUCCESS,r,i)};this.once("res-@".concat(u),H);const Y=()=>{j(new ge(K.WS_ABORT,"type: ".concat(r))),this.off(Xe.WS_CLOSED,Y),this.off(Xe.WS_RECONNECTING,Y),this.off("res-@".concat(u),H)};this.once(Xe.WS_CLOSED,Y),this.once(Xe.WS_RECONNECTING,Y),Er(W("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==m||L||(A.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(r)),this.emit(Xe.REQUEST_TIMEOUT,r,i))})});let x=null;try{x=await y}catch(V){if(this.connectionState===Ft.CLOSED||r===nt.LEAVE)throw new ge(K.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?V.throw():r===nt.JOIN||r===nt.REJOIN?null:(await g(),await this.request(r,i))}if(x.isSuccess)return x.message;const S=Number(x.message.error_code||x.message.code),T=ih(S),C=new ge(K.UNEXPECTED_RESPONSE,"".concat(T.desc,": ").concat(x.message.error_str),{code:S,data:x.message,desc:T.desc});return T.action==="success"?x.message:(A.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(r,", error_code: ").concat(S,", message: ").concat(T.desc,", action: ").concat(T.action)),S===at.ERR_TOO_MANY_BROADCASTERS?((r===nt.JOIN||r===nt.REJOIN)&&(this.initError=C,this.close()),C.throw()):T.action==="failed"?C.throw():T.action==="quit"?(this.initError=C,this.close(),C.throw()):(S===at.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=x.message.option,A.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Qr.MULTI_IP)):this.reconnect(T.action,Qr.SERVER_ERROR),r===nt.JOIN||r===nt.REJOIN?null:await this.request(r,i)))}waitMessage(r,i){return new je(a=>{const l=u=>{(!i||i(u))&&(this.off(r,l),a(u))};this.on(r,l)})}uploadWRTCStats(r){if(!this.store.sessionId)return void A.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const i={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:r};this.upload(rh.WRTC_STATS,i)}upload(r,i){const a={_type:r,_message:i};try{this.websocket.sendMessage(a)}catch{const u=W("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Ft.CONNECTED)return;const p=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(p._type,p._message)},W("UPLOAD_CACHE_INTERVAL")||2e3))}}send(r,i){const a={_type:r,_message:i};this.websocket.sendMessage(a)}async sendExtensionMessage(r,i,a){return await this._external_signal.send(r,i,a)}init(r){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new je((i,a)=>{this.once(Xe.WS_CONNECTED,()=>i(this.joinResponse)),this.once(Xe.WS_CLOSED,()=>a(this.initError||new ge(K.WS_ABORT))),this.connectionState=Ft.CONNECTING,this.websocket.init(r).catch(a)})}close(r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=r||Ut.LEAVE,this.connectionState=Ft.CLOSED,A.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=tn(6,""),this._external_signal.clear(),this._external_signal=new vh(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(Xe.ABORT_P2P_EXECUTION);const r=await or(this,Xe.REQUEST_JOIN_INFO),i=await this.request(nt.JOIN,r);if(!i)return this.emit(Xe.REPORT_JOIN_GATEWAY,K.TIMEOUT,this.url||""),!1;this.joinResponse=i,this.emit(Xe.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Ft.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(r,i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(r,i)}async downgradeCodec(r){return!1}handleDataStream(r){try{var i;const a=zu(r.payload),l=new TextDecoder().decode(a),u=JSON.parse(l);"total"in u&&"id"in u||Ce(i=Object.values(Xn)).call(i,u._type)?(u._uid=r.uid,this._external_signal.onMessage(u)):this.emit(vt.ON_DATA_STREAM,r)}catch{this.emit(vt.ON_DATA_STREAM,r)}}handleNotification(r){A.debug("[".concat(this.clientId,"] receive notification: "),r);const i=ih(r.code);if(i.action!=="success"){if(i.action!=="failed")return i.action==="quit"?r.code===at.ERR_REPEAT_JOIN_CHANNEL&&W("IGNORE_UID_CHECK")?void this.close(Ut.UID_CONFLICT):(i.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Ut.UID_BANNED),void this.close()):void this.reconnect(i.action,Qr.SERVER_ERROR);A.error("[".concat(this.clientId,"] ignore error: "),i.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const r=W("PING_PONG_TIME_OUT"),i=Date.now();this.pingpongTimeoutCount>=r&&(A.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(i-this.lastMsgTime,"ms")),i-this.lastMsgTime>W("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Qr.TIMEOUT):this.request(nt.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-i;this.rttRolling.add(a),W("REPORT_STATS")&&this.send(nt.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleWebsocketEvents(){this.websocket.on(wt.RECONNECT_CREATE_CONNECTION,r=>{this.emit(Xe.WS_RECONNECT_CREATE_CONNECTION,r)}),this.websocket.on(wt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(wt.CLOSED,()=>{this.connectionState=Ft.CLOSED}),this.websocket.on(wt.FAILED,()=>{this._disconnectedReason=Ut.NETWORK_ERROR,this.connectionState=Ft.CLOSED}),this.websocket.on(wt.RECONNECTING,r=>{this._websocketReconnectReason=r,this.joinResponse=void 0,this.connectionState===Ft.CONNECTED?this.connectionState=Ft.RECONNECTING:this.connectionState=Ft.CONNECTING}),this.websocket.on(wt.WILL_RECONNECT,(r,i,a)=>{r!=="retry"?(A.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(r)),this.reconnectToken=void 0):A.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),a(r)}),this.websocket.on(wt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(r=>{if(this.emit(Xe.REPORT_JOIN_GATEWAY,r,this.url||""),r instanceof ge&&r.code===K.UNEXPECTED_RESPONSE&&r.data.code===at.ERR_NO_AUTHORIZED)return A.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Qr.SERVER_ERROR);A.error("[".concat(this.clientId,"] join gateway request failed"),r.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Qr.SERVER_ERROR):(this.initError=r,this.close())})}),this.websocket.on(wt.REQUEST_NEW_URLS,(r,i)=>{or(this,Xe.REQUEST_RECOVER,this.multiIpOption).then(r).catch(i)}),this.websocket.on(wt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(vt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}const nxe={name:"P2PChannel",create:function(t){let{store:r,statsCollector:i}=t;return new exe(r,i)},createSubmodule:function(t){let{store:r,spec:i}=t;return new txe(i,r)}};function fz(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function gz(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?fz(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):fz(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}class rxe{constructor(r){F(this,"sessionDesc",void 0),F(this,"localCapabilities",void 0),F(this,"rtpCapabilities",void 0),F(this,"candidates",void 0),F(this,"_originCandidates",void 0),F(this,"iceParameters",void 0),F(this,"dtlsParameters",void 0),F(this,"setup",void 0),F(this,"currentMidIndex",void 0),F(this,"cname",void 0),r=Sn(r);const{iceParameters:i,dtlsParameters:a,candidates:l,rtpCapabilities:u,setup:p,localCapabilities:m,sdkCodec:g,cname:y}=r,x=ki(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=u,this.candidates=l,this._originCandidates=Sn(l),this.iceParameters=i,this.dtlsParameters=a,this.setup=p,this.localCapabilities=m,this.cname=y;for(let S=0;S<x.mediaDescriptions.length;S++){const T=x.mediaDescriptions[S];if(T.attributes.iceUfrag=i.iceUfrag,T.attributes.icePwd=i.icePwd,T.attributes.fingerprints=a.fingerprints,T.attributes.candidates=l,T.attributes.setup=p,T.media.mediaType==="video"){T.media.fmts=u.videoCodecs.map(j=>j.payloadType.toString(10));const C=u.videoCodecs.filter(j=>{var L,H;return(L=j.rtpMap)===null||L===void 0?void 0:Ce(H=L.encodingName.toLowerCase()).call(H,g)}),V=u.videoCodecs.filter(j=>!Ce(C).call(C,j));T.attributes.payloads=[...C,...V],T.attributes.extmaps=u.videoExtensions}T.media.mediaType==="audio"&&(T.media.fmts=u.audioCodecs.map(C=>C.payloadType.toString(10)),T.attributes.payloads=u.audioCodecs,T.attributes.extmaps=u.audioExtensions),x.mediaDescriptions[S]=this.mungMediaDesc(T)}this.sessionDesc=x,this.currentMidIndex=x.mediaDescriptions.length-1}toString(){return pl(this.sessionDesc)}send(r,i,a){const{ssrcs:l,ssrcGroups:u}=O0(i,this.cname),p=this.sessionDesc.mediaDescriptions.find(y=>r===ze.VIDEO?y.media.mediaType==="video":y.media.mediaType==="audio"),m=l[0].attributes.label,g=l[0].attributes.mslabel;return p.attributes.ssrcs=p.attributes.ssrcs.concat(l),p.attributes.ssrcGroups=p.attributes.ssrcGroups.concat(u),{id:m,mslabel:g}}batchSend(r){return r.map(i=>{let{kind:a,ssrcMsg:l}=i;return this.send(a,l,void 0)})}stopSending(r){this.sessionDesc.mediaDescriptions.forEach(i=>{const a=[],l=[],u=[];i.attributes.ssrcs.forEach(p=>{Ce(r).call(r,p.attributes.label||"")?u.push(p):a.push(p)}),i.attributes.ssrcGroups.forEach(p=>{var m;Ce(m=u.map(g=>g.ssrcId)).call(m,p.ssrcIds[0])||l.push(p)}),i.attributes.ssrcs=a,i.attributes.ssrcGroups=l})}mute(r){const i=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===r);if(!i)throw new Error("mediaDescription not found with ".concat(r," in remote SDP when calling RemoteSDP.mute."));i.attributes.direction="inactive"}unmute(r){const i=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===r);if(!i)throw new Error("mediaDescription not found with ".concat(r," in remote SDP when calling RemoteSDP.unmute."));i.attributes.direction="sendonly"}receive(r,i,a){r.forEach((l,u)=>{const p=l._mediaStreamTrack,m=this.sessionDesc.mediaDescriptions.findIndex(y=>y.attributes.mid===p.kind),g=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[m],l);this.sessionDesc.mediaDescriptions[m]=g})}stopReceiving(r){}updateCandidates(r){const i=this._originCandidates.filter(l=>l.transport==="udp"),a=[];if(i.forEach(l=>{a.push(gz(gz({},l),{},{foundation:"tcpcandidate",priority:Number(l.priority)-1+"",transport:"tcp",port:Number(l.port)+90+""}))}),i.length!==0){switch(r){case jr.TCP_RELAY:this.candidates=a;break;case jr.UDP_TCP_RELAY:case jr.RELAY:this.candidates=[...i,...a];break;default:this.candidates=i}for(const l of this.sessionDesc.mediaDescriptions)l.attributes.candidates=this.candidates}}restartICE(r){r=Sn(r),this.iceParameters=r,this.sessionDesc.mediaDescriptions.forEach(i=>{i.attributes.iceUfrag=r.iceUfrag,i.attributes.icePwd=r.icePwd})}predictReceivingMids(r){const i=[];for(let a=0;a<r;a++)i.push((this.currentMidIndex+a+1).toString(10));return i}mungRecvMediaDsec(r,i){const a=Sn(r);return sh(a,i),C1(a,i),a}updateRecvMedia(r,i){const a=this.sessionDesc.mediaDescriptions.findIndex(l=>l.attributes.mid===r);if(a!==-1){const l=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[a],i);this.sessionDesc.mediaDescriptions[a]=l}}bumpMid(r){this.currentMidIndex+=r}updateTrackLabel(r,i,a){const l=this.sessionDesc.mediaDescriptions.find(p=>r===ze.VIDEO?p.attributes.mid==="video":p.attributes.mid==="audio");if(l){const p=l.attributes.ssrcs.find(m=>m.attributes.label===i);var u;p&&(p.attributes.label=a,(u=p.attributes.msid)===null||u===void 0||u.replace(i,a))}}mungMediaDesc(r){const i=Sn(r);return N1(i),function(a){const l=a.attributes.extmaps.find(u=>I_(u.extensionName));l&&a.attributes.extmaps.splice(a.attributes.extmaps.indexOf(l),1),a.attributes.payloads.forEach(u=>{const p=u.rtcpFeedbacks.findIndex(m=>m.type==="transport-cc");p!==-1&&u.rtcpFeedbacks.splice(p,1)})}(i),i}getSSRC(r){for(const i of this.sessionDesc.mediaDescriptions)for(const a of i.attributes.ssrcs)if(a.attributes.label===r)return[a]}}var vn;function vz(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function mE(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?vz(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):vz(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}let ixe=(vn=class jv extends T_{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(r=>r.rtpMap&&r.rtpMap.encodingName.toLowerCase()||"").filter(r=>{var i;return Ce(i=Object.keys(Yu)).call(i,r)}))]}constructor(r,i){super(r,i),F(this,"store",void 0),F(this,"peerConnection",void 0),F(this,"remoteSDP",void 0),F(this,"initialOffer",void 0),F(this,"statsFilter",void 0),F(this,"useRTX",!1),F(this,"localCapabilities",void 0),F(this,"localCandidateCount",0),F(this,"allCandidatesReceived",!1),F(this,"establishPromise",void 0),F(this,"mutex",void 0),this.store=i,this.mutex=new kr("P2PConnection-mutex",i.clientId),this.peerConnection=new RTCPeerConnection(jv.resolvePCConfiguration(r),{optional:[{googDscp:!0}]}),this.statsFilter=Zx(this.peerConnection,W("STATS_UPDATE_INTERVAL"),void 0,wn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const r=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!r.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const i=Ic(r.sdp),a=I0(r.sdp,{filterRTX:!this.useRTX,filterVideoFec:W("FILTER_VIDEO_FEC"),filterAudioFec:W("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=a,this.initialOffer=r,mE(mE({},i),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:a},offerSDP:r.sdp})}catch(r){throw new ge(K.GET_LOCAL_CONNECTION_PARAMS_FAILED,r.toString())}}async updateRemoteConnect(){}async connect(r){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new rxe(mE(mE({},r),{},{rtpCapabilities:r.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const i=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(i.toString()))}}async updateRemoteRTPCapabilities(r,i){throw new ge(K.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(r){}send(r,i){var a=this;return $i(function*(){const l=yield Nt(a.mutex.lock());try{if(!a.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const u=r.map(T=>a.peerConnection.addTrack(T._mediaStreamTrack)),p=yield Nt(a.peerConnection.createOffer()),m=ki(p.sdp),g=r.map(T=>{const C=T._mediaStreamTrack,V=m.mediaDescriptions.find(j=>j.attributes.mid===C.kind);if(!V)throw new Error("Cannot extract ssrc from mediaDescription.");return function(j,L,H){const Y=j.attributes.ssrcs.filter(se=>se.attributes.label===L),te=j.attributes.ssrcGroups;if(Y.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(te&&Y.length>1){const se=te.find(oe=>oe.ssrcIds.indexOf(Y[0].ssrcId)!==-1);return se?[{ssrcId:se.ssrcIds[0],rtx:H?se.ssrcIds[1]:void 0}]:[{ssrcId:Y[0].ssrcId}]}return[{ssrcId:Y[0].ssrcId}]}(V,C.id,a.useRTX)});let y;try{y=yield g}catch(T){throw u.forEach(C=>{Pr()&&C.replaceTrack(null),a.peerConnection.removeTrack(C)}),T}const x=a.mungSendOfferSDP(p.sdp,r);a.remoteSDP.receive(r,i,y);const S=a.remoteSDP.toString();return yield Nt(a.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield Nt(a.applySendEncodings(u,r)),yield Nt(a.peerConnection.setRemoteDescription({type:"answer",sdp:S})),r.map((T,C)=>{const V=T._mediaStreamTrack.id;return{localSSRC:g[C],id:V}})}catch(u){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(u.toString()))}finally{l()}})()}async stopSending(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const i=this.peerConnection.getSenders().filter(u=>{var p;return r.indexOf(((p=u.track)===null||p===void 0?void 0:p.id)||"")!==-1});if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");i.map(u=>{Pr()&&u.replaceTrack(null),this.peerConnection.removeTrack(u)});const a=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(a),this.remoteSDP.stopReceiving(r);const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(i.toString()))}}async receive(r,i,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(r," before remoteSDP created."));const{id:u,mslabel:p}=this.remoteSDP.send(r,i,l),m=new je((x,S)=>{const T=setTimeout(()=>{S(new Error("Cannot receive track, id: ".concat(u)))},1e4),C=V=>{const j=Ht();if((j.name==="Safari"&&Number(j.version)===11||pi())&&V.track.id!==u&&V.streams[0].id===p){var L;const H=V.streams[0].getTracks()[0];return(L=this.remoteSDP)===null||L===void 0||L.updateTrackLabel(r,u,V.track.id),this.peerConnection.removeEventListener("track",C),clearTimeout(T),void x(H)}if(V.track.id===u)return this.peerConnection.removeEventListener("track",C),clearTimeout(T),void x(V.track)};this.peerConnection.addEventListener("track",C)}),g=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const y=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(y),{track:await m,id:u}}catch(u){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async stopReceiving(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(r);const i=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const a=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(a)}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}}async muteRemote(r){}async unmuteRemote(r){}async muteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const i=this.peerConnection.getSenders().filter(a=>{var l;return r.indexOf(((l=a.track)===null||l===void 0?void 0:l.id)||"")!==-1});if(i.length!==r.length)throw new Error("sender' length doesn't match mids' length.");i.map(a=>{if(Pr()&&a.track)a.track.enabled=!1;else{const l=a.getParameters();l.encodings.forEach(u=>u.active=!1),a.setParameters(l)}})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(i.toString()))}}async unmuteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const i=this.peerConnection.getSenders().filter(u=>{var p;return r.indexOf(((p=u.track)===null||p===void 0?void 0:p.id)||"")!==-1});if(i.length!==r.length)throw new Error("Senders' length doesn't match mids' length.");i.map(async u=>{if(Pr()&&u.track)u.track.enabled=!0;else{const p=u.getParameters();p.encodings.forEach(m=>m.active=!0),await u.setParameters(p)}});const a=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(a);const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(i.toString()))}}restartICE(r){var i=this;return $i(function*(){const a=yield Nt(i.mutex.lock("From P2PConnection.restartICE"));try{if(!i.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const l=jt().supportPCSetConfiguration;if(r===jr.RELAY&&!l)return;if(l){const y=i.peerConnection.getConfiguration(),x=r===jr.RELAY?"relay":"all";y.iceTransportPolicy!==x&&(A.debug("[".concat(i.store.clientId,"] restartICE change iceTransportPolicy from [").concat(y.iceTransportPolicy,"] to [").concat(x,"]")),y.iceTransportPolicy=x,i.peerConnection.setConfiguration(y))}r!==jr.RELAY&&i.remoteSDP.updateCandidates(r);const u=yield Nt(i.peerConnection.createOffer({iceRestart:!0}));if(!u.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const p=Ic(u.sdp),{remoteIceParameters:m}=yield p.iceParameters;i.remoteSDP.restartICE(m);const g=i.remoteSDP.toString();yield Nt(i.peerConnection.setLocalDescription(u)),yield Nt(i.peerConnection.setRemoteDescription({type:"answer",sdp:g}))}catch(l){A.warning("[".concat(i.store.clientId,"] restart ICE failed, abort operation"),l)}finally{a()}})()}close(){var r;this.peerConnection.close(),(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(r){return this.statsFilter.getVideoIsReady(r)}async updateEncoderConfig(r,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[i]);this.remoteSDP.updateRecvMedia(i._mediaStreamTrack.kind,i);const u=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new ge(K.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(r,i){const a=this.peerConnection.getSenders().filter(l=>{var u;return((u=l.track)===null||u===void 0?void 0:u.id)===r});a.length===1&&await this.applySendEncodings(a,[i])}setStatsRemoteVideoIsReady(r,i){this.statsFilter.setVideoIsReady2(r,i)}async replaceTrack(r,i){const a=this.peerConnection.getSenders().find(l=>{var u;return((u=l.track)===null||u===void 0?void 0:u.id)===i});a&&await a.replaceTrack(r._mediaStreamTrack)}createDataChannels(r,i){throw new ge(K.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(r){throw new ge(K.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var r;(r=this.onICEConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var r;(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=r=>{r.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},W("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(r){const i={iceServers:[],sdpSemantics:"plan-b"};return r.iceServers?i.iceServers=r.iceServers:r.turnServer&&r.turnServer.mode!=="off"&&(Bu(r.turnServer.servers)?i.iceServers=r.turnServer.servers:(i.iceServers&&i.iceServers.push(...jv.turnServerConfigToIceServers(r.turnServer.servers)),W("USE_TURN_SERVER_OF_GATEWAY")&&i.iceServers&&r.turnServer.serversFromGateway&&i.iceServers.push(...jv.turnServerConfigToIceServers(r.turnServer.serversFromGateway)),r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(i.iceTransportPolicy="relay")}))),i}static turnServerConfigToIceServers(r){const i=[];return r.forEach(a=>{a.security?a.tcpport&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),i}async updateRtpSenderEncodings(r,i){var a;if(i||(i=this.peerConnection.getSenders().find(y=>{var x;return((x=y.track)===null||x===void 0?void 0:x.id)===r._mediaStreamTrack.id})),!i)return A.warn("[".concat(r.getTrackId(),"] no rtpSender found}"));if(!jt().supportSetRtpSenderParameters)return A.warn("Browser not support set rtp-sender parameters");const l={},u={};if(r instanceof pn)switch(r._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;default:l.degradationPreference="balanced"}if(W("DSCP_TYPE")&&Sc()){var p;const y=W("DSCP_TYPE");Ce(p=["very-low","low","medium","high"]).call(p,y)&&(u.networkPriority=y)}const m=i.getParameters(),g=(a=m.encodings)===null||a===void 0?void 0:a[0];g&&Object.assign(g,u),Object.assign(m,l),A.debug("[".concat(r.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(m.encodings))),await i.setParameters(m)}async applySendEncodings(r,i){try{if(!jt().supportSetRtpSenderParameters||r.length!==i.length)return;for(let a=0;a<r.length;a++){const l=r[a],u=i[a];l&&u&&await this.updateRtpSenderEncodings(u,l)}}catch{A.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(r,i){const a=ki(r);return i.forEach((l,u)=>{const p=l._mediaStreamTrack,m=a.mediaDescriptions.find(g=>g.attributes.mid===p.kind);m&&sh(m,l)}),pl(a)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=r=>{var i;(i=this.onFirstAudioReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoReceived=r=>{var i;(i=this.onFirstVideoReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstAudioDecoded=r=>{var i;(i=this.onFirstAudioDecoded)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoDecoded=(r,i,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,r,i,a)},this.statsFilter.onSelectedLocalCandidateChanged=(r,i)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,r,i)},this.statsFilter.onSelectedRemoteCandidateChanged=(r,i)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,r,i)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const i=this.remoteSDP.batchSend(r).map((u,p)=>{let{id:m,mslabel:g}=u;const{kind:y}=r[p];return new je((x,S)=>{const T=setTimeout(()=>{S(new Error("Cannot receive track, id: ".concat(m)))},1e4),C=V=>{const j=Ht();if(j.name==="Safari"&&Number(j.version)===11&&V.track.id!==m&&V.streams[0].id===g){var L;const H=V.streams[0].getTracks()[0];return(L=this.remoteSDP)===null||L===void 0||L.updateTrackLabel(y,m,V.track.id),this.peerConnection.removeEventListener("track",C),clearTimeout(T),void x({track:H,id:m})}if(V.track.id===m)return this.peerConnection.removeEventListener("track",C),clearTimeout(T),void x({track:V.track,id:m})};this.peerConnection.addEventListener("track",C)})}),a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});const l=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(l),await je.all(i)}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(i.toString()))}}async getRemoteSSRC(r){if(!this.remoteSDP)return;const i=this.remoteSDP.getSSRC(r);return i==null?void 0:i[0].ssrcId}setConfiguration(r){if(jt().supportPCSetConfiguration){const i=jv.resolvePCConfiguration(r);this.peerConnection.setConfiguration(i)}}},Le(vn.prototype,"connect",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"connect"),vn.prototype),Le(vn.prototype,"stopSending",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"stopSending"),vn.prototype),Le(vn.prototype,"receive",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"receive"),vn.prototype),Le(vn.prototype,"stopReceiving",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"stopReceiving"),vn.prototype),Le(vn.prototype,"muteRemote",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"muteRemote"),vn.prototype),Le(vn.prototype,"unmuteRemote",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"unmuteRemote"),vn.prototype),Le(vn.prototype,"muteLocal",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"muteLocal"),vn.prototype),Le(vn.prototype,"unmuteLocal",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"unmuteLocal"),vn.prototype),Le(vn.prototype,"close",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"close"),vn.prototype),Le(vn.prototype,"updateEncoderConfig",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"updateEncoderConfig"),vn.prototype),Le(vn.prototype,"updateSendParameters",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"updateSendParameters"),vn.prototype),Le(vn.prototype,"replaceTrack",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"replaceTrack"),vn.prototype),Le(vn.prototype,"getRemoteSSRC",[wa],Object.getOwnPropertyDescriptor(vn.prototype,"getRemoteSSRC"),vn.prototype),vn);function wa(t,r,i){const a=t[r];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){const l=this.mutex,u=await l.lock("Locking from P2PConnection.".concat(r));try{for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];return await a.apply(this,m)}finally{u()}},i}const sxe={name:"PlanBConnection",create:function(t){let{store:r,spec:i}=t;return new ixe(i,r)}},axe={interceptLocalAudioFrame:async function(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!jt().supportWebRTCEncodedTransform)return void A.warning("browser not support audio encoded transform");if(h_.has(t)||!t.track)return;const i={track:t.track};if(ul()){if(!t.createEncodedStreams)return void A.warning("browser not support createEncodedStreams() API");let l=null;try{l=t.createEncodedStreams()}catch(p){return void A.error("create audio-encoded-streams error",p&&p.message)}const u=new TransformStream({transform(p,m){i.controller||(i.controller=m),t.track&&t.track.id!==i.track.id&&(A.debug("audio track changed: ".concat(i.track.id," => ").concat(t.track.id)),i.track.removeEventListener("ended",a),i.track=t.track,i.track.addEventListener("ended",a));const g=r.metadata&&r.metadata();g?function(y,x){const{chunk:S,controller:T}=x,C=vd.METADATA;S.data=function(V,j,L){const H=L.byteLength,Y=H+i1+d8,te=n1+r1+Y,se=new ArrayBuffer(V.byteLength+te),oe=new DataView(se);oe.setUint8(0,l8),oe.setUint16(1,Y),oe.setUint8(3,j),oe.setUint16(4,H);for(let de=0;de<H;de++)oe.setUint8(6+de,L[de]);const ne=new Uint8Array(oe.buffer);return ne.set(new Uint8Array(V),te),ne.buffer}(S.data,C,y),T.enqueue(S)}(g,{chunk:p,controller:m}):m.enqueue(p)}});l.readable.pipeThrough(u).pipeTo(l.writable)}else if(Pr()){if(typeof RTCRtpScriptTransform>"u")return void A.warning("browser not support RTCRtpScriptTransform");const l=u_(),u=new MessageChannel;await new je(m=>l.onmessage=g=>{g.data==="registered"&&m(void 0)});const p=new RTCRtpScriptTransform(l,{name:"audio-metadata-tx",port:u.port2},[u.port2]);t.transform=p,await new je(m=>l.onmessage=g=>{g.data==="started"&&m(void 0)}),u.port1.onmessage=m=>{var g;if(m.data.transformed&&t.track&&((g=t.track)===null||g===void 0?void 0:g.id)!==i.track.id)A.debug("audio track changed: ".concat(i.track.id," => ").concat(t.track.id)),i.track.removeEventListener("ended",a),i.track=t.track,i.track.addEventListener("ended",a);else if(m.data.getMetadata){const y=r.metadata&&r.metadata();y&&u.port1.postMessage({metadata:y})}},i.worker=l}function a(){if(t.track){if(this.id!==t.track.id)return;t.track.removeEventListener("ended",a)}const l=h_.get(t);if(l){h_.delete(t);try{var u,p;(u=l.controller)===null||u===void 0||u.terminate(),(p=l.worker)===null||p===void 0||p.terminate()}catch(m){A.warning(m&&m.message)}}}h_.set(t,i),t.track.addEventListener("ended",a)},interceptRemoteAudioFrame:async function(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!jt().supportWebRTCEncodedTransform)return void A.warning("browser not support audio encoded transform");if(y_.has(t))return;const i={track:t.track,onMetadata:r.onMetadata,onPts:r.onPts};if(ul()&&!pi()){if(!t.createEncodedStreams)return void A.warning("browser not support createEncodedStreams() API");pA(Yt.CHROME,87,116)||(r.enableTopn=!1);let l=null;try{l=t.createEncodedStreams()}catch(p){return void A.error("create audio-encoded-streams error",p&&p.message)}const u=new TransformStream({transform(p,m){i.controller||(i.controller=m),t.track&&t.track.id!==i.track.id&&(A.debug("audio track changed: ".concat(i.track.id," => ").concat(t.track.id)),i.track.removeEventListener("ended",a),i.track=t.track,i.track.addEventListener("ended",a)),r.enableTopn?function(g,y,x){var S;const T=s1(new DataView(y.data));if(!T)return x.enqueue(y);const C=g.track.id;M0e.set(C,g.track);const V=(S=T.tlv.find(se=>se.tag===vd.AUDIO_LEVEL))===null||S===void 0?void 0:S.value;let j=0;typeof V=="number"&&(j=127-V);const L=Math.round(Math.pow(10,j/60)-1),{selected:H,speaker:Y}=function(se,oe){let ne=mm.get(se);if(ne||(ne=function(de){const be=new h8;return mm.set(de,be),Fo||(Fo=new D0e(W("TOPN_SILENCE_THRESHOLD")||500),Fo.on("ActiveSpeakerChanged",Se=>{Se!=null&&(f_=Se)})),Fo.addSpeakers([be]),be}(se)),mm.size<=p8)return{selected:!0,speaker:ne};if(!Fo)throw new Error("no active speaker detector");return Fo.levelChanged(ne.id,oe),eh=Fo.loudest.map(de=>de.id),f_&&!Ce(eh).call(eh,f_)&&eh.length>=p8&&eh.pop(),{selected:Ce(eh).call(eh,ne.id)||ne.id===f_,speaker:ne}}(g,L),te=function(se,oe,ne){const de=Vo.get(se)||new L0e(se,oe);return de.score=ne,Vo.set(se,de),function(be){if(g_.set(be,!0),!v_)return void(v_=Date.now());const Se=Date.now();Se-v_>1e3&&(g_.get(be)?g_.set(be,!1):(m8(be),g_.delete(be)),v_=Se)}(se),de}(C,g.track,Y.energyScore);te.addSample(H),te.active&&(y.data=T.frame.buffer,x.enqueue(y))}(t,p,m):r.enableMetadata||r.enablePts?function(g,y,x,S){const T=new DataView(g.data),C=T.getUint8(0);let V;if(128&C&&C!==71){const H=function(Y){if(Y.byteLength<=0)return[];const te=[];let se=0;for(;se<Y.byteLength;){const ne=(128&Y.getUint8(se))>>7,de=127&Y.getUint8(se);if(!(ne&&se+4<=Y.byteLength)){se++;break}{const be=Y.getUint32(se,!1),Se=(16776192&be)>>10,Be=1023&be;te.push({pt:de,ts_offset:Se,length:Be,data:new Uint8Array}),se+=4}}let oe=Y.byteLength-se;for(const ne of te){if(ne.length>oe)return console.warn("Broken red payload"),[];ne.length>0&&(ne.data=new Uint8Array(Y.buffer,Y.byteOffset+se,ne.length),se+=ne.length,oe-=ne.length)}if(oe>0){const ne={pt:te.length>0?te[te.length-1].pt:0,ts_offset:0,length:oe,data:new Uint8Array(Y.buffer,Y.byteOffset+se,oe)};te.push(ne)}return te}(T);if(H.length>0){const Y=function(te){let se=0;for(let de=0;de<te.length;de++)se+=de<te.length-1?4:1,se+=te[de].length;const oe=new Uint8Array(se);let ne=0;for(let de=0;de<te.length;de++)if(de<te.length-1){const be=(2147483648|(127&te[de].pt)<<24|(262143&te[de].ts_offset)<<10|1023&te[de].length)>>>0;oe[ne++]=be>>24&255,oe[ne++]=be>>16&255,oe[ne++]=be>>8&255,oe[ne++]=255&be}else oe[ne++]=127&te[de].pt;for(const de of te)oe.set(de.data,ne),ne+=de.length;return oe}(H.map(te=>{const se=new Uint8Array(te.length);se.set(te.data);const oe=s1(new DataView(se.buffer));return oe!=null&&oe.frame&&(te.data=oe==null?void 0:oe.frame),V=oe,te}));g.data=Y.buffer}}else V=s1(T),V&&(g.data=V.frame.buffer);if(y.enqueue(g),!V)return;const j=V.tlv.find(H=>H.tag===vd.METADATA);j&&x&&j.value instanceof Uint8Array&&x(j.value);const L=V.tlv.find(H=>H.tag===vd.AUDIO_64_BIT_PTS);L&&S&&L.value instanceof Uint8Array&&L.value.length==8&&S(new DataView(L.value.buffer).getBigUint64(0,!0))}(p,m,r.onMetadata,r.onPts):m.enqueue(p)}});l.readable.pipeThrough(u).pipeTo(l.writable)}else{if(typeof RTCRtpScriptTransform>"u")return void A.warning("browser not support RTCRtpScriptTransform");const l=u_(),u=new MessageChannel;await new je(m=>l.onmessage=g=>{g.data==="registered"&&m(void 0)});const p=new RTCRtpScriptTransform(l,{name:"audio-metadata-rx",port:u.port2},[u.port2]);t.transform=p,await new je(m=>l.onmessage=g=>{g.data==="started"&&m(void 0)}),u.port1.onmessage=m=>{var g;m.data.transformed&&t.track&&((g=t.track)===null||g===void 0?void 0:g.id)!==i.track.id?(A.debug("audio track changed: ".concat(i.track.id," => ").concat(t.track.id)),i.track.removeEventListener("ended",a),i.track=t.track,i.track.addEventListener("ended",a)):m.data.metadata&&i.onMetadata?i.onMetadata(m.data.metadata):m.data.pts&&i.onPts&&i.onPts(m.data.pts)},i.worker=l}function a(){t.track.removeEventListener("ended",a),function(l){const u=y_.get(l);if(u){(function(g){const y=mm.get(g);y&&(mm.delete(g),Fo&&(Fo.removeSpeakers([y]),mm.size===0&&(Fo.destroy(),Fo=null)))})(l),m8(l.track.id),y_.delete(l);try{var p,m;(p=u.controller)===null||p===void 0||p.terminate(),(m=u.worker)===null||m===void 0||m.terminate()}catch(g){A.warning(g&&g.message)}}}(t)}y_.set(t,i),t.track.addEventListener("ended",a)},interceptLocalVideoFrame:async function(t,r){if(!jt().supportWebRTCEncodedTransform)return void A.warning("browser not support video encoded transform");if(b_.has(t)||!t.track)return;const i={track:t.track};if(ul()){if(!t.createEncodedStreams)return void A.warning("browser not support createEncodedStreams() API");let l=null;try{l=t.createEncodedStreams()}catch(m){return void A.error("create video-encoded-streams error",m&&m.message)}const u=[];r.on("sei-to-send",m=>{u.push(m)});const p=new TransformStream({transform(m,g){i.controller||(i.controller=g),t.track&&t.track.id!==i.track.id&&(A.debug("video track changed: ".concat(i.track.id," => ").concat(t.track.id)),i.track.removeEventListener("ended",a),i.track=t.track,i.track.addEventListener("ended",a));const y=v8(new Uint8Array(m.data)),x=u.shift();if(x){const S=function(T,C,V){switch(V){case l1:return function(j,L){const H=g8(L),Y=H.length,te=Math.floor(Y/255),se=Y%255,oe=new Uint8Array(6+te+1+Y+j.byteLength);oe[0]=0,oe[1]=0,oe[2]=0,oe[3]=1,oe[4]=6,oe[5]=101;let ne=0;for(;ne<te;)oe[6+ne]=255,ne++;return oe[6+ne]=se,ne++,oe.set(H,6+ne),oe.set(new Uint8Array(j),6+ne+Y),oe.buffer}(T,C);case d1:return function(j,L){const H=g8(L),Y=H.length,te=Math.floor(Y/255),se=Y%255,oe=new Uint8Array(7+te+1+Y+1+j.byteLength);oe[0]=0,oe[1]=0,oe[2]=0,oe[3]=1,oe[4]=78,oe[5]=1,oe[6]=101;let ne=0;for(;ne<te;)oe[7+ne]=255,ne++;return oe[7+ne]=se,ne++,oe.set(H,7+ne),ne+=Y,oe[7+ne]=128,ne++,oe.set(new Uint8Array(j),7+ne),oe.buffer}(T,C);default:return null}}(m.data,x,y);S&&(m.data=S)}g.enqueue(m)}});l.readable.pipeThrough(p).pipeTo(l.writable)}else{if(!Pr())return;{if(typeof RTCRtpScriptTransform>"u")return void A.warning("browser not support RTCRtpScriptTransform");const l=u_(),u=new MessageChannel;await new je(m=>l.onmessage=g=>{g.data==="registered"&&m(void 0)});const p=new RTCRtpScriptTransform(l,{name:"sei-tx",port:u.port2},[u.port2]);t.transform=p,await new je(m=>l.onmessage=g=>{g.data==="started"&&m(void 0)}),r.on("sei-to-send",m=>{u.port1.postMessage({sei:m})}),u.port1.onmessage=m=>{var g;m.data.transformed&&t.track&&((g=t.track)===null||g===void 0?void 0:g.id)!==i.track.id&&(A.debug("video track changed: ".concat(i.track.id," => ").concat(t.track.id)),i.track.removeEventListener("ended",a),i.track=t.track,i.track.addEventListener("ended",a))},i.worker=l}}function a(){if(t.track){if(this.id!==t.track.id)return;t.track.removeEventListener("ended",a)}const l=b_.get(t);if(l){b_.delete(t);try{var u,p;(u=l.controller)===null||u===void 0||u.terminate(),(p=l.worker)===null||p===void 0||p.terminate()}catch(m){A.warning(m&&m.message)}}}b_.set(t,i),t.track.addEventListener("ended",a)},interceptRemoteVideoFrame:async function(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!jt().supportWebRTCEncodedTransform)return void A.warning("browser not support video encoded transform");if(!t.track)return;if(N0.has(t)){const l=N0.get(t);return void(l&&(l.onSei=r.onSei))}const i={track:t.track,onSei:r.onSei};if(ul()){if(!t.createEncodedStreams)return void A.warning("browser not support createEncodedStreams() API");let l=null;try{l=t.createEncodedStreams()}catch(p){return void A.error("create video-encoded-streams error",p&&p.message)}const u=new TransformStream({transform(p,m){if(i.controller||(i.controller=m),!i.firstFrameInfo){var g;const x=p.getMetadata()||{};i.firstFrameInfo=xn({type:p.type,rtpTimestamp:p.timestamp,payloadType:x.payloadType||0,ssrc:x.synchronizationSource||0,length:p.data.byteLength},"mimeType"in x?{mimeType:x.mimeType}:{}),(g=r.onFirstFrame)===null||g===void 0||g.call(r,i.firstFrameInfo)}t.track&&t.track.id!==i.track.id&&(A.debug("video track changed: ".concat(i.track.id," => ").concat(t.track.id)),i.track.removeEventListener("ended",a),i.track=t.track,i.track.addEventListener("ended",a));const y=function(x,S){switch(S){case l1:return function(T){const C=new DataView(T.data);let V=0;for(;V+4<T.data.byteLength;){if(C.getUint8(V+0)===0&&C.getUint8(V+1)===0&&C.getUint8(V+2)===0&&C.getUint8(V+3)===1&&C.getUint8(V+4)===6){let j=V+6,L=0,H=0;for(;(H=C.getUint8(j++))===255;)L+=255;L+=H;const Y=f8(T.data,j,L);return new Uint8Array(Y)}V++}return null}(x);case d1:return function(T){const C=new DataView(T.data);let V=0;for(;V+5<T.data.byteLength;){if(C.getUint8(V+0)===0&&C.getUint8(V+1)===0&&C.getUint8(V+2)===0&&C.getUint8(V+3)===1&&C.getUint8(V+4)===78&&C.getUint8(V+5)===1&&C.getUint8(V+6)===101){let j=V+7,L=0,H=0;for(;(H=C.getUint8(j++))===255;)L+=255;L+=H;const Y=f8(T.data,j,L);return new Uint8Array(Y)}V++}return null}(x);default:return null}}(p,v8(new Uint8Array(p.data)));y&&i.onSei&&i.onSei(y),m.enqueue(p)}});l.readable.pipeThrough(u).pipeTo(l.writable)}else if(Pr()){if(typeof RTCRtpScriptTransform>"u")return void A.warning("browser not support RTCRtpScriptTransform");const l=u_(),u=new MessageChannel;await new je(m=>l.onmessage=g=>{g.data==="registered"&&m(void 0)});const p=new RTCRtpScriptTransform(l,{name:"sei-rx",port:u.port2},[u.port2]);t.transform=p,await new je(m=>l.onmessage=g=>{g.data==="started"&&m(void 0)}),u.port1.onmessage=m=>{var g;if(m.data.transformed&&t.track&&((g=t.track)===null||g===void 0?void 0:g.id)!==i.track.id)A.debug("video track changed: ".concat(i.track.id," => ").concat(t.track.id)),i.track.removeEventListener("ended",a),i.track=t.track,i.track.addEventListener("ended",a);else if(m.data.sei&&i.onSei)i.onSei(m.data.sei);else if(m.data.firstFrameInfo&&r.onFirstFrame){var y;(y=r.onFirstFrame)===null||y===void 0||y.call(r,m.data.firstFrameInfo)}},i.worker=l}function a(){if(t.track){if(this.id!==t.track.id)return;t.track.removeEventListener("ended",a)}(function(l){const u=N0.get(l);if(u){N0.delete(l);try{var p,m;(p=u.controller)===null||p===void 0||p.terminate(),(m=u.worker)===null||m===void 0||m.terminate()}catch(g){A.warning(g&&g.message)}}})(t)}N0.set(t,i),t.track.addEventListener("ended",a)}},oxe={name:"InterceptFrame",create:()=>axe};var Wt;function yz(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}function qo(t){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?yz(Object(i),!0).forEach(function(a){F(t,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):yz(Object(i)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(i,a))})}return t}let cxe=(Wt=class Hm extends T_{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var r,i;return(r=(i=this.peerConnection.getReceivers()[0])===null||i===void 0||(i=i.transport)===null||i===void 0?void 0:i.state)!==null&&r!==void 0?r:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(r=>r.rtpMap&&r.rtpMap.encodingName.toLowerCase()||"").filter(r=>{var i;return Ce(i=Object.keys(Yu)).call(i,r)}))]}constructor(r,i,a){super(r,i),F(this,"id",tn(5,"connection-")),F(this,"store",void 0),F(this,"peerConnection",void 0),F(this,"forceTurn",!1),F(this,"remoteSDP",void 0),F(this,"initialOffer",void 0),F(this,"transportEventReceiver",void 0),F(this,"statsFilter",void 0),F(this,"extension",{useXR:W("USE_XR")}),F(this,"localCapabilities",void 0),F(this,"remoteCodecs",void 0),F(this,"localCandidateCount",0),F(this,"allCandidatesReceived",!1),F(this,"isPreallocation",!1),F(this,"preMediaMap",new Map),F(this,"dataStreamChannelMap",new Map),F(this,"establishPromise",void 0),F(this,"recoveredDataChannelIds",[]),F(this,"currentDataChannelId",1),F(this,"supportAV1RtpSpec",!1),F(this,"mutex",void 0),F(this,"qualityLimitationReason",nm.NONE),F(this,"isFirstConnected",!1),this.store=i,this.forceTurn=K1(r),this.mutex=new kr("NVConnectionExtension-mutex",i.clientId),this.peerConnection=a,this.isFirstConnected=!1,this.statsFilter=Zx(this.peerConnection,W("STATS_UPDATE_INTERVAL"),void 0,wn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,r.isPreallocation&&(this.isPreallocation=!0),this.establishPromise=this.establish()}getPreMedia(r){return this.preMediaMap.get(r)}isPreSub(){return this.preMediaMap.size>0}async updateRemoteRTPCapabilities(r,i){if(this.remoteCodecs=i,!this.remoteSDP)return void A.debug("[NVConnectionExtension] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(i));if(this.remoteSDP.updateRemoteCodec(r,i,this.store.codec)){const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}else A.debug("[NVConnectionExtension] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const i=await this.peerConnection.createOffer();if(!i.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const a=Ic(i.sdp),l=await A1({filterRTX:!W("USE_PUB_RTX")&&!W("USE_SUB_RTX"),filterVideoFec:W("FILTER_VIDEO_FEC"),filterAudioFec:W("FILTER_AUDIO_FEC"),filterVideoCodec:W("FILTER_VIDEO_CODEC"),unsupportedVideoUplinkCodec:W("UNSUPPORTED_VIDEO_UPLINK_CODEC"),unsupportedVideoDownlinkCodec:W("UNSUPPORTED_VIDEO_DOWNLINK_CODEC")},this.extension);if(this.localCapabilities=P0(l),this.initialOffer=i,W("ENABLE_SVC")&&this.store.codec=="av1"){const p=await z8();var r;p&&(this.supportAV1RtpSpec=!0,(r=l.send)===null||r===void 0||r.videoExtensions.push(p))}let u;return i.sdp&&P_(i.sdp)&&(u=Sn(l),M8(u)),qo(qo({},a),{},{rtpCapabilities:u||l,offerSDP:i.sdp})}catch(i){throw new ge(K.GET_LOCAL_CONNECTION_PARAMS_FAILED,i.toString())}}async connect(r){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnectionExtension without initial offer.");this.initialOffer.sdp&&P_(this.initialOffer.sdp)&&U8(r.rtpCapabilities,this.localCapabilities),this.remoteSDP=new gG(qo(qo({},r),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec,!(!W("ENABLE_PRE_SUB_WITH_PRE_PC")||!W("PRE_USE_LOCAL_CODECS"))&&w0(this.store),!0),r.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const i=this.remoteSDP.toString(),a=I1(this.initialOffer.sdp,this.extension),l=this.logSDPExchange(a||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:a}),l==null||l(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i});const u=this.peerConnection.getTransceivers()[0];if(u!=null&&u.receiver&&this.tryBindTransportEvents(u.receiver),w0(this.store))if(r.preallocation&&W("ENABLE_PRE_SUB_WITH_PRE_PC")){const p=W("PRE_SUB_NUM"),{mids:m,preSSRCs:g}=this.remoteSDP.preloadRemoteMedia(p);await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[".concat(this.store.clientId,"] [NVConnectionExtension] preload media, in pre pc,add preload ssrcs ").concat(g)),this.presetMedia(m,g)}else{const{preSSRCs:p=[]}=r,m=p.map(y=>y.ssrcMsg[0].ssrcId);if(p.length===0)return;const{mids:g}=this.remoteSDP.batchSend(p.map(y=>Object.assign({},y)));await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[NVConnectionExtension.connect] preload media, after join, add preload ssrcs ".concat(m)),this.presetMedia(g,m)}}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.connect failed; ".concat(i.toString()))}}presetMedia(r,i){r.forEach((a,l)=>{this.peerConnection.getTransceivers().forEach(u=>{if(u.mid!=null&&a===u.mid&&u.receiver.track){const p=u.receiver.track;let m;p.kind==="video"&&W("ENABLE_PRE_RENDER")&&(m=new l_({trackId:"track-".concat(p.kind,"-unknown-").concat(this.store.clientId,"_").concat(tn(5,""))},!0),m.updateVideoTrack(p),m.onFirstVideoFrameRender=()=>{var g;const y=this.preMediaMap.get(i[l]);y&&(y.firstVideoRender=Date.now()),(g=this.onFirstVideoRender)===null||g===void 0||g.call(this,i[l])},m.onVideoBufferReady=()=>{var g;(g=this.onFirstVideoBufferReady)===null||g===void 0||g.call(this,i[l])},m.play(this.store.sessionId||void 0)),this.preMediaMap.set(i[l],{mid:a,track:p,player:m,transceiver:u})}}),this.store.peerReceiver()})}checkDtlsParameters(r){return!!this.remoteSDP&&r.length>0&&this.remoteSDP.updateRemoteDtlsParameters(r)}async updateRemoteConnect(r){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.updateRemoteConnect before remote SDP created");let i=!1;const{rtpCapabilities:a}=r;if([,i]=this.remoteSDP.updateRemoteRTPCapabilities(a),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0){const p=this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);i=i||p}const{preSSRCs:l=[]}=r,u=l.map(p=>p.ssrcMsg[0].ssrcId);if(!this.remoteSDP.checkPreloadSsrcs(u)){const p=[],m=[];if(Array.from(this.preMediaMap.entries()).every(g=>{let[y,{mid:x,player:S,track:T}]=g;return p.push(x),m.push(y),this.preMediaMap.delete(y),S&&S.destroy(),!0}),p.length>0&&(this.remoteSDP.stopSending(p),await ds(this.peerConnection,this.remoteSDP,this.extension),A.warn("[NVConnectionExtension.updateRemoteConnect] preload media, failed, del preload ssrcs ".concat(m)),Ye.reportApiInvoke(this.store.sessionId,{name:Cn.PRELOAD_MEDIA_FAILED,options:[l,m],tag:hn.TRACER}).onSuccess()),l.length>0){const{mids:g}=this.remoteSDP.batchSend(l.map(y=>Object.assign({},y)));await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[NVConnectionExtension.updateRemoteConnect] preload media, after join, add preload ssrcs ".concat(u)),this.presetMedia(g,u)}}i?(await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[NVConnectionExtension] updateRemoteConnect by exchanging SDP.")):A.debug("[NVConnectionExtension] updateRemoteConnect no need to exchange SDP, because no need to update remote codecs (use local codecs)")}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.updateRemoteConnect failed; ".concat(i.toString()))}}send(r,i,a){var l=this;return $i(function*(){const u=yield Nt(l.mutex.lock("From NVConnectionExtension.send"));try{if(!l.remoteSDP)throw new Error("Cannot call NVConnectionExtension.send before remote SDP created");const p=[],m=A0();r.forEach(L=>{const H=l.peerConnection.addTransceiver(L._mediaStreamTrack,qo({direction:"sendonly"},L.trackMediaType==="video"&&l.supportAV1RtpSpec&&m?{sendEncodings:[{scalabilityMode:m}]}:{}));p.push(H),L._updateRtpTransceiver(H)}),wn()&&W("SIMULCAST")===!0&&(yield Nt(l.applySimulcastForFirefox(p,r)));const g=yield Nt(l.peerConnection.createOffer()),y=l.remoteSDP.predictReceivingMids(r.length),x=l.mungSendOfferSDP(g.sdp,r,y),S=ki(x),T=y.map(L=>{const H=S.mediaDescriptions.find(Y=>Y.attributes.mid===L);if(!H)throw new Error("Cannot extract ssrc from mediaDescription.");return T1(H,W("USE_PUB_RTX"))});let C;try{C=yield T}catch(L){C=[],l.remoteSDP.receive(r,i,a,C);const H=l.remoteSDP.toString();throw yield Nt(l.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield Nt(l.peerConnection.setRemoteDescription({type:"answer",sdp:H})),yield Nt(l.stopSending(y,!0)),L}l.remoteSDP.receive(r,i,a,C);const V=l.remoteSDP.toString(),j=l.logSDPExchange(x,"offer","local","send");return yield Nt(l.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield Nt(l.applySimulcastEncodings(p,r)),yield Nt(l.applySendEncodings(p,r)),j==null||j(V),yield Nt(l.peerConnection.setRemoteDescription({type:"answer",sdp:V})),p.map((L,H)=>{const Y=y[H];return{localSSRC:T[H],id:Y,transceiver:L}})}catch(p){throw p instanceof ge?p:new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.send failed; ".concat(p.toString()))}finally{u()}})()}async createDataChannels(r,i){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.createDataChannels before remote SDP created");let a=this.dataStreamChannelMap.get(r);if(a&&a.readyState==="open")A.debug("[NVConnectionExtension] Channels are already available and can be reused directly.");else{const u=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof u!="number")throw new Error("create DataChannel error, because cannot get dc id");a=this.peerConnection.createDataChannel("datastream-channel",{id:u,negotiated:!0,ordered:!1,maxRetransmits:W("DATASTREAM_MAX_RETRANSMITS")}),a.binaryType="arraybuffer",this.dataStreamChannelMap.set(r,a)}i.forEach(u=>{u._updateOriginDataChannel(a)});const{needExchangeSDP:l}=this.remoteSDP.sendDataChannel();if(l){const u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:u});const p=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(p),A.debug("[NVConnectionExtension] createDataChannels by exchanging SDP.")}else A.debug("[NVConnectionExtension] createDataChannels no need to exchange SDP.");return}catch(a){throw a instanceof ge?a:new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.createDataChannels failed; ".concat(a.toString()))}}async stopDataChannels(r){try{const i=this.dataStreamChannelMap.get(r);return i&&(i.id&&this.recoveredDataChannelIds.push(i.id),i.close()),void this.dataStreamChannelMap.delete(r)}catch(i){throw i instanceof ge?i:new ge(K.DATACHANNEL_FAILED,"NVConnectionExtension.stopDataChannels failed; ".concat(i.toString()))}}async stopSending(r,i){const a=i?void 0:await this.mutex.lock("From NVConnectionExtension.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.stopSending before remote SDP created");const l=this.peerConnection.getTransceivers().filter(g=>r.indexOf(g.mid)!==-1);if(l.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVConnectionExtension.stopSending.");l.map(g=>{var y;Tm(this.id+g.mid,this),g.direction="inactive",(y=g.stop)===null||y===void 0||y.call(g)});const u=await this.peerConnection.createOffer(),p=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(r);const m=this.remoteSDP.toString();p==null||p(m),await this.peerConnection.setRemoteDescription({type:"answer",sdp:m})}catch(l){throw new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.stopSending failed; ".concat(l.toString()))}finally{a&&a()}}async receive(r,i,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.receive ".concat(r," before remoteSDP created."));const{mid:u,needExchangeSDP:p}=this.remoteSDP.send(r,i,a,l);p&&(await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[".concat(this.store.clientId,"] [NVConnectionExtension] receive ").concat(r," by exchanging SDP.")));const m=this.peerConnection.getTransceivers().find(g=>g.mid===u);if(!m)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:m.receiver.track,id:u,transceiver:m}}catch(u){throw new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.receive failed; ".concat(u.toString()))}}async batchReceive(r){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.batchReceive before remoteSDP created.");const{mids:i,needExchangeSDP:a}=this.remoteSDP.batchSend(r);return a&&(await ds(this.peerConnection,this.remoteSDP,this.extension),A.debug("[".concat(this.store.clientId,"] [NVConnectionExtension] batchReceive by exchanging SDP."))),i.map(l=>{const u=this.peerConnection.getTransceivers().find(p=>p.mid===l);if(!u)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:u.receiver.track,id:l,transceiver:u}})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.receive failed; ".concat(i.toString()))}}async stopReceiving(r){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.stopReceiving before remote SDP created.");r.forEach(u=>{Array.from(this.preMediaMap.entries()).some(p=>{let[m,{mid:g,player:y}]=p;if(g===u)return this.preMediaMap.delete(m),y&&y.destroy(),!0})}),this.remoteSDP.stopSending(r);const i=this.remoteSDP.toString(),a=this.logSDPExchange(i,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension stopReceiving failed; ".concat(i.toString()))}}async muteRemote(r){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.muteRemote mid=".concat(r," before remote SDP created."));this.remoteSDP.mute(r);const i=this.remoteSDP.toString(),a=this.logSDPExchange(i,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.muteRemote failed; ".concat(i.toString()))}}async unmuteRemote(r){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.unmuteRemote mid=".concat(r," before remote SDP created."));this.remoteSDP.unmute(r);const i=this.remoteSDP.toString(),a=this.logSDPExchange(i,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.unmuteRemote failed; ".concat(i.toString()))}}async muteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.muteLocal before remote SDP created.");const i=this.peerConnection.getTransceivers().filter(p=>p.mid&&r.indexOf(p.mid)!==-1);if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(p=>{p.direction="inactive"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.muteRemote(r);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.muteLocal failed; ".concat(i.toString()))}}async unmuteLocal(r){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.unmuteLocal before remote SDP created.");const i=this.peerConnection.getTransceivers().filter(p=>p.mid&&r.indexOf(p.mid)!==-1);if(i.length!==r.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(async(p,m)=>{p.direction="sendonly"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.unmuteRemote(r),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(r,this.remoteCodecs,this.store.codec);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new ge(K.EXCHANGE_SDP_FAILED,"NVConnectionExtension.unmuteLocal failed; ".concat(i.toString()))}}restartICE(r){var i=this;return $i(function*(){const a=yield Nt(i.mutex.lock("From NVConnectionExtension.restartICE"));try{if(!i.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const l=jt().supportPCSetConfiguration,u=W("FORCE_TURN_TCP")||i.forceTurn;if(r===jr.RELAY&&!l)return;if(l&&!u){const S=r===jr.RELAY?"relay":"all",T=i.peerConnection.getConfiguration();T.iceTransportPolicy!==S&&(A.debug("[".concat(i.store.clientId,"] restartICE change iceTransportPolicy from [").concat(T.iceTransportPolicy,"] to [").concat(S,"]")),T.iceTransportPolicy=S,i.peerConnection.setConfiguration(T))}i.remoteSDP.updateCandidates(r);const p=yield Nt(i.peerConnection.createOffer({iceRestart:!0}));if(!p.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const m=Ic(p.sdp),{remoteIceParameters:g}=yield m.iceParameters;i.remoteSDP.restartICE(g);const y=i.remoteSDP.toString(),x=i.logSDPExchange(p.sdp||"","offer","local","restartICE");i.store.descriptionStart(),yield Nt(i.peerConnection.setLocalDescription(p)),x==null||x(y),yield Nt(i.peerConnection.setRemoteDescription({type:"answer",sdp:y}))}catch(l){A.warning("[".concat(i.store.clientId,"] restart ICE failed, abort operation"),l)}finally{a()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;const r=await this.mutex.lock("From NVConnectionExtension.extendCandidate");try{this.remoteSDP.updateCandidates(jr.TCP_RELAY),await ds(this.peerConnection,this.remoteSDP,this.extension)}catch(i){A.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),i)}finally{r()}}close(){var r;this.peerConnection.getTransceivers().forEach(i=>{Tm(this.id+i.mid,this)}),this.preMediaMap.forEach(i=>{let{player:a}=i;a&&a.destroy()}),this.preMediaMap.clear(),this.peerConnection.close(),(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return qo(qo({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(r){return this.statsFilter.getVideoIsReady(r)}async updateEncoderConfig(r,i){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[i],[r]);this.remoteSDP.updateRecvMedia(r,i);const u=this.remoteSDP.toString(),p=this.logSDPExchange(l,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),p==null||p(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new ge(K.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(r,i){const a=this.peerConnection.getTransceivers().filter(l=>l.mid===r);a.length===1&&(this.isVP8Simulcast(i)?wn()||await this.applySimulcastEncodings(a,[i]):await this.applySendEncodings(a,[i]))}setStatsRemoteVideoIsReady(r,i){this.statsFilter.setVideoIsReady2(r,i)}async replaceTrack(r,i){const a=this.peerConnection.getTransceivers().find(l=>l.mid===i);a&&await a.sender.replaceTrack(r._mediaStreamTrack)}async getSelectedCandidatePair(){const r=this.peerConnection.getReceivers();if(r.length>0&&r[0].transport&&r[0].transport.iceTransport&&r[0].transport.iceTransport.getSelectedCandidatePair&&r[0].transport.iceTransport.getSelectedCandidatePair()){const i=r[0].transport.iceTransport,{local:a,remote:l}=i.getSelectedCandidatePair();return{local:qo(qo({},Ja),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port}),remote:qo(qo({},Ja),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var r;(r=this.onICEConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var r;this.peerConnection.connectionState==="connected"&&(this.isFirstConnected=!0),(r=this.onConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=r=>{if(r&&(r.errorCode||r.errorText)){var i;const a="code: ".concat(r.errorCode,", message: ").concat(r.errorText),l=r.port?"local: ".concat(r.port):"",u=Ac(r.url||"");A.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: NVConnectionExtension.onICECandidateError(").concat(a,"), url: ").concat(u||"",", host_candidate:").concat(l)),(i=this.onICECandidateError)===null||i===void 0||i.call(this,a)}},this.peerConnection.onicegatheringstatechange=r=>{r&&r.target&&"iceGatheringState"in r.target&&A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(r.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=r=>{r.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,A.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},W("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(r){const i={iceServers:[]},a=r.cloudProxyServer||"disabled";return r.iceServers?i.iceServers=r.iceServers:r.turnServer&&(Bu(r.turnServer.servers)?i.iceServers=r.turnServer.servers:W("NEW_TURN_MODE")&&i.iceServers&&a==="disabled"?(W("USE_TURN_SERVER_OF_GATEWAY")?r.turnServer.serversFromGateway&&i.iceServers.push(...Hm.newTurnServerConfigToIceServers(r.turnServer.serversFromGateway)):i.iceServers.push(...Hm.newTurnServerConfigToIceServers(r.turnServer.servers)),W("NEW_FORCE_TURN")&&(i.iceTransportPolicy="relay")):r.turnServer.mode!=="off"&&(i.iceServers&&i.iceServers.push(...Hm.turnServerConfigToIceServers(r.turnServer.servers)),W("USE_TURN_SERVER_OF_GATEWAY")&&i.iceServers&&r.turnServer.serversFromGateway&&i.iceServers.push(...Hm.turnServerConfigToIceServers(r.turnServer.serversFromGateway)),W("FORCE_TURN_TCP")?i.iceTransportPolicy="relay":r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).forEach(l=>{l.forceturn&&(i.iceTransportPolicy="relay")}))),W("ENABLE_ENCODED_TRANSFORM")&&jt().supportWebRTCEncodedTransform&&(i.encodedInsertableStreams=!0),i}static turnServerConfigToIceServers(r){const i=[];return r.forEach(a=>{a.security?a.tcpport&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(no(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!W("FORCE_TURN_TCP")&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),i}static newTurnServerConfigToIceServers(r){const i=[];return r.forEach(a=>{const l=W("NEW_TURN_MODE");l===1?i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":3478?transport=udp")}):l===2?i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":3478?transport=tcp")}):l===3?i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(no(a.turnServerURL),":443?transport=tcp")}):l===4&&(i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":3478?transport=udp")}),i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":3478?transport=tcp")}),i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(no(a.turnServerURL),":443?transport=tcp")}))}),i}tryBindTransportEvents(r){const i=r.transport;if(i){this.transportEventReceiver=r,i.onstatechange=()=>{var l;i!=null&&i.state&&((l=this.onDTLSTransportStateChange)===null||l===void 0||l.call(this,i.state))},i.onerror=l=>{var u;(u=this.onDTLSTransportError)===null||u===void 0||u.call(this,"error"in l?l.error:l)};const a=i.iceTransport;a&&(a.onstatechange=()=>{const l=i==null?void 0:i.iceTransport.state;var u;l&&((u=this.onICETransportStateChange)===null||u===void 0||u.call(this,l))},a.getSelectedCandidatePair&&(a.onselectedcandidatepairchange=()=>{if(a.getSelectedCandidatePair()){const{local:l,remote:u}=a.getSelectedCandidatePair()||{};if(l&&u){const p=l.address+":"+l.port,m=u.address+":"+u.port;A.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify(Ac(p)),", remote ").concat(JSON.stringify(Ac(m))))}}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(r,i){var a,l;if(i||(i=this.peerConnection.getSenders().find(L=>L.track===r._mediaStreamTrack)),!i)return A.warn("[".concat(r.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(r))return A.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!jt().supportSetRtpSenderParameters)return A.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const u={},p={};switch(r._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;case"balanced":u.degradationPreference="balanced"}const m=D8(this.peerConnection,r._mediaStreamTrack),g=S6(r);if(EG(r)&&m&&i&&g&&this.getLocalVideoStats&&Ce(a=["vp8","vp9"]).call(a,this.store.codec)){var y;const j=u.degradationPreference||(Ce(y=r._hints).call(y,Zt.CUSTOM_TRACK)?W("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");wG(this.id+m.mid,g,this,j,L=>{i&&this.updateAdaptation(i,L)},this.getLocalVideoStats.bind(this))}if(r._encoderConfig){var x;const{bitrateMax:j,frameRate:L,scaleResolutionDownBy:H}=r._encoderConfig;j&&(p.maxBitrate=1e3*j),(Ce(x=r._hints).call(x,Zt.LOW_STREAM)||r.isUseScaleResolutionDownBy)&&(L&&(p.maxFramerate=qi(L)),H&&H>=1&&(p.scaleResolutionDownBy=H))}const{maxFramerate:S}=W("ENCODER_CONFIG_LIMIT");if(S&&typeof S=="number"&&(p.maxFramerate=p.maxFramerate?Math.min(p.maxFramerate,S):S),W("DSCP_TYPE")&&Sc()){var T;const j=W("DSCP_TYPE");Ce(T=["very-low","low","medium","high"]).call(T,j)&&(p.networkPriority=j)}const C=i.getParameters(),V=(l=C.encodings)===null||l===void 0?void 0:l[0];wn()&&!V&&(u.encodings=[p]),V&&Object.assign(V,p),Object.assign(C,u),A.debug("[".concat(r.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(C.encodings))),await i.setParameters(C),await Y8(this.store.codec,i,W("SVC_MODE"))}async updateAdaptation(r,i){var a,l;if(!r)return A.debug("[updateAdaptation] no rtpSender found");if(!jt().supportSetRtpSenderParameters)return A.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const u={},{bitrateMax:p,frameRate:m,scaleResolutionDownBy:g}=i;p&&(u.maxBitrate=1e3*p),m&&(u.maxFramerate=qi(m)),g&&g>=1&&Ce(a=["vp8","vp9"]).call(a,this.store.codec)&&(u.scaleResolutionDownBy=g);const y=r.getParameters(),x=(l=y.encodings)===null||l===void 0?void 0:l[0];x&&Object.assign(x,u),Object.assign(y,{});try{await r.setParameters(y),A.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(y.encodings)))}catch(S){!("transport"in r)||r.transport&&r.transport.state==="connected"?this.peerConnectionState!=="connected"?A.debug("[updateAdaptation] peerConnection not connected}"):A.debug("[updateAdaptation] updateRtpSenderEncodings failed",S):A.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(r,i){try{if(!jt().supportSetRtpSenderParameters||r.length!==i.length)return;for(let a=0;a<r.length;a++){const l=r[a],u=i[a];u instanceof pn&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,l.sender)}}catch{A.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(r,i,a){const l=ki(r);return i.forEach((u,p)=>{const m=a[p],g=l.mediaDescriptions.find(y=>y.attributes.mid===m);g&&(sh(g,u),R1(g,u,this.store.codec))}),pl(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=r=>{var i;(i=this.onFirstAudioReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoReceived=r=>{var i;(i=this.onFirstVideoReceived)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstAudioDecoded=r=>{var i;(i=this.onFirstAudioDecoded)===null||i===void 0||i.call(this,r)},this.statsFilter.onFirstVideoDecoded=(r,i,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,r,i,a)},this.statsFilter.onSelectedLocalCandidateChanged=(r,i)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,r,i)},this.statsFilter.onSelectedRemoteCandidateChanged=(r,i)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,r,i)},this.statsFilter.onFirstVideoDecodedTimeout=r=>{var i;(i=this.onFirstVideoDecodedTimeout)===null||i===void 0||i.call(this,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(r,i){if(r.length===i.length)for(let g=0;g<r.length;g++){var a,l,u,p,m;const y=r[g],x=i[g];if(x instanceof pn&&!Ce(a=x._hints).call(a,Zt.LOW_STREAM)&&(l=x._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((u=x._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(p=x._scalabilityMode)!==null&&p!==void 0&&p.numSpatialLayers&&((m=x._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1&&this.store.codec==="vp8"){const S={},T={high:1e3*(x._encoderConfig.bitrateMax-50),medium:5e4};S.encodings=[{rid:"m",active:!0,maxBitrate:T.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:T.high}];const C=y.sender.getParameters();await y.sender.setParameters(Object.assign(C,S))}}}async applySimulcastEncodings(r,i){if(!wn()&&r.length===i.length)for(let a=0;a<r.length;a++){const l=i[a];if(l instanceof pn&&this.isVP8Simulcast(l)){const u=r[a],p={},m={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};p.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:m.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:m.medium,scaleResolutionDownBy:4}];const g=u.sender.getParameters();await u.sender.setParameters(Object.assign(g,p))}}}isVP8Simulcast(r){var i,a,l,u,p;return!!(r instanceof pn&&W("SIMULCAST")&&this.store.codec==="vp8"&&!Ce(i=r._hints).call(i,Zt.LOW_STREAM)&&(a=r._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=r._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=r._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((p=r._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1)}logSDPExchange(r,i,a,l){if(W("SDP_LOGGING"))return A.upload("[".concat(this.store.clientId,"] exchanging ").concat(a," ").concat(i," SDP during NVConnectionExtension.").concat(l,`
`),r),i==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}async getRemoteSSRC(r){if(!this.remoteSDP)return;const i=this.remoteSDP.getSSRC(r);return i&&i.length!==0?i[0].ssrcId:void 0}setConfiguration(r){if(jt().supportPCSetConfiguration){const i=Hm.resolvePCConfiguration(r);this.peerConnection.setConfiguration(i)}r.isPreallocation&&(this.isPreallocation=!0)}},Le(Wt.prototype,"updateRemoteRTPCapabilities",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"updateRemoteRTPCapabilities"),Wt.prototype),Le(Wt.prototype,"connect",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"connect"),Wt.prototype),Le(Wt.prototype,"updateRemoteConnect",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"updateRemoteConnect"),Wt.prototype),Le(Wt.prototype,"createDataChannels",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"createDataChannels"),Wt.prototype),Le(Wt.prototype,"receive",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"receive"),Wt.prototype),Le(Wt.prototype,"batchReceive",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"batchReceive"),Wt.prototype),Le(Wt.prototype,"stopReceiving",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"stopReceiving"),Wt.prototype),Le(Wt.prototype,"muteRemote",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"muteRemote"),Wt.prototype),Le(Wt.prototype,"unmuteRemote",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"unmuteRemote"),Wt.prototype),Le(Wt.prototype,"muteLocal",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"muteLocal"),Wt.prototype),Le(Wt.prototype,"unmuteLocal",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"unmuteLocal"),Wt.prototype),Le(Wt.prototype,"close",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"close"),Wt.prototype),Le(Wt.prototype,"updateEncoderConfig",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"updateEncoderConfig"),Wt.prototype),Le(Wt.prototype,"updateSendParameters",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"updateSendParameters"),Wt.prototype),Le(Wt.prototype,"replaceTrack",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"replaceTrack"),Wt.prototype),Le(Wt.prototype,"updateAdaptation",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"updateAdaptation"),Wt.prototype),Le(Wt.prototype,"getRemoteSSRC",[Qi],Object.getOwnPropertyDescriptor(Wt.prototype,"getRemoteSSRC"),Wt.prototype),Wt);function Qi(t,r,i){const a=t[r];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){const l=this.mutex,u=await l.lock("From NVConnectionExtension.".concat(r));try{for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];return await a.apply(this,m)}finally{u()}},i}var an;function bz(t){var r,i,a,l=2;for(typeof Symbol<"u"&&(i=Lx,a=Symbol.iterator);l--;){if(i&&(r=t[i])!=null)return r.call(t);if(a&&(r=t[a])!=null)return new fE(r.call(t));i="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function fE(t){function r(i){if(Object(i)!==i)return je.reject(new TypeError(i+" is not an object."));var a=i.done;return je.resolve(i.value).then(function(l){return{value:l,done:a}})}return fE=function(i){this.s=i,this.n=i.next},fE.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(i){var a=this.s.return;return a===void 0?je.resolve({value:i,done:!0}):r(a.apply(this.s,arguments))},throw:function(i){var a=this.s.return;return a===void 0?je.reject(i):r(a.apply(this.s,arguments))}},new fE(t)}let lxe=(an=class _w extends T_{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){return this._p2pConnection.localCodecs}constructor(r,i){super(r,i),F(this,"name","DataChannelConnection"),F(this,"store",void 0),F(this,"peerConnection",void 0),F(this,"cname",void 0),F(this,"mutex",new kr("DataChannelConnection-mutex")),F(this,"dataChannel",void 0),F(this,"_p2pConnection",void 0),F(this,"establishPromise",void 0),F(this,"_nvMedia",void 0),this.store=i,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(_w.resolvePCConfiguration(r),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new cxe(r,i,this.peerConnection),this.bindPCEvents(),this.establishPromise=this._p2pConnection.establishPromise}getPreMedia(r){var i;return(i=this._p2pConnection)===null||i===void 0?void 0:i.getPreMedia(r)}isPreSub(){var r,i;return(r=(i=this._p2pConnection)===null||i===void 0?void 0:i.isPreSub())!==null&&r!==void 0&&r}async establish(){return await this._p2pConnection.establish()}getP2PConnectionParams(){return this._p2pConnection.establishPromise}updateRtpSenderEncodings(r){return this._p2pConnection.updateRtpSenderEncodings(r)}async connect(r){return this.cname=r.cname,await this._p2pConnection.connect(r),await new je((i,a)=>{const l=setTimeout(()=>{this.closeSignal(),a(new pe(K.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(r.candidates))))},W("DC_CONNECTION_TIMEOUT"));this.dataChannel.onopen=()=>{if(this.dataChannel.readyState==="open")return clearTimeout(l),void i()},this.dataChannel.onerror=u=>{this.closeSignal(),a(u)},this.dataChannel.addEventListener("close",()=>{a(new pe(K.DATACHANNEL_CONNECTION_TIMEOUT))})}),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}async updateRemoteRTPCapabilities(r,i){return this._p2pConnection.updateRemoteRTPCapabilities(r,i)}send(r,i,a){var l=this;return $i(function*(){const u=yield Nt(l.mutex.lock("From DataChannelConnection.send"));try{return yield*Xp(bz(l._p2pConnection.send(r,i,a)))}finally{u()}})()}async stopSending(r,i){return this._p2pConnection.stopSending(r,i)}async createDataChannels(r,i){return this._p2pConnection.createDataChannels(r,i)}async stopDataChannels(r){return this._p2pConnection.stopDataChannels(r)}async receive(r,i,a,l){return this._nvMedia?(A.debug("[DataChannelConnection] receive ".concat(r," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(r,i,this.cname)):(A.debug("[DataChannelConnection] receive ".concat(r," by WebRTC.")),await this._p2pConnection.receive(r,i,a,l))}async batchReceive(r){return[...await this._p2pConnection.batchReceive(r)]}async stopReceiving(r){return await this._p2pConnection.stopReceiving(r)}async muteRemote(r){return await this._p2pConnection.muteRemote(r)}async unmuteRemote(r){return await this._p2pConnection.unmuteRemote(r)}async muteLocal(r){return await this._p2pConnection.muteLocal(r)}async unmuteLocal(r){return await this._p2pConnection.unmuteLocal(r)}restartICE(r){var i=this;return $i(function*(){return yield*Xp(bz(i._p2pConnection.restartICE(r)))})()}close(){var r;(r=this._nvMedia)===null||r===void 0||r.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(r){return this._p2pConnection.getRemoteVideoIsReady(r)}updateRemoteConnect(r){var i;return(i=this._nvMedia)===null||i===void 0||i.setRemoteRtpCapabilities(r),this._p2pConnection.updateRemoteConnect(r)}async updateEncoderConfig(r,i){return await this._p2pConnection.updateEncoderConfig(r,i)}async updateSendParameters(r,i){return await this._p2pConnection.updateSendParameters(r,i)}setStatsRemoteVideoIsReady(r,i){this._p2pConnection.setStatsRemoteVideoIsReady(r,i)}async replaceTrack(r,i){return await this._p2pConnection.replaceTrack(r,i)}async getRemoteSSRC(r){return this._p2pConnection.getRemoteSSRC(r)}logSDPExchange(r,i,a,l){if(W("SDP_LOGGING"))return A.upload("exchanging ".concat(a," ").concat(i," SDP during DataChannelConnection.").concat(l,`
`),r),i==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}static resolvePCConfiguration(r){const i={iceServers:[]};return r.iceServers?i.iceServers=r.iceServers:r.turnServer&&r.turnServer.mode!=="off"&&(Bu(r.turnServer.servers)?i.iceServers=r.turnServer.servers:(i.iceServers&&i.iceServers.push(..._w.turnServerConfigToIceServers(r.turnServer.servers)),W("USE_TURN_SERVER_OF_GATEWAY")&&i.iceServers&&r.turnServer.serversFromGateway&&i.iceServers.push(..._w.turnServerConfigToIceServers(r.turnServer.serversFromGateway)),W("FORCE_TURN_TCP")?i.iceTransportPolicy="relay":r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(i.iceTransportPolicy="relay")}))),W("ENABLE_ENCODED_TRANSFORM")&&jt().supportWebRTCEncodedTransform&&(i.encodedInsertableStreams=!0),i}static turnServerConfigToIceServers(r){const i=[];return r.forEach(a=>{a.security?a.tcpport&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(no(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!W("FORCE_TURN_TCP")&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&i.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),i}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=r=>{var i;return(i=this.onICEConnectionStateChange)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onConnectionStateChange=r=>{var i;return(i=this.onConnectionStateChange)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onDTLSTransportStateChange=r=>{var i;return(i=this.onDTLSTransportStateChange)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onDTLSTransportError=r=>{var i;return(i=this.onDTLSTransportError)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onICETransportStateChange=r=>{var i;return(i=this.onICETransportStateChange)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onFirstAudioReceived=r=>{var i;return(i=this.onFirstAudioReceived)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onFirstVideoReceived=r=>{var i;return(i=this.onFirstVideoReceived)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onFirstAudioDecoded=r=>{var i;return(i=this.onFirstAudioDecoded)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onFirstVideoRender=r=>{var i;return(i=this.onFirstVideoRender)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onFirstVideoBufferReady=r=>{var i;return(i=this.onFirstVideoBufferReady)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onFirstVideoDecoded=(r,i,a)=>{var l;return(l=this.onFirstVideoDecoded)===null||l===void 0?void 0:l.call(this,r,i,a)},this._p2pConnection.onFirstVideoDecodedTimeout=r=>{var i;return(i=this.onFirstVideoDecodedTimeout)===null||i===void 0?void 0:i.call(this,r)},this._p2pConnection.onSelectedLocalCandidateChanged=(r,i)=>{var a;return(a=this.onSelectedLocalCandidateChanged)===null||a===void 0?void 0:a.call(this,r,i)},this._p2pConnection.onSelectedRemoteCandidateChanged=(r,i)=>{var a;return(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0?void 0:a.call(this,r,i)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(r){r.onConnectionStateChange=void 0,r.onICEConnectionStateChange=void 0,r.onICETransportStateChange=void 0,r.onDTLSTransportStateChange=void 0,r.onDTLSTransportError=void 0,r.onFirstAudioDecoded=void 0,r.onFirstAudioReceived=void 0,r.onFirstVideoDecoded=void 0,r.onFirstVideoReceived=void 0,r.onSelectedLocalCandidateChanged=void 0,r.onSelectedRemoteCandidateChanged=void 0,r.onFirstVideoDecodedTimeout=void 0}setConfiguration(r){this._p2pConnection.setConfiguration(r)}},Le(an.prototype,"connect",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"connect"),an.prototype),Le(an.prototype,"updateRemoteRTPCapabilities",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"updateRemoteRTPCapabilities"),an.prototype),Le(an.prototype,"createDataChannels",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"createDataChannels"),an.prototype),Le(an.prototype,"receive",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"receive"),an.prototype),Le(an.prototype,"stopReceiving",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"stopReceiving"),an.prototype),Le(an.prototype,"muteRemote",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"muteRemote"),an.prototype),Le(an.prototype,"unmuteRemote",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"unmuteRemote"),an.prototype),Le(an.prototype,"muteLocal",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"muteLocal"),an.prototype),Le(an.prototype,"unmuteLocal",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"unmuteLocal"),an.prototype),Le(an.prototype,"close",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"close"),an.prototype),Le(an.prototype,"updateEncoderConfig",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"updateEncoderConfig"),an.prototype),Le(an.prototype,"updateSendParameters",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"updateSendParameters"),an.prototype),Le(an.prototype,"replaceTrack",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"replaceTrack"),an.prototype),Le(an.prototype,"getRemoteSSRC",[Zs],Object.getOwnPropertyDescriptor(an.prototype,"getRemoteSSRC"),an.prototype),an);function Zs(t,r,i){const a=t[r];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){const l=this.mutex,u=await l.lock("From DataChannelConnection.".concat(r));try{for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];return await a.apply(this,m)}finally{u()}},i}function xz(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),i.push.apply(i,a)}return i}class dxe extends Pn{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(r){var i;Ce(i=["tryNext","recover"]).call(i,r)&&this.resetReconnectCount(r),this._reconnectMode=r}get state(){return this._state}set state(r){r!==this._state&&(this._state=r,this._state==="reconnecting"?this.emit(fr.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(fr.CONNECTED):this._state==="closed"?this.emit(fr.CLOSED):this._state==="failed"&&this.emit(fr.FAILED))}constructor(r,i,a,l){super(),F(this,"connectionID",0),F(this,"currentURLIndex",0),F(this,"reconnectReason",void 0),F(this,"_reconnectMode","tryNext"),F(this,"_initMutex",void 0),F(this,"_name",void 0),F(this,"_state","closed"),F(this,"_reconnectInterrupter",void 0),F(this,"_url",void 0),F(this,"_retryConfig",void 0),F(this,"_reconnectCount",0),F(this,"_forceCloseTimeout",5e3),F(this,"_onlineReconnectListener",void 0),F(this,"_closeEstablishingTransmitter",()=>{}),F(this,"_store",void 0),F(this,"_joinChannelServiceRecordIndex",void 0),F(this,"_transmitter",void 0),F(this,"_useCompress",void 0),F(this,"_inflateLength",0),F(this,"_deflateLength",0),this._store=l,this._name=r,this._retryConfig=function(u){for(var p=1;p<arguments.length;p++){var m=arguments[p]!=null?arguments[p]:{};p%2?xz(Object(m),!0).forEach(function(g){F(u,g,m[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(m)):xz(Object(m)).forEach(function(g){Object.defineProperty(u,g,Object.getOwnPropertyDescriptor(m,g))})}return u}({},i),this._useCompress=a}resetReconnectCount(r){A.debug("".concat(this._name," reset reconnect count, reason: ").concat(r)),this._reconnectCount=0}close(r,i){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const a=this._transmitter;i?setTimeout(()=>a.close(),500):a.close(),this._transmitter=void 0}this.state=r?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(r,i){if(!this._transmitter)return void A.warning("[".concat(this._name,"] can not reconnect, no websocket"));var a;r!==void 0&&(this.reconnectMode=r),A.debug("[".concat(this._name,"] reconnect is triggered initiative")),typeof this._joinChannelServiceRecordIndex=="number"&&((a=this._store)===null||a===void 0||a.recordJoinChannelService({status:"error",errors:[new Error(i)]},this._joinChannelServiceRecordIndex));const l=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),l&&l.bind(this._transmitter)({code:9999,reason:i})}getInflateData(){const r=this._inflateLength,i=this._deflateLength;return this.clearInflateData(),{inflateLength:r,deflateLength:i}}setInflateData(r){this._deflateLength=this._deflateLength+r.originLength,this._inflateLength=this._inflateLength+r.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}let Xo=function(t){return t[t.Default=0]="Default",t[t.Ack=1]="Ack",t}({});class uxe{constructor(r,i,a){F(this,"version",1),F(this,"initialRTO",void 0),F(this,"maxBatchAckCount",void 0),F(this,"maxRTO",void 0),F(this,"initialRTT",void 0),F(this,"ID",void 0),F(this,"rtt",void 0),F(this,"packetNumber",1),F(this,"rtoRatioMap",new Map),F(this,"timeoutMap",new Map),F(this,"unorderedPacketQueue",[]),F(this,"batchAckPacketQueue",[]),F(this,"lastOrderedPacketNumber",0),F(this,"batchAckTimer",void 0),F(this,"sendImpl",void 0),F(this,"receiveImpl",void 0),this.sendImpl=r,this.receiveImpl=i,this.ID=tn(7,"transmitter-"),this.initialRTO=(a==null?void 0:a.initialRTO)!==void 0?a.initialRTO:W("TRANSMITTER_INITIAL_RTO"),this.initialRTT=(a==null?void 0:a.initialRTT)!==void 0?a.initialRTT:W("TRANSMITTER_INITIAL_RTT"),this.rtt=(a==null?void 0:a.initialRTT)!==void 0?a.initialRTT:W("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=(a==null?void 0:a.maxBatchAckCount)!==void 0?a.maxBatchAckCount:W("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=(a==null?void 0:a.maxRTO)!==void 0?a.maxRTO:W("TRANSMITTER_MAX_RTO")}packetize(r,i){return{type:Xo.Default,version:this.version,packetNumber:i,payload:r}}serialize(r){switch(r.type){case Xo.Default:{let i;typeof r.payload=="string"?i=new TextEncoder().encode(r.payload):i=r.payload;const a=new ArrayBuffer(i.length+15),l=new DataView(a);return l.setUint16(0,r.version),l.setUint8(2,r.type),l.setUint32(3,r.packetNumber),bV(l,7,BigInt(r.sendTs)),new Uint8Array(l.buffer).set(i,15),a}case Xo.Ack:{const i=new ArrayBuffer(16),a=new DataView(i);return a.setUint16(0,r.version),a.setUint8(2,r.type),a.setUint32(3,r.maxAckPacketNumber),a.setUint8(7,r.shift),bV(a,8,BigInt(r.ackSendTs)),i}}}deserialize(r){const i=new DataView(r),a=i.getUint16(0),l=i.getUint8(2);switch(l){case Xo.Default:{const u=i.getUint32(3),p=yV(i,7),m=r.slice(15),g=new Uint8Array(m);return{version:a,type:l,packetNumber:u,sendTs:Number(p),payload:g}}case Xo.Ack:{const u=i.getUint32(3),p=i.getUint8(7),m=yV(i,8);return{version:a,type:l,maxAckPacketNumber:u,shift:p,ackSendTs:Number(m)}}default:throw A.error("[".concat(this.ID,"] Unrecognized packet type ").concat(l)),new Error("Unrecognized packet type ".concat(l))}}sendMessage(r){W("DC_DEBUG_LOG")&&typeof r=="string"&&A.debug("[".concat(this.ID,"] sending message packet"),JSON.parse(r));const i=this.packetize(r,this.packetNumber);this.packetNumber=this.packetNumber===4294967295?1:this.packetNumber+1;const a=this.calculateRTO(i),l=window.setTimeout(()=>{this.resendMessage(i)},a);this.timeoutMap.set(i.packetNumber,l),this.sendPacket(i)}onData(r){const i=this.deserialize(r);i.type===Xo.Default?this.ack(i):i.type===Xo.Ack&&(this.updateRTT(i,Math.round(performance.now())),this.clearRTO(i))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(r=>{let[i,a]=r;window.clearTimeout(a)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,this.batchAckTimer!==void 0&&window.clearTimeout(this.batchAckTimer)}resendMessage(r){const i=this.calculateRTO(r),a=window.setTimeout(()=>{W("DC_DEBUG_LOG")&&typeof r.payload=="string"&&A.debug("[".concat(this.ID,"] resending message packet"),JSON.parse(r.payload),"timeout: ".concat(i)),this.resendMessage(r)},i);this.timeoutMap.set(r.packetNumber,a),this.sendPacket(r)}calculateRTO(r){const i=this.rtoRatioMap.get(r.packetNumber);if(i===void 0)return this.rtoRatioMap.set(r.packetNumber,1),this.initialRTO;{const a=9*this.rtt/8*i;return this.rtoRatioMap.set(r.packetNumber,i+1),a>this.maxRTO?this.maxRTO:a}}updateRTT(r,i){const a=r.ackSendTs;this.rtt=this.rtt*(7/8)+(i-a-this.rtt)/8}ack(r){if(r.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(r):(this.batchAckPacketQueue.push(r),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(r.payload);;){const i=this.unorderedPacketQueue[0];if(!i){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(i.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(r.packetNumber<=this.lastOrderedPacketNumber){const i={ackSendTs:r.sendTs,maxAckPacketNumber:r.packetNumber,shift:0,type:Xo.Ack,version:this.version};W("DC_DEBUG_LOG")&&A.debug("[".concat(this.ID,"] sending ack packet"),i,"packetNumber: ".concat(r.packetNumber)),this.sendPacket(i)}else if(r.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[r.packetNumber-this.lastOrderedPacketNumber-2]=r;const i={ackSendTs:r.sendTs,maxAckPacketNumber:r.packetNumber,shift:0,type:Xo.Ack,version:this.version};W("DC_DEBUG_LOG")&&A.debug("[".concat(this.ID,"] sending ack packet"),i,"packetNumber: ".concat(r.packetNumber)),this.sendPacket(i)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const r={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:Xo.Ack,version:this.version};W("DC_DEBUG_LOG")&&A.debug("[".concat(this.ID,"] sending batch ack packet"),r,"shift: ".concat(this.batchAckPacketQueue.length-1)),this.sendPacket(r),this.batchAckPacketQueue=[]}sendPacket(r){r.type===Xo.Default&&(r.sendTs=Math.round(performance.now()));const i=this.serialize(r);this.sendImpl(i)}clearRTO(r){for(let i=r.maxAckPacketNumber-r.shift;i<=r.maxAckPacketNumber;i++){const a=this.timeoutMap.get(i);a!==void 0&&window.clearTimeout(a),this.timeoutMap.delete(i),this.rtoRatioMap.delete(i)}}}class _z extends dxe{constructor(r,i){super(r,i,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),F(this,"_initMutex",void 0),F(this,"_reconnectInterrupter",void 0),F(this,"_url",void 0),F(this,"_transmitter",void 0),F(this,"_addresses",void 0),F(this,"_reliableTransmission",void 0),F(this,"_textEncoder",void 0),F(this,"_textDecoder",void 0),this._textEncoder=new TextEncoder,this._textDecoder=new TextDecoder,this._initMutex=new kr("datachannel");const{timeout:a,timeoutFactor:l}=i,u=Math.max(300,Math.floor(3*a/5)),p=Math.max(1.2,Math.floor(8*l)/10);Pi.ONLINE&&(this._retryConfig.timeout=u,this._retryConfig.timeoutFactor=p),Un.on(Gu.NETWORK_STATE_CHANGE,(m,g)=>{m!==g&&(this.resetReconnectCount("network state change: ".concat(g," -> ").concat(m)),m===Pi.ONLINE?(this._retryConfig.timeout=u,this._retryConfig.timeoutFactor=p):(this._retryConfig.timeout=a,this._retryConfig.timeoutFactor=l))})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this._forceCloseTimeout=i;const a=(l,u)=>{this._addresses=r,this.currentURLIndex=this._addresses.findIndex(m=>m.fingerprint||W("FINGERPRINT"));const p=this._addresses[this.currentURLIndex];this.state="connecting",this.createTransmitterConnection(p).then(l).catch(u),this.once(fr.CLOSED,()=>u(new pe(K.WS_DISCONNECT))),this.once(fr.CONNECTED,()=>l())};return this._initMutex.lock().then(l=>new je((u,p)=>{a(u,p)}).then(()=>{l()}).catch(()=>{l()}))}async sendMessage(r){let i=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new pe(K.WS_ABORT,"datachannel is not ready");try{i||(r=JSON.stringify(r));const a=this._textEncoder.encode(r),l=wbe(a,{raw:!0});this._reliableTransmission.sendMessage(l)}catch(a){throw new pe(K.WS_ERR,"send datachannel signal message error"+a.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(r){const i=JSON.stringify(r);return{compressed:i,compressedLength:i.length,origin:r}}sendMessageWithUint8Array(r){return{compressed:r,compressedLength:r.byteLength,origin:r}}createTransmitterConnection(r){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(r.ip,":").concat(r.port),new je((i,a)=>{var l;const u=()=>{A.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="recover",this.state="connected",this.resetReconnectCount("opened"),i()},p=async x=>{var S;if((S=this._closeEstablishingTransmitter)===null||S===void 0||S.call(this),A.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(x.code,", reason: ").concat(x.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=x.reason,this.state="reconnecting");const T=As(this,fr.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,C=await this.reconnectWithAction(T);if(this.state==="closed")return void A.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!C)return a(new pe(K.WS_DISCONNECT,"datachannel reconnect failed: ".concat(x.code))),void this.close(!0);i()}else a(new pe(K.WS_DISCONNECT,"datachannel close: ".concat(x.code))),this.close()},m=async x=>{try{var S;(S=this._reliableTransmission)===null||S===void 0||S.onData(x.data)}catch(T){console.log(T)}};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),A.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(r)));const g=(l=this._store)===null||l===void 0?void 0:l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),y=Date.now();or(this,fr.TO_CONNECT_DATACHANNEL).then(x=>{var S,T;if(!x)throw new Error("transmissonInfo not exist yet");const{transmitter:C,close:V}=x;this._transmitter=C,(S=this._store)===null||S===void 0||S.signalChannelOpen();const j=Date.now()-y;A.debug("[choose dc] dc open cost ".concat(j,"ms")),this._reliableTransmission=new uxe(L=>{var H;this._transmitter&&this._transmitter.readyState==="open"&&((H=this._transmitter)===null||H===void 0||H.send(L))},L=>{if(typeof L=="string")this.emit(fr.ON_MESSAGE,L);else{const H=Tbe(L,{raw:!0}).buffer,Y=this._textDecoder.decode(H);this.emit(fr.ON_MESSAGE,Y)}}),this._closeEstablishingTransmitter=()=>{var L;(L=this._reliableTransmission)===null||L===void 0||L.close(),this._reliableTransmission=void 0,V()},u&&u(),C.onclose=p,C.onmessage=m,(T=this._store)===null||T===void 0||T.recordJoinChannelService({endTs:Date.now(),status:"success"},g),this._joinChannelServiceRecordIndex=g}).catch(x=>{var S;if((S=this._store)===null||S===void 0||S.recordJoinChannelService({endTs:Date.now(),status:x instanceof pe&&x.code===K.WS_ABORT?"aborted":"error",errors:[x]},g),this.state!=="closed"){if(x instanceof pe&&x.code===K.WS_ERR){const T=new pe(K.WS_ERR,"init datachannel failed! Error: ".concat(x.toString()));return A.error("[".concat(this._name,"]").concat(T)),void a(T)}p&&p(x)}else a(new pe(K.WS_DISCONNECT,"datachannel is closed: ".concat(x.toString())))})})}async reconnectWithAction(r){let i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount||!this._addresses||this.state==="closed")return!1;this._onlineReconnectListener||Un.networkState!==Pi.OFFLINE||(this._onlineReconnectListener=Un.onlineWaiter&&Un.onlineWaiter.then(()=>{this._onlineReconnectListener=void 0}));let a=!0;if(this._reconnectInterrupter=()=>{a=!1},i){const m=qx(this._reconnectCount,this._retryConfig);A.debug("[".concat(this._name,"] wait ").concat(m,"ms to reconnect datachannel, mode: ").concat(r)),await je.race([Er(m),this._onlineReconnectListener||new je(()=>{})])}if(this.state==="closed"||!a)return!1;this._reconnectCount+=1;const l=async(m,g)=>{this.emit(fr.RECONNECT_CREATE_CONNECTION,g),await this.createTransmitterConnection(m)};try{if(r==="retry"){const m=this._addresses[this.currentURLIndex];await l(m,r)}else if(r==="tryNext"){this.currentURLIndex+=1;for(let g=this.currentURLIndex;g<this._addresses.length;g++){if(this._addresses[g].fingerprint||W("FINGERPRINT")){this.currentURLIndex=g;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return A.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);A.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const m=this._addresses[this.currentURLIndex];await l(m,r)}else r==="recover"&&(A.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit(fr.FAILBACK));return!0}catch(m){var u,p;return A.error("[".concat(this._name,"] reconnect failed"),m.toString()),m!=null&&(u=m.data)!==null&&u!==void 0&&u.desc&&Array.isArray(m.data.desc)&&m.data.desc.length&&Ce(p=m.data.desc).call(p,"dynamic key expired")?(this.emit(fr.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(r,i)}}}class hxe extends Pn{get connectionState(){return this._connectionState}set connectionState(r){r!==this._connectionState&&(this._connectionState=r,r===Ft.CONNECTED?this.emit(Xe.WS_CONNECTED):r===Ft.RECONNECTING?this.emit(Xe.WS_RECONNECTING,this._websocketReconnectReason):r===Ft.CLOSED&&this.emit(Xe.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}processPendingNotifications(){this.pendingNotifications.length!==0&&(A.debug("[".concat(this.clientId,"] processing ").concat(this.pendingNotifications.length," pending notifications")),this.pendingNotifications.forEach(r=>{let{type:i,message:a}=r;this.emit(i,a),i===vt.ON_NOTIFICATION&&this.handleNotification(a),i===vt.ON_USER_BANNED&&this.handleUserBanned(a)}),this.pendingNotifications=[])}handleUserBanned(r){switch(r.error_code){case 14:this.close(Ut.UID_BANNED);break;case 15:this.close(Ut.IP_BANNED);break;case 16:this.close(Ut.CHANNEL_BANNED)}}constructor(r,i){super(),F(this,"__name__","DataChannelSignal"),F(this,"_disconnectedReason",void 0),F(this,"_websocketReconnectReason",void 0),F(this,"_connectionState",Ft.CLOSED),F(this,"reconnectToken",void 0),F(this,"websocket",void 0),F(this,"openConnectionTime",void 0),F(this,"clientId",void 0),F(this,"lastMsgTime",Date.now()),F(this,"uploadCache",[]),F(this,"uploadCacheInterval",void 0),F(this,"rttRolling",new CA(5)),F(this,"pingpongTimer",void 0),F(this,"inflateDataTimer",void 0),F(this,"pingpongTimeoutCount",0),F(this,"ortc",void 0),F(this,"joinResponse",void 0),F(this,"multiIpOption",void 0),F(this,"initError",void 0),F(this,"spec",void 0),F(this,"store",void 0),F(this,"isJoining",!1),F(this,"pendingNotifications",[]),F(this,"onWebsocketMessage",a=>{if(a instanceof ArrayBuffer)return void this.emit(Xe.ON_BINARY_DATA,a);const l=JSON.parse(a);if(W("DC_DEBUG_LOG")&&A.debug("[datachannel-signal] received packet",l),this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const u="res-@".concat(l._id);this.emit(u,l._result,l._message)}else Object.prototype.hasOwnProperty.call(l,"_type")&&(this.isJoining?l._type===vt.ON_NOTIFICATION||l._type===vt.ON_USER_BANNED?(this.emit(l._type,l._message),l._type===vt.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===vt.ON_USER_BANNED&&this.handleUserBanned(l._message)):(this.pendingNotifications.push({type:l._type,message:l._message}),A.debug("[".concat(this.clientId,"] cached notification during join: ").concat(l._type))):(this.emit(l._type,l._message),l._type===vt.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===vt.ON_USER_BANNED&&this.handleUserBanned(l._message)))}),this.clientId=r.clientId,this.spec=r,this.store=i,this.websocket=new _z("gateway-".concat(this.clientId),this.spec.retryConfig,!0,i),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Ft.CONNECTED&&this.reconnect("retry",bd.OFFLINE)})}async request(r,i,a,l){const u=tn(6,""),p={_id:u,_type:r,_message:i},m=this.websocket.connectionID,g=()=>new je((V,j)=>{if(this.connectionState===Ft.CONNECTED)return V();const L=()=>{this.off(Xe.WS_CLOSED,H),V()},H=()=>{this.off(Xe.WS_CONNECTED,L),j(new pe(K.WS_ABORT))};this.once(Xe.WS_CONNECTED,L),this.once(Xe.WS_CLOSED,H),r!==nt.PUBLISH&&r!==nt.SUBSCRIBE&&r!==nt.UNSUBSCRIBE&&r!==nt.UNPUBLISH&&r!==nt.CONTROL&&r!==nt.RESTART_ICE||this.once(Xe.DISCONNECT_P2P,()=>{j(new pe(K.DISCONNECT_P2P))}),r!==nt.PUBLISH&&r!==nt.RESTART_ICE||this.once(Xe.ABORT_P2P_EXECUTION,()=>{j(new pe(K.DISCONNECT_P2P))})});if(this.connectionState!==Ft.CONNECTING&&this.connectionState!==Ft.RECONNECTING||r===nt.JOIN||r===nt.REJOIN||await g(),r===nt.LEAVE&&(this.websocket.unbindDcCloseEventListener(),l=!0),W("DC_DEBUG_LOG")&&A.debug("[datachannel-signal] sendMessage",p),await this.websocket.sendMessage(p,!0,!1),l)return;const y=new je((V,j)=>{let L=!1;const H=(te,se)=>{L=!0,V({isSuccess:te==="success",message:se||{}}),this.off(Xe.WS_CLOSED,Y),this.off(Xe.WS_RECONNECTING,Y),this.emit(Xe.REQUEST_SUCCESS,r,i)};this.once("res-@".concat(u),H);const Y=()=>{j(new pe(K.WS_ABORT,"type: ".concat(r))),this.off(Xe.WS_CLOSED,Y),this.off(Xe.WS_RECONNECTING,Y),this.off("res-@".concat(u),H)};this.once(Xe.WS_CLOSED,Y),this.once(Xe.WS_RECONNECTING,Y),Er(W("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==m||L||(A.warning("dc request timeout, type: ".concat(r)),this.emit(Xe.REQUEST_TIMEOUT,r,i))})});let x=null;try{x=await y}catch(V){if(this.connectionState===Ft.CLOSED||r===nt.LEAVE)throw new pe(K.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?V.throw():r===nt.JOIN||r===nt.REJOIN?null:(await g(),await this.request(r,i))}if(x.isSuccess)return x.message;const S=Number(x.message.error_code||x.message.code),T=ih(S),C=new pe(K.UNEXPECTED_RESPONSE,"".concat(T.desc,": ").concat(x.message.error_str),{code:S,data:x.message});return T.action==="success"?x.message:(A.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(r,", error_code: ").concat(S,", message: ").concat(T.desc,", action: ").concat(T.action)),S===at.ERR_TOO_MANY_BROADCASTERS?((r===nt.JOIN||r===nt.REJOIN)&&(this.initError=C,this.close()),C.throw()):T.action==="failed"?C.throw():T.action==="quit"?(this.initError=C,this.close(),C.throw()):(S===at.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=x.message.option,A.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",bd.MULTI_IP)):this.reconnect(T.action,bd.SERVER_ERROR),r===nt.JOIN||r===nt.REJOIN?null:await this.request(r,i)))}waitMessage(r,i){return new je(a=>{const l=u=>{(!i||i(u))&&(this.off(r,l),a(u))};this.on(r,l)})}uploadWRTCStats(r){if(!this.store.sessionId)return void A.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const i={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:r};this.upload(rh.WRTC_STATS,i)}upload(r,i){const a={_type:r,_message:i};try{this.websocket.sendMessage(a)}catch{const u=W("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Ft.CONNECTED)return;const p=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(p._type,p._message)},W("UPLOAD_CACHE_INTERVAL")||2e3))}}async send(r,i){const a={_type:r,_message:i};await this.websocket.sendMessage(a)}init(r){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new je((i,a)=>{this.once(Xe.WS_CONNECTED,()=>i(this.joinResponse)),this.once(Xe.WS_CLOSED,()=>a(this.initError||new pe(K.WS_ABORT))),this.connectionState=Ft.CONNECTING,this.websocket.init(r).catch(a),this.websocket.once(fr.FAILBACK,()=>{a(new pe(K.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{this.openConnectionTime===void 0&&(A.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),a(new pe(K.INIT_DATACHANNEL_TIMEOUT)))},W("DC_JOIN_WITH_FAILBACK"))})}close(r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this.isJoining=!1,this.pendingNotifications=[],this._disconnectedReason=r||Ut.LEAVE,this.connectionState=Ft.CLOSED,A.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),r===Ut.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new _z("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),W("DC_PINGPONG_INTERVAL")),!this.joinResponse){this.emit(Xe.ABORT_P2P_EXECUTION),this.store.signalConnected();const r=await or(this,Xe.REQUEST_JOIN_INFO);this.store.joinReq(),this.isJoining=!0,this.pendingNotifications=[];const i=await this.request(nt.JOIN,r);if(this.store.joinRep(),this.ortc=r==null?void 0:r.ortc,!i)return this.emit(Xe.REPORT_JOIN_GATEWAY,K.TIMEOUT,this.url||""),!1;this.joinResponse=i,this.emit(Xe.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Ft.CONNECTED,this.isJoining=!1,this.processPendingNotifications(),!0}async rejoin(){if(!this.reconnectToken)throw new pe(K.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const r=Wu(this,Xe.REQUEST_REJOIN_INFO);r.token=this.reconnectToken;const i=await this.request(nt.REJOIN,r);return!!i&&(this.connectionState=Ft.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),W("DC_PINGPONG_INTERVAL")),i.peers&&i.peers.forEach(a=>{this.emit(vt.ON_USER_ONLINE,{uid:a.uid}),a.audio&&this.emit(vt.ON_ADD_AUDIO_STREAM,{uid:a.uid,uint_id:a.uint_id,audio:!0,ssrcId:a.audio_ssrc}),a.video&&this.emit(vt.ON_ADD_VIDEO_STREAM,{uid:a.uid,uint_id:a.uint_id,video:!0,ssrcId:a.video_ssrc}),a.audio_mute?this.emit(vt.MUTE_AUDIO,{uid:a.uid}):this.emit(vt.UNMUTE_AUDIO,{uid:a.uid}),a.video_mute?this.emit(vt.MUTE_VIDEO,{uid:a.uid}):this.emit(vt.UNMUTE_VIDEO,{uid:a.uid}),a.audio_enable_local?this.emit(vt.ENABLE_LOCAL_AUDIO,{uid:a.uid}):this.emit(vt.DISABLE_LOCAL_AUDIO,{uid:a.uid}),a.video_enable_local?this.emit(vt.ENABLE_LOCAL_VIDEO,{uid:a.uid}):this.emit(vt.DISABLE_LOCAL_VIDEO,{uid:a.uid}),a.audio||a.video||this.emit(vt.ON_REMOVE_STREAM,{uid:a.uid,uint_id:a.uint_id})}),!0)}reconnect(r,i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(r,i)}async downgradeCodec(r){if(!this.ortc)return!1;const i={downgrade_codec:r,ortc:this.ortc};return!!await this.request(nt.DOWNGRADE_CODEC,i)}handleNotification(r){A.debug("[".concat(this.clientId,"] receive notification: "),r);const i=ih(r.code);if(i.action!=="success"){if(i.action!=="failed")return i.action==="quit"?(i.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Ut.UID_BANNED),void this.close()):void this.reconnect(i.action,bd.SERVER_ERROR);A.error("[".concat(this.clientId,"] ignore error: "),i.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1,W("DC_DEBUG_LOG")&&console.debug("[datachannel-signal] pingpongTimeoutCount: ".concat(this.pingpongTimeoutCount));const r=W("PING_PONG_TIME_OUT"),i=Date.now();this.pingpongTimeoutCount>=r&&(A.warning("[datachannel-signal] PINGPONG Timeout. Last Socket Message: ".concat(i-this.lastMsgTime,"ms")),i-this.lastMsgTime>W("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("recover",bd.FALLBACK):this.request(nt.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-i;this.rttRolling.add(a),W("REPORT_STATS")&&this.send(nt.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleInflateData(){const{inflateLength:r,deflateLength:i}=this.websocket.getInflateData();r!==0&&i!==0&&this.upload(rh.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:i,ws_inflate_length:r})}handleWebsocketEvents(){this.websocket.on(fr.RECONNECT_CREATE_CONNECTION,r=>{this.emit(Xe.WS_RECONNECT_CREATE_CONNECTION,r)}),this.websocket.on(fr.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(fr.CLOSED,()=>{this.connectionState=Ft.CLOSED}),this.websocket.on(fr.FAILED,()=>{this._disconnectedReason=Ut.NETWORK_ERROR,this.connectionState=Ft.CLOSED}),this.websocket.on(fr.RECONNECTING,r=>{this._websocketReconnectReason=r,this.joinResponse=void 0,this.connectionState===Ft.CONNECTED?this.connectionState=Ft.RECONNECTING:this.connectionState=Ft.CONNECTING}),this.websocket.on(fr.WILL_RECONNECT,(r,i)=>{if(Wu(this,Xe.IS_P2P_DISCONNECTED)&&r==="retry")return A.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(Xe.NEED_RENEW_SESSION),this.emit(Xe.DISCONNECT_P2P),i("tryNext");r!=="retry"&&(A.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(r)),this.reconnectToken=void 0,this.emit(Xe.NEED_RENEW_SESSION),this.emit(Xe.DISCONNECT_P2P)),i(r)}),this.websocket.on(fr.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(r=>{A.warning("[".concat(this.clientId,"] rejoin failed ").concat(r)),this.reconnect("tryNext",bd.SERVER_ERROR)}):this.join().catch(r=>{if(this.emit(Xe.REPORT_JOIN_GATEWAY,r.message||r.code,this.url||""),r instanceof pe&&r.code===K.UNEXPECTED_RESPONSE&&r.data.code===at.ERR_NO_AUTHORIZED)return A.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",bd.SERVER_ERROR);A.error("[".concat(this.clientId,"] join gateway request failed"),r.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",bd.SERVER_ERROR):(this.initError=r,this.close())})}),this.websocket.on(fr.REQUEST_NEW_URLS,(r,i)=>{or(this,Xe.REQUEST_RECOVER,this.multiIpOption).then(r).catch(i)}),this.websocket.on(fr.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(vt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(fr.TO_CONNECT_DATACHANNEL,(r,i)=>{or(this,Xe.PRE_CONNECT_PC).then(r).catch(i)}),this.websocket.on(fr.FAILBACK,()=>{this.openConnectionTime!==void 0&&this.emit(Xe.DATACHANNEL_FAILBACK)})}}const pxe={name:"DataChannelConnection",create:function(t){let{store:r,spec:i}=t;return new lxe(i,r)}},mxe={name:"DataChannelSignal",create:function(t){let{store:r,spec:i}=t;return new hxe(i,r)}};kA(),cn("PROCESS_ID","process-".concat(tn(8,""),"-").concat(tn(4,""),"-").concat(tn(4,""),"-").concat(tn(4,""),"-").concat(tn(12,""))),function(){let t;try{t=window.localStorage.getItem("websdk_ng_global_parameter")}catch(r){return void A.error("Error loading sdk config",r.message)}if(t)try{const r=JSON.parse(window.atob(t)),i=Date.now();A.debug("Loading global parameters from cache",r),Object.keys(r).forEach(a=>{if(Object.prototype.hasOwnProperty.call(nn,a)){const{value:l,expires:u}=r[a];if(u&&u<=i)return;$s[a]=l,nn[a]=l}})}catch(r){A.error("Error loading mutableParamsCache: ".concat(t),r.message)}}(),Array.isArray($s.AREAS)&&$s.AREAS.length>0&&j1($s.AREAS,!0);const Ez=(t,r,i)=>{A.debug("setParameter key:".concat(t,", value:").concat(JSON.stringify(r))),cn(t,r,i)};Oc(Ibe,!1),Oc(kbe,!1),Oc(lye,!1),Oc($be,!1),Oc(Cbe,!1),Oc(nxe,!1),Oc(sxe,!1),Oc(oxe,!1),Oc(pxe,!1),Oc(mxe,!1);const cr=function(t){const r=new Pn,i=t,a={getListeners:r.getListeners.bind(r),on:(l,u)=>(function(p,m){p===Rc.SECURITY_POLICY_VIOLATION&&XW(m,!0)}(l,u),r.on.bind(r)(l,u)),addListener:r.addListener.bind(r),once:r.once.bind(r),off:r.off.bind(r),removeAllListeners:r.removeAllListeners.bind(r),emit:r.emit.bind(r),safeEmit:r.safeEmit.bind(r)};return qW(qW({},i),a)}({__TRACK_LIST__:qu,VERSION:fa,BUILD:LA,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:Ez,getParameter:W,getSupportedCodec:async function(){let t={audio:[],video:[]};try{let r=new RTCPeerConnection;const i=await async function(a){let l;return jt().supportUnifiedPlan?(a.addTransceiver("video",{direction:"recvonly"}),a.addTransceiver("audio",{direction:"recvonly"}),l=(await a.createOffer()).sdp):l=(await a.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,l}(r);if(!i)return t;r.close(),r=null,t=function(a){const l={video:[],audio:[]};return a.match(/ VP8/i)&&l.video.push("VP8"),a.match(/ VP9/i)&&l.video.push("VP9"),a.match(/ AV1/i)&&l.video.push("AV1"),a.match(/ H264/i)&&l.video.push("H264"),a.match(/ H265/i)&&l.video.push("H265"),a.match(/ opus/i)&&l.audio.push("OPUS"),a.match(/ PCMU/i)&&l.audio.push("PCMU"),a.match(/ PCMA/i)&&l.audio.push("PCMA"),a.match(/ G722/i)&&l.audio.push("G722"),l}(i)}catch(r){throw new pe(K.CREATE_OFFER_FAILED,r.toString&&r.toString()).print()}return t},checkSystemRequirements:function(){let t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];const r=Ye.reportApiInvoke(null,{name:Cn.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:hn.TRACER}),i=function(){let u=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],p=!1;try{const m=window.RTCPeerConnection,g=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,y=window.WebSocket;p=!(!m||!y),u&&!g&&(p=!1),p&&f0()&&oV(75)&&new m().close()}catch(m){A.error("check system requirement failed: ",m),p=!1}return p}(t),a=uye();A.debug("checkSystemRequirements, api:",i,"browser",a);const l=i&&a;return r.onSuccess(l),W("IGNORE_RTC_DEVICE_CHECK")?i:l},getDevices:function(t){return qs.enumerateDevices(!0,!0,t)},getMicrophones:function(t){return qs.getRecordingDevices(t)},getCameras:function(t){return qs.getCamerasDevices(t)},getElectronScreenSources:h6,getPlaybackDevices:function(t){return qs.getSpeakers(t)},createClient:HW,createCameraVideoTrack:async function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=W("CAMERA_CAPTURE_CONFIG"),i=tn(8,"track-cam-"),a=Ye.reportApiInvoke(null,{id:i,tag:hn.TRACER,name:Cn.CREATE_CAM_VIDEO_TRACK,options:[xn({},t),r]});r&&(t.encoderConfig=r);const l=c_(t);let u=null;A.info("start create camera video track with config",JSON.stringify(t),"trackId",i);try{u=(await Ys({video:l},i)).getVideoTracks()[0]||null}catch(m){throw a.onError(m),m}if(!u){const m=new ge(K.UNEXPECTED_ERROR,"can not find track in media stream");return a.onError(m),m.throw(A)}if(t.optimizationMode&&t1(i,u,t,Za(t.encoderConfig)),W("USE_STANDARD_BITRATE_DEFAULT")){const m=Za(t.encoderConfig);t.encoderConfig=m,delete m.bitrateMax,delete m.bitrateMin}const p=new d_(u,t,l,t.scalabiltyMode?i_(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,i);return a.onSuccess(p.getTrackId()),A.info("create camera video success, trackId:",i),p},createCustomVideoTrack:function(t){const r=tn(8,"track-cus-"),i=Ye.reportApiInvoke(null,{id:r,tag:hn.TRACER,name:Cn.CREATE_CUSTOM_VIDEO_TRACK,options:[t]});W("USE_STANDARD_BITRATE_DEFAULT")&&(delete t.bitrateMax,delete t.bitrateMin);const a=new pn(t.mediaStreamTrack,{width:t.width,height:t.height,frameRate:t.frameRate,bitrateMax:t.bitrateMax,bitrateMin:t.bitrateMin},t.scalabiltyMode?i_(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,r,[Zt.CUSTOM_TRACK]);return i.onSuccess(a.getTrackId()),A.info("create custom video track success with config",t,"trackId",a.getTrackId()),a},createScreenVideoTrack:async function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const i=typeof r=="object"?function(T){const C=E6(T);return t6()&&T.suppressLocalAudioPlayback&&(C.suppressLocalAudioPlayback=T.suppressLocalAudioPlayback),n6()&&T.restrictOwnAudio&&(C.restrictOwnAudio=!0),C}(r):void 0;i&&(r="auto");const a=tn(8,"track-scr-v-"),l=Ye.reportApiInvoke(null,{id:a,tag:hn.TRACER,name:Cn.CREATE_SCREEN_VIDEO_TRACK,options:[xn({},t),r]});t.encoderConfig?typeof t.encoderConfig=="string"||t.encoderConfig.width&&t.encoderConfig.height||(t.encoderConfig.width={max:1920},t.encoderConfig.height={max:1080}):t.encoderConfig="1080p_2";const u=function(T){const C={};T.screenSourceType&&(C.mediaSource=T.screenSourceType),T.extensionId&&ul()&&(C.extensionId=T.extensionId);const{displaySurface:V,selfBrowserSurface:j,surfaceSwitching:L,systemAudio:H,preferCurrentTab:Y,windowAudio:te,monitorTypeSurfaces:se}=T;(Mo(107)||md(107)||Vu(93))&&(V&&(Zn(V,"displaySurface",["browser","window","monitor"]),C.displaySurface=V),j?(Zn(j,"selfBrowserSurface",["exclude","include"]),C.selfBrowserSurface=j):C.selfBrowserSurface="include",L&&(Zn(L,"surfaceSwitching",["exclude","include"]),C.surfaceSwitching=L)),(Mo(105)||md(105)||Vu(91))&&H&&(Zn(H,"systemAudio",["exclude","include"]),C.systemAudio=H),(Mo(94)||md(94)||Vu(80))&&Y&&(C.preferCurrentTab=!0),(Mo(141)||md(141)||Vu(125))&&te&&(Zn(te,"windowAudio",["exclude","system"]),C.windowAudio=te),(Mo(119)||md(119)||Vu(105))&&se&&(Zn(se,"monitorTypeSurfaces",["exclude","include"]),C.monitorTypeSurfaces=se),T.electronScreenSourceId&&(C.sourceId=T.electronScreenSourceId);const oe=T.encoderConfig?GA(T.encoderConfig):null;return C.mandatory={chromeMediaSource:"desktop",maxWidth:oe?oe.width:void 0,maxHeight:oe?oe.height:void 0},oe&&(oe.frameRate&&(typeof oe.frameRate=="number"?(C.mandatory.maxFrameRate=oe.frameRate,C.mandatory.minFrameRate=oe.frameRate):(C.mandatory.maxFrameRate=oe.frameRate.max||oe.frameRate.ideal||oe.frameRate.exact||void 0,C.mandatory.minFrameRate=oe.frameRate.min||oe.frameRate.ideal||oe.frameRate.exact||void 0),C.frameRate=oe.frameRate),oe.width&&(C.width=oe.width),oe.height&&(C.height=oe.height)),C}(t);let p=null,m=null;const g=jt();if(!g.supportShareAudio&&r==="enable"){const T=new ge(K.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return l.onError(T),T.throw(A)}A.info("start create screen video track with config",t,"withAudio",r,"trackId",a);const y=g.supportShareAudio&&r!=="disable";try{const T=await Ys({screen:u,screenAudio:y?i||!0:void 0},a);p=T.getVideoTracks()[0]||null,m=T.getAudioTracks()[0]||null}catch(T){throw l.onError(T),T}if(!p){const T=new ge(K.UNEXPECTED_ERROR,"can not find track in media stream");return l.onError(T),T.throw(A)}if(!m&&r==="enable"){p&&p.stop();const T=new ge(K.SHARE_AUDIO_NOT_ALLOWED);return l.onError(T),T.throw(A)}t.optimizationMode||(t.optimizationMode="detail"),t.optimizationMode&&(t1(a,p,t,t.encoderConfig&&GA(t.encoderConfig)||void 0),t.encoderConfig&&typeof t.encoderConfig!="string"&&(t.encoderConfig.bitrateMin=t.encoderConfig.bitrateMax));const x=new pn(p,t.encoderConfig?GA(t.encoderConfig):{},t.scalabiltyMode?i_(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,a,[Zt.SCREEN_TRACK]);if(!m)return l.onSuccess(x.getTrackId()),A.info("create screen video track success","video:",x.getTrackId()),x;const S=new $n(m,void 0,tn(8,"track-scr-a-"),!1);return l.onSuccess([x.getTrackId(),S.getTrackId()]),A.info("create screen video track success","video:",x.getTrackId(),"audio:",S.getTrackId()),[x,S]},createMicrophoneAndCameraTracks:async function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=W("CAMERA_CAPTURE_CONFIG"),a=tn(8,"track-mic-"),l=tn(8,"track-cam-"),u=Ye.reportApiInvoke(null,{id:"".concat(a,"-").concat(l),tag:hn.TRACER,name:Cn.CREATE_MIC_AND_CAM_TRACKS,options:[t,r,i]});i&&(r.encoderConfig=i);const p=c_(r),m=w6(t);let g=null,y=null;A.info("start create camera video track(".concat(l,") and microphone audio track(").concat(a,") with config, audio: ").concat(JSON.stringify(t),", video: ").concat(JSON.stringify(r)));try{const T=await Ys({audio:m,video:p},"".concat(a,"-").concat(l));g=T.getAudioTracks()[0],y=T.getVideoTracks()[0]}catch(T){throw u.onError(T),T}if(!g||!y){const T=new ge(K.UNEXPECTED_ERROR,"can not find tracks in media stream");return u.onError(T),T.throw(A)}if(r.optimizationMode&&t1(l,y,r,Za(r.encoderConfig)),W("USE_STANDARD_BITRATE_DEFAULT")){const T=Za(r.encoderConfig);r.encoderConfig=T,delete T.bitrateMax,delete T.bitrateMin}const x=new T0(g,t,m,a),S=new d_(y,r,p,r.scalabiltyMode?i_(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,l);return u.onSuccess([x.getTrackId(),S.getTrackId()]),A.info("create camera video track(".concat(l,") and microphone audio track(").concat(a,") success")),[x,S]},createMicrophoneAudioTrack:async function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=tn(8,"track-mic-"),i=Ye.reportApiInvoke(null,{id:r,tag:hn.TRACER,name:Cn.CREATE_MIC_AUDIO_TRACK,options:[t]}),a=w6(t);let l=null;A.info("start create microphone audio track with config",JSON.stringify(t),"trackId",r);try{l=(await Ys({audio:a},r)).getAudioTracks()[0]||null}catch(p){throw i.onError(p),p}if(!l){const p=new ge(K.UNEXPECTED_ERROR,"can not find track in media stream");return i.onError(p),p.throw(A)}const u=new T0(l,t,a,r);return i.onSuccess(u.getTrackId()),A.info("create microphone audio track success, trackId:",r),u},createCustomAudioTrack:qB,createBufferSourceAudioTrack:async function(t){var r;const{cacheOnlineFile:i,encoderConfig:a}=t;let{source:l}=t;const u={source:l instanceof AudioBuffer?"AudioBuffer":l instanceof File?(r=File.name)!==null&&r!==void 0?r:"File":l,cacheOnlineFile:i,encoderConfig:a},p=tn(8,"track-buf-"),m=Ye.reportApiInvoke(null,{id:p,tag:hn.TRACER,name:Cn.CREATE_BUFFER_AUDIO_TRACK,options:[u]});if(W("DISABLE_WEBAUDIO"))throw new ge(K.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");A.info("start create buffer source audio track with config",JSON.stringify(u),"trackId",p);const g=l;if(!(l instanceof AudioBuffer))try{l=await async function(S,T){let C=null;if(typeof S=="string"){const j=dB.get(S);if(j)return A.debug("use cached audio resource: ",S),j;try{C=(await Uo(()=>zi.get(S,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(L){throw new ge(K.FETCH_AUDIO_FILE_FAILED,L.toString())}}else C=await new je((L,H)=>{const Y=new FileReader;Y.onload=te=>{te.target?L(te.target.result):H(new ge(K.READ_LOCAL_AUDIO_FILE_ERROR))},Y.onerror=()=>{H(new ge(K.READ_LOCAL_AUDIO_FILE_ERROR))},Y.readAsArrayBuffer(S)});const V=await function(j){const L=dm();return new je((H,Y)=>{L.decodeAudioData(j,te=>{H(te)},te=>{Y(new ge(K.DECODE_AUDIO_FILE_FAILED,te.toString()))})})}(C);return typeof S=="string"&&T&&dB.set(S,V),V}(l,i)}catch(S){return m.onError(S),S.throw(A)}const y=new I0e(l),x=new A0e(g,y,a?s_(a):{},p);return A.info("create buffer source audio track success, trackId:",p),m.onSuccess(x.getTrackId()),x},setAppType:function(t){if(A.debug("setAppType: ".concat(t)),!(Number.isInteger(t)&&t>=0))throw A.debug("Invalid appType"),new pe(K.INVALID_PARAMS,"invalid app type",t);cn("APP_TYPE",Math.floor(t))},setLogLevel:function(t){A.setLogLevel(t)},enableLogUpload:function(){W("USE_NEW_LOG")?cn("UPLOAD_LOG",!0):A.enableLogUpload()},disableLogUpload:function(){W("USE_NEW_LOG")?cn("UPLOAD_LOG",!1):A.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new pG},checkAudioTrackIsActive:async function(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const i=Ye.reportApiInvoke(null,{tag:hn.TRACER,name:Cn.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[r]});if(!(t instanceof $n||t instanceof pm)){const g=new pe(K.INVALID_TRACK,"the parameter is not a audio track");return i.onError(g),g.throw()}r&&r<1e3&&(r=1e3);const a=t instanceof $n?t.getTrackLabel():"remote_track",l=t.getVolumeLevel();let u=l,p=l;const m=Date.now();return new je(g=>{const y=setInterval(()=>{const x=t.getVolumeLevel();u=x>u?x:u,p=x<p?x:p;const S=u-p>1e-4,T=Date.now()-m;if(S||T>r){clearInterval(y);const C=S,V={duration:T,deviceLabel:a,maxVolumeLevel:u,result:C};A.info("[track-".concat(t.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(V))),i.onSuccess(V),g(C)}},200)})},checkVideoTrackIsActive:async function(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const i=Ye.reportApiInvoke(null,{tag:hn.TRACER,name:Cn.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[r]});if(!(t instanceof pn||t instanceof hm)){const S=new pe(K.INVALID_TRACK,"the parameter is not a video track");return i.onError(S),S.throw()}r&&r<1e3&&(r=1e3);const a=t instanceof pn?t.getTrackLabel():"remote_track",l=t.getMediaStreamTrack(!0),u=document.createElement("video");u.style.width="1px",u.style.height="1px",u.setAttribute("muted",""),u.muted=!0,u.setAttribute("playsinline",""),u.controls=!1,(Pr()||Hx())&&(u.style.opacity="0.01",u.style.position="fixed",u.style.left="0",u.style.top="0",document.body.appendChild(u)),u.srcObject=new MediaStream([l]),u.play();const p=document.createElement("canvas");p.width=160,p.height=120;let m=0,g=0;try{const S=Date.now();m=await function(T,C,V,j){let L,H=0,Y=null;return new je((te,se)=>{function oe(){H>j&&L&&(L(),te(H));const ne=V.getContext("2d");if(!ne){const Se=new pe(K.UNEXPECTED_ERROR,"can not get canvas 2d context.");return A.error(Se.toString()),void se(Se)}ne.drawImage(T,0,0,160,120);const de=ne.getImageData(0,0,V.width,V.height),be=Math.floor(de.data.length/3);if(Y){for(let Se=0;Se<be;Se+=3)if(de.data[Se]!==Y[Se])return H+=1,void(Y=de.data);Y=de.data}else Y=de.data}setTimeout(()=>{L&&(L(),te(H))},C),L=YA(()=>{oe()},30)})}(u,r,p,4),g=Date.now()-S}catch(S){throw i.onError(S),S}qve===Yt.SAFARI&&(u.pause(),u.remove()),u.srcObject=null;const y=m>4,x={duration:g,changedPicNum:m,deviceLabel:a,result:y};return A.info("[track-".concat(t.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(x))),i.onSuccess(x),y},setArea:j1,audioElementPlayCenter:yi,resumeAudioContext:function(){return yi.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(t){pye.processExternalMediaAEC(t)},registerExtensions:function(t){const r=W("PLUGIN_INFO")||[];t.forEach(i=>{"name"in i&&!Ce(r).call(r,i.name)&&r.push(i.name);const a=i;a.__registered__=!0,a.logger.hookLog=A.extLog,a.reporter.hookApiInvoke=Ye.extApiInvoke,a.parameters&&Object.keys(a.parameters).forEach(l=>{a.parameters[l]=W(l)})}),Ez("PLUGIN_INFO",r)},ChannelMediaRelayError:gm,ChannelMediaRelayEvent:fl,ChannelMediaRelayState:ls,RemoteStreamFallbackType:w0e,RemoteStreamType:E0e,ConnectionDisconnectedReason:Ut,AudienceLatencyLevelType:Jge,AREAS:Jt,preload:async function(t,r,i,a){return nI(t,r,i,a)},startLastmileProbeTest:async function(t,r,i,a){let l={state:"unavailable"};await nI(t,r,i,a);const u=await rI({appId:t,cname:r,token:i||t,uid:a,cloudProxyServer:"disabled"});if(!u)return l;await iI(u);let p,m=HW({mode:"rtc",codec:"vp8"});try{p=await m.join(t,r,i,a,{networkQualityProbe:!0})}catch{return l}const g=new Zve,y=g.createMuteAudioTrack();let x=await qB({mediaStreamTrack:y});await m.publish([x]);let[S,T,C]=await new je((te,se)=>{const oe=setTimeout(()=>{clearTimeout(oe),te([!0,null,"audio"])},5e3);m.on("user-published",async(ne,de)=>{ne.uid===p&&(clearTimeout(oe),te([!1,ne,de]))})});if(S||!T)return await m.unpublish([x]),await m.leave(),x.close(),g.close(),l;await m.subscribe(T,C),await new je((te,se)=>{const oe=setTimeout(()=>{clearTimeout(oe),te(null)},5e3)});let V=m.getRTCStats(),j=m.getLocalAudioStats();const L=V.RTT,H=j.sendJitterMs,Y=j.currentPacketLossRate;return l={state:"complete",rtt:L,packetLossRate:Y,jitter:H,networkQuality:((te,se,oe)=>{let ne=1;if(oe>0){let mt=Math.log(100*oe)/Math.log(2)+1;mt=Math.min(5,Math.max(0,mt)),ne=1-mt/5}let de=1;if(te>0){let mt=Math.log(te/40)/Math.log(2)+1;mt=Math.min(5,Math.max(0,mt)),de=1-mt/5}let be=1;if(se>0){let mt=Math.log(se/10)/Math.log(2.5)+1;mt=Math.min(5,Math.max(0,mt)),be=1-mt/5}const Se=.5*ne+.3*de+.2*be;let Be=0;return Be=Se>=.8?1:Se>=.6?2:Se>=.4?3:Se>=.2?4:5,Be})(L,H,Y)},await m.unsubscribe(T),await m.unpublish([x]),await m.leave(),x.close(),g.close(),await iI(u),l}});return Object.defineProperties(cr,{onAudioAutoplayFailed:{get:()=>Ki.onAudioAutoplayFailed,set:t=>{Ki.onAudioAutoplayFailed=t}},onAutoplayFailed:{get:()=>Ki.onAutoplayFailed,set:t=>{Ki.onAutoplayFailed=t}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>cr._onSecurityPolicyViolation,set(t){cr._onSecurityPolicyViolation=t,XW(t)}},__CLIENT_LIST__:{get:()=>W("SHOW_GLOBAL_CLIENT_LIST")?th:[]}}),qs.on(Ju.CAMERA_DEVICE_CHANGED,t=>{A.info("camera device changed",JSON.stringify(t)),cr.onCameraChanged&&cr.onCameraChanged(t),cr.safeEmit(Rc.CAMERA_CHANGED,t)}),qs.on(Ju.RECORDING_DEVICE_CHANGED,t=>{A.info("microphone device changed",JSON.stringify(t)),cr.onMicrophoneChanged&&cr.onMicrophoneChanged(t),cr.safeEmit(Rc.MICROPHONE_CHANGED,t)}),qs.on(Ju.PLAYOUT_DEVICE_CHANGED,t=>{A.debug("playout device changed",JSON.stringify(t)),cr.onPlaybackDeviceChanged&&cr.onPlaybackDeviceChanged(t),cr.safeEmit(Rc.PLAYBACK_DEVICE_CHANGED,t)}),yi.onAutoplayFailed=()=>{A.info("detect audio element autoplay failed"),Ki.onAudioAutoplayFailed&&Ki.onAudioAutoplayFailed()},ln.on("autoplay-failed",()=>{A.info("detect webaudio autoplay failed"),Ki.onAudioAutoplayFailed&&Ki.onAudioAutoplayFailed(),cr.safeEmit(Rc.AUTOPLAY_FAILED)}),ln.on($r.STATE_CHANGE,(t,r)=>{A.info("audio context state changed: ".concat(r," => ").concat(t)),cr.onAudioContextStateChanged&&cr.onAudioContextStateChanged(t,r),cr.safeEmit(Rc.AUDIO_CONTEXT_STATE_CHANGED,t,r)}),Un.on(Gu.NETWORK_STATE_CHANGE,(t,r)=>{A.info("[network-indicator] network state changed, ".concat(r," => ").concat(t))}),window&&(window.__ARTC__=cr),cr})})(Xne);var DYe=Xne.exports;const _f=ur(DYe);function LYe(){var Fe,ke,Ge,De,Pe,Ve,it,Mt,tt,ft,Rt;const{appointmentId:e}=rb(),n=Us(),[s,o]=z.useState(null),[d,h]=z.useState(!0),[f,v]=z.useState(!1),[b,_]=z.useState("video"),[w,E]=z.useState([]),[N,I]=z.useState(""),[R,O]=z.useState({video:!0,audio:!0,speaker:!0}),[P,M]=z.useState(null),[D,U]=z.useState(null),[B,G]=z.useState(null),[$,q]=z.useState([]),[X,ee]=z.useState(!1),ce=z.useRef(null),Q=z.useRef(null);z.useEffect(()=>(le(),ae(),()=>{ve()}),[e]);const ae=()=>{const Te=_f.createClient({mode:"rtc",codec:"vp8"});Te.on("user-published",async(st,ct)=>{await Te.subscribe(st,ct),ct==="video"&&(q(zt=>[...zt.filter(Ke=>Ke.uid!==st.uid),st]),Q.current&&st.videoTrack.play(Q.current)),ct==="audio"&&st.audioTrack.play()}),Te.on("user-unpublished",st=>{q(ct=>ct.filter(zt=>zt.uid!==st.uid))}),Te.on("user-left",st=>{q(ct=>ct.filter(zt=>zt.uid!==st.uid))}),M(Te)},ve=async()=>{D&&(D.stop(),D.close()),B&&(B.stop(),B.close()),P&&X&&await P.leave()},le=async()=>{try{const{data:Te}=await ra.getAppointmentDetails(e);o(Te)}catch{et.error("Failed to load appointment details"),n("/doctors")}finally{h(!1)}},fe=async()=>{if(!P||!(s!=null&&s.videoRoom)){et.error("Video call not available");return}try{const{config:Te}=s.videoRoom;if(Te.type==="agora"&&Te.appId&&Te.token){await P.join(Te.appId,Te.channelName,Te.token,Te.uid);const st=await _f.createCameraVideoTrack(),ct=await _f.createMicrophoneAudioTrack();U(st),G(ct),ce.current&&st.play(ce.current),await P.publish([st,ct]),ee(!0),et.success("Joined video call successfully")}else et.error("Video call configuration not available")}catch(Te){console.error("Error joining video call:",Te),et.error("Failed to join video call")}},re=async()=>{try{await ve(),ee(!1),q([]),et.success("Left video call")}catch(Te){console.error("Error leaving video call:",Te)}},he=async()=>{try{await ra.startConsultation(e),v(!0),(s==null?void 0:s.type)==="video"&&await fe(),et.success("Consultation started")}catch{et.error("Failed to start consultation")}},J=async()=>{try{X&&await re(),await ra.endConsultation(e),v(!1),et.success("Consultation ended"),n("/consultation-summary/"+e)}catch{et.error("Failed to end consultation")}},ue=()=>{if(!N.trim())return;const Te={id:Date.now(),text:N,sender:"patient",timestamp:new Date};E([...w,Te]),I("")},Ee=async Te=>{if(Te==="video"&&D){const st=!R.video;await D.setEnabled(st),O(ct=>({...ct,video:st}))}else if(Te==="audio"&&B){const st=!R.audio;await B.setEnabled(st),O(ct=>({...ct,audio:st}))}else Te==="speaker"&&O(st=>({...st,speaker:!st.speaker}))};return d?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500"})}):s?c.jsxs("div",{className:"min-h-screen bg-[#0a0f1a]",children:[c.jsx("div",{className:"bg-[#111827] border-b border-slate-700 px-4 py-4",children:c.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>n("/doctors"),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:c.jsx(Ci,{className:"w-5 h-5 text-slate-400"})}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center text-lg font-bold text-white",children:((Ge=(ke=(Fe=s.doctor)==null?void 0:Fe.name)==null?void 0:ke[0])==null?void 0:Ge.toUpperCase())||"D"}),c.jsxs("div",{children:[c.jsxs("h1",{className:"text-lg font-bold text-white",children:["Dr. ",(De=s.doctor)==null?void 0:De.name]}),c.jsx("p",{className:"text-sm text-slate-400",children:(Pe=s.doctor)==null?void 0:Pe.specialization})]})]})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.status==="confirmed"?"bg-green-500/20 text-green-400":s.status==="pending"?"bg-yellow-500/20 text-yellow-400":"bg-slate-500/20 text-slate-400"}`,children:s.status})})]})}),f?c.jsxs("div",{className:"h-[calc(100vh-80px)] flex",children:[c.jsxs("div",{className:"flex-1 bg-slate-900 relative",children:[b==="video"&&c.jsxs("div",{className:"h-full relative",children:[c.jsx("div",{className:"w-full h-full bg-slate-800 flex items-center justify-center",children:$.length>0?c.jsx("div",{ref:Q,className:"w-full h-full",style:{background:"#1e293b"}}):c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center text-4xl font-bold text-white mx-auto mb-4",children:((ft=(tt=(Mt=s.doctor)==null?void 0:Mt.name)==null?void 0:tt[0])==null?void 0:ft.toUpperCase())||"D"}),c.jsxs("p",{className:"text-white text-lg",children:["Dr. ",(Rt=s.doctor)==null?void 0:Rt.name]}),c.jsx("p",{className:"text-slate-400",children:X?"Waiting for doctor to join...":"Video consultation ready"})]})}),X&&c.jsxs("div",{className:"absolute top-4 right-4 w-48 h-36 bg-slate-800 rounded-lg overflow-hidden border-2 border-slate-600",children:[c.jsx("div",{ref:ce,className:"w-full h-full",style:{background:"#1e293b"}}),c.jsx("div",{className:"absolute bottom-2 left-2 text-white text-xs bg-black/50 px-2 py-1 rounded",children:"You"})]}),c.jsx("div",{className:"absolute top-4 left-4",children:c.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${X?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${X?"bg-green-400":"bg-yellow-400"} animate-pulse`}),X?"Connected":"Connecting..."]})}),X&&c.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2",children:c.jsxs("div",{className:"flex items-center gap-2 bg-slate-800/90 backdrop-blur-sm rounded-full px-3 py-1 text-white text-sm",children:[c.jsx(Pf,{className:"w-4 h-4"}),$.length+1," participants"]})})]}),c.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2",children:c.jsxs("div",{className:"flex items-center gap-4 bg-slate-800/90 backdrop-blur-sm rounded-full px-6 py-3",children:[c.jsx("button",{onClick:()=>Ee("audio"),className:`p-3 rounded-full transition-colors ${R.audio?"bg-slate-700 text-white hover:bg-slate-600":"bg-red-500 text-white hover:bg-red-600"}`,title:R.audio?"Mute microphone":"Unmute microphone",children:R.audio?c.jsx(MQ,{className:"w-5 h-5"}):c.jsx(LQ,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>Ee("video"),className:`p-3 rounded-full transition-colors ${R.video?"bg-slate-700 text-white hover:bg-slate-600":"bg-red-500 text-white hover:bg-red-600"}`,title:R.video?"Turn off camera":"Turn on camera",children:R.video?c.jsx(AQ,{className:"w-5 h-5"}):c.jsx(iP,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>Ee("speaker"),className:`p-3 rounded-full transition-colors ${R.speaker?"bg-slate-700 text-white hover:bg-slate-600":"bg-red-500 text-white hover:bg-red-600"}`,title:R.speaker?"Mute speaker":"Unmute speaker",children:R.speaker?c.jsx(FNe,{className:"w-5 h-5"}):c.jsx(VNe,{className:"w-5 h-5"})}),c.jsx("button",{className:"p-3 rounded-full bg-slate-700 text-white hover:bg-slate-600 transition-colors",title:"Share screen",children:c.jsx(INe,{className:"w-5 h-5"})}),c.jsx("button",{onClick:J,className:"p-3 rounded-full bg-red-500 hover:bg-red-600 text-white transition-colors",title:"End consultation",children:c.jsx(di,{className:"w-5 h-5"})})]})})]}),c.jsxs("div",{className:"w-80 bg-[#111827] border-l border-slate-700 flex flex-col",children:[c.jsx("div",{className:"p-4 border-b border-slate-700",children:c.jsx("h3",{className:"text-white font-medium",children:"Chat"})}),c.jsx("div",{className:"flex-1 p-4 overflow-y-auto space-y-3",children:w.map(Te=>c.jsx("div",{className:`flex ${Te.sender==="patient"?"justify-end":"justify-start"}`,children:c.jsx("div",{className:`max-w-xs px-3 py-2 rounded-lg text-sm ${Te.sender==="patient"?"bg-cyan-500 text-white":"bg-slate-700 text-white"}`,children:Te.text})},Te.id))}),c.jsx("div",{className:"p-4 border-t border-slate-700",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",value:N,onChange:Te=>I(Te.target.value),onKeyPress:Te=>Te.key==="Enter"&&ue(),placeholder:"Type a message...",className:"flex-1 bg-slate-800 border border-slate-600 rounded-lg px-3 py-2 text-white placeholder-slate-400 focus:outline-none focus:border-cyan-500"}),c.jsx("button",{onClick:ue,className:"bg-cyan-500 hover:bg-cyan-600 text-white p-2 rounded-lg transition-colors",children:c.jsx(db,{className:"w-4 h-4"})})]})})]})]}):c.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[c.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsx("h2",{className:"text-lg font-bold text-white mb-6",children:"Appointment Details"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(qr,{className:"w-5 h-5 text-cyan-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-medium",children:"Date & Time"}),c.jsxs("p",{className:"text-slate-400 text-sm",children:[new Date(s.date).toLocaleDateString()," at ",s.timeSlot]})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(du,{className:"w-5 h-5 text-cyan-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-medium",children:"Consultation Type"}),c.jsx("p",{className:"text-slate-400 text-sm capitalize",children:s.type})]})]}),s.symptoms&&c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(Vn,{className:"w-5 h-5 text-cyan-400 mt-0.5"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-medium",children:"Symptoms"}),c.jsx("p",{className:"text-slate-400 text-sm",children:s.symptoms})]})]})]})]}),c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsx("h2",{className:"text-lg font-bold text-white mb-6",children:"Doctor Information"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(If,{className:"w-5 h-5 text-cyan-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-medium",children:"Experience"}),c.jsxs("p",{className:"text-slate-400 text-sm",children:[((Ve=s.doctor)==null?void 0:Ve.experience)||"5+"," years"]})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(nP,{className:"w-5 h-5 text-cyan-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-medium",children:"Location"}),c.jsx("p",{className:"text-slate-400 text-sm",children:((it=s.doctor)==null?void 0:it.location)||"Online"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(ja,{className:"w-5 h-5 text-cyan-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-medium",children:"Rating"}),c.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(Te=>c.jsx(ja,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},Te)),c.jsx("span",{className:"text-slate-400 text-sm ml-1",children:"(4.8)"})]})]})]})]})]})]}),c.jsx("div",{className:"mt-8 text-center",children:c.jsxs("button",{onClick:he,className:"bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white px-8 py-4 rounded-xl font-medium transition-all inline-flex items-center gap-2",children:[c.jsx(du,{className:"w-5 h-5"}),"Start Consultation"]})})]})]}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Vr,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),c.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Appointment Not Found"}),c.jsx("p",{className:"text-slate-400",children:"The appointment you're looking for doesn't exist."})]})}function MYe(){const{appointmentId:e}=rb(),n=Us(),[s,o]=z.useState(null),[d,h]=z.useState(!0),[f,v]=z.useState(0),[b,_]=z.useState(""),[w,E]=z.useState(!1),[N,I]=z.useState("summary");z.useEffect(()=>{R()},[e]);const R=async()=>{try{const{data:U}=await ra.getConsultationSummary(e);o(U)}catch{et.error("Failed to load consultation summary"),n("/doctors")}finally{h(!1)}},O=async()=>{if(f===0){et.error("Please provide a rating");return}E(!0);try{await ra.submitReview(e,{rating:f,review:b}),et.success("Review submitted successfully"),o(U=>({...U,reviewSubmitted:!0}))}catch{et.error("Failed to submit review")}finally{E(!1)}},P=async()=>{try{const U=await ra.downloadPrescription(e),B=new Blob([U.data],{type:"application/pdf"}),G=window.URL.createObjectURL(B),$=document.createElement("a");$.href=G,$.download=`prescription-${e}.pdf`,$.click(),window.URL.revokeObjectURL(G)}catch{et.error("Failed to download prescription")}};if(d)return c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500"})});const M={doctor:{name:"Dr. Sarah Johnson",specialization:"General Physician"},date:new Date().toISOString(),duration:"30 minutes",diagnosis:"Vitamin D deficiency with mild fatigue symptoms",prescription:[{medication:"Vitamin D3 Supplement",dosage:"1000 IU daily",duration:"3 months",instructions:"Take with food, preferably in the morning"},{medication:"Multivitamin",dosage:"1 tablet daily",duration:"1 month",instructions:"Take after breakfast"}],recommendations:["Get 15-20 minutes of sunlight exposure daily","Include vitamin D rich foods like fatty fish, eggs, and fortified milk","Regular exercise to improve energy levels","Follow-up blood test in 3 months"],followUp:{date:new Date(Date.now()+90*24*60*60*1e3).toISOString(),type:"Blood test review"},notes:"Patient reported fatigue and low energy levels. Blood work shows vitamin D deficiency at 18 ng/mL (normal: 30-100). Recommended supplementation and lifestyle changes.",reviewSubmitted:!1},D=s||M;return c.jsxs("div",{className:"min-h-screen bg-[#0a0f1a] pb-8",children:[c.jsx("div",{className:"bg-[#111827] border-b border-slate-700 px-4 py-4",children:c.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>n("/doctors"),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:c.jsx(Ci,{className:"w-5 h-5 text-slate-400"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-lg font-bold text-white",children:"Consultation Summary"}),c.jsxs("p",{className:"text-sm text-slate-400",children:[new Date(D.date).toLocaleDateString(),"  ",D.duration]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:P,className:"flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:[c.jsx(PQ,{className:"w-4 h-4"}),"Download"]}),c.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-cyan-500 hover:bg-cyan-600 text-white rounded-lg transition-colors",children:[c.jsx(MNe,{className:"w-4 h-4"}),"Share"]})]})]})}),c.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[c.jsx("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6 mb-6",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center text-xl font-bold text-white",children:D.doctor.name[0]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:D.doctor.name}),c.jsx("p",{className:"text-slate-400",children:D.doctor.specialization})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"flex items-center gap-1 mb-1",children:[1,2,3,4,5].map(U=>c.jsx(ja,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},U))}),c.jsx("p",{className:"text-sm text-slate-400",children:"4.8 rating"})]})]})}),c.jsxs("div",{className:"flex gap-2 p-1 bg-slate-800 rounded-xl w-fit mb-6",children:[c.jsx("button",{onClick:()=>I("summary"),className:`px-4 py-2 rounded-lg font-medium transition-all ${N==="summary"?"bg-slate-700 text-white":"text-slate-400 hover:text-white"}`,children:"Summary"}),c.jsx("button",{onClick:()=>I("prescription"),className:`px-4 py-2 rounded-lg font-medium transition-all ${N==="prescription"?"bg-slate-700 text-white":"text-slate-400 hover:text-white"}`,children:"Prescription"}),c.jsx("button",{onClick:()=>I("followup"),className:`px-4 py-2 rounded-lg font-medium transition-all ${N==="followup"?"bg-slate-700 text-white":"text-slate-400 hover:text-white"}`,children:"Follow-up"})]}),c.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[N==="summary"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/20 flex items-center justify-center",children:c.jsx(jn,{className:"w-5 h-5 text-blue-400"})}),c.jsx("h3",{className:"text-lg font-bold text-white",children:"Diagnosis"})]}),c.jsx("p",{className:"text-slate-300 leading-relaxed",children:D.diagnosis})]}),c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-500/20 flex items-center justify-center",children:c.jsx(Vn,{className:"w-5 h-5 text-green-400"})}),c.jsx("h3",{className:"text-lg font-bold text-white",children:"Doctor's Notes"})]}),c.jsx("p",{className:"text-slate-300 leading-relaxed",children:D.notes})]}),c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-cyan-500/20 flex items-center justify-center",children:c.jsx(rr,{className:"w-5 h-5 text-cyan-400"})}),c.jsx("h3",{className:"text-lg font-bold text-white",children:"Recommendations"})]}),c.jsx("ul",{className:"space-y-3",children:D.recommendations.map((U,B)=>c.jsxs("li",{className:"flex items-start gap-3",children:[c.jsx(rr,{className:"w-5 h-5 text-green-400 mt-0.5 shrink-0"}),c.jsx("span",{className:"text-slate-300",children:U})]},B))})]})]}),N==="prescription"&&c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-purple-500/20 flex items-center justify-center",children:c.jsx(ka,{className:"w-5 h-5 text-purple-400"})}),c.jsx("h3",{className:"text-lg font-bold text-white",children:"Prescription"})]}),c.jsx("div",{className:"space-y-4",children:D.prescription.map((U,B)=>c.jsxs("div",{className:"p-4 bg-slate-800 rounded-xl",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("h4",{className:"font-bold text-white",children:U.medication}),c.jsx("span",{className:"text-sm text-slate-400",children:U.duration})]}),c.jsx("p",{className:"text-cyan-400 font-medium mb-2",children:U.dosage}),c.jsx("p",{className:"text-slate-300 text-sm",children:U.instructions})]},B))}),c.jsx("div",{className:"mt-6 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-xl",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx($d,{className:"w-5 h-5 text-yellow-400 mt-0.5"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-yellow-400 font-medium mb-1",children:"Important"}),c.jsx("p",{className:"text-slate-300 text-sm",children:"Take medications as prescribed. Do not stop or change dosage without consulting your doctor."})]})]})})]}),N==="followup"&&c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-orange-500/20 flex items-center justify-center",children:c.jsx(qr,{className:"w-5 h-5 text-orange-400"})}),c.jsx("h3",{className:"text-lg font-bold text-white",children:"Follow-up Care"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"p-4 bg-slate-800 rounded-xl",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx(To,{className:"w-5 h-5 text-cyan-400"}),c.jsx("h4",{className:"font-bold text-white",children:"Next Appointment"})]}),c.jsxs("p",{className:"text-slate-300",children:[new Date(D.followUp.date).toLocaleDateString()," - ",D.followUp.type]})]}),c.jsxs("div",{className:"p-4 bg-slate-800 rounded-xl",children:[c.jsx("h4",{className:"font-bold text-white mb-2",children:"Health Tracking"}),c.jsx("p",{className:"text-slate-300 text-sm mb-3",children:"Monitor your progress and upload follow-up reports to track improvements."}),c.jsx("button",{className:"bg-cyan-500 hover:bg-cyan-600 text-white px-4 py-2 rounded-lg text-sm transition-colors",children:"Upload Report"})]})]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Quick Actions"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("button",{className:"w-full flex items-center gap-3 p-3 bg-slate-800 hover:bg-slate-700 rounded-xl transition-colors",children:[c.jsx(qr,{className:"w-5 h-5 text-cyan-400"}),c.jsx("span",{className:"text-white",children:"Book Follow-up"})]}),c.jsxs("button",{className:"w-full flex items-center gap-3 p-3 bg-slate-800 hover:bg-slate-700 rounded-xl transition-colors",children:[c.jsx(cu,{className:"w-5 h-5 text-cyan-400"}),c.jsx("span",{className:"text-white",children:"Message Doctor"})]}),c.jsxs("button",{className:"w-full flex items-center gap-3 p-3 bg-slate-800 hover:bg-slate-700 rounded-xl transition-colors",children:[c.jsx(xNe,{className:"w-5 h-5 text-cyan-400"}),c.jsx("span",{className:"text-white",children:"Save to Health Records"})]})]})]}),!D.reviewSubmitted&&c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Rate this Consultation"}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-slate-400 text-sm mb-2",children:"How was your experience?"}),c.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(U=>c.jsx("button",{onClick:()=>v(U),className:`p-1 transition-colors ${U<=f?"text-yellow-400":"text-slate-600 hover:text-slate-400"}`,children:c.jsx(ja,{className:"w-6 h-6 fill-current"})},U))})]}),c.jsx("textarea",{value:b,onChange:U=>_(U.target.value),placeholder:"Share your feedback (optional)",className:"w-full bg-slate-800 border border-slate-600 rounded-lg p-3 text-white placeholder-slate-400 resize-none h-20 focus:outline-none focus:border-cyan-500"}),c.jsx("button",{onClick:O,disabled:w||f===0,className:"w-full mt-4 bg-cyan-500 hover:bg-cyan-600 disabled:bg-slate-600 text-white py-2 rounded-lg transition-colors flex items-center justify-center gap-2",children:w?c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):c.jsxs(c.Fragment,{children:[c.jsx(db,{className:"w-4 h-4"}),"Submit Review"]})})]}),c.jsxs("div",{className:"bg-[#111827] rounded-2xl border border-slate-700 p-6",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Health Tracking"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Vitamin D Level"}),c.jsx("span",{className:"text-yellow-400",children:"Improving"})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Energy Level"}),c.jsx("span",{className:"text-green-400",children:"Stable"})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Sleep Quality"}),c.jsx("span",{className:"text-cyan-400",children:"Good"})]})]})]})]})]})]})]})}function UYe(){const[e,n]=z.useState(null),[s,o]=z.useState(null),[d,h]=z.useState(null),[f,v]=z.useState([]),[b,_]=z.useState(!1),[w,E]=z.useState(!0),[N,I]=z.useState(!0),R=z.useRef(null),O=z.useRef(null),P="e788e8f838484d4dafe4705d682df57c",M="healthai-test";z.useEffect(()=>(D(),()=>{G()}),[]);const D=()=>{const X=_f.createClient({mode:"rtc",codec:"vp8"});X.on("user-published",async(ee,ce)=>{await X.subscribe(ee,ce),ce==="video"&&(v(Q=>[...Q.filter(ae=>ae.uid!==ee.uid),ee]),O.current&&ee.videoTrack.play(O.current)),ce==="audio"&&ee.audioTrack.play()}),X.on("user-unpublished",ee=>{v(ce=>ce.filter(Q=>Q.uid!==ee.uid))}),X.on("user-left",ee=>{v(ce=>ce.filter(Q=>Q.uid!==ee.uid))}),n(X)},U=async()=>{if(e)try{const X=Math.floor(Math.random()*1e4);let ee=null;try{const ve=await(await fetch("/api/doctors/generate-video-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channelName:M,uid:X})})).json();ve.success&&(ee=ve.token,console.log("Generated token:",ee?"Token received":"No token (testing mode)"))}catch(ae){console.log("Failed to get token from server, using null token:",ae)}await e.join(P,M,ee,X);const ce=await _f.createCameraVideoTrack(),Q=await _f.createMicrophoneAudioTrack();o(ce),h(Q),R.current&&ce.play(R.current),await e.publish([ce,Q]),_(!0),et.success("Joined video call successfully!")}catch(X){console.error("Error joining channel:",X),et.error("Failed to join video call: "+X.message)}},B=async()=>{if(e)try{await G(),_(!1),v([]),et.success("Left video call")}catch(X){console.error("Error leaving channel:",X),et.error("Failed to leave video call")}},G=async()=>{s&&(s.stop(),s.close(),o(null)),d&&(d.stop(),d.close(),h(null)),e&&b&&await e.leave()},$=async()=>{if(s){const X=!w;await s.setEnabled(X),E(X)}},q=async()=>{if(d){const X=!N;await d.setEnabled(X),I(X)}};return c.jsx("div",{className:"min-h-screen bg-[#0a0f1a] p-6",children:c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Video Call Test"}),c.jsx("p",{className:"text-slate-400",children:"Test your Agora.io video calling setup"}),c.jsx("div",{className:"mt-4 p-4 bg-slate-800 rounded-lg",children:c.jsxs("p",{className:"text-sm text-slate-300",children:[c.jsx("strong",{children:"Channel:"})," ",M," | ",c.jsx("strong",{children:"App ID:"})," ",P.substring(0,8),"..."]})})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[c.jsxs("div",{className:"bg-slate-900 rounded-2xl overflow-hidden aspect-video relative",children:[c.jsx("div",{ref:R,className:"w-full h-full bg-slate-800"}),c.jsxs("div",{className:"absolute bottom-4 left-4 bg-black/50 text-white px-3 py-1 rounded-full text-sm",children:["You ",b?"(Live)":"(Preview)"]}),!w&&c.jsx("div",{className:"absolute inset-0 bg-slate-800 flex items-center justify-center",children:c.jsx(iP,{className:"w-16 h-16 text-slate-400"})})]}),c.jsxs("div",{className:"bg-slate-900 rounded-2xl overflow-hidden aspect-video relative",children:[f.length>0?c.jsx("div",{ref:O,className:"w-full h-full bg-slate-800"}):c.jsx("div",{className:"w-full h-full bg-slate-800 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(du,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),c.jsx("p",{className:"text-slate-400",children:b?"Waiting for others to join...":"Remote participant will appear here"})]})}),f.length>0&&c.jsx("div",{className:"absolute bottom-4 left-4 bg-black/50 text-white px-3 py-1 rounded-full text-sm",children:"Remote User"})]})]}),c.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[c.jsx("button",{onClick:q,className:`p-4 rounded-full transition-colors ${N?"bg-slate-700 text-white hover:bg-slate-600":"bg-red-500 text-white hover:bg-red-600"}`,disabled:!b,children:N?c.jsx(MQ,{className:"w-6 h-6"}):c.jsx(LQ,{className:"w-6 h-6"})}),c.jsx("button",{onClick:$,className:`p-4 rounded-full transition-colors ${w?"bg-slate-700 text-white hover:bg-slate-600":"bg-red-500 text-white hover:bg-red-600"}`,disabled:!b,children:w?c.jsx(du,{className:"w-6 h-6"}):c.jsx(iP,{className:"w-6 h-6"})}),b?c.jsxs("button",{onClick:B,className:"bg-red-500 hover:bg-red-600 text-white px-8 py-4 rounded-full font-medium transition-colors flex items-center gap-2",children:[c.jsx(kNe,{className:"w-5 h-5"}),"Leave Call"]}):c.jsxs("button",{onClick:U,className:"bg-green-500 hover:bg-green-600 text-white px-8 py-4 rounded-full font-medium transition-colors flex items-center gap-2",children:[c.jsx(Kj,{className:"w-5 h-5"}),"Join Call"]})]}),c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium ${b?"bg-green-500/20 text-green-400":"bg-slate-500/20 text-slate-400"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${b?"bg-green-400 animate-pulse":"bg-slate-400"}`}),b?`Connected (${f.length+1} participants)`:"Not connected"]})}),c.jsxs("div",{className:"mt-8 bg-slate-800 rounded-2xl p-6",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Testing Instructions:"}),c.jsxs("ol",{className:"text-slate-300 space-y-2 list-decimal list-inside",children:[c.jsx("li",{children:'Click "Join Call" to start the video call'}),c.jsx("li",{children:"Allow camera and microphone permissions when prompted"}),c.jsx("li",{children:"Open this page in another browser tab/window to test with multiple participants"}),c.jsx("li",{children:"Test the mute/unmute and video on/off controls"}),c.jsx("li",{children:"Check that you can see and hear other participants"})]}),c.jsx("div",{className:"mt-4 p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:c.jsxs("p",{className:"text-blue-400 text-sm",children:[c.jsx("strong",{children:"Note:"})," This is using your Agora.io free tier (10,000 minutes/month). Perfect for testing and development!"]})}),c.jsxs("div",{className:"mt-4 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:[c.jsx("h4",{className:"text-yellow-400 font-medium mb-2",children:" Troubleshooting"}),c.jsxs("div",{className:"text-yellow-300 text-sm space-y-1",children:[c.jsx("p",{children:c.jsx("strong",{children:"If video call fails:"})}),c.jsx("p",{children:" Check browser console for error messages"}),c.jsx("p",{children:" Ensure camera/microphone permissions are granted"}),c.jsx("p",{children:" Try disabling token authentication in Agora Console"}),c.jsx("p",{children:" Check server logs for token generation issues"})]})]}),c.jsxs("div",{className:"mt-4 p-4 bg-green-500/10 border border-green-500/20 rounded-lg",children:[c.jsx("h4",{className:"text-green-400 font-medium mb-2",children:" Quick Fix"}),c.jsx("div",{className:"text-green-300 text-sm",children:c.jsxs("p",{children:[c.jsx("strong",{children:"Easiest solution:"}),' Go to Agora Console  Project Settings  Change Authentication from "App ID + Token" to "App ID only"']})})]})]})]})})}function FYe(){const[e,n]=z.useState(""),[s,o]=z.useState(!1),[d,h]=z.useState(null),f=async v=>{if(v.preventDefault(),!e){et.error("Please enter an email address");return}o(!0),h(null);try{const _=await(await fetch("/api/doctors/test-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})})).json();_.success?(h({success:!0,message:_.message}),et.success("Test email sent successfully!")):(h({success:!1,message:_.message}),et.error("Failed to send email"))}catch(b){console.error("Email test error:",b),h({success:!1,message:b.message}),et.error("Failed to send email")}finally{o(!1)}};return c.jsx("div",{className:"min-h-screen bg-[#0a0f1a] p-6",children:c.jsxs("div",{className:"max-w-2xl mx-auto",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Email Test"}),c.jsx("p",{className:"text-slate-400",children:"Test your SMTP email configuration"})]}),c.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 mb-8",children:[c.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[c.jsx(lb,{className:"w-5 h-5 text-cyan-400"}),"Current SMTP Configuration"]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-slate-400",children:"Host:"}),c.jsx("span",{className:"text-white ml-2",children:"smtp.gmail.com"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-slate-400",children:"Port:"}),c.jsx("span",{className:"text-white ml-2",children:"587"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-slate-400",children:"User:"}),c.jsx("span",{className:"text-white ml-2",children:"tech@colabplatforms.com"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-slate-400",children:"From:"}),c.jsx("span",{className:"text-white ml-2",children:"HealthAI <tech@colabplatforms.com>"})]})]})]}),c.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 mb-8",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Send Test Email"}),c.jsxs("form",{onSubmit:f,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Test Email Address"}),c.jsx("input",{type:"email",value:e,onChange:v=>n(v.target.value),placeholder:"Enter email to receive test appointment confirmation",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:border-cyan-500",required:!0})]}),c.jsx("button",{type:"submit",disabled:s,className:"w-full bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 disabled:from-slate-600 disabled:to-slate-600 text-white py-3 rounded-xl font-medium transition-all flex items-center justify-center gap-2",children:s?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Sending..."]}):c.jsxs(c.Fragment,{children:[c.jsx(db,{className:"w-5 h-5"}),"Send Test Email"]})})]})]}),d&&c.jsxs("div",{className:`rounded-2xl p-6 ${d.success?"bg-green-500/10 border border-green-500/20":"bg-red-500/10 border border-red-500/20"}`,children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[d.success?c.jsx(rr,{className:"w-6 h-6 text-green-400"}):c.jsx(Vr,{className:"w-6 h-6 text-red-400"}),c.jsx("h3",{className:`text-lg font-bold ${d.success?"text-green-400":"text-red-400"}`,children:d.success?"Email Sent Successfully!":"Email Failed"})]}),c.jsx("p",{className:`${d.success?"text-green-300":"text-red-300"}`,children:d.message}),d.success&&c.jsxs("div",{className:"mt-4 p-4 bg-slate-800 rounded-lg",children:[c.jsx("h4",{className:"text-white font-medium mb-2",children:"What to expect:"}),c.jsxs("ul",{className:"text-slate-300 text-sm space-y-1",children:[c.jsx("li",{children:' Check your inbox for "Appointment Confirmation - HealthAI"'}),c.jsx("li",{children:" The email will contain appointment details and a join link"}),c.jsx("li",{children:" It may take a few minutes to arrive"}),c.jsx("li",{children:" Check spam folder if not received"})]})]})]}),c.jsxs("div",{className:"mt-8 bg-slate-800 rounded-2xl p-6",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Email Features"}),c.jsxs("div",{className:"space-y-4 text-slate-300",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-white font-medium mb-2",children:" Appointment Confirmation"}),c.jsx("p",{className:"text-sm",children:"Professional HTML email with appointment details, doctor info, and video call join link."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-white font-medium mb-2",children:" Automated Reminders"}),c.jsx("p",{className:"text-sm",children:"System sends reminders 24 hours before and 30 minutes before appointments."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-white font-medium mb-2",children:" Mobile Responsive"}),c.jsx("p",{className:"text-sm",children:"Emails look great on all devices with touch-friendly buttons and responsive design."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-white font-medium mb-2",children:" Professional Design"}),c.jsx("p",{className:"text-sm",children:"Branded emails with HealthAI colors, gradients, and professional layout."})]})]})]}),c.jsxs("div",{className:"mt-8 bg-yellow-500/10 border border-yellow-500/20 rounded-2xl p-6",children:[c.jsx("h3",{className:"text-lg font-bold text-yellow-400 mb-4",children:"Troubleshooting"}),c.jsxs("div",{className:"space-y-2 text-yellow-300 text-sm",children:[c.jsxs("p",{children:[" ",c.jsx("strong",{children:"Gmail App Password:"})," Make sure you're using an app password, not your regular Gmail password"]}),c.jsxs("p",{children:[" ",c.jsx("strong",{children:"2FA Required:"})," Gmail requires 2-factor authentication to generate app passwords"]}),c.jsxs("p",{children:[" ",c.jsx("strong",{children:"Less Secure Apps:"}),' App passwords bypass the need for "less secure apps" setting']}),c.jsxs("p",{children:[" ",c.jsx("strong",{children:"Rate Limits:"})," Gmail has sending limits (500 emails/day for free accounts)"]}),c.jsxs("p",{children:[" ",c.jsx("strong",{children:"Spam Filters:"})," Test emails might go to spam initially"]})]})]})]})})}const VYe=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Tl={startTime:"09:00",endTime:"18:00",slotDuration:30};function BYe(){const[e,n]=z.useState(Tl),[s,o]=z.useState({}),[d,h]=z.useState({}),[f,v]=z.useState(!1),[b,_]=z.useState(!0),w=()=>{const B=[],G=new Date;for(let $=0;$<7;$++){const q=new Date(G);q.setDate(G.getDate()+$),B.push({date:q.toISOString().split("T")[0],dayName:VYe[q.getDay()],displayDate:q.toLocaleDateString("en-US",{month:"short",day:"numeric"}),isToday:$===0})}return B},[E]=z.useState(w());z.useEffect(()=>{N()},[]);const N=async()=>{var B,G,$,q,X,ee,ce;try{const{data:Q}=await ra.getMyAvailability(),ae={startTime:((G=(B=Q.availability)==null?void 0:B.settings)==null?void 0:G.startTime)||Tl.startTime,endTime:((q=($=Q.availability)==null?void 0:$.settings)==null?void 0:q.endTime)||Tl.endTime,slotDuration:((ee=(X=Q.availability)==null?void 0:X.settings)==null?void 0:ee.slotDuration)||Tl.slotDuration};n(ae),(ce=Q.availability)!=null&&ce.blockedSlots&&h(Q.availability.blockedSlots),I(ae)}catch(Q){console.error("Failed to fetch availability:",Q),I(Tl)}finally{_(!1)}},I=B=>{B||(B=Tl);const G={},$=B.startTime||Tl.startTime,q=B.endTime||Tl.endTime,X=B.slotDuration||Tl.slotDuration,ee=$.split(":"),ce=q.split(":");if(ee.length<2||ce.length<2){console.error("Invalid time format");return}const Q=parseInt(ee[0],10),ae=parseInt(ee[1],10),ve=parseInt(ce[0],10),le=parseInt(ce[1],10);E.forEach(fe=>{G[fe.date]=[];let re=Q*60+ae;const he=ve*60+le;for(;re<he;){const J=Math.floor(re/60),ue=re%60,Ee=`${J.toString().padStart(2,"0")}:${ue.toString().padStart(2,"0")}`,Fe=new Date(`2000-01-01T${Ee}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});G[fe.date].push({time:Ee,display:Fe}),re+=X}}),o(G)},R=(B,G)=>{const $={...e,[B]:G};n($),I($)},O=(B,G)=>{h($=>{const q=$[B]||[];return q.includes(G)?{...$,[B]:q.filter(X=>X!==G)}:{...$,[B]:[...q,G]}})},P=B=>{const G=s[B]||[];(d[B]||[]).length===G.length?h(q=>({...q,[B]:[]})):h(q=>({...q,[B]:G.map(X=>X.time)}))},M=(B,G)=>(d[B]||[]).includes(G),D=B=>{const G=s[B]||[],$=d[B]||[];return G.length>0&&$.length===G.length},U=async()=>{var B,G;v(!0);try{const $=await ra.updateMyAvailability({settings:e,blockedSlots:d});console.log("Save response:",$.data),et.success("Availability saved successfully!")}catch($){console.error("Failed to save:",$),et.error(((G=(B=$.response)==null?void 0:B.data)==null?void 0:G.message)||"Failed to save availability")}finally{v(!1)}};return b?c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-12 h-12 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-slate-500",children:"Loading availability..."})]})}):c.jsxs("div",{className:"space-y-6 animate-fade-in",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Manage Your Slots"}),c.jsx("p",{className:"text-slate-500 mt-1",children:"Set your operating hours and block unavailable times"})]}),c.jsxs("button",{onClick:U,disabled:f,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-xl font-medium hover:shadow-lg transition-all disabled:opacity-50",children:[f?c.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):c.jsx(LNe,{className:"w-5 h-5"}),"Save Changes"]})]}),c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[c.jsxs("h2",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[c.jsx(To,{className:"w-5 h-5 text-cyan-500"}),"Operating Hours"]}),c.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Start Time"}),c.jsx("select",{value:e.startTime,onChange:B=>R("startTime",B.target.value),className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 focus:border-cyan-500 focus:outline-none",children:Array.from({length:24},(B,G)=>{const $=`${G.toString().padStart(2,"0")}:00`,q=new Date(`2000-01-01T${$}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return c.jsx("option",{value:$,children:q},$)})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"End Time"}),c.jsx("select",{value:e.endTime,onChange:B=>R("endTime",B.target.value),className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 focus:border-cyan-500 focus:outline-none",children:Array.from({length:24},(B,G)=>{const $=`${G.toString().padStart(2,"0")}:00`,q=new Date(`2000-01-01T${$}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return c.jsx("option",{value:$,children:q},$)})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Slot Duration"}),c.jsxs("select",{value:e.slotDuration,onChange:B=>R("slotDuration",parseInt(B.target.value)),className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 focus:border-cyan-500 focus:outline-none",children:[c.jsx("option",{value:15,children:"15 minutes"}),c.jsx("option",{value:30,children:"30 minutes"}),c.jsx("option",{value:45,children:"45 minutes"}),c.jsx("option",{value:60,children:"60 minutes"})]})]})]}),c.jsxs("p",{className:"text-sm text-slate-400 mt-3",children:["Current: ",e.startTime," to ",e.endTime,", ",e.slotDuration," min slots"]})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-4 h-4 rounded-full bg-emerald-100 border-2 border-emerald-300"}),c.jsx("span",{className:"text-slate-600",children:"Available"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-4 h-4 rounded-full bg-red-100 border-2 border-red-300"}),c.jsx("span",{className:"text-slate-600",children:"Blocked"})]}),c.jsx("p",{className:"text-slate-400 ml-auto",children:"Click on slots to block/unblock"})]}),c.jsx("div",{className:"space-y-4",children:E.map(B=>{const G=s[B.date]||[],$=D(B.date);return c.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(qr,{className:"w-5 h-5 text-cyan-500"}),c.jsxs("div",{children:[c.jsxs("h3",{className:"font-semibold text-slate-800",children:[B.dayName,B.isToday&&c.jsx("span",{className:"ml-2 text-xs bg-cyan-100 text-cyan-600 px-2 py-0.5 rounded-full",children:"Today"})]}),c.jsx("p",{className:"text-sm text-slate-500",children:B.displayDate})]})]}),c.jsx("button",{onClick:()=>P(B.date),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${$?"bg-emerald-100 text-emerald-600 hover:bg-emerald-200":"bg-red-100 text-red-600 hover:bg-red-200"}`,children:$?c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(Xd,{className:"w-4 h-4"})," Unblock All"]}):c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(di,{className:"w-4 h-4"})," Block Day"]})})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[G.map(q=>{const X=M(B.date,q.time);return c.jsx("button",{onClick:()=>O(B.date,q.time),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${X?"bg-red-100 text-red-600 border border-red-200 hover:bg-red-200":"bg-emerald-100 text-emerald-600 border border-emerald-200 hover:bg-emerald-200"}`,children:q.display},q.time)}),G.length===0&&c.jsx("p",{className:"text-slate-400 text-sm py-2",children:"No slots - check your operating hours"})]})]},B.date)})}),c.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded-xl p-4",children:[c.jsx("h3",{className:"font-medium text-cyan-800 mb-2",children:" Quick Tips"}),c.jsxs("ul",{className:"text-sm text-cyan-700 space-y-1",children:[c.jsx("li",{children:" Set your operating hours above to auto-generate time slots"}),c.jsx("li",{children:" Click individual slots to block specific times"}),c.jsx("li",{children:' Use "Block Day" to mark entire days as unavailable'}),c.jsx("li",{children:" Don't forget to save your changes!"})]})]})]})}function GYe(){var Q,ae,ve;const{user:e}=as(),[n,s]=z.useState(!0),[o,d]=z.useState(!1),[h,f]=z.useState(null),[v,b]=z.useState(null),[_,w]=z.useState(null),[E,N]=z.useState([]),[I,R]=z.useState(null),[O,P]=z.useState(!1),[M,D]=z.useState(null),[U,B]=z.useState(!1);z.useEffect(()=>{window.scrollTo(0,0),G(),$(),X(),ee()},[]),z.useEffect(()=>{if(M&&h&&h.generatedAt){const le=new Date(h.generatedAt),fe=new Date(M.updatedAt||M.createdAt);console.log(" Checking if plan is outdated..."),console.log(" Plan generated:",le),console.log(" Goal updated:",fe),fe>le?(B(!0),console.log(" Diet plan is OUTDATED - goals were updated after plan generation")):(B(!1),console.log(" Diet plan is up-to-date"))}},[M,h]),z.useEffect(()=>{I&&q(I)},[I]);const G=async()=>{var le;try{const fe=localStorage.getItem("token"),re=await fetch("/api/nutrition/goals",{headers:{Authorization:`Bearer ${fe}`}});if(console.log(" Nutrition goal response status:",re.status),re.status===404){P(!1),console.log(" No nutrition goal set (404)");return}if(re.ok){const he=await re.json();console.log(" Full response data:",JSON.stringify(he,null,2)),console.log(" data.success:",he.success),console.log(" data.healthGoal:",he.healthGoal),console.log(" data.healthGoal?.goalType:",(le=he.healthGoal)==null?void 0:le.goalType),he.success&&he.healthGoal&&he.healthGoal.goalType?(P(!0),D(he.healthGoal),console.log(" User has nutrition goal:",he.healthGoal.goalType)):(P(!1),console.log(" No nutrition goal in response"))}else P(!1),console.log(" Failed to fetch nutrition goal, status:",re.status)}catch(fe){console.error("Failed to check nutrition goal:",fe),P(!1)}},$=async()=>{try{const{data:le}=await da.getReports(),re=(Array.isArray(le)?le:le.reports||[]).filter(he=>{var J;return(J=he.aiAnalysis)==null?void 0:J.dietPlan});if(N(re),re.length>0&&!I){const he=re[0];R(he._id)}}catch(le){console.error("Failed to fetch reports:",le)}finally{s(!1)}},q=async le=>{var fe,re;try{s(!0);const{data:he}=await da.getReport(le),J=he.report;if(console.log(" Report Data:",J),console.log(" AI Analysis:",J.aiAnalysis),console.log(" Diet Plan:",(fe=J.aiAnalysis)==null?void 0:fe.dietPlan),(re=J.aiAnalysis)!=null&&re.dietPlan){const ue=J.aiAnalysis.dietPlan;console.log(" Breakfast:",ue.breakfast),console.log(" Lunch:",ue.lunch),console.log(" Dinner:",ue.dinner),console.log(" Snacks:",ue.snacks);let Ee={protein:150,carbs:250,fats:65},Fe=2e3,ke=!1;try{const De=localStorage.getItem("token"),Ve=await(await fetch("/api/nutrition/goals",{headers:{Authorization:`Bearer ${De}`}})).json();Ve.healthGoal&&(Fe=Ve.healthGoal.dailyCalorieTarget||2e3,Ee=Ve.healthGoal.macroTargets||Ee,ke=!0)}catch{console.log("Using default macro targets")}const Ge={mealPlan:{breakfast:Array.isArray(ue.breakfast)?ue.breakfast:[],lunch:Array.isArray(ue.lunch)?ue.lunch:[],dinner:Array.isArray(ue.dinner)?ue.dinner:[],snacks:Array.isArray(ue.snacks)?ue.snacks:[]},dailyCalorieTarget:Fe,macroTargets:Ee,hasGoals:ke,keyFoods:[],lifestyleRecommendations:Array.isArray(ue.tips)?ue.tips:[],createdAt:J.createdAt,source:"report",reportId:le};console.log(" Setting personalized plan:",Ge),console.log(" Meal counts:",{breakfast:Ge.mealPlan.breakfast.length,lunch:Ge.mealPlan.lunch.length,dinner:Ge.mealPlan.dinner.length,snacks:Ge.mealPlan.snacks.length}),f(Ge),Ge.mealPlan.breakfast.length===0&&Ge.mealPlan.lunch.length===0&&Ge.mealPlan.dinner.length===0&&Ge.mealPlan.snacks.length===0&&et.error("Diet plan is empty. The AI analysis may not have generated meal recommendations.")}else console.log(" No diet plan in AI analysis"),f(null),et.error("This report does not contain a diet plan")}catch(he){console.error(" Failed to fetch report diet plan:",he),et.error("Failed to load diet plan from report"),f(null)}finally{s(!1)}},X=async()=>{try{const le=localStorage.getItem("token"),fe=await fetch("/api/diet-recommendations/diet-plan/active",{headers:{Authorization:`Bearer ${le}`}});if(fe.status===404){console.log("Diet recommendation routes not available");return}const re=await fe.json();re.success&&re.dietPlan&&(f(re.dietPlan),console.log(" Fetched diet plan:",re.dietPlan.generatedAt))}catch(le){console.error("Failed to fetch personalized plan:",le)}},ee=async()=>{try{const le=localStorage.getItem("token"),fe=await fetch("/api/diet-recommendations/supplements/active",{headers:{Authorization:`Bearer ${le}`}});if(fe.status===404){console.log("Supplement recommendation routes not available");return}const re=await fe.json();re.success&&re.recommendations&&b(re.recommendations)}catch(le){console.error("Failed to fetch supplement recommendations:",le)}},ce=async()=>{d(!0);try{const le=localStorage.getItem("token"),fe=await fetch("/api/diet-recommendations/diet-plan/generate",{method:"POST",headers:{Authorization:`Bearer ${le}`,"Content-Type":"application/json"}});if(fe.status===404){et.error("Diet plan service is not available. Please restart the server.");return}const re=await fe.json();re.success?(f(re.dietPlan),B(!1),et.success("AI-powered diet plan generated!")):et.error(re.message||"Failed to generate plan")}catch(le){console.error("Failed to generate AI plan:",le),et.error("Failed to generate personalized plan. Please restart the server.")}finally{d(!1)}};return n?c.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-slate-600",children:"Loading your personalized plan..."})]})}):c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-cyan-50 via-blue-50 to-cyan-100 pb-20",children:c.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in p-4",children:[c.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-emerald-500 via-green-500 to-teal-500 rounded-3xl p-8 text-white shadow-2xl",children:[c.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -mr-32 -mt-32"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white/10 rounded-full -ml-24 -mb-24"}),c.jsxs("div",{className:"relative z-10",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"w-16 h-16 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center",children:c.jsx(Pa,{className:"w-8 h-8"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl sm:text-4xl font-bold",children:"Your Personalized Diet Plan"}),c.jsx("p",{className:"text-emerald-100 mt-1",children:"AI-powered nutrition guidance tailored for you"})]})]}),(e==null?void 0:e.profile)&&c.jsxs("div",{className:"flex flex-wrap gap-3 mt-6",children:[e.profile.age&&c.jsxs("div",{className:"px-4 py-2 bg-white/20 backdrop-blur-sm rounded-xl flex items-center gap-2",children:[c.jsx(qr,{className:"w-4 h-4"}),c.jsxs("span",{className:"text-sm font-medium",children:[e.profile.age," years"]})]}),e.profile.gender&&c.jsxs("div",{className:"px-4 py-2 bg-white/20 backdrop-blur-sm rounded-xl flex items-center gap-2",children:[c.jsx(ns,{className:"w-4 h-4"}),c.jsx("span",{className:"text-sm font-medium capitalize",children:e.profile.gender})]}),e.profile.dietaryPreference&&c.jsxs("div",{className:"px-4 py-2 bg-white/20 backdrop-blur-sm rounded-xl flex items-center gap-2",children:[c.jsx(hO,{className:"w-4 h-4"}),c.jsx("span",{className:"text-sm font-medium capitalize",children:e.profile.dietaryPreference})]})]})]})]}),E.length>0&&c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[c.jsx(Vn,{className:"w-6 h-6 text-cyan-500"}),"Select Report for Diet Plan"]}),c.jsxs(Ct,{to:"/upload",className:"px-3 py-1.5 bg-cyan-500 text-white rounded-lg text-sm font-medium hover:bg-cyan-600 transition-colors flex items-center gap-1",children:[c.jsx(Or,{className:"w-3 h-3"}),"Upload New"]})]}),c.jsx("select",{value:I||"",onChange:le=>R(le.target.value),className:"w-full px-4 py-3 bg-slate-50 border-2 border-slate-200 rounded-xl text-slate-800 font-medium focus:border-cyan-500 focus:outline-none cursor-pointer",children:E.map(le=>{var fe;return c.jsxs("option",{value:le._id,children:[le.reportType," - ",new Date(le.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})," ",(fe=le.aiAnalysis)!=null&&fe.healthScore?`(Score: ${le.aiAnalysis.healthScore})`:""]},le._id)})})]}),E.length===0&&c.jsx("div",{className:"text-center",children:c.jsxs(Ct,{to:"/upload",className:"inline-flex items-center gap-2 px-4 py-2 bg-cyan-500 text-white rounded-lg text-sm font-medium hover:bg-cyan-600 transition-colors",children:[c.jsx(Or,{className:"w-4 h-4"}),"Upload Report"]})}),h&&c.jsxs(c.Fragment,{children:[U&&c.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border-2 border-amber-300 rounded-2xl p-6 flex items-start gap-4 shadow-lg",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-amber-500 flex items-center justify-center shrink-0",children:c.jsx(Vr,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-bold text-amber-900 mb-2",children:"Your Goals Have Changed!"}),c.jsx("p",{className:"text-amber-800 mb-4",children:"You've updated your nutrition goals since this diet plan was created. Generate a new plan to match your current goals."}),c.jsx("button",{onClick:ce,disabled:o,className:"px-5 py-2.5 bg-gradient-to-r from-emerald-500 to-green-600 text-white font-semibold rounded-xl hover:shadow-lg transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Generating New Plan..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Wh,{className:"w-5 h-5"}),"Generate New Diet Plan"]})})]})]}),c.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-5 text-center hover:shadow-xl transition-shadow",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-red-400 to-pink-500 flex items-center justify-center mx-auto mb-3",children:c.jsx(xo,{className:"w-6 h-6 text-white"})}),c.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Daily Calories"}),c.jsx("p",{className:"text-2xl font-bold text-slate-800",children:h.dailyCalorieTarget}),h.source==="report"&&!h.hasGoals&&c.jsx(Ct,{to:"/profile?tab=goals",className:"text-xs text-cyan-600 hover:underline mt-1 block",children:"Set Goals"})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-5 text-center hover:shadow-xl transition-shadow",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-400 to-cyan-500 flex items-center justify-center mx-auto mb-3",children:c.jsx(ns,{className:"w-6 h-6 text-white"})}),c.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Protein"}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800",children:[(Q=h.macroTargets)==null?void 0:Q.protein,"g"]})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-5 text-center hover:shadow-xl transition-shadow",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-green-400 to-emerald-500 flex items-center justify-center mx-auto mb-3",children:c.jsx(hO,{className:"w-6 h-6 text-white"})}),c.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Carbs"}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800",children:[(ae=h.macroTargets)==null?void 0:ae.carbs,"g"]})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-5 text-center hover:shadow-xl transition-shadow",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center mx-auto mb-3",children:c.jsx(zn,{className:"w-6 h-6 text-white"})}),c.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Fats"}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800",children:[(ve=h.macroTargets)==null?void 0:ve.fats,"g"]})]})]}),h.source==="report"&&!h.hasGoals&&c.jsxs("div",{className:"bg-amber-50 border-2 border-amber-200 rounded-2xl p-4 flex items-start gap-3",children:[c.jsx(Vr,{className:"w-5 h-5 text-amber-600 shrink-0 mt-0.5"}),c.jsx("div",{className:"flex-1",children:c.jsxs("p",{className:"text-sm text-amber-900",children:[c.jsx("strong",{children:"Using default macro targets."})," For personalized calorie and macro goals based on your body metrics,",c.jsx(Ct,{to:"/profile?tab=goals",className:"text-amber-700 hover:underline font-semibold ml-1",children:"set your fitness goals "})]})})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[c.jsxs("h2",{className:"text-xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx(fu,{className:"w-6 h-6 text-emerald-500"}),"Your Daily Meal Plan"]}),c.jsx("div",{className:"space-y-4",children:Object.entries(h.mealPlan||{}).map(([le,fe])=>fe&&fe.length>0&&c.jsx(WYe,{mealType:le,meals:fe,expanded:_===le,onToggle:()=>w(_===le?null:le)},le))})]}),h.keyFoods&&h.keyFoods.length>0&&c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[c.jsxs("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center gap-2",children:[c.jsx(hO,{className:"w-6 h-6 text-green-500"}),"Key Foods to Include"]}),c.jsx("div",{className:"grid sm:grid-cols-2 gap-3",children:h.keyFoods.map((le,fe)=>c.jsxs("div",{className:"p-4 bg-green-50 rounded-xl border-2 border-green-200 hover:shadow-md transition-shadow",children:[c.jsx("p",{className:"font-bold text-green-900 mb-1",children:le.name}),c.jsx("p",{className:"text-sm text-green-700 mb-2",children:le.reason}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600",children:[c.jsx(To,{className:"w-3 h-3"}),c.jsx("span",{className:"font-medium",children:le.frequency})]})]},fe))})]}),h.lifestyleRecommendations&&h.lifestyleRecommendations.length>0&&c.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-2xl border-2 border-cyan-200 p-6",children:[c.jsxs("h2",{className:"text-xl font-bold text-cyan-900 mb-4 flex items-center gap-2",children:[c.jsx(xw,{className:"w-6 h-6 text-cyan-600"}),"Lifestyle Tips"]}),c.jsx("ul",{className:"space-y-3",children:h.lifestyleRecommendations.map((le,fe)=>c.jsxs("li",{className:"flex items-start gap-3 text-cyan-800",children:[c.jsx(rr,{className:"w-5 h-5 mt-0.5 text-cyan-500 shrink-0"}),c.jsx("span",{children:le})]},fe))})]}),(v==null?void 0:v.supplements)&&v.supplements.length>0&&c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[c.jsxs("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center gap-2",children:[c.jsx(Wh,{className:"w-6 h-6 text-purple-500"}),"Supplement Recommendations"]}),c.jsx("p",{className:"text-sm text-slate-600 mb-6",children:v.consultationNote||"Always consult a healthcare provider before starting supplements."}),c.jsx("div",{className:"space-y-4",children:v.supplements.map((le,fe)=>c.jsxs("div",{className:"p-5 bg-purple-50 border-2 border-purple-200 rounded-xl hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsx("h3",{className:"font-bold text-purple-900 text-lg",children:le.name}),le.priority&&c.jsx("span",{className:`text-xs px-3 py-1 rounded-full font-semibold ${le.priority==="high"?"bg-red-100 text-red-700":le.priority==="medium"?"bg-amber-100 text-amber-700":"bg-green-100 text-green-700"}`,children:le.priority.toUpperCase()})]}),c.jsx("p",{className:"text-sm text-purple-700 mb-3",children:le.reason}),c.jsxs("div",{className:"grid sm:grid-cols-2 gap-3 mb-3",children:[c.jsxs("div",{className:"p-3 bg-white rounded-lg",children:[c.jsx("p",{className:"text-xs text-purple-600 font-semibold mb-1",children:"Dosage"}),c.jsx("p",{className:"text-sm text-purple-900",children:le.dosage})]}),c.jsxs("div",{className:"p-3 bg-white rounded-lg",children:[c.jsx("p",{className:"text-xs text-purple-600 font-semibold mb-1",children:"Timing"}),c.jsx("p",{className:"text-sm text-purple-900",children:le.timing})]})]}),le.precautions&&c.jsx("div",{className:"p-3 bg-amber-50 rounded-lg border border-amber-200",children:c.jsxs("p",{className:"text-xs text-amber-700",children:[c.jsx("strong",{children:" Precautions:"})," ",le.precautions]})})]},fe))})]})]}),!h&&!n&&c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-12 text-center",children:[c.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-emerald-400 to-green-500 flex items-center justify-center mx-auto mb-6",children:c.jsx(Pa,{className:"w-10 h-10 text-white"})}),c.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-3",children:O?"Generate Your Diet Plan":"Set Your Goals First"}),c.jsx("p",{className:"text-slate-600 mb-6 max-w-md mx-auto",children:O?"Click the button below to generate a personalized AI-powered diet plan based on your nutrition goals.":"Set your nutrition goals in your profile to get a personalized diet plan. You can also upload health reports for more detailed recommendations."}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[O?c.jsx("button",{onClick:ce,disabled:o,className:"px-6 py-3 bg-gradient-to-r from-emerald-500 to-green-600 text-white font-semibold rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Generating..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Wh,{className:"w-5 h-5"}),"Generate AI Diet Plan"]})}):c.jsxs(Ct,{to:"/profile?tab=goals",className:"px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-semibold rounded-xl hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[c.jsx(ns,{className:"w-5 h-5"}),"Set Your Goals"]}),c.jsx(Ct,{to:"/upload",className:"px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-xl font-medium hover:shadow-lg transition-all",children:"Upload Report"})]})]}),c.jsxs("div",{className:"bg-slate-100 border-2 border-slate-200 rounded-xl p-4 text-sm text-slate-600",children:[c.jsx("strong",{className:"text-slate-800",children:"Disclaimer:"})," This diet plan is AI-generated for informational purposes only. It is not a substitute for professional medical advice. Please consult a healthcare provider or registered dietitian before making significant changes to your diet."]})]})})}function WYe({mealType:e,meals:n,expanded:s,onToggle:o}){const d={breakfast:{icon:TNe,color:"from-amber-400 to-orange-500",bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-700"},lunch:{icon:qj,color:"from-orange-400 to-red-500",bg:"bg-orange-50",border:"border-orange-200",text:"text-orange-700"},dinner:{icon:hg,color:"from-indigo-400 to-purple-500",bg:"bg-indigo-50",border:"border-indigo-200",text:"text-indigo-700"},snacks:{icon:Pa,color:"from-green-400 to-emerald-500",bg:"bg-green-50",border:"border-green-200",text:"text-green-700"}},h=d[e.toLowerCase()]||d.breakfast,f=h.icon,v=Array.isArray(n)?n:[];return c.jsxs("div",{className:`${h.bg} border-2 ${h.border} rounded-xl p-5 hover:shadow-md transition-all`,children:[c.jsxs("button",{onClick:o,className:"w-full flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${h.color} flex items-center justify-center`,children:c.jsx(f,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{className:"text-left",children:[c.jsx("h3",{className:"font-bold text-slate-800 text-lg capitalize",children:e.replace(/([A-Z])/g," $1").trim()}),c.jsxs("p",{className:"text-sm text-slate-600",children:[v.length," options"]})]})]}),s?c.jsx(ENe,{className:"w-6 h-6 text-slate-400"}):c.jsx(mu,{className:"w-6 h-6 text-slate-400"})]}),s&&v.length>0&&c.jsx("div",{className:"mt-4 space-y-3",children:v.map((b,_)=>{let w="Meal",E="",N="",I="",R="";try{typeof b=="string"?w=b:b&&typeof b=="object"&&(w=String(b.name||b.meal||"Meal"),E=String(b.description||b.tip||""),N=String(b.benefits||""),b.nutrients&&typeof b.nutrients=="object"?(I=String(b.nutrients.calories||b.nutrients.Calories||""),R=String(b.nutrients.protein||b.nutrients.Protein||"")):(I=String(b.calories||""),R=String(b.protein||"")))}catch(O){console.error("Error parsing meal item:",O,b),w="Meal"}return c.jsx("div",{className:"p-4 bg-white rounded-xl border border-slate-200",children:c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-bold text-slate-800",children:w}),E&&c.jsx("p",{className:"text-sm text-slate-600 mt-1",children:E}),N&&c.jsxs("p",{className:"text-xs text-green-600 mt-2 flex items-center gap-1",children:[c.jsx(rr,{className:"w-3 h-3"}),c.jsx("span",{children:N})]})]}),I&&c.jsxs("div",{className:"text-right ml-4",children:[c.jsx("p",{className:"text-lg font-bold text-slate-800",children:I}),c.jsx("p",{className:"text-xs text-slate-500",children:"calories"}),R&&c.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[R,"g protein"]})]})]})},_)})}),s&&v.length===0&&c.jsx("div",{className:"mt-4 p-4 bg-white rounded-xl border border-slate-200 text-center text-slate-500",children:"No meals available for this category"})]})}function $Ye(){const{user:e}=as(),n=mc(),[s,o]=z.useState([]),[d,h]=z.useState(""),[f,v]=z.useState(!1),[b,_]=z.useState(!1),[w,E]=z.useState(""),[N,I]=z.useState(null),[R,O]=z.useState([]),[P,M]=z.useState(!1),[D,U]=z.useState([]),[B,G]=z.useState(null),$=z.useRef(null),q=z.useRef(null);z.useEffect(()=>{(async()=>{try{const he=localStorage.getItem("token"),J=await fetch("/api/health/reports",{headers:{Authorization:`Bearer ${he}`}});if(J.ok){const ue=await J.json();O(ue.reports||[])}}catch(he){console.error("Failed to load reports:",he)}})()},[]),z.useEffect(()=>{e&&(()=>{try{const he=localStorage.getItem(`chat_sessions_${e==null?void 0:e.id}`);he&&U(JSON.parse(he))}catch(he){console.error("Failed to load chat sessions:",he)}})()},[e==null?void 0:e.id]),z.useEffect(()=>{var he;e&&(async()=>{try{const J=B||`session_${Date.now()}`;G(J);const ue=localStorage.getItem(`chat_history_${e==null?void 0:e.id}_${J}`);if(ue)o(JSON.parse(ue));else{const Ee=X();o([{role:"assistant",content:Ee,timestamp:new Date}])}}catch(J){console.error("Failed to load chat history:",J);const ue=X();o([{role:"assistant",content:ue,timestamp:new Date}])}})(),(he=n.state)!=null&&he.selectedText&&h(`Can you explain this: "${n.state.selectedText}"`)},[e==null?void 0:e.id,n.state,e==null?void 0:e.name,B]),z.useEffect(()=>{var re;(re=$.current)==null||re.scrollIntoView({behavior:"smooth"})},[s,w]);const X=()=>{let re=`Hello ${(e==null?void 0:e.name)||"there"}!  I'm your AI health assistant.

`;return R&&R.length>0?(re+=`I've reviewed your uploaded health reports:

`,R.slice(0,3).forEach(he=>{const J=new Date(he.uploadDate).toLocaleDateString();if(re+=` **${he.reportType}** (${J})
`,he.analysis&&(re+=`   ${he.analysis.substring(0,100)}...
`),he.metrics&&Object.keys(he.metrics).length>0){const ue=Object.keys(he.metrics).slice(0,2);re+=`   Key metrics: ${ue.join(", ")}
`}re+=`
`}),re+=`I have a complete understanding of your health profile. Feel free to ask me about your reports, health concerns, or get personalized recommendations!

What would you like to know?`):re+="I can help you understand your health reports, explain medical terms, provide diet guidance, and answer health-related questions. What would you like to know?",re},ee=(re,he)=>{_(!0),E("");let J=0;const ue=setInterval(()=>{J<=re.length?(E(re.substring(0,J)),J++):(clearInterval(ue),_(!1),he())},15);return()=>clearInterval(ue)},ce=async()=>{if(confirm("Are you sure you want to clear the chat history?"))try{localStorage.removeItem(`chat_history_${e==null?void 0:e.id}_${B}`);const re=X();o([{role:"assistant",content:re,timestamp:new Date}]),et.success("Chat cleared")}catch(re){console.error("Failed to clear chat:",re),et.error("Failed to clear chat")}},Q=()=>{const re=`session_${Date.now()}`;G(re);const he=X();o([{role:"assistant",content:he,timestamp:new Date}]),M(!1),et.success("New chat started")},ae=re=>{try{const he=localStorage.getItem(`chat_history_${e==null?void 0:e.id}_${re}`);he&&(o(JSON.parse(he)),G(re),M(!1))}catch(he){console.error("Failed to load session:",he),et.error("Failed to load chat session")}},ve=async re=>{if(re.preventDefault(),!d.trim()||f)return;const he={role:"user",content:d,timestamp:new Date};o(ue=>[...ue,he]);const J=d;h(""),v(!0);try{const ue=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:J,conversationHistory:s.slice(-10),userReports:R.map(Fe=>({type:Fe.reportType,date:Fe.uploadDate,analysis:Fe.analysis,metrics:Fe.metrics}))})});if(!ue.ok)throw new Error("Failed to get AI response");const Ee=await ue.json();Ee.success&&Ee.response&&ee(Ee.response,()=>{var it;const Fe={role:"assistant",content:Ee.response,timestamp:new Date},ke=[...s,he,Fe];o(ke),E(""),localStorage.setItem(`chat_history_${e==null?void 0:e.id}_${B}`,JSON.stringify(ke));const Ge=JSON.parse(localStorage.getItem(`chat_sessions_${e==null?void 0:e.id}`)||"[]"),De=Ge.findIndex(Mt=>Mt.id===B),Pe={id:B,title:s.length===1?J.substring(0,50):((it=Ge[De])==null?void 0:it.title)||J.substring(0,50),lastMessage:J.substring(0,100),timestamp:new Date().toISOString(),messageCount:ke.length};De>=0?Ge[De]=Pe:Ge.unshift(Pe);const Ve=Ge.slice(0,50);localStorage.setItem(`chat_sessions_${e==null?void 0:e.id}`,JSON.stringify(Ve)),U(Ve)})}catch(ue){console.error("AI Chat error:",ue),et.error("Failed to get response");const Ee=le(J);ee(Ee,()=>{const Fe={role:"assistant",content:Ee,timestamp:new Date},ke=[...s,he,Fe];o(ke),E(""),localStorage.setItem(`chat_history_${e==null?void 0:e.id}_${B}`,JSON.stringify(ke))})}finally{v(!1)}},le=re=>{const he=re.toLowerCase();return he.includes("vitamin d")?`Based on your query about Vitamin D:

**What is Vitamin D?**
Vitamin D is essential for bone health, immune function, and overall wellbeing.

**Normal Range:** 30-100 ng/mL

**If Low:**
 Get 15-20 minutes of morning sunlight daily
 Eat fish, eggs, fortified milk
 Consider supplements (consult your doctor)`:he.includes("iron")||he.includes("hemoglobin")?`Regarding Iron and Hemoglobin:

**Importance:**
Iron is crucial for producing hemoglobin, which carries oxygen in your blood.

**Normal Hemoglobin:** 12-17 g/dL
**Normal Iron:** 60-170 mcg/dL

**To Increase Iron:**
 Red meat, spinach, dal
 Eat with Vitamin C foods
 Avoid tea/coffee with meals`:"Thank you for your question. I'm here to help with understanding your health reports, explaining medical terms, providing diet guidance, and answering health-related questions."},fe=(re,he)=>{navigator.clipboard.writeText(re),I(he),setTimeout(()=>I(null),2e3),et.success("Copied to clipboard")};return c.jsxs("div",{className:"w-full h-full bg-white flex flex-col md:flex-row",children:[P&&c.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 md:hidden",onClick:()=>M(!1)}),c.jsxs("div",{className:`fixed md:static left-0 top-0 h-full w-64 bg-white border-r border-gray-200 flex flex-col transition-transform duration-300 z-50 md:z-auto ${P?"translate-x-0":"-translate-x-full md:translate-x-0"} md:translate-x-0 shrink-0`,children:[c.jsxs("div",{className:"p-3 border-b border-gray-200 flex items-center justify-between shrink-0",children:[c.jsx("h2",{className:"font-bold text-gray-900 text-xs",children:"Chat History"}),c.jsx("button",{onClick:()=>M(!1),className:"p-1 hover:bg-gray-100 rounded md:hidden",children:c.jsx(di,{className:"w-4 h-4"})})]}),c.jsx("button",{onClick:Q,className:"m-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2 font-medium text-xs shrink-0",children:"+ New Chat"}),c.jsx("div",{className:"flex-1 overflow-y-auto px-2 space-y-1",children:D.length>0?D.map(re=>c.jsxs("button",{onClick:()=>ae(re.id),className:`w-full text-left p-2 rounded-lg transition text-xs ${B===re.id?"bg-blue-100 border-l-4 border-blue-600":"hover:bg-gray-100"}`,children:[c.jsx("p",{className:"font-medium text-gray-900 truncate text-xs",children:re.title}),c.jsx("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:re.preview})]},re.id)):c.jsx("p",{className:"text-xs text-gray-500 text-center py-6",children:"No chat history yet"})}),c.jsx("div",{className:"p-2 border-t border-gray-200 space-y-1 shrink-0",children:c.jsxs("button",{onClick:ce,className:"w-full px-2 py-1.5 text-xs text-red-600 hover:bg-red-50 rounded-lg transition flex items-center justify-center gap-2",children:[c.jsx(lu,{className:"w-3 h-3"}),"Clear Chat"]})})]}),c.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[c.jsx("div",{className:"flex items-center px-3 py-2 border-b border-gray-200 bg-white shrink-0",children:c.jsx("button",{onClick:()=>M(!P),className:"p-1.5 hover:bg-gray-100 rounded-lg transition md:hidden",title:"Toggle chat history",children:c.jsx(DQ,{className:"w-5 h-5 text-gray-700"})})}),c.jsxs("div",{ref:q,className:"flex-1 overflow-y-auto px-3 py-4 space-y-3 pb-24 md:pb-4",style:{userSelect:"text"},children:[s.map((re,he)=>c.jsxs("div",{className:`flex gap-2 ${re.role==="user"?"justify-end":"justify-start"}`,children:[re.role==="assistant"&&c.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center shrink-0 bg-blue-600",children:c.jsx(uO,{className:"w-4 h-4 text-white"})}),c.jsxs("div",{className:`max-w-xs md:max-w-md rounded-2xl px-3 py-2 ${re.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:[c.jsx("div",{className:"whitespace-pre-wrap break-words text-sm leading-relaxed",children:re.content}),c.jsxs("div",{className:"flex items-center justify-between mt-1 gap-2",children:[c.jsx("span",{className:`text-xs ${re.role==="user"?"text-blue-100":"text-gray-500"}`,children:re.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),re.role==="assistant"&&c.jsx("button",{onClick:()=>fe(re.content,he),className:"transition-colors p-0.5 rounded hover:bg-gray-200",title:"Copy response",children:N===he?c.jsx(Xd,{className:"w-3 h-3 text-green-500"}):c.jsx(NNe,{className:"w-3 h-3 text-gray-500"})})]})]}),re.role==="user"&&c.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center shrink-0 bg-gray-300",children:c.jsx(tl,{className:"w-4 h-4 text-gray-700"})})]},he)),b&&w&&c.jsxs("div",{className:"flex gap-2 justify-start",children:[c.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center shrink-0 bg-blue-600",children:c.jsx(uO,{className:"w-4 h-4 text-white"})}),c.jsx("div",{className:"max-w-xs md:max-w-md bg-gray-100 rounded-2xl px-3 py-2",children:c.jsxs("div",{className:"whitespace-pre-wrap break-words text-sm leading-relaxed text-gray-900",children:[w,c.jsx("span",{className:"inline-block w-1 h-3 ml-1 animate-pulse bg-blue-600"})]})})]}),f&&!b&&c.jsxs("div",{className:"flex gap-2 justify-start",children:[c.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center shrink-0 bg-blue-600",children:c.jsx(uO,{className:"w-4 h-4 text-white"})}),c.jsx("div",{className:"bg-gray-100 rounded-2xl px-3 py-2",children:c.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[c.jsx(Zh,{className:"w-3 h-3 animate-spin text-blue-600"}),c.jsx("span",{className:"text-xs",children:"Analyzing..."})]})})]}),c.jsx("div",{ref:$})]}),c.jsx("div",{className:"fixed md:relative bottom-0 left-0 right-0 md:bottom-auto border-t border-gray-200 bg-white p-3 shrink-0 md:w-auto",children:c.jsxs("form",{onSubmit:ve,className:"flex gap-2 items-end",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx("input",{type:"text",value:d,onChange:re=>h(re.target.value),placeholder:"Ask...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-2xl focus:outline-none transition-all text-sm border border-gray-200 focus:border-blue-500 focus:bg-white",disabled:f||b}),d&&c.jsx("button",{type:"button",onClick:()=>h(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-lg hover:opacity-70 transition-opacity text-gray-500",children:""})]}),c.jsx("button",{type:"submit",disabled:!d.trim()||f||b,className:"px-3 py-2.5 text-white rounded-2xl font-medium hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1 flex-shrink-0 bg-blue-600 hover:bg-blue-700",title:d.trim()?"Send message":"Type a message first",children:f||b?c.jsx(Zh,{className:"w-4 h-4 animate-spin"}):c.jsx(db,{className:"w-4 h-4"})})]})})]})]})}function zYe(){var fe,re,he,J,ue,Ee,Fe,ke,Ge,De;const[e,n]=z.useState(""),[s,o]=z.useState(null),[d,h]=z.useState(null),[f,v]=z.useState(!1),[b,_]=z.useState(null),[w,E]=z.useState(!1),[N,I]=z.useState(""),[R,O]=z.useState(!1),[P,M]=z.useState(null),[D,U]=z.useState([]),[B,G]=z.useState(!1),[$,q]=z.useState(!1);z.useEffect(()=>{X()},[]);const X=async()=>{var Pe;try{const Ve=localStorage.getItem("token"),it=new Date().toISOString().split("T")[0],Mt=await Ln.get(`/api/nutrition/quick-checks/history/date?date=${it}`,{headers:{Authorization:`Bearer ${Ve}`}});U(((Pe=Mt.data.stats)==null?void 0:Pe.checks)||[])}catch(Ve){console.error("Failed to fetch history:",Ve)}},ee=Pe=>{const Ve=Pe.toLowerCase();return/\d+/.test(Ve)||["bowl","plate","cup","glass","slice","piece","gram","kg","ml","litre"].some(Te=>Ve.includes(Te))?{show:!1,text:""}:["juice","milk","water","tea","coffee","smoothie","shake","lassi","soup","dal","curry"].some(Te=>Ve.includes(Te))?{show:!0,text:" Add quantity: e.g., 250ml, 1 glass, 2 cups"}:["pizza","bread","toast","cake","sandwich","paratha","naan"].some(Te=>Ve.includes(Te))?{show:!0,text:" Add quantity: e.g., 2 slices, 1 piece"}:["rice","roti","chicken","fish","meat","paneer","vegetables","pasta","biryani"].some(Te=>Ve.includes(Te))?{show:!0,text:" Add quantity: e.g., 100g, 1 bowl, 1 plate"}:["egg","banana","apple","samosa","pakora","biscuit","idli","dosa"].some(Te=>Ve.includes(Te))?{show:!0,text:" Add quantity: e.g., 2 pieces, 1 banana"}:{show:!0,text:" Add quantity for accurate results: e.g., 100g, 1 bowl, 2 pieces, 250ml"}},ce=Pe=>{const Ve=Pe.toLowerCase();return["grilled","fried","baked","boiled","steamed","roasted","raw","cooked","homemade","restaurant","packaged","frozen"].some(tt=>Ve.includes(tt))?{show:!1}:["chicken","fish","meat","egg","potato","vegetables","rice","noodles","samosa","pakora","fries","chips"].some(tt=>Ve.includes(tt))?{show:!0}:{show:!1}},Q=Pe=>{const Ve=Pe.target.value;if(n(Ve),Ve.length>=3){const it=ee(Ve);E(it.show),I(it.text);const Mt=ce(Ve);O(Mt.show)}else E(!1),O(!1)},ae=async()=>{var Pe,Ve;if(!e.trim()&&!s){et.error("Please enter a food item or upload an image");return}v(!0);try{const it=localStorage.getItem("token");let Mt=null;if(s){const ft=new FileReader;Mt=await new Promise((Rt,Te)=>{ft.onloadend=()=>{Rt(ft.result.split(",")[1])},ft.onerror=Te,ft.readAsDataURL(s)})}const tt=await Ln.post("/api/nutrition/quick-check",{foodDescription:e||void 0,imageBase64:Mt,additionalContext:e||void 0},{headers:{Authorization:`Bearer ${it}`}});_(tt.data.data),n(""),o(null),h(null),E(!1),et.success("Food analyzed and saved!"),X()}catch(it){console.error("Quick check error:",it),et.error(((Ve=(Pe=it.response)==null?void 0:Pe.data)==null?void 0:Ve.message)||"Failed to analyze food")}finally{v(!1)}},ve=Pe=>{_({foodItem:{name:Pe.foodName,quantity:Pe.quantity||"",nutrition:{calories:Pe.calories||0,protein:Pe.protein||0,carbs:Pe.carbs||0,fats:Pe.fats||0}},isHealthy:Pe.isHealthy,healthScore:Pe.healthScore,analysis:Pe.analysis||"Previously analyzed food item",warnings:Pe.warnings||[],alternatives:Pe.alternatives||[]}),G(!1)},le=async Pe=>{if(confirm("Delete this food check?"))try{const Ve=localStorage.getItem("token");await Ln.delete(`/api/nutrition/quick-checks/${Pe}`,{headers:{Authorization:`Bearer ${Ve}`}}),et.success("Deleted"),X()}catch{et.error("Failed to delete")}};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-3xl p-6 shadow-lg border border-blue-100",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl flex items-center justify-center",children:c.jsx(xw,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Quick Check"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Analyze any food instantly"})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",value:e,onChange:Q,placeholder:"What did you eat? e.g., Pizza, Chicken...",className:"w-full px-5 py-4 pr-14 bg-white border-2 border-blue-200 rounded-2xl focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 text-gray-900 placeholder-gray-500 font-medium transition-all"}),c.jsxs("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 flex items-center gap-2",children:[c.jsxs("div",{className:"relative group",children:[c.jsx("div",{className:"p-2 text-gray-300 cursor-not-allowed opacity-50",children:c.jsx(AQ,{className:"w-5 h-5"})}),c.jsx("div",{className:"absolute bottom-full right-0 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:"Coming soon"})]}),e&&c.jsx("button",{onClick:()=>{n(""),E(!1),O(!1)},className:"p-2 hover:bg-gray-100 rounded-lg transition",children:c.jsx(di,{className:"w-5 h-5 text-gray-400"})})]})]}),w&&c.jsxs("div",{className:"bg-white border-2 border-amber-200 rounded-2xl p-4 flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[c.jsx(xo,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-amber-900 mb-1",children:"Add Quantity"}),c.jsx("p",{className:"text-sm text-amber-700",children:N})]})]}),R&&c.jsxs("div",{className:"bg-white border-2 border-purple-200 rounded-2xl p-4 animate-in fade-in slide-in-from-top-2",children:[c.jsxs("p",{className:"text-sm font-semibold text-purple-900 mb-3 flex items-center gap-2",children:[c.jsx(_Ne,{className:"w-4 h-4"}),"How was it prepared?"]}),c.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{label:"Homemade",icon:""},{label:"Restaurant",icon:""},{label:"Packaged",icon:""},{label:"Grilled",icon:""},{label:"Fried",icon:""},{label:"Baked",icon:""}].map(Pe=>c.jsxs("button",{onClick:()=>{M(Pe.label),O(!1)},className:`px-3 py-2 rounded-xl text-sm font-medium transition-all ${P===Pe.label?"bg-purple-500 text-white":"bg-purple-50 text-purple-700 hover:bg-purple-100"}`,children:[Pe.icon," ",Pe.label]},Pe.label))})]}),c.jsx("div",{className:"grid grid-cols-1 gap-3",children:c.jsx("button",{onClick:ae,disabled:f||!e.trim()&&!s,className:"px-4 py-4 bg-gradient-to-r from-cyan-500 via-blue-500 to-blue-600 text-white rounded-2xl font-bold hover:shadow-xl hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 transition-all flex items-center justify-center gap-2 shadow-lg",children:f?c.jsxs(c.Fragment,{children:[c.jsx(Zh,{className:"w-5 h-5 animate-spin"}),c.jsx("span",{className:"hidden sm:inline",children:"Analyzing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(xo,{className:"w-5 h-5"}),c.jsx("span",{className:"hidden sm:inline",children:"Analyze Food"}),c.jsx("span",{className:"sm:hidden",children:"Check"})]})})})]})]}),b&&c.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-4",children:[c.jsxs("div",{className:`rounded-3xl p-6 shadow-lg border-2 ${b.isHealthy?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200":"bg-gradient-to-br from-red-50 to-orange-50 border-red-200"}`,children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:(fe=b.foodItem)==null?void 0:fe.name}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(re=b.foodItem)==null?void 0:re.quantity}),P&&c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[" ",P]})]}),c.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center font-bold text-xl ${b.isHealthy?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:b.healthScore})]}),c.jsx("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full font-semibold text-sm ${b.isHealthy?"bg-green-200 text-green-800":"bg-red-200 text-red-800"}`,children:b.isHealthy?c.jsxs(c.Fragment,{children:[c.jsx(rr,{className:"w-4 h-4"}),"Healthy Choice"]}):c.jsxs(c.Fragment,{children:[c.jsx(Vr,{className:"w-4 h-4"}),"Not Ideal"]})})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[c.jsxs("div",{className:"bg-white rounded-2xl p-4 border-2 border-orange-100 text-center",children:[c.jsx(Ml,{className:"w-6 h-6 text-orange-500 mx-auto mb-2"}),c.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Calories"}),c.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:((J=(he=b.foodItem)==null?void 0:he.nutrition)==null?void 0:J.calories)||0})]}),c.jsxs("div",{className:"bg-white rounded-2xl p-4 border-2 border-red-100 text-center",children:[c.jsx(zn,{className:"w-6 h-6 text-red-500 mx-auto mb-2"}),c.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Protein"}),c.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:[((Ee=(ue=b.foodItem)==null?void 0:ue.nutrition)==null?void 0:Ee.protein)||0,"g"]})]}),c.jsxs("div",{className:"bg-white rounded-2xl p-4 border-2 border-yellow-100 text-center",children:[c.jsx(xo,{className:"w-6 h-6 text-yellow-500 mx-auto mb-2"}),c.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Carbs"}),c.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:[((ke=(Fe=b.foodItem)==null?void 0:Fe.nutrition)==null?void 0:ke.carbs)||0,"g"]})]}),c.jsxs("div",{className:"bg-white rounded-2xl p-4 border-2 border-blue-100 text-center",children:[c.jsx(xw,{className:"w-6 h-6 text-blue-500 mx-auto mb-2"}),c.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Fats"}),c.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:[((De=(Ge=b.foodItem)==null?void 0:Ge.nutrition)==null?void 0:De.fats)||0,"g"]})]})]}),c.jsx("div",{className:"bg-white rounded-2xl p-5 border-2 border-gray-200",children:c.jsx("p",{className:"text-gray-700 leading-relaxed",children:b.analysis})}),b.warnings&&b.warnings.length>0&&c.jsx("div",{className:"bg-red-50 rounded-2xl p-5 border-2 border-red-200",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(Vr,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-bold text-red-900 mb-2",children:" Watch Out"}),c.jsx("ul",{className:"space-y-1",children:b.warnings.map((Pe,Ve)=>c.jsxs("li",{className:"text-sm text-red-700",children:[" ",Pe]},Ve))})]})]})}),b.alternatives&&b.alternatives.length>0&&c.jsxs("div",{className:"bg-green-50 rounded-2xl p-5 border-2 border-green-200",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(xw,{className:"w-6 h-6 text-green-600"}),c.jsx("h4",{className:"font-bold text-green-900",children:" Better Options"})]}),c.jsx("div",{className:"space-y-3",children:b.alternatives.slice(0,3).map((Pe,Ve)=>{var it,Mt,tt,ft;return c.jsxs("div",{className:"bg-white rounded-xl p-4 border border-green-200",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("p",{className:"font-bold text-green-900",children:Pe.name}),c.jsxs("span",{className:"text-xs font-bold bg-green-100 text-green-700 px-2 py-1 rounded-lg",children:[(it=Pe.nutrition)==null?void 0:it.calories," cal"]})]}),c.jsx("p",{className:"text-sm text-green-700 mb-2",children:Pe.description}),c.jsxs("div",{className:"flex gap-2 text-xs text-green-600 font-medium",children:[c.jsxs("span",{children:["P: ",(Mt=Pe.nutrition)==null?void 0:Mt.protein,"g"]}),c.jsxs("span",{children:["C: ",(tt=Pe.nutrition)==null?void 0:tt.carbs,"g"]}),c.jsxs("span",{children:["F: ",(ft=Pe.nutrition)==null?void 0:ft.fats,"g"]})]})]},Ve)})})]}),c.jsx("button",{onClick:()=>{_(null),M(null)},className:"w-full py-3 bg-gray-200 text-gray-900 rounded-2xl font-bold hover:bg-gray-300 transition-all",children:"Clear"})]}),c.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-lg border-2 border-gray-200",children:[c.jsxs("button",{onClick:()=>G(!B),className:"w-full flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:c.jsx(CNe,{className:"w-5 h-5 text-blue-600"})}),c.jsxs("div",{className:"text-left",children:[c.jsx("h3",{className:"font-bold text-gray-900",children:"Today's Checks"}),c.jsxs("p",{className:"text-xs text-gray-600",children:[D.length," items"]})]})]}),c.jsx("span",{className:`text-2xl text-gray-400 transition-transform ${B?"rotate-180":""}`,children:""})]}),B&&c.jsx("div",{className:"space-y-2 border-t-2 border-gray-200 pt-4",children:D.length===0?c.jsx("p",{className:"text-center text-gray-500 py-4",children:"No checks yet today"}):D.map(Pe=>c.jsxs("button",{onClick:()=>ve(Pe),className:"w-full flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl hover:from-blue-100 hover:to-cyan-100 transition-all text-left",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-semibold text-gray-900",children:Pe.foodName}),c.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[c.jsxs("span",{className:`text-xs font-bold px-2 py-1 rounded-lg ${Pe.isHealthy?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[Pe.healthScore,"/100"]}),c.jsxs("span",{className:"text-xs text-gray-500",children:[Pe.calories," cal"]}),c.jsx("span",{className:"text-xs text-gray-500",children:new Date(Pe.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),c.jsx("button",{onClick:Ve=>{Ve.stopPropagation(),le(Pe._id)},className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition ml-2",children:c.jsx(lu,{className:"w-4 h-4"})})]},Pe._id))})]})]})}function HYe(){var ct,zt,Ke,xe,Je,yt,Yn,Jr,os,Ao;const e=Us(),[n,s]=z.useState(!1),[o,d]=z.useState(!0),[h,f]=z.useState([]),[v,b]=z.useState(null),[_,w]=z.useState(null),[E,N]=z.useState(!1),[I,R]=z.useState(0),[O,P]=z.useState(new Date().toISOString().split("T")[0]),[M,D]=z.useState("breakfast"),[U,B]=z.useState(""),[G,$]=z.useState(!1),[q,X]=z.useState(null),[ee,ce]=z.useState(""),[Q,ae]=z.useState("medium"),[ve,le]=z.useState("homemade"),[fe,re]=z.useState([]),[he,J]=z.useState(!1);z.useEffect(()=>{ue()},[O]),z.useEffect(()=>{window.location.hash==="#daily-target"&&setTimeout(()=>{var Ne;(Ne=document.getElementById("daily-target"))==null||Ne.scrollIntoView({behavior:"smooth",block:"center"})},100)},[]);const ue=async()=>{s(!0);try{const Ze={Authorization:`Bearer ${localStorage.getItem("token")}`},Gn=new Date().toISOString().split("T")[0],on=O===Gn,[Br,Wi,Fs]=await Promise.all([on?Ln.get("/api/nutrition/logs/today",{headers:Ze}):Ln.get(`/api/nutrition/logs?startDate=${O}&endDate=${O}`,{headers:Ze}),Ln.get(`/api/nutrition/summary/daily?date=${O}`,{headers:Ze}),Ln.get("/api/nutrition/goals",{headers:Ze}).catch(()=>({data:{healthGoal:null}}))]);f(Br.data.foodLogs||[]),b(Wi.data.summary),w(Fs.data.healthGoal);const al=localStorage.getItem(`waterIntake_${O}`);R(al?parseInt(al):0),d(!1)}catch(Ne){console.error("Failed to fetch data:",Ne),et.error("Failed to load nutrition data"),d(!1)}finally{s(!1)}},Ee=()=>{const Ne=I+1;R(Ne),localStorage.setItem(`waterIntake_${O}`,Ne),et.success("Water intake updated! ")},Fe=()=>{if(I>0){const Ne=I-1;R(Ne),localStorage.setItem(`waterIntake_${O}`,Ne)}},ke=Ne=>{const Ze=Ne.toLowerCase();return Ze.includes("juice")||Ze.includes("milk")||Ze.includes("water")||Ze.includes("tea")||Ze.includes("coffee")?["1 cup (250ml)","1 glass (200ml)","1 bottle (500ml)","2 cups (500ml)"]:Ze.includes("rice")||Ze.includes("pasta")||Ze.includes("noodles")?["1 cup","1.5 cups","2 cups","1 bowl"]:Ze.includes("bread")||Ze.includes("roti")||Ze.includes("chapati")||Ze.includes("paratha")?["1 piece","2 pieces","3 pieces","4 pieces"]:Ze.includes("apple")||Ze.includes("banana")||Ze.includes("orange")||Ze.includes("mango")?["1 small","1 medium","1 large","2 pieces"]:Ze.includes("egg")?["1 egg","2 eggs","3 eggs","4 eggs"]:Ze.includes("chicken")||Ze.includes("meat")||Ze.includes("fish")?["100g","150g","200g","1 piece"]:["1 serving","1 plate","1 bowl","1 cup"]},Ge=()=>{if(!q||!ee){et.error("Please analyze food and select quantity");return}const Ne={...q.foodItem,quantity:ee,servingSize:Q,preparationMethod:ve,id:Date.now()};re([...fe,Ne]),B(""),X(null),ce(""),J(!1),et.success("Food item added!")},De=Ne=>{re(fe.filter(Ze=>Ze.id!==Ne)),et.success("Item removed")},Pe=async()=>{if(!U.trim()){et.error("Please enter a food item");return}$(!0);try{const Ne=localStorage.getItem("token"),Ze=`${Q} ${ve} ${U}`,Gn=await Ln.post("/api/nutrition/quick-check",{foodDescription:Ze},{headers:{Authorization:`Bearer ${Ne}`}});X(Gn.data.data),J(!0),et.success("Food analyzed!")}catch(Ne){console.error("Analysis error:",Ne),et.error("Failed to analyze food")}finally{$(!1)}},Ve=async()=>{if(fe.length===0){et.error("Please add at least one food item");return}try{const Ne=localStorage.getItem("token");await Ln.post("/api/nutrition/log-meal",{mealType:M,foodItems:fe.map(Ze=>({...Ze,notes:`${Ze.quantity} - ${Ze.servingSize} - ${Ze.preparationMethod}`})),notes:`${fe.length} items logged`},{headers:{Authorization:`Bearer ${Ne}`}}),et.success("Meal logged successfully!"),N(!1),B(""),X(null),re([]),ce(""),ae("medium"),le("homemade"),ue()}catch(Ne){console.error("Log meal error:",Ne),et.error("Failed to log meal")}},it=async Ne=>{if(confirm("Delete this meal?"))try{const Ze=localStorage.getItem("token");await Ln.delete(`/api/nutrition/logs/${Ne}`,{headers:{Authorization:`Bearer ${Ze}`}}),et.success("Meal deleted"),ue()}catch(Ze){console.error("Delete error:",Ze),et.error("Failed to delete meal")}},Mt=Ne=>({breakfast:"",lunch:"",dinner:"",snack:""})[Ne]||"",tt=()=>{const Ne=new Date(O);Ne.setDate(Ne.getDate()-1),P(Ne.toISOString().split("T")[0])},ft=()=>{const Ne=new Date(O);Ne.setDate(Ne.getDate()+1),P(Ne.toISOString().split("T")[0])},Rt=Ne=>{const Ze=new Date(Ne+"T00:00:00"),Gn=new Date,on=new Date(Gn);return on.setDate(on.getDate()-1),Ne===Gn.toISOString().split("T")[0]?"Today":Ne===on.toISOString().split("T")[0]?"Yesterday":Ze.toLocaleDateString("en-US",{month:"short",day:"numeric"})};if(o&&n)return c.jsx("div",{className:"flex items-center justify-center h-screen",children:c.jsx(Zh,{className:"w-8 h-8 animate-spin text-blue-500"})});const Te=(v==null?void 0:v.caloriePercentage)||0;return c.jsxs("div",{className:`w-full h-full bg-gradient-to-br from-cyan-50 via-blue-50 to-cyan-100 flex flex-col ${E?"overflow-hidden":""}`,children:[n&&!o&&c.jsxs("div",{className:"fixed top-20 right-4 z-50 bg-white rounded-full shadow-lg px-4 py-2 flex items-center gap-2 animate-slide-in-right",children:[c.jsx("div",{className:"w-4 h-4 border-2 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin"}),c.jsx("span",{className:"text-sm text-slate-600",children:"Refreshing..."})]}),c.jsxs("div",{className:"w-full px-3 md:px-6 lg:px-8 py-3 flex items-center justify-between bg-white border-b border-gray-200 sticky top-0 z-10 shrink-0",children:[c.jsx("button",{onClick:tt,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:c.jsx(IQ,{className:"w-5 h-5 text-gray-600"})}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Nutrition"}),c.jsx("p",{className:"text-lg font-bold text-gray-900",children:Rt(O)})]}),c.jsx("button",{onClick:ft,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:c.jsx(Il,{className:"w-5 h-5 text-gray-600"})})]}),c.jsx("div",{className:"w-full flex-1 overflow-y-auto flex justify-center",children:c.jsxs("div",{className:"w-full max-w-4xl px-3 md:px-6 lg:px-8 py-4 space-y-4 pb-24",children:[!_&&c.jsxs("div",{className:"bg-amber-50 border-2 border-amber-200 rounded-2xl p-4 flex items-start gap-3",children:[c.jsx(Vr,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-semibold text-amber-900 mb-2",children:"Set Your Fitness Goal"}),c.jsx("button",{onClick:()=>e("/profile?tab=goals"),className:"text-sm bg-amber-600 text-white px-3 py-1 rounded-lg hover:bg-amber-700",children:"Set Goal Now"})]})]}),v&&_&&c.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-3xl p-6 text-white shadow-lg",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-blue-100 text-sm mb-1",children:"Calories Today"}),c.jsxs("div",{className:"flex items-baseline gap-2",children:[c.jsx("span",{className:"text-4xl font-bold",children:v.totalCalories}),c.jsxs("span",{className:"text-blue-100",children:["/ ",_.dailyCalorieTarget]})]})]}),c.jsxs("div",{className:"relative w-24 h-24",children:[c.jsxs("svg",{className:"w-24 h-24 transform -rotate-90",viewBox:"0 0 36 36",children:[c.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"rgba(255,255,255,0.2)",strokeWidth:"3"}),c.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"white",strokeWidth:"3",strokeDasharray:`${Math.min(Te,100)}, 100`,strokeLinecap:"round"})]}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c.jsxs("span",{className:"text-sm font-bold",children:[Math.min(Te,100).toFixed(0),"%"]})})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[c.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[c.jsx("p",{className:"text-xs text-blue-100 mb-1",children:"Protein"}),c.jsxs("p",{className:"font-bold",children:[v.totalProtein.toFixed(0),"g"]}),c.jsxs("p",{className:"text-xs text-blue-100",children:["/ ",_.macroTargets.protein,"g"]})]}),c.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[c.jsx("p",{className:"text-xs text-blue-100 mb-1",children:"Carbs"}),c.jsxs("p",{className:"font-bold",children:[v.totalCarbs.toFixed(0),"g"]}),c.jsxs("p",{className:"text-xs text-blue-100",children:["/ ",_.macroTargets.carbs,"g"]})]}),c.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[c.jsx("p",{className:"text-xs text-blue-100 mb-1",children:"Fats"}),c.jsxs("p",{className:"font-bold",children:[v.totalFats.toFixed(0),"g"]}),c.jsxs("p",{className:"text-xs text-blue-100",children:["/ ",_.macroTargets.fats,"g"]})]})]})]}),c.jsxs("div",{className:"bg-gradient-to-br from-cyan-400 to-blue-500 rounded-3xl p-6 text-white shadow-lg",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-cyan-100 text-sm mb-1",children:"Water Reminder"}),c.jsx("p",{className:"text-2xl font-bold",children:"Drink water stay hydrated"})]}),c.jsx("div",{className:"text-4xl",children:""})]}),c.jsxs("p",{className:"text-cyan-100 mb-4",children:["Today you drink ",c.jsxs("span",{className:"font-bold text-white",children:[I," glass"]})," of water"]}),c.jsxs("p",{className:"text-cyan-100 mb-4 text-sm",children:[(I*.25).toFixed(2)," L"]}),c.jsx("div",{className:"grid grid-cols-6 gap-2 mb-4",children:Array.from({length:8}).map((Ne,Ze)=>c.jsx("div",{onClick:()=>Ze<I?Fe():Ee(),className:`aspect-square rounded-lg flex items-center justify-center cursor-pointer transition-all transform hover:scale-110 ${Ze<I?"bg-white text-blue-500 shadow-lg":"bg-white/30 text-white"}`,children:c.jsx(Qh,{className:"w-5 h-5"})},Ze))}),c.jsx("button",{onClick:Ee,className:"w-full bg-white text-blue-600 font-bold py-2 rounded-xl hover:bg-blue-50 transition-all",children:"+ Add Water"})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"Quick Check"}),c.jsx(zYe,{})]}),c.jsxs("div",{id:"daily-target",className:"scroll-mt-20",children:[c.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"My Daily Target"}),c.jsx("div",{className:"space-y-3",children:["breakfast","lunch","snack","dinner"].map(Ne=>{const Ze=h.filter(on=>on.mealType===Ne),Gn=Ze.reduce((on,Br)=>{var Wi;return on+(((Wi=Br.totalNutrition)==null?void 0:Wi.calories)||0)},0);return c.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-4 text-white shadow-md",children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm opacity-90 capitalize",children:Ne}),c.jsxs("p",{className:"text-2xl font-bold",children:[Gn," Kcal"]})]}),c.jsx("span",{className:"text-3xl",children:Mt(Ne)})]}),Ze.length>0?c.jsx("div",{className:"space-y-2 mb-3",children:Ze.map(on=>{var Br,Wi,Fs;return c.jsxs("div",{className:"bg-white/20 rounded-lg p-2 flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium",children:((Wi=(Br=on.foodItems)==null?void 0:Br[0])==null?void 0:Wi.name)||"Food"}),c.jsxs("p",{className:"text-xs opacity-75",children:[(Fs=on.totalNutrition)==null?void 0:Fs.calories," cal"]})]}),c.jsx("button",{onClick:()=>it(on._id),className:"p-1 hover:bg-white/30 rounded-lg transition",children:c.jsx(lu,{className:"w-4 h-4"})})]},on._id)})}):null,c.jsxs("button",{onClick:()=>{if(!_){et.error("Please set your fitness goal first");return}D(Ne),N(!0)},className:"w-full bg-white/30 hover:bg-white/40 text-white font-bold py-2 rounded-lg transition-all flex items-center justify-center gap-2",children:[c.jsx(Qc,{className:"w-5 h-5"}),"Add ",Ne.charAt(0).toUpperCase()+Ne.slice(1)]})]},Ne)})})]})]})}),E&&c.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end md:items-center md:justify-center",children:c.jsxs("div",{className:"bg-white w-full md:w-full md:max-w-2xl rounded-t-3xl md:rounded-3xl p-6 max-h-[85vh] md:max-h-[90vh] overflow-y-auto md:mb-0",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Add ",M.charAt(0).toUpperCase()+M.slice(1)]}),c.jsx("button",{onClick:()=>{N(!1),B(""),X(null),re([]),ce(""),ae("medium"),le("homemade"),J(!1)},className:"p-2 hover:bg-gray-100 rounded-lg",children:c.jsx(di,{className:"w-6 h-6"})})]}),fe.length>0&&c.jsxs("div",{className:"mb-4 space-y-2",children:[c.jsxs("h3",{className:"text-sm font-semibold text-gray-700",children:["Added Items (",fe.length,")"]}),fe.map(Ne=>{var Ze;return c.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-medium text-gray-900",children:Ne.name}),c.jsxs("p",{className:"text-xs text-gray-500",children:[Ne.quantity,"  ",Ne.servingSize,"  ",Ne.preparationMethod]}),c.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[((Ze=Ne.nutrition)==null?void 0:Ze.calories)||0," cal"]})]}),c.jsx("button",{onClick:()=>De(Ne.id),className:"p-2 hover:bg-red-100 rounded-lg text-red-600",children:c.jsx(lu,{className:"w-4 h-4"})})]},Ne.id)})]}),q?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-4 text-white",children:[c.jsx("h3",{className:"font-bold text-white mb-4",children:(ct=q.foodItem)==null?void 0:ct.name}),c.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[c.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[c.jsx(Ml,{className:"w-5 h-5 text-orange-300 mx-auto mb-1"}),c.jsx("p",{className:"text-xs text-blue-100",children:"Calories"}),c.jsx("p",{className:"text-xl font-bold text-white",children:((Ke=(zt=q.foodItem)==null?void 0:zt.nutrition)==null?void 0:Ke.calories)||0})]}),c.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[c.jsx(zn,{className:"w-5 h-5 text-red-300 mx-auto mb-1"}),c.jsx("p",{className:"text-xs text-blue-100",children:"Protein"}),c.jsxs("p",{className:"text-xl font-bold text-white",children:[((Je=(xe=q.foodItem)==null?void 0:xe.nutrition)==null?void 0:Je.protein)||0,"g"]})]}),c.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[c.jsx(xo,{className:"w-5 h-5 text-yellow-300 mx-auto mb-1"}),c.jsx("p",{className:"text-xs text-blue-100",children:"Carbs"}),c.jsxs("p",{className:"text-xl font-bold text-white",children:[((Yn=(yt=q.foodItem)==null?void 0:yt.nutrition)==null?void 0:Yn.carbs)||0,"g"]})]}),c.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[c.jsx(Qh,{className:"w-5 h-5 text-cyan-300 mx-auto mb-1"}),c.jsx("p",{className:"text-xs text-blue-100",children:"Fats"}),c.jsxs("p",{className:"text-xl font-bold text-white",children:[((os=(Jr=q.foodItem)==null?void 0:Jr.nutrition)==null?void 0:os.fats)||0,"g"]})]})]}),q.isHealthy?c.jsxs("div",{className:"flex items-center gap-2 text-white bg-white/20 px-3 py-2 rounded-lg",children:[c.jsx(rr,{className:"w-5 h-5"}),c.jsx("span",{className:"text-sm font-medium",children:"Healthy Choice"})]}):c.jsxs("div",{className:"flex items-center gap-2 text-white bg-white/20 px-3 py-2 rounded-lg",children:[c.jsx(Vr,{className:"w-5 h-5"}),c.jsx("span",{className:"text-sm font-medium",children:"Not Ideal"})]})]}),he&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Quantity"}),c.jsx("div",{className:"grid grid-cols-2 gap-2",children:ke(((Ao=q.foodItem)==null?void 0:Ao.name)||"").map(Ne=>c.jsx("button",{onClick:()=>ce(Ne),className:`py-3 px-4 rounded-lg font-medium transition-all ${ee===Ne?"bg-cyan-600 text-white ring-2 ring-cyan-300":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:Ne},Ne))}),c.jsx("input",{type:"text",value:ee,onChange:Ne=>ce(Ne.target.value),placeholder:"Or enter custom quantity",className:"w-full mt-2 px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-cyan-500 focus:outline-none text-sm"})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>{X(null),B(""),ce(""),J(!1)},className:"flex-1 bg-gray-200 text-gray-900 font-bold py-3 rounded-xl hover:bg-gray-300",children:"Back"}),c.jsxs("button",{onClick:Ge,disabled:!ee,className:"flex-1 bg-cyan-600 text-white font-bold py-3 rounded-xl hover:bg-cyan-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[c.jsx(Qc,{className:"w-5 h-5"}),"Add Item"]})]})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Serving Size"}),c.jsx("div",{className:"grid grid-cols-3 gap-2",children:["small","medium","large"].map(Ne=>c.jsx("button",{onClick:()=>ae(Ne),className:`py-2 px-4 rounded-lg font-medium transition-all ${Q===Ne?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:Ne.charAt(0).toUpperCase()+Ne.slice(1)},Ne))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preparation Method"}),c.jsx("div",{className:"grid grid-cols-3 gap-2",children:["homemade","baked","fried","grilled","steamed","raw"].map(Ne=>c.jsx("button",{onClick:()=>le(Ne),className:`py-2 px-3 rounded-lg text-sm font-medium transition-all ${ve===Ne?"bg-emerald-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:Ne.charAt(0).toUpperCase()+Ne.slice(1)},Ne))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Food Item"}),c.jsx("input",{type:"text",value:U,onChange:Ne=>B(Ne.target.value),placeholder:"e.g., Chicken rice with vegetables",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none",onKeyPress:Ne=>Ne.key==="Enter"&&Pe()})]}),c.jsx("button",{onClick:Pe,disabled:G||!U.trim(),className:"w-full bg-blue-600 text-white font-bold py-3 rounded-xl hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:G?c.jsxs(c.Fragment,{children:[c.jsx(Zh,{className:"w-5 h-5 animate-spin"}),"Analyzing..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Ml,{className:"w-5 h-5"}),"Analyze Food"]})})]}),fe.length>0&&!q&&c.jsxs("button",{onClick:Ve,className:"w-full mt-4 bg-green-600 text-white font-bold py-3 rounded-xl hover:bg-green-700 flex items-center justify-center gap-2",children:[c.jsx(rr,{className:"w-5 h-5"}),"Log ",fe.length," Item",fe.length>1?"s":""]})]})})]})}function KYe(){const[e,n]=z.useState([]),[s,o]=z.useState(!0),[d,h]=z.useState("all");z.useEffect(()=>{window.scrollTo(0,0),f()},[]);const f=async()=>{try{const{data:w}=await da.getReports();n(w)}catch{et.error("Failed to load reports")}finally{o(!1)}},v=async(w,E)=>{if(E.preventDefault(),E.stopPropagation(),!!window.confirm("Are you sure you want to delete this report? This action cannot be undone."))try{await da.deleteReport(w),n(e.filter(N=>N._id!==w)),et.success("Report deleted successfully")}catch{et.error("Failed to delete report")}},b=d==="all"?e:e.filter(w=>w.reportType.toLowerCase().includes(d.toLowerCase())),_=["all",...new Set(e.map(w=>w.reportType))];return s?c.jsx(op,{message:"Loading your health reports..."}):c.jsxs("div",{className:"max-w-6xl mx-auto space-y-4 sm:space-y-6 animate-fade-in p-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4",children:[c.jsxs("div",{children:[c.jsxs(Ct,{to:"/dashboard",className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 font-medium transition-colors mb-2 text-sm",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back to Dashboard"]}),c.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800",children:"All Health Reports"}),c.jsx("p",{className:"text-slate-500 mt-1 text-sm",children:"View and manage all your uploaded health reports"})]}),c.jsxs(Ct,{to:"/upload",className:"px-4 py-2.5 sm:px-6 sm:py-3 text-white rounded-xl font-medium hover:shadow-lg transition-all flex items-center justify-center gap-2 text-sm sm:text-base whitespace-nowrap",style:{backgroundColor:"#8B7355"},children:[c.jsx(Es,{className:"w-4 h-4"}),"Upload Report"]})]}),e.length>0&&c.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4",children:[c.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-3 sm:p-6",children:c.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:gap-3",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-cyan-100 flex items-center justify-center mb-2 sm:mb-0",children:c.jsx(Vn,{className:"w-4 h-4 sm:w-5 sm:h-5 text-cyan-500"})}),c.jsxs("div",{className:"text-center sm:text-left",children:[c.jsx("p",{className:"text-xl sm:text-2xl font-bold text-slate-800",children:e.length}),c.jsx("p",{className:"text-slate-500 text-[10px] sm:text-sm",children:"Total Reports"})]})]})}),c.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-3 sm:p-6",children:c.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:gap-3",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-emerald-100 flex items-center justify-center mb-2 sm:mb-0",children:c.jsx(Or,{className:"w-4 h-4 sm:w-5 sm:h-5 text-emerald-500"})}),c.jsxs("div",{className:"text-center sm:text-left",children:[c.jsx("p",{className:"text-xl sm:text-2xl font-bold text-slate-800",children:e.filter(w=>w.status==="completed").length}),c.jsx("p",{className:"text-slate-500 text-[10px] sm:text-sm",children:"Analyzed"})]})]})}),c.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-3 sm:p-6",children:c.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:gap-3",children:[c.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-amber-100 flex items-center justify-center mb-2 sm:mb-0",children:c.jsx(qr,{className:"w-4 h-4 sm:w-5 sm:h-5 text-amber-500"})}),c.jsxs("div",{className:"text-center sm:text-left",children:[c.jsx("p",{className:"text-xs sm:text-base font-bold text-slate-800 leading-tight",children:e.length>0?new Date(e[0].createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"N/A"}),c.jsx("p",{className:"text-slate-500 text-[10px] sm:text-sm",children:"Latest"})]})]})})]}),c.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 snap-x snap-mandatory scrollbar-hide -mx-4 px-4 sm:mx-0 sm:px-0",children:_.map(w=>c.jsx("button",{onClick:()=>h(w),className:`px-3 py-1.5 sm:px-4 sm:py-2 rounded-xl font-medium whitespace-nowrap transition-all text-sm snap-start ${d===w?"bg-cyan-500 text-white shadow-md":"bg-white text-slate-600 border border-slate-200 hover:bg-slate-50"}`,children:w==="all"?"All Reports":w},w))}),b.length>0?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"hidden sm:grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(w=>{var E,N,I,R,O;return c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-4 sm:p-6 hover:border-cyan-400 hover:shadow-lg transition-all group relative",children:[c.jsx("button",{onClick:P=>v(w._id,P),className:"absolute top-4 right-4 w-8 h-8 rounded-lg bg-red-100 hover:bg-red-200 flex items-center justify-center transition-colors z-10",title:"Delete report",children:c.jsx(lu,{className:"w-4 h-4 text-red-600"})}),c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-100 flex items-center justify-center group-hover:bg-red-200 transition-colors",children:c.jsx(Vn,{className:"w-6 h-6 text-red-500"})}),c.jsx("span",{className:`text-xs px-3 py-1 rounded-full font-medium ${w.status==="completed"?"bg-emerald-100 text-emerald-600":w.status==="processing"?"bg-amber-100 text-amber-600":"bg-slate-100 text-slate-600"}`,children:w.status==="completed"?"ANALYZED":w.status.toUpperCase()})]}),c.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2 group-hover:text-cyan-600 transition-colors",children:w.reportType}),(w.patientName||((E=w.aiAnalysis)==null?void 0:E.patientName))&&c.jsxs("p",{className:"text-sm text-slate-600 mb-2",children:["Patient: ",w.patientName||((N=w.aiAnalysis)==null?void 0:N.patientName)]}),c.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm mb-3",children:[c.jsx(qr,{className:"w-4 h-4"}),c.jsx("span",{children:new Date(w.reportDate||w.createdAt).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]}),((I=w.aiAnalysis)==null?void 0:I.healthScore)&&c.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-xl mb-3",children:[c.jsx("span",{className:"text-sm text-slate-600",children:"Health Score"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-2xl font-bold text-slate-800",children:w.aiAnalysis.healthScore}),c.jsx("span",{className:"text-slate-400 text-sm",children:"/100"})]})]}),((O=(R=w.aiAnalysis)==null?void 0:R.keyFindings)==null?void 0:O.length)>0&&c.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 mb-3",children:[c.jsx(Vr,{className:"w-4 h-4"}),c.jsxs("span",{children:[w.aiAnalysis.keyFindings.length," key findings"]})]}),c.jsxs(Ct,{to:`/reports/${w._id}`,onClick:()=>window.scrollTo(0,0),className:"block w-full mt-3 py-2 bg-cyan-500 text-white rounded-lg font-medium text-sm hover:bg-cyan-600 transition-colors flex items-center justify-center gap-2",children:[c.jsx(Ll,{className:"w-4 h-4"}),"View Details"]})]},w._id)})}),c.jsx("div",{className:"sm:hidden",children:b.length<=3?c.jsx("div",{className:"grid grid-cols-1 gap-3",children:b.map(w=>{var E;return c.jsxs("div",{className:"bg-white rounded-xl border-2 border-slate-200 p-4 hover:border-cyan-400 transition-all relative",children:[c.jsx("button",{onClick:N=>v(w._id,N),className:"absolute top-3 right-3 w-7 h-7 rounded-lg bg-red-100 hover:bg-red-200 flex items-center justify-center transition-colors z-10",children:c.jsx(lu,{className:"w-3.5 h-3.5 text-red-600"})}),c.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center flex-shrink-0",children:c.jsx(Vn,{className:"w-5 h-5 text-red-500"})}),c.jsxs("div",{className:"flex-1 min-w-0 pr-8",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[c.jsx("h3",{className:"text-sm font-bold text-slate-800 truncate",children:w.reportType}),c.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-medium whitespace-nowrap ${w.status==="completed"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:w.status==="completed"?"DONE":"PENDING"})]}),c.jsx("p",{className:"text-xs text-slate-500 mb-2",children:new Date(w.reportDate||w.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),((E=w.aiAnalysis)==null?void 0:E.healthScore)&&c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("span",{className:"text-xs text-slate-600",children:"Score:"}),c.jsx("span",{className:"text-lg font-bold text-slate-800",children:w.aiAnalysis.healthScore}),c.jsx("span",{className:"text-xs text-slate-400",children:"/100"})]})]})]}),c.jsxs(Ct,{to:`/reports/${w._id}`,onClick:()=>window.scrollTo(0,0),className:"block w-full py-2 bg-cyan-500 text-white rounded-lg font-medium text-xs hover:bg-cyan-600 transition-colors flex items-center justify-center gap-2",children:[c.jsx(Ll,{className:"w-3.5 h-3.5"}),"View Details"]})]},w._id)})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"flex overflow-x-auto gap-3 pb-4 snap-x snap-mandatory scrollbar-hide -mx-4 px-4",children:b.map(w=>{var E;return c.jsxs("div",{className:"min-w-[280px] bg-white rounded-xl border-2 border-slate-200 p-4 hover:border-cyan-400 transition-all snap-start flex-shrink-0 relative",children:[c.jsx("button",{onClick:N=>v(w._id,N),className:"absolute top-3 right-3 w-7 h-7 rounded-lg bg-red-100 hover:bg-red-200 flex items-center justify-center transition-colors z-10",children:c.jsx(lu,{className:"w-3.5 h-3.5 text-red-600"})}),c.jsxs("div",{className:"flex items-start gap-3 mb-3 pr-8",children:[c.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center flex-shrink-0",children:c.jsx(Vn,{className:"w-5 h-5 text-red-500"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h3",{className:"text-sm font-bold text-slate-800 mb-1",children:w.reportType}),c.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-medium ${w.status==="completed"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:w.status==="completed"?"ANALYZED":"PENDING"})]})]}),c.jsx("p",{className:"text-xs text-slate-500 mb-3",children:new Date(w.reportDate||w.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),((E=w.aiAnalysis)==null?void 0:E.healthScore)&&c.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-50 rounded-lg mb-3",children:[c.jsx("span",{className:"text-xs text-slate-600",children:"Health Score"}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-xl font-bold text-slate-800",children:w.aiAnalysis.healthScore}),c.jsx("span",{className:"text-xs text-slate-400",children:"/100"})]})]}),c.jsxs(Ct,{to:`/reports/${w._id}`,onClick:()=>window.scrollTo(0,0),className:"block w-full py-2 bg-cyan-500 text-white rounded-lg font-medium text-xs hover:bg-cyan-600 transition-colors flex items-center justify-center gap-2",children:[c.jsx(Ll,{className:"w-3.5 h-3.5"}),"View Details"]})]},w._id)})}),c.jsx("div",{className:"flex items-center justify-center gap-2 text-slate-400 text-xs",children:c.jsx("span",{children:" Scroll for more "})})]})})]}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:c.jsx(Vn,{className:"w-10 h-10 text-slate-400"})}),c.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-2",children:"No Reports Found"}),c.jsx("p",{className:"text-slate-500 mb-6 text-sm",children:d==="all"?"Upload your first health report to get started":`No ${d} reports found`}),c.jsxs(Ct,{to:"/upload",className:"inline-flex items-center gap-2 px-6 py-3 text-white rounded-xl font-medium hover:shadow-lg transition-all",style:{backgroundColor:"#8B7355"},children:[c.jsx(Vn,{className:"w-4 h-4"}),"Upload Report"]})]})]})}const Rv=[{id:"water",label:"Drink 8 glasses of water",icon:""},{id:"workout",label:"Workout/Yoga (30 mins)",icon:""},{id:"fruits",label:"Eat 2 servings of fruits",icon:""},{id:"vegetables",label:"Eat 3 servings of vegetables",icon:""},{id:"sleep",label:"Sleep 7-8 hours",icon:""},{id:"meditation",label:"Meditate (10 mins)",icon:""},{id:"steps",label:"Walk 8,000 steps",icon:""},{id:"screen",label:"Limit screen time (< 2 hrs)",icon:""}];function YYe(){const[e,n]=z.useState(1),[s,o]=z.useState({}),[d,h]=z.useState(0);z.useEffect(()=>{window.scrollTo(0,0);const E=localStorage.getItem("challenge30Days");if(E){const N=JSON.parse(E);o(N),f(N)}},[]);const f=E=>{let N=0;for(let I=e;I>=1;I--){const R=E[I];if(R&&Object.values(R).filter(Boolean).length>=5)N++;else break}h(N)},v=(E,N)=>{var O;const I={...s,[E]:{...s[E],[N]:!((O=s[E])!=null&&O[N])}};o(I),localStorage.setItem("challenge30Days",JSON.stringify(I)),f(I);const R=Object.values(I[E]).filter(Boolean).length;R===Rv.length?et.success(" Amazing! You completed all tasks for today!"):R===5&&et.success(" Great job! You're doing awesome!")},b=E=>{const N=s[E]||{};return Object.values(N).filter(Boolean).length/Rv.length*100},_=()=>{let E=0;for(let N=1;N<=30;N++){const I=s[N]||{};E+=Object.values(I).filter(Boolean).length}return E/(Rv.length*30)*100},w=()=>{let E=0;for(let N=1;N<=30;N++){const I=s[N]||{};Object.values(I).filter(Boolean).length>=5&&E++}return E};return c.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in p-4",children:[c.jsxs("div",{children:[c.jsxs(Ct,{to:"/dashboard",className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 font-medium transition-colors mb-2",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back to Dashboard"]}),c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{children:[c.jsxs("h1",{className:"text-3xl font-bold text-slate-800 flex items-center gap-3",children:[c.jsx(rP,{className:"w-8 h-8 text-amber-500"}),"30 Days Health Challenge"]}),c.jsx("p",{className:"text-slate-500 mt-1",children:"Build healthy habits, one day at a time"})]})})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4",children:[c.jsx("div",{className:"bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl sm:rounded-2xl p-3 sm:p-6 text-white",children:c.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:gap-3 mb-2",children:[c.jsx(Ml,{className:"w-6 h-6 sm:w-8 sm:h-8 mb-1 sm:mb-0"}),c.jsxs("div",{className:"text-center sm:text-left",children:[c.jsx("p",{className:"text-2xl sm:text-3xl font-bold",children:d}),c.jsx("p",{className:"text-amber-100 text-[10px] sm:text-sm",children:"Day Streak"})]})]})}),c.jsx("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-500 rounded-xl sm:rounded-2xl p-3 sm:p-6 text-white",children:c.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:gap-3 mb-2",children:[c.jsx(rr,{className:"w-6 h-6 sm:w-8 sm:h-8 mb-1 sm:mb-0"}),c.jsxs("div",{className:"text-center sm:text-left",children:[c.jsx("p",{className:"text-2xl sm:text-3xl font-bold",children:w()}),c.jsx("p",{className:"text-emerald-100 text-[10px] sm:text-sm",children:"Days Done"})]})]})}),c.jsx("div",{className:"bg-gradient-to-br from-cyan-500 to-blue-500 rounded-xl sm:rounded-2xl p-3 sm:p-6 text-white",children:c.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:gap-3 mb-2",children:[c.jsx(ns,{className:"w-6 h-6 sm:w-8 sm:h-8 mb-1 sm:mb-0"}),c.jsxs("div",{className:"text-center sm:text-left",children:[c.jsxs("p",{className:"text-2xl sm:text-3xl font-bold",children:[_().toFixed(0),"%"]}),c.jsx("p",{className:"text-cyan-100 text-[10px] sm:text-sm",children:"Progress"})]})]})})]}),c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-4 sm:p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-800",children:"Select Day"}),c.jsxs("span",{className:"text-xs sm:text-sm text-slate-500",children:["Current: Day ",e]})]}),c.jsx("div",{className:"block sm:hidden space-y-3 max-h-[300px] overflow-y-auto",children:[0,1,2,3].map(E=>c.jsx("div",{className:"flex gap-2",children:Array.from({length:7},(N,I)=>E*7+I+1).filter(N=>N<=30).map(N=>{const I=b(N),R=I>=62.5;return c.jsx("button",{onClick:()=>n(N),className:`flex-1 aspect-square rounded-xl font-bold text-sm transition-all ${e===N?"bg-cyan-500 text-white shadow-lg scale-105":R?"bg-emerald-100 text-emerald-700 hover:bg-emerald-200":I>0?"bg-amber-100 text-amber-700 hover:bg-amber-200":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:N},N)})},E))}),c.jsx("div",{className:"hidden sm:grid grid-cols-10 gap-2",children:Array.from({length:30},(E,N)=>N+1).map(E=>{const N=b(E),I=N>=62.5;return c.jsx("button",{onClick:()=>n(E),className:`aspect-square rounded-xl font-bold text-sm transition-all ${e===E?"bg-cyan-500 text-white shadow-lg scale-110":I?"bg-emerald-100 text-emerald-700 hover:bg-emerald-200":N>0?"bg-amber-100 text-amber-700 hover:bg-amber-200":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:E},E)})})]}),c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-bold text-slate-800",children:["Day ",e," Tasks"]}),c.jsxs("p",{className:"text-slate-500 text-sm",children:[Object.values(s[e]||{}).filter(Boolean).length," of ",Rv.length," completed"]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-2xl font-bold text-cyan-600",children:[b(e).toFixed(0),"%"]}),c.jsx("div",{className:"text-xs text-slate-500",children:"Progress"})]})]}),c.jsx("div",{className:"w-full bg-slate-100 rounded-full h-3 mb-6",children:c.jsx("div",{className:"h-3 rounded-full bg-gradient-to-r from-cyan-500 to-blue-500 transition-all duration-500",style:{width:`${b(e)}%`}})}),c.jsx("div",{className:"space-y-3",children:Rv.map(E=>{var I;const N=(I=s[e])==null?void 0:I[E.id];return c.jsxs("button",{onClick:()=>v(e,E.id),className:`w-full flex items-center gap-4 p-4 rounded-xl border-2 transition-all ${N?"bg-emerald-50 border-emerald-200 hover:bg-emerald-100":"bg-white border-slate-200 hover:bg-slate-50"}`,children:[c.jsx("div",{className:"text-3xl",children:E.icon}),c.jsx("div",{className:"flex-1 text-left",children:c.jsx("p",{className:`font-medium ${N?"text-emerald-700 line-through":"text-slate-800"}`,children:E.label})}),c.jsx("div",{children:N?c.jsx(rr,{className:"w-6 h-6 text-emerald-500"}):c.jsx(SNe,{className:"w-6 h-6 text-slate-300"})})]},E.id)})})]}),c.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl p-6 text-white",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx(If,{className:"w-6 h-6"}),c.jsx("h3",{className:"text-lg font-semibold",children:"Achievements"})]}),c.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[c.jsxs("div",{className:`p-3 rounded-xl text-center ${d>=3?"bg-white/20":"bg-white/10 opacity-50"}`,children:[c.jsx("div",{className:"text-2xl mb-1",children:""}),c.jsx("p",{className:"text-xs font-medium",children:"3 Day Streak"})]}),c.jsxs("div",{className:`p-3 rounded-xl text-center ${d>=7?"bg-white/20":"bg-white/10 opacity-50"}`,children:[c.jsx("div",{className:"text-2xl mb-1",children:""}),c.jsx("p",{className:"text-xs font-medium",children:"1 Week Streak"})]}),c.jsxs("div",{className:`p-3 rounded-xl text-center ${w()>=15?"bg-white/20":"bg-white/10 opacity-50"}`,children:[c.jsx("div",{className:"text-2xl mb-1",children:""}),c.jsx("p",{className:"text-xs font-medium",children:"Half Way"})]}),c.jsxs("div",{className:`p-3 rounded-xl text-center ${w()>=30?"bg-white/20":"bg-white/10 opacity-50"}`,children:[c.jsx("div",{className:"text-2xl mb-1",children:""}),c.jsx("p",{className:"text-xs font-medium",children:"Champion"})]})]})]}),c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:" Tips for Success"}),c.jsxs("ul",{className:"space-y-2 text-slate-600",children:[c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-cyan-500 mt-1",children:""}),c.jsx("span",{children:"Complete at least 5 tasks daily to maintain your streak"})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-cyan-500 mt-1",children:""}),c.jsx("span",{children:"Set reminders on your phone for each task"})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-cyan-500 mt-1",children:""}),c.jsx("span",{children:"Start with easier tasks and gradually increase difficulty"})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-cyan-500 mt-1",children:""}),c.jsx("span",{children:"Share your progress with friends for accountability"})]})]})]})]})}function Zne({vital:e,onClose:n}){const[s,o]=z.useState("overview"),[d,h]=z.useState(null),[f,v]=z.useState(!0);if(!e)return console.error("VitalDetailsPopup: vital prop is null or undefined"),null;const{name:b="Unknown Metric",value:_="N/A",unit:w="",normalRange:E="N/A",status:N="normal",description:I="",recommendations:R=[],foodsToConsume:O=[],foodsToAvoid:P=[],symptoms:M=[],severity:D=""}=e||{};z.useEffect(()=>{b&&b!=="Unknown Metric"?(async()=>{try{v(!0),console.log(" Fetching AI info for vital:",b);const Q=await da.getMetricInfo({metricName:b,metricValue:_,normalRange:E,unit:w});Q.data&&Q.data.metricInfo&&(console.log(" Received AI info for vital:",b),h(Q.data.metricInfo.en))}catch(Q){console.error(" Error fetching AI info:",Q)}finally{v(!1)}})():v(!1)},[b,_,E,w]);const B=(ce=>{if(!ce)return{min:0,max:100};const Q=ce.split("-").map(ae=>parseFloat(ae.trim()));return{min:Q[0],max:Q[1]}})(E),G=parseFloat(_),$=()=>G<B.min?0:G>B.max?100:(G-B.min)/(B.max-B.min)*100,X=N==="normal"?{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-700",badge:"bg-emerald-100"}:N==="borderline"?{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-700",badge:"bg-amber-100"}:{bg:"bg-red-50",border:"border-red-200",text:"text-red-700",badge:"bg-red-100"},ee=$();return c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",onClick:ce=>{ce.target===ce.currentTarget&&n()},children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:ce=>ce.stopPropagation(),children:[c.jsxs("div",{className:`${X.bg} border-b-2 ${X.border} p-6 flex items-center justify-between sticky top-0 z-10`,children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:`w-12 h-12 rounded-xl ${X.badge} flex items-center justify-center`,children:[N==="normal"&&c.jsx(rr,{className:`w-6 h-6 ${X.text}`}),N==="borderline"&&c.jsx(Vr,{className:`w-6 h-6 ${X.text}`}),N==="high"&&c.jsx(Or,{className:`w-6 h-6 ${X.text}`})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-slate-800",children:b}),c.jsx("p",{className:`text-sm ${X.text} font-medium capitalize`,children:N})]})]}),c.jsx("button",{onClick:n,className:"p-2 hover:bg-white/50 rounded-lg transition-colors",children:c.jsx(di,{className:"w-6 h-6 text-slate-600"})})]}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:[c.jsx("p",{className:"text-xs text-slate-600 font-medium mb-1",children:"Your Value"}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800",children:[_," ",c.jsx("span",{className:"text-sm text-slate-500",children:w})]})]}),c.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:[c.jsx("p",{className:"text-xs text-blue-600 font-medium mb-1",children:"Normal Range"}),c.jsx("p",{className:"text-2xl font-bold text-blue-700",children:E})]}),c.jsxs("div",{className:`${X.bg} rounded-xl p-4 border-2 ${X.border}`,children:[c.jsx("p",{className:`text-xs ${X.text} font-medium mb-1`,children:"Status"}),c.jsx("p",{className:`text-2xl font-bold ${X.text} capitalize`,children:N})]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Range Indicator"}),c.jsxs("div",{className:"relative h-12 bg-gradient-to-r from-red-200 via-amber-200 to-emerald-200 rounded-xl overflow-hidden border-2 border-slate-200",children:[c.jsx("div",{className:"absolute top-0 bottom-0 bg-white/40 border-l-2 border-r-2 border-blue-500",style:{left:`${B.min/(B.max*1.2)*100}%`,right:`${100-B.max/(B.max*1.2)*100}%`}}),c.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-1 h-full bg-slate-800 border-2 border-white shadow-lg",style:{left:`${ee}%`},children:c.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 -translate-x-1/2 left-0 w-8 h-8 bg-slate-800 rounded-full border-4 border-white shadow-lg"})})]}),c.jsxs("div",{className:"flex justify-between text-xs text-slate-600 font-medium",children:[c.jsx("span",{children:"Low"}),c.jsx("span",{children:"Normal"}),c.jsx("span",{children:"High"})]})]})]}),c.jsx("div",{className:"flex gap-2 border-b border-slate-200",children:[{id:"overview",label:"Overview"},{id:"recommendations",label:"What to Do"},{id:"foods",label:"Foods & Diet"}].map(ce=>c.jsx("button",{onClick:()=>o(ce.id),className:`px-4 py-2 font-medium text-sm border-b-2 transition-colors ${s===ce.id?"border-cyan-500 text-cyan-600":"border-transparent text-slate-600 hover:text-slate-800"}`,children:ce.label},ce.id))}),c.jsxs("div",{className:"space-y-4",children:[s==="overview"&&c.jsx("div",{className:"space-y-4",children:f?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"w-12 h-12 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mx-auto mb-3"}),c.jsx("p",{className:"text-slate-500 text-sm",children:"Loading AI insights..."})]}):c.jsxs(c.Fragment,{children:[((d==null?void 0:d.whatIsIt)||I)&&c.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-200",children:[c.jsxs("h3",{className:"font-semibold text-blue-900 mb-2 flex items-center gap-2",children:[c.jsx(bw,{className:"w-4 h-4"}),"What is ",b,"?"]}),c.jsx("p",{className:"text-sm text-blue-900 leading-relaxed",children:(d==null?void 0:d.whatIsIt)||I||`${b} is a health metric that helps monitor your overall health.`})]}),c.jsxs("div",{className:`p-4 rounded-xl border-2 ${X.border} ${X.bg}`,children:[c.jsxs("h3",{className:`font-semibold ${X.text} mb-2 flex items-center gap-2`,children:[c.jsx(bw,{className:"w-4 h-4"}),"What This Means"]}),c.jsxs("p",{className:`text-sm ${X.text}`,children:[N==="normal"&&"Your value is within the normal range. Keep maintaining your current lifestyle and habits.",N==="borderline"&&"Your value is slightly outside the normal range. Consider making lifestyle adjustments and monitor regularly.",N==="high"&&"Your value is significantly outside the normal range. Consult with a healthcare provider and make necessary changes.",N==="low"&&"Your value is below the normal range. Consult with a healthcare provider for guidance."]})]}),(d==null?void 0:d.whenLowEffects)&&d.whenLowEffects.length>0&&c.jsxs("div",{className:"p-4 bg-amber-50 rounded-xl border border-amber-200",children:[c.jsxs("h3",{className:"font-semibold text-amber-900 mb-3 flex items-center gap-2",children:[c.jsx(CT,{className:"w-4 h-4"}),d.whenLowTitle||"When Low"]}),c.jsx("ul",{className:"space-y-2",children:d.whenLowEffects.map((ce,Q)=>c.jsxs("li",{className:"text-sm text-amber-800 flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-amber-600 rounded-full mt-1.5 flex-shrink-0"}),ce]},Q))})]}),(d==null?void 0:d.whenHighEffects)&&d.whenHighEffects.length>0&&c.jsxs("div",{className:"p-4 bg-red-50 rounded-xl border border-red-200",children:[c.jsxs("h3",{className:"font-semibold text-red-900 mb-3 flex items-center gap-2",children:[c.jsx(Or,{className:"w-4 h-4"}),d.whenHighTitle||"When High"]}),c.jsx("ul",{className:"space-y-2",children:d.whenHighEffects.map((ce,Q)=>c.jsxs("li",{className:"text-sm text-red-800 flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-red-600 rounded-full mt-1.5 flex-shrink-0"}),ce]},Q))})]}),!d&&M&&Array.isArray(M)&&M.length>0&&c.jsxs("div",{className:"p-4 bg-amber-50 rounded-xl border border-amber-200",children:[c.jsxs("h3",{className:"font-semibold text-amber-900 mb-3 flex items-center gap-2",children:[c.jsx(Vr,{className:"w-4 h-4"}),"Associated Symptoms"]}),c.jsx("ul",{className:"space-y-2",children:M.map((ce,Q)=>c.jsxs("li",{className:"text-sm text-amber-800 flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-amber-600 rounded-full mt-1.5 flex-shrink-0"}),ce]},Q))})]})]})}),s==="recommendations"&&c.jsx("div",{className:"space-y-4",children:f?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"w-12 h-12 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mx-auto mb-3"}),c.jsx("p",{className:"text-slate-500 text-sm",children:"Loading recommendations..."})]}):c.jsxs(c.Fragment,{children:[d!=null&&d.solutions&&d.solutions.length>0?c.jsxs("div",{className:"p-4 bg-emerald-50 rounded-xl border border-emerald-200",children:[c.jsxs("h3",{className:"font-semibold text-emerald-900 mb-3 flex items-center gap-2",children:[c.jsx(rr,{className:"w-4 h-4"}),"How to Improve"]}),c.jsx("ul",{className:"space-y-3",children:d.solutions.map((ce,Q)=>c.jsxs("li",{className:"text-sm text-emerald-800 flex items-start gap-3 p-3 bg-white rounded-lg",children:[c.jsx("span",{className:"w-6 h-6 bg-emerald-500 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:Q+1}),c.jsx("span",{children:ce})]},Q))})]}):R&&Array.isArray(R)&&R.length>0?c.jsxs("div",{className:"p-4 bg-emerald-50 rounded-xl border border-emerald-200",children:[c.jsxs("h3",{className:"font-semibold text-emerald-900 mb-3 flex items-center gap-2",children:[c.jsx(rr,{className:"w-4 h-4"}),"Recommendations"]}),c.jsx("ul",{className:"space-y-3",children:R.map((ce,Q)=>c.jsxs("li",{className:"text-sm text-emerald-800 flex items-start gap-3 p-3 bg-white rounded-lg",children:[c.jsx("span",{className:"w-6 h-6 bg-emerald-500 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:Q+1}),c.jsx("span",{children:ce})]},Q))})]}):c.jsxs("div",{className:"text-center py-8 text-slate-500",children:[c.jsx(bw,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),c.jsx("p",{children:"Consult with a healthcare professional for personalized recommendations."})]}),c.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-200",children:[c.jsx("h3",{className:"font-semibold text-blue-900 mb-3",children:"General Tips"}),c.jsxs("ul",{className:"space-y-2 text-sm text-blue-800",children:[c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-blue-600 rounded-full mt-1.5 flex-shrink-0"}),"Monitor this value regularly"]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-blue-600 rounded-full mt-1.5 flex-shrink-0"}),"Maintain a healthy lifestyle"]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-blue-600 rounded-full mt-1.5 flex-shrink-0"}),"Consult a healthcare provider if concerned"]})]})]})]})}),s==="foods"&&c.jsxs("div",{className:"space-y-4",children:[O&&Array.isArray(O)&&O.length>0&&c.jsxs("div",{className:"p-4 bg-emerald-50 rounded-xl border border-emerald-200",children:[c.jsxs("h3",{className:"font-semibold text-emerald-900 mb-3 flex items-center gap-2",children:[c.jsx(rr,{className:"w-4 h-4"}),"Foods to Consume"]}),c.jsx("div",{className:"flex flex-wrap gap-2",children:O.map((ce,Q)=>c.jsx("span",{className:"px-3 py-1.5 bg-emerald-100 text-emerald-700 rounded-full text-sm font-medium",children:ce},Q))})]}),P&&Array.isArray(P)&&P.length>0&&c.jsxs("div",{className:"p-4 bg-red-50 rounded-xl border border-red-200",children:[c.jsxs("h3",{className:"font-semibold text-red-900 mb-3 flex items-center gap-2",children:[c.jsx(Vr,{className:"w-4 h-4"}),"Foods to Avoid"]}),c.jsx("div",{className:"flex flex-wrap gap-2",children:P.map((ce,Q)=>c.jsx("span",{className:"px-3 py-1.5 bg-red-100 text-red-700 rounded-full text-sm font-medium",children:ce},Q))})]}),(!O||!Array.isArray(O)||O.length===0)&&(!P||!Array.isArray(P)||P.length===0)&&c.jsx("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-200",children:c.jsx("p",{className:"text-sm text-slate-600",children:"No specific dietary recommendations available."})})]})]}),D&&c.jsx("div",{className:`p-4 rounded-xl border-2 ${D==="severe"?"bg-red-50 border-red-200":D==="moderate"?"bg-amber-50 border-amber-200":"bg-yellow-50 border-yellow-200"}`,children:c.jsxs("p",{className:`text-sm font-medium ${D==="severe"?"text-red-700":D==="moderate"?"text-amber-700":"text-yellow-700"}`,children:[c.jsx("strong",{children:"Severity:"})," ",D.charAt(0).toUpperCase()+D.slice(1)]})})]}),c.jsx("div",{className:"border-t border-slate-200 p-6 bg-slate-50",children:c.jsx("p",{className:"text-xs text-slate-600 text-center",children:"This information is for educational purposes only. Always consult with a healthcare provider for medical advice."})})]})})}function qYe(){var I,R,O,P,M,D,U;const{id:e}=rb(),[n,s]=z.useState(null),[o,d]=z.useState(!0),[h,f]=z.useState(null),[v,b]=z.useState(!1);z.useEffect(()=>{(async()=>{try{const{data:G}=await da.getReport(e);s(G.report)}catch{et.error("Failed to load report")}finally{d(!1)}})()},[e]);const _=(B,G)=>{const $={name:B,value:G.value,unit:G.unit||"",normalRange:G.normalRange||"N/A",status:G.status||"normal",description:G.description||"",recommendations:G.recommendations||[],foodsToConsume:G.foodsToConsume||[],foodsToAvoid:G.foodsToAvoid||[],symptoms:G.symptoms||[],severity:G.severity||""};f($),b(!0)},w=()=>{b(!1),f(null)};if(o)return c.jsx(op,{message:"Loading your health report..."});if(!n)return c.jsx("div",{className:"text-center py-12 text-slate-400",children:"Report not found"});const{aiAnalysis:E}=n,N=(E==null?void 0:E.healthScore)||0;return c.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fade-in p-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs(Ct,{to:"/dashboard",className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 font-medium transition-colors",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back to Dashboard"]}),c.jsx(Ct,{to:`/reports/${e}`,className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 font-medium transition-colors",children:"Back to Report Details "})]}),c.jsx("div",{className:"bg-gradient-to-r from-cyan-600 to-blue-600 rounded-2xl p-8 text-white",children:c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[c.jsxs("div",{children:[(n.patientName||(E==null?void 0:E.patientName))&&c.jsxs("div",{className:"mb-3",children:[c.jsx("p",{className:"text-sm text-white/60 uppercase tracking-wide",children:"Patient Name"}),c.jsx("p",{className:"text-xl font-semibold",children:n.patientName||(E==null?void 0:E.patientName)})]}),c.jsxs("h1",{className:"text-3xl font-bold mb-2",children:[n.reportType," Analysis"]}),c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 text-white/70",children:[c.jsxs("p",{children:["Analyzed on ",new Date(n.createdAt).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]}),(n.reportDate||(E==null?void 0:E.reportDate))&&c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"hidden sm:inline",children:""}),c.jsxs("p",{children:["Report Date: ",new Date(n.reportDate||(E==null?void 0:E.reportDate)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]})]})]})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-5xl font-bold mb-2",children:N}),c.jsx("div",{className:"text-sm text-white/70",children:"Health Score"})]})]})}),(E==null?void 0:E.summary)&&c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-blue-200 p-8 shadow-sm",children:[c.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-4 flex items-center gap-2",children:[c.jsx(jn,{className:"w-6 h-6 text-cyan-500"})," Report Summary"]}),c.jsx("p",{className:"text-slate-700 leading-relaxed text-lg",children:E.summary})]}),((I=E==null?void 0:E.keyFindings)==null?void 0:I.length)>0&&c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-8 shadow-sm",children:[c.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx(zn,{className:"w-6 h-6 text-red-500"})," Key Findings"]}),c.jsx("div",{className:"space-y-3",children:E.keyFindings.map((B,G)=>c.jsxs("div",{className:"flex items-start gap-4 p-4 bg-slate-50 rounded-lg border border-slate-200",children:[c.jsx(rr,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-1"}),c.jsx("p",{className:"text-slate-700 text-base",children:B})]},G))})]}),(E==null?void 0:E.metrics)&&Object.keys(E.metrics).length>0&&c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-8 shadow-sm",children:[c.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx(jn,{className:"w-6 h-6 text-cyan-500"})," All Health Metrics"]}),c.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(E.metrics).map(([B,G])=>c.jsxs("button",{onClick:()=>_(B,G),className:`p-5 rounded-xl border-2 text-left transition-all hover:scale-105 hover:shadow-lg cursor-pointer ${G.status==="normal"?"bg-emerald-50 border-emerald-200 hover:border-emerald-300":G.status==="high"?"bg-red-50 border-red-200 hover:border-red-300":"bg-amber-50 border-amber-200 hover:border-amber-300"}`,children:[c.jsx("p",{className:"text-sm text-slate-600 font-medium mb-2",children:B}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800 mb-2",children:[G.value," ",c.jsx("span",{className:"text-sm font-normal text-slate-500",children:G.unit})]}),c.jsxs("p",{className:"text-xs text-slate-600 mb-3",children:["Normal: ",G.normalRange]}),c.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-semibold ${G.status==="normal"?"bg-emerald-100 text-emerald-700":G.status==="high"?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:G.status.toUpperCase()})]},B))})]}),((R=E==null?void 0:E.deficiencies)==null?void 0:R.length)>0&&c.jsxs("div",{className:"bg-white rounded-2xl border-l-4 border-amber-500 border-t-2 border-r-2 border-b-2 border-t-slate-200 border-r-slate-200 border-b-slate-200 p-8 shadow-sm",children:[c.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx($d,{className:"w-6 h-6 text-amber-500"})," Detected Deficiencies"]}),c.jsx("div",{className:"space-y-4",children:E.deficiencies.map((B,G)=>{var $;return c.jsxs("div",{className:`p-5 rounded-xl border-2 ${B.severity==="Severe"?"bg-red-50 border-red-200":B.severity==="Moderate"?"bg-amber-50 border-amber-200":"bg-yellow-50 border-yellow-200"}`,children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsx("h3",{className:"text-lg font-bold text-slate-800",children:B.name}),c.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${B.severity==="Severe"?"bg-red-100 text-red-700":B.severity==="Moderate"?"bg-amber-100 text-amber-700":"bg-yellow-100 text-yellow-700"}`,children:B.severity})]}),B.explanation&&c.jsx("p",{className:"text-slate-700 mb-3",children:B.explanation}),(($=B.symptoms)==null?void 0:$.length)>0&&c.jsxs("div",{className:"mb-3",children:[c.jsx("p",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Symptoms:"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:B.symptoms.map((q,X)=>c.jsx("span",{className:"text-xs bg-white px-2 py-1 rounded border border-slate-300",children:q},X))})]}),B.currentValue&&c.jsxs("p",{className:"text-sm text-slate-600",children:[c.jsx("strong",{children:"Current:"})," ",B.currentValue," | ",c.jsx("strong",{children:"Normal:"})," ",B.normalRange]})]},G)})})]}),(E==null?void 0:E.foodRecommendations)&&Object.keys(E.foodRecommendations).length>0&&c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-8 shadow-sm",children:[c.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx(Pa,{className:"w-6 h-6 text-emerald-500"})," Recommended Foods"]}),c.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:Object.entries(E.foodRecommendations).map(([B,G])=>c.jsxs("div",{className:"p-6 bg-emerald-50 rounded-xl border-2 border-emerald-200",children:[c.jsx("h3",{className:"font-bold text-emerald-700 mb-2 text-lg",children:B}),G.explanation&&c.jsx("p",{className:"text-sm text-emerald-600 mb-3",children:G.explanation}),G.frequency&&c.jsxs("p",{className:"text-xs text-emerald-700 font-medium mb-3",children:["Frequency: ",G.frequency]}),G.foods&&c.jsx("div",{className:"flex flex-wrap gap-2",children:G.foods.map(($,q)=>c.jsx("span",{className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-medium",children:$},q))})]},B))})]}),(E==null?void 0:E.supplementRecommendations)&&Object.keys(E.supplementRecommendations).length>0&&c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-8 shadow-sm",children:[c.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx(ka,{className:"w-6 h-6 text-blue-600"})," Recommended Supplements"]}),c.jsx("div",{className:"space-y-6",children:Object.entries(E.supplementRecommendations).map(([B,G])=>c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-blue-700 mb-4 text-lg",children:B}),Array.isArray(G)?c.jsx("div",{className:"space-y-3",children:G.map(($,q)=>c.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("p",{className:"font-semibold text-slate-800",children:$.name}),$.frequency&&c.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded font-medium",children:$.frequency})]}),$.dosage&&c.jsxs("p",{className:"text-sm text-slate-700 mb-1",children:[c.jsx("strong",{children:"Dosage:"})," ",$.dosage]}),$.timing&&c.jsxs("p",{className:"text-sm text-slate-700 mb-1",children:[c.jsx("strong",{children:"Timing:"})," ",$.timing]}),$.whyItHelps&&c.jsxs("p",{className:"text-sm text-slate-600 mb-1",children:[c.jsx("strong",{children:"Why:"})," ",$.whyItHelps]}),$.note&&c.jsxs("p",{className:"text-xs text-slate-600 italic",children:[" ",$.note]})]},q))}):null]},B))})]}),(E==null?void 0:E.recommendations)&&Object.keys(E.recommendations).length>0&&c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-8 shadow-sm",children:[c.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[c.jsx(zn,{className:"w-6 h-6 text-red-500"})," Health Recommendations"]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[((O=E.recommendations.immediate)==null?void 0:O.length)>0&&c.jsxs("div",{className:"p-6 bg-red-50 rounded-xl border-2 border-red-200",children:[c.jsx("h3",{className:"font-bold text-red-700 mb-4 text-lg",children:" Immediate Actions"}),c.jsx("ul",{className:"space-y-2",children:E.recommendations.immediate.map((B,G)=>c.jsxs("li",{className:"text-sm text-red-700 flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mt-1.5 flex-shrink-0"}),B]},G))})]}),((P=E.recommendations.shortTerm)==null?void 0:P.length)>0&&c.jsxs("div",{className:"p-6 bg-amber-50 rounded-xl border-2 border-amber-200",children:[c.jsx("h3",{className:"font-bold text-amber-700 mb-4 text-lg",children:" Short-Term (2-4 weeks)"}),c.jsx("ul",{className:"space-y-2",children:E.recommendations.shortTerm.map((B,G)=>c.jsxs("li",{className:"text-sm text-amber-700 flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mt-1.5 flex-shrink-0"}),B]},G))})]}),((M=E.recommendations.longTerm)==null?void 0:M.length)>0&&c.jsxs("div",{className:"p-6 bg-emerald-50 rounded-xl border-2 border-emerald-200",children:[c.jsx("h3",{className:"font-bold text-emerald-700 mb-4 text-lg",children:" Long-Term (Ongoing)"}),c.jsx("ul",{className:"space-y-2",children:E.recommendations.longTerm.map((B,G)=>c.jsxs("li",{className:"text-sm text-emerald-700 flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full mt-1.5 flex-shrink-0"}),B]},G))})]}),E.recommendations.diet&&c.jsxs("div",{className:"p-6 bg-blue-50 rounded-xl border-2 border-blue-200",children:[c.jsx("h3",{className:"font-bold text-blue-700 mb-4 text-lg",children:" Diet Recommendations"}),c.jsx("p",{className:"text-sm text-blue-700",children:E.recommendations.diet})]}),((D=E.recommendations.lifestyle)==null?void 0:D.length)>0&&c.jsxs("div",{className:"p-6 bg-violet-50 rounded-xl border-2 border-violet-200",children:[c.jsx("h3",{className:"font-bold text-violet-700 mb-4 text-lg",children:" Lifestyle Changes"}),c.jsx("ul",{className:"space-y-2",children:E.recommendations.lifestyle.map((B,G)=>c.jsxs("li",{className:"text-sm text-violet-700 flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-violet-500 rounded-full mt-1.5 flex-shrink-0"}),B]},G))})]}),((U=E.recommendations.followUpTests)==null?void 0:U.length)>0&&c.jsxs("div",{className:"p-6 bg-cyan-50 rounded-xl border-2 border-cyan-200",children:[c.jsx("h3",{className:"font-bold text-cyan-700 mb-4 text-lg",children:" Follow-Up Tests"}),c.jsx("ul",{className:"space-y-2",children:E.recommendations.followUpTests.map((B,G)=>c.jsxs("li",{className:"text-sm text-cyan-700 flex items-start gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-cyan-500 rounded-full mt-1.5 flex-shrink-0"}),B]},G))})]})]})]}),c.jsx("div",{className:"p-6 bg-blue-50 rounded-xl border-2 border-blue-200",children:c.jsxs("p",{className:"text-sm text-blue-700",children:[c.jsx("strong",{children:"Disclaimer:"})," This AI analysis is for informational wellness support only and should not replace professional medical advice. Always consult with a healthcare provider for medical decisions."]})}),v&&h&&c.jsx(Zne,{vital:h,onClose:w})]})}function XYe(){var ee,ce;const[e,n]=z.useState([]),[s,o]=z.useState(null),[d,h]=z.useState(null),[f,v]=z.useState(!0),[b,_]=z.useState(null),[w,E]=z.useState(!1),[N,I]=z.useState(null);z.useEffect(()=>{R()},[]),z.useEffect(()=>{if(s){const Q=e.find(ae=>ae._id===s);h(Q)}},[s,e]);const R=async()=>{try{const{data:Q}=await da.getReports();n(Q),Q.length>0&&o(Q[0]._id)}catch(Q){console.error("Failed to fetch reports:",Q)}finally{v(!1)}},O=(Q,ae)=>{if(!ae||typeof ae!="object")return;const ve={name:Q||"Unknown Metric",value:ae.value!==void 0?ae.value:"N/A",unit:ae.unit||"",normalRange:ae.normalRange||"N/A",status:ae.status||"normal",description:ae.description||`Details for ${Q}`,recommendations:Array.isArray(ae.recommendations)?ae.recommendations:[],foodsToConsume:Array.isArray(ae.foodsToConsume)?ae.foodsToConsume:[],foodsToAvoid:Array.isArray(ae.foodsToAvoid)?ae.foodsToAvoid:[],symptoms:Array.isArray(ae.symptoms)?ae.symptoms:[],severity:ae.severity||""};_(ve),E(!0)},P=()=>{E(!1),_(null)},M=()=>{const Q=new Set;return e.forEach(ae=>{var ve;(ve=ae.aiAnalysis)!=null&&ve.metrics&&Object.keys(ae.aiAnalysis.metrics).forEach(le=>Q.add(le))}),Array.from(Q).sort()},D=Q=>Q?e.filter(ae=>{var ve,le;return(le=(ve=ae.aiAnalysis)==null?void 0:ve.metrics)==null?void 0:le[Q]}).reverse().map(ae=>({date:new Date(ae.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"}),value:ae.aiAnalysis.metrics[Q].value,unit:ae.aiAnalysis.metrics[Q].unit,status:ae.aiAnalysis.metrics[Q].status,normalRange:ae.aiAnalysis.metrics[Q].normalRange,fullDate:new Date(ae.createdAt)})):[],U=Q=>{if(Q.length<2)return{direction:"stable",change:0,percentChange:0};const ae=Q[Q.length-1].value,ve=Q[Q.length-2].value,le=ae-ve,fe=(le/ve*100).toFixed(1);let re="stable";return le>0?re="up":le<0&&(re="down"),{direction:re,change:le.toFixed(2),percentChange:fe}};if(f)return c.jsx(op,{message:"Loading vital signs..."});if(e.length===0)return c.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in p-4",children:[c.jsx("div",{className:"flex items-center gap-4 mb-6",children:c.jsxs(Ct,{to:"/dashboard",className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 font-medium transition-colors",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back to Dashboard"]})}),c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-12 text-center",children:[c.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:c.jsx(jn,{className:"w-10 h-10 text-red-500"})}),c.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-3",children:"No Vital Signs Available"}),c.jsx("p",{className:"text-slate-600 mb-6 max-w-md mx-auto",children:"Upload your health report to view your vital signs and health metrics extracted from your reports."}),c.jsxs(Ct,{to:"/upload",className:"inline-flex items-center gap-2 px-6 py-3 bg-red-500 text-white rounded-xl font-semibold hover:bg-red-600 transition-colors",children:[c.jsx(Es,{className:"w-5 h-5"}),"Upload Report"]})]})]});const B=((ee=d==null?void 0:d.aiAnalysis)==null?void 0:ee.metrics)||{},G=Object.keys(B).length>0,$=M(),q=N?D(N):[],X=q.length>0?U(q):null;return c.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fade-in p-4 pb-20",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[c.jsxs("div",{children:[c.jsxs(Ct,{to:"/dashboard",className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 font-medium transition-colors mb-2",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back to Dashboard"]}),c.jsxs("h1",{className:"text-3xl font-bold text-slate-800 flex items-center gap-3",children:[c.jsx(jn,{className:"w-8 h-8 text-red-500"}),"Vital Signs"]}),c.jsx("p",{className:"text-slate-600 mt-2",children:"View your health metrics from reports"})]}),e.length>1&&c.jsxs("div",{className:"relative",children:[c.jsx("select",{value:s||"",onChange:Q=>o(Q.target.value),className:"appearance-none px-4 py-3 pr-10 bg-white border-2 border-slate-200 rounded-xl text-sm font-medium text-slate-800 hover:border-cyan-400 focus:border-cyan-500 focus:outline-none cursor-pointer transition-colors",children:e.map(Q=>c.jsxs("option",{value:Q._id,children:[Q.reportType," - ",new Date(Q.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]},Q._id))}),c.jsx(mu,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 pointer-events-none"})]})]}),d&&c.jsxs("div",{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-2xl p-6 text-white",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx(Vn,{className:"w-6 h-6"}),c.jsx("h2",{className:"text-xl font-bold",children:d.reportType})]}),c.jsxs("p",{className:"text-white/80 text-sm",children:["Report Date: ",new Date(d.createdAt).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]}),((ce=d.aiAnalysis)==null?void 0:ce.healthScore)&&c.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-lg",children:[c.jsx("span",{className:"text-sm",children:"Health Score:"}),c.jsx("span",{className:"text-2xl font-bold",children:d.aiAnalysis.healthScore})]})]}),e.length>1&&$.length>0&&c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Vital Progress Tracker"}),c.jsx("p",{className:"text-slate-600 text-sm",children:"Select a vital to see its progress over time"})]}),c.jsxs("div",{className:"relative min-w-[200px]",children:[c.jsxs("select",{value:N||"",onChange:Q=>I(Q.target.value),className:"appearance-none w-full px-4 py-3 pr-10 bg-gradient-to-r from-cyan-50 to-blue-50 border-2 border-cyan-200 rounded-xl text-sm font-medium text-slate-800 hover:border-cyan-400 focus:border-cyan-500 focus:outline-none cursor-pointer transition-colors",children:[c.jsx("option",{value:"",children:"Select Vital"}),$.map(Q=>c.jsx("option",{value:Q,children:Q},Q))]}),c.jsx(mu,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-cyan-600 pointer-events-none"})]})]}),N&&q.length>0?c.jsxs("div",{className:"space-y-4",children:[X&&q.length>1&&c.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-slate-50 to-slate-100 rounded-xl",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Current Value"}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800",children:[q[q.length-1].value," ",c.jsx("span",{className:"text-sm font-normal text-slate-500",children:q[q.length-1].unit})]}),c.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Normal: ",q[q.length-1].normalRange]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-slate-600 mb-2",children:"Trend"}),c.jsx("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full font-bold ${X.direction==="up"?"bg-blue-100 text-blue-700":X.direction==="down"?"bg-purple-100 text-purple-700":"bg-slate-100 text-slate-700"}`,children:X.direction==="up"?c.jsxs(c.Fragment,{children:[c.jsx(Or,{className:"w-5 h-5"}),c.jsxs("span",{children:["+",X.change]})]}):X.direction==="down"?c.jsxs(c.Fragment,{children:[c.jsx(CT,{className:"w-5 h-5"}),c.jsx("span",{children:X.change})]}):c.jsxs(c.Fragment,{children:[c.jsx(ff,{className:"w-5 h-5"}),c.jsx("span",{children:"Stable"})]})}),c.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[Math.abs(X.percentChange),"% change"]})]})]}),c.jsx("div",{className:"h-64 sm:h-80",children:c.jsx(xy,{width:"100%",height:"100%",children:c.jsxs(rL,{data:q,children:[c.jsx("defs",{children:c.jsxs("linearGradient",{id:"vitalGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[c.jsx("stop",{offset:"5%",stopColor:"#06b6d4",stopOpacity:.3}),c.jsx("stop",{offset:"95%",stopColor:"#06b6d4",stopOpacity:0})]})}),c.jsx(Jf,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),c.jsx(Xl,{dataKey:"date",stroke:"#94a3b8",fontSize:12,tickLine:!1}),c.jsx(Jl,{stroke:"#94a3b8",fontSize:12,tickLine:!1}),c.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"2px solid #06b6d4",borderRadius:"12px",padding:"12px"},labelStyle:{color:"#64748b",fontWeight:"bold",marginBottom:"4px"},formatter:(Q,ae,ve)=>[`${Q} ${ve.payload.unit}`,N]}),c.jsx(sl,{type:"monotone",dataKey:"value",stroke:"#06b6d4",strokeWidth:3,fill:"url(#vitalGradient)",dot:{fill:"#06b6d4",strokeWidth:2,r:5},activeDot:{r:7,fill:"#0891b2"}})]})})}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:q.slice(-4).reverse().map((Q,ae)=>c.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg border border-slate-200",children:[c.jsx("p",{className:"text-xs text-slate-500 mb-1",children:Q.date}),c.jsx("p",{className:"text-lg font-bold text-slate-800",children:Q.value}),c.jsx("span",{className:`inline-block mt-1 px-2 py-0.5 rounded text-xs font-semibold ${Q.status==="normal"?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700"}`,children:Q.status})]},ae))})]}):N?c.jsxs("div",{className:"text-center py-12 text-slate-400",children:[c.jsx(jn,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"No data available for this vital across your reports"})]}):c.jsxs("div",{className:"text-center py-12 text-slate-400",children:[c.jsx(jn,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"Select a vital from the dropdown to see its progress"})]})]}),G?c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-6 shadow-sm",children:[c.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-6",children:"Current Health Metrics"}),c.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(B).map(([Q,ae])=>c.jsxs("button",{onClick:()=>O(Q,ae),className:`p-5 rounded-xl border-2 text-left transition-all hover:scale-105 hover:shadow-lg cursor-pointer ${ae.status==="normal"?"bg-emerald-50 border-emerald-200 hover:border-emerald-300":ae.status==="high"||ae.status==="low"?"bg-red-50 border-red-200 hover:border-red-300":"bg-amber-50 border-amber-200 hover:border-amber-300"}`,children:[c.jsx("p",{className:"text-sm text-slate-600 font-medium mb-2",children:Q}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800 mb-2",children:[ae.value," ",c.jsx("span",{className:"text-sm font-normal text-slate-500",children:ae.unit})]}),c.jsxs("p",{className:"text-xs text-slate-600 mb-3",children:["Normal: ",ae.normalRange]}),c.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-semibold ${ae.status==="normal"?"bg-emerald-100 text-emerald-700":ae.status==="high"||ae.status==="low"?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:ae.status.toUpperCase()})]},Q))})]}):c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-12 text-center",children:[c.jsx(jn,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-2",children:"No Metrics Found"}),c.jsx("p",{className:"text-slate-600 mb-6",children:"This report doesn't contain any extracted health metrics. Try uploading a different report."}),c.jsxs(Ct,{to:"/upload",className:"inline-flex items-center gap-2 px-6 py-3 bg-red-500 text-white rounded-xl font-semibold hover:bg-red-600 transition-colors",children:[c.jsx(Es,{className:"w-5 h-5"}),"Upload New Report"]})]}),w&&b&&c.jsx(Zne,{vital:b,onClose:P})]})}function JYe(){const[e,n]=z.useState([]),[s,o]=z.useState(null),[d,h]=z.useState(null),[f,v]=z.useState([]),[b,_]=z.useState(!0);z.useEffect(()=>{w()},[]),z.useEffect(()=>{if(s){const I=e.find(R=>R._id===s);h(I),E(I)}},[s,e]);const w=async()=>{try{const{data:I}=await da.getReports();n(I),I.length>0&&o(I[0]._id)}catch(I){console.error("Failed to fetch reports:",I)}finally{_(!1)}},E=I=>{var O;if(!I){v([]);return}const R=[];(O=I.aiAnalysis)!=null&&O.supplementRecommendations&&Object.entries(I.aiAnalysis.supplementRecommendations).forEach(([P,M])=>{Array.isArray(M)&&M.forEach(D=>{R.push({...D,category:P,reportId:I._id,reportType:I.reportType,reportDate:I.createdAt})})}),v(R)};if(b)return c.jsx(op,{message:"Loading supplement recommendations..."});if(e.length===0)return c.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in p-4",children:[c.jsx("div",{className:"flex items-center gap-4 mb-6",children:c.jsxs(Ct,{to:"/dashboard",className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 font-medium transition-colors",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back to Dashboard"]})}),c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-12 text-center",children:[c.jsx("div",{className:"w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6",children:c.jsx(ka,{className:"w-10 h-10 text-purple-500"})}),c.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-3",children:"No Supplement Recommendations Yet"}),c.jsx("p",{className:"text-slate-600 mb-6 max-w-md mx-auto",children:"Upload your health report to get personalized supplement recommendations based on your deficiencies and health conditions."}),c.jsxs(Ct,{to:"/upload",className:"inline-flex items-center gap-2 px-6 py-3 bg-purple-500 text-white rounded-xl font-semibold hover:bg-purple-600 transition-colors",children:[c.jsx(Es,{className:"w-5 h-5"}),"Upload Report"]})]})]});if(f.length===0&&d)return c.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in p-4",children:[c.jsx("div",{className:"flex items-center gap-4 mb-6",children:c.jsxs(Ct,{to:"/dashboard",className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 font-medium transition-colors",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back to Dashboard"]})}),e.length>1&&c.jsx("div",{className:"flex justify-end",children:c.jsxs("div",{className:"relative",children:[c.jsx("select",{value:s||"",onChange:I=>o(I.target.value),className:"appearance-none px-4 py-3 pr-10 bg-white border-2 border-slate-200 rounded-xl text-sm font-medium text-slate-800 hover:border-cyan-400 focus:border-cyan-500 focus:outline-none cursor-pointer transition-colors",children:e.map(I=>c.jsxs("option",{value:I._id,children:[I.reportType," - ",new Date(I.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]},I._id))}),c.jsx(mu,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 pointer-events-none"})]})}),c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-12 text-center",children:[c.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:c.jsx(rr,{className:"w-10 h-10 text-green-500"})}),c.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-3",children:"No Supplements Needed"}),c.jsx("p",{className:"text-slate-600 mb-6 max-w-md mx-auto",children:"Great news! This report doesn't show any deficiencies that require supplements. Keep maintaining your healthy lifestyle!"}),e.length>1?c.jsx("p",{className:"text-sm text-slate-500",children:"Try selecting a different report above to view its supplement recommendations."}):c.jsx(Ct,{to:"/dashboard",className:"inline-flex items-center gap-2 px-6 py-3 bg-cyan-500 text-white rounded-xl font-semibold hover:bg-cyan-600 transition-colors",children:"Back to Dashboard"})]})]});const N=f.reduce((I,R)=>(I[R.category]||(I[R.category]=[]),I[R.category].push(R),I),{});return c.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fade-in p-4 pb-20",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[c.jsxs("div",{children:[c.jsxs(Ct,{to:"/dashboard",className:"inline-flex items-center gap-2 text-slate-400 hover:text-cyan-400 font-medium transition-colors mb-2",children:[c.jsx(Ci,{className:"w-4 h-4"})," Back to Dashboard"]}),c.jsxs("h1",{className:"text-3xl font-bold text-slate-800 flex items-center gap-3",children:[c.jsx(ka,{className:"w-8 h-8 text-purple-500"}),"Supplement Recommendations"]}),c.jsx("p",{className:"text-slate-600 mt-2",children:"Based on your selected health report"})]}),e.length>1&&c.jsxs("div",{className:"relative",children:[c.jsx("select",{value:s||"",onChange:I=>o(I.target.value),className:"appearance-none px-4 py-3 pr-10 bg-white border-2 border-slate-200 rounded-xl text-sm font-medium text-slate-800 hover:border-cyan-400 focus:border-cyan-500 focus:outline-none cursor-pointer transition-colors",children:e.map(I=>c.jsxs("option",{value:I._id,children:[I.reportType," - ",new Date(I.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]},I._id))}),c.jsx(mu,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 pointer-events-none"})]})]}),d&&c.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl p-6 text-white",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx(Vn,{className:"w-6 h-6"}),c.jsx("h2",{className:"text-xl font-bold",children:d.reportType})]}),c.jsxs("p",{className:"text-white/80 text-sm",children:["Report Date: ",new Date(d.createdAt).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]}),f.length>0&&c.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-lg",children:[c.jsx(ka,{className:"w-5 h-5"}),c.jsxs("span",{className:"text-sm",children:[f.length," Supplement",f.length!==1?"s":""," Recommended"]})]})]}),c.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[c.jsx(bw,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("p",{className:"font-semibold mb-1",children:"Important Information"}),c.jsx("p",{children:"These recommendations are based on your selected health report. Always consult with a healthcare provider before starting any new supplements."})]})]}),Object.entries(N).map(([I,R])=>c.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-6 shadow-sm",children:[c.jsxs("h2",{className:"text-xl font-bold text-purple-700 mb-4 flex items-center gap-2",children:[c.jsx(ka,{className:"w-6 h-6"}),I]}),c.jsx("div",{className:"space-y-4",children:R.map((O,P)=>c.jsxs("div",{className:"p-5 bg-purple-50 rounded-xl border-2 border-purple-200",children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-1",children:O.name}),c.jsxs("p",{className:"text-xs text-slate-500",children:["From ",O.reportType,"  ",new Date(O.reportDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]}),O.frequency&&c.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-semibold",children:O.frequency})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-3",children:[O.dosage&&c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:"Dosage"}),c.jsx("p",{className:"text-sm text-slate-800",children:O.dosage})]}),O.timing&&c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:"Timing"}),c.jsx("p",{className:"text-sm text-slate-800",children:O.timing})]})]}),O.whyItHelps&&c.jsxs("div",{className:"mb-3",children:[c.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:"Why It Helps"}),c.jsx("p",{className:"text-sm text-slate-700",children:O.whyItHelps})]}),O.note&&c.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[c.jsx(Vr,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"}),c.jsx("p",{className:"text-xs text-amber-800",children:O.note})]})]},P))})]},I)),c.jsxs("div",{className:"bg-slate-50 border-2 border-slate-200 rounded-xl p-6",children:[c.jsxs("h3",{className:"font-semibold text-slate-800 mb-2 flex items-center gap-2",children:[c.jsx(Vr,{className:"w-5 h-5 text-slate-600"}),"Disclaimer"]}),c.jsx("p",{className:"text-sm text-slate-600",children:"These supplement recommendations are generated based on your health reports and are for informational purposes only. They should not replace professional medical advice. Always consult with a qualified healthcare provider before starting any new supplements, especially if you have existing medical conditions or are taking medications."})]})]})}const Ui=({children:e,allowedRoles:n})=>{const{user:s,loading:o}=as();return o?c.jsx(op,{message:"Verifying your credentials..."}):s?n&&!n.includes(s.role)?s.role==="admin"?c.jsx(Aa,{to:"/admin"}):s.role==="doctor"?c.jsx(Aa,{to:"/doctor/dashboard"}):c.jsx(Aa,{to:"/dashboard"}):e:c.jsx(Aa,{to:"/login"})},QYe=({children:e})=>{const{user:n,loading:s,isAdmin:o}=as();return s?c.jsx(op,{message:"Checking admin access..."}):n?o()?e:c.jsx(Aa,{to:"/dashboard"}):c.jsx(Aa,{to:"/login"})},YO=({children:e})=>{const{user:n,loading:s,isDoctor:o}=as();return s?c.jsx(op,{message:"Verifying doctor credentials..."}):n?o()?e:c.jsx(Aa,{to:"/dashboard"}):c.jsx(Aa,{to:"/login"})};function ZYe(){const{user:e,isAdmin:n,isDoctor:s}=as(),o=()=>e?n()?c.jsx(Aa,{to:"/admin"}):s()?c.jsx(Aa,{to:"/doctor/dashboard"}):c.jsx(Aa,{to:"/dashboard"}):c.jsx(pRe,{});return c.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #0a3d5c 0%, #0d5a8a 20%, #1a7fa8 40%, #2b9ec9 60%, #1a7fa8 80%, #0f4f7f 100%)",backgroundAttachment:"fixed"},children:[c.jsx(YNe,{}),c.jsxs(kwe,{children:[c.jsx(Qn,{path:"/",element:c.jsx(hRe,{})}),c.jsx(Qn,{path:"/login",element:o()}),c.jsx(Qn,{path:"/register",element:e?c.jsx(Aa,{to:"/dashboard"}):c.jsx(fRe,{})}),c.jsx(Qn,{path:"/register/doctor",element:e?c.jsx(Aa,{to:"/doctor/dashboard"}):c.jsx(vRe,{})}),c.jsx(Qn,{path:"/dashboard",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(_Ke,{})})})}),c.jsx(Qn,{path:"/dashboard/classic",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(fKe,{})})})}),c.jsx(Qn,{path:"/upload",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(vYe,{})})})}),c.jsx(Qn,{path:"/reports",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(KYe,{})})})}),c.jsx(Qn,{path:"/reports/:id",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(xYe,{})})})}),c.jsx(Qn,{path:"/reports/:id/summary",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(qYe,{})})})}),c.jsx(Qn,{path:"/challenge",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(YYe,{})})})}),c.jsx(Qn,{path:"/doctors",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(EYe,{})})})}),c.jsx(Qn,{path:"/consultation/:appointmentId",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(LYe,{})})}),c.jsx(Qn,{path:"/consultation-summary/:appointmentId",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(MYe,{})})})}),c.jsx(Qn,{path:"/wearables",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(kYe,{})})})}),c.jsx(Qn,{path:"/nutrition",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(HYe,{})})})}),c.jsx(Qn,{path:"/vital-signs",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(XYe,{})})})}),c.jsx(Qn,{path:"/supplements",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(JYe,{})})})}),c.jsx(Qn,{path:"/subscription",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(PYe,{})})})}),c.jsx(Qn,{path:"/diet-plan",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx(GYe,{})})})}),c.jsx(Qn,{path:"/ai-chat",element:c.jsx(Ui,{allowedRoles:["patient","client"],children:c.jsx(oi,{children:c.jsx($Ye,{})})})}),c.jsx(Qn,{path:"/doctor/dashboard",element:c.jsx(YO,{children:c.jsx(oi,{isDoctor:!0,children:c.jsx(EKe,{})})})}),c.jsx(Qn,{path:"/doctor/availability",element:c.jsx(YO,{children:c.jsx(oi,{isDoctor:!0,children:c.jsx(BYe,{})})})}),c.jsx(Qn,{path:"/patient/:patientId",element:c.jsx(YO,{children:c.jsx(oi,{isDoctor:!0,children:c.jsx(jYe,{})})})}),c.jsx(Qn,{path:"/profile",element:c.jsx(Ui,{children:c.jsx(oi,{children:c.jsx(wYe,{})})})}),c.jsx(Qn,{path:"/admin",element:c.jsx(QYe,{children:c.jsx(oi,{isAdmin:!0,children:c.jsx(RYe,{})})})}),c.jsx(Qn,{path:"/demo",element:c.jsx(CYe,{})}),c.jsx(Qn,{path:"/video-test",element:c.jsx(UYe,{})}),c.jsx(Qn,{path:"/email-test",element:c.jsx(FYe,{})})]})]})}qO.createRoot(document.getElementById("root")).render(c.jsx(ye.StrictMode,{children:c.jsx(Bwe,{children:c.jsx(pNe,{children:c.jsxs(yRe,{children:[c.jsx(ZYe,{}),c.jsx(kSe,{position:"top-right"})]})})})}));
